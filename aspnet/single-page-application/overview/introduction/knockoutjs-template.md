---
uid: single-page-application/overview/introduction/knockoutjs-template
title: 'シングルページアプリケーション: KnockoutJS template |Microsoft Docs'
author: MikeWasson
description: テンプレートのノックアウト
ms.author: riande
ms.date: 01/30/2013
ms.assetid: f9c07af0-4b20-4b08-af8f-47fc3df169a2
msc.legacyurl: /single-page-application/overview/introduction/knockoutjs-template
msc.type: authoredcontent
ms.openlocfilehash: 3a551db1caa9636eb7f2e04c287d3ef371263584
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 03/06/2020
ms.locfileid: "78467320"
---
# <a name="single-page-application-knockoutjs-template"></a><span data-ttu-id="2bc54-103">シングルページアプリケーション: KnockoutJS テンプレート</span><span class="sxs-lookup"><span data-stu-id="2bc54-103">Single Page Application: KnockoutJS template</span></span>

<span data-ttu-id="2bc54-104">[Mike Wasson](https://github.com/MikeWasson)</span><span class="sxs-lookup"><span data-stu-id="2bc54-104">by [Mike Wasson](https://github.com/MikeWasson)</span></span>

> <span data-ttu-id="2bc54-105">ノックアウト MVC テンプレートは ASP.NET and Web Tools 2012.2 の一部です</span><span class="sxs-lookup"><span data-stu-id="2bc54-105">The Knockout MVC Template is part of ASP.NET and Web Tools 2012.2</span></span>
> 
> [<span data-ttu-id="2bc54-106">ASP.NET and Web Tools 2012.2 のダウンロード</span><span class="sxs-lookup"><span data-stu-id="2bc54-106">Download ASP.NET and Web Tools 2012.2</span></span>](https://go.microsoft.com/fwlink/?LinkId=282650)

<span data-ttu-id="2bc54-107">ASP.NET and Web Tools 2012.2 の更新プログラムには、ASP.NET MVC 4 用の単一ページアプリケーション (SPA) テンプレートが含まれています。</span><span class="sxs-lookup"><span data-stu-id="2bc54-107">The ASP.NET and Web Tools 2012.2 update includes a Single-Page Application (SPA) template for ASP.NET MVC 4.</span></span> <span data-ttu-id="2bc54-108">このテンプレートは、対話型のクライアント側 web アプリの構築をすぐに始めることができるように設計されています。</span><span class="sxs-lookup"><span data-stu-id="2bc54-108">This template is designed to get you started quickly building interactive client-side web apps.</span></span>

<span data-ttu-id="2bc54-109">"シングルページアプリケーション" (SPA) は、1つの HTML ページを読み込み、新しいページを読み込むのではなく、ページを動的に更新する web アプリケーションの一般的な用語です。</span><span class="sxs-lookup"><span data-stu-id="2bc54-109">"Single-page application" (SPA) is the general term for a web application that loads a single HTML page and then updates the page dynamically, instead of loading new pages.</span></span> <span data-ttu-id="2bc54-110">最初のページの読み込み後、SPA は AJAX 要求によってサーバーと通信します。</span><span class="sxs-lookup"><span data-stu-id="2bc54-110">After the initial page load, the SPA talks with the server through AJAX requests.</span></span>

![](knockoutjs-template/_static/image1.png)

<span data-ttu-id="2bc54-111">AJAX はまったく新しいものではありませんが、今日では、大規模な高度な SPA アプリケーションを簡単に構築して維持できる JavaScript フレームワークが用意されています。</span><span class="sxs-lookup"><span data-stu-id="2bc54-111">AJAX is nothing new, but today there are JavaScript frameworks that make it easier to build and maintain a large sophisticated SPA application.</span></span> <span data-ttu-id="2bc54-112">また、HTML 5 と CSS3 は、豊富な Ui の作成を容易にします。</span><span class="sxs-lookup"><span data-stu-id="2bc54-112">Also, HTML 5 and CSS3 are making it easier to create rich UIs.</span></span>

<span data-ttu-id="2bc54-113">始めるには、SPA テンプレートでサンプルの "To do list" アプリケーションを作成します。</span><span class="sxs-lookup"><span data-stu-id="2bc54-113">To get you started, the SPA template creates a sample "To-do list" application.</span></span> <span data-ttu-id="2bc54-114">このチュートリアルでは、テンプレートのガイドツアーを実行します。</span><span class="sxs-lookup"><span data-stu-id="2bc54-114">In this tutorial, we'll take a guided tour of the template.</span></span> <span data-ttu-id="2bc54-115">まず、To do list アプリケーション自体を見て、それが機能するテクノロジを確認します。</span><span class="sxs-lookup"><span data-stu-id="2bc54-115">First we'll look at the To-do list application itself, then examine the technology pieces that make it work.</span></span>

## <a name="create-a-new-spa-template-project"></a><span data-ttu-id="2bc54-116">新しい SPA テンプレートプロジェクトを作成する</span><span class="sxs-lookup"><span data-stu-id="2bc54-116">Create a New SPA Template Project</span></span>

<span data-ttu-id="2bc54-117">要件:</span><span class="sxs-lookup"><span data-stu-id="2bc54-117">Requirements:</span></span>

- <span data-ttu-id="2bc54-118">Web 用 Visual Studio 2012 または Visual Studio Express 2012</span><span class="sxs-lookup"><span data-stu-id="2bc54-118">Visual Studio 2012 or Visual Studio Express 2012 for Web</span></span>
- <span data-ttu-id="2bc54-119">ASP.NET Web Tools 2012.2 更新プログラム。</span><span class="sxs-lookup"><span data-stu-id="2bc54-119">ASP.NET Web Tools 2012.2 update.</span></span> <span data-ttu-id="2bc54-120">[ここで](https://www.microsoft.com/web/handlers/webpi.ashx?command=getinstallerredirect&appid=ASPDOTNETandWebTools2012_2)更新プログラムをインストールできます。</span><span class="sxs-lookup"><span data-stu-id="2bc54-120">You can install the update [here](https://www.microsoft.com/web/handlers/webpi.ashx?command=getinstallerredirect&appid=ASPDOTNETandWebTools2012_2).</span></span>

<span data-ttu-id="2bc54-121">Visual Studio を起動し、スタートページで **[新しいプロジェクト]** を選択します。</span><span class="sxs-lookup"><span data-stu-id="2bc54-121">Start Visual Studio and select **New Project** from the Start page.</span></span> <span data-ttu-id="2bc54-122">または、 **[ファイル]** メニューの **[新規作成]** をポイントし、 **[プロジェクト]** をクリックします。</span><span class="sxs-lookup"><span data-stu-id="2bc54-122">Or, from the **File** menu, select **New** and then **Project**.</span></span>

<span data-ttu-id="2bc54-123">**[テンプレート]** ペインで、 **[インストールされたテンプレート]** を選択し、  **C#ビジュアル**ノードを展開します。</span><span class="sxs-lookup"><span data-stu-id="2bc54-123">In the **Templates** pane, select **Installed Templates** and expand the **Visual C#** node.</span></span> <span data-ttu-id="2bc54-124">**[ビジュアルC# ]** で **[Web]** を選択します。</span><span class="sxs-lookup"><span data-stu-id="2bc54-124">Under **Visual C#**, select **Web**.</span></span> <span data-ttu-id="2bc54-125">プロジェクトテンプレートの一覧で、 **[ASP.NET MVC 4 Web アプリケーション]** を選択します。</span><span class="sxs-lookup"><span data-stu-id="2bc54-125">In the list of project templates, select **ASP.NET MVC 4 Web Application**.</span></span> <span data-ttu-id="2bc54-126">プロジェクト名を指定して、 **[OK]** をクリックします。</span><span class="sxs-lookup"><span data-stu-id="2bc54-126">Name the project and click **OK**.</span></span>

![](knockoutjs-template/_static/image2.png)

<span data-ttu-id="2bc54-127">**新しいプロジェクト**ウィザードで、 **[シングルページアプリケーション]** を選択します。</span><span class="sxs-lookup"><span data-stu-id="2bc54-127">In the **New Project** wizard, select **Single Page Application**.</span></span>

![](knockoutjs-template/_static/image3.png)

<span data-ttu-id="2bc54-128">F5 キーを押して、アプリケーションをビルドして実行します。</span><span class="sxs-lookup"><span data-stu-id="2bc54-128">Press F5 to build and run the application.</span></span> <span data-ttu-id="2bc54-129">アプリケーションを初めて実行すると、ログイン画面が表示されます。</span><span class="sxs-lookup"><span data-stu-id="2bc54-129">When the application first runs, it displays a login screen.</span></span>

![](knockoutjs-template/_static/image4.png)

<span data-ttu-id="2bc54-130">&quot;サインアップ&quot; リンクをクリックして、新しいユーザーを作成します。</span><span class="sxs-lookup"><span data-stu-id="2bc54-130">Click the &quot;Sign up&quot; link and create a new user.</span></span>

![](knockoutjs-template/_static/image5.png)

<span data-ttu-id="2bc54-131">ログインすると、アプリケーションは2つの項目を含む既定の Todo リストを作成します。</span><span class="sxs-lookup"><span data-stu-id="2bc54-131">After you log in, the application creates a default Todo list with two items.</span></span> <span data-ttu-id="2bc54-132">新しいリストを追加するには、[Todo リストの追加] をクリックします。</span><span class="sxs-lookup"><span data-stu-id="2bc54-132">You can click "Add Todo list" to add a new list.</span></span>

![](knockoutjs-template/_static/image6.png)

<span data-ttu-id="2bc54-133">リストの名前を変更し、リストに項目を追加して、それらのチェックボックスをオフにします。</span><span class="sxs-lookup"><span data-stu-id="2bc54-133">Rename the list, add items to the list, and check them off.</span></span> <span data-ttu-id="2bc54-134">また、項目を削除したり、一覧全体を削除したりすることもできます。</span><span class="sxs-lookup"><span data-stu-id="2bc54-134">You can also delete items or delete an entire list.</span></span> <span data-ttu-id="2bc54-135">変更は、サーバー上のデータベースに自動的に保存されます (アプリケーションをローカルで実行しているため、この時点では実際には LocalDB です)。</span><span class="sxs-lookup"><span data-stu-id="2bc54-135">The changes are automatically persisted to a database on the server (actually LocalDB at this point, because you are running the application locally).</span></span>

![](knockoutjs-template/_static/image7.png)

## <a name="architecture-of-the-spa-template"></a><span data-ttu-id="2bc54-136">SPA テンプレートのアーキテクチャ</span><span class="sxs-lookup"><span data-stu-id="2bc54-136">Architecture of the SPA Template</span></span>

<span data-ttu-id="2bc54-137">次の図は、アプリケーションの主な構成要素を示しています。</span><span class="sxs-lookup"><span data-stu-id="2bc54-137">This diagram shows the main building blocks for the application.</span></span>

![](knockoutjs-template/_static/image8.png)

<span data-ttu-id="2bc54-138">サーバー側では、ASP.NET MVC は HTML を提供し、フォームベースの認証も処理します。</span><span class="sxs-lookup"><span data-stu-id="2bc54-138">On the server side, ASP.NET MVC serves the HTML and also handles forms-based authentication.</span></span>

<span data-ttu-id="2bc54-139">ASP.NET Web API は、ToDoLists と ToDoItems に関連するすべての要求を処理します。これには、取得、作成、更新、および削除が含まれます。</span><span class="sxs-lookup"><span data-stu-id="2bc54-139">ASP.NET Web API handles all requests that relate to the ToDoLists and ToDoItems, including getting, creating, updating and deleting.</span></span> <span data-ttu-id="2bc54-140">クライアントは、JSON 形式の Web API とデータを交換します。</span><span class="sxs-lookup"><span data-stu-id="2bc54-140">The client exchanges data with Web API in JSON format.</span></span>

<span data-ttu-id="2bc54-141">Entity Framework (EF) は、O/RM レイヤーです。</span><span class="sxs-lookup"><span data-stu-id="2bc54-141">Entity Framework (EF) is the O/RM layer.</span></span> <span data-ttu-id="2bc54-142">ASP.NET のオブジェクト指向の世界と基になるデータベースを仲介します。</span><span class="sxs-lookup"><span data-stu-id="2bc54-142">It mediates between the object-oriented world of ASP.NET and the underlying database.</span></span> <span data-ttu-id="2bc54-143">データベースは LocalDB を使用しますが、これは web.config ファイルで変更できます。</span><span class="sxs-lookup"><span data-stu-id="2bc54-143">The database uses LocalDB but you can change this in the Web.config file.</span></span> <span data-ttu-id="2bc54-144">通常は、ローカル開発に LocalDB を使用してから、EF code first の移行を使用してサーバー上の SQL データベースに配置します。</span><span class="sxs-lookup"><span data-stu-id="2bc54-144">Typically you would use LocalDB for local development and then deploy to a SQL database on the server, using EF code-first migration.</span></span>

<span data-ttu-id="2bc54-145">クライアント側では、node.js ライブラリが AJAX 要求からページの更新を処理します。</span><span class="sxs-lookup"><span data-stu-id="2bc54-145">On the client side, the Knockout.js library handles page updates from AJAX requests.</span></span> <span data-ttu-id="2bc54-146">ノックアウトでは、データバインディングを使用して、ページと最新のデータを同期します。</span><span class="sxs-lookup"><span data-stu-id="2bc54-146">Knockout uses data binding to synchronize the page with the latest data.</span></span> <span data-ttu-id="2bc54-147">このようにして、JSON データを処理するコードを記述して DOM を更新する必要はありません。</span><span class="sxs-lookup"><span data-stu-id="2bc54-147">That way, you don't have to write any of the code that walks through the JSON data and updates the DOM.</span></span> <span data-ttu-id="2bc54-148">代わりに、データを表示する方法をノックアウトするように、宣言型の属性を HTML に配置します。</span><span class="sxs-lookup"><span data-stu-id="2bc54-148">Instead, you put declarative attributes in the HTML that tell Knockout how to present the data.</span></span>

<span data-ttu-id="2bc54-149">このアーキテクチャの大きな利点は、プレゼンテーション層とアプリケーションロジックが分離されていることです。</span><span class="sxs-lookup"><span data-stu-id="2bc54-149">A big advantage of this architecture is that it separates the presentation layer from the application logic.</span></span> <span data-ttu-id="2bc54-150">Web ページがどのように表示されるかを知らなくても、Web API の部分を作成できます。</span><span class="sxs-lookup"><span data-stu-id="2bc54-150">You can create the Web API portion without knowing anything about how your web page will look.</span></span> <span data-ttu-id="2bc54-151">クライアント側では、データを表す "ビューモデル" を作成し、ビューモデルがノックアウトを使用して HTML にバインドします。</span><span class="sxs-lookup"><span data-stu-id="2bc54-151">On the client side, you create a "view model" to represent that data, and the view model uses Knockout to bind to the HTML.</span></span> <span data-ttu-id="2bc54-152">これにより、ビューモデルを変更せずに HTML を簡単に変更できます。</span><span class="sxs-lookup"><span data-stu-id="2bc54-152">That lets you easily change the HTML without changing the view model.</span></span> <span data-ttu-id="2bc54-153">(後でもう少しノックアウトを見てみましょう)。</span><span class="sxs-lookup"><span data-stu-id="2bc54-153">(We'll look at Knockout a bit later.)</span></span>

## <a name="models"></a><span data-ttu-id="2bc54-154">モデル</span><span class="sxs-lookup"><span data-stu-id="2bc54-154">Models</span></span>

<span data-ttu-id="2bc54-155">Visual Studio プロジェクトの [モデル] フォルダーには、サーバー側で使用されるモデルが含まれています。</span><span class="sxs-lookup"><span data-stu-id="2bc54-155">In the Visual Studio project, the Models folder contains the models that are used on the server side.</span></span> <span data-ttu-id="2bc54-156">(クライアント側にもモデルがあります。これらのモデルについて説明します)。</span><span class="sxs-lookup"><span data-stu-id="2bc54-156">(There are also models on the client side; we'll get to those.)</span></span>

![](knockoutjs-template/_static/image9.png)

<span data-ttu-id="2bc54-157">**TodoItem、TodoList**</span><span class="sxs-lookup"><span data-stu-id="2bc54-157">**TodoItem, TodoList**</span></span>

<span data-ttu-id="2bc54-158">これらは、Entity Framework Code First のデータベースモデルです。</span><span class="sxs-lookup"><span data-stu-id="2bc54-158">These are the database models for Entity Framework Code First.</span></span> <span data-ttu-id="2bc54-159">これらのモデルには、互いを指し示すプロパティがあることに注意してください。</span><span class="sxs-lookup"><span data-stu-id="2bc54-159">Notice that these models have properties that point to each other.</span></span> <span data-ttu-id="2bc54-160">`ToDoList` には ToDoItems のコレクションが含まれ、各 `ToDoItem` には親の ToDoList への参照があります。</span><span class="sxs-lookup"><span data-stu-id="2bc54-160">`ToDoList` contains a collection of ToDoItems, and each `ToDoItem` has a reference back to its parent ToDoList.</span></span> <span data-ttu-id="2bc54-161">これらのプロパティはナビゲーションプロパティと呼ばれ、一対多の関係、to do リスト、およびその to do 項目を表します。</span><span class="sxs-lookup"><span data-stu-id="2bc54-161">These properties are called navigation properties, and they represent the one-to-many relation a to-do list and its to-do items.</span></span>

<span data-ttu-id="2bc54-162">また `ToDoItem` クラスでは、 **[ForeignKey]** 属性を使用して、`ToDoListId` が `ToDoList` テーブルの外部キーであることを指定します。</span><span class="sxs-lookup"><span data-stu-id="2bc54-162">The `ToDoItem` class also uses the **[ForeignKey]** attribute to specify that `ToDoListId` is a foreign key into the `ToDoList` table.</span></span> <span data-ttu-id="2bc54-163">これは、データベースに外部キー制約を追加するように EF に指示します。</span><span class="sxs-lookup"><span data-stu-id="2bc54-163">This tells EF to add a foreign-key constraint to the database.</span></span>

[!code-csharp[Main](knockoutjs-template/samples/sample1.cs)]

<span data-ttu-id="2bc54-164">**TodoItemDto, TodoListDto**</span><span class="sxs-lookup"><span data-stu-id="2bc54-164">**TodoItemDto, TodoListDto**</span></span>

<span data-ttu-id="2bc54-165">これらのクラスは、クライアントに送信されるデータを定義します。</span><span class="sxs-lookup"><span data-stu-id="2bc54-165">These classes define the data that will be sent to the client.</span></span> <span data-ttu-id="2bc54-166">"DTO" は "データ転送オブジェクト" を表します。</span><span class="sxs-lookup"><span data-stu-id="2bc54-166">"DTO" stands for "data transfer object."</span></span> <span data-ttu-id="2bc54-167">DTO は、エンティティを JSON にシリアル化する方法を定義します。</span><span class="sxs-lookup"><span data-stu-id="2bc54-167">The DTO defines how the entities will be serialized into JSON.</span></span> <span data-ttu-id="2bc54-168">通常、Dto を使用する理由はいくつかあります。</span><span class="sxs-lookup"><span data-stu-id="2bc54-168">In general, there are several reasons to use DTOs:</span></span>

- <span data-ttu-id="2bc54-169">シリアル化するプロパティを制御します。</span><span class="sxs-lookup"><span data-stu-id="2bc54-169">To control which properties are serialized.</span></span> <span data-ttu-id="2bc54-170">DTO には、ドメインモデルのプロパティのサブセットを含めることができます。</span><span class="sxs-lookup"><span data-stu-id="2bc54-170">The DTO can contain a subset of the properties from the domain model.</span></span> <span data-ttu-id="2bc54-171">これは、セキュリティ上の理由 (機密データを非表示にするため) または単に送信するデータの量を減らすために行うことができます。</span><span class="sxs-lookup"><span data-stu-id="2bc54-171">You might do this for security reasons (to hide sensitive data) or simply to reduce the amount of data that you send.</span></span>
- <span data-ttu-id="2bc54-172">データの形状を変更する場合 (たとえば、より複雑なデータ構造をフラット化する場合)。</span><span class="sxs-lookup"><span data-stu-id="2bc54-172">To change the shape of the data – e.g. to flatten a more complex data structure.</span></span>
- <span data-ttu-id="2bc54-173">DTO からビジネスロジックを維持する (懸念事項の分離)。</span><span class="sxs-lookup"><span data-stu-id="2bc54-173">To keep any business logic out of the DTO (separation of concerns).</span></span>
- <span data-ttu-id="2bc54-174">何らかの理由でドメインモデルをシリアル化できない場合。</span><span class="sxs-lookup"><span data-stu-id="2bc54-174">If your domain models cannot be serialized for some reason.</span></span> <span data-ttu-id="2bc54-175">たとえば、循環参照では、オブジェクトをシリアル化するときに問題が発生する可能性があります。 Web API でこの問題を処理する方法があります (「[循環オブジェクト参照の処理](../../../web-api/overview/formats-and-model-binding/json-and-xml-serialization.md#handling_circular_object_references)」を参照してください)。しかし、DTO を使用すると、単に問題を回避できます。</span><span class="sxs-lookup"><span data-stu-id="2bc54-175">For example, circular references can cause problems when you serialize an object There are ways to handle this problem in Web API (see [Handling Circular Object References](../../../web-api/overview/formats-and-model-binding/json-and-xml-serialization.md#handling_circular_object_references)); but using a DTO simply avoids the problem altogether.</span></span>

<span data-ttu-id="2bc54-176">SPA テンプレートでは、Dto にはドメインモデルと同じデータが含まれています。</span><span class="sxs-lookup"><span data-stu-id="2bc54-176">In the SPA template, the DTOs contains the same data as the domain models.</span></span> <span data-ttu-id="2bc54-177">ただし、これらはナビゲーションプロパティからの循環参照を避け、一般的な DTO パターンを示すため便利です。</span><span class="sxs-lookup"><span data-stu-id="2bc54-177">However, they are still useful because they avoid circular references from the navigation properties, and they demonstrate the general DTO pattern.</span></span>

<span data-ttu-id="2bc54-178">**AccountModels.cs**</span><span class="sxs-lookup"><span data-stu-id="2bc54-178">**AccountModels.cs**</span></span>

<span data-ttu-id="2bc54-179">このファイルには、サイトメンバーシップのモデルが含まれています。</span><span class="sxs-lookup"><span data-stu-id="2bc54-179">This file contains models for site membership.</span></span> <span data-ttu-id="2bc54-180">`UserProfile` クラスは、メンバーシップデータベース内のユーザープロファイルのスキーマを定義します。</span><span class="sxs-lookup"><span data-stu-id="2bc54-180">The `UserProfile` class defines the schema for user profiles in the membership DB.</span></span> <span data-ttu-id="2bc54-181">(この場合、唯一の情報は、ユーザー ID とユーザー名です)。このファイル内の他のモデルクラスを使用して、ユーザー登録フォームとログインフォームを作成します。</span><span class="sxs-lookup"><span data-stu-id="2bc54-181">(In this case, the only information is the user ID and the user name.) The other model classes in this file are used to create the user registration and login forms.</span></span>

## <a name="entity-framework"></a><span data-ttu-id="2bc54-182">Entity Framework</span><span class="sxs-lookup"><span data-stu-id="2bc54-182">Entity Framework</span></span>

<span data-ttu-id="2bc54-183">SPA テンプレートは EF Code First を使用します。</span><span class="sxs-lookup"><span data-stu-id="2bc54-183">The SPA template uses EF Code First.</span></span> <span data-ttu-id="2bc54-184">Code First 開発では、まずコードでモデルを定義し、次に EF でモデルを使用してデータベースを作成します。</span><span class="sxs-lookup"><span data-stu-id="2bc54-184">In Code First development, you define the models first in code, and then EF uses the model to create the database.</span></span> <span data-ttu-id="2bc54-185">EF は、既存のデータベース ([Database First](https://msdn.microsoft.com/data/jj206878.aspx)) と共に使用することもできます。</span><span class="sxs-lookup"><span data-stu-id="2bc54-185">You can also use EF with an existing database ([Database First](https://msdn.microsoft.com/data/jj206878.aspx)).</span></span>

<span data-ttu-id="2bc54-186">[モデル] フォルダー内の `TodoItemContext` クラスは、 **Dbcontext**から派生します。</span><span class="sxs-lookup"><span data-stu-id="2bc54-186">The `TodoItemContext` class in the Models folder derives from **DbContext**.</span></span> <span data-ttu-id="2bc54-187">このクラスは、モデルと EF の間に "グルー" を提供します。</span><span class="sxs-lookup"><span data-stu-id="2bc54-187">This class provides the "glue" between the models and EF.</span></span> <span data-ttu-id="2bc54-188">`TodoItemContext` には `ToDoItem` コレクションと `TodoList` コレクションが格納されます。</span><span class="sxs-lookup"><span data-stu-id="2bc54-188">The `TodoItemContext` holds a `ToDoItem` collection and a `TodoList` collection.</span></span> <span data-ttu-id="2bc54-189">データベースに対してクエリを実行するには、これらのコレクションに対して LINQ クエリを記述するだけです。</span><span class="sxs-lookup"><span data-stu-id="2bc54-189">To query the database, you simply write a LINQ query against these collections.</span></span> <span data-ttu-id="2bc54-190">たとえば、ユーザー "Alice" の to do リストをすべて選択するには、次のようにします。</span><span class="sxs-lookup"><span data-stu-id="2bc54-190">For example, here is how you can select all of the to-do lists for user "Alice":</span></span>

[!code-csharp[Main](knockoutjs-template/samples/sample2.cs)]

<span data-ttu-id="2bc54-191">また、コレクションに新しい項目を追加したり、項目を更新したり、コレクションから項目を削除したりして、変更をデータベースに保持することもできます。</span><span class="sxs-lookup"><span data-stu-id="2bc54-191">You can also add new items to the collection, update items, or delete items from the collection, and persist the changes to the database.</span></span>

## <a name="aspnet-web-api-controllers"></a><span data-ttu-id="2bc54-192">ASP.NET Web API コントローラー</span><span class="sxs-lookup"><span data-stu-id="2bc54-192">ASP.NET Web API Controllers</span></span>

<span data-ttu-id="2bc54-193">ASP.NET Web API では、コントローラーは HTTP 要求を処理するオブジェクトです。</span><span class="sxs-lookup"><span data-stu-id="2bc54-193">In ASP.NET Web API, controllers are objects that handle HTTP requests.</span></span> <span data-ttu-id="2bc54-194">前述のように、SPA テンプレートでは、Web API を使用して `ToDoList` および `ToDoItem` インスタンスで CRUD 操作を有効にします。</span><span class="sxs-lookup"><span data-stu-id="2bc54-194">As mentioned, the SPA template uses Web API to enable CRUD operations on `ToDoList` and `ToDoItem` instances.</span></span> <span data-ttu-id="2bc54-195">コントローラーは、ソリューションの Controllers フォルダーに配置されます。</span><span class="sxs-lookup"><span data-stu-id="2bc54-195">The controllers are located in the Controllers folder of the solution.</span></span>

![](knockoutjs-template/_static/image10.png)

- <span data-ttu-id="2bc54-196">`TodoController`: to do 項目に対する HTTP 要求を処理します</span><span class="sxs-lookup"><span data-stu-id="2bc54-196">`TodoController`: Handles HTTP requests for to-do items</span></span>
- <span data-ttu-id="2bc54-197">`TodoListController`: to do リストに対する HTTP 要求を処理します。</span><span class="sxs-lookup"><span data-stu-id="2bc54-197">`TodoListController`: Handles HTTP requests for to-do lists.</span></span>

<span data-ttu-id="2bc54-198">これらの名前は、Web API が URI パスをコントローラー名と照合するため、重要です。</span><span class="sxs-lookup"><span data-stu-id="2bc54-198">These names are significant, because Web API matches the URI path to the controller name.</span></span> <span data-ttu-id="2bc54-199">(Web API が HTTP 要求をコントローラーにルーティングする方法については、「 [ASP.NET Web API でのルーティング](../../../web-api/overview/web-api-routing-and-actions/routing-in-aspnet-web-api.md)」を参照してください)。</span><span class="sxs-lookup"><span data-stu-id="2bc54-199">(To learn how Web API routes HTTP requests to controllers, see [Routing in ASP.NET Web API](../../../web-api/overview/web-api-routing-and-actions/routing-in-aspnet-web-api.md).)</span></span>

<span data-ttu-id="2bc54-200">`ToDoListController` クラスを見てみましょう。</span><span class="sxs-lookup"><span data-stu-id="2bc54-200">Let's look at the `ToDoListController` class.</span></span> <span data-ttu-id="2bc54-201">1つのデータメンバーが含まれています。</span><span class="sxs-lookup"><span data-stu-id="2bc54-201">It contains a single data member:</span></span>

[!code-csharp[Main](knockoutjs-template/samples/sample3.cs)]

<span data-ttu-id="2bc54-202">前に説明したように、`TodoItemContext` は EF との通信に使用されます。</span><span class="sxs-lookup"><span data-stu-id="2bc54-202">The `TodoItemContext` is used to communicate with EF, as described earlier.</span></span> <span data-ttu-id="2bc54-203">コントローラーのメソッドは CRUD 操作を実装します。</span><span class="sxs-lookup"><span data-stu-id="2bc54-203">The methods on the controller implement the CRUD operations.</span></span> <span data-ttu-id="2bc54-204">Web API は、次のように、クライアントからの HTTP 要求をコントローラーメソッドにマップします。</span><span class="sxs-lookup"><span data-stu-id="2bc54-204">Web API maps HTTP requests from the client to controller methods, as follows:</span></span>

| <span data-ttu-id="2bc54-205">HTTP 要求</span><span class="sxs-lookup"><span data-stu-id="2bc54-205">HTTP Request</span></span> | <span data-ttu-id="2bc54-206">コントローラーメソッド</span><span class="sxs-lookup"><span data-stu-id="2bc54-206">Controller Method</span></span> | <span data-ttu-id="2bc54-207">Description</span><span class="sxs-lookup"><span data-stu-id="2bc54-207">Description</span></span> |
| --- | --- | --- |
| <span data-ttu-id="2bc54-208">GET /api/todo</span><span class="sxs-lookup"><span data-stu-id="2bc54-208">GET /api/todo</span></span> | `GetTodoLists` | <span data-ttu-id="2bc54-209">To do リストのコレクションを取得します。</span><span class="sxs-lookup"><span data-stu-id="2bc54-209">Gets a collection of to-do lists.</span></span> |
| <span data-ttu-id="2bc54-210">/Api/todo/*id*の取得</span><span class="sxs-lookup"><span data-stu-id="2bc54-210">GET /api/todo/*id*</span></span> | `GetTodoList` | <span data-ttu-id="2bc54-211">ID を使って to do リストを取得します</span><span class="sxs-lookup"><span data-stu-id="2bc54-211">Gets a to-do list by ID</span></span> |
| <span data-ttu-id="2bc54-212">PUT/api/todo/*id*</span><span class="sxs-lookup"><span data-stu-id="2bc54-212">PUT /api/todo/*id*</span></span> | `PutTodoList` | <span data-ttu-id="2bc54-213">To do リストを更新します。</span><span class="sxs-lookup"><span data-stu-id="2bc54-213">Updates a to-do list.</span></span> |
| <span data-ttu-id="2bc54-214">POST /api/todo</span><span class="sxs-lookup"><span data-stu-id="2bc54-214">POST /api/todo</span></span> | `PostTodoList` | <span data-ttu-id="2bc54-215">新しい to do リストを作成します。</span><span class="sxs-lookup"><span data-stu-id="2bc54-215">Creates a new to-do list.</span></span> |
| <span data-ttu-id="2bc54-216">/Api/todo/*id*の削除</span><span class="sxs-lookup"><span data-stu-id="2bc54-216">DELETE /api/todo/*id*</span></span> | `DeleteTodoList` | <span data-ttu-id="2bc54-217">TODO リストを削除します。</span><span class="sxs-lookup"><span data-stu-id="2bc54-217">Deletes a TODO list.</span></span> |

<span data-ttu-id="2bc54-218">一部の操作の Uri には、ID 値のプレースホルダーが含まれていることに注意してください。</span><span class="sxs-lookup"><span data-stu-id="2bc54-218">Notice that the URIs for some operations contain placeholders for the ID value.</span></span> <span data-ttu-id="2bc54-219">たとえば、ID が42の to リストを削除するには、URI を `/api/todo/42`します。</span><span class="sxs-lookup"><span data-stu-id="2bc54-219">For example, to delete a to-list with an ID of 42, the URI is `/api/todo/42`.</span></span>

<span data-ttu-id="2bc54-220">CRUD 操作に Web API を使用する方法の詳細については、「 [Crud 操作をサポートする WEB api の作成](../../../web-api/overview/older-versions/creating-a-web-api-that-supports-crud-operations.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="2bc54-220">To learn more about using Web API for CRUD operations, see [Creating a Web API that Supports CRUD Operations](../../../web-api/overview/older-versions/creating-a-web-api-that-supports-crud-operations.md).</span></span> <span data-ttu-id="2bc54-221">このコントローラーのコードは非常に簡単です。</span><span class="sxs-lookup"><span data-stu-id="2bc54-221">The code for this controller is fairly straightforward.</span></span> <span data-ttu-id="2bc54-222">いくつかの興味深い点を次に示します。</span><span class="sxs-lookup"><span data-stu-id="2bc54-222">Here are some interesting points:</span></span>

- <span data-ttu-id="2bc54-223">`GetTodoLists` メソッドは、LINQ クエリを使用して、ログインしているユーザーの ID で結果をフィルター処理します。</span><span class="sxs-lookup"><span data-stu-id="2bc54-223">The `GetTodoLists` method uses a LINQ query to filter the results by the ID of the logged-in user.</span></span> <span data-ttu-id="2bc54-224">そうすることで、ユーザーは自分に属するデータだけを見ることができます。</span><span class="sxs-lookup"><span data-stu-id="2bc54-224">That way, a user only sees the data that belongs to him or her.</span></span> <span data-ttu-id="2bc54-225">また、Select ステートメントを使用して、`ToDoList` インスタンスを `TodoListDto` インスタンスに変換することにも注意してください。</span><span class="sxs-lookup"><span data-stu-id="2bc54-225">Also, notice that a Select statement is used to convert the `ToDoList` instances into `TodoListDto` instances.</span></span>
- <span data-ttu-id="2bc54-226">PUT メソッドと POST メソッドは、データベースを変更する前にモデルの状態を確認します。</span><span class="sxs-lookup"><span data-stu-id="2bc54-226">The PUT and POST methods check the model state before modifying the database.</span></span> <span data-ttu-id="2bc54-227">**Modelstate. IsValid**が false の場合、これらのメソッドは HTTP 400、Bad Request を返します。</span><span class="sxs-lookup"><span data-stu-id="2bc54-227">If **ModelState.IsValid** is false, these methods return HTTP 400, Bad Request.</span></span> <span data-ttu-id="2bc54-228">モデルの検証の詳細については、「モデルの検証」を[参照して](../../../web-api/overview/formats-and-model-binding/model-validation-in-aspnet-web-api.md)ください。</span><span class="sxs-lookup"><span data-stu-id="2bc54-228">Read more about model validation in Web API at [Model Validation](../../../web-api/overview/formats-and-model-binding/model-validation-in-aspnet-web-api.md).</span></span>
- <span data-ttu-id="2bc54-229">コントローラークラスも **[承認]** 属性で修飾されています。</span><span class="sxs-lookup"><span data-stu-id="2bc54-229">The controller class is also decorated with the **[Authorize]** attribute.</span></span> <span data-ttu-id="2bc54-230">この属性は、HTTP 要求が認証されているかどうかを確認します。</span><span class="sxs-lookup"><span data-stu-id="2bc54-230">This attribute checks whether the HTTP request is authenticated.</span></span> <span data-ttu-id="2bc54-231">要求が認証されていない場合、クライアントは、許可されていない HTTP 401 を受信します。</span><span class="sxs-lookup"><span data-stu-id="2bc54-231">If the request is not authenticated, the client receives HTTP 401, Unauthorized.</span></span> <span data-ttu-id="2bc54-232">認証と承認の詳細について[は、ASP.NET Web API を](../../../web-api/overview/security/authentication-and-authorization-in-aspnet-web-api.md)参照してください。</span><span class="sxs-lookup"><span data-stu-id="2bc54-232">Read more about authentication at [Authentication and Authorization in ASP.NET Web API](../../../web-api/overview/security/authentication-and-authorization-in-aspnet-web-api.md).</span></span>

<span data-ttu-id="2bc54-233">`TodoController` クラスは `TodoListController`とよく似ています。</span><span class="sxs-lookup"><span data-stu-id="2bc54-233">The `TodoController` class is very similar to `TodoListController`.</span></span> <span data-ttu-id="2bc54-234">最大の違いは、クライアントが to do 項目を各 to do リストと共に取得するため、GET メソッドが定義されていないことです。</span><span class="sxs-lookup"><span data-stu-id="2bc54-234">The biggest difference is that it does not define any GET methods, because the client will get the to-do items along with each to-do list.</span></span>

## <a name="mvc-controllers-and-views"></a><span data-ttu-id="2bc54-235">MVC コントローラーとビュー</span><span class="sxs-lookup"><span data-stu-id="2bc54-235">MVC Controllers and Views</span></span>

<span data-ttu-id="2bc54-236">MVC コントローラーは、ソリューションの Controllers フォルダーにもあります。</span><span class="sxs-lookup"><span data-stu-id="2bc54-236">The MVC controllers are also located in the Controllers folder of the solution.</span></span> <span data-ttu-id="2bc54-237">`HomeController` は、アプリケーションのメインの HTML をレンダリングします。</span><span class="sxs-lookup"><span data-stu-id="2bc54-237">`HomeController` renders the main HTML for the application.</span></span> <span data-ttu-id="2bc54-238">Home コントローラーのビューは、Views/Home/Index. cshtml に定義されています。</span><span class="sxs-lookup"><span data-stu-id="2bc54-238">The view for the Home controller is defined in Views/Home/Index.cshtml.</span></span> <span data-ttu-id="2bc54-239">ホームビューでは、ユーザーがログインしているかどうかに応じて、さまざまなコンテンツが表示されます。</span><span class="sxs-lookup"><span data-stu-id="2bc54-239">The Home view renders different content depending on whether the user is logged in:</span></span>

[!code-cshtml[Main](knockoutjs-template/samples/sample4.cshtml)]

<span data-ttu-id="2bc54-240">ユーザーがログインすると、メイン UI が表示されます。</span><span class="sxs-lookup"><span data-stu-id="2bc54-240">When users are logged in, they see the main UI.</span></span> <span data-ttu-id="2bc54-241">それ以外の場合は、[ログイン] パネルが表示されます。</span><span class="sxs-lookup"><span data-stu-id="2bc54-241">Otherwise, they see the login panel.</span></span> <span data-ttu-id="2bc54-242">この条件付きレンダリングはサーバー側で行われることに注意してください。</span><span class="sxs-lookup"><span data-stu-id="2bc54-242">Note that this conditional rendering happens on the server side.</span></span> <span data-ttu-id="2bc54-243">クライアント側&#8212;の機密コンテンツを非表示にしないでください。 http 応答で送信されるものは、未加工の http メッセージを監視しているユーザーに表示されます。</span><span class="sxs-lookup"><span data-stu-id="2bc54-243">Never try to hide sensitive content on the client side&#8212;anything that you send in an HTTP response is visible to someone who is watching the raw HTTP messages.</span></span>

## <a name="client-side-javascript-and-knockoutjs"></a><span data-ttu-id="2bc54-244">クライアント側の JavaScript とノックアウト</span><span class="sxs-lookup"><span data-stu-id="2bc54-244">Client-Side JavaScript and Knockout.js</span></span>

<span data-ttu-id="2bc54-245">次に、アプリケーションのサーバー側からクライアントに切り替えます。</span><span class="sxs-lookup"><span data-stu-id="2bc54-245">Now let's turn from the server side of the application to the client.</span></span> <span data-ttu-id="2bc54-246">SPA テンプレートでは、jQuery とノックアウトの組み合わせを使用して、スムーズで対話型の UI を作成します。</span><span class="sxs-lookup"><span data-stu-id="2bc54-246">The SPA template uses a combination of jQuery and Knockout.js to create a smooth, interactive UI.</span></span> <span data-ttu-id="2bc54-247">ノックアウトは、HTML をデータに簡単にバインドできる JavaScript ライブラリです。</span><span class="sxs-lookup"><span data-stu-id="2bc54-247">Knockout.js is a JavaScript library that makes it easy to bind HTML to data.</span></span> <span data-ttu-id="2bc54-248">ノックアウトは、"モデルビュービューモデル" と呼ばれるパターンを使用します。</span><span class="sxs-lookup"><span data-stu-id="2bc54-248">Knockout.js uses a pattern called "Model-View-ViewModel."</span></span>

- <span data-ttu-id="2bc54-249">モデルはドメインデータ (ToDo リストと ToDo 項目) です。</span><span class="sxs-lookup"><span data-stu-id="2bc54-249">The model is the domain data (ToDo lists and ToDo items).</span></span>
- <span data-ttu-id="2bc54-250">ビューは HTML ドキュメントです。</span><span class="sxs-lookup"><span data-stu-id="2bc54-250">The view is the HTML document.</span></span>
- <span data-ttu-id="2bc54-251">ビューモデルは、モデルデータを保持する JavaScript オブジェクトです。</span><span class="sxs-lookup"><span data-stu-id="2bc54-251">The view-model is a JavaScript object that holds the model data.</span></span> <span data-ttu-id="2bc54-252">ビューモデルは、UI のコード抽象化です。</span><span class="sxs-lookup"><span data-stu-id="2bc54-252">The view-model is a code abstraction of the UI.</span></span> <span data-ttu-id="2bc54-253">HTML 表現に関する情報はありません。</span><span class="sxs-lookup"><span data-stu-id="2bc54-253">It has no knowledge of the HTML representation.</span></span> <span data-ttu-id="2bc54-254">代わりに、"ToDo 項目のリスト" など、ビューの抽象的な機能を表します。</span><span class="sxs-lookup"><span data-stu-id="2bc54-254">Instead, it represents abstract features of the view, such as "a list of ToDo items".</span></span>

<span data-ttu-id="2bc54-255">ビューは、ビューモデルにデータバインドされています。</span><span class="sxs-lookup"><span data-stu-id="2bc54-255">The view is data-bound to the view-model.</span></span> <span data-ttu-id="2bc54-256">ビューモデルに対する更新は、自動的にビューに反映されます。</span><span class="sxs-lookup"><span data-stu-id="2bc54-256">Updates to the view-model are automatically reflected in the view.</span></span> <span data-ttu-id="2bc54-257">バインドも同様に機能します。</span><span class="sxs-lookup"><span data-stu-id="2bc54-257">Bindings work the other direction as well.</span></span> <span data-ttu-id="2bc54-258">DOM 内のイベント (クリックなど) は、AJAX 呼び出しをトリガーするビューモデルの関数にデータバインドされます。</span><span class="sxs-lookup"><span data-stu-id="2bc54-258">Events in the DOM (such as clicks) are data-bound to functions on the view model, which trigger AJAX calls.</span></span>

<span data-ttu-id="2bc54-259">SPA テンプレートでは、クライアント側の JavaScript が次の3つのレイヤーに編成されます。</span><span class="sxs-lookup"><span data-stu-id="2bc54-259">The SPA template organizes the client-side JavaScript into three layers:</span></span>

- <span data-ttu-id="2bc54-260">todo. datacontext: AJAX 要求を送信します。</span><span class="sxs-lookup"><span data-stu-id="2bc54-260">todo.datacontext.js: Sends AJAX requests.</span></span>
- <span data-ttu-id="2bc54-261">todo: モデルを定義します。</span><span class="sxs-lookup"><span data-stu-id="2bc54-261">todo.model.js: Defines the models.</span></span>
- <span data-ttu-id="2bc54-262">todo。ビューモデルを定義します。</span><span class="sxs-lookup"><span data-stu-id="2bc54-262">todo.viewmodel.js: Defines the view model.</span></span>

![](knockoutjs-template/_static/image11.png)

<span data-ttu-id="2bc54-263">これらのスクリプトファイルは、ソリューションの Scripts/app フォルダーにあります。</span><span class="sxs-lookup"><span data-stu-id="2bc54-263">These script files are located in the Scripts/app folder of the solution.</span></span>

![](knockoutjs-template/_static/image12.png)

<span data-ttu-id="2bc54-264">**todo. datacontext**は、Web API コントローラーに対するすべての AJAX 呼び出しを処理します。</span><span class="sxs-lookup"><span data-stu-id="2bc54-264">**todo.datacontext** handles all AJAX calls to the Web API controllers.</span></span> <span data-ttu-id="2bc54-265">(ログインのための AJAX 呼び出しは、ajaxlogin 内の他の場所で定義されています)。</span><span class="sxs-lookup"><span data-stu-id="2bc54-265">(The AJAX calls for logging in are defined elsewhere, in ajaxlogin.js.)</span></span>

<span data-ttu-id="2bc54-266">**todo。モデル**は、to do リストのクライアント側 (ブラウザー) モデルを定義します。</span><span class="sxs-lookup"><span data-stu-id="2bc54-266">**todo.model.js** defines the client-side (browser) models for the to-do lists.</span></span> <span data-ttu-id="2bc54-267">モデルクラスには、todoItem と todoList の2つがあります。</span><span class="sxs-lookup"><span data-stu-id="2bc54-267">There are two model classes: todoItem and todoList.</span></span>

<span data-ttu-id="2bc54-268">モデルクラスのプロパティの多くは、"ko" 型です。</span><span class="sxs-lookup"><span data-stu-id="2bc54-268">Many of the properties in the model classes are of type "ko.observable".</span></span> <span data-ttu-id="2bc54-269">Observable は、ノックアウトがどのようにマジックを行うかを示します。</span><span class="sxs-lookup"><span data-stu-id="2bc54-269">Observables are how Knockout does its magic.</span></span> <span data-ttu-id="2bc54-270">[ノックアウトドキュメント](http://knockoutjs.com/documentation/introduction.html)から: 観測可能なは、変更についてサブスクライバーに通知できる "JavaScript オブジェクト" です。</span><span class="sxs-lookup"><span data-stu-id="2bc54-270">From the [Knockout documentation](http://knockoutjs.com/documentation/introduction.html): An observable is a "JavaScript object that can notify subscribers about changes."</span></span> <span data-ttu-id="2bc54-271">観測可能な変更の値を指定すると、observable にバインドされているすべての HTML 要素が更新されます。</span><span class="sxs-lookup"><span data-stu-id="2bc54-271">When the value of an observable changes, Knockout updates any HTML elements that are bound to those observables.</span></span> <span data-ttu-id="2bc54-272">たとえば、todoItem には、title プロパティと isDone プロパティの observable があります。</span><span class="sxs-lookup"><span data-stu-id="2bc54-272">For example, todoItem has observables for the title and isDone properties:</span></span>

[!code-javascript[Main](knockoutjs-template/samples/sample5.js)]

<span data-ttu-id="2bc54-273">また、コードで観測可能なにサブスクライブすることもできます。</span><span class="sxs-lookup"><span data-stu-id="2bc54-273">You can also subscribe to an observable in code.</span></span> <span data-ttu-id="2bc54-274">たとえば、todoItem クラスは、"isDone" プロパティと "title" プロパティの変更をサブスクライブします。</span><span class="sxs-lookup"><span data-stu-id="2bc54-274">For example, the todoItem class subscribes to changes in the "isDone" and "title" properties:</span></span>

[!code-javascript[Main](knockoutjs-template/samples/sample6.js)]

<span data-ttu-id="2bc54-275">**モデルの表示**</span><span class="sxs-lookup"><span data-stu-id="2bc54-275">**View Model**</span></span>

<span data-ttu-id="2bc54-276">ビューモデルは、todo. ビューモデルで定義されます。</span><span class="sxs-lookup"><span data-stu-id="2bc54-276">The view model is defined in todo.viewmodel.js.</span></span> <span data-ttu-id="2bc54-277">ビューモデルは、アプリケーションが HTML ページ要素をドメインデータにバインドする中心点です。</span><span class="sxs-lookup"><span data-stu-id="2bc54-277">The view model is the central point where the application binds the HTML page elements to the domain data.</span></span> <span data-ttu-id="2bc54-278">SPA テンプレートでは、ビューモデルには todoLists の観測可能な配列が含まれています。</span><span class="sxs-lookup"><span data-stu-id="2bc54-278">In the SPA template, the view model contains an observable array of todoLists.</span></span> <span data-ttu-id="2bc54-279">ビューモデルの次のコードは、バインドを適用するようにノックアウトに指示します。</span><span class="sxs-lookup"><span data-stu-id="2bc54-279">The following code in the view model tells Knockout to apply the bindings:</span></span>

[!code-javascript[Main](knockoutjs-template/samples/sample7.js)]

## <a name="html-and-data-binding"></a><span data-ttu-id="2bc54-280">HTML およびデータバインド</span><span class="sxs-lookup"><span data-stu-id="2bc54-280">HTML and Data Binding</span></span>

<span data-ttu-id="2bc54-281">ページのメインの HTML は Views/Home/Index. cshtml に定義されています。</span><span class="sxs-lookup"><span data-stu-id="2bc54-281">The main HTML for the page is defined in Views/Home/Index.cshtml.</span></span> <span data-ttu-id="2bc54-282">データバインディングを使用しているため、HTML は実際に表示される内容のテンプレートにすぎません。</span><span class="sxs-lookup"><span data-stu-id="2bc54-282">Because we are using data-binding, the HTML is only a template for what actually gets rendered.</span></span> <span data-ttu-id="2bc54-283">ノックアウトは*宣言型*のバインドを使用します。</span><span class="sxs-lookup"><span data-stu-id="2bc54-283">Knockout uses *declarative* bindings.</span></span> <span data-ttu-id="2bc54-284">ページ要素をデータにバインドするには、要素に "データバインド" 属性を追加します。</span><span class="sxs-lookup"><span data-stu-id="2bc54-284">You bind page elements to data by adding a "data-bind" attribute to the element.</span></span> <span data-ttu-id="2bc54-285">次に示すのは、ノックアウトドキュメントから取得した非常に単純な例です。</span><span class="sxs-lookup"><span data-stu-id="2bc54-285">Here is a very simple example, taken from the Knockout documentation:</span></span>

[!code-html[Main](knockoutjs-template/samples/sample8.html)]

<span data-ttu-id="2bc54-286">この例では、ノックアウトは `myItems.count()`の値を使用して **&lt;スパン&gt;** 要素の内容を更新します。</span><span class="sxs-lookup"><span data-stu-id="2bc54-286">In this example, Knockout updates the contents of the **&lt;span&gt;** element with the value of `myItems.count()`.</span></span> <span data-ttu-id="2bc54-287">この値が変更されるたびに、抜き合わせによってドキュメントが更新されます。</span><span class="sxs-lookup"><span data-stu-id="2bc54-287">Whenever this value changes, Knockout updates the document.</span></span>

<span data-ttu-id="2bc54-288">ノックアウトは、さまざまな種類のバインドを提供します。</span><span class="sxs-lookup"><span data-stu-id="2bc54-288">Knockout provides a number of different binding types.</span></span> <span data-ttu-id="2bc54-289">SPA テンプレートで使用されるバインドの一部を次に示します。</span><span class="sxs-lookup"><span data-stu-id="2bc54-289">Here are some of the bindings used in the SPA template:</span></span>

- <span data-ttu-id="2bc54-290">**foreach**: ループを反復処理し、リスト内の各項目に同じマークアップを適用できます。</span><span class="sxs-lookup"><span data-stu-id="2bc54-290">**foreach**: Lets you iterate through a loop and apply the same markup to each item in the list.</span></span> <span data-ttu-id="2bc54-291">これは、to do リストと to do 項目を表示するために使用されます。</span><span class="sxs-lookup"><span data-stu-id="2bc54-291">This is used to render the to-do lists and to-do items.</span></span> <span data-ttu-id="2bc54-292">**Foreach**内では、リストの要素にバインドが適用されます。</span><span class="sxs-lookup"><span data-stu-id="2bc54-292">Within the **foreach**, the bindings are applied to the elements of the list.</span></span>
- <span data-ttu-id="2bc54-293">**visible**: 表示/非表示を切り替えるために使用されます。</span><span class="sxs-lookup"><span data-stu-id="2bc54-293">**visible**: Used to toggle visibility.</span></span> <span data-ttu-id="2bc54-294">コレクションが空のときにマークアップを非表示にするか、エラーメッセージを表示します。</span><span class="sxs-lookup"><span data-stu-id="2bc54-294">Hide markup when a collection is empty, or make the error message visible.</span></span>
- <span data-ttu-id="2bc54-295">**value**: フォーム値の設定に使用されます。</span><span class="sxs-lookup"><span data-stu-id="2bc54-295">**value**: Used to populate form values.</span></span>
- <span data-ttu-id="2bc54-296">**クリックし**て、ビューモデルの関数に click イベントをバインドします。</span><span class="sxs-lookup"><span data-stu-id="2bc54-296">**click**: Binds a click event to a function on the view model.</span></span>

## <a name="anti-csrf-protection"></a><span data-ttu-id="2bc54-297">CSRF 防止</span><span class="sxs-lookup"><span data-stu-id="2bc54-297">Anti-CSRF Protection</span></span>

<span data-ttu-id="2bc54-298">クロスサイト要求偽造 (CSRF) は、ユーザーが現在ログインしている脆弱なサイトに、悪意のあるサイトから要求を送信する攻撃です。</span><span class="sxs-lookup"><span data-stu-id="2bc54-298">Cross-Site Request Forgery (CSRF) is an attack where a malicious site sends a request to a vulnerable site where the user is currently logged in.</span></span> <span data-ttu-id="2bc54-299">CSRF 攻撃を防ぐために、ASP.NET MVC では*偽造防止トークン*を使用します。これは、要求検証トークンとも呼ばれます。</span><span class="sxs-lookup"><span data-stu-id="2bc54-299">To help prevent CSRF attacks, ASP.NET MVC uses *anti-forgery tokens*, also called request verification tokens.</span></span> <span data-ttu-id="2bc54-300">これは、サーバーがランダムに生成されたトークンを web ページに配置するということです。</span><span class="sxs-lookup"><span data-stu-id="2bc54-300">The idea is that the server puts a randomly generated token into a web page.</span></span> <span data-ttu-id="2bc54-301">クライアントは、サーバーにデータを送信するときに、要求メッセージにこの値を含める必要があります。</span><span class="sxs-lookup"><span data-stu-id="2bc54-301">When the client submits data to the server, it must include this value in the request message.</span></span>

<span data-ttu-id="2bc54-302">悪意のあるページでは、同じオリジンのポリシーによってユーザーのトークンを読み取ることができないため、偽造防止トークンが機能します。</span><span class="sxs-lookup"><span data-stu-id="2bc54-302">Anti-forgery tokens work because the malicious page cannot read the user's tokens, due to same-origin policies.</span></span> <span data-ttu-id="2bc54-303">(同じオリジンポリシーを利用すると、2つの異なるサイトでホストされているドキュメントから互いのコンテンツにアクセスできなくなります)。</span><span class="sxs-lookup"><span data-stu-id="2bc54-303">(Same-origin policies prevent documents hosted on two different sites from accessing each other's content.)</span></span>

<span data-ttu-id="2bc54-304">ASP.NET MVC では[、偽造防止のクラスと](https://msdn.microsoft.com/library/system.web.helpers.antiforgery.aspx) [[Validateアンチ Forgerytoken]](https://msdn.microsoft.com/library/system.web.mvc.validateantiforgerytokenattribute.aspx)属性を使用して、偽造防止トークンの組み込みサポートを提供しています。</span><span class="sxs-lookup"><span data-stu-id="2bc54-304">ASP.NET MVC provides built-in support for anti-forgery tokens, through the [AntiForgery](https://msdn.microsoft.com/library/system.web.helpers.antiforgery.aspx) class and the [[ValidateAntiForgeryToken]](https://msdn.microsoft.com/library/system.web.mvc.validateantiforgerytokenattribute.aspx) attribute.</span></span> <span data-ttu-id="2bc54-305">現在、この機能は Web API には組み込まれていません。</span><span class="sxs-lookup"><span data-stu-id="2bc54-305">Currently, this functionality is not built into Web API.</span></span> <span data-ttu-id="2bc54-306">ただし、SPA テンプレートには、Web API のカスタム実装が含まれています。</span><span class="sxs-lookup"><span data-stu-id="2bc54-306">However, the SPA template includes a custom implementation for Web API.</span></span> <span data-ttu-id="2bc54-307">このコードは、ソリューションの Filters フォルダーにある `ValidateHttpAntiForgeryTokenAttribute` クラスで定義されています。</span><span class="sxs-lookup"><span data-stu-id="2bc54-307">This code is defined in the `ValidateHttpAntiForgeryTokenAttribute` class, which is located in the Filters folder of the solution.</span></span> <span data-ttu-id="2bc54-308">Web API での CSRF の防止の詳細については、「[クロスサイト要求偽造 (csrf) 攻撃の防止](../../../web-api/overview/security/preventing-cross-site-request-forgery-csrf-attacks.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="2bc54-308">To learn more about anti-CSRF in Web API, see [Preventing Cross-Site Request Forgery (CSRF) Attacks](../../../web-api/overview/security/preventing-cross-site-request-forgery-csrf-attacks.md).</span></span>

## <a name="conclusion"></a><span data-ttu-id="2bc54-309">まとめ</span><span class="sxs-lookup"><span data-stu-id="2bc54-309">Conclusion</span></span>

<span data-ttu-id="2bc54-310">SPA テンプレートは、最新の対話型 web アプリケーションの作成をすぐに開始できるように設計されています。</span><span class="sxs-lookup"><span data-stu-id="2bc54-310">The SPA template is designed to get you started quickly writing modern, interactive web applications.</span></span> <span data-ttu-id="2bc54-311">また、ノックアウトライブラリを使用して、データとアプリケーションロジックからプレゼンテーション (HTML マークアップ) を分離します。</span><span class="sxs-lookup"><span data-stu-id="2bc54-311">It uses the Knockout.js library to separate presentation (HTML markup) from the data and application logic.</span></span> <span data-ttu-id="2bc54-312">ただし、ノックアウトは、SPA の作成に使用できる唯一の JavaScript ライブラリではありません。</span><span class="sxs-lookup"><span data-stu-id="2bc54-312">But Knockout is not the only JavaScript library you can use to create a SPA.</span></span> <span data-ttu-id="2bc54-313">他のオプションを調べる場合は、コミュニティによって[作成された SPA テンプレート](../templates/index.md)を参照してください。</span><span class="sxs-lookup"><span data-stu-id="2bc54-313">If you want to explore some other options, take a look at the [community-created SPA templates](../templates/index.md).</span></span>

---
uid: web-pages/overview/data/7-displaying-data-in-a-chart
title: web ページを使用したグラフでのデータASP.NET表示 (Razor) |マイクロソフトドキュメント
author: rick-anderson
description: この章では、グラフにデータを表示する方法について説明します。 前の章では、データを手動でグリッドに表示する方法を学習しました。 この章では説明します。
ms.author: riande
ms.date: 05/22/2012
ms.assetid: f889fd46-4dac-4ecb-83d8-60e64c22036e
msc.legacyurl: /web-pages/overview/data/7-displaying-data-in-a-chart
msc.type: authoredcontent
ms.openlocfilehash: ad55d4898ee39e0239ef8b0bd5eea6387af3c816
ms.sourcegitcommit: 022f79dbc1350e0c6ffaa1e7e7c6e850cdabf9af
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/17/2020
ms.locfileid: "81542886"
---
# <a name="displaying-data-in-a-chart-with-aspnet-web-pages-razor"></a>ASP.NET Web ページを使用したグラフでのデータの表示 (Razor)

[マイクロソフト](https://github.com/microsoft)

> この記事では、ヘルパーを使用して、グラフを使用して ASP.NET Web ページ (Razor) `Chart` Web サイトでデータを表示する方法について説明します。
> 
> **あなたが学ぶこと:**
> 
> - グラフにデータを表示する方法。
> - 組み込みのテーマを使用してグラフのスタイルを設定する方法。
> - グラフを保存する方法と、パフォーマンスを向上させるためにグラフをキャッシュする方法。
> 
> この記事で紹介されているASP.NETプログラミング機能は次のとおりです。
> 
> - ヘルパー `Chart` 。
> 
> > [!NOTE]
> > この資料の情報は、Web ページ 1.0 および Web ページ 2 ASP.NETに適用されます。

<a id="The_Chart_Helper"></a>
## <a name="the-chart-helper"></a>チャートヘルパー

データをグラフィカルな形式で表示する場合は、ヘルパーを使用`Chart`できます。 ヘルパー`Chart`は、さまざまな種類のグラフでデータを表示するイメージをレンダリングできます。 書式設定とラベル付けの多くのオプションをサポートしています。 この`Chart`支援者は、Microsoft Excel や、面グラフ、棒グラフ、縦棒グラフ、折れ線グラフ、円グラフなどのツール&#8212;、30 種類以上のグラフを表示できます。

| **面グラフ**![の説明 : 面グラフの種類の画像](7-displaying-data-in-a-chart/_static/image1.jpg) | **横棒グラフ**![の説明: 棒グラフの種類の画像](7-displaying-data-in-a-chart/_static/image2.jpg) |
| --- | --- |
| **縦棒グラフ**![の説明 : 縦棒グラフの種類の画像](7-displaying-data-in-a-chart/_static/image3.jpg) | **折れ線グラフ**![の説明: 折れ線グラフの種類の画像](7-displaying-data-in-a-chart/_static/image4.jpg) |
| **円グラフ**![の説明 : 円グラフの種類の画像](7-displaying-data-in-a-chart/_static/image5.jpg) | **株価チャート**![の説明: 株価チャートの種類の画像](7-displaying-data-in-a-chart/_static/image6.jpg) |

### <a name="chart-elements"></a>グラフ要素

グラフには、凡例、軸、系列などのデータと追加要素が表示されます。 次の図は、`Chart`ヘルパーを使用するときにカスタマイズできるグラフ要素の多くを示しています。 この記事では、これらの要素の一部 (すべてではない) を設定する方法について説明します。

![説明: グラフ要素を示す画像](7-displaying-data-in-a-chart/_static/image7.jpg)

<a id="Creating_a_Chart"></a>
## <a name="creating-a-chart-from-data"></a>データからグラフを作成する

グラフに表示するデータは、配列、データベースから返された結果、または XML ファイル内のデータから取得できます。

### <a name="using-an-array"></a>配列の使用

[「Razor 構文を使用した web ページプログラミング ASP.NETの概要](https://go.microsoft.com/fwlink/?LinkId=202890)」で説明したように、配列を使用すると、類似した項目のコレクションを 1 つの変数に格納できます。 配列を使用して、グラフに含めるデータを格納できます。

この手順では、既定のグラフの種類を使用して、配列内のデータからグラフを作成する方法を示します。 また、ページ内にグラフを表示する方法も示します。

1. という名前の新しいファイル*を作成します*。
2. 既存のコンテンツを次の内容に置き換えます。 

    [!code-cshtml[Main](7-displaying-data-in-a-chart/samples/sample1.cshtml)]

    コードは、まず新しいグラフを作成し、その幅と高さを設定します。 この方法を使用して、グラフの`AddTitle`タイトルを指定します。 データを追加するには、 メソッド`AddSeries`を使用します。 この例では、メソッド`name`の 、 `xValue`、`yValues`および の`AddSeries`パラメーターを使用します。 パラメーター`name`は、グラフの凡例に表示されます。 この`xValue`パラメーターには、グラフの横軸に沿って表示されるデータの配列が含まれます。 この`yValues`パラメータには、グラフの垂直ポイントをプロットするために使用されるデータの配列が含まれています。

    この`Write`メソッドは、実際にグラフをレンダリングします。 この場合、グラフの種類を指定していないため、ヘルパーは既定の`Chart`グラフ (縦棒グラフ) をレンダリングします。
3. ブラウザでページを実行します。 ブラウザにグラフが表示されます。 

    ![](7-displaying-data-in-a-chart/_static/image8.jpg)

### <a name="using-a-database-query-for-chart-data"></a>グラフ データに対するデータベース クエリの使用

グラフにする情報がデータベースにある場合は、データベース クエリを実行し、結果のデータを使用してグラフを作成できます。 この手順では[、「Web ページ サイト](https://go.microsoft.com/fwlink/?LinkId=202893)のデータベースの概要」の記事で作成したデータベースのデータを読み取って表示する方法ASP.NET示します。

1. フォルダーが存在しない場合は *、Web\_* サイトのルートにアプリ データ フォルダーを追加します。
2. *[\_アプリ データ*] フォルダで、「Web ページ サイトでのデータベースの操作の概要 」で説明されている*SmallBakery.sdf*という[名前のデータベース](https://go.microsoft.com/fwlink/?LinkId=202893)ファイルASP.NET追加します。
3. という名前の新しいファイル*を作成します*。
4. 既存のコンテンツを次の内容に置き換えます。   

    [!code-cshtml[Main](7-displaying-data-in-a-chart/samples/sample2.cshtml)]

    コードは最初に SmallBakery データベースを開き、 という名前`db`の変数に割り当てます。 この変数は、`Database`データベースの読み取りおよび書き込みに使用できるオブジェクトを表します。 次に、各製品の名前と価格を取得する SQL クエリを実行します。 このコードは、新しいグラフを作成し、グラフの`DataBindTable`メソッドを呼び出してデータベース クエリをそれに渡します。 このメソッドは、`dataSource`クエリのデータに対するパラメータと、グラフの X`xField`軸に使用するデータ列を設定するパラメータの 2 つのパラメーターを受け取ります。

    `DataBindTable`メソッドを使用する代わりに、ヘルパーのメソッドを`AddSeries``Chart`使用できます。 この`AddSeries`メソッドでは、 および`xValue``yValues`パラメーターを設定できます。 たとえば、次のような方法を使用`DataBindTable`する代わりに、

    [!code-css[Main](7-displaying-data-in-a-chart/samples/sample3.css)]

    次のような方法を`AddSeries`使用できます。

    [!code-html[Main](7-displaying-data-in-a-chart/samples/sample4.html)]

    どちらも同じ結果をレンダリングします。 この`AddSeries`方法は、グラフの種類とデータをより明確に指定できるため、より柔軟ですが、柔軟性`DataBindTable`が必要ない場合は、この方法を使用する方が簡単です。
5. ブラウザでページを実行します。 

    ![](7-displaying-data-in-a-chart/_static/image9.jpg)

### <a name="using-xml-data"></a>XML データの使用

グラフ作成の 3 番目のオプションは、XML ファイルをグラフのデータとして使用することです。 これには、XML ファイルにも、XML 構造を記述するスキーマ ファイル (*.xsd*ファイル ) が含まれている必要があります。 この手順では、XML ファイルからデータを読み取る方法を示します。

1. *[\_アプリケーション データ*] フォルダに *、data.xml*という名前の新しい XML ファイルを作成します。
2. 既存の XML を次の XML (架空の会社の従業員に関する XML データ) に置き換えます。 

    [!code-xml[Main](7-displaying-data-in-a-chart/samples/sample5.xml)]
3. *[\_アプリケーション データ*] フォルダに *、data.xsd*という名前の新しい XML ファイルを作成します。 (今回の拡張子は *.xsd*であることに注意してください。
4. 既存の XML を次のように置き換えます。 

    [!code-xml[Main](7-displaying-data-in-a-chart/samples/sample6.xml)]
5. Web サイトのルートで *、ChartDataXML.cshtml*という名前の新しいファイルを作成します。
6. 既存のコンテンツを次の内容に置き換えます。 

    [!code-cshtml[Main](7-displaying-data-in-a-chart/samples/sample7.cshtml)]

    このコードでは、まず`DataSet`オブジェクトを作成します。 このオブジェクトは、XML ファイルから読み取られるデータを管理し、スキーマ ファイルの情報に従って整理するために使用されます。 (コードの先頭にステートメント`using SystemData`が含まれていることに注意してください。 `DataSet`これは、オブジェクトを操作するために必要です。 詳細については、この記事[&quot;の&quot;「ステートメントと完全修飾名の使用](#SB_UsingStatements)」を参照してください)。

    次に、データセットに基`DataView`づいてオブジェクトを作成します。 データビューは、チャートが&#8212;、読み取り、プロットにバインドできるオブジェクトを提供します。 このグラフは、配列データのチャート作成`AddSeries`で先に説明したように、この`xValue``yValues`メソッドを使用してデータにバインド`DataView`されます。

    この例では、特定のグラフの種類を指定する方法も示します。 メソッドにデータが`AddSeries`追加されると、`chartType`パラメーターも円グラフを表示するように設定されます。
7. ブラウザでページを実行します。 

    ![](7-displaying-data-in-a-chart/_static/image10.jpg)

> [!TIP]
> 
> <a id="SB_UsingStatements"></a>
> ### <a name="using-statements-and-fully-qualified-names"></a>"using" ステートメントと完全修飾名
> 
> Razor 構文を使用して Web ページをASP.NETする .NET Framework は、何千ものコンポーネント (クラス) で構成されています。 これらのすべてのクラスを管理しやすくするために、それらはライブラリに似た*名前空間*に編成されています。 たとえば、`System.Web`名前空間にはブラウザー/サーバー通信をサポートするクラスが含まれ`System.Xml`、名前空間には XML ファイルの作成と読み取りを行`System.Data`うために使用されるクラスが含まれ、名前空間にはデータを操作するためのクラスが含まれます。
> 
> .NET Framework 内の特定のクラスにアクセスするには、クラス名だけでなく、クラスが存在する名前空間もコードで認識する必要があります。 たとえば、`Chart`ヘルパーを使用するには、`System.Web.Helpers.Chart`名前空間 ( ) とクラス名 (`System.Web.Helpers``Chart`) を組み合わせたクラスをコードで検索する必要があります。 これは、.NET Framework の広大な範囲内で、クラスの*完全修飾*名&#8212;完全で明確な場所と呼ばれます。 コードでは、次のようになります。
> 
> `var myChart = new System.Web.Helpers.Chart(width: 600, height: 400) // etc.`
> 
> ただし、クラスやヘルパーを参照するたびに、これらの長い完全修飾名を使用する必要がある場合は、面倒な (エラーが発生しやすい) 。 したがって、クラス名を使いやすくするために、関心のある名前空間を*インポート*できます。 名前空間をインポートした場合は、完全修飾名 ( ) の代わりに`Chart`クラス名 ( )`System.Web.Helpers.Chart`のみを使用できます。 コードが実行され、クラス名を検出すると、インポートした名前空間だけを検索してそのクラスを見つけることができます。
> 
> Web ページASP.NET Razor 構文を使用して Web ページを作成する場合、通常は、`WebPage`クラス、さまざまなヘルパーなど、毎回同じクラスのセットを使用します。 Web サイトを作成するたびに関連する名前空間をインポートする作業を節約するために、ASP.NETは、各 Web サイトのコア名前空間のセットを自動的にインポートするように構成されます。 そのため、これまで名前空間を処理したり、インポートしたりする必要はありません。作業したすべてのクラスは、既にインポートされている名前空間に含まれています。
> 
> ただし、自動的にインポートされる名前空間にないクラスを使用する必要がある場合があります。 その場合は、そのクラスの完全修飾名を使用するか、クラスを含む名前空間を手動でインポートできます。 名前空間をインポートするには、前の例`using`で説明`import`したように、Visual Basic でステートメントを使用します。
> 
> たとえば、`DataSet`クラスは名前空間にあります`System.Data`。 名前空間`System.Data`は、Razor ページASP.NET自動的には使用できません。 したがって、完全修飾名を`DataSet`使用してクラスを操作するには、次のようなコードを使用できます。
> 
> `var dataSet = new System.Data.DataSet();`
> 
> `DataSet`クラスを繰り返し使用する必要がある場合は、次のような名前空間をインポートし、コードでクラス名だけを使用できます。
> 
> [!code-cshtml[Main](7-displaying-data-in-a-chart/samples/sample8.cshtml)]
> 
> 参照する他`using`の .NET Framework 名前空間のステートメントを追加できます。 ただし、前述のように、ほとんどのクラスは *、.cshtml*および *.vbhtml*ページで使用するためにASP.NETによって自動的にインポートされる名前空間に含まれているため、頻繁に行う必要はありません。

<a id="Displaying_Charts"></a>
## <a name="displaying-charts-inside-a-web-page"></a>Web ページ内にグラフを表示する

これまでに説明した例では、グラフを作成し、グラフがブラウザーに直接グラフィックスとして表示されます。 ただし、多くの場合、グラフは、ブラウザー内で単独で表示されるのではなく、ページの一部として表示する必要があります。 そのためには、2段階のプロセスが必要です。 最初の手順は、既に見てきたように、グラフを生成するページを作成することです。

2 番目の手順では、別のページに結果の画像を表示します。 画像を表示するには、任意の画像を`<img>`表示するのと同じ方法で HTML 要素を使用します。 ただし *、.jpg*ファイルまたは *.png*ファイルを参照する`<img>`代わりに、要素は、グラフを作成する`Chart`ヘルパーを含む *.cshtml*ファイルを参照します。 表示ページが実行されると、要素`<img>`はヘルパーの出力を`Chart`取得し、グラフをレンダリングします。

![](7-displaying-data-in-a-chart/_static/image11.jpg)

1. という名前のファイル*を作成します*。
2. 既存のコンテンツを次の内容に置き換えます。 

    [!code-html[Main](7-displaying-data-in-a-chart/samples/sample9.html)]

    コードでは、要素`<img>`を使用して *、ChartArrayBasic.cshtml*ファイルで作成したグラフを表示します。
3. ブラウザーで Web ページを実行します。 ファイルには *、ChartArrayBasic.cshtml*ファイルに含まれるコードに基づいてグラフ イメージが表示されます。 *ShowChart.cshtml*

<a id="Styling_a_Chart"></a>
## <a name="styling-a-chart"></a>グラフのスタイル設定

ヘルパー`Chart`は、グラフの外観をカスタマイズできる多数のオプションをサポートしています。 色、フォント、罫線などを設定できます。 グラフの外観をカスタマイズする簡単な方法は、 テーマ を使用*することです*。 テーマは、フォント、色、ラベル、パレット、枠線、効果を使用したグラフの表示方法を指定する情報の集まりです。 (グラフのスタイルはグラフの種類を示しません)。

次の表は、組み込みのテーマの一覧です。

| テーマ | 説明 |
| --- | --- |
| `Vanilla` | 白い背景に赤い列を表示します。 |
| `Blue` | 青いグラデーションの背景に青い列を表示します。 |
| `Green` | 緑のグラデーションの背景に青い列を表示します。 |
| `Yellow` | 黄色のグラデーションの背景にオレンジ色の列を表示します。 |
| `Vanilla3D` | 白い背景に 3-D の赤い列を表示します。 |

新しいグラフを作成するときに使用するテーマを指定できます。

1. という名前の新しいファイル*を作成します*。
2. ページ内の既存のコンテンツを次の内容に置き換えます。

    [!code-cshtml[Main](7-displaying-data-in-a-chart/samples/sample10.cshtml)]

    このコードは、データベースをデータに使用する前の例と同じですが、オブジェクト`theme`を作成するときにパラメータを`Chart`追加します。 変更されたコードを次に示します。

    [!code-csharp[Main](7-displaying-data-in-a-chart/samples/sample11.cs)]
3. ブラウザでページを実行します。 以前と同じデータが表示されますが、グラフはより洗練された外観になります。 

    ![](7-displaying-data-in-a-chart/_static/image12.jpg)

<a id="Saving_a_Chart"></a>
## <a name="saving-a-chart"></a>グラフの保存

この記事で説明`Chart`したようにヘルパーを使用すると、ヘルパーは呼び出されるたびにグラフを最初から再作成します。 必要に応じて、グラフのコードもデータベースを再クエリするか、XML ファイルを再読み込みしてデータを取得します。 クエリを実行しているデータベースが大きい場合や、XML ファイルに大量のデータが含まれている場合など、複雑な操作が行われる場合があります。 グラフに大量のデータが含まれていない場合でも、画像を動的に作成するプロセスはサーバーリソースを占有し、多くのユーザーがグラフを表示するページを要求すると、Web サイトのパフォーマンスに影響を与える可能性があります。

グラフを作成した場合のパフォーマンスへの影響を軽減するために、グラフを初めて作成して保存します。 グラフが再生成されるのではなく、再び必要になったときに、保存したバージョンを取得してレンダリングするだけで済みます。

グラフは次の方法で保存できます。

- (サーバー上の) コンピュータメモリにグラフをキャッシュします。
- グラフを画像ファイルとして保存します。
- グラフを XML ファイルとして保存します。 このオプションを使用すると、保存する前にグラフを変更できます。

### <a name="caching-a-chart"></a>チャートをキャッシュする

グラフを作成したら、それをキャッシュできます。 グラフをキャッシュすると、グラフを再度表示する必要がある場合に再作成する必要はありません。 キャッシュにグラフを保存する場合は、そのグラフに固有のキーを指定します。

サーバーのメモリが不足している場合、キャッシュに保存されたグラフが削除されることがあります。 また、何らかの理由でアプリケーションが再起動されると、キャッシュはクリアされます。 したがって、キャッシュされたグラフを使用する標準的な方法は、キャッシュで使用できるかどうかを常に確認し、キャッシュ内で使用可能でない場合は作成または再作成することです。

1. Web サイトのルートで *、ShowCachedChart.cshtml*という名前のファイルを作成します。
2. 既存のコンテンツを次の内容に置き換えます。 

    [!code-html[Main](7-displaying-data-in-a-chart/samples/sample12.html)]

    この`<img>`タグには`src`*、ChartSaveToCache.cshtml*ファイルを指し示す属性が含まれており、キーをクエリ文字列としてページに渡します。 キーには、myChartKey&quot;&quot;という値が含まれています。 グラフを作成*する*ヘルパーが`Chart`含まれています。 このページは、すぐに作成します。

    ページの最後に *、ClearCache.cshtml*という名前のページへのリンクがあります。 これは、すぐに作成するページです。 この例のキャッシュをテストする場合にのみ *、ClearCache.cshtml*が必要です。
3. Web サイトのルートで *、ChartSaveToCache.cshtml*という名前の新しいファイルを作成します。
4. 既存のコンテンツを次の内容に置き換えます。

    [!code-cshtml[Main](7-displaying-data-in-a-chart/samples/sample13.cshtml)]

    コードは、クエリ文字列のキー値として渡されたものがあるかどうかを最初にチェックします。 その場合、コードはメソッドを呼び出してキーを渡すことによって、キャッシュ`GetFromCache`からグラフを読み取ろうとします。 キャッシュ内にキーの下に何も存在しないことがわかった場合 (これは、グラフが最初に要求された時に発生します)、コードは通常どおりグラフを作成します。 グラフが終了すると、コードは を呼び出`SaveToCache`してキャッシュに保存します。 このメソッドにはキー (チャートを後で要求できるように) と、グラフをキャッシュに保存する時間が必要です。 (グラフをキャッシュする正確な時間は、グラフが表すデータが変更される可能性があると考える頻度によって異なります)。この`SaveToCache`メソッドでは`slidingExpiration`、パラメーター &#8212;が true に設定されている場合、グラフにアクセスするたびにタイムアウト カウンタがリセットされます。 この場合、チャートのキャッシュエントリは、最後に誰かがチャートにアクセスした 2 分後に期限切れになります。 (有効期限のスライドの代わりに絶対有効期限が設定されている場合は、キャッシュ エントリがキャッシュに格納されてから 2 分後に、アクセス頻度にかかわらず、キャッシュ エントリの有効期限が切れます)。

    最後に、このメソッドを`WriteFromCache`使用して、キャッシュからチャートをフェッチしてレンダリングします。 このメソッドは、キャッシュを`if`チェックするブロックの外側にあるので、グラフが最初に存在するか、生成してキャッシュに保存する必要があったかにかかわらず、キャッシュからグラフを取得します。

    この例では、メソッドに`AddTitle`タイムスタンプが含まれていることに注意してください。 (タイトルに現在の日付と時刻&#8212;&#8212;`DateTime.Now`が追加されます)。
5. *ClearCache.cshtml*という名前の新しいページを作成し、その内容を次のように置き換えます。

    [!code-cshtml[Main](7-displaying-data-in-a-chart/samples/sample14.cshtml)]

    このページでは、`WebCache`ヘルパーを使用して*ChartSaveToCache.cshtml*にキャッシュされているグラフを削除します。 前述のように、通常このようなページを持つ必要はありません。 ここでは、キャッシュのテストを簡単にするために作成しています。
6. ブラウザーで Web ページを*実行*します。 このページには *、ChartSaveToCache.cshtml*ファイルに含まれるコードに基づいてグラフ イメージが表示されます。 タイムスタンプがチャートタイトルに何を示しているのかを書き留めます。 

    ![説明:チャートタイトルのタイムスタンプ付きの基本的なチャートの画像](7-displaying-data-in-a-chart/_static/image13.jpg)
7. ブラウザーを閉じます。
8. もう一度*実行します*。 タイムスタンプは前と同じで、チャートは再生成されず、キャッシュから読み取られたことを示します。
9. [*キャッシュの***クリア**] リンクをクリックします。 これにより、キャッシュがクリアされたことを報告する*ClearCache.cshtml*が表示されます。
10. リンク**をクリック**するか、WebMatrix から*ShowCachedChart.cshtml を*再実行します。 キャッシュがクリアされたため、今回はタイムスタンプが変更されています。 そのため、コードはグラフを再生成し、キャッシュに戻す必要がありました。

### <a name="saving-a-chart-as-an-image-file"></a>グラフをイメージ ファイルとして保存する

また、グラフをイメージ ファイルとして保存することもできます (たとえば *、.jpg*ファイルとして) サーバー上でします。 その後、イメージファイルを任意のイメージと同じように使用できます。 この利点は、一時キャッシュに保存するのではなく、ファイルが保存される点です。 新しいグラフ イメージを異なる時間 (たとえば、1 時間ごと) に保存し、時間の経過に伴う変更を永続的に記録しておくことができます。 Web アプリケーションに、イメージ ファイルを配置するサーバー上のフォルダーにファイルを保存する権限があることを確認する必要があります。

1. Web サイトのルートに*\_ChartFiles*という名前のフォルダーが存在しない場合は、フォルダーを作成します。
2. Web サイトのルートで *、ChartSave.cshtml*という名前の新しいファイルを作成します。
3. 既存のコンテンツを次の内容に置き換えます。

    [!code-cshtml[Main](7-displaying-data-in-a-chart/samples/sample15.cshtml)]

    コードは、まず、メソッドを呼び出すことによって *.jpg*ファイル`File.Exists`が存在するかどうかを確認します。 ファイルが存在しない場合、コードは配列から new`Chart`を作成します。 今回は、コードがメソッドを`Save`呼び出し、`path`パラメーターを渡して、グラフを保存する場所のファイル パスとファイル名を指定します。 ページの本文では、`<img>`要素はパスを使用して表示する *.jpg*ファイルを指します。
4. *ファイル*を実行します。
5. WebMatrix に戻ります。 *chart01.jpg*という名前のイメージ ファイルが*\_ChartFiles*フォルダに保存されていることに注意してください。

### <a name="saving-a-chart-as-an-xml-file"></a>グラフを XML ファイルとして保存する

最後に、グラフを XML ファイルとしてサーバーに保存できます。 グラフをキャッシュしたり、グラフをファイルに保存したりする方法よりもこの方法を使用する利点は、必要に応じて、グラフを表示する前に XML を変更できることです。 アプリケーションには、イメージ ファイルを配置するサーバー上のフォルダーに対する読み取り/書き込みアクセス許可が必要です。

1. Web サイトのルートで *、ChartSaveXml.cshtml*という名前の新しいファイルを作成します。
2. 既存のコンテンツを次の内容に置き換えます。

    [!code-cshtml[Main](7-displaying-data-in-a-chart/samples/sample16.cshtml)]

    このコードは、XML ファイルを使用する点を除いて、以前に表示されたコードと似ています。 このコードは、まず、メソッドを呼び出して XML`File.Exists`ファイルが存在するかどうかを確認します。 ファイルが存在する場合、コードは新`Chart`しいオブジェクトを作成し、ファイル名を`themePath`パラメーターとして渡します。 これにより、XML ファイル内のグラフに基づいてグラフが作成されます。 XML ファイルが存在しない場合、コードは標準グラフを作成し、それを保存する呼`SaveXml`び出しを行います。 前に見たように、`Write`グラフはメソッドを使用してレンダリングされます。

    キャッシュを表示したページと同様に、このコードにはグラフ タイトルにタイムスタンプが含まれています。
3. *ChartDisplayXMLChart.cshtml*という名前の新しいページを作成し、それに次のマークアップを追加します。 

    [!code-html[Main](7-displaying-data-in-a-chart/samples/sample17.html)]
4. ページを*実行*します。 グラフが表示されます。 チャートのタイトルのタイムスタンプを書き留めます。
5. ブラウザーを閉じます。
6. WebMatrix で*\_、ChartFiles*フォルダーを右クリックし、 (**更新)** をクリックして、フォルダーを開きます。 このフォルダー内の*XMLChart.xml*ファイルは`Chart`ヘルパーによって作成されました。 

    ![説明: グラフ ヘルパーによって作成された XMLChart.xml ファイルを示す_ChartFiles フォルダー。](7-displaying-data-in-a-chart/_static/image14.jpg)
7. もう一度 *[グラフ表示XML チャート.cshtml]* ページを実行します。 チャートには、ページを初めて実行した時と同じタイムスタンプが表示されます。 これは、先ほど保存した XML からグラフが生成されるためです。
8. マトリックスで、*\_グラフ ファイル*フォルダーを開き *、XMLChart.xml*ファイルを削除します。
9. もう一度*ページを実行します*。 今回は、ヘルパーが XML ファイルを`Chart`再作成する必要があるため、タイムスタンプが更新されます。 必要に応じ*\_、ChartFiles*フォルダを確認し、XML ファイルが戻っていることを確認します。

<a id="Additional_Resources"></a>
## <a name="additional-resources"></a>その他のリソース

- [ASP.NET Web ページ サイトでのデータベースの操作の概要](https://go.microsoft.com/fwlink/?LinkId=202893)
- [ASP.NET Web ページ サイトでキャッシュを使用してパフォーマンスを向上させる](https://go.microsoft.com/fwlink/?LinkId=202903)
- [グラフ クラス](https://msdn.microsoft.com/library/system.web.helpers.chart(v=vs.99))(msdn ASP.NET Web ページ API リファレンス)

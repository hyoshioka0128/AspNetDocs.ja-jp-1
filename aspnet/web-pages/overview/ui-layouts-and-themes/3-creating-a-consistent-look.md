---
uid: web-pages/overview/ui-layouts-and-themes/3-creating-a-consistent-look
title: ASP.NET Web ページ (Razor) サイトでの一貫したレイアウトの作成 |Microsoft Docs
author: Rick-Anderson
description: サイトの web ページをより効率的に作成するために、web サイト用に再利用可能なコンテンツのブロック (ヘッダーやフッターなど) を作成することができます。
ms.author: riande
ms.date: 03/10/2014
ms.assetid: d7bd001b-6db2-4422-9b78-f3d08b743b00
msc.legacyurl: /web-pages/overview/ui-layouts-and-themes/3-creating-a-consistent-look
msc.type: authoredcontent
ms.openlocfilehash: 3f63ce68ae4c13970ac0df196167ace0b22b592c
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 03/06/2020
ms.locfileid: "78509098"
---
# <a name="creating-a-consistent-layout-in-aspnet-web-pages-razor-sites"></a>ASP.NET Web ページ (Razor) サイトでの一貫したレイアウトの作成

[Tom FitzMacken](https://github.com/tfitzmac)

> この記事では、ASP.NET Web ページ (Razor) web サイトのレイアウトページを使用して、再利用可能なコンテンツのブロック (ヘッダーやフッターなど) を作成し、サイト内のすべてのページに一貫した外観を作成する方法について説明します。
> 
> **学習内容:** 
> 
> - ヘッダーやフッターなどの再利用可能なコンテンツのブロックを作成する方法。
> - レイアウトを使用して、サイト内のすべてのページに一貫した外観を作成する方法。
> - 実行時にレイアウトページにデータを渡す方法。
> 
> この記事で導入された ASP.NET 機能を次に示します。
> 
> - コンテンツブロックは、複数のページに挿入される HTML 形式のコンテンツを含むファイルです。
> - レイアウトページ: web サイト上のページで共有できる HTML 形式のコンテンツが含まれているページです。
> - `RenderPage`、`RenderBody`、および `RenderSection` メソッド。ページ要素を挿入する場所を ASP.NET に指示します。
> - コンテンツブロックとレイアウトページの間でデータを共有できるようにする `PageData` ディクショナリ。
>   
> 
> ## <a name="software-versions-used-in-the-tutorial"></a>このチュートリアルで使用されているソフトウェアのバージョン
> 
> 
> - ASP.NET Web ページ (Razor) 3
>   
> 
> このチュートリアルは ASP.NET Web ページ2でも動作します。

## <a name="about-layout-pages"></a>レイアウトページについて

多くの web サイトには、ヘッダーやフッターなどのすべてのページに表示されるコンテンツや、ログインしていることをユーザーに通知するボックスがあります。 ASP.NET を使用すると、通常の web ページと同様に、テキスト、マークアップ、およびコードを含めることができるコンテンツブロックを含む別のファイルを作成できます。 その後、情報を表示するサイトの他のページにコンテンツブロックを挿入できます。 このようにして、すべてのページに同じコンテンツをコピーして貼り付ける必要はありません。 このような共通コンテンツを作成すると、サイトの更新も容易になります。 コンテンツを変更する必要がある場合は、単に1つのファイルを更新するだけで、コンテンツが挿入されるすべての場所に変更が反映されます。

次の図は、コンテンツブロックがどのように機能するかを示しています。 ブラウザーが web サーバーからページを要求すると、ASP.NET は、メインページで `RenderPage` メソッドが呼び出される位置にコンテンツブロックを挿入します。 完成した (マージされた) ページがブラウザーに送信されます。

![RenderPage メソッドが参照されているページを現在のページに挿入する方法を示す概念図。](3-creating-a-consistent-look/_static/image1.jpg)

この手順では、別のファイルに配置されている2つのコンテンツブロック (ヘッダーとフッター) を参照するページを作成します。 これらの同じコンテンツブロックは、サイト内のどのページでも使用できます。 完了すると、次のようなページが表示されます。

![RenderPage メソッドの呼び出しを含むページを実行した結果として得られるブラウザー内のページを示すスクリーンショット。](3-creating-a-consistent-look/_static/image2.png)

1. Web サイトのルートフォルダーに、" *Index. cshtml*" という名前のファイルを作成します。
2. 既存のマークアップを次のように置き換えます。

    [!code-html[Main](3-creating-a-consistent-look/samples/sample1.html)]
3. ルートフォルダーに、 *Shared*という名前のフォルダーを作成します。

    > [!NOTE]
    > Web ページ間で共有されるファイルは、*共有*という名前のフォルダーに格納するのが一般的です。
4. *共有*フォルダーに、 *\_Header*という名前のファイルを作成します。
5. 既存のコンテンツを次の内容に置き換えます。

    [!code-html[Main](3-creating-a-consistent-look/samples/sample2.html)]

    ファイル名は、プレフィックスとしてアンダースコア (\_) を使用して *\_ヘッダーです。* ASP.NET の名前がアンダースコアで始まる場合、ページはブラウザーに送信されません。 これにより、これらのページを直接 (誤って、またはそれ以外の方法で) 要求できなくなります。 アンダースコアを使用して、コンテンツブロックのあるページに名前を付けることをお勧めします。実際には、他のページに挿入さ&#8212;れることがあるページをユーザーに要求することはありません。
6. *共有*フォルダーに、 *\_Footer. cshtml*という名前のファイルを作成し、内容を次のように置き換えます。

    [!code-html[Main](3-creating-a-consistent-look/samples/sample3.html)]
7. 次に示すように、 *Index. cshtml*ページで、`RenderPage` メソッドに2つの呼び出しを追加します。

    [!code-html[Main](3-creating-a-consistent-look/samples/sample4.html)]

    これは、web ページにコンテンツブロックを挿入する方法を示しています。 `RenderPage` メソッドを呼び出し、その時点で内容を挿入するファイルの名前を渡します。 ここでは、 *\_Header*ファイルと *\_フッター*ファイルの内容を、*インデックスの cshtml*ファイルに挿入しています。
8. ブラウザーで、 *Index. cshtml*ページを実行します。 (WebMatrix の **[ファイル]** ワークスペースで、ファイルを右クリックし、 **[ブラウザーで起動]** を選択します)。
9. ブラウザーでページソースを表示します。 (たとえば、Internet Explorer で、ページを右クリックし、[ソースの**表示**] をクリックします)。

    これにより、ブラウザーに送信された web ページマークアップが表示されます。これにより、インデックスページマークアップがコンテンツブロックと結合されます。 次の例は、 *Index. cshtml*に対してレンダリングされるページソースを示しています。 *Index. cshtml*に挿入した `RenderPage` への呼び出しは、ヘッダーファイルとフッターファイルの実際の内容に置き換えられています。

    [!code-html[Main](3-creating-a-consistent-look/samples/sample5.html)]

## <a name="creating-a-consistent-look-using-layout-pages"></a>レイアウトページを使用して一貫した外観を作成する

ここまでで、同じコンテンツを複数のページに簡単に含めることができました。 サイトの一貫性のある外観を作成するためのより体系的な方法は、レイアウトページを使用することです。 レイアウトページは web ページの構造を定義しますが、実際のコンテンツは含まれません。 レイアウトページを作成したら、そのコンテンツを含む web ページを作成して、レイアウトページにリンクすることができます。 これらのページを表示すると、レイアウトページに従って書式設定されます。 (この意味では、レイアウトページは他のページで定義されているコンテンツの一種のテンプレートとして機能します)。

レイアウトページは HTML ページと同じですが、`RenderBody` メソッドの呼び出しが含まれている点が異なります。 [レイアウト] ページの `RenderBody` メソッドの位置によって、コンテンツページからの情報が含まれる場所が決まります。

次の図は、実行時にコンテンツページとレイアウトページがどのように組み合わされ、完成した web ページが生成されるかを示しています。 ブラウザーはコンテンツページを要求します。 コンテンツページには、ページの構造に使用するレイアウトページを指定するコードが含まれています。 [レイアウト] ページでは、`RenderBody` メソッドが呼び出される位置にコンテンツが挿入されます。 また、前のセクションで行ったように、`RenderPage` メソッドを呼び出すことによって、コンテンツブロックをレイアウトページに挿入することもできます。 Web ページが完成すると、ブラウザーに送信されます。

![RenderBody メソッドの呼び出しを含むページを実行した結果として得られるブラウザー内のページを示すスクリーンショット。](3-creating-a-consistent-look/_static/image3.jpg)

次の手順では、レイアウトページを作成し、そのページにコンテンツページをリンクする方法を示します。

1. Web サイトの*共有*フォルダーに、 *\_Layout1*という名前のファイルを作成します。
2. 既存のコンテンツを次の内容に置き換えます。

    [!code-html[Main](3-creating-a-consistent-look/samples/sample6.html)]

    コンテンツブロックを挿入するには、レイアウトページで `RenderPage` メソッドを使用します。 レイアウトページには、`RenderBody` メソッドの呼び出しを1つだけ含めることができます。
3. *共有*フォルダーで、 *\_.header2*という名前のファイルを作成し、既存のコンテンツを次の内容に置き換えます。

    [!code-html[Main](3-creating-a-consistent-look/samples/sample7.html)]
4. ルートフォルダーで、新しいフォルダーを作成し、その名前を「 *Styles*」にします。
5. [*スタイル*] フォルダーで、「 *.css* 」という名前のファイルを作成し、次のスタイル定義を追加します。

    [!code-css[Main](3-creating-a-consistent-look/samples/sample8.css)]

    ここでは、スタイルシートをレイアウトページで使用する方法についてのみ説明します。 必要に応じて、これらの要素に対して独自のスタイルを定義できます。
6. ルートフォルダーに*Content1*という名前のファイルを作成し、既存のコンテンツを次の内容に置き換えます。

    [!code-cshtml[Main](3-creating-a-consistent-look/samples/sample9.cshtml)]

    これは、レイアウトページを使用するページです。 ページの上部にあるコードブロックは、このコンテンツの書式設定に使用するレイアウトページを示しています。
7. ブラウザーで*Content1*を実行します。 レンダリング\_されたページは、 *Layout1*で定義されている形式とスタイルシートと、 *Content1*で定義されているテキスト (コンテンツ) を使用します。

    ![[画像]](3-creating-a-consistent-look/_static/image4.png)

    手順 6. を繰り返して、同じレイアウトページを共有できる追加のコンテンツページを作成できます。

    > [!NOTE]
    > フォルダー内のすべてのコンテンツページに対して同じレイアウトページを自動的に使用できるようにサイトを設定することができます。 詳細については、「 [ASP.NET Web ページのサイト全体の動作をカスタマイズする](https://go.microsoft.com/fwlink/?LinkId=202906)」を参照してください。

## <a name="designing-layout-pages-that-have-multiple-content-sections"></a>複数のコンテンツセクションを含むレイアウトページのデザイン

コンテンツページには複数のセクションを含めることができます。これは、置き換え可能なコンテンツを持つ複数の領域を持つレイアウトを使用する場合に便利です。 [コンテンツ] ページで、各セクションに一意の名前を付けます。 (既定のセクションは無名のままです)。[レイアウト] ページで、`RenderBody` メソッドを追加して、名前のない (既定の) セクションを表示する場所を指定します。 次に、名前付きセクションを個別に表示するために、個別の `RenderSection` メソッドを追加します。

次の図は、ASP.NET が複数のセクションに分割されたコンテンツを処理する方法を示しています。 各名前付きセクションは、コンテンツページのセクションブロックに含まれています。 (例では `Header` と `List` という名前です)。フレームワークによって、`RenderSection` メソッドが呼び出される位置のレイアウトページにコンテンツセクションが挿入されます。 前に見たように、名前のない (既定の) セクションが、`RenderBody` メソッドが呼び出される位置に挿入されます。

![RenderSection メソッドが参照セクションを現在のページに挿入する方法を示す概念図。](3-creating-a-consistent-look/_static/image5.jpg)

この手順では、複数のコンテンツセクションを含むコンテンツページを作成する方法と、複数のコンテンツセクションをサポートするレイアウトページを使用してコンテンツセクションを表示する方法について説明します。

1. *共有*フォルダーに、 *\_Layout2*という名前のファイルを作成します。
2. 既存のコンテンツを次の内容に置き換えます。

    [!code-html[Main](3-creating-a-consistent-look/samples/sample10.html)]

    ヘッダーセクションとリストセクションの両方を表示するには、`RenderSection` メソッドを使用します。
3. ルートフォルダーに*Content2*という名前のファイルを作成し、既存のコンテンツを次の内容に置き換えます。

    [!code-cshtml[Main](3-creating-a-consistent-look/samples/sample11.cshtml)]

    このコンテンツページには、ページの上部にコードブロックが含まれています。 各名前付きセクションは、セクションブロックに含まれています。 ページの残りの部分には、既定の (名前のない) コンテンツセクションが含まれています。
4. ブラウザーで*Content2*を実行します。

    ![RenderSection メソッドの呼び出しを含むページを実行した結果として得られるブラウザー内のページを示すスクリーンショット。](3-creating-a-consistent-look/_static/image6.png)

## <a name="making-content-sections-optional"></a>コンテンツセクションをオプションにする

通常、コンテンツページで作成するセクションは、[レイアウト] ページで定義されているセクションと一致している必要があります。 次のいずれかが発生すると、エラーが発生する可能性があります。

- コンテンツページには、レイアウトページに対応するセクションがないセクションが含まれています。
- レイアウトページには、コンテンツがないセクションが含まれています。
- レイアウトページには、同じセクションを複数回表示しようとするメソッド呼び出しが含まれています。

ただし、レイアウトページでセクションをオプションとして宣言することで、名前付きセクションのこの動作をオーバーライドできます。 これにより、レイアウトページを共有できるコンテンツページを複数定義できますが、特定のセクションのコンテンツが含まれていない場合もあります。

1. *Content2*を開き、次のセクションを削除します。

    [!code-cshtml[Main](3-creating-a-consistent-look/samples/sample12.cshtml)]
2. ページを保存し、ブラウザーで実行します。 コンテンツページでは、レイアウトページで定義されているセクション (ヘッダーセクション) のコンテンツが提供されないため、エラーメッセージが表示されます。

    ![RenderSection メソッドを呼び出すページを実行しても、対応するセクションが指定されていない場合に発生するエラーを示すスクリーンショット。](3-creating-a-consistent-look/_static/image7.png)
3. *共有*フォルダーで、 *\_Layout2*ページを開き、次の行を置き換えます。

    [!code-javascript[Main](3-creating-a-consistent-look/samples/sample13.js)]

    を、以下のコードに置き換えます。

    [!code-javascript[Main](3-creating-a-consistent-look/samples/sample14.js)]

    別の方法として、前のコード行を次のコードブロックに置き換えることもできます。これにより、同じ結果が得られます。

    [!code-cshtml[Main](3-creating-a-consistent-look/samples/sample15.cshtml)]
4. ブラウザーで*Content2*ページをもう一度実行します。 (ブラウザーでこのページを開いたままにしている場合は、更新するだけで済みます)。今回は、ヘッダーがない場合でも、ページにエラーが表示されません。

## <a name="passing-data-to-layout-pages"></a>レイアウトページにデータを渡す

コンテンツページで、レイアウトページで参照する必要があるデータが定義されている場合があります。 その場合は、コンテンツページからレイアウトページにデータを渡す必要があります。 たとえば、ユーザーのログインステータスを表示したり、ユーザー入力に基づいてコンテンツ領域の表示と非表示を切り替えたりすることができます。

コンテンツページからレイアウトページにデータを渡すには、コンテンツページの [`PageData`] プロパティに値を入力します。 `PageData` プロパティは、ページ間で渡されるデータを格納する名前と値のペアのコレクションです。 [レイアウト] ページでは、`PageData` プロパティから値を読み取ることができます。

もう1つの図を次に示します。 ここでは、ASP.NET が `PageData` プロパティを使用して、コンテンツページからレイアウトページに値を渡す方法について説明します。 ASP.NET が web ページの構築を開始すると、`PageData` コレクションが作成されます。 [コンテンツ] ページで、`PageData` コレクションにデータを格納するコードを記述します。 `PageData` コレクション内の値は、コンテンツページの他のセクション、または追加のコンテンツブロックによってアクセスすることもできます。

![コンテンツページで PageData 辞書にデータを入力し、その情報をレイアウトページに渡す方法を示す概念図。](3-creating-a-consistent-look/_static/image8.jpg)

次の手順では、コンテンツページからレイアウトページにデータを渡す方法について説明します。 ページを実行すると、レイアウトページで定義されている一覧をユーザーが非表示にしたり表示したりできるボタンが表示されます。 ユーザーがボタンをクリックすると、`PageData` プロパティに true/false (ブール値) 値が設定されます。 レイアウトページはその値を読み取り、false の場合はリストを非表示にします。 この値は、**リストの非表示** ボタンと **リストの表示** ボタンのどちらを表示するかを決定するために、コンテンツ ページでも使用されます。

![[画像]](3-creating-a-consistent-look/_static/image9.jpg)

1. ルートフォルダーに*Content3*という名前のファイルを作成し、既存のコンテンツを次の内容に置き換えます。

    [!code-cshtml[Main](3-creating-a-consistent-look/samples/sample16.cshtml)]

    このコードでは、`PageData` プロパティ&#8212;に2つのデータを格納し、web ページのタイトルと true または false を指定して、リストを表示するかどうかを指定します。

    ASP.NET を使用すると、コードブロックを使用して条件付きでページに HTML マークアップを配置できます。 たとえば、ページの本文の `if/else` ブロックは、`PageData["ShowList"]` が true に設定されているかどうかに応じてどのフォームを表示するかを決定します。
2. *共有*フォルダーで、 *\_Layout3*という名前のファイルを作成し、既存のコンテンツを次の内容に置き換えます。

    [!code-cshtml[Main](3-creating-a-consistent-look/samples/sample17.cshtml)]

    レイアウトページには、`PageData` プロパティからタイトル値を取得する `<title>` 要素の式が含まれています。 また、`PageData` プロパティの `ShowList` 値を使用して、リストコンテンツブロックを表示するかどうかを決定します。
3. *共有*フォルダーで、 *\_List. cshtml*という名前のファイルを作成し、既存のコンテンツを次の内容に置き換えます。

    [!code-html[Main](3-creating-a-consistent-look/samples/sample18.html)]
4. ブラウザーで*Content3*ページを実行します。 ページが表示され、ページの左側にリストが表示され、下部に **[リストの非表示]** ボタンが表示されます。

    ![リストを含むページと、' Hide List ' というボタンを示すスクリーンショット。](3-creating-a-consistent-look/_static/image10.png)
5. **[一覧の非表示]** をクリックします。 一覧が表示されなくなり、ボタンが **[一覧の表示]** に変わります。

    ![リストを含まないページと、' Show List ' というボタンを示すスクリーンショット。](3-creating-a-consistent-look/_static/image11.png)
6. **[一覧の表示]** ボタンをクリックすると、一覧が再び表示されます。

## <a name="additional-resources"></a>その他のリソース

[ASP.NET Web ページのサイト全体の動作のカスタマイズ](https://go.microsoft.com/fwlink/?LinkId=202906)

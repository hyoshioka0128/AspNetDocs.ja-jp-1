---
uid: mvc/overview/performance/bundling-and-minification
title: バンドルと縮小 |Microsoft Docs
author: Rick-Anderson
description: バンドルと縮小は、要求の読み込み時間を向上させるために ASP.NET 4.5 で使用できる2つの手法です。 バンドルと縮小によって、reducin による読み込み時間が向上します...
ms.author: riande
ms.date: 08/23/2012
ms.assetid: 5894dc13-5d45-4dad-8096-136499120f1d
msc.legacyurl: /mvc/overview/performance/bundling-and-minification
msc.type: authoredcontent
ms.openlocfilehash: 61bfe5dbac04b57e1461183b66ead2f01fe0734c
ms.sourcegitcommit: 7709c0a091b8d55b7b33bad8849f7b66b23c3d72
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 02/19/2020
ms.locfileid: "77457766"
---
# <a name="bundling-and-minification"></a><span data-ttu-id="ed7d0-104">バンドルと縮小</span><span class="sxs-lookup"><span data-stu-id="ed7d0-104">Bundling and Minification</span></span>

<span data-ttu-id="ed7d0-105">[Rick Anderson](https://twitter.com/RickAndMSFT)</span><span class="sxs-lookup"><span data-stu-id="ed7d0-105">by [Rick Anderson](https://twitter.com/RickAndMSFT)</span></span>

> <span data-ttu-id="ed7d0-106">バンドルと縮小は、要求の読み込み時間を向上させるために ASP.NET 4.5 で使用できる2つの手法です。</span><span class="sxs-lookup"><span data-stu-id="ed7d0-106">Bundling and minification are two techniques you can use in ASP.NET 4.5 to improve request load time.</span></span> <span data-ttu-id="ed7d0-107">バンドルと縮小は、サーバーへの要求の数を減らし、要求された資産のサイズ (CSS や JavaScript など) を減らすことによって、読み込み時間を短縮します。</span><span class="sxs-lookup"><span data-stu-id="ed7d0-107">Bundling and minification improves load time by reducing the number of requests to the server and reducing the size of requested assets (such as CSS and JavaScript.)</span></span>

<span data-ttu-id="ed7d0-108">現在の主要なブラウザーのほとんどは、各ホスト名の[同時接続](http://www.browserscope.org/?category=network)数を6に制限しています。</span><span class="sxs-lookup"><span data-stu-id="ed7d0-108">Most of the current major browsers limit the number of [simultaneous connections](http://www.browserscope.org/?category=network) per each hostname to six.</span></span> <span data-ttu-id="ed7d0-109">つまり、6つの要求が処理されている間に、ホスト上の資産に対する追加の要求は、ブラウザーによってキューに登録されます。</span><span class="sxs-lookup"><span data-stu-id="ed7d0-109">That means that while six requests are being processed, additional requests for assets on a host will be queued by the browser.</span></span> <span data-ttu-id="ed7d0-110">次の図では、IE F12 開発者ツールの [ネットワーク] タブに、サンプルアプリケーションの [About] ビューで必要とされる資産のタイミングが示されています。</span><span class="sxs-lookup"><span data-stu-id="ed7d0-110">In the image below, the IE F12 developer tools network tabs shows the timing for assets required by the About view of a sample application.</span></span>

![B/M](bundling-and-minification/_static/image1.png)

<span data-ttu-id="ed7d0-112">灰色のバーは、ブラウザーが6つの接続制限を待機しているときに、要求がキューに入れられた時間を示します。</span><span class="sxs-lookup"><span data-stu-id="ed7d0-112">The gray bars show the time the request is queued by the browser waiting on the six connection limit.</span></span> <span data-ttu-id="ed7d0-113">黄色のバーは、最初のバイトまでの要求時間 (つまり、要求の送信とサーバーからの最初の応答の受信にかかった時間) です。</span><span class="sxs-lookup"><span data-stu-id="ed7d0-113">The yellow bar is the request time to first byte, that is, the time taken to send the request and receive the first response from the server.</span></span> <span data-ttu-id="ed7d0-114">青色のバーは、サーバーからの応答データの受信にかかった時間を示します。</span><span class="sxs-lookup"><span data-stu-id="ed7d0-114">The blue bars show the time taken to receive the response data from the server.</span></span> <span data-ttu-id="ed7d0-115">資産をダブルクリックすると、詳細なタイミング情報を取得できます。</span><span class="sxs-lookup"><span data-stu-id="ed7d0-115">You can double-click on an asset to get detailed timing information.</span></span> <span data-ttu-id="ed7d0-116">たとえば、次の図は、 */Scripts/MyScripts/JavaScript6.js*ファイルを読み込むためのタイミングの詳細を示しています。</span><span class="sxs-lookup"><span data-stu-id="ed7d0-116">For example, the following image shows the timing details for loading the */Scripts/MyScripts/JavaScript6.js* file.</span></span>

![](bundling-and-minification/_static/image2.png)

<span data-ttu-id="ed7d0-117">上の図は、ブラウザーが同時接続の数を制限しているために要求がキューに入れられた時間を示す**開始**イベントを示しています。</span><span class="sxs-lookup"><span data-stu-id="ed7d0-117">The preceding image shows the **Start** event, which gives the time the request was queued because of the browser limit the number of simultaneous connections.</span></span> <span data-ttu-id="ed7d0-118">この場合、要求は別の要求の完了を待機している46ミリ秒間キューに登録されました。</span><span class="sxs-lookup"><span data-stu-id="ed7d0-118">In this case, the request was queued for 46 milliseconds waiting for another request to complete.</span></span>

## <a name="bundling"></a><span data-ttu-id="ed7d0-119">まとめる</span><span class="sxs-lookup"><span data-stu-id="ed7d0-119">Bundling</span></span>

<span data-ttu-id="ed7d0-120">バンドルは ASP.NET 4.5 の新機能で、複数のファイルを簡単に1つのファイルに結合したりバンドルしたりすることができます。</span><span class="sxs-lookup"><span data-stu-id="ed7d0-120">Bundling is a new feature in ASP.NET 4.5 that makes it easy to combine or bundle multiple files into a single file.</span></span> <span data-ttu-id="ed7d0-121">CSS、JavaScript、その他のバンドルを作成できます。</span><span class="sxs-lookup"><span data-stu-id="ed7d0-121">You can create CSS, JavaScript and other bundles.</span></span> <span data-ttu-id="ed7d0-122">ファイルの数が減ると、HTTP 要求が減り、最初のページ読み込みのパフォーマンスが向上します。</span><span class="sxs-lookup"><span data-stu-id="ed7d0-122">Fewer files means fewer HTTP requests and that can improve first page load performance.</span></span>

<span data-ttu-id="ed7d0-123">次の図は、前に示した [About] ビューと同じタイミングビューを示していますが、今回はバンドルと縮小が有効になっています。</span><span class="sxs-lookup"><span data-stu-id="ed7d0-123">The following image shows the same timing view of the About view shown previously, but this time with bundling and minification enabled.</span></span>

![](bundling-and-minification/_static/image3.png)

## <a name="minification"></a><span data-ttu-id="ed7d0-124">縮小</span><span class="sxs-lookup"><span data-stu-id="ed7d0-124">Minification</span></span>

<span data-ttu-id="ed7d0-125">縮小は、スクリプトや css に対してさまざまなコードの最適化を実行します。たとえば、不要な空白やコメントを削除し、変数名を1文字に短縮します。</span><span class="sxs-lookup"><span data-stu-id="ed7d0-125">Minification performs a variety of different code optimizations to scripts or css, such as removing unnecessary white space and comments and shortening variable names to one character.</span></span> <span data-ttu-id="ed7d0-126">次の JavaScript 関数を考えてみます。</span><span class="sxs-lookup"><span data-stu-id="ed7d0-126">Consider the following JavaScript function.</span></span>

[!code-javascript[Main](bundling-and-minification/samples/sample1.js)]

<span data-ttu-id="ed7d0-127">縮小の後、関数は次のように縮小されます。</span><span class="sxs-lookup"><span data-stu-id="ed7d0-127">After minification, the function is reduced to the following:</span></span>

[!code-javascript[Main](bundling-and-minification/samples/sample2.js)]

<span data-ttu-id="ed7d0-128">コメントや不要な空白文字を削除するだけでなく、次のようなパラメーターと変数名が変更されました (短縮)。</span><span class="sxs-lookup"><span data-stu-id="ed7d0-128">In addition to removing the comments and unnecessary whitespace, the following parameters and variable names were renamed (shortened) as follows:</span></span>

| <span data-ttu-id="ed7d0-129">**Original**</span><span class="sxs-lookup"><span data-stu-id="ed7d0-129">**Original**</span></span> | <span data-ttu-id="ed7d0-130">**変わり**</span><span class="sxs-lookup"><span data-stu-id="ed7d0-130">**Renamed**</span></span> |
| --- | --- |
| <span data-ttu-id="ed7d0-131">imageTagAndImageID</span><span class="sxs-lookup"><span data-stu-id="ed7d0-131">imageTagAndImageID</span></span> | <span data-ttu-id="ed7d0-132">n</span><span class="sxs-lookup"><span data-stu-id="ed7d0-132">n</span></span> |
| <span data-ttu-id="ed7d0-133">imageContext</span><span class="sxs-lookup"><span data-stu-id="ed7d0-133">imageContext</span></span> | <span data-ttu-id="ed7d0-134">t</span><span class="sxs-lookup"><span data-stu-id="ed7d0-134">t</span></span> |
| <span data-ttu-id="ed7d0-135">imageElement</span><span class="sxs-lookup"><span data-stu-id="ed7d0-135">imageElement</span></span> | <span data-ttu-id="ed7d0-136">i</span><span class="sxs-lookup"><span data-stu-id="ed7d0-136">i</span></span> |

## <a name="impact-of-bundling-and-minification"></a><span data-ttu-id="ed7d0-137">バンドルと縮小の影響</span><span class="sxs-lookup"><span data-stu-id="ed7d0-137">Impact of Bundling and Minification</span></span>

<span data-ttu-id="ed7d0-138">次の表は、サンプルプログラムですべての資産を個別に一覧表示し、バンドルと縮小 (B/M) を使用する場合の、いくつかの重要な違いを示しています。</span><span class="sxs-lookup"><span data-stu-id="ed7d0-138">The following table shows several important differences between listing all the assets individually and using bundling and minification (B/M) in the sample program.</span></span>

|  | <span data-ttu-id="ed7d0-139">**B/M を使用する**</span><span class="sxs-lookup"><span data-stu-id="ed7d0-139">**Using B/M**</span></span> | <span data-ttu-id="ed7d0-140">**B/M なし**</span><span class="sxs-lookup"><span data-stu-id="ed7d0-140">**Without B/M**</span></span> | <span data-ttu-id="ed7d0-141">**変更**</span><span class="sxs-lookup"><span data-stu-id="ed7d0-141">**Change**</span></span> |
| --- | --- | --- | --- |
| <span data-ttu-id="ed7d0-142">**ファイル要求**</span><span class="sxs-lookup"><span data-stu-id="ed7d0-142">**File Requests**</span></span> | <span data-ttu-id="ed7d0-143">9</span><span class="sxs-lookup"><span data-stu-id="ed7d0-143">9</span></span> | <span data-ttu-id="ed7d0-144">34</span><span class="sxs-lookup"><span data-stu-id="ed7d0-144">34</span></span> | <span data-ttu-id="ed7d0-145">256%</span><span class="sxs-lookup"><span data-stu-id="ed7d0-145">256%</span></span> |
| <span data-ttu-id="ed7d0-146">**送信済み KB**</span><span class="sxs-lookup"><span data-stu-id="ed7d0-146">**KB Sent**</span></span> | <span data-ttu-id="ed7d0-147">3.26</span><span class="sxs-lookup"><span data-stu-id="ed7d0-147">3.26</span></span> | <span data-ttu-id="ed7d0-148">11.92</span><span class="sxs-lookup"><span data-stu-id="ed7d0-148">11.92</span></span> | <span data-ttu-id="ed7d0-149">266%</span><span class="sxs-lookup"><span data-stu-id="ed7d0-149">266%</span></span> |
| <span data-ttu-id="ed7d0-150">**受信した KB**</span><span class="sxs-lookup"><span data-stu-id="ed7d0-150">**KB Received**</span></span> | <span data-ttu-id="ed7d0-151">388.51</span><span class="sxs-lookup"><span data-stu-id="ed7d0-151">388.51</span></span> | <span data-ttu-id="ed7d0-152">530</span><span class="sxs-lookup"><span data-stu-id="ed7d0-152">530</span></span> | <span data-ttu-id="ed7d0-153">36%</span><span class="sxs-lookup"><span data-stu-id="ed7d0-153">36%</span></span> |
| <span data-ttu-id="ed7d0-154">**読み込み時間**</span><span class="sxs-lookup"><span data-stu-id="ed7d0-154">**Load Time**</span></span> | <span data-ttu-id="ed7d0-155">510ミリ秒</span><span class="sxs-lookup"><span data-stu-id="ed7d0-155">510 MS</span></span> | <span data-ttu-id="ed7d0-156">780 MS</span><span class="sxs-lookup"><span data-stu-id="ed7d0-156">780 MS</span></span> | <span data-ttu-id="ed7d0-157">53%</span><span class="sxs-lookup"><span data-stu-id="ed7d0-157">53%</span></span> |

<span data-ttu-id="ed7d0-158">送信されるバイト数は、ブラウザーが要求に適用される HTTP ヘッダーとかなり冗長であるため、バンドルによって大幅に削減されました。</span><span class="sxs-lookup"><span data-stu-id="ed7d0-158">The bytes sent had a significant reduction with bundling as browsers are fairly verbose with the HTTP headers they apply on requests.</span></span> <span data-ttu-id="ed7d0-159">最大のファイル (*スクリプト\\jquery-ui-1.8.11* and *scripts\\jquery-1.7.1*) は、既に縮小されているため、受信バイト数の減少はそれほど大きくありません。</span><span class="sxs-lookup"><span data-stu-id="ed7d0-159">The received bytes reduction is not as large because the largest files (*Scripts\\jquery-ui-1.8.11.min.js* and *Scripts\\jquery-1.7.1.min.js*) are already minified.</span></span> <span data-ttu-id="ed7d0-160">メモ:サンプルプログラムのタイミングでは、 [Fiddler](http://www.fiddler2.com/fiddler2/)ツールを使用して低速ネットワークをシミュレートしていました。</span><span class="sxs-lookup"><span data-stu-id="ed7d0-160">Note: The timings on the sample program used the [Fiddler](http://www.fiddler2.com/fiddler2/) tool to simulate a slow network.</span></span> <span data-ttu-id="ed7d0-161">(Fiddler の **[規則]** メニューで、 **[パフォーマンス]** 、 **[モデムの速度をシミュレート]** する の順に選択します)。</span><span class="sxs-lookup"><span data-stu-id="ed7d0-161">(From the Fiddler **Rules** menu, select **Performance** then **Simulate Modem Speeds**.)</span></span>

## <a name="debugging-bundled-and-minified-javascript"></a><span data-ttu-id="ed7d0-162">バンドルされた、縮小された JavaScript のデバッグ</span><span class="sxs-lookup"><span data-stu-id="ed7d0-162">Debugging Bundled and Minified JavaScript</span></span>

<span data-ttu-id="ed7d0-163">Javascript ファイルがバンドルまたは縮小されていないため、開発環境で JavaScript を簡単にデバッグ*できます (web.config ファイルの*[コンパイル要素](https://msdn.microsoft.com/library/s10awwz0.aspx)は `debug="true"` に設定されています)。</span><span class="sxs-lookup"><span data-stu-id="ed7d0-163">It's easy to debug your JavaScript in a development environment (where the [compilation Element](https://msdn.microsoft.com/library/s10awwz0.aspx) in the *Web.config* file is set to `debug="true"` ) because the JavaScript files are not bundled or minified.</span></span> <span data-ttu-id="ed7d0-164">JavaScript ファイルがバンドルおよび縮小されたリリースビルドをデバッグすることもできます。</span><span class="sxs-lookup"><span data-stu-id="ed7d0-164">You can also debug a release build where your JavaScript files are bundled and minified.</span></span> <span data-ttu-id="ed7d0-165">IE F12 開発者ツールを使用すると、次の方法を使用して、縮小されたバンドルに含まれる JavaScript 関数をデバッグできます。</span><span class="sxs-lookup"><span data-stu-id="ed7d0-165">Using the IE F12 developer tools, you debug a JavaScript function included in a minified bundle using the following approach:</span></span>

1. <span data-ttu-id="ed7d0-166">**[スクリプト]** タブを選択し、 **[デバッグの開始]** ボタンを選択します。</span><span class="sxs-lookup"><span data-stu-id="ed7d0-166">Select the **Script** tab and then select the **Start debugging** button.</span></span>
2. <span data-ttu-id="ed7d0-167">[アセット] ボタンを使用して、デバッグする JavaScript 関数を含むバンドルを選択します。</span><span class="sxs-lookup"><span data-stu-id="ed7d0-167">Select the bundle containing the JavaScript function you want to debug using the assets button.</span></span>  
    ![](bundling-and-minification/_static/image4.png)
3. <span data-ttu-id="ed7d0-168">[**構成] ボタン**![](bundling-and-minification/_static/image5.png)を選択し、 **[Javascript の書式設定]** を選択して、表示されている javascript の書式を設定します。</span><span class="sxs-lookup"><span data-stu-id="ed7d0-168">Format the minified JavaScript by selecting the **Configuration button** ![](bundling-and-minification/_static/image5.png), and then selecting **Format JavaScript**.</span></span>
4. <span data-ttu-id="ed7d0-169">**[検索スクリプト]** 入力ボックスで、デバッグする関数の名前を選択します。</span><span class="sxs-lookup"><span data-stu-id="ed7d0-169">In the **Search Script** input box, select the name of the function you want to debug.</span></span> <span data-ttu-id="ed7d0-170">次の図では、 **[検索スクリプト]** 入力ボックスに**Addalttoimg**が入力されています。</span><span class="sxs-lookup"><span data-stu-id="ed7d0-170">In the following image, **AddAltToImg** was entered in the **Search Script** input box.</span></span>  
    ![](bundling-and-minification/_static/image6.png)

<span data-ttu-id="ed7d0-171">F12 開発者ツールを使用したデバッグの詳細については、MSDN の記事「 [f12 開発者ツールを使用した JavaScript エラーのデバッグ」を](https://msdn.microsoft.com/library/ie/gg699336(v=vs.85).aspx)参照してください。</span><span class="sxs-lookup"><span data-stu-id="ed7d0-171">For more information on debugging with the F12 developer tools, see the MSDN article [Using the F12 Developer Tools to Debug JavaScript Errors](https://msdn.microsoft.com/library/ie/gg699336(v=vs.85).aspx).</span></span>

## <a name="controlling-bundling-and-minification"></a><span data-ttu-id="ed7d0-172">バンドルと縮小の制御</span><span class="sxs-lookup"><span data-stu-id="ed7d0-172">Controlling Bundling and Minification</span></span>

<span data-ttu-id="ed7d0-173">バンドルと縮小*は、web.config ファイルの*[コンパイル要素](https://msdn.microsoft.com/library/s10awwz0.aspx)の debug 属性の値を設定することによって有効または無効になります。</span><span class="sxs-lookup"><span data-stu-id="ed7d0-173">Bundling and minification is enabled or disabled by setting the value of the debug attribute in the [compilation Element](https://msdn.microsoft.com/library/s10awwz0.aspx)  in the *Web.config* file.</span></span> <span data-ttu-id="ed7d0-174">次の XML では、バンドルと縮小が無効になるように `debug` が true に設定されています。</span><span class="sxs-lookup"><span data-stu-id="ed7d0-174">In the following XML, `debug` is set to true so bundling and minification is disabled.</span></span>

[!code-xml[Main](bundling-and-minification/samples/sample3.xml?highlight=2)]

<span data-ttu-id="ed7d0-175">バンドルと縮小を有効にするには、`debug` 値を "false" に設定します。</span><span class="sxs-lookup"><span data-stu-id="ed7d0-175">To enable bundling and minification, set the `debug` value to "false".</span></span> <span data-ttu-id="ed7d0-176">`BundleTable` クラスの `EnableOptimizations` プロパティを*使用して web.config 設定を*オーバーライドできます。</span><span class="sxs-lookup"><span data-stu-id="ed7d0-176">You can override the *Web.config* setting with the `EnableOptimizations` property on the `BundleTable` class.</span></span> <span data-ttu-id="ed7d0-177">次のコードを使用すると、バンドルと縮小が可能に*なり、web.config ファイルの*設定が上書きされます。</span><span class="sxs-lookup"><span data-stu-id="ed7d0-177">The following code enables bundling and minification and overrides any setting in the *Web.config* file.</span></span>

[!code-csharp[Main](bundling-and-minification/samples/sample4.cs?highlight=7)]

> [!NOTE]
> <span data-ttu-id="ed7d0-178">`EnableOptimizations` が `true` さ*れてい*ない場合、または web.config ファイルの[コンパイル要素](https://msdn.microsoft.com/library/s10awwz0.aspx)の debug 属性が `false`に設定されている場合を除き、ファイルはバンドルまたは縮小されません。</span><span class="sxs-lookup"><span data-stu-id="ed7d0-178">Unless `EnableOptimizations` is `true` or the debug attribute in the [compilation Element](https://msdn.microsoft.com/library/s10awwz0.aspx)  in the *Web.config* file is set to `false`, files will not be bundled or minified.</span></span> <span data-ttu-id="ed7d0-179">また、ファイルの最小バージョンが使用されないため、完全なデバッグバージョンが選択されます。</span><span class="sxs-lookup"><span data-stu-id="ed7d0-179">Additionally, the .min version of files will not be used, the full debug versions will be selected.</span></span> <span data-ttu-id="ed7d0-180">`EnableOptimizations` は、web.config ファイルの[コンパイル要素](https://msdn.microsoft.com/library/s10awwz0.aspx)の debug 属性よりも優先され*ます。*</span><span class="sxs-lookup"><span data-stu-id="ed7d0-180">`EnableOptimizations` overrides the debug attribute in the [compilation Element](https://msdn.microsoft.com/library/s10awwz0.aspx)  in the *Web.config* file</span></span>

## <a name="using-bundling-and-minification-with-aspnet-web-forms-and-web-pages"></a><span data-ttu-id="ed7d0-181">ASP.NET Web フォームと Web ページでのバンドルと縮小の使用</span><span class="sxs-lookup"><span data-stu-id="ed7d0-181">Using Bundling and Minification with ASP.NET Web Forms and Web Pages</span></span>

- <span data-ttu-id="ed7d0-182">Web ページについては、web[ページサイトへの Web 最適化の追加に](https://docs.microsoft.com/archive/blogs/rickandy/adding-web-optimization-to-a-web-pages-site)関するブログエントリを参照してください。</span><span class="sxs-lookup"><span data-stu-id="ed7d0-182">For Web Pages, see the blog entry [Adding Web Optimization to a Web Pages Site](https://docs.microsoft.com/archive/blogs/rickandy/adding-web-optimization-to-a-web-pages-site).</span></span>
- <span data-ttu-id="ed7d0-183">Web フォームについては、 [Web フォームへのバンドルと縮小の追加に](https://docs.microsoft.com/archive/blogs/rickandy/adding-bundling-and-minification-to-web-forms)関するブログエントリを参照してください。</span><span class="sxs-lookup"><span data-stu-id="ed7d0-183">For Web Forms, see the blog entry [Adding Bundling and Minification to Web Forms](https://docs.microsoft.com/archive/blogs/rickandy/adding-bundling-and-minification-to-web-forms).</span></span>

## <a name="using-bundling-and-minification-with-aspnet-mvc"></a><span data-ttu-id="ed7d0-184">ASP.NET MVC でのバンドルと縮小の使用</span><span class="sxs-lookup"><span data-stu-id="ed7d0-184">Using Bundling and Minification with ASP.NET MVC</span></span>

<span data-ttu-id="ed7d0-185">このセクションでは、ASP.NET MVC プロジェクトを作成して、バンドルと縮小を確認します。</span><span class="sxs-lookup"><span data-stu-id="ed7d0-185">In this section we will create an ASP.NET MVC project to examine bundling and minification.</span></span> <span data-ttu-id="ed7d0-186">まず、既定値を変更せずに、 **Mvcbm**という名前の新しい ASP.NET MVC インターネットプロジェクトを作成します。</span><span class="sxs-lookup"><span data-stu-id="ed7d0-186">First, create a new ASP.NET MVC internet project named **MvcBM** without changing any of the defaults.</span></span>

<span data-ttu-id="ed7d0-187">*アプリ\\を開き \_\\BundleConfig.cs*ファイルを起動し、バンドルの作成、登録、および構成に使用される `RegisterBundles` 方法を確認します。</span><span class="sxs-lookup"><span data-stu-id="ed7d0-187">Open the *App\\\_Start\\BundleConfig.cs* file and examine the `RegisterBundles` method which is used to create, register and configure bundles.</span></span> <span data-ttu-id="ed7d0-188">次のコードは、`RegisterBundles` メソッドの一部を示しています。</span><span class="sxs-lookup"><span data-stu-id="ed7d0-188">The following code shows a portion of the `RegisterBundles` method.</span></span>

[!code-csharp[Main](bundling-and-minification/samples/sample5.cs)]

<span data-ttu-id="ed7d0-189">上記のコードは、すべての適切な (デバッグまたは縮小) を含む、 */bundles/jquery*という名前の新しい JavaScript バンドルを作成します。*vsdoc*) ワイルドカード文字列 "~/Scripts/jquery-{version}.js" に一致する*Scripts*フォルダー内のファイル。</span><span class="sxs-lookup"><span data-stu-id="ed7d0-189">The  preceding code creates a new JavaScript bundle named *~/bundles/jquery* that includes all the appropriate (that is debug or minified but not .*vsdoc*) files in the *Scripts* folder that match the wild card string "~/Scripts/jquery-{version}.js".</span></span> <span data-ttu-id="ed7d0-190">ASP.NET MVC 4 の場合、これはデバッグ構成で、ファイル*jquery-1.7.1*がバンドルに追加されることを意味します。</span><span class="sxs-lookup"><span data-stu-id="ed7d0-190">For ASP.NET MVC 4, this means with a debug configuration, the file *jquery-1.7.1.js* will be added to the bundle.</span></span> <span data-ttu-id="ed7d0-191">リリース構成では、 *jquery-1.7.1*が追加されます。</span><span class="sxs-lookup"><span data-stu-id="ed7d0-191">In a release configuration, *jquery-1.7.1.min.js* will be added.</span></span> <span data-ttu-id="ed7d0-192">バンドルフレームワークは、次のようないくつかの一般的な規則に従います。</span><span class="sxs-lookup"><span data-stu-id="ed7d0-192">The bundling framework follows several common conventions such as:</span></span>

- <span data-ttu-id="ed7d0-193">ファイルが存在*する場合に*、release の ". min" ファイルを選択*します*。</span><span class="sxs-lookup"><span data-stu-id="ed7d0-193">Selecting ".min" file for release when *FileX.min.js* and *FileX.js* exist.</span></span>
- <span data-ttu-id="ed7d0-194">デバッグの非 ". min" バージョンを選択しています。</span><span class="sxs-lookup"><span data-stu-id="ed7d0-194">Selecting the non ".min" version for debug.</span></span>
- <span data-ttu-id="ed7d0-195">"-Vsdoc" ファイル ( *jquery-1.7.1*など) は無視されます。これは、IntelliSense によってのみ使用されます。</span><span class="sxs-lookup"><span data-stu-id="ed7d0-195">Ignoring "-vsdoc" files (such as *jquery-1.7.1-vsdoc.js*), which are used only by IntelliSense.</span></span>

<span data-ttu-id="ed7d0-196">上に示した `{version}` ワイルドカード一致は、適切なバージョンの jQuery を*Scripts*フォルダーに自動的に作成するために使用されます。</span><span class="sxs-lookup"><span data-stu-id="ed7d0-196">The `{version}` wild card matching shown above is used to automatically create a jQuery bundle with the appropriate version of jQuery in your *Scripts* folder.</span></span> <span data-ttu-id="ed7d0-197">この例では、ワイルドカードを使用すると、次のような利点があります。</span><span class="sxs-lookup"><span data-stu-id="ed7d0-197">In this example, using a wild card provides the following benefits:</span></span>

- <span data-ttu-id="ed7d0-198">では、ビューページで前のバンドルコードや jQuery 参照を変更することなく、NuGet を使用して新しい jQuery バージョンに更新することができます。</span><span class="sxs-lookup"><span data-stu-id="ed7d0-198">Allows you to use NuGet to update to a newer jQuery version without changing the preceding bundling code or jQuery references in your view pages.</span></span>
- <span data-ttu-id="ed7d0-199">では、デバッグ構成の完全バージョンと、リリースビルドの ". 分" バージョンが自動的に選択されます。</span><span class="sxs-lookup"><span data-stu-id="ed7d0-199">Automatically selects the full version for debug configurations and the ".min" version for release builds.</span></span>

## <a name="using-a-cdn"></a><span data-ttu-id="ed7d0-200">CDN の使用</span><span class="sxs-lookup"><span data-stu-id="ed7d0-200">Using a CDN</span></span>

 <span data-ttu-id="ed7d0-201">次のコードは、ローカルの jQuery バンドルを CDN jQuery バンドルに置き換えます。</span><span class="sxs-lookup"><span data-stu-id="ed7d0-201">The follow code replaces the local jQuery bundle with a CDN jQuery bundle.</span></span>

[!code-csharp[Main](bundling-and-minification/samples/sample6.cs)]

<span data-ttu-id="ed7d0-202">上記のコードでは、リリースモードでは CDN から jQuery が要求され、デバッグバージョンの jQuery はデバッグモードでローカルにフェッチされます。</span><span class="sxs-lookup"><span data-stu-id="ed7d0-202">In the code above, jQuery will be requested from the CDN while in release mode and the debug version of jQuery will be fetched locally in debug mode.</span></span> <span data-ttu-id="ed7d0-203">CDN を使用する場合は、CDN 要求が失敗した場合に備えてフォールバックメカニズムが必要です。</span><span class="sxs-lookup"><span data-stu-id="ed7d0-203">When using a CDN, you should have a fallback mechanism in case the CDN request fails.</span></span> <span data-ttu-id="ed7d0-204">レイアウトファイルの末尾にある次のマークアップフラグメントは、CDN が失敗したことを要求するために追加されたスクリプトを示しています。</span><span class="sxs-lookup"><span data-stu-id="ed7d0-204">The following markup fragment from the end of the layout file shows script added to request jQuery should the CDN fail.</span></span>

[!code-cshtml[Main](bundling-and-minification/samples/sample7.cshtml?highlight=5-13)]

## <a name="creating-a-bundle"></a><span data-ttu-id="ed7d0-205">バンドルの作成</span><span class="sxs-lookup"><span data-stu-id="ed7d0-205">Creating a Bundle</span></span>

<span data-ttu-id="ed7d0-206">[バンドル](https://msdn.microsoft.com/library/system.web.optimization.bundle(v=VS.110).aspx)クラス `Include` メソッドは、文字列の配列を受け取ります。各文字列はリソースへの仮想パスです。</span><span class="sxs-lookup"><span data-stu-id="ed7d0-206">The [Bundle](https://msdn.microsoft.com/library/system.web.optimization.bundle(v=VS.110).aspx) class `Include` method takes an array of strings, where each string is a virtual path to resource.</span></span> <span data-ttu-id="ed7d0-207">アプリの `RegisterBundles` メソッドの次のコードでは *\\BundleConfig.cs file の開始 \_\\* 、バンドルへの複数のファイルの追加方法を示しています。</span><span class="sxs-lookup"><span data-stu-id="ed7d0-207">The following code from the `RegisterBundles` method in the *App\\\_Start\\BundleConfig.cs* file shows how multiple files are added to a bundle:</span></span>

[!code-csharp[Main](bundling-and-minification/samples/sample8.cs)]

<span data-ttu-id="ed7d0-208">[バンドル](https://msdn.microsoft.com/library/system.web.optimization.bundle(v=VS.110).aspx)クラス `IncludeDirectory` メソッドは、検索パターンに一致するディレクトリ (および必要に応じてすべてのサブディレクトリ) 内のすべてのファイルを追加するために用意されています。</span><span class="sxs-lookup"><span data-stu-id="ed7d0-208">The [Bundle](https://msdn.microsoft.com/library/system.web.optimization.bundle(v=VS.110).aspx) class `IncludeDirectory` method is provided to add all the files in a directory (and optionally all subdirectories) which match a search pattern.</span></span> <span data-ttu-id="ed7d0-209">[バンドル](https://msdn.microsoft.com/library/system.web.optimization.bundle(v=VS.110).aspx)クラス `IncludeDirectory` API を以下に示します。</span><span class="sxs-lookup"><span data-stu-id="ed7d0-209">The [Bundle](https://msdn.microsoft.com/library/system.web.optimization.bundle(v=VS.110).aspx) class `IncludeDirectory` API is shown below:</span></span>

[!code-csharp[Main](bundling-and-minification/samples/sample9.cs)]

<span data-ttu-id="ed7d0-210">バンドルは、Render メソッドを使用してビュー内で参照されます (CSS の場合は`Styles.Render`、JavaScript の場合は `Scripts.Render`)。</span><span class="sxs-lookup"><span data-stu-id="ed7d0-210">Bundles are referenced in views using the Render method, (`Styles.Render` for CSS and `Scripts.Render` for JavaScript).</span></span> <span data-ttu-id="ed7d0-211">*Views\\Shared \_\\のビュー*の次のマークアップは、既定の ASP.NET internet プロジェクトビューが CSS と JavaScript バンドルを参照する方法を示しています。</span><span class="sxs-lookup"><span data-stu-id="ed7d0-211">The following markup from the *Views\\Shared\\\_Layout.cshtml* file shows how the default ASP.NET internet project views reference CSS and JavaScript bundles.</span></span>

[!code-cshtml[Main](bundling-and-minification/samples/sample10.cshtml?highlight=5-6,11)]

<span data-ttu-id="ed7d0-212">Render メソッドが文字列の配列を受け取ることに注意してください。そのため、1行のコードに複数のバンドルを追加できます。</span><span class="sxs-lookup"><span data-stu-id="ed7d0-212">Notice the Render methods takes an array of strings, so you can add multiple bundles in one line of code.</span></span> <span data-ttu-id="ed7d0-213">通常は、アセットを参照するために必要な HTML を作成する Render メソッドを使用します。</span><span class="sxs-lookup"><span data-stu-id="ed7d0-213">You will generally want to use the Render methods which create the necessary HTML to reference the asset.</span></span> <span data-ttu-id="ed7d0-214">`Url` メソッドを使用して、資産を参照するために必要なマークアップなしでアセットへの URL を生成できます。</span><span class="sxs-lookup"><span data-stu-id="ed7d0-214">You can use the `Url` method to generate the URL to the asset without the markup needed to reference the asset.</span></span> <span data-ttu-id="ed7d0-215">新しい HTML5[非同期](http://www.whatwg.org/specs/web-apps/current-work/#attr-script-async)属性を使用するとします。</span><span class="sxs-lookup"><span data-stu-id="ed7d0-215">Suppose you wanted to use the new HTML5 [async](http://www.whatwg.org/specs/web-apps/current-work/#attr-script-async) attribute.</span></span> <span data-ttu-id="ed7d0-216">次のコードは、`Url` メソッドを使用して、modernizr を参照する方法を示しています。</span><span class="sxs-lookup"><span data-stu-id="ed7d0-216">The following code shows how to reference modernizr using the `Url` method.</span></span>

[!code-cshtml[Main](bundling-and-minification/samples/sample11.cshtml?highlight=11)]

## <a name="using-the--wildcard-character-to-select-files"></a><span data-ttu-id="ed7d0-217">"\*" ワイルドカード文字を使用したファイルの選択</span><span class="sxs-lookup"><span data-stu-id="ed7d0-217">Using the "\*" Wildcard Character to Select Files</span></span>

<span data-ttu-id="ed7d0-218">`Include` メソッドで指定した仮想パスと、`IncludeDirectory` メソッドの検索パターンでは、最後のパスセグメントののプレフィックスまたはサフィックスとして、1つの "\*" ワイルドカード文字を使用できます。</span><span class="sxs-lookup"><span data-stu-id="ed7d0-218">The virtual path specified in the `Include` method and the search pattern in the `IncludeDirectory` method can accept one "\*" wildcard character as a prefix or suffix to in the last path segment.</span></span> <span data-ttu-id="ed7d0-219">検索文字列の大文字と小文字は区別されません。</span><span class="sxs-lookup"><span data-stu-id="ed7d0-219">The search string is case insensitive.</span></span> <span data-ttu-id="ed7d0-220">`IncludeDirectory` メソッドには、サブディレクトリを検索するオプションがあります。</span><span class="sxs-lookup"><span data-stu-id="ed7d0-220">The `IncludeDirectory` method has the option of searching subdirectories.</span></span>

<span data-ttu-id="ed7d0-221">次の JavaScript ファイルを含むプロジェクトを考えてみましょう。</span><span class="sxs-lookup"><span data-stu-id="ed7d0-221">Consider a project with the following JavaScript files:</span></span>

- <span data-ttu-id="ed7d0-222">*スクリプト\\共通\\AddAltToImg*</span><span class="sxs-lookup"><span data-stu-id="ed7d0-222">*Scripts\\Common\\AddAltToImg.js*</span></span>
- <span data-ttu-id="ed7d0-223">*スクリプト\\共通\\ToggleDiv*</span><span class="sxs-lookup"><span data-stu-id="ed7d0-223">*Scripts\\Common\\ToggleDiv.js*</span></span>
- <span data-ttu-id="ed7d0-224">*スクリプト\\共通\\ToggleImg*</span><span class="sxs-lookup"><span data-stu-id="ed7d0-224">*Scripts\\Common\\ToggleImg.js*</span></span>
- <span data-ttu-id="ed7d0-225">*スクリプト\\共通\\Sub1\\ToggleLinks*</span><span class="sxs-lookup"><span data-stu-id="ed7d0-225">*Scripts\\Common\\Sub1\\ToggleLinks.js*</span></span>

![dir imag](bundling-and-minification/_static/image7.png)

<span data-ttu-id="ed7d0-227">次の表は、ワイルドカードを使用してバンドルに追加されるファイルを示しています。</span><span class="sxs-lookup"><span data-stu-id="ed7d0-227">The following table shows the files added to a bundle using the wildcard as shown:</span></span>

| <span data-ttu-id="ed7d0-228">**Call**</span><span class="sxs-lookup"><span data-stu-id="ed7d0-228">**Call**</span></span> | <span data-ttu-id="ed7d0-229">**追加または例外が発生したファイル**</span><span class="sxs-lookup"><span data-stu-id="ed7d0-229">**Files Added or Exception Raised**</span></span> |
| --- | --- |
| <span data-ttu-id="ed7d0-230">Include("~/Scripts/Common/\*.js")</span><span class="sxs-lookup"><span data-stu-id="ed7d0-230">Include("~/Scripts/Common/\*.js")</span></span> | <span data-ttu-id="ed7d0-231">*Addalttoimg .js*、 *ToggleDiv*、 *ToggleImg*</span><span class="sxs-lookup"><span data-stu-id="ed7d0-231">*AddAltToImg.js*, *ToggleDiv.js*, *ToggleImg.js*</span></span> |
| <span data-ttu-id="ed7d0-232">Include("~/Scripts/Common/T\*.js")</span><span class="sxs-lookup"><span data-stu-id="ed7d0-232">Include("~/Scripts/Common/T\*.js")</span></span> | <span data-ttu-id="ed7d0-233">無効なパターン例外です。</span><span class="sxs-lookup"><span data-stu-id="ed7d0-233">Invalid pattern exception.</span></span> <span data-ttu-id="ed7d0-234">ワイルドカード文字は、プレフィックスまたはサフィックスに対してのみ使用できます。</span><span class="sxs-lookup"><span data-stu-id="ed7d0-234">The wildcard character is only allowed on the prefix or suffix.</span></span> |
| <span data-ttu-id="ed7d0-235">Include("~/Scripts/Common/\*og.\*")</span><span class="sxs-lookup"><span data-stu-id="ed7d0-235">Include("~/Scripts/Common/\*og.\*")</span></span> | <span data-ttu-id="ed7d0-236">無効なパターン例外です。</span><span class="sxs-lookup"><span data-stu-id="ed7d0-236">Invalid pattern exception.</span></span> <span data-ttu-id="ed7d0-237">ワイルドカード文字は1つだけ使用できます。</span><span class="sxs-lookup"><span data-stu-id="ed7d0-237">Only one wildcard character is allowed.</span></span> |
| <span data-ttu-id="ed7d0-238">Include ("~/スクリプト/Common/t\*")</span><span class="sxs-lookup"><span data-stu-id="ed7d0-238">Include("~/Scripts/Common/T\*")</span></span> | <span data-ttu-id="ed7d0-239">*ToggleDiv*、 *ToggleImg*</span><span class="sxs-lookup"><span data-stu-id="ed7d0-239">*ToggleDiv.js*, *ToggleImg.js*</span></span> |
| <span data-ttu-id="ed7d0-240">Include ("~/スクリプト/Common/\*")</span><span class="sxs-lookup"><span data-stu-id="ed7d0-240">Include("~/Scripts/Common/\*")</span></span> | <span data-ttu-id="ed7d0-241">無効なパターン例外です。</span><span class="sxs-lookup"><span data-stu-id="ed7d0-241">Invalid pattern exception.</span></span> <span data-ttu-id="ed7d0-242">純粋ワイルドカードセグメントが無効です。</span><span class="sxs-lookup"><span data-stu-id="ed7d0-242">A pure wildcard segment is not valid.</span></span> |
| <span data-ttu-id="ed7d0-243">IncludeDirectory("~/Scripts/Common", "T\*")</span><span class="sxs-lookup"><span data-stu-id="ed7d0-243">IncludeDirectory("~/Scripts/Common", "T\*")</span></span> | <span data-ttu-id="ed7d0-244">*ToggleDiv*、 *ToggleImg*</span><span class="sxs-lookup"><span data-stu-id="ed7d0-244">*ToggleDiv.js*, *ToggleImg.js*</span></span> |
| <span data-ttu-id="ed7d0-245">IncludeDirectory ("~/スクリプト/共通"、"T\*"、true)</span><span class="sxs-lookup"><span data-stu-id="ed7d0-245">IncludeDirectory("~/Scripts/Common", "T\*", true)</span></span> | <span data-ttu-id="ed7d0-246">*ToggleDiv*、 *ToggleImg*、 *ToggleLinks*のようになります。</span><span class="sxs-lookup"><span data-stu-id="ed7d0-246">*ToggleDiv.js*, *ToggleImg.js*, *ToggleLinks.js*</span></span> |

<span data-ttu-id="ed7d0-247">一般に、各ファイルをバンドルに明示的に追加することは、次のような理由で、ファイルのワイルドカード読み込みよりも優先されます。</span><span class="sxs-lookup"><span data-stu-id="ed7d0-247">Explicitly adding each file to a bundle is generally the preferred over wildcard loading of files for the following reasons:</span></span>

- <span data-ttu-id="ed7d0-248">ワイルドカードを使用してスクリプトを追加すると、既定ではアルファベット順に読み込まれます。これは通常は必要ありません。</span><span class="sxs-lookup"><span data-stu-id="ed7d0-248">Adding scripts by wildcard defaults to loading them in alphabetical order, which is typically not what you want.</span></span> <span data-ttu-id="ed7d0-249">CSS ファイルと JavaScript ファイルは、多くの場合、特定の (アルファベット順ではない) 順序で追加する必要があります。</span><span class="sxs-lookup"><span data-stu-id="ed7d0-249">CSS and JavaScript files frequently need to be added in a specific (non-alphabetic) order.</span></span> <span data-ttu-id="ed7d0-250">このリスクを軽減するには、カスタム[IBundleOrderer](https://msdn.microsoft.com/library/system.web.optimization.ibundleorderer(VS.110).aspx)実装を追加しますが、各ファイルを明示的に追加するとエラーが発生しやすくなります。</span><span class="sxs-lookup"><span data-stu-id="ed7d0-250">You can mitigate this risk by adding a custom [IBundleOrderer](https://msdn.microsoft.com/library/system.web.optimization.ibundleorderer(VS.110).aspx) implementation, but explicitly adding each file is less error prone.</span></span> <span data-ttu-id="ed7d0-251">たとえば、将来的にはフォルダーに新しい資産を追加し、 [IBundleOrderer](https://msdn.microsoft.com/library/system.web.optimization.ibundleorderer(VS.110).aspx)の実装を変更することが必要になる場合があります。</span><span class="sxs-lookup"><span data-stu-id="ed7d0-251">For example, you might add new assets to a folder in the future which might require you to modify your [IBundleOrderer](https://msdn.microsoft.com/library/system.web.optimization.ibundleorderer(VS.110).aspx) implementation.</span></span>
- <span data-ttu-id="ed7d0-252">ワイルドカードによる読み込みを使用してディレクトリに追加された特定のファイルを表示すると、そのバンドルを参照するすべてのビューに含めることができます。</span><span class="sxs-lookup"><span data-stu-id="ed7d0-252">View specific files added to a directory using wild card loading can be included in all views referencing that bundle.</span></span> <span data-ttu-id="ed7d0-253">ビュー固有のスクリプトがバンドルに追加されると、バンドルを参照する他のビューで JavaScript エラーが発生することがあります。</span><span class="sxs-lookup"><span data-stu-id="ed7d0-253">If the view specific script is added to a bundle, you may get a JavaScript error on other views that reference the bundle.</span></span>
- <span data-ttu-id="ed7d0-254">他のファイルをインポートする CSS ファイルは、インポートされたファイルを2回読み込むことになります。</span><span class="sxs-lookup"><span data-stu-id="ed7d0-254">CSS files that import other files result in the imported files loaded twice.</span></span> <span data-ttu-id="ed7d0-255">たとえば、次のコードでは、ほとんどの jQuery UI テーマ CSS ファイルが2回読み込まれたバンドルが作成されます。</span><span class="sxs-lookup"><span data-stu-id="ed7d0-255">For example, the following code creates a bundle with most of the jQuery UI theme CSS files loaded twice.</span></span> 

    [!code-csharp[Main](bundling-and-minification/samples/sample12.cs)]

  <span data-ttu-id="ed7d0-256">ワイルドカードセレクター "\*.css" は、フォルダー内の各 CSS ファイル (*コンテンツ\\テーマ\\base\\jquery. ui. すべての .css*ファイル) を取り込みます。</span><span class="sxs-lookup"><span data-stu-id="ed7d0-256">The wild card selector "\*.css" brings in each CSS file in the folder, including the *Content\\themes\\base\\jquery.ui.all.css* file.</span></span> <span data-ttu-id="ed7d0-257">*すべての .css*ファイルは、他の css ファイルをインポートします。</span><span class="sxs-lookup"><span data-stu-id="ed7d0-257">The *jquery.ui.all.css* file imports other CSS files.</span></span>

## <a name="bundle-caching"></a><span data-ttu-id="ed7d0-258">バンドルキャッシュ</span><span class="sxs-lookup"><span data-stu-id="ed7d0-258">Bundle Caching</span></span>

<span data-ttu-id="ed7d0-259">バンドルは、バンドルの作成時に、HTTP Expires ヘッダーを1年に設定します。</span><span class="sxs-lookup"><span data-stu-id="ed7d0-259">Bundles set the HTTP Expires Header one year from when the bundle is created.</span></span> <span data-ttu-id="ed7d0-260">以前に表示されていたページに移動した場合、Fiddler は、バンドルに対する条件付き要求を作成しないことを示します。つまり、バンドルに対する IE からの HTTP GET 要求とサーバーからの HTTP 304 応答がありません。</span><span class="sxs-lookup"><span data-stu-id="ed7d0-260">If you navigate to a previously viewed page, Fiddler shows IE does not make a conditional request for the bundle, that is, there are no HTTP GET requests from IE for the bundles and no HTTP 304 responses from the server.</span></span> <span data-ttu-id="ed7d0-261">F5 キーを使用して各バンドルの条件付き要求を実行するように、IE に強制することができます (その結果、各バンドルに対して HTTP 304 応答が返されます)。</span><span class="sxs-lookup"><span data-stu-id="ed7d0-261">You can force IE to make a conditional request for each bundle with the F5 key (resulting in a HTTP 304 response for each bundle).</span></span> <span data-ttu-id="ed7d0-262">^ F5 を使用して完全更新を強制的に実行できます (その結果、各バンドルに対して HTTP 200 応答が返されます)。</span><span class="sxs-lookup"><span data-stu-id="ed7d0-262">You can force a full refresh by using ^F5 (resulting in a HTTP 200 response for each bundle.)</span></span>

<span data-ttu-id="ed7d0-263">次の図は、Fiddler response ウィンドウの **キャッシュ** タブを示しています。</span><span class="sxs-lookup"><span data-stu-id="ed7d0-263">The following image shows the **Caching** tab of the Fiddler response pane:</span></span>

![fiddler キャッシュイメージ](bundling-and-minification/_static/image8.png)

<span data-ttu-id="ed7d0-265">要求</span><span class="sxs-lookup"><span data-stu-id="ed7d0-265">The request</span></span>   
`http://localhost/MvcBM_time/bundles/AllMyScripts?v=r0sLDicvP58AIXN_mc3QdyVvVj5euZNzdsa2N1PKvb81`  
 <span data-ttu-id="ed7d0-266">はバンドル**Allmyscripts**用であり、クエリ文字列 pair **v = R0sLDicvP58AIXN\\\_mc3QdyVvVj5euZNzdsa2N1PKvb81**を含んでいます。</span><span class="sxs-lookup"><span data-stu-id="ed7d0-266">is for the bundle **AllMyScripts** and contains a query string pair **v=r0sLDicvP58AIXN\\\_mc3QdyVvVj5euZNzdsa2N1PKvb81**.</span></span> <span data-ttu-id="ed7d0-267">クエリ文字列**v**には、キャッシュに使用される一意の識別子である値トークンがあります。</span><span class="sxs-lookup"><span data-stu-id="ed7d0-267">The query string **v** has a value token that is a unique identifier used for caching.</span></span> <span data-ttu-id="ed7d0-268">バンドルが変更されない限り、ASP.NET アプリケーションはこのトークンを使用して**Allmyscripts**バンドルを要求します。</span><span class="sxs-lookup"><span data-stu-id="ed7d0-268">As long as the bundle doesn't change, the ASP.NET application will request the **AllMyScripts** bundle using this token.</span></span> <span data-ttu-id="ed7d0-269">バンドル内のいずれかのファイルが変更された場合、ASP.NET optimization framework は新しいトークンを生成します。これにより、バンドルに対するブラウザーの要求が最新のバンドルを取得することが保証されます。</span><span class="sxs-lookup"><span data-stu-id="ed7d0-269">If any file in the bundle changes, the ASP.NET optimization framework will generate a new token, guaranteeing that browser requests for the bundle will get the latest bundle.</span></span>

<span data-ttu-id="ed7d0-270">IE9 F12 developer tools を実行し、以前に読み込まれたページに移動した場合、IE では、各バンドルに対して行われた条件付き GET 要求と、HTTP 304 を返すサーバーが誤って表示されます。</span><span class="sxs-lookup"><span data-stu-id="ed7d0-270">If you run the IE9 F12 developer tools and navigate to a previously loaded page, IE incorrectly shows conditional GET requests made to each bundle and the server returning HTTP 304.</span></span> <span data-ttu-id="ed7d0-271">IE9 に問題がある理由を確認するには、CDNs を使用したブログエントリで条件付き要求が行われたかどうかを判断し、 [Web サイトのパフォーマンスを向上させるために期限切れに](https://blogs.msdn.com/b/rickandy/archive/2011/05/21/using-cdns-to-improve-web-site-performance.aspx)します。</span><span class="sxs-lookup"><span data-stu-id="ed7d0-271">You can read why IE9 has problems determining if a conditional request was made in the blog entry [Using CDNs and Expires to Improve Web Site Performance](https://blogs.msdn.com/b/rickandy/archive/2011/05/21/using-cdns-to-improve-web-site-performance.aspx).</span></span>

## <a name="less-coffeescript-scss-sass-bundling"></a><span data-ttu-id="ed7d0-272">LESS、CoffeeScript、SCSS、Sass のバンドル。</span><span class="sxs-lookup"><span data-stu-id="ed7d0-272">LESS, CoffeeScript, SCSS, Sass Bundling.</span></span>

<span data-ttu-id="ed7d0-273">バンドルと縮小フレームワークには、 [SCSS](http://sass-lang.com/)、 [sass](http://sass-lang.com/)、 [LESS](http://www.dotlesscss.org/) 、または[Coffescript](http://coffeescript.org/)などの中間言語を処理し、縮小などの変換を結果のバンドルに適用するメカニズムが用意されています。</span><span class="sxs-lookup"><span data-stu-id="ed7d0-273">The bundling and minification framework provides a mechanism to process intermediate languages such as [SCSS](http://sass-lang.com/), [Sass](http://sass-lang.com/), [LESS](http://www.dotlesscss.org/) or [Coffeescript](http://coffeescript.org/), and apply transforms such as minification to the resulting bundle.</span></span> <span data-ttu-id="ed7d0-274">たとえば、追加する[.less](http://www.dotlesscss.org/) MVC 4 プロジェクト ファイル。</span><span class="sxs-lookup"><span data-stu-id="ed7d0-274">For example, to add [.less](http://www.dotlesscss.org/) files to your MVC 4 project:</span></span>

1. <span data-ttu-id="ed7d0-275">コンテンツの少ないフォルダーを作成します。</span><span class="sxs-lookup"><span data-stu-id="ed7d0-275">Create a folder for your LESS content.</span></span> <span data-ttu-id="ed7d0-276">次の例では、*コンテンツ\\MyLess*フォルダーを使用しています。</span><span class="sxs-lookup"><span data-stu-id="ed7d0-276">The following example uses the *Content\\MyLess* folder.</span></span>
2. <span data-ttu-id="ed7d0-277">追加、 [.less](http://www.dotlesscss.org/) NuGet パッケージ**ドット**をプロジェクトにします。</span><span class="sxs-lookup"><span data-stu-id="ed7d0-277">Add the [.less](http://www.dotlesscss.org/) NuGet package **dotless** to your project.</span></span>  
    <span data-ttu-id="ed7d0-278">![NuGet のドットのないインストール](bundling-and-minification/_static/image9.png)</span><span class="sxs-lookup"><span data-stu-id="ed7d0-278">![NuGet dotless install](bundling-and-minification/_static/image9.png)</span></span>
3. <span data-ttu-id="ed7d0-279">[IBundleTransform](https://msdn.microsoft.com/library/system.web.optimization.ibundletransform(VS.110).aspx)インターフェイスを実装するクラスを追加します。</span><span class="sxs-lookup"><span data-stu-id="ed7d0-279">Add a class that implements the [IBundleTransform](https://msdn.microsoft.com/library/system.web.optimization.ibundletransform(VS.110).aspx) interface.</span></span> <span data-ttu-id="ed7d0-280">.Less トランス フォームをプロジェクトに次のコードを追加します。</span><span class="sxs-lookup"><span data-stu-id="ed7d0-280">For the .less transform, add the following code to your project.</span></span>

    [!code-csharp[Main](bundling-and-minification/samples/sample13.cs)]
4. <span data-ttu-id="ed7d0-281">`LessTransform` と[CssMinify](https://msdn.microsoft.com/library/system.web.optimization.cssminify(VS.110).aspx)変換を使用して、LESS ファイルのバンドルを作成します。</span><span class="sxs-lookup"><span data-stu-id="ed7d0-281">Create a bundle of LESS files with the `LessTransform` and the [CssMinify](https://msdn.microsoft.com/library/system.web.optimization.cssminify(VS.110).aspx) transform.</span></span> <span data-ttu-id="ed7d0-282">*アプリ\\_Start\\BundleConfig.cs*ファイルの `RegisterBundles` メソッドに次のコードを追加します。</span><span class="sxs-lookup"><span data-stu-id="ed7d0-282">Add the following code to the `RegisterBundles` method in the *App\\_Start\\BundleConfig.cs* file.</span></span>

    [!code-csharp[Main](bundling-and-minification/samples/sample14.cs)]
5. <span data-ttu-id="ed7d0-283">LESS バンドルを参照するすべてのビューに次のコードを追加します。</span><span class="sxs-lookup"><span data-stu-id="ed7d0-283">Add the following code to any views which references the LESS bundle.</span></span>

    [!code-cshtml[Main](bundling-and-minification/samples/sample15.cshtml)]

## <a name="bundle-considerations"></a><span data-ttu-id="ed7d0-284">バンドルに関する考慮事項</span><span class="sxs-lookup"><span data-stu-id="ed7d0-284">Bundle Considerations</span></span>

<span data-ttu-id="ed7d0-285">バンドルを作成する場合は、バンドル名にプレフィックスとして "バンドル" を含めることをお勧めします。</span><span class="sxs-lookup"><span data-stu-id="ed7d0-285">A good convention to follow when creating bundles is to include "bundle" as a prefix in the bundle name.</span></span> <span data-ttu-id="ed7d0-286">これにより、[ルーティングの競合](https://forums.asp.net/post/5012037.aspx)を防ぐことができます。</span><span class="sxs-lookup"><span data-stu-id="ed7d0-286">This will prevent a possible [routing conflict](https://forums.asp.net/post/5012037.aspx).</span></span>

<span data-ttu-id="ed7d0-287">バンドル内の1つのファイルを更新すると、バンドルクエリ文字列パラメーターに対して新しいトークンが生成され、バンドルを含むページを次回クライアントが要求したときに完全なバンドルをダウンロードする必要があります。</span><span class="sxs-lookup"><span data-stu-id="ed7d0-287">Once you update one file in a bundle, a new token is generated for the bundle query string parameter and the full bundle must be downloaded the next time a client requests a page containing the bundle.</span></span> <span data-ttu-id="ed7d0-288">各資産が個別に一覧表示される従来のマークアップでは、変更されたファイルのみがダウンロードされます。</span><span class="sxs-lookup"><span data-stu-id="ed7d0-288">In traditional markup where each asset is listed individually, only the changed file would be downloaded.</span></span> <span data-ttu-id="ed7d0-289">頻繁に変更される資産は、バンドルに適していない可能性があります。</span><span class="sxs-lookup"><span data-stu-id="ed7d0-289">Assets that change frequently may not be good candidates for bundling.</span></span>

<span data-ttu-id="ed7d0-290">バンドルと縮小は、主に最初のページ要求の読み込み時間を短縮します。</span><span class="sxs-lookup"><span data-stu-id="ed7d0-290">Bundling and minification primarily improve the first page request load time.</span></span> <span data-ttu-id="ed7d0-291">Web ページが要求されると、ブラウザーはアセット (JavaScript、CSS、およびイメージ) をキャッシュするので、バンドルと縮小では、同じページを要求しても、同じ資産を要求している同じサイト上のページを要求しても、パフォーマンスが向上しません。</span><span class="sxs-lookup"><span data-stu-id="ed7d0-291">Once a webpage has been requested, the browser caches the assets (JavaScript, CSS and images) so bundling and minification won't provide any performance boost when requesting the same page, or pages on the same site requesting the same assets.</span></span> <span data-ttu-id="ed7d0-292">資産に expires ヘッダーを正しく設定しておらず、バンドルと縮小を使用していない場合は、ブラウザーの鮮度ヒューリスティックによって、数日後に資産が古くなっているとマークされ、ブラウザーは各資産に対する検証要求を必要とします。</span><span class="sxs-lookup"><span data-stu-id="ed7d0-292">If you don't set the expires header correctly on your assets, and you don't use bundling and minification, the browsers freshness heuristics will mark the assets stale after a few days and the browser will require a validation request for each asset.</span></span> <span data-ttu-id="ed7d0-293">この場合、バンドルと縮小によって、最初のページ要求の後にパフォーマンスが向上します。</span><span class="sxs-lookup"><span data-stu-id="ed7d0-293">In this case, bundling and minification provide a performance increase after the first page request.</span></span> <span data-ttu-id="ed7d0-294">詳細については、「 [CDNs を使用する」および「Web サイトのパフォーマンスを向上させるための期限切れ](https://blogs.msdn.com/b/rickandy/archive/2011/05/21/using-cdns-to-improve-web-site-performance.aspx)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="ed7d0-294">For details, see the blog [Using CDNs and Expires to Improve Web Site Performance](https://blogs.msdn.com/b/rickandy/archive/2011/05/21/using-cdns-to-improve-web-site-performance.aspx).</span></span>

<span data-ttu-id="ed7d0-295">ブラウザーでは、各ホスト名につき6つの同時接続が制限されているため、 [CDN](https://blogs.msdn.com/b/rickandy/archive/2011/05/21/using-cdns-to-improve-web-site-performance.aspx)を使用して軽減できます。</span><span class="sxs-lookup"><span data-stu-id="ed7d0-295">The browser limitation of six simultaneous connections per each hostname can be mitigated by using a [CDN](https://blogs.msdn.com/b/rickandy/archive/2011/05/21/using-cdns-to-improve-web-site-performance.aspx).</span></span> <span data-ttu-id="ed7d0-296">CDN はホスティングサイトとは異なるホスト名を持つため、CDN からの資産要求は、ホスト環境に対する6つの同時接続の制限に対してカウントされません。</span><span class="sxs-lookup"><span data-stu-id="ed7d0-296">Because the CDN will have a different hostname than your hosting site, asset requests from the CDN will not count against the six simultaneous connections limit to your hosting environment.</span></span> <span data-ttu-id="ed7d0-297">CDN では、一般的なパッケージキャッシュとエッジキャッシュの利点も提供されます。</span><span class="sxs-lookup"><span data-stu-id="ed7d0-297">A CDN can also provide common package caching and edge caching advantages.</span></span>

<span data-ttu-id="ed7d0-298">バンドルは、それらを必要とするページでパーティション分割する必要があります。</span><span class="sxs-lookup"><span data-stu-id="ed7d0-298">Bundles should be partitioned by pages that need them.</span></span> <span data-ttu-id="ed7d0-299">たとえば、インターネットアプリケーションの既定の ASP.NET MVC テンプレートでは、jQuery とは別の jQuery 検証バンドルが作成されます。</span><span class="sxs-lookup"><span data-stu-id="ed7d0-299">For example, the default ASP.NET MVC template for an internet application creates a jQuery Validation bundle separate from jQuery.</span></span> <span data-ttu-id="ed7d0-300">作成される既定のビューには入力がなく、値がポストされないため、検証バンドルは含まれません。</span><span class="sxs-lookup"><span data-stu-id="ed7d0-300">Because the default views created have no input and do not post values, they don't include the validation bundle.</span></span>

<span data-ttu-id="ed7d0-301">`System.Web.Optimization` 名前空間は、 *system.web. Optimization*に実装されています。</span><span class="sxs-lookup"><span data-stu-id="ed7d0-301">The `System.Web.Optimization` namespace is implemented in *System.Web.Optimization.dll*.</span></span> <span data-ttu-id="ed7d0-302">これは、縮小機能に WebGrease library (*webgrease .dll*) を利用し、さらに*Antlr3*を使用します。</span><span class="sxs-lookup"><span data-stu-id="ed7d0-302">It leverages the WebGrease library (*WebGrease.dll*) for minification capabilities, which in turn uses *Antlr3.Runtime.dll*.</span></span>

<span data-ttu-id="ed7d0-303">*Twitter を使用して、リンクをすばやく投稿し、共有することができます。Twitter のハンドルが*: [@RickAndMSFT](http://twitter.com/RickAndMSFT)</span><span class="sxs-lookup"><span data-stu-id="ed7d0-303">*I use Twitter to make quick posts and share links. My Twitter handle is*: [@RickAndMSFT](http://twitter.com/RickAndMSFT)</span></span>

## <a name="additional-resources"></a><span data-ttu-id="ed7d0-304">その他の技術情報</span><span class="sxs-lookup"><span data-stu-id="ed7d0-304">Additional resources</span></span>

- <span data-ttu-id="ed7d0-305">ビデオ: [Howard Dierking](https://twitter.com/#!/howard_dierking)による[バンドルと最適化](https://channel9.msdn.com/Events/aspConf/aspConf/Bundling-and-Optimizing)</span><span class="sxs-lookup"><span data-stu-id="ed7d0-305">Video:[Bundling and Optimizing](https://channel9.msdn.com/Events/aspConf/aspConf/Bundling-and-Optimizing) by [Howard Dierking](https://twitter.com/#!/howard_dierking)</span></span>
- <span data-ttu-id="ed7d0-306">Web[ページサイトに Web 最適化を追加する](https://blogs.msdn.com/b/rickandy/archive/2012/08/15/adding-web-optimization-to-a-web-pages-site.aspx)。</span><span class="sxs-lookup"><span data-stu-id="ed7d0-306">[Adding Web Optimization to a Web Pages Site](https://blogs.msdn.com/b/rickandy/archive/2012/08/15/adding-web-optimization-to-a-web-pages-site.aspx).</span></span>
- <span data-ttu-id="ed7d0-307">[Web フォームへのバンドルと縮小の追加](https://blogs.msdn.com/b/rickandy/archive/2012/08/14/adding-bundling-and-minification-to-web-forms.aspx)。</span><span class="sxs-lookup"><span data-stu-id="ed7d0-307">[Adding Bundling and Minification to Web Forms](https://blogs.msdn.com/b/rickandy/archive/2012/08/14/adding-bundling-and-minification-to-web-forms.aspx).</span></span>
- <span data-ttu-id="ed7d0-308">[Henrik](http://en.wikipedia.org/wiki/Henrik_Frystyk_Nielsen) [@frystyk](https://twitter.com/frystyk) F による[Web 閲覧のバンドルと縮小のパフォーマンスへの影響](https://blogs.msdn.com/b/henrikn/archive/2012/06/17/performance-implications-of-bundling-and-minification-on-http.aspx)</span><span class="sxs-lookup"><span data-stu-id="ed7d0-308">[Performance Implications of Bundling and Minification on Web Browsing](https://blogs.msdn.com/b/henrikn/archive/2012/06/17/performance-implications-of-bundling-and-minification-on-http.aspx) by [Henrik F Nielsen](http://en.wikipedia.org/wiki/Henrik_Frystyk_Nielsen) [@frystyk](https://twitter.com/frystyk)</span></span>
- <span data-ttu-id="ed7d0-309">Rick Anderson によって[Web サイトのパフォーマンスを向上させるために、CDNs と有効期限を使用することが](https://blogs.msdn.com/b/rickandy/archive/2011/05/21/using-cdns-to-improve-web-site-performance.aspx) [@RickAndMSFT](https://twitter.com/#!/RickAndMSFT)</span><span class="sxs-lookup"><span data-stu-id="ed7d0-309">[Using CDNs and Expires to Improve Web Site Performance](https://blogs.msdn.com/b/rickandy/archive/2011/05/21/using-cdns-to-improve-web-site-performance.aspx) by Rick Anderson [@RickAndMSFT](https://twitter.com/#!/RickAndMSFT)</span></span>
- [<span data-ttu-id="ed7d0-310">RTT を最小化する (ラウンドトリップ時間)</span><span class="sxs-lookup"><span data-stu-id="ed7d0-310">Minimize RTT (round-trip times)</span></span>](https://developers.google.com/speed/docs/best-practices/rtt)

## <a name="contributors"></a><span data-ttu-id="ed7d0-311">共同作成者</span><span class="sxs-lookup"><span data-stu-id="ed7d0-311">Contributors</span></span>

- <span data-ttu-id="ed7d0-312">Hao Kung</span><span class="sxs-lookup"><span data-stu-id="ed7d0-312">Hao Kung</span></span>
- [<span data-ttu-id="ed7d0-313">Howard Dierking</span><span class="sxs-lookup"><span data-stu-id="ed7d0-313">Howard Dierking</span></span>](https://twitter.com/#!/howard_dierking)
- <span data-ttu-id="ed7d0-314">Diana LaRose</span><span class="sxs-lookup"><span data-stu-id="ed7d0-314">Diana LaRose</span></span>

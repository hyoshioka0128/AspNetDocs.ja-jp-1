---
uid: mvc/overview/older-versions/getting-started-with-aspnet-mvc3/vb/adding-a-view
title: ビュー (VB) の追加 |Microsoft Docs
author: Rick-Anderson
description: このチュートリアルでは、Microsoft Visual Web Developer 2010 Express Service Pack 1、これを使用して ASP.NET MVC Web アプリケーションの構築の基礎を説明しています.
ms.author: riande
ms.date: 01/12/2011
ms.assetid: d3633f64-5d3c-45c9-ae4b-cb1563e3739f
msc.legacyurl: /mvc/overview/older-versions/getting-started-with-aspnet-mvc3/vb/adding-a-view
msc.type: authoredcontent
ms.openlocfilehash: cf2e73b4245de6fe702b8c74550e6c7fc701a47f
ms.sourcegitcommit: 51b01b6ff8edde57d8243e4da28c9f1e7f1962b2
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 05/06/2019
ms.locfileid: "65129972"
---
# <a name="adding-a-view-vb"></a><span data-ttu-id="d2b46-103">ビューの追加 (VB)</span><span class="sxs-lookup"><span data-stu-id="d2b46-103">Adding a View (VB)</span></span>

<span data-ttu-id="d2b46-104">によって[Rick Anderson]((https://twitter.com/RickAndMSFT))</span><span class="sxs-lookup"><span data-stu-id="d2b46-104">by [Rick Anderson]((https://twitter.com/RickAndMSFT))</span></span>

> <span data-ttu-id="d2b46-105">このチュートリアルでは、Microsoft Visual Web Developer 2010 Express Service Pack 1、Microsoft Visual Studio の無料版であるを使用して ASP.NET MVC Web アプリケーションの構築の基礎を説明します。</span><span class="sxs-lookup"><span data-stu-id="d2b46-105">This tutorial will teach you the basics of building an ASP.NET MVC Web application using Microsoft Visual Web Developer 2010 Express Service Pack 1, which is a free version of Microsoft Visual Studio.</span></span> <span data-ttu-id="d2b46-106">始める前に、以下の前提条件がインストールされていることを確認します。</span><span class="sxs-lookup"><span data-stu-id="d2b46-106">Before you start, make sure you've installed the prerequisites listed below.</span></span> <span data-ttu-id="d2b46-107">次のリンクをクリックして、それらのすべてをインストールできます。[Web プラットフォーム インストーラー](https://www.microsoft.com/web/gallery/install.aspx?appid=VWD2010SP1Pack)します。</span><span class="sxs-lookup"><span data-stu-id="d2b46-107">You can install all of them by clicking the following link: [Web Platform Installer](https://www.microsoft.com/web/gallery/install.aspx?appid=VWD2010SP1Pack).</span></span> <span data-ttu-id="d2b46-108">または、次のリンクを使用して、前提条件を個別にインストールできます。</span><span class="sxs-lookup"><span data-stu-id="d2b46-108">Alternatively, you can individually install the prerequisites using the following links:</span></span>
> 
> - [<span data-ttu-id="d2b46-109">Visual Studio Web Developer Express SP1 の前提条件</span><span class="sxs-lookup"><span data-stu-id="d2b46-109">Visual Studio Web Developer Express SP1 prerequisites</span></span>](https://www.microsoft.com/web/gallery/install.aspx?appid=VWD2010SP1Pack)
> - [<span data-ttu-id="d2b46-110">ASP.NET MVC 3 Tools Update します。</span><span class="sxs-lookup"><span data-stu-id="d2b46-110">ASP.NET MVC 3 Tools Update</span></span>](https://www.microsoft.com/web/gallery/install.aspx?appsxml=&amp;appid=MVC3)
> - <span data-ttu-id="d2b46-111">[SQL Server Compact 4.0](https://www.microsoft.com/web/gallery/install.aspx?appid=SQLCE;SQLCEVSTools_4_0)(ランタイムとツールのサポート)</span><span class="sxs-lookup"><span data-stu-id="d2b46-111">[SQL Server Compact 4.0](https://www.microsoft.com/web/gallery/install.aspx?appid=SQLCE;SQLCEVSTools_4_0)(runtime + tools support)</span></span>
> 
> <span data-ttu-id="d2b46-112">Visual Web Developer 2010 ではなく Visual Studio 2010 を使用する場合は、次のリンクをクリックして、前提条件をインストールします。[Visual Studio 2010 の前提条件](https://www.microsoft.com/web/gallery/install.aspx?appsxml=&amp;appid=VS2010SP1Pack)します。</span><span class="sxs-lookup"><span data-stu-id="d2b46-112">If you're using Visual Studio 2010 instead of Visual Web Developer 2010, install the prerequisites by clicking the following link: [Visual Studio 2010 prerequisites](https://www.microsoft.com/web/gallery/install.aspx?appsxml=&amp;appid=VS2010SP1Pack).</span></span>
> 
> <span data-ttu-id="d2b46-113">VB.NET のソース コードでの Visual Web Developer プロジェクトは、このトピックと共に使用できます。</span><span class="sxs-lookup"><span data-stu-id="d2b46-113">A Visual Web Developer project with VB.NET source code is available to accompany this topic.</span></span> <span data-ttu-id="d2b46-114">[VB.NET のバージョンをダウンロード](https://code.msdn.microsoft.com/Introduction-to-MVC-3-10d1b098)します。</span><span class="sxs-lookup"><span data-stu-id="d2b46-114">[Download the VB.NET version](https://code.msdn.microsoft.com/Introduction-to-MVC-3-10d1b098).</span></span> <span data-ttu-id="d2b46-115">C# を使用する場合に切り替えて、 [c# バージョン](../cs/adding-a-view.md)このチュートリアルの。</span><span class="sxs-lookup"><span data-stu-id="d2b46-115">If you prefer C#, switch to the [C# version](../cs/adding-a-view.md) of this tutorial.</span></span>

<span data-ttu-id="d2b46-116">このセクションでお見せ変更、`HelloWorldController`をクリーンにビュー テンプレート ファイルを使用するクラスがクライアントへの HTML 応答を生成するプロセスをカプセル化します。</span><span class="sxs-lookup"><span data-stu-id="d2b46-116">In this section we're going to modify the `HelloWorldController` class to use a view template file to cleanly encapsulate the process of generating HTML responses to a client.</span></span>

<span data-ttu-id="d2b46-117">ビュー テンプレートを使用して、まず、`Index`メソッドで、`HelloWorldController`クラス。</span><span class="sxs-lookup"><span data-stu-id="d2b46-117">Let's start by using a view template with the `Index` method in the `HelloWorldController` class.</span></span> <span data-ttu-id="d2b46-118">現在、`Index`メソッドがコント ローラー クラス内でハードコーディングされているメッセージに文字列を返します。</span><span class="sxs-lookup"><span data-stu-id="d2b46-118">Currently the `Index` method returns a string with a message that is hard-coded within the controller class.</span></span> <span data-ttu-id="d2b46-119">変更、`Index`を返すメソッドを`View`オブジェクトを次に示すようにします。</span><span class="sxs-lookup"><span data-stu-id="d2b46-119">Change the `Index` method to return a `View` object, as shown in the following:</span></span>

[!code-vb[Main](adding-a-view/samples/sample1.vb)]

<span data-ttu-id="d2b46-120">呼び出すことができるプロジェクトにビュー テンプレートを追加してみましょう今すぐ、`Index`メソッド。</span><span class="sxs-lookup"><span data-stu-id="d2b46-120">Let's now add a view template to our project that we can invoke with the `Index` method.</span></span> <span data-ttu-id="d2b46-121">これを行うには、内を右クリックして、`Index`メソッドとクリック**ビューの追加**します。</span><span class="sxs-lookup"><span data-stu-id="d2b46-121">To do this, right-click inside the `Index` method and click **Add View**.</span></span>

<span data-ttu-id="d2b46-122">[![IndexAddView](adding-a-view/_static/image2.png "IndexAddView")](adding-a-view/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="d2b46-122">[![IndexAddView](adding-a-view/_static/image2.png "IndexAddView")](adding-a-view/_static/image1.png)</span></span>

<span data-ttu-id="d2b46-123">**ビューの追加** ダイアログ ボックスが表示されます。</span><span class="sxs-lookup"><span data-stu-id="d2b46-123">The **Add View** dialog box appears.</span></span> <span data-ttu-id="d2b46-124">既定のエントリのままにし、をクリックして、**追加**ボタンをクリックします。</span><span class="sxs-lookup"><span data-stu-id="d2b46-124">Leave the default entries and click the **Add** button.</span></span>

<span data-ttu-id="d2b46-125">[![3addView](adding-a-view/_static/image4.png "3addView")](adding-a-view/_static/image3.png)</span><span class="sxs-lookup"><span data-stu-id="d2b46-125">[![3addView](adding-a-view/_static/image4.png "3addView")](adding-a-view/_static/image3.png)</span></span>

<span data-ttu-id="d2b46-126">*MvcMovie\Views\HelloWorld*フォルダーと*MvcMovie\Views\HelloWorld\Index.vbhtml*ファイルが作成されます。</span><span class="sxs-lookup"><span data-stu-id="d2b46-126">The *MvcMovie\Views\HelloWorld* folder and the *MvcMovie\Views\HelloWorld\Index.vbhtml* file are created.</span></span> <span data-ttu-id="d2b46-127">わかります**ソリューション エクスプ ローラー**:</span><span class="sxs-lookup"><span data-stu-id="d2b46-127">You can see them in **Solution Explorer**:</span></span>

<span data-ttu-id="d2b46-128">[![SolnExpHelloWorldIndx](adding-a-view/_static/image6.png "SolnExpHelloWorldIndx")](adding-a-view/_static/image5.png)</span><span class="sxs-lookup"><span data-stu-id="d2b46-128">[![SolnExpHelloWorldIndx](adding-a-view/_static/image6.png "SolnExpHelloWorldIndx")](adding-a-view/_static/image5.png)</span></span>

<span data-ttu-id="d2b46-129">HTML を追加、`<h2>`タグ。</span><span class="sxs-lookup"><span data-stu-id="d2b46-129">Add some HTML under the `<h2>` tag.</span></span> <span data-ttu-id="d2b46-130">変更された*MvcMovie\Views\HelloWorld\Index.vbhtml*ファイルを次に示します。</span><span class="sxs-lookup"><span data-stu-id="d2b46-130">The modified *MvcMovie\Views\HelloWorld\Index.vbhtml* file is shown below.</span></span>

[!code-vbhtml[Main](adding-a-view/samples/sample2.vbhtml)]

<span data-ttu-id="d2b46-131">アプリケーションを実行しを参照、 &quot;hello world&quot;コント ローラー (`http://localhost:xxxx/HelloWorld`)。</span><span class="sxs-lookup"><span data-stu-id="d2b46-131">Run the application and browse to the &quot;hello world&quot; controller (`http://localhost:xxxx/HelloWorld`).</span></span> <span data-ttu-id="d2b46-132">`Index`コント ローラーのメソッドは多くの作業を行わない; に単に、ステートメントを実行した`return View()`クライアントに応答をレンダリングするビュー テンプレート ファイルを使用したいことが示されます。</span><span class="sxs-lookup"><span data-stu-id="d2b46-132">The `Index` method in your controller didn't do much work; it simply ran the statement `return View()`, which indicated that we wanted to use a view template file to render a response to the client.</span></span> <span data-ttu-id="d2b46-133">ASP.NET MVC の既定値を使用してに明示的に使用するビュー テンプレート ファイルの名前を指定しましたいない、ため、 *Index.vbhtml*内でファイルの表示、 *\Views\HelloWorld*フォルダー。</span><span class="sxs-lookup"><span data-stu-id="d2b46-133">Because we did not explicitly specify the name of the view template file to use, ASP.NET MVC defaulted to using the *Index.vbhtml* view file within the *\Views\HelloWorld* folder.</span></span> <span data-ttu-id="d2b46-134">次の図では、ビューにハード コードされた文字列を示します。</span><span class="sxs-lookup"><span data-stu-id="d2b46-134">The image below shows the string hard-coded in the view.</span></span>

<span data-ttu-id="d2b46-135">[![3HelloWorld](adding-a-view/_static/image8.png "3HelloWorld")](adding-a-view/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="d2b46-135">[![3HelloWorld](adding-a-view/_static/image8.png "3HelloWorld")](adding-a-view/_static/image7.png)</span></span>

<span data-ttu-id="d2b46-136">ように見えますね。</span><span class="sxs-lookup"><span data-stu-id="d2b46-136">Looks pretty good.</span></span> <span data-ttu-id="d2b46-137">ただし、ブラウザーのタイトル バーに表示されることを確認&quot;インデックス&quot;ビッグ、ページのタイトルと&quot;マイ MVC アプリケーションです。&quot;これらの名前を変更してみましょう。</span><span class="sxs-lookup"><span data-stu-id="d2b46-137">However, notice that the browser's title bar says &quot;Index&quot; and the big title on the page says &quot;My MVC Application.&quot; Let's change those.</span></span>

## <a name="changing-views-and-layout-pages"></a><span data-ttu-id="d2b46-138">ビューとレイアウト ページの変更</span><span class="sxs-lookup"><span data-stu-id="d2b46-138">Changing views and layout pages</span></span>

<span data-ttu-id="d2b46-139">まず、テキストを変更してみましょう&quot;マイ MVC アプリケーションです。&quot;そのテキストは、共有され、すべてのページに表示されます。</span><span class="sxs-lookup"><span data-stu-id="d2b46-139">First, let's change the text &quot;My MVC Application.&quot; That text is shared and appears on every page.</span></span> <span data-ttu-id="d2b46-140">アプリケーション内の各ページ上にある場合でも実際に、プロジェクト内の 1 か所で表示します。</span><span class="sxs-lookup"><span data-stu-id="d2b46-140">It actually appears in only one place in our project, even though it's on every page in our application.</span></span> <span data-ttu-id="d2b46-141">移動して、 */ビュー/共有*フォルダー**ソリューション エクスプ ローラー**を開くと、  *\_Layout.vbhtml*ファイル。</span><span class="sxs-lookup"><span data-stu-id="d2b46-141">Go to the */Views/Shared* folder in **Solution Explorer** and open the *\_Layout.vbhtml* file.</span></span> <span data-ttu-id="d2b46-142">このファイルは、レイアウト ページと呼ばれ、共有は&quot;シェル&quot;他のすべてのページを使用します。</span><span class="sxs-lookup"><span data-stu-id="d2b46-142">This file is called a layout page and it's the shared &quot;shell&quot; that all other pages use.</span></span>

<span data-ttu-id="d2b46-143">注、`@RenderBody()`のファイルの下部にあるコード行。</span><span class="sxs-lookup"><span data-stu-id="d2b46-143">Note the `@RenderBody()` line of code near the bottom of the file.</span></span> <span data-ttu-id="d2b46-144">`RenderBody` プレース ホルダーを作成するすべてのページが表示するには&quot;ラップ&quot;レイアウト ページ。</span><span class="sxs-lookup"><span data-stu-id="d2b46-144">`RenderBody` is a placeholder where all the pages you create show up, &quot;wrapped&quot; in the layout page.</span></span> <span data-ttu-id="d2b46-145">変更、`<h1>`から見出し**&quot;** My MVC Application&quot;に&quot;MVC ムービー アプリ&quot;します。</span><span class="sxs-lookup"><span data-stu-id="d2b46-145">Change the `<h1>` heading from **&quot;** My MVC Application&quot; to &quot;MVC Movie App&quot;.</span></span>

[!code-html[Main](adding-a-view/samples/sample3.html)]

<span data-ttu-id="d2b46-146">アプリケーションを実行し、伝えることに注意してください。 &quot;MVC ムービー アプリ&quot;します。</span><span class="sxs-lookup"><span data-stu-id="d2b46-146">Run the application and note it now says &quot;MVC Movie App&quot;.</span></span> <span data-ttu-id="d2b46-147">をクリックして、**について**リンク、およびページ表示&quot;MVC ムービー アプリ&quot;もします。</span><span class="sxs-lookup"><span data-stu-id="d2b46-147">Click the **About** link, and that page shows &quot;MVC Movie App&quot;, too.</span></span>

<span data-ttu-id="d2b46-148">完全な *\_Layout.vbhtml*ファイルを次に示します。</span><span class="sxs-lookup"><span data-stu-id="d2b46-148">The complete *\_Layout.vbhtml* file is shown below:</span></span>

[!code-cshtml[Main](adding-a-view/samples/sample4.cshtml)]

<span data-ttu-id="d2b46-149">ここで、インデックス ページ (ビュー) のタイトルを変更してみましょう。</span><span class="sxs-lookup"><span data-stu-id="d2b46-149">Now, let's change the title of the Index page (view).</span></span>

[!code-vbhtml[Main](adding-a-view/samples/sample5.vbhtml)]

<span data-ttu-id="d2b46-150">Open *MvcMovie\Views\HelloWorld\Index.vbhtml*.</span><span class="sxs-lookup"><span data-stu-id="d2b46-150">Open *MvcMovie\Views\HelloWorld\Index.vbhtml*.</span></span> <span data-ttu-id="d2b46-151">2 か所変更する場合: 最初に、テキスト表示される、ブラウザーのタイトルにおよび、セカンダリ ヘッダー (、`<h2>`要素)。</span><span class="sxs-lookup"><span data-stu-id="d2b46-151">There are two places to make a change: first, the text that appears in the title of the browser, and then in the secondary header (the `<h2>` element).</span></span> <span data-ttu-id="d2b46-152">しましょうに若干異なるため、どのビット コードの変更、アプリのどの部分を参照してください。</span><span class="sxs-lookup"><span data-stu-id="d2b46-152">We'll make them slightly different so you can see which bit of code changes which part of the app.</span></span>

<span data-ttu-id="d2b46-153">アプリケーションを実行しを参照する`http://localhost:xx/HelloWorld`します。</span><span class="sxs-lookup"><span data-stu-id="d2b46-153">Run the application and browse to`http://localhost:xx/HelloWorld`.</span></span> <span data-ttu-id="d2b46-154">ブラウザーのタイトル、プライマリ見出し、およびセカンダリ見出しが変更されていることに注意してください </span><span class="sxs-lookup"><span data-stu-id="d2b46-154">Notice that the browser title, the primary heading, and the secondary headings have changed.</span></span> <span data-ttu-id="d2b46-155">ビューに少し変更を加えて、アプリケーションで大きな変更を加えるには簡単です。</span><span class="sxs-lookup"><span data-stu-id="d2b46-155">It's easy to make big changes in your application with small changes to a view.</span></span> <span data-ttu-id="d2b46-156">(ブラウザーに変更内容が表示されない場合は、キャッシュされたコンテンツを表示している可能性があります。</span><span class="sxs-lookup"><span data-stu-id="d2b46-156">(If you don't see changes in the browser, you might be viewing cached content.</span></span> <span data-ttu-id="d2b46-157">ブラウザーで Ctrl + F5 キーを押して、サーバーからの応答が強制的に読み込まれるようにしてください)。</span><span class="sxs-lookup"><span data-stu-id="d2b46-157">Press Ctrl+F5 in your browser to force the response from the server to be loaded.)</span></span>

<span data-ttu-id="d2b46-158">[![3_MyMovieList](adding-a-view/_static/image10.png "3_MyMovieList")](adding-a-view/_static/image9.png)</span><span class="sxs-lookup"><span data-stu-id="d2b46-158">[![3_MyMovieList](adding-a-view/_static/image10.png "3_MyMovieList")](adding-a-view/_static/image9.png)</span></span>

<span data-ttu-id="d2b46-159">ごく一部&quot;データ&quot;(この場合、 &quot;Hello World!&quot;メッセージ) はハード コーディング、ただしします。</span><span class="sxs-lookup"><span data-stu-id="d2b46-159">Our little bit of &quot;data&quot; (in this case the &quot;Hello World!&quot; message) is hard-coded, though.</span></span> <span data-ttu-id="d2b46-160">MVC アプリケーションは V (ビュー) を備え、C (コント ローラー) がないの M (モデル) まだがあります。</span><span class="sxs-lookup"><span data-stu-id="d2b46-160">Our MVC application has V (views) and we've got C (controllers), but no M (model) yet.</span></span> <span data-ttu-id="d2b46-161">方法を説明します、データベースを作成し、モデル データを取得します。</span><span class="sxs-lookup"><span data-stu-id="d2b46-161">Shortly, we'll walk through how create a database and retrieve model data from it.</span></span>

## <a name="passing-data-from-the-controller-to-the-view"></a><span data-ttu-id="d2b46-162">コントローラーからビューへのデータの受け渡し</span><span class="sxs-lookup"><span data-stu-id="d2b46-162">Passing Data from the Controller to the View</span></span>

<span data-ttu-id="d2b46-163">データベースに移動してモデルについて説明する前に、まずについて説明しましょうコント ローラーからビューに情報を渡します。</span><span class="sxs-lookup"><span data-stu-id="d2b46-163">Before we go to a database and talk about models, though, let's first talk about passing information from the Controller to a View.</span></span> <span data-ttu-id="d2b46-164">クライアントへの HTML 応答を表示するためにビュー テンプレートで必要がありますを渡すたいのです。</span><span class="sxs-lookup"><span data-stu-id="d2b46-164">We want to pass what a view template requires in order to render an HTML response to a client.</span></span> <span data-ttu-id="d2b46-165">これらのオブジェクトが通常作成され、コント ローラー クラスによって、ビュー テンプレートに渡され、テンプレートの表示が必要とするデータのみを含める必要がありますとは。</span><span class="sxs-lookup"><span data-stu-id="d2b46-165">These objects are typically created and passed by a controller class to a view template, and they should contain only the data that the view template requires — and no more.</span></span>

<span data-ttu-id="d2b46-166">以前、`HelloWorldController`クラス、`Welcome`アクション メソッドが、`name`と`numTimes`パラメーターと、ブラウザーに、パラメーターの値からの出力。</span><span class="sxs-lookup"><span data-stu-id="d2b46-166">Previously with the `HelloWorldController` class, the `Welcome` action method took a `name` and a `numTimes` parameter and then output the parameter values to the browser.</span></span> <span data-ttu-id="d2b46-167">代わりこの応答を直接表示するために引き続きコント ローラーがある、みましょう代わりを用意データ バッグに、ビューの。</span><span class="sxs-lookup"><span data-stu-id="d2b46-167">Rather than have the controller continue to render this response directly, let's instead we'll put that data in a bag for the View.</span></span> <span data-ttu-id="d2b46-168">コント ローラーとビューを使用できる、`ViewBag`そのデータを保持するオブジェクト。</span><span class="sxs-lookup"><span data-stu-id="d2b46-168">Controllers and Views can use a `ViewBag` object to hold that data.</span></span> <span data-ttu-id="d2b46-169">ビュー テンプレートに自動的には、渡さし、するデータとして、バッグのコンテンツを使用して HTML 応答をレンダリングするために使用します。</span><span class="sxs-lookup"><span data-stu-id="d2b46-169">That will be passed over to a view template automatically, and used to render the HTML response using the contents of the bag as data.</span></span> <span data-ttu-id="d2b46-170">これにより、コント ローラーでは 1 つと別のビュー テンプレート-クリーンに維持するためにできるようになりました&quot;懸念事項の分離&quot;アプリケーション内で。</span><span class="sxs-lookup"><span data-stu-id="d2b46-170">That way the controller is concerned with one thing and the view template with another — enabling us to maintain clean &quot;separation of concerns&quot; within the application.</span></span>

<span data-ttu-id="d2b46-171">またはカスタム クラスを定義、当社が単独でそのオブジェクトのインスタンスを作成とデータの挿入し、ビューに渡すことです。</span><span class="sxs-lookup"><span data-stu-id="d2b46-171">Alternatively, we could define a custom class, then create an instance of that object on our own, fill it with data and pass it to the View.</span></span> <span data-ttu-id="d2b46-172">カスタム ビューのモデルのため、ViewModel は、多くの場合、呼び出されます。</span><span class="sxs-lookup"><span data-stu-id="d2b46-172">That is often called a ViewModel, because it's a custom Model for the View.</span></span> <span data-ttu-id="d2b46-173">少量のデータは、ただし、ViewBag うまく動作します。</span><span class="sxs-lookup"><span data-stu-id="d2b46-173">For small amounts of data, however, the ViewBag works great.</span></span>

<span data-ttu-id="d2b46-174">戻り、 *HelloWorldController.vb*ファイルの変更、 `Welcome` ViewBag に NumTimes とメッセージを格納するコント ローラーの内部メソッド。</span><span class="sxs-lookup"><span data-stu-id="d2b46-174">Return to the *HelloWorldController.vb* file change the `Welcome` method inside the controller to put the Message and NumTimes into the ViewBag.</span></span> <span data-ttu-id="d2b46-175">ViewBag、動的オブジェクトです。</span><span class="sxs-lookup"><span data-stu-id="d2b46-175">The ViewBag is a dynamic object.</span></span> <span data-ttu-id="d2b46-176">つまりに自由に配置することができます。</span><span class="sxs-lookup"><span data-stu-id="d2b46-176">That means you can put whatever you want in to it.</span></span> <span data-ttu-id="d2b46-177">内部に、何かを設定するまで、ViewBag は定義されているプロパティがありません。</span><span class="sxs-lookup"><span data-stu-id="d2b46-177">The ViewBag has no defined properties until you put something inside it.</span></span>

<span data-ttu-id="d2b46-178">完全な`HelloWorldController.vb`同じファイル内の新しいクラスを使用します。</span><span class="sxs-lookup"><span data-stu-id="d2b46-178">The complete `HelloWorldController.vb` with the new class in the same file.</span></span>

[!code-vb[Main](adding-a-view/samples/sample6.vb)]

<span data-ttu-id="d2b46-179">これで、ViewBag には、渡される経由でのビューに自動的にデータが含まれています。</span><span class="sxs-lookup"><span data-stu-id="d2b46-179">Now our ViewBag contains data that will be passed over to the View automatically.</span></span> <span data-ttu-id="d2b46-180">ここでも、またはでしたが渡された次のように、独自のオブジェクト苦する場合。</span><span class="sxs-lookup"><span data-stu-id="d2b46-180">Again, alternatively we could have passed in our own object like this if we liked:</span></span>

[!code-csharp[Main](adding-a-view/samples/sample7.cs)]

<span data-ttu-id="d2b46-181">必要があります、`WelcomeView`テンプレート。</span><span class="sxs-lookup"><span data-stu-id="d2b46-181">Now we need a `WelcomeView` template!</span></span> <span data-ttu-id="d2b46-182">新しいコードをコンパイルするためには、アプリケーションを実行します。</span><span class="sxs-lookup"><span data-stu-id="d2b46-182">Run the application so the new code is compiled.</span></span> <span data-ttu-id="d2b46-183">ブラウザーを閉じて、内を右クリックし、`Welcome`メソッド、およびクリック**ビューの追加**します。</span><span class="sxs-lookup"><span data-stu-id="d2b46-183">Close the browser, right-click inside the `Welcome` method, and then click **Add View**.</span></span>

<span data-ttu-id="d2b46-184">ここでは、**ビューの追加** ダイアログ ボックスのようになります。</span><span class="sxs-lookup"><span data-stu-id="d2b46-184">Here's what your **Add View** dialog box looks like.</span></span>

<span data-ttu-id="d2b46-185">[![3AddWelcomeView](adding-a-view/_static/image12.png "3AddWelcomeView")](adding-a-view/_static/image11.png)</span><span class="sxs-lookup"><span data-stu-id="d2b46-185">[![3AddWelcomeView](adding-a-view/_static/image12.png "3AddWelcomeView")](adding-a-view/_static/image11.png)</span></span>

<span data-ttu-id="d2b46-186">次のコードを追加、 `<h2>` 、新しい要素<em>ようこそ</em>。vbhtml ファイルです。</span><span class="sxs-lookup"><span data-stu-id="d2b46-186">Add the following code under the `<h2>` element in the new <em>Welcome.</em>vbhtml file.</span></span> <span data-ttu-id="d2b46-187">ループを作成し、たとえば&quot;こんにちは&quot;回数だけ、ユーザーがあります。</span><span class="sxs-lookup"><span data-stu-id="d2b46-187">We'll make a loop and say &quot;Hello&quot; as many times as the user says we should!</span></span>

[!code-vbhtml[Main](adding-a-view/samples/sample8.vbhtml)]

<span data-ttu-id="d2b46-188">アプリケーションを実行しを参照 `http://localhost:xx/HelloWorld/Welcome?name=Scott&numtimes=4`</span><span class="sxs-lookup"><span data-stu-id="d2b46-188">Run the application and browse to `http://localhost:xx/HelloWorld/Welcome?name=Scott&numtimes=4`</span></span>

<span data-ttu-id="d2b46-189">今すぐデータでは、URL から取得され、コント ローラーに自動的に渡されます。</span><span class="sxs-lookup"><span data-stu-id="d2b46-189">Now data is taken from the URL and passed to the controller automatically.</span></span> <span data-ttu-id="d2b46-190">コント ローラーがパッケージにデータを`Model`オブジェクトと、ビューにオブジェクトを渡します。</span><span class="sxs-lookup"><span data-stu-id="d2b46-190">The controller packages up the data into a `Model` object and passes that object to the view.</span></span> <span data-ttu-id="d2b46-191">ビューよりも、ユーザーに HTML としてデータが表示されます。</span><span class="sxs-lookup"><span data-stu-id="d2b46-191">The view than displays the data as HTML to the user.</span></span>

<span data-ttu-id="d2b46-192">[![3Hello_Scott_4](adding-a-view/_static/image14.png "3Hello_Scott_4")](adding-a-view/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="d2b46-192">[![3Hello_Scott_4](adding-a-view/_static/image14.png "3Hello_Scott_4")](adding-a-view/_static/image13.png)</span></span>

<span data-ttu-id="d2b46-193">一種の&quot;M&quot;モデルがデータベースの種類ではありません。</span><span class="sxs-lookup"><span data-stu-id="d2b46-193">Well, that was a kind of an &quot;M&quot; for model, but not the database kind.</span></span> <span data-ttu-id="d2b46-194">学習したことを確認し、ムービーのデータベースを作成してみましょう。</span><span class="sxs-lookup"><span data-stu-id="d2b46-194">Let's take what we've learned and create a database of movies.</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="d2b46-195">[前へ](adding-a-controller.md)
> [次へ](adding-a-model.md)</span><span class="sxs-lookup"><span data-stu-id="d2b46-195">[Previous](adding-a-controller.md)
[Next](adding-a-model.md)</span></span>

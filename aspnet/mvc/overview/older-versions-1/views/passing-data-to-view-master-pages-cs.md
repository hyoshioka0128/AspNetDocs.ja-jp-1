---
uid: mvc/overview/older-versions-1/views/passing-data-to-view-master-pages-cs
title: ビュー マスター ページへのデータの受け渡し (C#) |マイクロソフトドキュメント
author: rick-anderson
description: このチュートリアルの目的は、コント ローラーからビュー マスター ページにデータを渡す方法について説明します。 ビュー m. にデータを渡すための 2 つの戦略を検討します。
ms.author: riande
ms.date: 10/16/2008
ms.assetid: 5fee879b-8bde-42a9-a434-60ba6b1cf747
msc.legacyurl: /mvc/overview/older-versions-1/views/passing-data-to-view-master-pages-cs
msc.type: authoredcontent
ms.openlocfilehash: 7a934f93d89e6530becc114fe455c8b3ab2968de
ms.sourcegitcommit: 022f79dbc1350e0c6ffaa1e7e7c6e850cdabf9af
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/17/2020
ms.locfileid: "81542483"
---
# <a name="passing-data-to-view-master-pages-c"></a>ビュー マスター ページにデータを渡す (C#)

[マイクロソフト](https://github.com/microsoft)

[PDF のダウンロード](https://download.microsoft.com/download/e/f/3/ef3f2ff6-7424-48f7-bdaa-180ef64c3490/ASPNET_MVC_Tutorial_13_CS.pdf)

> このチュートリアルの目的は、コント ローラーからビュー マスター ページにデータを渡す方法について説明します。 ビュー マスター ページにデータを渡すための 2 つの方法を検討します。 まず、保守が困難なアプリケーションを実現する簡単なソリューションについて説明します。 次に、より多くの初期作業を必要とするはるかに優れたソリューションを検討しますが、その結果、アプリケーションの保守性が向上します。

## <a name="passing-data-to-view-master-pages"></a>ビュー マスター ページへのデータの受け渡し

このチュートリアルの目的は、コント ローラーからビュー マスター ページにデータを渡す方法について説明します。 ビュー マスター ページにデータを渡すための 2 つの方法を検討します。 まず、保守が困難なアプリケーションを実現する簡単なソリューションについて説明します。 次に、より多くの初期作業を必要とするはるかに優れたソリューションを検討しますが、その結果、アプリケーションの保守性が向上します。

### <a name="the-problem"></a>問題

ムービー データベース アプリケーションを構築し、アプリケーションのすべてのページにムービー カテゴリの一覧を表示するとします (図 1 参照)。 さらに、ムービーカテゴリのリストがデータベーステーブルに格納されていることを想像してみてください。 その場合は、データベースからカテゴリを取得し、ビュー マスター ページ内のムービー カテゴリの一覧をレンダリングするほうが理にかなっています。

[![ビュー マスター ページでのムービー カテゴリの表示](passing-data-to-view-master-pages-cs/_static/image2.png)](passing-data-to-view-master-pages-cs/_static/image1.png)

**図 01**: ビュー マスター ページにムービー カテゴリを表示する ([フルサイズの画像を表示する をクリック](passing-data-to-view-master-pages-cs/_static/image3.png)します )

ここに問題があります。 マスター ページのムービー カテゴリの一覧を取得する方法 マスターページでモデルクラスのメソッドを直接呼び出すのも魅力的です。 つまり、データベースからデータを取得するためのコードをマスター ページに含めたくなるのは魅力的です。 ただし、MVC コントローラーをバイパスしてデータベースにアクセスすると、MVC アプリケーションを構築する主な利点の 1 つである懸念事項が明確に分離される可能性があります。

MVC アプリケーションでは、MVC のビューと MVC モデルの間のすべての相互作用を MVC コント ローラーによって処理する必要があります。 この懸念事項の分離により、保守性、適応性、およびテスト可能なアプリケーションが得られます。

MVC アプリケーションでは、ビュー マスター ページを含むビューに渡されるすべてのデータを、コント ローラー アクションによってビューに渡す必要があります。 さらに、ビューデータを利用してデータを渡す必要があります。 このチュートリアルの残りの部分では、ビューのデータをビュー マスター ページに渡す 2 つの方法を調べます。

### <a name="the-simple-solution"></a>シンプルなソリューション

まず、コントローラーからビュー マスター ページにビュー データを渡す最も簡単なソリューションを見てみましょう。 最も簡単な解決策は、各コントローラアクションでマスターページのビューデータを渡す方法です。

リスト 1 でコントローラーを考えてみましょう。 と という名前`Index()`の 2`Details()`つのアクションが公開されます。 アクション`Index()`メソッドは、Movies データベース テーブル内のすべてのムービーを返します。 アクション`Details()`メソッドは、特定のムービーカテゴリ内のすべてのムービーを返します。

**リスト1 –`Controllers\HomeController.cs`**

[!code-csharp[Main](passing-data-to-view-master-pages-cs/samples/sample1.cs)]

Index() アクションと Details() アクションの両方が、データを表示するために 2 つの項目を追加することに注意してください。 Index() アクションは、カテゴリとムービーの 2 つのキーを追加します。 categories キーは、ビュー マスター ページによって表示されるムービー カテゴリの一覧を表します。 movies キーは、インデックス ビュー ページで表示されるムービーの一覧を表します。

Details() アクションでは、カテゴリとムービーという名前の 2 つのキーも追加されます。 カテゴリ キーは、もう一度、ビュー マスター ページによって表示されるムービー カテゴリの一覧を表します。 movies キーは、詳細ビュー ページで表示される特定のカテゴリの映画の一覧を表します (図 2 参照)。

[![詳細ビュー](passing-data-to-view-master-pages-cs/_static/image5.png)](passing-data-to-view-master-pages-cs/_static/image4.png)

**図 02**: 詳細ビュー ([フルサイズの画像を表示する をクリック](passing-data-to-view-master-pages-cs/_static/image6.png))

インデックス ビューは、リスト 2 に含まれています。 ビュー データ内の movies アイテムによって表される映画のリストを反復処理するだけです。

**リスト2 –`Views\Home\Index.aspx`**

[!code-aspx[Main](passing-data-to-view-master-pages-cs/samples/sample2.aspx)]

ビュー マスター ページは、リスト 3 に含まれています。 ビュー マスター ページは、ビュー データからカテゴリ項目によって表されるすべてのムービー カテゴリを反復処理してレンダリングします。

**リスト3 –`Views\Shared\Site.master`**

[!code-aspx[Main](passing-data-to-view-master-pages-cs/samples/sample3.aspx)]

ビューとビューのマスター ページに、すべてのデータがビュー データを通じて渡されます。 これは、マスター ページにデータを渡す正しい方法です。

だから、このソリューションの何が問題なのですか? 問題は、このソリューションが DRY (繰り返しを繰り返さない) 原則に違反していることです。 各コントローラのアクションは、データを表示するために、ムービーカテゴリの非常に同じリストを追加する必要があります。 アプリケーションにコードが重複していると、アプリケーションの保守、適応、変更が非常に困難になります。

### <a name="the-good-solution"></a>良い解決策

このセクションでは、コントローラー アクションからビュー マスター ページにデータを渡す方法と、より優れたソリューションについて説明します。 各コントローラアクションでマスターページのムービーカテゴリを追加するのではなく、ムービーカテゴリをビューデータに1回だけ追加します。 ビュー マスター ページで使用されるすべてのビュー データは、アプリケーション コントローラーに追加されます。

アプリケーション コント ローラー クラスは、リスト 4 に含まれています。

**リスト4 –`Controllers\ApplicationController.cs`**

[!code-csharp[Main](passing-data-to-view-master-pages-cs/samples/sample4.cs)]

リスト 4 では、アプリケーション コントローラについて 3 つの注意点があります。 まず、クラスが基本の System.Web.Mvc.Controller クラスから継承していることに注意してください。 アプリケーション コント ローラーは、コント ローラー クラスです。

次に、アプリケーション コント ローラー クラスは抽象クラスであることに注意してください。 抽象クラスは、具象クラスによって実装される必要があるクラスです。 アプリケーション コント ローラーは抽象クラスであるため、クラスで定義されているメソッドを直接呼び出すことはできません。 アプリケーション クラスを直接呼び出そうとすると、リソースが見つかりませんというエラー メッセージが表示されます。

3 つ目は、アプリケーション コントローラーに、ムービー カテゴリのリストを追加してデータを表示するコンストラクターが含まれていることに注意してください。 アプリケーション コントローラーから継承されるすべてのコントローラー クラスは、アプリケーション コントローラーのコンストラクターを自動的に呼び出します。 アプリケーション コントローラーから継承したコントローラーでアクションを呼び出すと、ムービーのカテゴリがビュー データに自動的に含まれます。

リスト 5 の Movies コントローラは、アプリケーション コントローラから継承されます。

**リスト5 –`Controllers\MoviesController.cs`**

[!code-csharp[Main](passing-data-to-view-master-pages-cs/samples/sample5.cs)]

Movies コントローラは、前のセクションで説明した Home コントローラと同様に、 と`Index()`という`Details()`2 つのアクション メソッドを公開します。 ビュー マスター ページによって表示されるムービー カテゴリの一覧は、`Index()`または`Details()`メソッドのデータを表示するために追加されません。 ムービー コントローラはアプリケーション コントローラから継承するため、ムービー カテゴリのリストが自動的にデータを表示するために追加されます。

ビュー マスター ページのビュー データを追加するこのソリューションは、DRY (繰り返しを繰り返さない) 原則に違反しないことに注意してください。 ムービーカテゴリのリストを追加してデータを表示するコードは、アプリケーションコントローラのコンストラクタという1つの場所にしか含まれていません。

### <a name="summary"></a>まとめ

このチュートリアルでは、コント ローラーからビュー マスター ページにビュー データを渡す 2 つの方法について説明します。 まず、単純で、かつ、維持が難しいアプローチを検討しました。 最初のセクションでは、アプリケーションの各コントローラ アクションでビュー マスター ページのビュー データを追加する方法について説明しました。 DRY(繰り返さない)の原則に違反しているため、これは悪いアプローチであると結論付けました。

次に、ビュー マスター ページで必要なデータを追加してデータを表示するための、より優れた戦略を検討しました。 各コントローラー アクションにビュー データを追加する代わりに、アプリケーション コントローラー内にビュー データを 1 回だけ追加しました。 このようにすると、ASP.NET MVC アプリケーションでビュー マスター ページにデータを渡すときに、コードの重複を回避できます。

> [!div class="step-by-step"]
> [前へ](creating-page-layouts-with-view-master-pages-cs.md)
> [次へ](asp-net-mvc-views-overview-vb.md)

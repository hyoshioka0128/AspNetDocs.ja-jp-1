---
uid: identity/overview/getting-started/introduction-to-aspnet-identity
title: ASP.NET Identity の概要-ASP.NET 4.x
author: jongalloway
description: ASP.NET メンバーシップシステムは、ASP.NET 2.0 を使用して2005に戻されました。そのため、web アプリケーションでは、さまざまな変更が行われています。
ms.author: riande
ms.date: 01/22/2019
ms.assetid: 38717fc1-5989-43cf-952d-4007cc1dd923
ms.custom: seoapril2019
msc.legacyurl: /identity/overview/getting-started/introduction-to-aspnet-identity
msc.type: authoredcontent
ms.openlocfilehash: 0268dfc16cd2cfb1e79ee14997a4c5eb247af950
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 03/06/2020
ms.locfileid: "78471736"
---
# <a name="introduction-to-aspnet-identity"></a><span data-ttu-id="62ecf-103">ASP.NET Identity 入門</span><span class="sxs-lookup"><span data-stu-id="62ecf-103">Introduction to ASP.NET Identity</span></span>

> <span data-ttu-id="62ecf-104">ASP.NET メンバーシップシステムは、ASP.NET 2.0 を使用して2005に戻されました。そのため、web アプリケーションは通常、認証と承認を処理する方法に多くの変更が加えられています。</span><span class="sxs-lookup"><span data-stu-id="62ecf-104">The ASP.NET membership system was introduced with ASP.NET 2.0 back in 2005, and since then there have been many changes in the ways web applications typically handle authentication and authorization.</span></span> <span data-ttu-id="62ecf-105">ASP.NET Identity は、web、電話、タブレット用の最新のアプリケーションを構築する際に、メンバーシップシステムがどのようなものである必要があるかを詳しく見ていきます。</span><span class="sxs-lookup"><span data-stu-id="62ecf-105">ASP.NET Identity is a fresh look at what the membership system should be when you are building modern applications for the web, phone, or tablet.</span></span>

## <a name="background-membership-in-aspnet"></a><span data-ttu-id="62ecf-106">背景: ASP.NET のメンバーシップ</span><span class="sxs-lookup"><span data-stu-id="62ecf-106">Background: Membership in ASP.NET</span></span>

### <a name="aspnet-membership"></a><span data-ttu-id="62ecf-107">ASP.NET メンバーシップ</span><span class="sxs-lookup"><span data-stu-id="62ecf-107">ASP.NET Membership</span></span>

<span data-ttu-id="62ecf-108">[ASP.NET のメンバーシップ](https://msdn.microsoft.com/library/yh26yfzy(v=VS.100).aspx)は、フォーム認証に関連する2005に共通するサイトメンバーシップ要件と、ユーザー名、パスワード、およびプロファイルデータの SQL Server データベースを解決するように設計されています。</span><span class="sxs-lookup"><span data-stu-id="62ecf-108">[ASP.NET Membership](https://msdn.microsoft.com/library/yh26yfzy(v=VS.100).aspx) was designed to solve site membership requirements that were common in 2005, which involved Forms Authentication, and a SQL Server database for user names, passwords, and profile data.</span></span> <span data-ttu-id="62ecf-109">現在、web アプリケーション用のデータストレージオプションははるかに広範囲になっており、ほとんどの開発者は、サイトで認証と承認の機能にソーシャル id プロバイダーを使用できるようにしたいと考えています。</span><span class="sxs-lookup"><span data-stu-id="62ecf-109">Today there is a much broader array of data storage options for web applications, and most developers want to enable their sites to use social identity providers for authentication and authorization functionality.</span></span> <span data-ttu-id="62ecf-110">ASP.NET メンバーシップの設計の制限によって、この移行は困難になります。</span><span class="sxs-lookup"><span data-stu-id="62ecf-110">The limitations of ASP.NET Membership's design make this transition difficult:</span></span>

- <span data-ttu-id="62ecf-111">データベーススキーマは SQL Server 向けに設計されており、変更することはできません。</span><span class="sxs-lookup"><span data-stu-id="62ecf-111">The database schema was designed for SQL Server and you can't change it.</span></span> <span data-ttu-id="62ecf-112">プロファイル情報を追加できますが、追加データは別のテーブルにパックされるため、プロファイルプロバイダー API を使用する場合を除き、どのような方法でもアクセスが困難になります。</span><span class="sxs-lookup"><span data-stu-id="62ecf-112">You can add profile information, but the additional data is packed into a different table, which makes it difficult to access by any means except through the Profile Provider API.</span></span>
- <span data-ttu-id="62ecf-113">プロバイダーシステムを使用すると、バッキングデータストアを変更できますが、システムはリレーショナルデータベースに適した想定に基づいて設計されています。</span><span class="sxs-lookup"><span data-stu-id="62ecf-113">The provider system enables you to change the backing data store, but the system is designed around assumptions appropriate for a relational database.</span></span> <span data-ttu-id="62ecf-114">メンバーシップ情報を非リレーショナルストレージメカニズム (Azure Storage テーブルなど) に格納するプロバイダーを作成することができますが、多くのコードを記述し、NoSQL データベースには適用されないメソッドの `System.NotImplementedException` の例外を大量に記述することで、リレーショナル設計を回避する必要があります。</span><span class="sxs-lookup"><span data-stu-id="62ecf-114">You can write a provider to store membership information in a non-relational storage mechanism, such as Azure Storage Tables, but then you have to work around the relational design by writing much code and a lot of `System.NotImplementedException` exceptions for methods that don't apply to NoSQL databases.</span></span>
- <span data-ttu-id="62ecf-115">ログイン/ログアウト機能はフォーム認証に基づいているため、メンバーシップシステムで[OWIN](../../../aspnet/overview/owin-and-katana/an-overview-of-project-katana.md)を使用することはできません。</span><span class="sxs-lookup"><span data-stu-id="62ecf-115">Since the log-in/log-out functionality is based on Forms Authentication, the membership system can't use [OWIN](../../../aspnet/overview/owin-and-katana/an-overview-of-project-katana.md).</span></span> <span data-ttu-id="62ecf-116">OWIN には、認証用のミドルウェアコンポーネントが含まれています。これには、外部 id プロバイダー (Microsoft アカウント、Facebook、Google、Twitter など) を使用したログインのサポートや、オンプレミス Active Directory の組織アカウントを使用したログインなどがあります。Azure Active Directory。</span><span class="sxs-lookup"><span data-stu-id="62ecf-116">OWIN includes middleware components for authentication, including support for log-ins using external identity providers (like Microsoft Accounts, Facebook, Google, Twitter), and log-ins using organizational accounts from on-premises Active Directory or Azure Active Directory.</span></span> <span data-ttu-id="62ecf-117">OWIN には、OAuth 2.0、JWT、CORS のサポートも含まれています。</span><span class="sxs-lookup"><span data-stu-id="62ecf-117">OWIN also includes support for OAuth 2.0, JWT and CORS.</span></span>

### <a name="aspnet-simple-membership"></a><span data-ttu-id="62ecf-118">ASP.NET Simple メンバーシップ</span><span class="sxs-lookup"><span data-stu-id="62ecf-118">ASP.NET Simple Membership</span></span>

<span data-ttu-id="62ecf-119">[ASP.NET simple メンバーシップ](../../../web-pages/overview/security/16-adding-security-and-membership.md)は、ASP.NET Web ページのメンバーシップシステムとして開発されました。</span><span class="sxs-lookup"><span data-stu-id="62ecf-119">[ASP.NET simple membership](../../../web-pages/overview/security/16-adding-security-and-membership.md) was developed as a membership system for ASP.NET Web Pages.</span></span> <span data-ttu-id="62ecf-120">WebMatrix と Visual Studio 2010 SP1 でリリースされました。</span><span class="sxs-lookup"><span data-stu-id="62ecf-120">It was released with WebMatrix and Visual Studio 2010 SP1.</span></span> <span data-ttu-id="62ecf-121">単純なメンバーシップの目的は、Web ページアプリケーションにメンバーシップ機能を簡単に追加できるようにすることでした。</span><span class="sxs-lookup"><span data-stu-id="62ecf-121">The goal of Simple Membership was to make it easy to add membership functionality to a Web Pages application.</span></span>

<span data-ttu-id="62ecf-122">単純なメンバーシップを使用すると、ユーザープロファイル情報のカスタマイズが容易になりますが、ASP.NET メンバーシップに関する他の問題は引き続き共有され、いくつかの制限があります。</span><span class="sxs-lookup"><span data-stu-id="62ecf-122">Simple Membership did make it easier to customize user profile information, but it still shares the other problems with ASP.NET Membership, and it has some limitations:</span></span>

- <span data-ttu-id="62ecf-123">非リレーショナルストアにメンバーシップシステムデータを保持することは困難でした。</span><span class="sxs-lookup"><span data-stu-id="62ecf-123">It was hard to persist membership system data in a non-relational store.</span></span>
- <span data-ttu-id="62ecf-124">OWIN で使用することはできません。</span><span class="sxs-lookup"><span data-stu-id="62ecf-124">You can't use it with OWIN.</span></span>
- <span data-ttu-id="62ecf-125">既存の ASP.NET メンバーシッププロバイダーではうまく機能せず、拡張もできません。</span><span class="sxs-lookup"><span data-stu-id="62ecf-125">It doesn't work well with existing ASP.NET Membership providers, and it's not extensible.</span></span>

### <a name="aspnet-universal-providers"></a><span data-ttu-id="62ecf-126">ASP.NET ユニバーサル プロバイダー</span><span class="sxs-lookup"><span data-stu-id="62ecf-126">ASP.NET Universal Providers</span></span>

<span data-ttu-id="62ecf-127">[ASP.NET ユニバーサルプロバイダー](http://www.hanselman.com/blog/IntroducingSystemWebProvidersASPNETUniversalProvidersForSessionMembershipRolesAndUserProfileOnSQLCompactAndSQLAzure.aspx)は Microsoft Azure SQL Database でメンバーシップ情報を永続化できるように開発されており、SQL Server Compact でも使用できます。</span><span class="sxs-lookup"><span data-stu-id="62ecf-127">[ASP.NET Universal Providers](http://www.hanselman.com/blog/IntroducingSystemWebProvidersASPNETUniversalProvidersForSessionMembershipRolesAndUserProfileOnSQLCompactAndSQLAzure.aspx) were developed to make it possible to persist membership information in Microsoft Azure SQL Database, and they also work with SQL Server Compact.</span></span> <span data-ttu-id="62ecf-128">ユニバーサルプロバイダーは Entity Framework Code First 上に構築されています。これは、EF によってサポートされる任意のストアのデータを保持するためにユニバーサルプロバイダーを使用できることを意味します。</span><span class="sxs-lookup"><span data-stu-id="62ecf-128">The Universal Providers were built on Entity Framework Code First, which means that the Universal Providers can be used to persist data in any store supported by EF.</span></span> <span data-ttu-id="62ecf-129">ユニバーサルプロバイダーでは、データベーススキーマも大幅にクリーンアップされています。</span><span class="sxs-lookup"><span data-stu-id="62ecf-129">With the Universal Providers, the database schema was cleaned up quite a lot as well.</span></span>

<span data-ttu-id="62ecf-130">ユニバーサルプロバイダーは ASP.NET メンバーシップインフラストラクチャ上に構築されているので、SqlMembership プロバイダーと同じ制限があります。</span><span class="sxs-lookup"><span data-stu-id="62ecf-130">The Universal Providers are built on the ASP.NET Membership infrastructure, so they still carry the same limitations as the SqlMembership Provider.</span></span> <span data-ttu-id="62ecf-131">つまり、リレーショナルデータベース向けに設計されており、プロファイルとユーザー情報をカスタマイズするのは困難です。</span><span class="sxs-lookup"><span data-stu-id="62ecf-131">That is, they were designed for relational databases and it's hard to customize profile and user information.</span></span> <span data-ttu-id="62ecf-132">これらのプロバイダーでは、サインインとサインアウトの機能にもフォーム認証を使用します。</span><span class="sxs-lookup"><span data-stu-id="62ecf-132">These providers also still use Forms Authentication for sign-in and sign-out functionality.</span></span>

## <a name="aspnet-identity"></a><span data-ttu-id="62ecf-133">ASP.NET Identity</span><span class="sxs-lookup"><span data-stu-id="62ecf-133">ASP.NET Identity</span></span>

<span data-ttu-id="62ecf-134">ASP.NET のメンバーシップのストーリーが長年にわたって進化したため、ASP.NET チームはお客様からのフィードバックから膨大なことを学んできました。</span><span class="sxs-lookup"><span data-stu-id="62ecf-134">As the membership story in ASP.NET has evolved over the years, the ASP.NET team has learned a lot from feedback from customers.</span></span>

<span data-ttu-id="62ecf-135">ユーザーが自分のアプリケーションに登録したユーザー名とパスワードを入力することによってサインインすることを前提としています。</span><span class="sxs-lookup"><span data-stu-id="62ecf-135">The assumption that users will sign in by entering a user name and password that they have registered in your own application is no longer valid.</span></span> <span data-ttu-id="62ecf-136">Web がより社会的になりました。</span><span class="sxs-lookup"><span data-stu-id="62ecf-136">The web has become more social.</span></span> <span data-ttu-id="62ecf-137">ユーザーは、Facebook、Twitter、その他のソーシャル web サイトなどのソーシャルチャネルを使用して、リアルタイムで相互に対話しています。</span><span class="sxs-lookup"><span data-stu-id="62ecf-137">Users are interacting with each other in real time through social channels such as Facebook, Twitter, and other social web sites.</span></span> <span data-ttu-id="62ecf-138">開発者は、ユーザーが自分のソーシャル id を使用してサインインできるようにすることで、web サイトに豊富なエクスペリエンスを提供できます。</span><span class="sxs-lookup"><span data-stu-id="62ecf-138">Developers want users to be able to sign in with their social identities so that they can have a rich experience on their web sites.</span></span> <span data-ttu-id="62ecf-139">最新のメンバーシップシステムでは、Facebook、Twitter などの認証プロバイダーに対するリダイレクトベースのログインを有効にする必要があります。</span><span class="sxs-lookup"><span data-stu-id="62ecf-139">A modern membership system must enable redirection-based log-ins to authentication providers such as Facebook, Twitter, and others.</span></span>

<span data-ttu-id="62ecf-140">Web 開発の進化に応じて、web 開発のパターンを作成しました。</span><span class="sxs-lookup"><span data-stu-id="62ecf-140">As web development evolved, so did the patterns of web development.</span></span> <span data-ttu-id="62ecf-141">アプリケーションコードの単体テストは、アプリケーション開発者にとって重要な問題になりました。</span><span class="sxs-lookup"><span data-stu-id="62ecf-141">Unit testing of application code became a core concern for application developers.</span></span> <span data-ttu-id="62ecf-142">2008では、開発者が単体テスト可能な ASP.NET アプリケーションを構築するのに役立つ、モデルビューコントローラー (MVC) パターンに基づく新しいフレームワークが ASP.NET に追加されました。</span><span class="sxs-lookup"><span data-stu-id="62ecf-142">In 2008 ASP.NET added a new framework based on the Model-View-Controller (MVC) pattern, in part to help developers build unit testable ASP.NET applications.</span></span> <span data-ttu-id="62ecf-143">また、アプリケーションロジックの単体テストを行う開発者は、メンバーシップシステムを使用してそれを実行できるようにしたいと考えています。</span><span class="sxs-lookup"><span data-stu-id="62ecf-143">Developers who wanted to unit test their application logic also wanted to be able to do that with the membership system.</span></span>

<span data-ttu-id="62ecf-144">これらの変更を web アプリケーション開発で検討すると、ASP.NET Identity は次の目的で開発されました。</span><span class="sxs-lookup"><span data-stu-id="62ecf-144">Considering these changes in web application development, ASP.NET Identity was developed with the following goals:</span></span>

- <span data-ttu-id="62ecf-145">**1つの ASP.NET Identity システム**</span><span class="sxs-lookup"><span data-stu-id="62ecf-145">**One ASP.NET Identity system**</span></span>

    - <span data-ttu-id="62ecf-146">ASP.NET Identity は、ASP.NET MVC、Web フォーム、Web ページ、Web API、SignalR など、すべての ASP.NET フレームワークで使用できます。</span><span class="sxs-lookup"><span data-stu-id="62ecf-146">ASP.NET Identity can be used with all of the ASP.NET frameworks, such as ASP.NET MVC, Web Forms, Web Pages, Web API, and SignalR.</span></span>
    - <span data-ttu-id="62ecf-147">ASP.NET Identity は、web、電話、ストア、またはハイブリッドアプリケーションを構築するときに使用できます。</span><span class="sxs-lookup"><span data-stu-id="62ecf-147">ASP.NET Identity can be used when you are building web, phone, store, or hybrid applications.</span></span>
- <span data-ttu-id="62ecf-148">**ユーザーに関するプロファイルデータを簡単にプラグインする**</span><span class="sxs-lookup"><span data-stu-id="62ecf-148">**Ease of plugging in profile data about the user**</span></span>

    - <span data-ttu-id="62ecf-149">ユーザーおよびプロファイル情報のスキーマを制御できます。</span><span class="sxs-lookup"><span data-stu-id="62ecf-149">You have control over the schema of user and profile information.</span></span> <span data-ttu-id="62ecf-150">たとえば、ユーザーがアプリケーションにアカウントを登録するときにユーザーが入力した生年月日を格納できるように、システムを簡単に有効にすることができます。</span><span class="sxs-lookup"><span data-stu-id="62ecf-150">For example, you can easily enable the system to store birth dates entered by users when they register an account in your application.</span></span>

- <span data-ttu-id="62ecf-151">**永続化コントロール**</span><span class="sxs-lookup"><span data-stu-id="62ecf-151">**Persistence control**</span></span>

    - <span data-ttu-id="62ecf-152">既定では、ASP.NET Identity システムによって、すべてのユーザー情報がデータベースに格納されます。</span><span class="sxs-lookup"><span data-stu-id="62ecf-152">By default, the ASP.NET Identity system stores all the user information in a database.</span></span> <span data-ttu-id="62ecf-153">ASP.NET Identity は Entity Framework Code First を使用して、すべての永続化メカニズムを実装します。</span><span class="sxs-lookup"><span data-stu-id="62ecf-153">ASP.NET Identity uses Entity Framework Code First to implement all of its persistence mechanism.</span></span>
    - <span data-ttu-id="62ecf-154">データベーススキーマを制御するため、テーブル名の変更や主キーのデータ型の変更などの一般的なタスクは簡単に行うことができます。</span><span class="sxs-lookup"><span data-stu-id="62ecf-154">Since you control the database schema, common tasks such as changing table names or changing the data type of primary keys is simple to do.</span></span>
    - <span data-ttu-id="62ecf-155">`System.NotImplementedExceptions` 例外をスローすることなく、SharePoint、Azure Storage Table Service、NoSQL databases などのさまざまなストレージメカニズムを簡単にプラグインできます。</span><span class="sxs-lookup"><span data-stu-id="62ecf-155">It's easy to plug in different storage mechanisms such as SharePoint, Azure Storage Table Service, NoSQL databases, etc., without having to throw `System.NotImplementedExceptions` exceptions.</span></span>
- <span data-ttu-id="62ecf-156">**単体テスト**</span><span class="sxs-lookup"><span data-stu-id="62ecf-156">**Unit testability**</span></span>

    - <span data-ttu-id="62ecf-157">ASP.NET Identity により、web アプリケーションの単体テストが容易になります。</span><span class="sxs-lookup"><span data-stu-id="62ecf-157">ASP.NET Identity makes the web application more unit testable.</span></span> <span data-ttu-id="62ecf-158">ASP.NET Identity を使用するアプリケーションの一部に対して単体テストを記述できます。</span><span class="sxs-lookup"><span data-stu-id="62ecf-158">You can write unit tests for the parts of your application that use ASP.NET Identity.</span></span>
- <span data-ttu-id="62ecf-159">**ロールプロバイダー**</span><span class="sxs-lookup"><span data-stu-id="62ecf-159">**Role provider**</span></span>

    - <span data-ttu-id="62ecf-160">ロールによってアプリケーションの一部へのアクセスを制限できるロールプロバイダーがあります。</span><span class="sxs-lookup"><span data-stu-id="62ecf-160">There is a role provider which lets you restrict access to parts of your application by roles.</span></span> <span data-ttu-id="62ecf-161">"Admin" などのロールを簡単に作成し、ユーザーをロールに追加することができます。</span><span class="sxs-lookup"><span data-stu-id="62ecf-161">You can easily create roles such as "Admin" and add users to roles.</span></span>
- <span data-ttu-id="62ecf-162">**要求ベース**</span><span class="sxs-lookup"><span data-stu-id="62ecf-162">**Claims Based**</span></span>

    - <span data-ttu-id="62ecf-163">ASP.NET Identity は、クレームベースの認証をサポートしています。この場合、ユーザーの id はクレームのセットとして表されます。</span><span class="sxs-lookup"><span data-stu-id="62ecf-163">ASP.NET Identity supports claims-based authentication, where the user's identity is represented as a set of claims.</span></span> <span data-ttu-id="62ecf-164">要求を使用すると、開発者はロールで許可されているユーザーの id を記述する際に、はるかに表現力を高めることができます。</span><span class="sxs-lookup"><span data-stu-id="62ecf-164">Claims allow developers to be a lot more expressive in describing a user's identity than roles allow.</span></span> <span data-ttu-id="62ecf-165">ロールのメンバーシップはブール値 (メンバーまたは非メンバー) であるのに対し、クレームには、ユーザーの id とメンバーシップに関する豊富な情報を含めることができます。</span><span class="sxs-lookup"><span data-stu-id="62ecf-165">Whereas role membership is just a boolean (member or non-member), a claim can include rich information about the user's identity and membership.</span></span>
- <span data-ttu-id="62ecf-166">**ソーシャルログインプロバイダー**</span><span class="sxs-lookup"><span data-stu-id="62ecf-166">**Social Login Providers**</span></span>

    - <span data-ttu-id="62ecf-167">Microsoft アカウント、Facebook、Twitter、Google などのソーシャルログをアプリケーションに簡単に追加し、ユーザー固有のデータをアプリケーションに格納することができます。</span><span class="sxs-lookup"><span data-stu-id="62ecf-167">You can easily add social log-ins such as Microsoft Account, Facebook, Twitter, Google, and others to your application, and store the user-specific data in your application.</span></span>

- <span data-ttu-id="62ecf-168">**OWIN の統合**</span><span class="sxs-lookup"><span data-stu-id="62ecf-168">**OWIN Integration**</span></span>

    - <span data-ttu-id="62ecf-169">ASP.NET 認証は、任意の OWIN ベースのホストで使用できる OWIN ミドルウェアに基づいています。</span><span class="sxs-lookup"><span data-stu-id="62ecf-169">ASP.NET authentication is now based on OWIN middleware that can be used on any OWIN-based host.</span></span> <span data-ttu-id="62ecf-170">ASP.NET Identity は、System.web に依存していません。</span><span class="sxs-lookup"><span data-stu-id="62ecf-170">ASP.NET Identity does not have any dependency on System.Web.</span></span> <span data-ttu-id="62ecf-171">これは完全に準拠した OWIN フレームワークであり、OWIN でホストされるアプリケーションで使用できます。</span><span class="sxs-lookup"><span data-stu-id="62ecf-171">It is a fully compliant OWIN framework and can be used in any OWIN hosted application.</span></span>
    - <span data-ttu-id="62ecf-172">ASP.NET Identity は、web サイトのユーザーのログイン/ログアウトに OWIN 認証を使用します。</span><span class="sxs-lookup"><span data-stu-id="62ecf-172">ASP.NET Identity uses OWIN Authentication for log-in/log-out of users in the web site.</span></span> <span data-ttu-id="62ecf-173">つまり、FormsAuthentication を使用して cookie を生成する代わりに、アプリケーションで OWIN CookieAuthentication を使用します。</span><span class="sxs-lookup"><span data-stu-id="62ecf-173">This means that instead of using FormsAuthentication to generate the cookie, the application uses OWIN CookieAuthentication to do that.</span></span>
- <span data-ttu-id="62ecf-174">**NuGet パッケージ**</span><span class="sxs-lookup"><span data-stu-id="62ecf-174">**NuGet package**</span></span>

    - <span data-ttu-id="62ecf-175">ASP.NET Identity は、Visual Studio 2017 に付属する ASP.NET MVC、Web フォーム、Web API テンプレートにインストールされている NuGet パッケージとして再配布されます。</span><span class="sxs-lookup"><span data-stu-id="62ecf-175">ASP.NET Identity is redistributed as a NuGet package which is installed in the ASP.NET MVC, Web Forms and Web API templates that ship with Visual Studio 2017.</span></span> <span data-ttu-id="62ecf-176">この NuGet パッケージは、NuGet ギャラリーからダウンロードできます。</span><span class="sxs-lookup"><span data-stu-id="62ecf-176">You can download this NuGet package from the NuGet gallery.</span></span>
    - <span data-ttu-id="62ecf-177">NuGet パッケージとして ASP.NET Identity をリリースすることにより、ASP.NET チームは新しい機能やバグ修正を簡単に反復処理し、アジャイルな方法で開発者に配信できます。</span><span class="sxs-lookup"><span data-stu-id="62ecf-177">Releasing ASP.NET Identity as a NuGet package makes it easier for the ASP.NET team to iterate on new features and bug fixes, and deliver these to developers in an agile manner.</span></span>

## <a name="get-started-with-aspnet-identity"></a><span data-ttu-id="62ecf-178">ASP.NET Identity を使ってみる</span><span class="sxs-lookup"><span data-stu-id="62ecf-178">Get started with ASP.NET Identity</span></span>

<span data-ttu-id="62ecf-179">ASP.NET Identity は、ASP.NET MVC、Web フォーム、Web API、および SPA 用の Visual Studio 2017 プロジェクトテンプレートで使用されます。</span><span class="sxs-lookup"><span data-stu-id="62ecf-179">ASP.NET Identity is used in the Visual Studio 2017 project templates for ASP.NET MVC, Web Forms, Web API and SPA.</span></span> <span data-ttu-id="62ecf-180">このチュートリアルでは、プロジェクトテンプレートで ASP.NET Identity を使用して、ユーザーの登録、サインイン、サインアウトを行う機能を追加する方法を説明します。</span><span class="sxs-lookup"><span data-stu-id="62ecf-180">In this walkthrough, we'll illustrate how the project templates use ASP.NET Identity to add functionality to register, sign in and sign out a user.</span></span>

<span data-ttu-id="62ecf-181">ASP.NET Identity は、次の手順を使用して実装されます。</span><span class="sxs-lookup"><span data-stu-id="62ecf-181">ASP.NET Identity is implemented using the following procedure.</span></span> <span data-ttu-id="62ecf-182">この記事の目的は、ASP.NET Identity の概要を説明することです。詳細については、「ステップバイステップ」または「詳細」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="62ecf-182">The purpose of this article is to give you a high level overview of ASP.NET Identity; you can follow it step by step or just read the details.</span></span> <span data-ttu-id="62ecf-183">新しい API を使用してユーザー、ロール、およびプロファイル情報を追加するなど、ASP.NET Identity を使用してアプリを作成する手順の詳細については、この記事の最後にある「次のステップ」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="62ecf-183">For more detailed instructions on creating apps using ASP.NET Identity, including using the new API to add users, roles and profile information, see the Next Steps section at the end of this article.</span></span>

1. <span data-ttu-id="62ecf-184">個々のアカウントを使用して ASP.NET MVC アプリケーションを作成します。</span><span class="sxs-lookup"><span data-stu-id="62ecf-184">Create an ASP.NET MVC application with Individual Accounts.</span></span> <span data-ttu-id="62ecf-185">ASP.NET Identity は、ASP.NET MVC、Web フォーム、Web API、SignalR などで使用できます。この記事では、ASP.NET MVC アプリケーションから始めます。</span><span class="sxs-lookup"><span data-stu-id="62ecf-185">You can use ASP.NET Identity in ASP.NET MVC, Web Forms, Web API, SignalR etc. In this article we will start with an ASP.NET MVC application.</span></span>  
  
    ![](introduction-to-aspnet-identity/_static/image1.png)
2. <span data-ttu-id="62ecf-186">作成されたプロジェクトには、ASP.NET Identity 用の次の3つのパッケージが含まれています。</span><span class="sxs-lookup"><span data-stu-id="62ecf-186">The created project contains the following three packages for ASP.NET Identity.</span></span>

    - [`Microsoft.AspNet.Identity.EntityFramework`](http://www.nuget.org/packages/Microsoft.AspNet.Identity.EntityFramework/)  
   <span data-ttu-id="62ecf-187">このパッケージには ASP.NET Identity の Entity Framework 実装があり、ASP.NET Identity のデータとスキーマは SQL Server に保存されます。</span><span class="sxs-lookup"><span data-stu-id="62ecf-187">This package has the Entity Framework implementation of ASP.NET Identity which will persist the ASP.NET Identity data and schema to SQL Server.</span></span>
    - [`Microsoft.AspNet.Identity.Core`](http://www.nuget.org/packages/Microsoft.AspNet.Identity.Core/)  
   <span data-ttu-id="62ecf-188">このパッケージには ASP.NET Identity のコアインターフェイスがあります。</span><span class="sxs-lookup"><span data-stu-id="62ecf-188">This package has the core interfaces for ASP.NET Identity.</span></span> <span data-ttu-id="62ecf-189">このパッケージは、Azure Table Storage、NoSQL データベースなどのさまざまな永続ストアを対象とする ASP.NET Identity の実装を記述するために使用できます。</span><span class="sxs-lookup"><span data-stu-id="62ecf-189">This package can be used to write an implementation for ASP.NET Identity that targets different persistence stores such as Azure Table Storage, NoSQL databases etc.</span></span>
    - [`Microsoft.AspNet.Identity.OWIN`](http://www.nuget.org/packages/Microsoft.AspNet.Identity.Owin/)  
   <span data-ttu-id="62ecf-190">このパッケージには、OWIN 認証を ASP.NET アプリケーションの ASP.NET Identity にプラグインするために使用される機能が含まれています。</span><span class="sxs-lookup"><span data-stu-id="62ecf-190">This package contains functionality that is used to plug in OWIN authentication with ASP.NET Identity in ASP.NET applications.</span></span> <span data-ttu-id="62ecf-191">これは、サインイン機能をアプリケーションに追加し、OWIN Cookie 認証ミドルウェアを呼び出して cookie を生成するときに使用されます。</span><span class="sxs-lookup"><span data-stu-id="62ecf-191">This is used when you add sign in functionality to your application and call into OWIN Cookie Authentication middleware to generate a cookie.</span></span>
3. <span data-ttu-id="62ecf-192">ユーザーを作成しています。</span><span class="sxs-lookup"><span data-stu-id="62ecf-192">Creating a user.</span></span>  
   <span data-ttu-id="62ecf-193">アプリケーションを起動し、 **[登録]** リンクをクリックしてユーザーを作成します。</span><span class="sxs-lookup"><span data-stu-id="62ecf-193">Launch the application and then click on the **Register** link to create a user.</span></span> <span data-ttu-id="62ecf-194">次の図は、ユーザー名とパスワードを収集する登録ページを示しています。</span><span class="sxs-lookup"><span data-stu-id="62ecf-194">The following image shows the Register page that collects the user name and password.</span></span>  
  
    ![](introduction-to-aspnet-identity/_static/image2.png)  
  
   <span data-ttu-id="62ecf-195">ユーザーが **[登録]** ボタンを選択すると、アカウントコントローラーの `Register` アクションで、次に示すように ASP.NET Identity API を呼び出すことによってユーザーが作成されます。</span><span class="sxs-lookup"><span data-stu-id="62ecf-195">When the user selects the **Register** button, the `Register` action of the Account controller creates the user by calling the ASP.NET Identity API, as highlighted below:</span></span>

    [!code-csharp[Main](introduction-to-aspnet-identity/samples/sample1.cs?highlight=8-9)]
4. <span data-ttu-id="62ecf-196">サインインします。</span><span class="sxs-lookup"><span data-stu-id="62ecf-196">Sign in.</span></span>  
   <span data-ttu-id="62ecf-197">ユーザーが正常に作成された場合は、`SignInAsync` メソッドによってサインインされます。</span><span class="sxs-lookup"><span data-stu-id="62ecf-197">If the user was successfully created, she is signed in by the `SignInAsync` method.</span></span>  

    [!code-csharp[Main](introduction-to-aspnet-identity/samples/sample6.cs?highlight=12)]

   <span data-ttu-id="62ecf-198">`SignInManager.SignInAsync` メソッドは、 [ClaimsIdentity](https://msdn.microsoft.com/library/system.security.claims.claimsidentity.aspx)を生成します。</span><span class="sxs-lookup"><span data-stu-id="62ecf-198">The `SignInManager.SignInAsync` method generates a [ClaimsIdentity](https://msdn.microsoft.com/library/system.security.claims.claimsidentity.aspx).</span></span> <span data-ttu-id="62ecf-199">ASP.NET Identity と OWIN Cookie 認証はクレームベースのシステムであるため、フレームワークでは、ユーザーの ClaimsIdentity を生成するようにアプリに要求します。</span><span class="sxs-lookup"><span data-stu-id="62ecf-199">Since ASP.NET Identity and OWIN Cookie Authentication are claims-based system, the framework requires the app to generate a ClaimsIdentity for the user.</span></span> <span data-ttu-id="62ecf-200">ClaimsIdentity には、ユーザーが属するロールなど、ユーザーのすべての要求に関する情報が含まれています。</span><span class="sxs-lookup"><span data-stu-id="62ecf-200">ClaimsIdentity has information about all the claims for the user, such as what roles the user belongs to.</span></span>   
 
5. <span data-ttu-id="62ecf-201">ログオフします。</span><span class="sxs-lookup"><span data-stu-id="62ecf-201">Log off.</span></span>  
   <span data-ttu-id="62ecf-202">[ログオフ **] リンクを**選択して、アカウントコントローラーでログオフアクションを呼び出します。</span><span class="sxs-lookup"><span data-stu-id="62ecf-202">Select the **Log off** link to call the LogOff action in the account controller.</span></span> 

    [!code-csharp[Main](introduction-to-aspnet-identity/samples/sample5.cs?highlight=6)]

   <span data-ttu-id="62ecf-203">上の強調表示されているコードは、OWIN `AuthenticationManager.SignOut` メソッドを示しています。</span><span class="sxs-lookup"><span data-stu-id="62ecf-203">The highlighted code above shows the OWIN `AuthenticationManager.SignOut` method.</span></span> <span data-ttu-id="62ecf-204">これは、Web フォームの[FormsAuthentication](https://msdn.microsoft.com/library/system.web.security.formsauthenticationmodule.aspx)モジュールで使用される[サインアウト](https://msdn.microsoft.com/library/system.web.security.formsauthentication.signout.aspx)メソッドに似ています。</span><span class="sxs-lookup"><span data-stu-id="62ecf-204">This is analogous to [FormsAuthentication.SignOut](https://msdn.microsoft.com/library/system.web.security.formsauthentication.signout.aspx) method used by the [FormsAuthentication](https://msdn.microsoft.com/library/system.web.security.formsauthenticationmodule.aspx) module in Web Forms.</span></span>

## <a name="components-of-aspnet-identity"></a><span data-ttu-id="62ecf-205">ASP.NET Identity のコンポーネント</span><span class="sxs-lookup"><span data-stu-id="62ecf-205">Components of ASP.NET Identity</span></span>

<span data-ttu-id="62ecf-206">次の図は、ASP.NET Identity システムのコンポーネントを示しています ([こ](introduction-to-aspnet-identity/_static/image3.png)のコンポーネントを選択するか、図を拡大して拡大します)。</span><span class="sxs-lookup"><span data-stu-id="62ecf-206">The diagram below shows the components of the ASP.NET Identity system (select on [this](introduction-to-aspnet-identity/_static/image3.png) or on the diagram to enlarge it).</span></span> <span data-ttu-id="62ecf-207">緑のパッケージは、ASP.NET Identity システムを構成します。</span><span class="sxs-lookup"><span data-stu-id="62ecf-207">The packages in green make up the ASP.NET Identity system.</span></span> <span data-ttu-id="62ecf-208">他のすべてのパッケージは、ASP.NET アプリケーションで ASP.NET Identity システムを使用するために必要な依存関係です。</span><span class="sxs-lookup"><span data-stu-id="62ecf-208">All the other packages are dependencies which are needed to use the ASP.NET Identity system in ASP.NET applications.</span></span>

[![](introduction-to-aspnet-identity/_static/image5.png)](introduction-to-aspnet-identity/_static/image4.png)

<span data-ttu-id="62ecf-209">前に説明しなかった NuGet パッケージの簡単な説明を次に示します。</span><span class="sxs-lookup"><span data-stu-id="62ecf-209">The following is a brief description of the NuGet packages not mentioned previously:</span></span>

- [<span data-ttu-id="62ecf-210">Microsoft.Owin.Security.Cookies</span><span class="sxs-lookup"><span data-stu-id="62ecf-210">Microsoft.Owin.Security.Cookies</span></span>](http://www.nuget.org/packages/Microsoft.Owin.Security.Cookies/)  
 <span data-ttu-id="62ecf-211">アプリケーションが、ASP と同様に cookie ベースの認証を使用できるようにするミドルウェア。NET のフォーム認証。</span><span class="sxs-lookup"><span data-stu-id="62ecf-211">Middleware that enables an application to use cookie based authentication, similar to ASP.NET's Forms Authentication.</span></span>
- [<span data-ttu-id="62ecf-212">EntityFramework</span><span class="sxs-lookup"><span data-stu-id="62ecf-212">EntityFramework</span></span>](http://www.nuget.org/packages/EntityFramework/)  
 <span data-ttu-id="62ecf-213">Entity Framework は、リレーショナルデータベースに対して Microsoft が推奨するデータアクセステクノロジです。</span><span class="sxs-lookup"><span data-stu-id="62ecf-213">Entity Framework is Microsoft's recommended data access technology for relational databases.</span></span>

## <a name="migrating-from-membership-to-aspnet-identity"></a><span data-ttu-id="62ecf-214">メンバーシップから ASP.NET Identity への移行</span><span class="sxs-lookup"><span data-stu-id="62ecf-214">Migrating from Membership to ASP.NET Identity</span></span>

<span data-ttu-id="62ecf-215">ASP.NET メンバーシップを使用する既存のアプリや、単純なメンバーシップを新しい ASP.NET Identity システムに移行する方法についてのガイダンスをすぐに提供することをお勧めします。</span><span class="sxs-lookup"><span data-stu-id="62ecf-215">We hope to soon provide guidance on migrating your existing apps that use ASP.NET Membership or Simple Membership to the new ASP.NET Identity system.</span></span>

## <a name="next-steps"></a><span data-ttu-id="62ecf-216">次の手順</span><span class="sxs-lookup"><span data-stu-id="62ecf-216">Next Steps</span></span>

- [<span data-ttu-id="62ecf-217">Facebook と Google OAuth2 と OpenID サインオンを使用して ASP.NET MVC 5 アプリを作成する</span><span class="sxs-lookup"><span data-stu-id="62ecf-217">Create an ASP.NET MVC 5 App with Facebook and Google OAuth2 and OpenID Sign-on</span></span>](../../../mvc/overview/security/create-an-aspnet-mvc-5-app-with-facebook-and-google-oauth2-and-openid-sign-on.md)  
 <span data-ttu-id="62ecf-218">このチュートリアルでは、ASP.NET Identity API を使用して、ユーザーデータベースにプロファイル情報を追加し、Google と Facebook で認証する方法を説明します。</span><span class="sxs-lookup"><span data-stu-id="62ecf-218">The tutorial uses the ASP.NET Identity API to add profile information to the user database, and how to authenticate with Google and Facebook.</span></span>
- [<span data-ttu-id="62ecf-219">認証および SQL DB を使用する ASP.NET MVC アプリの作成と、Azure App Service へのデプロイ</span><span class="sxs-lookup"><span data-stu-id="62ecf-219">Create an ASP.NET MVC app with auth and SQL DB and deploy to Azure App Service</span></span>](https://docs.microsoft.com/aspnet/core/security/authorization/secure-data)  
 <span data-ttu-id="62ecf-220">このチュートリアルでは、Identity API を使用してユーザーとロールを追加する方法について説明します。</span><span class="sxs-lookup"><span data-stu-id="62ecf-220">This tutorial shows how to use the Identity API to add users and roles.</span></span>
- [https://github.com/rustd/AspnetIdentitySample](https://github.com/rustd/AspnetIdentitySample)  
 <span data-ttu-id="62ecf-221">基本的な役割とユーザーサポートを追加する方法と、役割とユーザー管理を行う方法を示すサンプルアプリケーション。</span><span class="sxs-lookup"><span data-stu-id="62ecf-221">Sample application that shows how to add basic roles and user support and how to do roles and user management.</span></span>

---
uid: web-forms/overview/deployment/web-deployment-in-the-enterprise/understanding-the-project-file
title: プロジェクトファイルについてMicrosoft Docs
author: jrjlee
description: ビルドと配置のプロセスの中核となるのは、Microsoft Build Engine (MSBuild) プロジェクトファイルです。 このトピックでは、まず MSBuild の概要について説明します。
ms.author: riande
ms.date: 05/04/2012
ms.assetid: 07978d9d-341c-4524-bcba-62976f390f77
msc.legacyurl: /web-forms/overview/deployment/web-deployment-in-the-enterprise/understanding-the-project-file
msc.type: authoredcontent
ms.openlocfilehash: 419fe51aaf65bddcc2c50380f099f842a8d9439c
ms.sourcegitcommit: 84b1681d4e6253e30468c8df8a09fe03beea9309
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 11/02/2019
ms.locfileid: "73445691"
---
# <a name="understanding-the-project-file"></a><span data-ttu-id="1c715-104">プロジェクトファイルについて</span><span class="sxs-lookup"><span data-stu-id="1c715-104">Understanding the project file</span></span>

<span data-ttu-id="1c715-105">[Jason Lee](https://github.com/jrjlee)</span><span class="sxs-lookup"><span data-stu-id="1c715-105">by [Jason Lee](https://github.com/jrjlee)</span></span>

[<span data-ttu-id="1c715-106">PDF のダウンロード</span><span class="sxs-lookup"><span data-stu-id="1c715-106">Download PDF</span></span>](https://msdnshared.blob.core.windows.net/media/MSDNBlogsFS/prod.evol.blogs.msdn.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/00/63/56/8130.DeployingWebAppsInEnterpriseScenarios.pdf)

> <span data-ttu-id="1c715-107">ビルドと配置のプロセスの中核となるのは、Microsoft Build Engine (MSBuild) プロジェクトファイルです。</span><span class="sxs-lookup"><span data-stu-id="1c715-107">Microsoft Build Engine (MSBuild) project files lie at the heart of the build and deployment process.</span></span> <span data-ttu-id="1c715-108">このトピックでは、まず MSBuild とプロジェクトファイルの概念的な概要について説明します。</span><span class="sxs-lookup"><span data-stu-id="1c715-108">This topic starts with a conceptual overview of MSBuild and the project file.</span></span> <span data-ttu-id="1c715-109">ここでは、プロジェクトファイルを操作するときに使用する主要なコンポーネントについて説明します。また、プロジェクトファイルを使用して実際のアプリケーションを配置する方法の例を示します。</span><span class="sxs-lookup"><span data-stu-id="1c715-109">It describes the key components you'll come across when you work with project files, and it works through an example of how you can use project files to deploy real-world applications.</span></span>
> 
> <span data-ttu-id="1c715-110">学習内容:</span><span class="sxs-lookup"><span data-stu-id="1c715-110">What you'll learn:</span></span>
> 
> - <span data-ttu-id="1c715-111">MSBuild が MSBuild プロジェクトファイルを使用してプロジェクトをビルドする方法。</span><span class="sxs-lookup"><span data-stu-id="1c715-111">How MSBuild uses MSBuild project files to build projects.</span></span>
> - <span data-ttu-id="1c715-112">MSBuild をインターネットインフォメーションサービス (IIS) Web 配置ツール (Web 配置) などの展開テクノロジと統合する方法について説明します。</span><span class="sxs-lookup"><span data-stu-id="1c715-112">How MSBuild integrates with deployment technologies, like the Internet Information Services (IIS) Web Deployment Tool (Web Deploy).</span></span>
> - <span data-ttu-id="1c715-113">プロジェクトファイルの主要なコンポーネントを理解する方法。</span><span class="sxs-lookup"><span data-stu-id="1c715-113">How to understand the key components of a project file.</span></span>
> - <span data-ttu-id="1c715-114">プロジェクトファイルを使用して複雑なアプリケーションをビルドおよび配置する方法について説明します。</span><span class="sxs-lookup"><span data-stu-id="1c715-114">How you can use project files to build and deploy complex applications.</span></span>

## <a name="msbuild-and-the-project-file"></a><span data-ttu-id="1c715-115">MSBuild とプロジェクトファイル</span><span class="sxs-lookup"><span data-stu-id="1c715-115">MSBuild and the Project File</span></span>

<span data-ttu-id="1c715-116">Visual Studio でソリューションを作成してビルドすると、Visual Studio は MSBuild を使用してソリューション内の各プロジェクトをビルドします。</span><span class="sxs-lookup"><span data-stu-id="1c715-116">When you create and build solutions in Visual Studio, Visual Studio uses MSBuild to build each project in your solution.</span></span> <span data-ttu-id="1c715-117">すべてのC# Visual Studio プロジェクトには、MSBuild プロジェクトファイルが含まれています。ファイル拡張子&#x2014;は、プロジェクト (.csproj)、Visual Basic.NET プロジェクト (.vbproj)、またはデータベースプロジェクト (.dbproj) などのプロジェクトの種類を反映しています。</span><span class="sxs-lookup"><span data-stu-id="1c715-117">Every Visual Studio project includes an MSBuild project file, with a file extension that reflects the type of project&#x2014;for example, a C# project (.csproj), a Visual Basic.NET project (.vbproj), or a database project (.dbproj).</span></span> <span data-ttu-id="1c715-118">プロジェクトをビルドするには、MSBuild がプロジェクトに関連付けられているプロジェクトファイルを処理する必要があります。</span><span class="sxs-lookup"><span data-stu-id="1c715-118">In order to build a project, MSBuild must process the project file associated with the project.</span></span> <span data-ttu-id="1c715-119">プロジェクトファイルは、MSBuild がプロジェクトをビルドするために必要なすべての情報と手順を含む XML ドキュメントです。これには、含めるコンテンツ、プラットフォーム要件、バージョン管理情報、web サーバーまたはデータベースサーバーの設定、実行する必要があるタスク。</span><span class="sxs-lookup"><span data-stu-id="1c715-119">The project file is an XML document that contains all the information and instructions that MSBuild needs in order to build your project, like the content to include, the platform requirements, versioning information, web server or database server settings, and the tasks that must be performed.</span></span>

<span data-ttu-id="1c715-120">MSBuild プロジェクトファイルは[MSBUILD XML スキーマ](/visualstudio/msbuild/msbuild-project-file-schema-reference)に基づいており、その結果、ビルドプロセスは完全にオープンで透過的になります。</span><span class="sxs-lookup"><span data-stu-id="1c715-120">MSBuild project files are based on the [MSBuild XML schema](/visualstudio/msbuild/msbuild-project-file-schema-reference), and as a result the build process is entirely open and transparent.</span></span> <span data-ttu-id="1c715-121">また、msbuild エンジン&#x2014;を使用するために Visual Studio をインストールする必要はありません。 msbuild.exe 実行可能ファイルは .NET Framework に含まれており、コマンドプロンプトから実行できます。</span><span class="sxs-lookup"><span data-stu-id="1c715-121">In addition, you don't need to install Visual Studio in order to use the MSBuild engine&#x2014;the MSBuild.exe executable is part of the .NET Framework, and you can run it from a command prompt.</span></span> <span data-ttu-id="1c715-122">開発者は、MSBuild XML スキーマを使用して独自の MSBuild プロジェクトファイルを作成し、プロジェクトのビルドと配置の方法を洗練された詳細な制御を行うことができます。</span><span class="sxs-lookup"><span data-stu-id="1c715-122">As a developer, you can craft your own MSBuild project files, using the MSBuild XML schema, to impose sophisticated and fine-grained control over how your projects are built and deployed.</span></span> <span data-ttu-id="1c715-123">これらのカスタムプロジェクトファイルは、Visual Studio によって自動的に生成されるプロジェクトファイルとまったく同じ方法で動作します。</span><span class="sxs-lookup"><span data-stu-id="1c715-123">These custom project files work in exactly the same way as the project files that Visual Studio generates automatically.</span></span>

> [!NOTE]
> <span data-ttu-id="1c715-124">MSBuild プロジェクトファイルは、Team Foundation Server (TFS) のチームビルドサービスと共に使用することもできます。</span><span class="sxs-lookup"><span data-stu-id="1c715-124">You can also use MSBuild project files with the Team Build service in Team Foundation Server (TFS).</span></span> <span data-ttu-id="1c715-125">たとえば、継続的インテグレーション (CI) シナリオでプロジェクトファイルを使用すると、新しいコードがチェックインされたときにテスト環境への配置を自動化できます。</span><span class="sxs-lookup"><span data-stu-id="1c715-125">For example, you can use project files in continuous integration (CI) scenarios to automate deployment to a test environment when new code is checked in.</span></span> <span data-ttu-id="1c715-126">詳細については、「[自動 Web 展開の Team Foundation Server の構成](../configuring-team-foundation-server-for-web-deployment/configuring-team-foundation-server-for-web-deployment.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="1c715-126">For more information, see [Configuring Team Foundation Server for Automated Web Deployment](../configuring-team-foundation-server-for-web-deployment/configuring-team-foundation-server-for-web-deployment.md).</span></span>

### <a name="project-file-naming-conventions"></a><span data-ttu-id="1c715-127">プロジェクトファイルの名前付け規則</span><span class="sxs-lookup"><span data-stu-id="1c715-127">Project File Naming Conventions</span></span>

<span data-ttu-id="1c715-128">独自のプロジェクトファイルを作成する場合は、任意のファイル拡張子を使用できます。</span><span class="sxs-lookup"><span data-stu-id="1c715-128">When you create your own project files, you can use any file extension you like.</span></span> <span data-ttu-id="1c715-129">ただし、ソリューションを他のユーザーが理解しやすいようにするには、次の一般的な規則を使用する必要があります。</span><span class="sxs-lookup"><span data-stu-id="1c715-129">However, to make your solutions easier for others to understand, you should use these common conventions:</span></span>

- <span data-ttu-id="1c715-130">プロジェクトをビルドするプロジェクトファイルを作成する場合は、proj 拡張子を使用します。</span><span class="sxs-lookup"><span data-stu-id="1c715-130">Use the .proj extension when you create a project file that builds projects.</span></span>
- <span data-ttu-id="1c715-131">他のプロジェクトファイルにインポートする再利用可能なプロジェクトファイルを作成する場合は、.targets 拡張子を使用します。</span><span class="sxs-lookup"><span data-stu-id="1c715-131">Use the .targets extension when you create a reusable project file to import into other project files.</span></span> <span data-ttu-id="1c715-132">.Targets 拡張子の付いたファイルは、通常は何もビルドしません。これには、proj ファイルにインポートできる指示が含まれているだけです。</span><span class="sxs-lookup"><span data-stu-id="1c715-132">Files with a .targets extension typically don't build anything themselves, they simply contain instructions that you can import into your .proj files.</span></span>

### <a name="integration-with-deployment-technologies"></a><span data-ttu-id="1c715-133">展開テクノロジとの統合</span><span class="sxs-lookup"><span data-stu-id="1c715-133">Integration with Deployment Technologies</span></span>

<span data-ttu-id="1c715-134">ASP.NET web applications や ASP.NET MVC web アプリケーションのように、Visual Studio 2010 で web アプリケーションプロジェクトを操作したことがある場合、これらのプロジェクトには、web アプリケーションをパッケージ化してターゲット環境に配置するための組み込みサポートが含まれていることがわかります。</span><span class="sxs-lookup"><span data-stu-id="1c715-134">If you've worked with web application projects in Visual Studio 2010, like ASP.NET web applications and ASP.NET MVC web applications, you'll know that these projects include built-in support for packaging and deploying the web application to a target environment.</span></span> <span data-ttu-id="1c715-135">これらのプロジェクトの**プロパティ**ページには、アプリケーションのコンポーネントのパッケージ化と配置の方法を構成するために使用できる **[Web のパッケージ化/発行]** タブと **[SQL のパッケージ化/発行]** タブがあります。</span><span class="sxs-lookup"><span data-stu-id="1c715-135">The **Properties** pages for these projects include **Package/Publish Web** and **Package/Publish SQL** tabs that you can use to configure how the components of your application are packaged and deployed.</span></span> <span data-ttu-id="1c715-136">[Web の**パッケージ化/発行**] タブが表示されます。</span><span class="sxs-lookup"><span data-stu-id="1c715-136">This shows the **Package/Publish Web** tab:</span></span>

![](understanding-the-project-file/_static/image1.png)

<span data-ttu-id="1c715-137">これらの機能の背後にある基になるテクノロジは、Web 発行パイプライン (WPP) と呼ばれます。</span><span class="sxs-lookup"><span data-stu-id="1c715-137">The underlying technology behind these capabilities is known as the Web Publishing Pipeline (WPP).</span></span> <span data-ttu-id="1c715-138">WPP は基本的に、MSBuild と[Web 配置](https://go.microsoft.com/?linkid=9805122)を統合して、Web アプリケーションの完全なビルド、パッケージ、および配置プロセスを提供します。</span><span class="sxs-lookup"><span data-stu-id="1c715-138">The WPP essentially brings MSBuild and [Web Deploy](https://go.microsoft.com/?linkid=9805122) together to provide a complete build, package, and deployment process for your web applications.</span></span>

<span data-ttu-id="1c715-139">Web プロジェクト用のカスタムプロジェクトファイルを作成するときに、WPP によって提供される統合ポイントを利用できるという素晴らしいニュースがあります。</span><span class="sxs-lookup"><span data-stu-id="1c715-139">The good news is that you can take advantage of the integration points that the WPP provides when you create custom project files for web projects.</span></span> <span data-ttu-id="1c715-140">プロジェクトファイルに配置手順を含めることができます。これにより、プロジェクトのビルド、web 配置パッケージの作成、およびこれらのパッケージのリモートサーバーへのインストールを、1つのプロジェクトファイルと MSBuild の1回の呼び出しで行うことができます。</span><span class="sxs-lookup"><span data-stu-id="1c715-140">You can include deployment instructions in your project file, which allows you to build your projects, create web deployment packages, and install these packages on remote servers through a single project file and a single call to MSBuild.</span></span> <span data-ttu-id="1c715-141">ビルドプロセスの一部として、他の実行可能ファイルを呼び出すこともできます。</span><span class="sxs-lookup"><span data-stu-id="1c715-141">You can also call any other executables as part of your build process.</span></span> <span data-ttu-id="1c715-142">たとえば、VSDBCMD コマンドラインツールを実行して、スキーマファイルからデータベースを配置できます。</span><span class="sxs-lookup"><span data-stu-id="1c715-142">For example, you can run the VSDBCMD.exe command-line tool to deploy a database from a schema file.</span></span> <span data-ttu-id="1c715-143">このトピックでは、これらの機能を利用して、エンタープライズ展開シナリオの要件を満たす方法について説明します。</span><span class="sxs-lookup"><span data-stu-id="1c715-143">Over the course of this topic, you'll see how you can take advantage of these capabilities to meet the requirements of your enterprise deployment scenarios.</span></span>

> [!NOTE]
> <span data-ttu-id="1c715-144">Web アプリケーションの配置プロセスのしくみの詳細については、「 [ASP.NET Web アプリケーションプロジェクトの配置の概要](https://msdn.microsoft.com/library/dd394698.aspx)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="1c715-144">For more information on how the web application deployment process works, see [ASP.NET Web Application Project Deployment Overview](https://msdn.microsoft.com/library/dd394698.aspx).</span></span>

## <a name="the-anatomy-of-a-project-file"></a><span data-ttu-id="1c715-145">プロジェクトファイルの構造</span><span class="sxs-lookup"><span data-stu-id="1c715-145">The Anatomy of a Project File</span></span>

<span data-ttu-id="1c715-146">ビルドプロセスの詳細を確認する前に、MSBuild プロジェクトファイルの基本的な構造について理解しておく必要があります。</span><span class="sxs-lookup"><span data-stu-id="1c715-146">Before you look at the build process in more detail, it's worth taking a few moments to familiarize yourself with the basic structure of an MSBuild project file.</span></span> <span data-ttu-id="1c715-147">このセクションでは、プロジェクトファイルを確認、編集、または作成するときに発生する一般的な要素の概要について説明します。</span><span class="sxs-lookup"><span data-stu-id="1c715-147">This section provides an overview of the more common elements that you'll encounter when you review, edit, or create a project file.</span></span> <span data-ttu-id="1c715-148">具体的には、次のことについて説明します。</span><span class="sxs-lookup"><span data-stu-id="1c715-148">In particular, you'll learn:</span></span>

- <span data-ttu-id="1c715-149">*プロパティ*を使用してビルド処理の変数を管理する方法。</span><span class="sxs-lookup"><span data-stu-id="1c715-149">How to use *properties* to manage variables for the build process.</span></span>
- <span data-ttu-id="1c715-150">*項目*を使用してビルド処理の入力を識別する方法 (コードファイルなど)。</span><span class="sxs-lookup"><span data-stu-id="1c715-150">How to use *items* to identify the inputs to the build process, like code files.</span></span>
- <span data-ttu-id="1c715-151">*ターゲット*と*タスク*を使用して、プロジェクトファイル内の他の場所で定義された*プロパティ*と*項目*を使用して、MSBuild に実行命令を提供する方法。</span><span class="sxs-lookup"><span data-stu-id="1c715-151">How to use *targets* and *tasks* to provide execution instructions to MSBuild, using *properties* and *items* defined elsewhere in the project file.</span></span>

<span data-ttu-id="1c715-152">これは、MSBuild プロジェクトファイル内のキー要素間の関係を示しています。</span><span class="sxs-lookup"><span data-stu-id="1c715-152">This shows the relationship between the key elements in an MSBuild project file:</span></span>

![](understanding-the-project-file/_static/image2.png)

### <a name="the-project-element"></a><span data-ttu-id="1c715-153">Project 要素</span><span class="sxs-lookup"><span data-stu-id="1c715-153">The Project Element</span></span>

<span data-ttu-id="1c715-154">[Project](https://msdn.microsoft.com/library/bcxfsh87.aspx)要素は、すべてのプロジェクトファイルのルート要素です。</span><span class="sxs-lookup"><span data-stu-id="1c715-154">The [Project](https://msdn.microsoft.com/library/bcxfsh87.aspx) element is the root element of every project file.</span></span> <span data-ttu-id="1c715-155">**プロジェクト要素に**は、プロジェクトファイルの XML スキーマを識別するだけでなく、ビルドプロセスのエントリポイントを指定するための属性を含めることができます。</span><span class="sxs-lookup"><span data-stu-id="1c715-155">In addition to identifying the XML schema for the project file, the **Project** element can include attributes to specify the entry points for the build process.</span></span> <span data-ttu-id="1c715-156">たとえば、 [Contact Manager サンプルソリューション](the-contact-manager-solution.md)では、" **fullpublish**" という名前のターゲットを呼び出すことによって、ビルドを開始する必要があることを指定し*ます。*</span><span class="sxs-lookup"><span data-stu-id="1c715-156">For example, in the [Contact Manager sample solution](the-contact-manager-solution.md), the *Publish.proj* file specifies that the build should start by calling the target named **FullPublish**.</span></span>

[!code-xml[Main](understanding-the-project-file/samples/sample1.xml)]

### <a name="properties-and-conditions"></a><span data-ttu-id="1c715-157">プロパティと条件</span><span class="sxs-lookup"><span data-stu-id="1c715-157">Properties and Conditions</span></span>

<span data-ttu-id="1c715-158">プロジェクトファイルは、通常、プロジェクトを正常にビルドおよび配置するためにさまざまな情報を提供する必要があります。</span><span class="sxs-lookup"><span data-stu-id="1c715-158">A project file typically needs to provide lots of different pieces of information in order to successfully build and deploy your projects.</span></span> <span data-ttu-id="1c715-159">これらの情報には、サーバー名、接続文字列、資格情報、ビルド構成、ソースとターゲットのファイルパス、およびカスタマイズをサポートするために必要なその他の情報が含まれます。</span><span class="sxs-lookup"><span data-stu-id="1c715-159">These pieces of information could include server names, connection strings, credentials, build configurations, source and destination file paths, and any other information you want to include to support customization.</span></span> <span data-ttu-id="1c715-160">プロジェクトファイルでは、 [PropertyGroup](https://msdn.microsoft.com/library/t4w159bs.aspx)要素内でプロパティを定義する必要があります。</span><span class="sxs-lookup"><span data-stu-id="1c715-160">In a project file, properties must be defined within a [PropertyGroup](https://msdn.microsoft.com/library/t4w159bs.aspx) element.</span></span> <span data-ttu-id="1c715-161">MSBuild プロパティは、キーと値のペアで構成されます。</span><span class="sxs-lookup"><span data-stu-id="1c715-161">MSBuild properties consist of key-value pairs.</span></span> <span data-ttu-id="1c715-162">**PropertyGroup**要素内では、要素名によってプロパティキーが定義され、要素の内容によってプロパティ値が定義されます。</span><span class="sxs-lookup"><span data-stu-id="1c715-162">Within the **PropertyGroup** element, the element name defines the property key and the content of the element defines the property value.</span></span> <span data-ttu-id="1c715-163">たとえば、 **ServerName**および**ConnectionString**という名前のプロパティを定義して、静的サーバー名と接続文字列を格納できます。</span><span class="sxs-lookup"><span data-stu-id="1c715-163">For example, you could define properties named **ServerName** and **ConnectionString** to store a static server name and connection string.</span></span>

[!code-xml[Main](understanding-the-project-file/samples/sample2.xml)]

<span data-ttu-id="1c715-164">プロパティ値を取得するには、 *$ (PropertyName)* という形式を使用します。</span><span class="sxs-lookup"><span data-stu-id="1c715-164">To retrieve a property value, use the format *$(PropertyName)*.</span></span> <span data-ttu-id="1c715-165">たとえば、 **ServerName**プロパティの値を取得するには、次のように入力します。</span><span class="sxs-lookup"><span data-stu-id="1c715-165">For example, to retrieve the value of the **ServerName** property, you would type:</span></span>

[!code-powershell[Main](understanding-the-project-file/samples/sample3.ps1)]

> [!NOTE]
> <span data-ttu-id="1c715-166">このトピックの後半で、プロパティ値を使用する方法とタイミングの例を紹介します。</span><span class="sxs-lookup"><span data-stu-id="1c715-166">You'll see examples of how and when to use property values later in this topic.</span></span>

<span data-ttu-id="1c715-167">プロジェクトファイルに静的なプロパティとして情報を埋め込むことは、常にビルドプロセスを管理するための理想的な方法ではありません。</span><span class="sxs-lookup"><span data-stu-id="1c715-167">Embedding information as static properties in a project file is not always the ideal approach to managing the build process.</span></span> <span data-ttu-id="1c715-168">さまざまなシナリオでは、他のソースから情報を取得したり、ユーザーがコマンドプロンプトから情報を提供できるようにしたりすることができます。</span><span class="sxs-lookup"><span data-stu-id="1c715-168">In a lot of scenarios, you'll want to obtain the information from other sources or empower the user to provide the information from the command prompt.</span></span> <span data-ttu-id="1c715-169">MSBuild では、コマンドラインパラメーターとして任意のプロパティ値を指定できます。</span><span class="sxs-lookup"><span data-stu-id="1c715-169">MSBuild allows you to specify any property value as a command-line parameter.</span></span> <span data-ttu-id="1c715-170">たとえば、ユーザーがコマンドラインから Msbuild.exe を実行するときに、 **ServerName**の値を指定できます。</span><span class="sxs-lookup"><span data-stu-id="1c715-170">For example, the user could provide a value for **ServerName** when he or she runs MSBuild.exe from the command line.</span></span>

[!code-console[Main](understanding-the-project-file/samples/sample4.cmd)]

> [!NOTE]
> <span data-ttu-id="1c715-171">Msbuild.exe で使用できる引数とスイッチの詳細については、「 [Msbuild コマンドラインリファレンス](https://msdn.microsoft.com/library/ms164311.aspx)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="1c715-171">For more information on the arguments and switches you can use with MSBuild.exe, see [MSBuild Command Line Reference](https://msdn.microsoft.com/library/ms164311.aspx).</span></span>

<span data-ttu-id="1c715-172">同じプロパティ構文を使用して、環境変数と組み込みプロジェクトプロパティの値を取得できます。</span><span class="sxs-lookup"><span data-stu-id="1c715-172">You can use the same property syntax to obtain the values of environment variables and built-in project properties.</span></span> <span data-ttu-id="1c715-173">よく使用される多くのプロパティが定義されており、関連するパラメーター名を含めることによってプロジェクトファイルで使用できます。</span><span class="sxs-lookup"><span data-stu-id="1c715-173">Lots of commonly used properties are defined for you, and you can use them in your project files by including the relevant parameter name.</span></span> <span data-ttu-id="1c715-174">たとえば、&#x2014;現在のプロジェクトプラットフォーム ( **x86**や**AnyCpu**&#x2014;など) を取得するには、プロジェクトファイルに **$ (platform)** プロパティの参照を含めることができます。</span><span class="sxs-lookup"><span data-stu-id="1c715-174">For example, to retrieve the current project platform&#x2014;for example, **x86** or **AnyCpu**&#x2014;you can include the **$(Platform)** property reference in your project file.</span></span> <span data-ttu-id="1c715-175">詳細については、「[ビルドコマンドとプロパティのマクロ](https://msdn.microsoft.com/library/c02as0cs.aspx)」、「 [MSBuild プロジェクトの共通プロパティ](https://msdn.microsoft.com/library/bb629394.aspx)」、および「[予約済みのプロパティ](https://msdn.microsoft.com/library/ms164309.aspx)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="1c715-175">For more information, see [Macros for Build Commands and Properties](https://msdn.microsoft.com/library/c02as0cs.aspx), [Common MSBuild Project Properties](https://msdn.microsoft.com/library/bb629394.aspx), and [Reserved Properties](https://msdn.microsoft.com/library/ms164309.aspx).</span></span>

<span data-ttu-id="1c715-176">プロパティは、多くの場合、*条件*と組み合わせて使用されます。</span><span class="sxs-lookup"><span data-stu-id="1c715-176">Properties are often used in conjunction with *conditions*.</span></span> <span data-ttu-id="1c715-177">ほとんどの MSBuild 要素は**Condition**属性をサポートしています。これにより、msbuild が要素を評価する条件を指定できます。</span><span class="sxs-lookup"><span data-stu-id="1c715-177">Most MSBuild elements support the **Condition** attribute, which lets you specify the criteria upon which MSBuild should evaluate the element.</span></span> <span data-ttu-id="1c715-178">たとえば、次のプロパティ定義について考えてみます。</span><span class="sxs-lookup"><span data-stu-id="1c715-178">For example, consider this property definition:</span></span>

[!code-xml[Main](understanding-the-project-file/samples/sample5.xml)]

<span data-ttu-id="1c715-179">MSBuild がこのプロパティ定義を処理するときに、 **$ (Outputroot)** プロパティ値が使用可能かどうかを最初に確認します。</span><span class="sxs-lookup"><span data-stu-id="1c715-179">When MSBuild processes this property definition, it first checks to see whether an **$(OutputRoot)** property value is available.</span></span> <span data-ttu-id="1c715-180">プロパティ値が空白&#x2014;の場合、ユーザーはこのプロパティ&#x2014;の値を指定していません。条件が**true**に評価され、プロパティ値がに設定され\**ます。\** 発行します。ユーザーがこのプロパティの値を指定した場合、条件は**false**と評価され、静的なプロパティ値は使用されません。</span><span class="sxs-lookup"><span data-stu-id="1c715-180">If the property value is blank&#x2014;in other words, the user hasn't provided a value for this property&#x2014;the condition evaluates to **true** and the property value is set to **..\Publish\Out**. If the user has provided a value for this property, the condition evaluates to **false** and the static property value is not used.</span></span>

<span data-ttu-id="1c715-181">条件を指定するさまざまな方法の詳細については、「 [MSBuild の条件](https://msdn.microsoft.com/library/7szfhaft.aspx)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="1c715-181">For more information on the different ways in which you can specify conditions, see [MSBuild Conditions](https://msdn.microsoft.com/library/7szfhaft.aspx).</span></span>

### <a name="items-and-item-groups"></a><span data-ttu-id="1c715-182">項目と項目グループ</span><span class="sxs-lookup"><span data-stu-id="1c715-182">Items and Item Groups</span></span>

<span data-ttu-id="1c715-183">プロジェクトファイルの重要な役割の1つは、ビルドプロセスへの入力を定義することです。</span><span class="sxs-lookup"><span data-stu-id="1c715-183">One of the important roles of the project file is to define the inputs to the build process.</span></span> <span data-ttu-id="1c715-184">通常、これらの入力は&#x2014;、ビルド処理の一部として処理またはコピーする必要があるファイルコードファイル、構成ファイル、コマンドファイル、およびその他のファイルです。</span><span class="sxs-lookup"><span data-stu-id="1c715-184">Typically, these inputs are files&#x2014;code files, configuration files, command files, and any other files that you need to process or copy as part of the build process.</span></span> <span data-ttu-id="1c715-185">MSBuild プロジェクトスキーマでは、これらの入力は[項目](https://msdn.microsoft.com/library/ms164283.aspx)要素によって表されます。</span><span class="sxs-lookup"><span data-stu-id="1c715-185">In the MSBuild project schema, these inputs are represented by [Item](https://msdn.microsoft.com/library/ms164283.aspx) elements.</span></span> <span data-ttu-id="1c715-186">プロジェクトファイルでは、 [ItemGroup](https://msdn.microsoft.com/library/646dk05y.aspx)要素内に項目を定義する必要があります。</span><span class="sxs-lookup"><span data-stu-id="1c715-186">In a project file, items must be defined within an [ItemGroup](https://msdn.microsoft.com/library/646dk05y.aspx) element.</span></span> <span data-ttu-id="1c715-187">**プロパティ**要素と同様に、**項目**要素には名前を自由に指定できます。</span><span class="sxs-lookup"><span data-stu-id="1c715-187">Just like **Property** elements, you can name an **Item** element however you like.</span></span> <span data-ttu-id="1c715-188">ただし、項目が表すファイルまたはワイルドカードを識別するには、 **Include**属性を指定する必要があります。</span><span class="sxs-lookup"><span data-stu-id="1c715-188">However, you must specify an **Include** attribute to identify the file or wildcard that the item represents.</span></span>

[!code-xml[Main](understanding-the-project-file/samples/sample6.xml)]

<span data-ttu-id="1c715-189">同じ名前の複数の**Item**要素を指定することで、リソースの名前付きリストを効果的に作成できます。</span><span class="sxs-lookup"><span data-stu-id="1c715-189">By specifying multiple **Item** elements with the same name, you're effectively creating a named list of resources.</span></span> <span data-ttu-id="1c715-190">これを実際に確認するには、Visual Studio によって作成されたプロジェクトファイルの中から1つを見てみます。</span><span class="sxs-lookup"><span data-stu-id="1c715-190">A good way to see this in action is to take a look inside one of the project files that Visual Studio creates.</span></span> <span data-ttu-id="1c715-191">たとえば、サンプルソリューションの*Contactmanager. .csproj*ファイルには、多数の項目グループが含まれており、それぞれに同じ名前の**項目**要素が複数あります。</span><span class="sxs-lookup"><span data-stu-id="1c715-191">For example, the *ContactManager.Mvc.csproj* file in the sample solution includes a lot of item groups, each with several identically named **Item** elements.</span></span>

[!code-xml[Main](understanding-the-project-file/samples/sample7.xml)]

<span data-ttu-id="1c715-192">このようにして、プロジェクトファイルは、ビルドを成功させるために必要なアセンブリが**参照**リストに&#x2014;含まれているのと同じ方法で処理する必要があるファイルのリストを構築するように MSBuild に指示します。 **[コンパイル]** の一覧にコードが含まれています。コンパイルが必要なファイルと**コンテンツ**の一覧には、変更せずにコピーする必要があるリソースが含まれます。</span><span class="sxs-lookup"><span data-stu-id="1c715-192">In this way, the project file is instructing MSBuild to construct lists of files that need to be processed in the same way&#x2014;the **Reference** list includes assemblies that must be in place for a successful build, the **Compile** list includes code files that must be compiled, and the **Content** list includes resources that must be copied unaltered.</span></span> <span data-ttu-id="1c715-193">このトピックの後の方で、ビルドプロセスがこれらの項目を参照して使用する方法について説明します。</span><span class="sxs-lookup"><span data-stu-id="1c715-193">We'll look at how the build process references and uses these items later in this topic.</span></span>

<span data-ttu-id="1c715-194">Item 要素には、 [Itemmetadata](https://msdn.microsoft.com/library/ms164284.aspx)子要素を含めることもできます。</span><span class="sxs-lookup"><span data-stu-id="1c715-194">Item elements can also include [ItemMetadata](https://msdn.microsoft.com/library/ms164284.aspx) child elements.</span></span> <span data-ttu-id="1c715-195">これらは、ユーザー定義のキーと値のペアであり、基本的にその項目に固有のプロパティを表します。</span><span class="sxs-lookup"><span data-stu-id="1c715-195">These are user-defined key-value pairs and essentially represent properties that are specific to that item.</span></span> <span data-ttu-id="1c715-196">たとえば、プロジェクトファイル内の**コンパイル**項目要素の大部分には、子要素の**依存**関係が含まれます。</span><span class="sxs-lookup"><span data-stu-id="1c715-196">For example, a lot of the **Compile** item elements in the project file include **DependentUpon** child elements.</span></span>

[!code-xml[Main](understanding-the-project-file/samples/sample8.xml)]

> [!NOTE]
> <span data-ttu-id="1c715-197">ユーザーが作成したアイテムメタデータに加え、すべてのアイテムには、作成時にさまざまな共通メタデータが割り当てられます。</span><span class="sxs-lookup"><span data-stu-id="1c715-197">In addition to user-created item metadata, all items are assigned various common metadata on creation.</span></span> <span data-ttu-id="1c715-198">詳細については、「[既知の項目メタデータ](https://msdn.microsoft.com/library/ms164313.aspx)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="1c715-198">For more information, see [Well-known Item Metadata](https://msdn.microsoft.com/library/ms164313.aspx).</span></span>

<span data-ttu-id="1c715-199">ルートレベルの**プロジェクト**要素内または特定の**ターゲット**要素内に**ItemGroup**要素を作成できます。</span><span class="sxs-lookup"><span data-stu-id="1c715-199">You can create **ItemGroup** elements within the root-level **Project** element or within specific **Target** elements.</span></span> <span data-ttu-id="1c715-200">**ItemGroup**要素は**Condition**属性もサポートします。これにより、プロジェクト構成やプラットフォームなどの条件に従って、ビルドプロセスへの入力を調整できます。</span><span class="sxs-lookup"><span data-stu-id="1c715-200">**ItemGroup** elements also support **Condition** attributes, which lets you tailor the inputs to the build process according to conditions like the project configuration or platform.</span></span>

### <a name="targets-and-tasks"></a><span data-ttu-id="1c715-201">ターゲットとタスク</span><span class="sxs-lookup"><span data-stu-id="1c715-201">Targets and Tasks</span></span>

<span data-ttu-id="1c715-202">MSBuild スキーマでは、 [task](https://msdn.microsoft.com/library/77f2hx1s.aspx)要素は個々のビルド命令 (またはタスク) を表します。</span><span class="sxs-lookup"><span data-stu-id="1c715-202">In the MSBuild schema, a [Task](https://msdn.microsoft.com/library/77f2hx1s.aspx) element represents an individual build instruction (or task).</span></span> <span data-ttu-id="1c715-203">MSBuild には、多数の定義済みタスクが含まれています。</span><span class="sxs-lookup"><span data-stu-id="1c715-203">MSBuild includes a multitude of predefined tasks.</span></span> <span data-ttu-id="1c715-204">(例:</span><span class="sxs-lookup"><span data-stu-id="1c715-204">For example:</span></span>

- <span data-ttu-id="1c715-205">**コピー**タスクは、ファイルを新しい場所にコピーします。</span><span class="sxs-lookup"><span data-stu-id="1c715-205">The **Copy** task copies files to a new location.</span></span>
- <span data-ttu-id="1c715-206">**Csc**タスクは、Visual C#コンパイラを呼び出します。</span><span class="sxs-lookup"><span data-stu-id="1c715-206">The **Csc** task invokes the Visual C# compiler.</span></span>
- <span data-ttu-id="1c715-207">**Vbc.exe**タスクは、Visual Basic コンパイラを呼び出します。</span><span class="sxs-lookup"><span data-stu-id="1c715-207">The **Vbc** task invokes the Visual Basic compiler.</span></span>
- <span data-ttu-id="1c715-208">**Exec**タスクは、指定されたプログラムを実行します。</span><span class="sxs-lookup"><span data-stu-id="1c715-208">The **Exec** task runs a specified program.</span></span>
- <span data-ttu-id="1c715-209">**メッセージ**タスクは、メッセージを logger に書き込みます。</span><span class="sxs-lookup"><span data-stu-id="1c715-209">The **Message** task writes a message to a logger.</span></span>

> [!NOTE]
> <span data-ttu-id="1c715-210">すぐに使用できるタスクの詳細については、「 [MSBuild タスクリファレンス](https://msdn.microsoft.com/library/7z253716.aspx)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="1c715-210">For full details of the tasks that are available out of the box, see [MSBuild Task Reference](https://msdn.microsoft.com/library/7z253716.aspx).</span></span> <span data-ttu-id="1c715-211">独自のカスタムタスクを作成する方法など、タスクの詳細については、「 [MSBuild タスク](https://msdn.microsoft.com/library/ms171466.aspx)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="1c715-211">For more information on tasks, including how to create your own custom tasks, see [MSBuild Tasks](https://msdn.microsoft.com/library/ms171466.aspx).</span></span>

<span data-ttu-id="1c715-212">タスクは、常に[ターゲット](https://msdn.microsoft.com/library/t50z2hka.aspx)要素内に含まれている必要があります。</span><span class="sxs-lookup"><span data-stu-id="1c715-212">Tasks must always be contained within [Target](https://msdn.microsoft.com/library/t50z2hka.aspx) elements.</span></span> <span data-ttu-id="1c715-213">**Target**要素は、順番に実行される1つ以上のタスクのセットであり、プロジェクトファイルには複数のターゲットを含めることができます。</span><span class="sxs-lookup"><span data-stu-id="1c715-213">A **Target** element is a set of one or more tasks that are executed sequentially, and a project file can contain multiple targets.</span></span> <span data-ttu-id="1c715-214">タスクまたは一連のタスクを実行する場合は、タスクを含むターゲットを呼び出します。</span><span class="sxs-lookup"><span data-stu-id="1c715-214">When you want to run a task, or a set of tasks, you invoke the target that contains them.</span></span> <span data-ttu-id="1c715-215">たとえば、メッセージをログに記録する単純なプロジェクトファイルがあるとします。</span><span class="sxs-lookup"><span data-stu-id="1c715-215">For example, suppose you have a simple project file that logs a message.</span></span>

[!code-xml[Main](understanding-the-project-file/samples/sample9.xml)]

<span data-ttu-id="1c715-216">**/T**スイッチを使用してターゲットを指定することで、コマンドラインからターゲットを呼び出すことができます。</span><span class="sxs-lookup"><span data-stu-id="1c715-216">You can invoke the target from the command line, by using the **/t** switch to specify the target.</span></span>

[!code-console[Main](understanding-the-project-file/samples/sample10.cmd)]

<span data-ttu-id="1c715-217">または、 **defaulttargets**属性を**Project**要素に追加して、呼び出すターゲットを指定することもできます。</span><span class="sxs-lookup"><span data-stu-id="1c715-217">Alternatively, you can add a **DefaultTargets** attribute to the **Project** element, to specify the targets that you want to invoke.</span></span>

[!code-xml[Main](understanding-the-project-file/samples/sample11.xml)]

<span data-ttu-id="1c715-218">この場合、コマンドラインからターゲットを指定する必要はありません。</span><span class="sxs-lookup"><span data-stu-id="1c715-218">In this case, you don't need to specify the target from the command line.</span></span> <span data-ttu-id="1c715-219">プロジェクトファイルを指定するだけで、MSBuild は**Fullpublish**ターゲットを呼び出すことができます。</span><span class="sxs-lookup"><span data-stu-id="1c715-219">You can simply specify the project file, and MSBuild will invoke the **FullPublish** target for you.</span></span>

[!code-console[Main](understanding-the-project-file/samples/sample12.cmd)]

<span data-ttu-id="1c715-220">ターゲットとタスクには両方とも**条件**属性を含めることができます。</span><span class="sxs-lookup"><span data-stu-id="1c715-220">Both targets and tasks can include **Condition** attributes.</span></span> <span data-ttu-id="1c715-221">そのため、特定の条件が満たされた場合に、ターゲット全体または個々のタスクを除外することを選択できます。</span><span class="sxs-lookup"><span data-stu-id="1c715-221">As such, you can choose to omit entire targets or individual tasks if certain conditions are met.</span></span>

<span data-ttu-id="1c715-222">一般に、便利なタスクとターゲットを作成する場合は、プロジェクトファイルの他の場所で定義したプロパティと項目を参照する必要があります。</span><span class="sxs-lookup"><span data-stu-id="1c715-222">Generally speaking, when you create useful tasks and targets, you'll need to refer to the properties and items that you've defined elsewhere in the project file:</span></span>

- <span data-ttu-id="1c715-223">プロパティ値を使用するには、「 **$ (***propertyname***)** 」と入力します。ここで、 *propertyname*は**プロパティ**要素の名前、またはパラメーターの名前です。</span><span class="sxs-lookup"><span data-stu-id="1c715-223">To use a property value, type **$(***PropertyName***)**, where *PropertyName* is the name of the **Property** element or the name of the parameter.</span></span>
- <span data-ttu-id="1c715-224">項目を使用するには、「 **@ (***itemname***)** 」と入力します。ここで、 *itemname*は**item**要素の名前です。</span><span class="sxs-lookup"><span data-stu-id="1c715-224">To use an item, type **@(***ItemName***)**, where *ItemName* is the name of the **Item** element.</span></span>

> [!NOTE]
> <span data-ttu-id="1c715-225">同じ名前で複数の項目を作成する場合は、リストを作成していることに注意してください。</span><span class="sxs-lookup"><span data-stu-id="1c715-225">Remember that if you create multiple items with the same name, you're building a list.</span></span> <span data-ttu-id="1c715-226">これに対して、同じ名前で複数のプロパティを作成した場合、指定した最後のプロパティ値によって、&#x2014;同じ名前を持つ以前のプロパティが上書きされます。プロパティには、1つの値のみを含めることができます。</span><span class="sxs-lookup"><span data-stu-id="1c715-226">In contrast, if you create multiple properties with the same name, the last property value you provide will overwrite any previous properties with the same name&#x2014;a property can only contain a single value.</span></span>

<span data-ttu-id="1c715-227">たとえば、サンプルソリューションの*Publish*ファイルで、 **buildprojects**ターゲットを見てみましょう。</span><span class="sxs-lookup"><span data-stu-id="1c715-227">For example, in the *Publish.proj* file in the sample solution, take a look at the **BuildProjects** target.</span></span>

[!code-xml[Main](understanding-the-project-file/samples/sample13.xml)]

<span data-ttu-id="1c715-228">このサンプルでは、次の重要なポイントを確認できます。</span><span class="sxs-lookup"><span data-stu-id="1c715-228">In this sample, you can observe these key points:</span></span>

- <span data-ttu-id="1c715-229">**BuildingInTeamBuild**パラメーターが指定され、値が**true**の場合、このターゲット内のタスクは実行されません。</span><span class="sxs-lookup"><span data-stu-id="1c715-229">If the **BuildingInTeamBuild** parameter is specified and has a value of **true**, none of the tasks within this target will be executed.</span></span>
- <span data-ttu-id="1c715-230">ターゲットには、 [MSBuild](https://msdn.microsoft.com/library/z7f65y0d.aspx)タスクの1つのインスタンスが含まれています。</span><span class="sxs-lookup"><span data-stu-id="1c715-230">The target contains a single instance of the [MSBuild](https://msdn.microsoft.com/library/z7f65y0d.aspx) task.</span></span> <span data-ttu-id="1c715-231">このタスクを使用すると、他の MSBuild プロジェクトをビルドできます。</span><span class="sxs-lookup"><span data-stu-id="1c715-231">This task lets you build other MSBuild projects.</span></span>
- <span data-ttu-id="1c715-232">**Projectstobuild**項目がタスクに渡されます。</span><span class="sxs-lookup"><span data-stu-id="1c715-232">The **ProjectsToBuild** item is passed to the task.</span></span> <span data-ttu-id="1c715-233">この項目は、プロジェクトファイルまたはソリューションファイルの一覧を表すことができます。これは、項目グループ内の**Projectstobuild** item 要素によって定義されます。</span><span class="sxs-lookup"><span data-stu-id="1c715-233">This item could represent a list of project or solution files, all defined by **ProjectsToBuild** item elements within an item group.</span></span> <span data-ttu-id="1c715-234">この場合、 **Projectstobuild**項目は1つのソリューションファイルを参照します。</span><span class="sxs-lookup"><span data-stu-id="1c715-234">In this case, the **ProjectsToBuild** item refers to a single solution file.</span></span>

    [!code-xml[Main](understanding-the-project-file/samples/sample14.xml)]
- <span data-ttu-id="1c715-235">**MSBuild**タスクに渡されるプロパティ値には、 **Outputroot**および**Configuration**という名前のパラメーターが含まれます。</span><span class="sxs-lookup"><span data-stu-id="1c715-235">The property values passed to the **MSBuild** task include parameters named **OutputRoot** and **Configuration**.</span></span> <span data-ttu-id="1c715-236">これらは、指定されている場合はパラメーター値に設定され、それ以外の場合は静的なプロパティ値に設定されます。</span><span class="sxs-lookup"><span data-stu-id="1c715-236">These are set to parameter values if they are provided, or static property values if they are not.</span></span>

    [!code-xml[Main](understanding-the-project-file/samples/sample15.xml)]

<span data-ttu-id="1c715-237">**MSBuild**タスクによって**ビルド**という名前のターゲットが呼び出されることもわかります。</span><span class="sxs-lookup"><span data-stu-id="1c715-237">You can also see that the **MSBuild** task invokes a target named **Build**.</span></span> <span data-ttu-id="1c715-238">これは、Visual Studio プロジェクトファイルで広く使用されているいくつかの組み込みターゲットの1つであり、**ビルド**、**クリーン**、**リビルド**、**発行**などのカスタムプロジェクトファイルで使用できます。</span><span class="sxs-lookup"><span data-stu-id="1c715-238">This is one of several built-in targets that are widely used in Visual Studio project files and are available to you in your custom project files, like **Build**, **Clean**, **Rebuild**, and **Publish**.</span></span> <span data-ttu-id="1c715-239">ターゲットとタスクを使用してビルドプロセスを制御する方法、特に**MSBuild**タスクについては、このトピックの後半で説明します。</span><span class="sxs-lookup"><span data-stu-id="1c715-239">You'll learn more about using targets and tasks to control the build process, and about the **MSBuild** task in particular, later in this topic.</span></span>

> [!NOTE]
> <span data-ttu-id="1c715-240">ターゲットの詳細については、「 [MSBuild ターゲット](https://msdn.microsoft.com/library/ms171462.aspx)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="1c715-240">For more information on targets, see [MSBuild Targets](https://msdn.microsoft.com/library/ms171462.aspx).</span></span>

## <a name="splitting-project-files-to-support-multiple-environments"></a><span data-ttu-id="1c715-241">複数の環境をサポートするためのプロジェクトファイルの分割</span><span class="sxs-lookup"><span data-stu-id="1c715-241">Splitting Project Files to Support Multiple Environments</span></span>

<span data-ttu-id="1c715-242">テストサーバー、ステージングプラットフォーム、運用環境などの複数の環境にソリューションを配置できるようにするとします。</span><span class="sxs-lookup"><span data-stu-id="1c715-242">Suppose you want to be able to deploy a solution to multiple environments, like test servers, staging platforms, and production environments.</span></span> <span data-ttu-id="1c715-243">構成は、サーバー名や接続文字列&#x2014;などの点だけでなく、資格情報、セキュリティ設定、およびその他の多くの要因の観点からも、非常に異なる場合があります。</span><span class="sxs-lookup"><span data-stu-id="1c715-243">The configuration may vary substantially between these environments&#x2014;not just in terms of server names, connection strings, and so on, but also potentially in terms of credentials, security settings, and lots of other factors.</span></span> <span data-ttu-id="1c715-244">これを定期的に実行する必要がある場合は、ターゲット環境を切り替えるたびにプロジェクトファイル内の複数のプロパティを編集するのは現実的ではありません。</span><span class="sxs-lookup"><span data-stu-id="1c715-244">If you need to do this regularly, it's not really expedient to edit multiple properties in your project file every time you switch the target environment.</span></span> <span data-ttu-id="1c715-245">また、ビルドプロセスに提供されるプロパティ値の無限のリストを必要とする理想的なソリューションでもありません。</span><span class="sxs-lookup"><span data-stu-id="1c715-245">Nor is it an ideal solution to require an endless list of property values to be provided to the build process.</span></span>

<span data-ttu-id="1c715-246">幸いにも、別の方法があります。</span><span class="sxs-lookup"><span data-stu-id="1c715-246">Fortunately there is an alternative.</span></span> <span data-ttu-id="1c715-247">MSBuild では、ビルド構成を複数のプロジェクトファイルに分割できます。</span><span class="sxs-lookup"><span data-stu-id="1c715-247">MSBuild lets you split your build configuration across multiple project files.</span></span> <span data-ttu-id="1c715-248">このしくみを確認するために、サンプルソリューションでは、次の2つのカスタムプロジェクトファイルがあることに注意してください。</span><span class="sxs-lookup"><span data-stu-id="1c715-248">To see how this works, in the sample solution, notice that there are two custom project files:</span></span>

- <span data-ttu-id="1c715-249">*Publish. proj*には、すべての環境に共通のプロパティ、項目、およびターゲットが含まれています。</span><span class="sxs-lookup"><span data-stu-id="1c715-249">*Publish.proj*, which contains properties, items, and targets that are common to all environments.</span></span>
- <span data-ttu-id="1c715-250">*Env-* 開発環境に固有のプロパティが含まれています。</span><span class="sxs-lookup"><span data-stu-id="1c715-250">*Env-Dev.proj*, which contains properties that are specific to a developer environment.</span></span>

<span data-ttu-id="1c715-251">次に、 *Publish*ファイルに[Import](https://msdn.microsoft.com/library/92x05xfs.aspx)要素が含まれていることを確認します。これは、**プロジェクト**の開始タグのすぐ下にあります。</span><span class="sxs-lookup"><span data-stu-id="1c715-251">Now notice that the *Publish.proj* file includes an [Import](https://msdn.microsoft.com/library/92x05xfs.aspx) element, immediately beneath the opening **Project** tag.</span></span>

[!code-xml[Main](understanding-the-project-file/samples/sample16.xml)]

<span data-ttu-id="1c715-252">**Import**要素は、現在の msbuild プロジェクトファイルに別の msbuild プロジェクトファイルの内容をインポートするために使用されます。</span><span class="sxs-lookup"><span data-stu-id="1c715-252">The **Import** element is used to import the contents of another MSBuild project file into the current MSBuild project file.</span></span> <span data-ttu-id="1c715-253">この場合、 **TargetEnvPropsFile**パラメーターを使用して、インポートするプロジェクトファイルのファイル名を指定します。</span><span class="sxs-lookup"><span data-stu-id="1c715-253">In this case, the **TargetEnvPropsFile** parameter provides the filename of the project file you want to import.</span></span> <span data-ttu-id="1c715-254">MSBuild を実行するときに、このパラメーターの値を指定できます。</span><span class="sxs-lookup"><span data-stu-id="1c715-254">You can provide a value for this parameter when you run MSBuild.</span></span>

[!code-console[Main](understanding-the-project-file/samples/sample17.cmd)]

<span data-ttu-id="1c715-255">これにより、2つのファイルの内容が効率的に1つのプロジェクトファイルにマージされます。</span><span class="sxs-lookup"><span data-stu-id="1c715-255">This effectively merges the contents of the two files into a single project file.</span></span> <span data-ttu-id="1c715-256">この方法を使用すると、ユニバーサルビルド構成を含む1つのプロジェクトファイルと、環境固有のプロパティを含む複数の補助プロジェクトファイルを作成できます。</span><span class="sxs-lookup"><span data-stu-id="1c715-256">Using this approach, you can create one project file containing your universal build configuration and multiple supplementary project files containing environment-specific properties.</span></span> <span data-ttu-id="1c715-257">その結果、別のパラメーター値を指定してコマンドを実行するだけで、ソリューションを別の環境に配置できます。</span><span class="sxs-lookup"><span data-stu-id="1c715-257">As a result, simply running a command with a different parameter value lets you deploy your solution to a different environment.</span></span>

![](understanding-the-project-file/_static/image3.png)

<span data-ttu-id="1c715-258">この方法でプロジェクトファイルを分割することをお勧めします。</span><span class="sxs-lookup"><span data-stu-id="1c715-258">Splitting your project files in this way is a good practice to follow.</span></span> <span data-ttu-id="1c715-259">これにより、開発者は1つのコマンドを実行して複数の環境に配置できます。一方で、複数のプロジェクトファイル間でのユニバーサルビルドプロパティの重複を回避できます。</span><span class="sxs-lookup"><span data-stu-id="1c715-259">It allows developers to deploy to multiple environments by running a single command, while avoiding the duplication of universal build properties across multiple project files.</span></span>

> [!NOTE]
> <span data-ttu-id="1c715-260">独自のサーバー環境に合わせて環境固有のプロジェクトファイルをカスタマイズする方法については、「[ターゲット環境の配置プロパティの構成](../configuring-server-environments-for-web-deployment/configuring-deployment-properties-for-a-target-environment.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="1c715-260">For guidance on how to customize the environment-specific project files for your own server environments, see [Configuring Deployment Properties for a Target Environment](../configuring-server-environments-for-web-deployment/configuring-deployment-properties-for-a-target-environment.md).</span></span>

## <a name="conclusion"></a><span data-ttu-id="1c715-261">まとめ</span><span class="sxs-lookup"><span data-stu-id="1c715-261">Conclusion</span></span>

<span data-ttu-id="1c715-262">このトピックでは、MSBuild プロジェクトファイルの概要について説明し、独自のカスタムプロジェクトファイルを作成してビルドプロセスを制御する方法について説明しました。</span><span class="sxs-lookup"><span data-stu-id="1c715-262">This topic provided a general introduction to MSBuild project files and explained how you can create your own custom project files to control the build process.</span></span> <span data-ttu-id="1c715-263">また、プロジェクトファイルをユニバーサルビルド命令と環境固有のビルドプロパティに分割するという概念が導入されました。これにより、複数の変換先にプロジェクトを簡単にビルドして配置することができます。</span><span class="sxs-lookup"><span data-stu-id="1c715-263">It also introduced the concept of splitting project files into universal build instructions and environment-specific build properties, to make it easy to build and deploy projects to multiple destinations.</span></span>

<span data-ttu-id="1c715-264">次のトピック「[ビルドプロセスについ](understanding-the-build-process.md)て」では、プロジェクトファイルを使用してビルドと配置を制御する方法について詳しく説明しています。これは、現実的なレベルの複雑さでソリューションをデプロイする方法を説明することによって行われます。</span><span class="sxs-lookup"><span data-stu-id="1c715-264">The next topic, [Understanding the Build Process](understanding-the-build-process.md), provides more insight into how you can use project files to control build and deployment by walking you through the deployment of a solution with a realistic level of complexity.</span></span>

## <a name="further-reading"></a><span data-ttu-id="1c715-265">関連項目</span><span class="sxs-lookup"><span data-stu-id="1c715-265">Further Reading</span></span>

<span data-ttu-id="1c715-266">プロジェクトファイルと WPP の詳細については、「Microsoft Build Engine の内部」を参照してください[。: MSBuild と Team Foundation Build](http://amzn.com/0735645248) By 作成者 Iロウ Hashimi およびウィリアム Bartholomew、ISBN: 978-0-7356-4524-0。</span><span class="sxs-lookup"><span data-stu-id="1c715-266">For a more in-depth introduction to project files and the WPP, see [Inside the Microsoft Build Engine: Using MSBuild and Team Foundation Build](http://amzn.com/0735645248) by Sayed Ibrahim Hashimi and William Bartholomew, ISBN: 978-0-7356-4524-0.</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="1c715-267">[前へ](setting-up-the-contact-manager-solution.md)
> [次へ](understanding-the-build-process.md)</span><span class="sxs-lookup"><span data-stu-id="1c715-267">[Previous](setting-up-the-contact-manager-solution.md)
[Next](understanding-the-build-process.md)</span></span>

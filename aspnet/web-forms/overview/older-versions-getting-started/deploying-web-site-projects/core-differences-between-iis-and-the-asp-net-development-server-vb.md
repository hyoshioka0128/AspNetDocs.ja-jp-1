---
uid: web-forms/overview/older-versions-getting-started/deploying-web-site-projects/core-differences-between-iis-and-the-asp-net-development-server-vb
title: IIS と ASP.NET 開発サーバーの主な相違点 (VB) |Microsoft Docs
author: rick-anderson
description: ASP.NET アプリケーションをローカルでテストする場合、ASP.NET Development Web サーバーを使用している可能性があります。 ただし、実稼働 web サイトはおそらく pow...
ms.author: riande
ms.date: 04/01/2009
ms.assetid: 090e9205-52f3-4d72-ae31-44775b8b8421
msc.legacyurl: /web-forms/overview/older-versions-getting-started/deploying-web-site-projects/core-differences-between-iis-and-the-asp-net-development-server-vb
msc.type: authoredcontent
ms.openlocfilehash: 880bb403e671446a77d7eebccf578a1dc714d1f9
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 03/06/2020
ms.locfileid: "78438976"
---
# <a name="core-differences-between-iis-and-the-aspnet-development-server-vb"></a><span data-ttu-id="69f75-104">IIS と ASP.NET 開発サーバーの間の中心的違い (VB)</span><span class="sxs-lookup"><span data-stu-id="69f75-104">Core Differences Between IIS and the ASP.NET Development Server (VB)</span></span>

<span data-ttu-id="69f75-105">[Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="69f75-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="69f75-106">[コードのダウンロード](https://download.microsoft.com/download/4/5/F/45F815EC-8B0E-46D3-9FB8-2DC015CCA306/ASPNET_Hosting_Tutorial_06_VB.zip)または[PDF のダウンロード](https://download.microsoft.com/download/E/8/9/E8920AE6-D441-41A7-8A77-9EF8FF970D8B/aspnet_tutorial06_WebServerDiff_vb.pdf)</span><span class="sxs-lookup"><span data-stu-id="69f75-106">[Download Code](https://download.microsoft.com/download/4/5/F/45F815EC-8B0E-46D3-9FB8-2DC015CCA306/ASPNET_Hosting_Tutorial_06_VB.zip) or [Download PDF](https://download.microsoft.com/download/E/8/9/E8920AE6-D441-41A7-8A77-9EF8FF970D8B/aspnet_tutorial06_WebServerDiff_vb.pdf)</span></span>

> <span data-ttu-id="69f75-107">ASP.NET アプリケーションをローカルでテストする場合、ASP.NET Development Web サーバーを使用している可能性があります。</span><span class="sxs-lookup"><span data-stu-id="69f75-107">When testing an ASP.NET application locally, chances are you are using the ASP.NET Development Web Server.</span></span> <span data-ttu-id="69f75-108">ただし、運用 web サイトは、最も多くの場合、IIS を利用しています。</span><span class="sxs-lookup"><span data-stu-id="69f75-108">However, the production website is most likely powered IIS.</span></span> <span data-ttu-id="69f75-109">これらの web サーバーが要求を処理する方法にはいくつかの違いがあり、これらの違いによって重要な結果が得られる可能性があります。</span><span class="sxs-lookup"><span data-stu-id="69f75-109">There are some differences between how these web servers handle requests, and these differences can have important consequences.</span></span> <span data-ttu-id="69f75-110">このチュートリアルでは、連動のさまざまな相違点について説明します。</span><span class="sxs-lookup"><span data-stu-id="69f75-110">This tutorial explores some of the more germane differences.</span></span>

## <a name="introduction"></a><span data-ttu-id="69f75-111">はじめに</span><span class="sxs-lookup"><span data-stu-id="69f75-111">Introduction</span></span>

<span data-ttu-id="69f75-112">ユーザーが ASP.NET アプリケーションにアクセスするたびに、ブラウザーは web サイトに要求を送信します。</span><span class="sxs-lookup"><span data-stu-id="69f75-112">Whenever a user visits an ASP.NET application his browser sends a request to the website.</span></span> <span data-ttu-id="69f75-113">この要求は web サーバーソフトウェアによって取得され、要求されたリソースのコンテンツを生成して返すように ASP.NET ランタイムと連携します。</span><span class="sxs-lookup"><span data-stu-id="69f75-113">That request is picked up by the web server software, which coordinates with the ASP.NET runtime to generate and return the content for the requested resource.</span></span> <span data-ttu-id="69f75-114">[**I** n **i**は、( IIS)](http://en.wikipedia.org/wiki/Internet_Information_Services)は、Windows サーバーに共通のインターネットベースの機能を提供する一連のサービスです。</span><span class="sxs-lookup"><span data-stu-id="69f75-114">The[**I** nternet **I** nformation **S** ervices (IIS)](http://en.wikipedia.org/wiki/Internet_Information_Services) are a suite of services that provide common Internet-based functionality for Windows servers.</span></span> <span data-ttu-id="69f75-115">IIS は、運用環境で ASP.NET アプリケーションを実行するために最も一般的に使用される web サーバーです。ほとんどの場合、web ホストプロバイダーが ASP.NET アプリケーションを提供するために使用している web サーバーソフトウェアです。</span><span class="sxs-lookup"><span data-stu-id="69f75-115">IIS is the most commonly used web server for ASP.NET applications in production environments; it's most likely the web server software being used by your web host provider to serve your ASP.NET application.</span></span> <span data-ttu-id="69f75-116">Iis は、IIS をインストールして適切に構成する必要がありますが、開発環境で web サーバーソフトウェアとして使用することもできます。</span><span class="sxs-lookup"><span data-stu-id="69f75-116">IIS can also be used as the web server software in the development environment, although this entails installing IIS and properly configuring it.</span></span>

<span data-ttu-id="69f75-117">ASP.NET 開発サーバーは、開発環境用の別の web サーバーオプションです。に付属しており、Visual Studio に統合されています。</span><span class="sxs-lookup"><span data-stu-id="69f75-117">The ASP.NET Development Server is an alternative web server option for the development environment; it ships with and is integrated into Visual Studio.</span></span> <span data-ttu-id="69f75-118">IIS を使用するように web アプリケーションが構成されていない限り、Visual Studio 内から web ページに初めてアクセスしたときに、ASP.NET 開発サーバーが自動的に開始され、web サーバーとして使用されます。</span><span class="sxs-lookup"><span data-stu-id="69f75-118">Unless the web application has been configured to use IIS, the ASP.NET Development Server is automatically started and used as the web server the first time you visit a web page from within Visual Studio.</span></span> <span data-ttu-id="69f75-119">「[*配置する必要があるファイルの決定*](determining-what-files-need-to-be-deployed-vb.md)」で作成したデモ web アプリケーションは、IIS を使用するように構成されていないファイルシステムベースの web アプリケーションです。</span><span class="sxs-lookup"><span data-stu-id="69f75-119">The demo web applications we created back in the [*Determining What Files Need to Be Deployed*](determining-what-files-need-to-be-deployed-vb.md) tutorial were both file system-based web applications that were not configured to use IIS.</span></span> <span data-ttu-id="69f75-120">このため、Visual Studio 内からこれらの web サイトのいずれかを閲覧すると、ASP.NET 開発サーバーが使用されます。</span><span class="sxs-lookup"><span data-stu-id="69f75-120">Therefore, when visiting either of these websites from within Visual Studio the ASP.NET Development Server is used.</span></span>

<span data-ttu-id="69f75-121">完璧な世界では、開発環境と運用環境は同じになります。</span><span class="sxs-lookup"><span data-stu-id="69f75-121">In a perfect world the development and production environments would be identical.</span></span> <span data-ttu-id="69f75-122">ただし、前のチュートリアルで説明したように、環境に異なる構成設定があることは珍しくありません。</span><span class="sxs-lookup"><span data-stu-id="69f75-122">However, as we discussed in the preceding tutorial it is not uncommon for the environments to have differing configuration settings.</span></span> <span data-ttu-id="69f75-123">環境内で異なる web サーバーソフトウェアを使用すると、アプリケーションを展開するときに考慮する必要がある別の変数が追加されます。</span><span class="sxs-lookup"><span data-stu-id="69f75-123">Using different web server software in the environments adds another variable that must be taken into consideration when deploying an application.</span></span> <span data-ttu-id="69f75-124">このチュートリアルでは、IIS と ASP.NET 開発サーバーの主な違いについて説明します。</span><span class="sxs-lookup"><span data-stu-id="69f75-124">This tutorial covers the key differences between IIS and the ASP.NET Development Server.</span></span> <span data-ttu-id="69f75-125">これらの違いにより、開発環境で問題が発生したコードが例外をスローしたり、運用環境で実行されたときに動作が異なる場合があります。</span><span class="sxs-lookup"><span data-stu-id="69f75-125">Because of these differences there are scenarios where code that runs flawlessly in the development environment throws an exception or behaves differently when executed in production.</span></span>

## <a name="security-context-differences"></a><span data-ttu-id="69f75-126">セキュリティコンテキストの違い</span><span class="sxs-lookup"><span data-stu-id="69f75-126">Security Context Differences</span></span>

<span data-ttu-id="69f75-127">Web サーバーソフトウェアが受信要求を処理するたびに、その要求が特定のセキュリティコンテキストに関連付けられます。</span><span class="sxs-lookup"><span data-stu-id="69f75-127">Whenever the web server software handles an incoming request it associates that request with a particular security context.</span></span> <span data-ttu-id="69f75-128">このセキュリティコンテキスト情報は、要求で許容されるアクションを決定するためにオペレーティングシステムによって使用されます。</span><span class="sxs-lookup"><span data-stu-id="69f75-128">This security context information is used by the operating system to determine what actions are permissible by the request.</span></span> <span data-ttu-id="69f75-129">たとえば、ASP.NET ページには、ディスク上のファイルにメッセージを記録するコードが含まれている場合があります。</span><span class="sxs-lookup"><span data-stu-id="69f75-129">For example, an ASP.NET page might include code that logs some message to a file on disk.</span></span> <span data-ttu-id="69f75-130">この ASP.NET ページがエラーなしで実行されるようにするには、セキュリティコンテキストにファイルシステムレベルの適切なアクセス許可、つまりそのファイルに対する書き込みアクセス許可が必要です。</span><span class="sxs-lookup"><span data-stu-id="69f75-130">In order for this ASP.NET page to execute without error, the security context must have the appropriate file system-level permissions, namely write permissions on that file.</span></span>

<span data-ttu-id="69f75-131">ASP.NET 開発サーバーは、現在ログオンしているユーザーのセキュリティコンテキストに着信要求を関連付けます。</span><span class="sxs-lookup"><span data-stu-id="69f75-131">The ASP.NET Development Server associates incoming requests with the security context of the currently logged on user.</span></span> <span data-ttu-id="69f75-132">管理者としてデスクトップにログオンしている場合、ASP.NET 開発サーバーによって提供される ASP.NET ページには、管理者と同じアクセス権が与えられます。</span><span class="sxs-lookup"><span data-stu-id="69f75-132">If you are logged on to your desktop as an administrator, then the ASP.NET pages served by the ASP.NET Development Server will have the same access rights as an administrator.</span></span> <span data-ttu-id="69f75-133">ただし、IIS によって処理される ASP.NET 要求は、特定のコンピューターアカウントに関連付けられています。</span><span class="sxs-lookup"><span data-stu-id="69f75-133">However, ASP.NET requests handled by IIS are associated with a specific machine account.</span></span> <span data-ttu-id="69f75-134">既定では、ネットワークサービスコンピューターアカウントは IIS バージョン6および7によって使用されます。ただし、web ホストプロバイダーでは、顧客ごとに一意のアカウントが構成されている場合があります。</span><span class="sxs-lookup"><span data-stu-id="69f75-134">By default, the Network Service machine account is used by IIS versions 6 and 7, although your web host provider may have configured a unique account for each customer.</span></span> <span data-ttu-id="69f75-135">さらに、web ホストプロバイダーには、このコンピューターアカウントに対する制限されたアクセス許可が与えられる可能性があります。</span><span class="sxs-lookup"><span data-stu-id="69f75-135">What's more, your web host provider has likely given limited permissions to this machine account.</span></span> <span data-ttu-id="69f75-136">結果として、開発環境ではエラーなしで実行される web ページが存在する可能性がありますが、運用環境でホストされている場合は承認関連の例外が生成されます。</span><span class="sxs-lookup"><span data-stu-id="69f75-136">The net result is that you may have web pages that execute without error in the development environment, but generate authorization-related exceptions when hosted in the production environment.</span></span>

<span data-ttu-id="69f75-137">この種のエラーを表示するには、書籍のレビュー web サイトにページを作成して、最新の日時を格納するファイルをディスク上に作成します。これにより、 *ASP.NET は24時間のレビューで 3.5*が表示されます。</span><span class="sxs-lookup"><span data-stu-id="69f75-137">To show this type of error in action I've created a page in the Book Reviews website that creates a file on disk that stores the most recent date and time someone viewed the *Teach Yourself ASP.NET 3.5 in 24 Hours* review.</span></span> <span data-ttu-id="69f75-138">先に進むには、[`~/Tech/TYASP35.aspx`] ページを開き、次のコードを `Page_Load` イベントハンドラーに追加します。</span><span class="sxs-lookup"><span data-stu-id="69f75-138">To follow along, open the `~/Tech/TYASP35.aspx` page and add the following code to the `Page_Load` event handler:</span></span>

[!code-vb[Main](core-differences-between-iis-and-the-asp-net-development-server-vb/samples/sample1.vb)]

> [!NOTE]
> <span data-ttu-id="69f75-139">[`File.WriteAllText` メソッド](https://msdn.microsoft.com/library/system.io.file.writealltext.aspx)は、新しいファイルが存在しない場合は作成し、指定された内容をそのファイルに書き込みます。</span><span class="sxs-lookup"><span data-stu-id="69f75-139">The [`File.WriteAllText` method](https://msdn.microsoft.com/library/system.io.file.writealltext.aspx) creates a new file if it does not exist and then writes the specified contents to it.</span></span> <span data-ttu-id="69f75-140">ファイルが既に存在する場合は、既存の内容が上書きされます。</span><span class="sxs-lookup"><span data-stu-id="69f75-140">If the file already exists, it's existing content is overwritten.</span></span>

<span data-ttu-id="69f75-141">次に、ASP.NET 開発サーバーを使用して、開発環境の [ *ASP.NET 3.5 In the 24 Hours* book review] \ (24 時間の自己学習 \) ページにアクセスします。</span><span class="sxs-lookup"><span data-stu-id="69f75-141">Next, visit the *Teach Yourself ASP.NET 3.5 in 24 Hours* book review page in the development environment using the ASP.NET Development Server.</span></span> <span data-ttu-id="69f75-142">Web アプリケーションのルートディレクトリ内のテキストファイルを作成および変更するための適切なアクセス許可を持つアカウントを使用してコンピューターにログオンしていると仮定した場合、ブックのレビューは以前と同じように見えますが、ページに日付と時刻が表示されるたびに、ユーザーの IP アドレスが `LastTYASP35Access.txt` ファイルに格納されます。</span><span class="sxs-lookup"><span data-stu-id="69f75-142">Assuming that you are logged on to your computer with an account that has adequate permissions to create and modify a text file in the web application's root directory the book review appears the same as before, but each time the page is visited the date and time and user's IP address is stored in the `LastTYASP35Access.txt` file.</span></span> <span data-ttu-id="69f75-143">ブラウザーでこのファイルを参照します。図1に示すようなメッセージが表示されます。</span><span class="sxs-lookup"><span data-stu-id="69f75-143">Point your browser to this file; you should see a message similar to the one shown in Figure 1.</span></span>

<span data-ttu-id="69f75-144">[このテキストファイルには、ブックのレビューが最後に閲覧された日時が含まれて ![&lt;](core-differences-between-iis-and-the-asp-net-development-server-vb/_static/image2.png)](core-differences-between-iis-and-the-asp-net-development-server-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="69f75-144">[![The Text File Contains the Last Date and Time the Book Review was Visited&lt;](core-differences-between-iis-and-the-asp-net-development-server-vb/_static/image2.png)](core-differences-between-iis-and-the-asp-net-development-server-vb/_static/image1.png)</span></span>

<span data-ttu-id="69f75-145">**図 1**: このテキストファイルには、ブックのレビューが最後に閲覧された日時が含まれています ([クリックすると、フルサイズの画像が表示](core-differences-between-iis-and-the-asp-net-development-server-vb/_static/image3.png)されます)</span><span class="sxs-lookup"><span data-stu-id="69f75-145">**Figure 1**: The Text File Contains the Last Date and Time the Book Review was Visited([Click to view full-size image](core-differences-between-iis-and-the-asp-net-development-server-vb/_static/image3.png))</span></span>

<span data-ttu-id="69f75-146">Web アプリケーションを運用環境にデプロイした後、 *24 時間の*書籍のレビューページで、ホストされている ASP.NET 3.5 にアクセスします。</span><span class="sxs-lookup"><span data-stu-id="69f75-146">Deploy the web application to production and then visit the hosted *Teach Yourself ASP.NET 3.5 in 24 Hours* book review page.</span></span> <span data-ttu-id="69f75-147">この時点で、[book review] ページが通常として表示されるか、図2のようなエラーメッセージが表示されます。</span><span class="sxs-lookup"><span data-stu-id="69f75-147">At this point you should either see the book review page as normal or the error message shown in Figure 2.</span></span> <span data-ttu-id="69f75-148">一部の web ホストプロバイダーは、匿名 ASP.NET コンピューターアカウントに書き込みアクセス許可を付与します。この場合、ページはエラーなしで動作します。</span><span class="sxs-lookup"><span data-stu-id="69f75-148">Some web host providers grant write permissions to the anonymous ASP.NET machine account, in which case the page will work without error.</span></span> <span data-ttu-id="69f75-149">ただし、web ホストプロバイダーが匿名アカウントへの書き込みアクセスを禁止している場合は、`TYASP35.aspx` ページが `LastTYASP35Access.txt` ファイルに現在の日付と時刻を書き込もうとしたときに、 [`UnauthorizedAccessException` 例外](https://msdn.microsoft.com/library/system.unauthorizedaccessexception.aspx)が発生します。</span><span class="sxs-lookup"><span data-stu-id="69f75-149">If, however, your web host provider prohibits write access for the anonymous account then an [`UnauthorizedAccessException` exception](https://msdn.microsoft.com/library/system.unauthorizedaccessexception.aspx) is raised when the `TYASP35.aspx` page attempts to write the current date and time to the `LastTYASP35Access.txt` file.</span></span>

<span data-ttu-id="69f75-150">[IIS によって使用される既定のコンピューターアカウントに、ファイルシステムへの書き込みアクセス許可がない ![](core-differences-between-iis-and-the-asp-net-development-server-vb/_static/image5.png)](core-differences-between-iis-and-the-asp-net-development-server-vb/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="69f75-150">[![The Default Machine Account Used by IIS Does Not Have Permissions to Write to the File System](core-differences-between-iis-and-the-asp-net-development-server-vb/_static/image5.png)](core-differences-between-iis-and-the-asp-net-development-server-vb/_static/image4.png)</span></span>

<span data-ttu-id="69f75-151">**図 2**: IIS で使用される既定のコンピューターアカウントに、ファイルシステムへの書き込みアクセス許可がない ([クリックしてフルサイズのイメージを表示する](core-differences-between-iis-and-the-asp-net-development-server-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="69f75-151">**Figure 2**: The Default Machine Account Used by IIS Does Not Have Permissions to Write to the File System ([Click to view full-size image](core-differences-between-iis-and-the-asp-net-development-server-vb/_static/image6.png))</span></span>

<span data-ttu-id="69f75-152">ほとんどの web ホストプロバイダーには、web サイトでファイルシステムのアクセス許可を指定できるようにするアクセス許可ツールがいくつか用意されています。</span><span class="sxs-lookup"><span data-stu-id="69f75-152">The good news is that most web host providers have some sort of permissions tool that allows you to specify file system permissions in your website.</span></span> <span data-ttu-id="69f75-153">ルートディレクトリへの書き込みアクセス権を匿名 ASP.NET アカウントに付与してから、[book review] ページに戻ります。</span><span class="sxs-lookup"><span data-stu-id="69f75-153">Grant the anonymous ASP.NET account write access to the root directory and then revisit the book review page.</span></span> <span data-ttu-id="69f75-154">(必要に応じて、既定の ASP.NET アカウントに書き込みアクセス許可を付与する方法については、web ホストプロバイダーに問い合わせてください。)今回は、ページがエラーなしで読み込まれ、`LastTYASP35Access.txt` ファイルが正常に作成されます。</span><span class="sxs-lookup"><span data-stu-id="69f75-154">(If needed, contact your web host provider for assistance on how to grant write permissions to the default ASP.NET account.) This time the page should load without error and the `LastTYASP35Access.txt` file should be created successfully.</span></span>

<span data-ttu-id="69f75-155">ここでは、ASP.NET 開発サーバーが IIS とは異なるセキュリティコンテキストで動作するため、ファイルシステムに対して読み取りまたは書き込みを行う ASP.NET ページ、Windows イベントログの読み取りまたは書き込み、または Windows への読み取りまたは書き込みを行うことができます。 レジストリは開発時に予想どおりに機能しますが、運用時には例外を生成します。</span><span class="sxs-lookup"><span data-stu-id="69f75-155">The take away here is that because the ASP.NET Development Server operates under a different security context than IIS, it is possible that your ASP.NET pages that read or write to the file system, read from or write to the Windows Event Log, or read or write to the Windows registry will work as expected on development but generate exceptions when on production.</span></span> <span data-ttu-id="69f75-156">共有 web ホスティング環境に配置される web アプリケーションを構築する場合は、イベントログまたは Windows レジストリに対して読み取りまたは書き込みを行わないでください。</span><span class="sxs-lookup"><span data-stu-id="69f75-156">When building a web application that will be deployed to a shared web hosting environment, do not read or write to the Event Log or the Windows registry.</span></span> <span data-ttu-id="69f75-157">また、運用環境の適切なフォルダーに対する読み取り権限と書き込み権限を付与する必要がある場合があるため、ファイルシステムに対して読み取りまたは書き込みを行うすべての ASP.NET ページをメモしておきます。</span><span class="sxs-lookup"><span data-stu-id="69f75-157">Also take note of any ASP.NET pages that read from or write to the file system as you may need to grant read and write privileges on the appropriate folders in the production environment.</span></span>

## <a name="differences-on-serving-static-content"></a><span data-ttu-id="69f75-158">静的コンテンツの提供に関する相違点</span><span class="sxs-lookup"><span data-stu-id="69f75-158">Differences On Serving Static Content</span></span>

<span data-ttu-id="69f75-159">IIS と ASP.NET 開発サーバーにおけるもう1つの重要な違いは、静的コンテンツの要求を処理する方法です。</span><span class="sxs-lookup"><span data-stu-id="69f75-159">Another core difference between IIS and the ASP.NET Development Server is how they handle requests for static content.</span></span> <span data-ttu-id="69f75-160">ASP.NET 開発サーバーに含まれるすべての要求は、ASP.NET ページ、イメージ、または JavaScript ファイルのいずれであるかにかかわらず、ASP.NET ランタイムによって処理されます。</span><span class="sxs-lookup"><span data-stu-id="69f75-160">Every request that comes into the ASP.NET Development Server, whether for an ASP.NET page, an image, or a JavaScript file, is processed by the ASP.NET runtime.</span></span> <span data-ttu-id="69f75-161">既定では、ASP.NET リソース (ASP.NET web ページ、Web サービスなど) に対して要求が送られた場合にのみ、IIS は ASP.NET ランタイムを呼び出します。</span><span class="sxs-lookup"><span data-stu-id="69f75-161">By default, IIS only invokes the ASP.NET runtime when a request comes in for an ASP.NET resource, such as an ASP.NET web page, a Web Service, and so forth.</span></span> <span data-ttu-id="69f75-162">静的コンテンツ (画像、CSS ファイル、JavaScript ファイル、PDF ファイル、ZIP ファイルなど) の要求は、ASP.NET ランタイムを介さずに IIS によって取得されます。</span><span class="sxs-lookup"><span data-stu-id="69f75-162">Requests for static content - images, CSS files, JavaScript files, PDF files, ZIP files, and the like - are retrieved by IIS without the involvement of the ASP.NET runtime.</span></span> <span data-ttu-id="69f75-163">(静的コンテンツを提供する場合は、ASP.NET ランタイムで動作するように IIS に指示することができます。詳細については、このチュートリアルの「IIS 7 を使用した静的ファイルでのフォームベース認証と URL 認証の実行」を参照してください)。</span><span class="sxs-lookup"><span data-stu-id="69f75-163">(It is possible to instruct IIS to work with the ASP.NET runtime when serving static content; consult the "Performing Forms-Based Authentication and URL Authentication on Static Files with IIS 7" section in this tutorial for more information.)</span></span>

<span data-ttu-id="69f75-164">ASP.NET ランタイムは、要求されたコンテンツを生成するためのいくつかの手順を実行します。これには、認証 (要求元の識別) と承認 (要求されたコンテンツを表示するアクセス許可が要求元にあるかどうかの確認) が含まれます。</span><span class="sxs-lookup"><span data-stu-id="69f75-164">The ASP.NET runtime performs a number of steps to generate the requested content, including authentication (identifying the requestor) and authorization (determining if the requestor has permission to view the requested content).</span></span> <span data-ttu-id="69f75-165">一般的な形式の認証は、*フォームベースの認証*です。この認証では、資格情報を入力してユーザーを識別します。通常は、web ページ上のテキストボックスにユーザー名とパスワードを入力します。</span><span class="sxs-lookup"><span data-stu-id="69f75-165">A popular form of authentication is *forms-based authentication*, in which a user is identified by entering their credentials - usually a username and password - into textboxes on a web page.</span></span> <span data-ttu-id="69f75-166">資格情報を検証すると、web サイトはユーザーのブラウザーに*認証チケット*cookie を保存します。これは、web サイトへの後続のすべての要求と共に送信され、ユーザーの認証に使用されます。</span><span class="sxs-lookup"><span data-stu-id="69f75-166">Upon validating their credentials, the website stores an *authentication ticket* cookie on the user's browser, which is sent with every subsequent request to the website and is what is used to authenticate the user.</span></span> <span data-ttu-id="69f75-167">さらに、ユーザーが特定のフォルダーにアクセスできるかどうかを指定する*URL 承認*規則を指定することもできます。</span><span class="sxs-lookup"><span data-stu-id="69f75-167">Moreover, it is possible to specify *URL authorization* rules that dictate what users can or cannot access a particular folder.</span></span> <span data-ttu-id="69f75-168">多くの ASP.NET websites は、フォームベースの認証と URL 承認を使用してユーザーアカウントをサポートし、特定のロールに属している認証済みのユーザーまたはユーザーのみがアクセスできるサイトの一部を定義します。</span><span class="sxs-lookup"><span data-stu-id="69f75-168">Many ASP.NET websites use forms-based authentication and URL authorization to support user accounts and to define portions of the site that are only accessible to authenticated users or users that belong to a certain role.</span></span>

> [!NOTE]
> <span data-ttu-id="69f75-169">ASP の詳細な調査を行う場合。ネットワークのフォームベース認証、URL 認証、およびその他のユーザーアカウント関連機能については、「 [Web サイトのセキュリティ](../../older-versions-security/introduction/security-basics-and-asp-net-support-cs.md)に関するチュートリアル」をご覧ください。</span><span class="sxs-lookup"><span data-stu-id="69f75-169">For a thorough examination of ASP.NET's forms-based authentication, URL authorization, and other user account-related features, be sure to check out my [Website Security Tutorials](../../older-versions-security/introduction/security-basics-and-asp-net-support-cs.md).</span></span>

<span data-ttu-id="69f75-170">フォームベースの承認を使用するユーザーアカウントをサポートする web サイトがあり、URL 承認を使用するフォルダーがあり、認証されたユーザーのみを許可するように構成されているとします。</span><span class="sxs-lookup"><span data-stu-id="69f75-170">Consider a website that supports user accounts using forms-based authorization and has a folder that, using URL authorization, is configured to only allow authenticated users.</span></span> <span data-ttu-id="69f75-171">このフォルダーには、ASP.NET ページと PDF ファイルが含まれており、認証されたユーザーのみがこれらの PDF ファイルを表示できることを意図しています。</span><span class="sxs-lookup"><span data-stu-id="69f75-171">Imagine that this folder contains ASP.NET pages and PDF files and that the intent is that only authenticated users can view these PDF files.</span></span>

<span data-ttu-id="69f75-172">ビジターがブラウザーのアドレスバーに直接 URL を入力して、これらの PDF ファイルの1つを表示しようとするとどうなりますか。</span><span class="sxs-lookup"><span data-stu-id="69f75-172">What happens if a visitor attempts to view one of these PDF files by entering the URL directly in his browser's Address bar?</span></span> <span data-ttu-id="69f75-173">まず、書籍のレビューサイトに新しいフォルダーを作成して PDF ファイルを追加し、匿名ユーザーがこのフォルダーにアクセスできないように URL 認証を使用するようにサイトを構成します。</span><span class="sxs-lookup"><span data-stu-id="69f75-173">To find out, let's create a new folder in the Book Reviews site, add some PDF files, and configure the site to use URL authorization to prohibit anonymous users from visiting this folder.</span></span> <span data-ttu-id="69f75-174">デモアプリケーションをダウンロードすると、`PrivateDocs` という名前のフォルダーが作成され、 [Web サイトのセキュリティチュートリアル](../../older-versions-security/introduction/security-basics-and-asp-net-support-cs.md)(「方法」) から PDF が追加されたことがわかります。</span><span class="sxs-lookup"><span data-stu-id="69f75-174">If you download the demo application you'll see that I created a folder called `PrivateDocs` and added a PDF from my [Website Security Tutorials](../../older-versions-security/introduction/security-basics-and-asp-net-support-cs.md) (how fitting!).</span></span> <span data-ttu-id="69f75-175">`PrivateDocs` フォルダーには、匿名ユーザーを拒否する URL 承認規則を指定する `Web.config` ファイルも含まれています。</span><span class="sxs-lookup"><span data-stu-id="69f75-175">The `PrivateDocs` folder also contains a `Web.config` file that specifies the URL authorization rules to deny anonymous users:</span></span>

[!code-xml[Main](core-differences-between-iis-and-the-asp-net-development-server-vb/samples/sample2.xml)]

<span data-ttu-id="69f75-176">最後に、ルートディレクトリの web.config ファイルを更新することによって、フォームベースの認証を使用するように web アプリケーションを構成しました。これは、次のように置き換えます。</span><span class="sxs-lookup"><span data-stu-id="69f75-176">Finally, I configured the web application to use forms-based authentication by updating the Web.config file in the root directory, replacing:</span></span>

[!code-xml[Main](core-differences-between-iis-and-the-asp-net-development-server-vb/samples/sample3.xml)]

<span data-ttu-id="69f75-177">置換後のコード:</span><span class="sxs-lookup"><span data-stu-id="69f75-177">With:</span></span>

[!code-xml[Main](core-differences-between-iis-and-the-asp-net-development-server-vb/samples/sample4.xml)]

<span data-ttu-id="69f75-178">ASP.NET 開発サーバーを使用して、サイトにアクセスし、ブラウザーのアドレスバーにある PDF ファイルの1つに直接 URL を入力します。</span><span class="sxs-lookup"><span data-stu-id="69f75-178">Using the ASP.NET Development Server, visit the site and enter the direct URL to one of the PDF files in your browser's Address bar.</span></span> <span data-ttu-id="69f75-179">このチュートリアルに関連付けられている web サイトをダウンロードした場合、URL は次のようになります: `http://localhost:portNumber/PrivateDocs/aspnet_tutorial01_Basics_vb.pdf`</span><span class="sxs-lookup"><span data-stu-id="69f75-179">If you downloaded the website associated with this tutorial the URL should look something like: `http://localhost:portNumber/PrivateDocs/aspnet_tutorial01_Basics_vb.pdf`</span></span>

<span data-ttu-id="69f75-180">この URL をアドレスバーに入力すると、ブラウザーはファイルの ASP.NET 開発サーバーに要求を送信します。</span><span class="sxs-lookup"><span data-stu-id="69f75-180">Entering this URL into the Address bar causes the browser to send a request to the ASP.NET Development Server for the file.</span></span> <span data-ttu-id="69f75-181">ASP.NET 開発サーバーは、ASP.NET ランタイムに要求を渡して処理を行います。</span><span class="sxs-lookup"><span data-stu-id="69f75-181">The ASP.NET Development Server hands off the request to the ASP.NET runtime for processing.</span></span> <span data-ttu-id="69f75-182">まだログインしていないため、`PrivateDocs` フォルダー内の `Web.config` は匿名アクセスを拒否するように構成されているため、ASP.NET ランタイムはログイン `Login.aspx` ページに自動的にリダイレクトします (図3を参照)。</span><span class="sxs-lookup"><span data-stu-id="69f75-182">Because we have not yet logged in, and because the `Web.config` in the `PrivateDocs` folder is configured to deny anonymous access, the ASP.NET runtime automatically redirects us to the login page, `Login.aspx` (see Figure 3).</span></span> <span data-ttu-id="69f75-183">ユーザーをログインページにリダイレクトする場合、ASP.NET には、ユーザーが表示しようとしていたページを示す `ReturnUrl` querystring パラメーターが含まれています。</span><span class="sxs-lookup"><span data-stu-id="69f75-183">When redirecting the user to the log in page, ASP.NET includes a `ReturnUrl` querystring parameter that indicates the page the user was attempting to view.</span></span> <span data-ttu-id="69f75-184">正常にログインした後、ユーザーはこのページに戻ることができます。</span><span class="sxs-lookup"><span data-stu-id="69f75-184">After successfully logging in the user can be returned to this page.</span></span>

<span data-ttu-id="69f75-185">[承認されていないユーザーがログインページに自動的にリダイレクト ![](core-differences-between-iis-and-the-asp-net-development-server-vb/_static/image8.png)](core-differences-between-iis-and-the-asp-net-development-server-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="69f75-185">[![Unauthorized Users are Automatically Redirected to the Login Page](core-differences-between-iis-and-the-asp-net-development-server-vb/_static/image8.png)](core-differences-between-iis-and-the-asp-net-development-server-vb/_static/image7.png)</span></span>

<span data-ttu-id="69f75-186">**図 3**: 許可されていないユーザーがログインページに自動的にリダイレクトされる ([クリックしてフルサイズの画像を表示する](core-differences-between-iis-and-the-asp-net-development-server-vb/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="69f75-186">**Figure 3**: Unauthorized Users are Automatically Redirected to the Login Page ([Click to view full-size image](core-differences-between-iis-and-the-asp-net-development-server-vb/_static/image9.png))</span></span>

<span data-ttu-id="69f75-187">次に、この動作が運用環境でどのように動作するかを見てみましょう。</span><span class="sxs-lookup"><span data-stu-id="69f75-187">Now let's see how this behaves on production.</span></span> <span data-ttu-id="69f75-188">アプリケーションをデプロイし、運用環境の `PrivateDocs` フォルダー内のいずれかの Pdf に直接 URL を入力します。</span><span class="sxs-lookup"><span data-stu-id="69f75-188">Deploy your application and enter the direct URL to one of the PDFs in the `PrivateDocs` folder in production.</span></span> <span data-ttu-id="69f75-189">これにより、ブラウザーでファイルの要求 IIS を送信するように求められます。</span><span class="sxs-lookup"><span data-stu-id="69f75-189">This prompts your browser to send a request IIS for the file.</span></span> <span data-ttu-id="69f75-190">静的ファイルが要求されるため、IIS は ASP.NET ランタイムを呼び出さずにファイルを取得して返します。</span><span class="sxs-lookup"><span data-stu-id="69f75-190">Because a static file is requested, IIS retrieves and returns the file without invoking the ASP.NET runtime.</span></span> <span data-ttu-id="69f75-191">その結果、URL 承認チェックは実行されませんでした。このプライベート PDF の内容は、ファイルへの直接 URL を知っているすべてのユーザーがアクセスできます。</span><span class="sxs-lookup"><span data-stu-id="69f75-191">As a result, there was no URL authorization check performed; the contents of the supposedly private PDF are accessible to anyone who knows the direct URL to the file.</span></span>

<span data-ttu-id="69f75-192">[匿名ユーザーは、ファイルへの直接 URL を入力することによって、プライベート PDF ファイルをダウンロード ![ます。](core-differences-between-iis-and-the-asp-net-development-server-vb/_static/image11.png)](core-differences-between-iis-and-the-asp-net-development-server-vb/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="69f75-192">[![Anonymous Users Can Download the Private PDF Files By Entering the Direct URL to the File](core-differences-between-iis-and-the-asp-net-development-server-vb/_static/image11.png)](core-differences-between-iis-and-the-asp-net-development-server-vb/_static/image10.png)</span></span>

<span data-ttu-id="69f75-193">**図 4**: 匿名ユーザーは、ファイルへの直接 URL を入力してプライベート PDF ファイルをダウンロードできます ([クリックすると、フルサイズの画像が表示](core-differences-between-iis-and-the-asp-net-development-server-vb/_static/image12.png)されます)。</span><span class="sxs-lookup"><span data-stu-id="69f75-193">**Figure 4**: Anonymous Users Can Download the Private PDF Files By Entering the Direct URL to the File ([Click to view full-size image](core-differences-between-iis-and-the-asp-net-development-server-vb/_static/image12.png))</span></span>

### <a name="performing-forms-based-authentication-and-url-authentication-on-static-files-with-iis-7"></a><span data-ttu-id="69f75-194">IIS 7 を使用した静的ファイルでのフォームベース認証と URL 認証の実行</span><span class="sxs-lookup"><span data-stu-id="69f75-194">Performing Forms-Based Authentication and URL Authentication on Static Files with IIS 7</span></span>

<span data-ttu-id="69f75-195">承認されていないユーザーから静的コンテンツを保護するには、いくつかの手法を使用できます。</span><span class="sxs-lookup"><span data-stu-id="69f75-195">There are a couple of techniques you can use to protect static content from unauthorized users.</span></span> <span data-ttu-id="69f75-196">IIS 7 では、統合された*パイプライン*が導入されました。これにより、iis のワークフローが ASP.NET ランタイムのワークフローと共に使用されます。</span><span class="sxs-lookup"><span data-stu-id="69f75-196">IIS 7 introduced the *integrated pipeline*, which marries IIS's workflow with the ASP.NET runtime's workflow.</span></span> <span data-ttu-id="69f75-197">簡単に言うと、ASP.NET ランタイムの認証および承認モジュールがすべての受信要求 (PDF ファイルなどの静的コンテンツを含む) を呼び出すように IIS に指示できます。</span><span class="sxs-lookup"><span data-stu-id="69f75-197">In a nutshell, you can instruct IIS to invoke the ASP.NET runtime's authentication and authorization modules all incoming requests (including static content like PDF files).</span></span> <span data-ttu-id="69f75-198">Web ホストプロバイダーに問い合わせて、統合パイプラインを使用するように web サイトを構成する方法を確認してください。</span><span class="sxs-lookup"><span data-stu-id="69f75-198">Contact your web host provider to find out how to configure your website to use the integrated pipeline.</span></span>

<span data-ttu-id="69f75-199">統合パイプラインを使用するように IIS を構成したら、次のマークアップをルートディレクトリの `Web.config` ファイルに追加します。</span><span class="sxs-lookup"><span data-stu-id="69f75-199">Once IIS has been configured to use the integrated pipeline add the following markup to the `Web.config` file in the root directory:</span></span>

[!code-xml[Main](core-differences-between-iis-and-the-asp-net-development-server-vb/samples/sample5.xml)]

<span data-ttu-id="69f75-200">このマークアップは、ASP.NET ベースの認証および承認モジュールを使用するように IIS 7 に指示します。</span><span class="sxs-lookup"><span data-stu-id="69f75-200">This markup instructs IIS 7 to use the ASP.NET-based authentication and authorization modules.</span></span> <span data-ttu-id="69f75-201">アプリケーションを再配置し、PDF ファイルに再度アクセスします。</span><span class="sxs-lookup"><span data-stu-id="69f75-201">Re-deploy your application and then re-visit the PDF file.</span></span> <span data-ttu-id="69f75-202">このとき、IIS が要求を処理するときに、ASP.NET ランタイムの認証と承認ロジックに要求を検査する機会が与えられます。</span><span class="sxs-lookup"><span data-stu-id="69f75-202">This time when IIS handles the request it gives the ASP.NET runtime's authentication and authorization logic an opportunity to inspect the request.</span></span> <span data-ttu-id="69f75-203">認証されたユーザーのみが `PrivateDocs` フォルダーの内容を表示する権限を持っているため、匿名ビジターは自動的にログインページにリダイレクトされます (図3を参照)。</span><span class="sxs-lookup"><span data-stu-id="69f75-203">Because only authenticated users are authorized to view the contents in the `PrivateDocs` folder, the anonymous visitor is automatically redirected to the login page (refer back to Figure 3).</span></span>

> [!NOTE]
> <span data-ttu-id="69f75-204">Web ホストプロバイダーがまだ IIS 6 を使用している場合は、統合パイプライン機能を使用できません。</span><span class="sxs-lookup"><span data-stu-id="69f75-204">If your web host provider is still using IIS 6 then you cannot use the integrated pipeline feature.</span></span> <span data-ttu-id="69f75-205">回避策の1つは、HTTP アクセスを禁止するフォルダー (`App_Data`など) にプライベートドキュメントを配置し、これらのドキュメントを提供するページを作成することです。</span><span class="sxs-lookup"><span data-stu-id="69f75-205">One workaround is to put your private documents in a folder that prohibits HTTP access (such as `App_Data`) and then create a page to serve these documents.</span></span> <span data-ttu-id="69f75-206">このページは `GetPDF.aspx`と呼ばれる場合があります。また、クエリ文字列パラメーターを使用して PDF の名前が渡されます。</span><span class="sxs-lookup"><span data-stu-id="69f75-206">This page might be called `GetPDF.aspx`, and is passed the name of the PDF through a querystring parameter.</span></span> <span data-ttu-id="69f75-207">`GetPDF.aspx` のページでは、まず、ユーザーがファイルを表示するアクセス許可を持っていることを確認し、存在する場合は、 [`Response.WriteFile(filePath)`](https://msdn.microsoft.com/library/system.web.httpresponse.writefile.aspx)メソッドを使用して、要求された PDF ファイルの内容を要求元のクライアントに送り返します。</span><span class="sxs-lookup"><span data-stu-id="69f75-207">The `GetPDF.aspx` page would first verify that the user has permission to view the file and, if so, would use the [`Response.WriteFile(filePath)`](https://msdn.microsoft.com/library/system.web.httpresponse.writefile.aspx) method to send the contents of the requested PDF file back to the requesting client.</span></span> <span data-ttu-id="69f75-208">この手法は、統合パイプラインを有効にしたくない場合に、IIS 7 でも機能します。</span><span class="sxs-lookup"><span data-stu-id="69f75-208">This technique would also work for IIS 7 if you did not wish to enable the integrated pipeline.</span></span>

## <a name="summary"></a><span data-ttu-id="69f75-209">まとめ</span><span class="sxs-lookup"><span data-stu-id="69f75-209">Summary</span></span>

<span data-ttu-id="69f75-210">運用環境の web アプリケーションは、Microsoft の IIS web サーバーソフトウェアを使用してホストされます。</span><span class="sxs-lookup"><span data-stu-id="69f75-210">Web applications in a production environment are hosted using Microsoft's IIS web server software.</span></span> <span data-ttu-id="69f75-211">ただし、開発環境では、アプリケーションは IIS または ASP.NET 開発サーバーを使用してホストされる場合があります。</span><span class="sxs-lookup"><span data-stu-id="69f75-211">In the development environment, however, the application may be hosted using IIS or the ASP.NET Development Server.</span></span> <span data-ttu-id="69f75-212">異なるソフトウェアを使用すると、混合に別の変数が追加されるため、同じ web サーバーソフトウェアを両方の環境で使用するのが理想的です。</span><span class="sxs-lookup"><span data-stu-id="69f75-212">Ideally, the same web server software should be used in both environments because using different software adds another variable in the mix.</span></span> <span data-ttu-id="69f75-213">ただし、ASP.NET 開発サーバーを使いやすくすることで、開発環境での選択が魅力的になります。</span><span class="sxs-lookup"><span data-stu-id="69f75-213">However, the ease of use of the ASP.NET Development Server makes it an attractive choice in the development environment.</span></span> <span data-ttu-id="69f75-214">IIS と ASP.NET 開発サーバーにはいくつかの基本的な違いがありますが、これらの違いを認識している場合は、アプリケーションの動作と機能に関係なく同じ方法で動作し、機能するようにするための対策を講じることができます。environment.</span><span class="sxs-lookup"><span data-stu-id="69f75-214">The good news is that there are only a few fundamental differences between IIS and the ASP.NET Development Server, and if you are aware of these differences you can take steps to help ensure that the application works and functions the same way regardless of the environment.</span></span>

<span data-ttu-id="69f75-215">プログラミングを楽しんでください。</span><span class="sxs-lookup"><span data-stu-id="69f75-215">Happy Programming!</span></span>

### <a name="further-reading"></a><span data-ttu-id="69f75-216">参考資料</span><span class="sxs-lookup"><span data-stu-id="69f75-216">Further Reading</span></span>

<span data-ttu-id="69f75-217">このチュートリアルで説明しているトピックの詳細については、次のリソースを参照してください。</span><span class="sxs-lookup"><span data-stu-id="69f75-217">For more information on the topics discussed in this tutorial, refer to the following resources:</span></span>

- [<span data-ttu-id="69f75-218">ASP.NET と IIS 7.0 の統合</span><span class="sxs-lookup"><span data-stu-id="69f75-218">ASP.NET Integration with IIS 7.0</span></span>](https://www.iis.net/learn/application-frameworks/building-and-running-aspnet-applications/aspnet-integration-with-iis)
- <span data-ttu-id="69f75-219">[IIS 7 のすべての種類のコンテンツで ASP.NET フォーラム認証を使用する](https://blogs.iis.net/bills/archive/2007/05/19/using-asp-net-forms-authentication-with-all-types-of-content-with-iis7-video.aspx)(ビデオ)</span><span class="sxs-lookup"><span data-stu-id="69f75-219">[Using ASP.NET Forums Authentication With All Types of Content on IIS 7](https://blogs.iis.net/bills/archive/2007/05/19/using-asp-net-forms-authentication-with-all-types-of-content-with-iis7-video.aspx) (Video)</span></span>
- [<span data-ttu-id="69f75-220">Visual Web Developer の web サーバー</span><span class="sxs-lookup"><span data-stu-id="69f75-220">Web Servers in Visual Web Developer</span></span>](https://msdn.microsoft.com/library/58wxa9w5.aspx)

> [!div class="step-by-step"]
> <span data-ttu-id="69f75-221">[前へ](common-configuration-differences-between-development-and-production-vb.md)
> [次へ](deploying-a-database-vb.md)</span><span class="sxs-lookup"><span data-stu-id="69f75-221">[Previous](common-configuration-differences-between-development-and-production-vb.md)
[Next](deploying-a-database-vb.md)</span></span>

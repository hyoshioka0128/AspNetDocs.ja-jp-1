---
uid: web-forms/overview/older-versions-getting-started/deploying-web-site-projects/precompiling-your-website-cs
title: Web サイトをプリコンC#パイルする () |Microsoft Docs
author: rick-anderson
description: Visual Studio には、Web アプリケーションプロジェクト (Wap) と Web サイトプロジェクト (WSPs) という2種類のプロジェクトが用意されています。 ASP.NET の開発者です。 重要な違いの1つは...
ms.author: riande
ms.date: 06/09/2009
ms.assetid: ecd5a4de-beb7-4d1d-bbbb-e31003633267
msc.legacyurl: /web-forms/overview/older-versions-getting-started/deploying-web-site-projects/precompiling-your-website-cs
msc.type: authoredcontent
ms.openlocfilehash: cb42398f44f3cd16ab83a9976e7b34f132384456
ms.sourcegitcommit: 22fbd8863672c4ad6693b8388ad5c8e753fb41a2
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 11/28/2019
ms.locfileid: "74635827"
---
# <a name="precompiling-your-website-c"></a><span data-ttu-id="b91ab-104">Web サイトを事前コンパイルする (C#)</span><span class="sxs-lookup"><span data-stu-id="b91ab-104">Precompiling Your Website (C#)</span></span>

<span data-ttu-id="b91ab-105">[Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="b91ab-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="b91ab-106">[コードのダウンロード](https://download.microsoft.com/download/1/0/C/10CC829F-A808-4302-97D3-59989B8F9C01/ASPNET_Hosting_Tutorial_15_CS.zip)または[PDF のダウンロード](https://download.microsoft.com/download/5/C/5/5C57DB8C-5DEA-4B3A-92CA-4405544D313B/aspnet_tutorial15_Precompiling_cs.pdf)</span><span class="sxs-lookup"><span data-stu-id="b91ab-106">[Download Code](https://download.microsoft.com/download/1/0/C/10CC829F-A808-4302-97D3-59989B8F9C01/ASPNET_Hosting_Tutorial_15_CS.zip) or [Download PDF](https://download.microsoft.com/download/5/C/5/5C57DB8C-5DEA-4B3A-92CA-4405544D313B/aspnet_tutorial15_Precompiling_cs.pdf)</span></span>

> <span data-ttu-id="b91ab-107">Visual Studio には、Web アプリケーションプロジェクト (Wap) と Web サイトプロジェクト (WSPs) という2種類のプロジェクトが用意されています。 ASP.NET の開発者です。</span><span class="sxs-lookup"><span data-stu-id="b91ab-107">Visual Studio offers ASP.NET developers two types of projects: Web Application Projects (WAPs) and Web Site Projects (WSPs).</span></span> <span data-ttu-id="b91ab-108">2つのプロジェクトの種類の主な違いの1つは、Wap ではデプロイの前にコードを明示的にコンパイルする必要があるのに対し、WSP のコードは web サーバーで自動的にコンパイルできることです。</span><span class="sxs-lookup"><span data-stu-id="b91ab-108">One of the key differences between the two project types is that WAPs must have the code explicitly compiled prior to deployment whereas the code in a WSP can be automatically compiled on the web server.</span></span> <span data-ttu-id="b91ab-109">ただし、デプロイの前に WSP をプリコンパイルすることは可能です。</span><span class="sxs-lookup"><span data-stu-id="b91ab-109">However, it is possible to precompile a WSP prior to deployment.</span></span> <span data-ttu-id="b91ab-110">このチュートリアルでは、プリコンパイルの利点について説明し、Visual Studio 内およびコマンドラインから web サイトをプリコンパイルする方法を示します。</span><span class="sxs-lookup"><span data-stu-id="b91ab-110">This tutorial explores the benefits of precompilation and shows how to precompile a website from within Visual Studio and from the command line.</span></span>

## <a name="introduction"></a><span data-ttu-id="b91ab-111">はじめに</span><span class="sxs-lookup"><span data-stu-id="b91ab-111">Introduction</span></span>

<span data-ttu-id="b91ab-112">Visual Studio には、Web アプリケーションプロジェクト (WAP) と Web サイトプロジェクト (WSP) という2種類のプロジェクトの開発者向けの ASP.NET が用意されています。</span><span class="sxs-lookup"><span data-stu-id="b91ab-112">Visual Studio offers ASP.NET developers two different project types: Web Application Projects (WAP) and Web Site Projects (WSP).</span></span> <span data-ttu-id="b91ab-113">これらのプロジェクトの種類の主な違いの1つは、Wap では*明示的なコンパイル*が必要であるのに対し、wsps は*自動コンパイル*を既定で使用することです。</span><span class="sxs-lookup"><span data-stu-id="b91ab-113">One of the key differences between these project types is that WAPs require *explicit compilation* whereas WSPs use *automatic compilation*, by default.</span></span> <span data-ttu-id="b91ab-114">Wap では、web アプリケーションのコードを1つのアセンブリにコンパイルします。このアセンブリは、web サイトの `Bin` フォルダーに作成されます。</span><span class="sxs-lookup"><span data-stu-id="b91ab-114">With WAPs, you compile the web application's code into a single assembly, which is created in the website's `Bin` folder.</span></span> <span data-ttu-id="b91ab-115">配置では、プロジェクト内のマークアップコンテンツ (`.aspx.ascx`、`.master` ファイル) を `Bin` フォルダー内のアセンブリと共にコピーすることがあります。分離コードクラスファイル自体を配置する必要はありません。</span><span class="sxs-lookup"><span data-stu-id="b91ab-115">Deployment entails copying the markup content (the `.aspx.ascx`, and `.master` files) in the project, along with the assembly in the `Bin` folder; the code-behind class files themselves do not need to be deployed.</span></span> <span data-ttu-id="b91ab-116">一方、マークアップページとそれに対応する分離コードクラスの両方を運用環境にコピーすることによって、WSPs をデプロイします。</span><span class="sxs-lookup"><span data-stu-id="b91ab-116">On the other hand, you deploy WSPs by copying both the markup pages and their corresponding code-behind classes to the production environment.</span></span> <span data-ttu-id="b91ab-117">分離コードクラスは、web サーバー上で要求時にコンパイルされます。</span><span class="sxs-lookup"><span data-stu-id="b91ab-117">The code-behind classes are compiled on demand on the web server.</span></span>

> [!NOTE]
> <span data-ttu-id="b91ab-118">プロジェクトモデルの相違点、明示的なコンパイルと自動コンパイル、およびコンパイルモデルが配置に与える影響の詳細については、「 [*配置する必要があるファイルの決定*](determining-what-files-need-to-be-deployed-cs.md) 」の「明示的なコンパイルと自動コンパイル」セクションを参照してください。</span><span class="sxs-lookup"><span data-stu-id="b91ab-118">Refer back to the "Explicit Compilation Versus Automatic Compilation" section in the [*Determining What Files Need to Be Deployed* tutorial](determining-what-files-need-to-be-deployed-cs.md) for more background on the differences between the project models, explicit and automatic compilation, and how the compilation model affects deployment.</span></span>

<span data-ttu-id="b91ab-119">自動コンパイルオプションは簡単に使用できます。</span><span class="sxs-lookup"><span data-stu-id="b91ab-119">The automatic compilation option is simple to use.</span></span> <span data-ttu-id="b91ab-120">明示的なコンパイル手順はなく、変更されたファイルのみを配置する必要がありますが、明示的なコンパイルでは、変更されたマークアップページとコンパイル済みのアセンブリを配置する必要があります。</span><span class="sxs-lookup"><span data-stu-id="b91ab-120">There's no explicit compilation step and only the files that have been modified need to be deployed, whereas explicit compilation necessitates deploying the changed markup pages and the just-compiled assembly.</span></span> <span data-ttu-id="b91ab-121">ただし、自動展開には、次の2つの潜在的な欠点があります。</span><span class="sxs-lookup"><span data-stu-id="b91ab-121">However, automatic deployment has two potential drawbacks:</span></span>

- <span data-ttu-id="b91ab-122">ページは最初にアクセスされたときに自動的にコンパイルされる必要があるため、ASP.NET ページが配置された後に初めて要求されると、短い遅延が発生する可能性があります。</span><span class="sxs-lookup"><span data-stu-id="b91ab-122">Because the pages must be automatically compiled when they are first visited, there can be a short but noticeable delay when an ASP.NET page is requested for the first time after being deployed.</span></span>
- <span data-ttu-id="b91ab-123">自動コンパイルを行うには、宣言型マークアップとソースコードの両方が web サーバー上に存在している必要があります。</span><span class="sxs-lookup"><span data-stu-id="b91ab-123">Automatic compilation requires that both the declarative markup and source code be present on the web server.</span></span> <span data-ttu-id="b91ab-124">これは、web アプリケーションを web サーバーにインストールする顧客に対して web アプリケーションを販売する予定の場合に魅力的オプションになります。</span><span class="sxs-lookup"><span data-stu-id="b91ab-124">This can be an unattractive option if you plan on selling the web application to customers who will install it on their web servers.</span></span>

<span data-ttu-id="b91ab-125">上記の2つの欠点のいずれかが処理ブレーカーの場合は、WAP モデルに切り替えるか、デプロイの前に WSP を*プリコンパイル*することができます。</span><span class="sxs-lookup"><span data-stu-id="b91ab-125">If either of the two above shortcomings are deal breakers, you can either switch to the WAP model or *precompile* the WSP prior to deployment.</span></span> <span data-ttu-id="b91ab-126">このチュートリアルでは、ホストされている web サイトに最適なプリコンパイルオプションを確認し、プリコンパイルプロセスとプリコンパイル済み web サイトの展開について説明します。</span><span class="sxs-lookup"><span data-stu-id="b91ab-126">This tutorial examines the precompilation options best suited for a hosted website and walks through the precompilation process and deployment of a precompiled website.</span></span>

## <a name="an-overview-of-aspnet-code-generation-and-compilation"></a><span data-ttu-id="b91ab-127">ASP.NET のコード生成とコンパイルの概要</span><span class="sxs-lookup"><span data-stu-id="b91ab-127">An Overview of ASP.NET Code Generation and Compilation</span></span>

<span data-ttu-id="b91ab-128">使用可能なプリコンパイルオプションを確認する前に、まず、ASP.NET ページが作成または最終更新された後に初めて要求されたときに発生するコード生成とコンパイルについて説明します。</span><span class="sxs-lookup"><span data-stu-id="b91ab-128">Before we look at the available precompilation options, let's first talk about the code generation and compilation that occurs when an ASP.NET page is requested for the first time since it's been created or last updated.</span></span> <span data-ttu-id="b91ab-129">ご存じのように、ASP.NET ページは2つの部分で構成されています。これは `.aspx` ファイル内の宣言型マークアップです。およびソースコード部分は、通常、別個の分離コードクラスファイル (`.aspx.cs`) にあります。</span><span class="sxs-lookup"><span data-stu-id="b91ab-129">As you know, ASP.NET pages are composed of two portions: declarative markup in the `.aspx` file; and a source code portion, typically in a separate code-behind class file (`.aspx.cs`).</span></span> <span data-ttu-id="b91ab-130">ASP.NET ページが要求されたときにランタイムによって実行される手順は、アプリケーションのコンパイルモデルによって異なります。</span><span class="sxs-lookup"><span data-stu-id="b91ab-130">The steps performed by the runtime when an ASP.NET page is requested depends on the application's compilation model.</span></span>

<span data-ttu-id="b91ab-131">Wap では、ページのソースコードをデプロイする前に、1つのアセンブリに明示的にコンパイルする必要があります。</span><span class="sxs-lookup"><span data-stu-id="b91ab-131">With WAPs, the pages' source code must be explicitly compiled into a single assembly before being deployed.</span></span> <span data-ttu-id="b91ab-132">デプロイ時に、このアセンブリとさまざまなマークアップページが運用環境にコピーされます。</span><span class="sxs-lookup"><span data-stu-id="b91ab-132">During deployment, this assembly and the various markup pages are copied to the production environment.</span></span> <span data-ttu-id="b91ab-133">ASP.NET ページの web サーバーに要求が到着すると、ランタイムはページの分離コードクラスのインスタンスを作成し `ProcessRequest` メソッドを呼び出します。このメソッドは、ページのライフサイクルを開始し、最終的には、要求元に返されるページのコンテンツを生成します。</span><span class="sxs-lookup"><span data-stu-id="b91ab-133">When a request arrives to the web server for an ASP.NET page, the runtime creates an instance of the page's code-behind class and invokes its `ProcessRequest` method, which starts the page lifecycle and, ultimately, generates the page's content, which is returned to the requestor.</span></span> <span data-ttu-id="b91ab-134">コードビハインドクラスは、配置前にアセンブリに既にコンパイルされているため、ランタイムは ASP.NET ページの分離コードクラスを使用できます。</span><span class="sxs-lookup"><span data-stu-id="b91ab-134">The runtime can work with the ASP.NET page's code-behind class because the code-behind class was already compiled into an assembly prior to deployment.</span></span>

<span data-ttu-id="b91ab-135">WSPs と自動コンパイルでは、デプロイの前に明示的なコンパイル手順はありません。</span><span class="sxs-lookup"><span data-stu-id="b91ab-135">With WSPs and automatic compilation, there is no explicit compilation step prior to deployment.</span></span> <span data-ttu-id="b91ab-136">代わりに、配置では、宣言型とソースコードの両方のコンテンツを運用環境にコピーする必要があります。</span><span class="sxs-lookup"><span data-stu-id="b91ab-136">Instead, deployment involves copying both the declarative and the source code content to the production environment.</span></span> <span data-ttu-id="b91ab-137">ページが作成された後、または最後に更新されてから初めて ASP.NET ページの web サーバーに要求が到着した場合、ランタイムは最初に、コードビハインドクラスをアセンブリにコンパイルする必要があります。</span><span class="sxs-lookup"><span data-stu-id="b91ab-137">When a request arrives to the web server for an ASP.NET page for the first time since the page has been created or last updated, the runtime must first compile the code-behind class into an assembly.</span></span> <span data-ttu-id="b91ab-138">このコンパイル済みアセンブリは `%WINDIR%\Microsoft.NET\Framework\v2.0.50727\Temporary ASP.NET Files`フォルダーに保存されます。ただし、このフォルダーの場所は `<system.web>`の `<compilation tempDirectory="" />` 要素 (通常は `Web.config`) を使用してカスタマイズできます。</span><span class="sxs-lookup"><span data-stu-id="b91ab-138">This compiled assembly is saved in the folder `%WINDIR%\Microsoft.NET\Framework\v2.0.50727\Temporary ASP.NET Files`, although the location of this folder can be customized via the `<compilation tempDirectory="" />` element of `<system.web>`, usually in `Web.config`.</span></span> <span data-ttu-id="b91ab-139">アセンブリはディスクに保存されるため、同じページへの後続の要求で再コンパイルする必要はありません。</span><span class="sxs-lookup"><span data-stu-id="b91ab-139">Because the assembly is saved to disk, it does not need to be recompiled on subsequent requests to the same page.</span></span>

> [!NOTE]
> <span data-ttu-id="b91ab-140">必要に応じて、自動コンパイルを使用しているサイトで最初にページを要求するとき (または、変更されてから初めて)、サーバーがページのコードをコンパイルし、生成されたアセンブリをに保存するのにしばらく時間がかかるため、わずかな遅延が発生します。ディスク.</span><span class="sxs-lookup"><span data-stu-id="b91ab-140">As you would expect, there is a slight delay when requesting a page for the first time (or for the first time since it's been changed) in a site that uses automatic compilation as it takes a moment for the server to compile the page's code and save the resulting assembly to disk.</span></span>

<span data-ttu-id="b91ab-141">簡潔に言えば、明示的なコンパイルでは、配置する前に web サイトのソースコードをコンパイルする必要があります。この手順を実行する必要がないように、ランタイムを保存します。</span><span class="sxs-lookup"><span data-stu-id="b91ab-141">In short, with explicit compilation you are required to compile the website's source code before deployment, saving the runtime from having to perform that step.</span></span> <span data-ttu-id="b91ab-142">自動コンパイルを使用すると、ランタイムはページのソースコードのコンパイルを処理しますが、ページが作成された後、または最後に更新されてからページに最初にアクセスしたときにわずかな初期化コストがかかります。</span><span class="sxs-lookup"><span data-stu-id="b91ab-142">With automatic compilation the runtime handles the compilation of the pages' source code, but with a slight initialization cost for the first visit to the page since it was created or last updated.</span></span>

<span data-ttu-id="b91ab-143">しかし、ASP.NET pages (`.aspx` ファイル) の宣言部分についてはどうでしょうか。</span><span class="sxs-lookup"><span data-stu-id="b91ab-143">But what about the declarative part of ASP.NET pages (the `.aspx` file)?</span></span> <span data-ttu-id="b91ab-144">宣言型マークアップで定義されている Web コントロールがコードでアクセス可能であるため、`.aspx` ファイルと分離コードクラスのコードの間にリレーションシップがあることは明らかです。</span><span class="sxs-lookup"><span data-stu-id="b91ab-144">It's obvious that there's a relationship between the `.aspx` files and the code in their code-behind classes, as the Web controls defined in the declarative markup are accessible in the code.</span></span> <span data-ttu-id="b91ab-145">また、`.aspx` ファイルの内容が、ページによって生成される表示マークアップに大きく影響することも明らかです。</span><span class="sxs-lookup"><span data-stu-id="b91ab-145">It's also obvious that the content in the `.aspx` files greatly influences the rendered markup generated by the page.</span></span> <span data-ttu-id="b91ab-146">では、要求されたページの表示内容を生成するために、ランタイムが `.aspx` ファイルで定義されているテキスト、HTML、および Web コントロール構文をどのように処理するのでしょうか。</span><span class="sxs-lookup"><span data-stu-id="b91ab-146">So how does the runtime work with the text, HTML, and Web control syntax defined in the `.aspx` file to generate the requested page's rendered content?</span></span>

<span data-ttu-id="b91ab-147">Wap と WSPs で異なる低レベルの実装の詳細については、あまり追跡しないようにしたいと思いますが、簡単に言うと、ランタイムは、さまざまな Web コントロールを含むクラスファイルをプロテクトメンバーとメソッドとして自動的に生成します。</span><span class="sxs-lookup"><span data-stu-id="b91ab-147">I don't want to get too sidetracked on the low-level implementation details, which vary between WAPs and WSPs, but in a nutshell the runtime automatically generates a class file that contains the various Web controls as protected members and methods.</span></span> <span data-ttu-id="b91ab-148">この生成されたファイルは、対応する分離コードクラスに*部分クラス*として実装されます。</span><span class="sxs-lookup"><span data-stu-id="b91ab-148">This generated file is implemented as a *partial class* to the corresponding code-behind class.</span></span> <span data-ttu-id="b91ab-149">([部分クラス](http://www.dotnet-guide.com/partialclasses.html)を使用すると、1つのクラスの内容を複数のファイルに分散させることができます)。このため、分離コードクラスは、作成した `.aspx.cs` ファイルと、ランタイムによって作成されたこの自動生成クラスの2か所で定義されます。</span><span class="sxs-lookup"><span data-stu-id="b91ab-149">([Partial classes](http://www.dotnet-guide.com/partialclasses.html) allow for the contents of a single class to be spread across multiple files.) Therefore, the code-behind class is defined in two places: in the `.aspx.cs` file that you create, and in this auto-generated class created by the runtime.</span></span> <span data-ttu-id="b91ab-150">この自動生成されたクラスは、`%WINDIR%\Microsoft.NET\Framework\v2.0.50727\Temporary ASP.NET Files` フォルダーに格納されます。</span><span class="sxs-lookup"><span data-stu-id="b91ab-150">This auto-generated class is stored in the `%WINDIR%\Microsoft.NET\Framework\v2.0.50727\Temporary ASP.NET Files` folder.</span></span>

<span data-ttu-id="b91ab-151">ここで重要なのは、ASP.NET ページがランタイムによってレンダリングされるようにすることです。これは、宣言型とソースコード部分の両方をアセンブリにコンパイルする必要があるためです。</span><span class="sxs-lookup"><span data-stu-id="b91ab-151">The important take away here is that for an ASP.NET page to be rendered by the runtime both its declarative and source code portions must be compiled into an assembly.</span></span> <span data-ttu-id="b91ab-152">Wap では、ソースコードは配置前にアセンブリに明示的にコンパイルされますが、宣言型マークアップはコードに変換され、web サーバーのランタイムによってコンパイルされる必要があります。</span><span class="sxs-lookup"><span data-stu-id="b91ab-152">With WAPs, the source code is explicitly compiled into an assembly prior to deployment, but the declarative markup must still be converted into code and compiled by the runtime on the web server.</span></span> <span data-ttu-id="b91ab-153">自動コンパイルを使用する WSPs では、ソースコードと宣言マークアップの両方を web サーバーでコンパイルする必要があります。</span><span class="sxs-lookup"><span data-stu-id="b91ab-153">With WSPs using automatic compilation, both the source code and the declarative markup need to be compiled by the web server.</span></span>

<span data-ttu-id="b91ab-154">WSP モデルでは、明示的なコンパイルを使用することができます。</span><span class="sxs-lookup"><span data-stu-id="b91ab-154">It is possible to use explicit compilation with the WSP model.</span></span> <span data-ttu-id="b91ab-155">WAP モデルと同様に、ソースコード部分を明示的にコンパイルできます。</span><span class="sxs-lookup"><span data-stu-id="b91ab-155">You can explicitly compile the source code portion, like with the WAP model.</span></span> <span data-ttu-id="b91ab-156">さらに、宣言型マークアップをコンパイルすることもできます。</span><span class="sxs-lookup"><span data-stu-id="b91ab-156">What's more, you can also compile the declarative markup.</span></span>

## <a name="precompilation-options"></a><span data-ttu-id="b91ab-157">プリコンパイルオプション</span><span class="sxs-lookup"><span data-stu-id="b91ab-157">Precompilation Options</span></span>

<span data-ttu-id="b91ab-158">.NET Framework には、 [ASP.NET コンパイルツール (`aspnet_compiler.exe`)](https://msdn.microsoft.com/library/ms229863.aspx)が付属しています。このツールを使用すると、WSP モデルを使用して構築された ASP.NET アプリケーションのソースコード (およびコンテンツも含む) をコンパイルできます。</span><span class="sxs-lookup"><span data-stu-id="b91ab-158">The .NET Framework ships with an [ASP.NET compilation tool (`aspnet_compiler.exe`)](https://msdn.microsoft.com/library/ms229863.aspx) that enables you to compile the source code (and even the content) of an ASP.NET application built using the WSP model.</span></span> <span data-ttu-id="b91ab-159">このツールは .NET Framework バージョン2.0 でリリースされ、`%WINDIR%\Microsoft.NET\Framework\v2.0.50727` フォルダーにあります。コマンドラインから使用することも、[ビルド] メニューの [Web サイトの発行] オプションを使用して Visual Studio 内から起動することもできます。</span><span class="sxs-lookup"><span data-stu-id="b91ab-159">This tool was released with the .NET Framework version 2.0 and is located in the `%WINDIR%\Microsoft.NET\Framework\v2.0.50727` folder; it can be used from the command line or launched from within Visual Studio via the Build menu's Publish Web Site option.</span></span>

<span data-ttu-id="b91ab-160">コンパイルツールには、配置のための組み込みプリコンパイルとプリコンパイルという2つの一般的なコンパイル形式が用意されています。</span><span class="sxs-lookup"><span data-stu-id="b91ab-160">The compilation tool provides two general forms of compilation: in-place precompilation and precompilation for deployment.</span></span> <span data-ttu-id="b91ab-161">インプレースプリコンパイルでは、コマンドラインから `aspnet_compiler.exe` ツールを実行し、コンピューター上に存在する web サイトの仮想ディレクトリまたは物理パスへのパスを指定します。</span><span class="sxs-lookup"><span data-stu-id="b91ab-161">With in-place precompilation you run the `aspnet_compiler.exe` tool from the command-line and specify the path to the virtual directory or physical path of a website that resides on your computer.</span></span> <span data-ttu-id="b91ab-162">次に、コンパイルツールは、プロジェクト内の各 ASP.NET ページをコンパイルし、コンパイルされたバージョンをブラウザーから初めてアクセスしたときと同じように、`%WINDIR%\Microsoft.NET\Framework\v2.0.50727\Temporary ASP.NET Files` フォルダーに保存します。</span><span class="sxs-lookup"><span data-stu-id="b91ab-162">The compilation tool then compiles each ASP.NET page in the project, storing the compiled version in the `%WINDIR%\Microsoft.NET\Framework\v2.0.50727\Temporary ASP.NET Files` folder just like if the pages had each been visited for the first time from a browser.</span></span> <span data-ttu-id="b91ab-163">インプレースプリコンパイルを使用すると、サイトに新しく配置された ASP.NET ページに対する最初の要求を高速化できます。これは、ランタイムがこの手順を実行する必要がなくなるためです。</span><span class="sxs-lookup"><span data-stu-id="b91ab-163">In-place precompilation can speed up the first request made to newly deployed ASP.NET pages on your site because it alleviates the runtime from needing to perform this step.</span></span> <span data-ttu-id="b91ab-164">ただし、ホストされている web サイトの大部分では、web サーバーのコマンドラインからプログラムを実行できる必要があるため、インプレースプリコンパイルは役に立ちません。</span><span class="sxs-lookup"><span data-stu-id="b91ab-164">However, in-place precompilation is not useful for the majority of hosted websites because it requires that you are able to run programs from the web server's command-line.</span></span> <span data-ttu-id="b91ab-165">共有ホスティング環境では、このレベルのアクセスは許可されていません。</span><span class="sxs-lookup"><span data-stu-id="b91ab-165">In shared hosting environments this level of access is not permitted.</span></span>

> [!NOTE]
> <span data-ttu-id="b91ab-166">インプレースプリコンパイルの詳細については、「[方法: ASP.NET Web サイトをプリコンパイルする](https://msdn.microsoft.com/library/ms227972.aspx)」および「 [ASP.NET 2.0 でのプリコンパイル](http://www.odetocode.com/Articles/417.aspx)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="b91ab-166">For more information on in-place precompilation, check out [How To: Precompile ASP.NET Web Sites](https://msdn.microsoft.com/library/ms227972.aspx) and [Precompilation in ASP.NET 2.0](http://www.odetocode.com/Articles/417.aspx).</span></span>

<span data-ttu-id="b91ab-167">Web サイトのページを `Temporary ASP.NET Files` フォルダーにコンパイルするのではなく、配置のプリコンパイルによって、選択したディレクトリと、運用環境に配置できる形式でページがコンパイルされます。</span><span class="sxs-lookup"><span data-stu-id="b91ab-167">Instead of compiling the pages in the website to the `Temporary ASP.NET Files` folder, precompilation for deployment compiles the pages to a directory of your choosing and in a format that can be deployed to the production environment.</span></span>

<span data-ttu-id="b91ab-168">このチュートリアルでは、「更新可能なユーザーインターフェイスを使用したプリコンパイル」と「更新不可能なユーザーインターフェイスを使用したプリコンパイル」の2種類のデプロイのプリコンパイルを使用します。</span><span class="sxs-lookup"><span data-stu-id="b91ab-168">There are two flavors of precompilation for deployment that we explore in this tutorial: precompilation with an updatable user interface, and precompilation with a non-updatable user interface.</span></span> <span data-ttu-id="b91ab-169">更新可能なユーザーインターフェイスを使用してプリコンパイルを行うと、`.aspx`、`.ascx`、および `.master` ファイルに宣言マークアップが残されるため、開発者は運用サーバー上の宣言型マークアップを表示して必要に応じて変更することができます。</span><span class="sxs-lookup"><span data-stu-id="b91ab-169">Precompilation with an updatable user interface leaves the declarative markup in the `.aspx`, `.ascx`, and `.master` files, thereby allowing a developer to view and, if desired, modify the declarative markup on the production server.</span></span> <span data-ttu-id="b91ab-170">更新不可能なユーザーインターフェイスを使用してプリコンパイルを行うと `.aspx` ページが生成され、`.ascx` ファイルと `.master` ファイルが削除されます。これにより、宣言型マークアップが非表示になり、開発者が運用環境から変更することを禁止できます。</span><span class="sxs-lookup"><span data-stu-id="b91ab-170">Precompilation with a non-updatable user interface generates `.aspx` pages that are void of any content and removes `.ascx` and `.master` files, thereby hiding the declarative markup and prohibiting a developer from changing it from the production environment.</span></span>

### <a name="precompiling-for-deployment-with-an-updatable-user-interface"></a><span data-ttu-id="b91ab-171">更新可能なユーザーインターフェイスを使用した配置のためのプリコンパイル</span><span class="sxs-lookup"><span data-stu-id="b91ab-171">Precompiling for Deployment With an Updatable User Interface</span></span>

<span data-ttu-id="b91ab-172">デプロイのプリコンパイルを理解する最善の方法は、動作の例を確認することです。</span><span class="sxs-lookup"><span data-stu-id="b91ab-172">The best way to understand precompilation for deployment is to see an example in action.</span></span> <span data-ttu-id="b91ab-173">更新可能なユーザーインターフェイスを使用して、デプロイ用の WSP をレビューするための書籍をプリコンパイルしてみましょう。</span><span class="sxs-lookup"><span data-stu-id="b91ab-173">Let's precompile the Book Reviews WSP for deployment using an updatable user interface.</span></span> <span data-ttu-id="b91ab-174">ASP.NET コンパイルツールは、Visual Studio の [ビルド] メニューから、またはコマンドラインから呼び出すことができます。</span><span class="sxs-lookup"><span data-stu-id="b91ab-174">The ASP.NET compilation tool can be invoked from Visual Studio's Build menu or from the command-line.</span></span> <span data-ttu-id="b91ab-175">このセクションでは、Visual Studio 内からのツールの使用について説明します。「コマンドラインからのプリコンパイル」セクションでは、コマンドラインからのコンパイラツールの実行について見ていきます。</span><span class="sxs-lookup"><span data-stu-id="b91ab-175">This section examines using the tool from within Visual Studio; the "Precompiling from the Command Line" section looks at running the compiler tool from the command line.</span></span>

<span data-ttu-id="b91ab-176">「Visual Studio での WSP のレビュー」を開き、[ビルド] メニューにアクセスして、[Web サイトの発行] メニューオプションを選択します。</span><span class="sxs-lookup"><span data-stu-id="b91ab-176">Open the Book Review WSP in Visual Studio, go to the Build menu, and select the Publish Web Site menu option.</span></span> <span data-ttu-id="b91ab-177">これにより、[Web サイトの発行] ダイアログボックスが開きます (**図 1**を参照)。このダイアログボックスでは、ターゲットの場所、プリコンパイル済みサイトのユーザーインターフェイスが更新可能かどうか、およびその他のコンパイラツールオプションを指定できます。</span><span class="sxs-lookup"><span data-stu-id="b91ab-177">This launches the Publish Web Site dialog box (see **Figure 1**), where you can specify the target location, whether or not the precompiled site's user interface is updatable, and other compiler tool options.</span></span> <span data-ttu-id="b91ab-178">ターゲットの場所には、リモート web サーバーまたは FTP サーバーを指定できますが、ここではコンピューターのハードドライブ上のフォルダーを選択します。</span><span class="sxs-lookup"><span data-stu-id="b91ab-178">The target location can be a remote web server or FTP server, but for now choose a folder on your computer's hard drive.</span></span> <span data-ttu-id="b91ab-179">更新可能なユーザーインターフェイスを使用してサイトをプリコンパイルする場合は、[このプリコンパイル済みサイトを更新可能にする] チェックボックスをオンにしたまま、[OK] をクリックします。</span><span class="sxs-lookup"><span data-stu-id="b91ab-179">Because we want to precompile the site with an updatable user interface, leave the "Allow this precompiled site to be updatable" checkbox checked and click OK.</span></span>

[![](precompiling-your-website-cs/_static/image2.png)](precompiling-your-website-cs/_static/image1.png)

<span data-ttu-id="b91ab-180">**図 1**: ASP.NET コンパイルツールは、指定されたターゲットの場所に web サイトをプリコンパイルします。</span><span class="sxs-lookup"><span data-stu-id="b91ab-180">**Figure 1**: The ASP.NET Compilation Tool Will Precompile Your Website to the Specified Target Location</span></span>  
 <span data-ttu-id="b91ab-181">([クリックすると、フルサイズの画像が表示](precompiling-your-website-cs/_static/image3.png)される)</span><span class="sxs-lookup"><span data-stu-id="b91ab-181">([Click to view full-size image](precompiling-your-website-cs/_static/image3.png))</span></span>

> [!NOTE]
> <span data-ttu-id="b91ab-182">[ビルド] メニューの [Web サイトの発行] オプションは、Visual Web Developer では使用できません。</span><span class="sxs-lookup"><span data-stu-id="b91ab-182">The Publish Web Site option in the Build menu is not available in Visual Web Developer.</span></span> <span data-ttu-id="b91ab-183">Visual Web Developer を使用している場合は、ASP.NET コンパイルツールのコマンドラインバージョンを使用する必要があります。これについては、「コマンドラインからのプリコンパイル」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="b91ab-183">If you are using Visual Web Developer you will need to use the command-line version of the ASP.NET compilation tool, which is covered in the "Precompiling from the Command Line" section.</span></span>

<span data-ttu-id="b91ab-184">Web サイトをプリコンパイルした後、[Web サイトの発行] ダイアログボックスで入力したターゲットの場所に移動します。</span><span class="sxs-lookup"><span data-stu-id="b91ab-184">After precompiling the website, navigate to the target location you entered in the Publish Web Site dialog box.</span></span> <span data-ttu-id="b91ab-185">このフォルダーの内容と web サイトの内容を比較してみてください。</span><span class="sxs-lookup"><span data-stu-id="b91ab-185">Take a moment to compare the contents of this folder with the contents of your website.</span></span> <span data-ttu-id="b91ab-186">**図 2**は、書籍のレビュー web サイトフォルダーを示しています。</span><span class="sxs-lookup"><span data-stu-id="b91ab-186">**Figure 2** shows the Book Reviews website folder.</span></span> <span data-ttu-id="b91ab-187">`.aspx` と `.aspx.cs` ファイルの両方が含まれていることに注意してください。</span><span class="sxs-lookup"><span data-stu-id="b91ab-187">Note that it contains both `.aspx` and `.aspx.cs` files.</span></span> <span data-ttu-id="b91ab-188">また、`Bin` ディレクトリには、[前のチュートリアル](logging-error-details-with-elmah-cs.md)で追加したファイルとして `Elmah.dll`が1つだけ含まれていることに注意してください。</span><span class="sxs-lookup"><span data-stu-id="b91ab-188">Also, note that the `Bin` directory includes only one file, `Elmah.dll`, which we added in the [preceding tutorial](logging-error-details-with-elmah-cs.md)</span></span>

[![](precompiling-your-website-cs/_static/image5.png)](precompiling-your-website-cs/_static/image4.png)

<span data-ttu-id="b91ab-189">**図 2**: プロジェクトディレクトリには `.aspx` ファイルと `.aspx.cs` ファイルが含まれています。`Bin` フォルダーには、だけが含まれてい `Elmah.dll`</span><span class="sxs-lookup"><span data-stu-id="b91ab-189">**Figure 2**: The Project Directory Contains `.aspx` and `.aspx.cs` Files; the `Bin` Folder Includes Just `Elmah.dll`</span></span>  
 <span data-ttu-id="b91ab-190">([クリックすると、フルサイズの画像が表示](precompiling-your-website-cs/_static/image6.png)される)</span><span class="sxs-lookup"><span data-stu-id="b91ab-190">([Click to view full-size image](precompiling-your-website-cs/_static/image6.png))</span></span>

<span data-ttu-id="b91ab-191">**図 3**は、ASP.NET コンパイルツールによってコンテンツが作成されたターゲットロケーションフォルダーを示しています。</span><span class="sxs-lookup"><span data-stu-id="b91ab-191">**Figure 3** shows the target location folder whose contents were created by the ASP.NET compilation tool.</span></span> <span data-ttu-id="b91ab-192">このフォルダーには、分離コードファイルが含まれていません。</span><span class="sxs-lookup"><span data-stu-id="b91ab-192">This folder does not contain any code-behind files.</span></span> <span data-ttu-id="b91ab-193">さらに、このフォルダーの `Bin` ディレクトリには、`Elmah.dll` アセンブリに加えて、複数のアセンブリと2つの `.compiled` ファイルが含まれています。</span><span class="sxs-lookup"><span data-stu-id="b91ab-193">Moreover, this folder's `Bin` directory includes several assemblies and two `.compiled` files in addition to the `Elmah.dll` assembly.</span></span>

[![](precompiling-your-website-cs/_static/image8.png)](precompiling-your-website-cs/_static/image7.png)

<span data-ttu-id="b91ab-194">**図 3**: ターゲットの場所フォルダーに配置用のファイルが含まれている</span><span class="sxs-lookup"><span data-stu-id="b91ab-194">**Figure 3**: The Target Location Folder Includes the Files for Deployment</span></span>  
 <span data-ttu-id="b91ab-195">([クリックすると、フルサイズの画像が表示](precompiling-your-website-cs/_static/image9.png)される)</span><span class="sxs-lookup"><span data-stu-id="b91ab-195">([Click to view full-size image](precompiling-your-website-cs/_static/image9.png))</span></span>

<span data-ttu-id="b91ab-196">Wap での明示的なコンパイルとは異なり、展開プロセスのプリコンパイルでは、サイト全体に対して1つのアセンブリが作成されるわけではありません。</span><span class="sxs-lookup"><span data-stu-id="b91ab-196">Unlike explicit compilation in WAPs, the precompilation for deployment process does not create one assembly for the entire site.</span></span> <span data-ttu-id="b91ab-197">代わりに、複数のページを1つのアセンブリにバッチ処理します。</span><span class="sxs-lookup"><span data-stu-id="b91ab-197">Instead, it batches together several pages into each assembly.</span></span> <span data-ttu-id="b91ab-198">また、`Global.asax` ファイル (存在する場合) も、`App_Code` フォルダー内のクラスだけでなく、独自のアセンブリにもコンパイルされます。</span><span class="sxs-lookup"><span data-stu-id="b91ab-198">It also compiles the `Global.asax` file (if present) into its own assembly, as well as any classes in the `App_Code` folder.</span></span> <span data-ttu-id="b91ab-199">ASP.NET web ページ、ユーザーコントロール、およびマスターページ (`.aspx`、`.ascx`、および `.master` ファイル) の宣言型マークアップを保持するファイルは、そのままターゲットの場所のディレクトリにコピーされます。</span><span class="sxs-lookup"><span data-stu-id="b91ab-199">The files that hold the declarative markup for ASP.NET web pages, User Controls, and master pages (`.aspx`, `.ascx`, and `.master` files, respectively) are copied as-is to the target location directory.</span></span> <span data-ttu-id="b91ab-200">同様に、`Web.config` ファイルは、イメージ、CSS クラス、PDF ファイルなどの静的ファイルと共に、すぐにコピーされます。</span><span class="sxs-lookup"><span data-stu-id="b91ab-200">Likewise, the `Web.config` file is copied straight over, along with any static files, such as images, CSS classes, and PDF files.</span></span> <span data-ttu-id="b91ab-201">コンパイルツールがさまざまなファイルの種類を処理する方法の詳細については、「 [ASP.NET プリコンパイル中のファイル処理](https://msdn.microsoft.com/library/e22s60h9.aspx)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="b91ab-201">For a more formal description of how the compilation tool handles various file types, refer to [File Handling During ASP.NET Precompilation](https://msdn.microsoft.com/library/e22s60h9.aspx).</span></span>

> [!NOTE]
> <span data-ttu-id="b91ab-202">[Web サイトの発行] ダイアログボックスの [固定名およびシングルページアセンブリを使用する] チェックボックスをオンにすることで、ASP.NET ページ、ユーザーコントロール、またはマスターページごとに1つのアセンブリを作成するようにコンパイルツールに指示できます。</span><span class="sxs-lookup"><span data-stu-id="b91ab-202">You can instruct the compilation tool to create one assembly per ASP.NET page, User Control, or master page by checking the "Used fixed naming and single page assemblies" checkbox from the Publish Web Site dialog box.</span></span> <span data-ttu-id="b91ab-203">各 ASP.NET ページを独自のアセンブリにコンパイルすることで、配置をより細かく制御できます。</span><span class="sxs-lookup"><span data-stu-id="b91ab-203">Having each ASP.NET page compiled into its own assembly allows for more fine-grained control over deployment.</span></span> <span data-ttu-id="b91ab-204">たとえば、1つの ASP.NET web ページを更新し、その変更を配置する必要がある場合、そのページの `.aspx` ファイルと関連アセンブリを運用環境に配置するだけで済みます。</span><span class="sxs-lookup"><span data-stu-id="b91ab-204">For example, if you updated a single ASP.NET web page and needed to deploy that change, you need only deploy that page's `.aspx` file and associated assembly to the production environment.</span></span> <span data-ttu-id="b91ab-205">詳細について[は、「方法: ASP.NET コンパイルツールを使用して固定名を生成する](https://msdn.microsoft.com/library/ms228040.aspx)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="b91ab-205">Consult [How To: Generate Fixed Names with the ASP.NET Compilation Tool](https://msdn.microsoft.com/library/ms228040.aspx) for more information.</span></span>

<span data-ttu-id="b91ab-206">ターゲットの場所のディレクトリには、プリコンパイルされた web プロジェクトの一部ではないファイルも含まれています (つまり `PrecompiledApp.config`)。</span><span class="sxs-lookup"><span data-stu-id="b91ab-206">The target location directory also contains a file that was not part of the precompiled web project, namely `PrecompiledApp.config`.</span></span> <span data-ttu-id="b91ab-207">このファイルは、アプリケーションがプリコンパイルされたこと、および更新可能な UI または正午の UI でプリコンパイルされているかどうかを ASP.NET ランタイムに通知します。</span><span class="sxs-lookup"><span data-stu-id="b91ab-207">This file informs the ASP.NET runtime that the application was precompiled and whether it was precompiled with an updatable or noon-updatable UI.</span></span>

<span data-ttu-id="b91ab-208">最後に、Visual Studio または任意のテキストエディターを使用して、ターゲットの場所にあるいずれかの `.aspx` ファイルを開きます。</span><span class="sxs-lookup"><span data-stu-id="b91ab-208">Finally, take a moment to open one of the `.aspx` files in the target location using Visual Studio or your text editor of choice.</span></span> <span data-ttu-id="b91ab-209">更新可能なユーザーインターフェイスを使用して配置用にプリコンパイルする場合、ターゲットの場所ディレクトリの ASP.NET ページには、web サイト内の対応するファイルとまったく同じマークアップが含まれます。</span><span class="sxs-lookup"><span data-stu-id="b91ab-209">When precompiling for deployment with an updatable user interface, the ASP.NET pages in the target location directory contain the exact same markup as the corresponding files in the website.</span></span>

### <a name="precompiling-for-deployment-with-a-non-updatable-user-interface"></a><span data-ttu-id="b91ab-210">更新不可能なユーザーインターフェイスを使用した配置のためのプリコンパイル</span><span class="sxs-lookup"><span data-stu-id="b91ab-210">Precompiling for Deployment With a Non-Updatable User Interface</span></span>

<span data-ttu-id="b91ab-211">ASP.NET コンパイラツールを使用すると、更新できない UI を使用して配置するサイトをプリコンパイルすることもできます。</span><span class="sxs-lookup"><span data-stu-id="b91ab-211">The ASP.NET compiler tool can also be used to precompile a site for deployment with a non-updatable UI.</span></span> <span data-ttu-id="b91ab-212">更新不可能な UI を使用したサイトのプリコンパイルは、更新可能な UI を使用したプリコンパイルと同様に機能します。つまり、ターゲットディレクトリの ASP.NET ページ、ユーザーコントロール、およびマスターページがマークアップによって削除されるという主な違いがあります。</span><span class="sxs-lookup"><span data-stu-id="b91ab-212">Precompiling the site with a non-updatable UI works much like precompiling with an updatable UI, the key difference being that the ASP.NET pages, User Controls, and master pages in the target directory are stripped of their markup.</span></span> <span data-ttu-id="b91ab-213">更新不可能な UI で web サイトをデプロイ用にプリコンパイルするには、[ビルド] メニューの [Web サイトの発行] オプションを選択します。ただし、[このプリコンパイル済みサイトを更新可能にする] オプションはオフにします (**図 4**を参照)。</span><span class="sxs-lookup"><span data-stu-id="b91ab-213">To precompile a website for deployment with a non-updatable UI, choose the Publish Web Site option from the Build menu, but uncheck the "Allow this precompiled site to be updatable" option (see **Figure 4**).</span></span>

[![](precompiling-your-website-cs/_static/image11.png)](precompiling-your-website-cs/_static/image10.png)

<span data-ttu-id="b91ab-214">**図 4**: 更新不可能な UI でプリコンパイルするために [このプリコンパイル済みサイトを更新可能にする] オプションをオフにする</span><span class="sxs-lookup"><span data-stu-id="b91ab-214">**Figure 4**: Uncheck the "Allow this precompiled site to be updatable" Option To Precompile With a Non-Updatable UI</span></span>  
 <span data-ttu-id="b91ab-215">([クリックすると、フルサイズの画像が表示](precompiling-your-website-cs/_static/image12.png)される)</span><span class="sxs-lookup"><span data-stu-id="b91ab-215">([Click to view full-size image](precompiling-your-website-cs/_static/image12.png))</span></span>

<span data-ttu-id="b91ab-216">**図 5**は、更新できないユーザーインターフェイスを使用してプリコンパイルした後のターゲットロケーションフォルダーを示しています。</span><span class="sxs-lookup"><span data-stu-id="b91ab-216">**Figure 5** shows the target location folder after precompiling with a non-updatable user interface.</span></span>

[![](precompiling-your-website-cs/_static/image14.png)](precompiling-your-website-cs/_static/image13.png)

<span data-ttu-id="b91ab-217">**図 5**: 更新できない UI を使用した配置のターゲットロケーションフォルダー</span><span class="sxs-lookup"><span data-stu-id="b91ab-217">**Figure 5**: The Target Location Folder for Deployment With a Non-Updatable UI</span></span>  
 <span data-ttu-id="b91ab-218">([クリックすると、フルサイズの画像が表示](precompiling-your-website-cs/_static/image15.png)される)</span><span class="sxs-lookup"><span data-stu-id="b91ab-218">([Click to view full-size image](precompiling-your-website-cs/_static/image15.png))</span></span>

<span data-ttu-id="b91ab-219">図**3**を**図 5**と比較します。</span><span class="sxs-lookup"><span data-stu-id="b91ab-219">Compare **Figure 3** to **Figure 5**.</span></span> <span data-ttu-id="b91ab-220">2つのフォルダーは同じように見えますが、更新できない UI フォルダーには、`Site.master`マスターページがありません。</span><span class="sxs-lookup"><span data-stu-id="b91ab-220">While the two folders may look identical, note that the non-updatable UI folder lacks the master page, `Site.master`.</span></span> <span data-ttu-id="b91ab-221">また、**図 5**にはさまざまな ASP.NET ページが含まれていますが、これらのファイルの内容を表示すると、宣言型マークアップが削除され、"これはプリコンパイルツールによって生成されたマーカーファイルであり、削除することはできません" と表示されます。</span><span class="sxs-lookup"><span data-stu-id="b91ab-221">And while **Figure 5** includes the various ASP.NET pages, if you view the contents of these files you'll see that they've been stripped of their declarative markup and replaced with the placeholder text: "This is a marker file generated by the precompilation tool, and should not be deleted!"</span></span>

[![](precompiling-your-website-cs/_static/image17.png)](precompiling-your-website-cs/_static/image16.png)

<span data-ttu-id="b91ab-222">**図 5**: 宣言型のマークアップが ASP.NET ページから削除されている</span><span class="sxs-lookup"><span data-stu-id="b91ab-222">**Figure 5**: The Declarative Markup Has Been Removed from the ASP.NET Pages</span></span>

<span data-ttu-id="b91ab-223">**図 3**と**5**の `Bin` フォルダーは、より大きく異なります。</span><span class="sxs-lookup"><span data-stu-id="b91ab-223">The `Bin` folders in **Figures 3** and **5** differ more substantially.</span></span> <span data-ttu-id="b91ab-224">アセンブリに加えて、**図 5**の `Bin` フォルダーには、各 ASP.NET ページ、ユーザーコントロール、およびマスターページの `.compiled` ファイルが含まれています。</span><span class="sxs-lookup"><span data-stu-id="b91ab-224">In addition to the assemblies, the `Bin` folder in **Figure 5** includes a `.compiled` file for each ASP.NET page, User Control, and master page.</span></span>

<span data-ttu-id="b91ab-225">更新不可能な UI を使用してサイトをプリコンパイルすることは、運用環境で web サイトをインストールまたは管理するユーザーまたは会社が ASP.NET ページの内容を変更したくない場合に役立ちます。</span><span class="sxs-lookup"><span data-stu-id="b91ab-225">Precompiling a site with a non-updatable UI is useful in situations where you do not want the ASP.NET pages' contents to be modified by the person or company who installs or manages the website in the production environment.</span></span> <span data-ttu-id="b91ab-226">お客様に販売する ASP.NET web アプリケーションを独自の web サーバーにインストールする場合は、発送する `.aspx` ページを直接編集して、サイトの外観を変更しないようにすることをお勧めします。</span><span class="sxs-lookup"><span data-stu-id="b91ab-226">If you build an ASP.NET web application that you sell to customers to install on their own web servers, you may want to ensure that they do not modify the look and feel of your site by directly editing the `.aspx` pages you ship them.</span></span> <span data-ttu-id="b91ab-227">更新できない UI で web サイトをプリコンパイルすることによって、インストールの一部としてプレースホルダーを `.aspx` ページに発送し、顧客がコンテンツを検査または変更するのを防ぐことができます。</span><span class="sxs-lookup"><span data-stu-id="b91ab-227">By precompiling your website with a non-updatable UI, you ship the placeholder `.aspx` pages as part of the installation, thereby preventing your customers from examining or modifying their content.</span></span>

### <a name="precompiling-from-the-command-line"></a><span data-ttu-id="b91ab-228">コマンドラインからのプリコンパイル</span><span class="sxs-lookup"><span data-stu-id="b91ab-228">Precompiling from the Command Line</span></span>

<span data-ttu-id="b91ab-229">バックグラウンドで、Visual Studio の [Web サイトの発行] ダイアログボックスで ASP.NET コンパイルツール (`aspnet_compiler.exe`) を呼び出して、web サイトをプリコンパイルします。</span><span class="sxs-lookup"><span data-stu-id="b91ab-229">Behind the scenes, Visual Studio's Publish Web Site dialog box invokes the ASP.NET compilation tool (`aspnet_compiler.exe`) to precompile the website.</span></span> <span data-ttu-id="b91ab-230">または、コマンドラインからこのツールを起動することもできます。</span><span class="sxs-lookup"><span data-stu-id="b91ab-230">Alternatively, you can invoke this tool from the command line.</span></span> <span data-ttu-id="b91ab-231">実際に Visual Web Developer を使用する場合は、Visual Web Developer の [ビルド] メニューに [Web サイトの発行] オプションが含まれていないため、コマンドラインからコンパイラツールを実行する必要があります。</span><span class="sxs-lookup"><span data-stu-id="b91ab-231">In fact, if you use Visual Web Developer then you will need to run the compiler tool from the command line, as Visual Web Developer's Build menu does not include the Publish Web Site option.</span></span>

<span data-ttu-id="b91ab-232">コマンドラインからコンパイラツールを使用するには、まずコマンドラインにドロップし、フレームワークのディレクトリに移動して `%WINDIR%\Microsoft.NET\Framework\v2.0.50727`ます。</span><span class="sxs-lookup"><span data-stu-id="b91ab-232">To use the compiler tool from the command line, start by dropping to the command line and navigating to the framework directory, `%WINDIR%\Microsoft.NET\Framework\v2.0.50727`.</span></span> <span data-ttu-id="b91ab-233">次に、コマンドラインに次のステートメントを入力します。</span><span class="sxs-lookup"><span data-stu-id="b91ab-233">Next, enter the following statement into the command line:</span></span>

`aspnet_compiler -p "physical_path_to_app" -v / -f -u "target_location_folder"`

<span data-ttu-id="b91ab-234">上のコマンドは、ASP.NET compiler ツール (`aspnet_compiler.exe`) を起動し、`-p` スイッチを使用して、*物理\_パス\_を*ルートとする web サイトを\_アプリにプリコンパイルするように指示します。この値は `C:\MySites\BookReviews`のようになります。引用符で区切る必要があります。</span><span class="sxs-lookup"><span data-stu-id="b91ab-234">The above command launches the ASP.NET compiler tool (`aspnet_compiler.exe`) and, via the `-p` switch, instructs it to precompile the website rooted at *physical\_path\_to\_app*; this value will be something like `C:\MySites\BookReviews`, and should be delimited by quotation marks.</span></span>

<span data-ttu-id="b91ab-235">`-v` スイッチは、サイトの仮想ディレクトリを指定します。</span><span class="sxs-lookup"><span data-stu-id="b91ab-235">The `-v` switch specifies the virtual directory of the site.</span></span> <span data-ttu-id="b91ab-236">サイトが IIS メタベースの既定の web サイトとして登録されている場合は、`-p` スイッチを省略し、アプリケーションの仮想ディレクトリを指定するだけで済みます。</span><span class="sxs-lookup"><span data-stu-id="b91ab-236">If your site is registered as the default website in the IIS metabase then you can omit the `-p` switch and just specify the virtual directory of the application.</span></span> <span data-ttu-id="b91ab-237">`-p` スイッチを使用する場合、`-v` スイッチの後の値は web サイトのルートを示し、はアプリケーションルートの参照を解決するために使用されます。</span><span class="sxs-lookup"><span data-stu-id="b91ab-237">If you use the `-p` switch, the value proceeding the `-v` switch indicates the root of the website, and is used to resolve application-root references.</span></span> <span data-ttu-id="b91ab-238">たとえば、`-v /MySite` の値を指定した場合、`~/path/file` するアプリケーション内の参照は `~/MySite/path/file`として解決されます。</span><span class="sxs-lookup"><span data-stu-id="b91ab-238">For instance, if you specify a value of `-v /MySite` then references in the application to `~/path/file` will be resolved as `~/MySite/path/file`.</span></span> <span data-ttu-id="b91ab-239">書籍のレビューサイトは、web ホスティング会社のルートディレクトリにあるため、スイッチ `-v /`を使用しました。</span><span class="sxs-lookup"><span data-stu-id="b91ab-239">Because the Book Reviews site is located at the root directory at my web hosting company I have used the switch `-v /`.</span></span>

<span data-ttu-id="b91ab-240">`-f` スイッチが存在する場合は、*ターゲット\_場所\_フォルダー*ディレクトリが既に存在する場合は上書きするようにコンパイルツールに指示します。</span><span class="sxs-lookup"><span data-stu-id="b91ab-240">The `-f` switch, if present, instructs the compilation tool to overwrite the *target\_location\_folder* directory if it already exists.</span></span> <span data-ttu-id="b91ab-241">`-f` スイッチを省略し、ターゲットの場所のフォルダーが既に存在する場合、コンパイルツールは "エラー ASPRUNTIME: ターゲットディレクトリが空ではありません" というエラーで終了します。</span><span class="sxs-lookup"><span data-stu-id="b91ab-241">If you omit the `-f` switch and the target location folder already exists, the compilation tool will quit with the error: "error ASPRUNTIME: The target directory is not empty.</span></span> <span data-ttu-id="b91ab-242">手動で削除するか、別のターゲットを選択してください。 "</span><span class="sxs-lookup"><span data-stu-id="b91ab-242">Please delete it manually or choose a different target."</span></span>

<span data-ttu-id="b91ab-243">`-u` スイッチが存在する場合は、更新可能なユーザーインターフェイスを作成するようにツールに通知します。</span><span class="sxs-lookup"><span data-stu-id="b91ab-243">The `-u` switch, if present, informs the tool to create an updatable user interface.</span></span> <span data-ttu-id="b91ab-244">更新できないユーザーインターフェイスを使用してサイトをプリコンパイルする場合は、このスイッチを省略します。</span><span class="sxs-lookup"><span data-stu-id="b91ab-244">Omit this switch to precompile the site with a non-updatable user interface.</span></span>

<span data-ttu-id="b91ab-245">最後に、ターゲットの *\_の場所\_フォルダー*は、ターゲットの場所のディレクトリへの物理パスです。この値は `C:\MySites\Output\BookReviews`のようになります。引用符で区切る必要があります。</span><span class="sxs-lookup"><span data-stu-id="b91ab-245">Lastly, the *target\_location\_folder* is the physical path to the target location directory; this value will be something like `C:\MySites\Output\BookReviews`, and should be delimited by quotation marks.</span></span>

## <a name="deploying-the-precompiled-website"></a><span data-ttu-id="b91ab-246">プリコンパイル済み Web サイトの配置</span><span class="sxs-lookup"><span data-stu-id="b91ab-246">Deploying the Precompiled Website</span></span>

<span data-ttu-id="b91ab-247">この時点で、ASP.NET コンパイルツールを使用して、更新可能なユーザーインターフェイスオプションと更新できないユーザーインターフェイスオプションの両方を使用して web サイトをプリコンパイルする方法を説明しました。</span><span class="sxs-lookup"><span data-stu-id="b91ab-247">At this point we have seen how to use the ASP.NET compilation tool to precompile a website using both the updatable and non-updatable user interface options.</span></span> <span data-ttu-id="b91ab-248">ただし、この例では、web サイトを実稼働環境ではなくローカルフォルダーにプリコンパイルしています。</span><span class="sxs-lookup"><span data-stu-id="b91ab-248">However, our examples thus far have precompiled the website to a local folder, and not to the production environment.</span></span> <span data-ttu-id="b91ab-249">さいわいにも、プリコンパイル済み web サイトのデプロイは簡単であり、Visual Studio またはスタンドアロン FTP クライアントなどの他のファイルコピーメカニズムを使用して行うことができます。</span><span class="sxs-lookup"><span data-stu-id="b91ab-249">The good news is that deploying the precompiled website is a breeze and can be done through Visual Studio or through some other file copy mechanism, such as from a stand-alone FTP client.</span></span>

<span data-ttu-id="b91ab-250">[Web サイトの発行] ダイアログボックス (**図 1**の最初に表示) には、[ターゲットの場所] オプションがあります。このオプションは、プリコンパイル済み web サイトファイルのコピー先を示します。</span><span class="sxs-lookup"><span data-stu-id="b91ab-250">The Publish Web Site dialog box (first shown in **Figure 1**) has a target location option, which indicates where the precompiled website files are copied to.</span></span> <span data-ttu-id="b91ab-251">この場所には、リモート web サーバーまたは FTP サーバーを指定できます。</span><span class="sxs-lookup"><span data-stu-id="b91ab-251">This location can be a remote web server or FTP server.</span></span> <span data-ttu-id="b91ab-252">このテキストボックスにリモートサーバーを入力すると、1回の手順で指定したサーバーに web サイトがプリコンパイルされ、展開されます。</span><span class="sxs-lookup"><span data-stu-id="b91ab-252">Entering a remote server into this textbox precompiles and deploys the website to the specified server in one step.</span></span> <span data-ttu-id="b91ab-253">または、web サイトをローカルフォルダーにプリコンパイルしてから、そのフォルダーの内容を FTP またはその他の方法を使用して運用環境に手動でコピーすることもできます。</span><span class="sxs-lookup"><span data-stu-id="b91ab-253">Alternatively, you can precompile the website to a local folder and then manually copy the contents of that folder to the production environment via FTP or some other approach.</span></span>

<span data-ttu-id="b91ab-254">Visual Studio の [Web サイトの発行] ダイアログボックスを使用して、プリコンパイルされた web サイトを自動的にデプロイすることは、開発環境と運用環境の間に構成の違いがない単純なサイトに役立ちます。</span><span class="sxs-lookup"><span data-stu-id="b91ab-254">Having the precompiled website automatically deployed via Visual Studio's Publish Web Site dialog box is helpful for simple sites where there are no configuration differences between the development and production environments.</span></span> <span data-ttu-id="b91ab-255">ただし、 [*開発と運用のチュートリアルの一般的な構成の違い*](common-configuration-differences-between-development-and-production-cs.md)に記載されているように、このような違いが存在することは珍しくありません。</span><span class="sxs-lookup"><span data-stu-id="b91ab-255">However, as noted in the [*Common Configuration Differences Between Development and Production* tutorial](common-configuration-differences-between-development-and-production-cs.md) it is not uncommon for such differences to exist.</span></span> <span data-ttu-id="b91ab-256">たとえば、書籍レビュー web アプリケーションでは、開発環境とは異なるデータベースを運用環境で使用します。</span><span class="sxs-lookup"><span data-stu-id="b91ab-256">For example, the Book Reviews web application uses a different database in the production environment than in the development environment.</span></span> <span data-ttu-id="b91ab-257">Visual Studio によって web サイトがリモートサーバーに発行されると、開発環境の構成ファイル情報が無条件にコピーされます。</span><span class="sxs-lookup"><span data-stu-id="b91ab-257">When Visual Studio publishes the website to a remote server it blindly copies up the configuration file information in the development environment.</span></span>

<span data-ttu-id="b91ab-258">開発環境と運用環境の構成が異なるサイトの場合は、サイトをローカルディレクトリにプリコンパイルし、実稼働固有の構成ファイルをコピーして、プリコンパイル済み出力の内容をにコピーするのが最適な場合があります。時.</span><span class="sxs-lookup"><span data-stu-id="b91ab-258">For sites with configuration differences between the development and production environments it may be best to precompile the site to a local directory, copy over the production-specific configuration files, and then copy the contents of the precompiled output to production.</span></span>

<span data-ttu-id="b91ab-259">開発環境から運用環境へのファイルのコピーの詳細については、「 [*FTP クライアントを使用した Web サイトのデプロイ*](deploying-your-site-using-an-ftp-client-cs.md)」と[ *「Visual Studio を使用した Web サイトのデプロイ*](determining-what-files-need-to-be-deployed-cs.md)」チュートリアルを参照してください。</span><span class="sxs-lookup"><span data-stu-id="b91ab-259">For a refresher on copying files from the development environment to the production environment refer to the [*Deploying Your Website Using an FTP Client*](deploying-your-site-using-an-ftp-client-cs.md) and [*Deploying Your Website Using Visual Studio*](determining-what-files-need-to-be-deployed-cs.md) tutorials.</span></span>

## <a name="summary"></a><span data-ttu-id="b91ab-260">要約</span><span class="sxs-lookup"><span data-stu-id="b91ab-260">Summary</span></span>

<span data-ttu-id="b91ab-261">ASP.NET は、自動と explicit の2つのコンパイルモードをサポートしています。</span><span class="sxs-lookup"><span data-stu-id="b91ab-261">ASP.NET supports two modes of compilation: automatic and explicit.</span></span> <span data-ttu-id="b91ab-262">前のチュートリアルで説明したように、Web アプリケーションプロジェクト (Wap) は明示的なコンパイルを使用しますが、Web サイトプロジェクト (WSPs) は既定で自動コンパイルを使用します。</span><span class="sxs-lookup"><span data-stu-id="b91ab-262">As discussed in previous tutorials, Web Application Projects (WAPs) use explicit compilation whereas Web Site Projects (WSPs) use automatic compilation, by default.</span></span> <span data-ttu-id="b91ab-263">ただし、ASP.NET コンパイルツールを使用すると、デプロイの前に WSP を明示的にコンパイルできます。</span><span class="sxs-lookup"><span data-stu-id="b91ab-263">However, it is possible to explicitly compile a WSP prior to deployment by using the ASP.NET compilation tool.</span></span>

<span data-ttu-id="b91ab-264">このチュートリアルでは、配置をサポートするためのコンパイルツールのプリコンパイルに焦点を絞っています。</span><span class="sxs-lookup"><span data-stu-id="b91ab-264">This tutorial focused on the compilation tool's Precompilation for Deployment support.</span></span> <span data-ttu-id="b91ab-265">配置のためにプリコンパイルを行う場合、コンパイルツールは、ターゲットの場所のフォルダーを作成し、指定された web アプリケーションのソースコードをコンパイルして、これらのコンパイル済みのアセンブリとコンテンツファイルをターゲットの場所のフォルダーにコピーします。</span><span class="sxs-lookup"><span data-stu-id="b91ab-265">When precompiling for deployment, the compilation tool creates a target location folder, compiles the specified web application's source code, and copies these compiled assemblies and the content files into the target location folder.</span></span> <span data-ttu-id="b91ab-266">コンパイルツールを構成して、更新可能または更新不可能なユーザーインターフェイスを作成できます。</span><span class="sxs-lookup"><span data-stu-id="b91ab-266">The compilation tool can be configured to create an updatable or non-updatable user interface.</span></span> <span data-ttu-id="b91ab-267">更新できないユーザーインターフェイスオプションを使用してプリコンパイルを行うと、コンテンツファイル内の宣言型マークアップが削除されます。</span><span class="sxs-lookup"><span data-stu-id="b91ab-267">When precompiling with a non-updatable user interface option, the declarative markup in the content files is removed.</span></span> <span data-ttu-id="b91ab-268">簡単に言うと、プリコンパイルを使用すると、必要に応じて、ソースコードファイルを含めずに、宣言型マークアップを削除して、Web サイトプロジェクトベースのアプリケーションを配置できます。</span><span class="sxs-lookup"><span data-stu-id="b91ab-268">In a nutshell, precompilation permits you to deploy your Web Site Project-based application without including any source code files and with the declarative markup removed, if desired.</span></span>

<span data-ttu-id="b91ab-269">プログラミングを楽しんでください。</span><span class="sxs-lookup"><span data-stu-id="b91ab-269">Happy Programming!</span></span>

### <a name="further-reading"></a><span data-ttu-id="b91ab-270">関連項目</span><span class="sxs-lookup"><span data-stu-id="b91ab-270">Further Reading</span></span>

<span data-ttu-id="b91ab-271">このチュートリアルで説明しているトピックの詳細については、次のリソースを参照してください。</span><span class="sxs-lookup"><span data-stu-id="b91ab-271">For more information on the topics discussed in this tutorial, refer to the following resources:</span></span>

- [<span data-ttu-id="b91ab-272">ASP.NET Web サイトのプリコンパイル</span><span class="sxs-lookup"><span data-stu-id="b91ab-272">ASP.NET Web Site Precompilation</span></span>](https://msdn.microsoft.com/library/ms228015.aspx)
- [<span data-ttu-id="b91ab-273">ASP.NET 2.0 での分離コードとコンパイル</span><span class="sxs-lookup"><span data-stu-id="b91ab-273">Codebehind and Compilation in ASP.NET 2.0</span></span>](https://msdn.microsoft.com/magazine/cc163675.aspx)
- [<span data-ttu-id="b91ab-274">ASP.NET でのプリコンパイル</span><span class="sxs-lookup"><span data-stu-id="b91ab-274">Precompilation in ASP.NET</span></span>](http://www.odetocode.com/Articles/417.aspx)
- [<span data-ttu-id="b91ab-275">ASP.NET のプリコンパイル済みサイトオプション</span><span class="sxs-lookup"><span data-stu-id="b91ab-275">Precompiled Site Options in ASP.NET</span></span>](http://www.dotnetperls.com/precompiled)

> [!div class="step-by-step"]
> <span data-ttu-id="b91ab-276">[前へ](logging-error-details-with-elmah-cs.md)
> [次へ](users-and-roles-on-the-production-website-cs.md)</span><span class="sxs-lookup"><span data-stu-id="b91ab-276">[Previous](logging-error-details-with-elmah-cs.md)
[Next](users-and-roles-on-the-production-website-cs.md)</span></span>

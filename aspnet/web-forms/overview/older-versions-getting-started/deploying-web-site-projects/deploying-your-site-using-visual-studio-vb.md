---
uid: web-forms/overview/older-versions-getting-started/deploying-web-site-projects/deploying-your-site-using-visual-studio-vb
title: Visual Studio を使用したサイトのデプロイ (VB) |Microsoft Docs
author: rick-anderson
description: Visual Studio には、web サイトを配置するためのツールが含まれています。 これらのツールの詳細については、このチュートリアルを参照してください。
ms.author: riande
ms.date: 04/01/2009
ms.assetid: 977105f3-7987-4e50-8be7-afb53b4ca28a
msc.legacyurl: /web-forms/overview/older-versions-getting-started/deploying-web-site-projects/deploying-your-site-using-visual-studio-vb
msc.type: authoredcontent
ms.openlocfilehash: 6c71e36a8a434947882cc767cd2f903ff6e8d422
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 03/06/2020
ms.locfileid: "78474622"
---
# <a name="deploying-your-site-using-visual-studio-vb"></a><span data-ttu-id="7c748-104">Visual Studio を使用してサイトを配置する (VB)</span><span class="sxs-lookup"><span data-stu-id="7c748-104">Deploying Your Site Using Visual Studio (VB)</span></span>

<span data-ttu-id="7c748-105">[Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="7c748-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="7c748-106">[コードのダウンロード](https://download.microsoft.com/download/4/5/F/45F815EC-8B0E-46D3-9FB8-2DC015CCA306/ASPNET_Hosting_Tutorial_04_VB.zip)または[PDF のダウンロード](https://download.microsoft.com/download/E/8/9/E8920AE6-D441-41A7-8A77-9EF8FF970D8B/aspnet_tutorial04_DeployingViaVS_vb.pdf)</span><span class="sxs-lookup"><span data-stu-id="7c748-106">[Download Code](https://download.microsoft.com/download/4/5/F/45F815EC-8B0E-46D3-9FB8-2DC015CCA306/ASPNET_Hosting_Tutorial_04_VB.zip) or [Download PDF](https://download.microsoft.com/download/E/8/9/E8920AE6-D441-41A7-8A77-9EF8FF970D8B/aspnet_tutorial04_DeployingViaVS_vb.pdf)</span></span>

> <span data-ttu-id="7c748-107">Visual Studio には、web サイトを配置するためのツールが含まれています。</span><span class="sxs-lookup"><span data-stu-id="7c748-107">Visual Studio includes tools for deploying a website.</span></span> <span data-ttu-id="7c748-108">これらのツールの詳細については、このチュートリアルを参照してください。</span><span class="sxs-lookup"><span data-stu-id="7c748-108">Learn more about these tools in this tutorial.</span></span>

## <a name="introduction"></a><span data-ttu-id="7c748-109">はじめに</span><span class="sxs-lookup"><span data-stu-id="7c748-109">Introduction</span></span>

<span data-ttu-id="7c748-110">前のチュートリアルでは、単純な ASP.NET web アプリケーションを web ホストプロバイダーに展開する方法について説明しました。</span><span class="sxs-lookup"><span data-stu-id="7c748-110">The preceding tutorial looked at how to deploy a simple ASP.NET web application to a web host provider.</span></span> <span data-ttu-id="7c748-111">具体的には、FileZilla のような FTP クライアントを使用して、開発環境から運用環境に必要なファイルを転送する方法を説明しました。</span><span class="sxs-lookup"><span data-stu-id="7c748-111">Specifically, the tutorial showed how to use an FTP client like FileZilla to transfer the necessary files from the development environment to the production environment.</span></span> <span data-ttu-id="7c748-112">また、Visual Studio には、web ホストプロバイダーへの配置を容易にする組み込みのツールも用意されています。</span><span class="sxs-lookup"><span data-stu-id="7c748-112">Visual Studio also offers built-in tools to facilitate deployment to a web host provider.</span></span> <span data-ttu-id="7c748-113">このチュートリアルでは、Web サイトのコピーツールの2つについて検討します。このツールでは、FTP または FrontPage Server Extensions を使用してリモート web サーバーとの間でファイルを移動できます。発行ツール。 web サイト全体を指定した場所にコピーします。</span><span class="sxs-lookup"><span data-stu-id="7c748-113">This tutorial examines two of these tools: the Copy Web Site tool, where you can move files to and from a remote web server using FTP or FrontPage Server Extensions; and the Publish tool, which copies the entire website to a specified location.</span></span>

> [!NOTE]
> <span data-ttu-id="7c748-114">Visual Studio で提供されるその他の配置関連ツールには、 [Web セットアッププロジェクト](https://msdn.microsoft.com/library/wx3b589t.aspx)および[web 配置プロジェクト](https://www.microsoft.com/downloads/details.aspx?FamilyId=0AA30AE8-C73B-4BDD-BB1B-FE697256C459&amp;displaylang=en)アドインが含まれます。</span><span class="sxs-lookup"><span data-stu-id="7c748-114">Other deployment-related tools offered by Visual Studio include [Web Setup Projects](https://msdn.microsoft.com/library/wx3b589t.aspx) and [Web Deployment Projects](https://www.microsoft.com/downloads/details.aspx?FamilyId=0AA30AE8-C73B-4BDD-BB1B-FE697256C459&amp;displaylang=en) Add-In.</span></span> <span data-ttu-id="7c748-115">Web セットアッププロジェクトでは、web サイトのコンテンツと構成情報を1つの MSI ファイルにパッケージ化します。</span><span class="sxs-lookup"><span data-stu-id="7c748-115">Web Setup Projects package a website's contents and configuration information into a single MSI file.</span></span> <span data-ttu-id="7c748-116">このオプションは、イントラネット内に展開されている web サイトや、お客様が独自の web サーバーにインストールした事前パッケージ web アプリケーションを販売する企業にとって最も役立ちます。</span><span class="sxs-lookup"><span data-stu-id="7c748-116">This option is most useful for websites that are deployed within an intranet or for companies that sell a pre-packaged web application that customers install on their own web servers.</span></span> <span data-ttu-id="7c748-117">Web 配置プロジェクトアドインは、開発環境と運用環境のビルド間の構成の違いを簡単に指定できる Visual Studio アドインです。</span><span class="sxs-lookup"><span data-stu-id="7c748-117">The Web Deployment Projects Add-In is a Visual Studio Add-In that facilitates specifying configuration differences between builds for development environments and production environments.</span></span> <span data-ttu-id="7c748-118">このチュートリアルシリーズでは、Web セットアッププロジェクトについては説明しません。Web 配置プロジェクトの概要については、「[*開発と運用のチュートリアルの間の一般的な構成の違い*](common-configuration-differences-between-development-and-production-vb.md)」をお寄せください。</span><span class="sxs-lookup"><span data-stu-id="7c748-118">Web Setup Projects are not discussed in this tutorial series; Web Deployment Projects are summarized in the [*Common Configuration Differences Between Development and Production*](common-configuration-differences-between-development-and-production-vb.md) tutorial.</span></span>

## <a name="deploying-your-site-using-the-copy-web-site-tool"></a><span data-ttu-id="7c748-119">Web サイトのコピーツールを使用したサイトのデプロイ</span><span class="sxs-lookup"><span data-stu-id="7c748-119">Deploying Your Site Using the Copy Web Site Tool</span></span>

<span data-ttu-id="7c748-120">Visual Studio の Web サイトのコピーツールは、スタンドアロン FTP クライアントの機能に似ています。</span><span class="sxs-lookup"><span data-stu-id="7c748-120">Visual Studio's Copy Web Site tool is similar in functionality to a stand-alone FTP client.</span></span> <span data-ttu-id="7c748-121">簡単に言うと、Web サイトのコピーツールを使用すると、FTP または FrontPage Server Extensions 経由でリモート web サイトに接続できます。</span><span class="sxs-lookup"><span data-stu-id="7c748-121">In a nutshell, the Copy Web Site tool allows you to connect to a remote web site through FTP or FrontPage Server Extensions.</span></span> <span data-ttu-id="7c748-122">FileZilla のユーザーインターフェイスと同様に、Web サイトのコピーのユーザーインターフェイスは2つのペインで構成されます。左側のウィンドウにはローカルファイルが一覧表示され、右側のペインには移行先サーバー上のファイルが一覧表示されます。</span><span class="sxs-lookup"><span data-stu-id="7c748-122">Similar to FileZilla's user interface, the Copy Web Site user interface consists of two panes: the left pane lists the local files while the right pane lists those files on the destination server.</span></span>

> [!NOTE]
> <span data-ttu-id="7c748-123">Web サイトのコピーツールは、Web サイトプロジェクトでのみ使用できます。</span><span class="sxs-lookup"><span data-stu-id="7c748-123">The Copy Web Site tool is only available for Web Site Projects.</span></span> <span data-ttu-id="7c748-124">Web アプリケーションプロジェクトを使用する場合、Visual Studio はこのツールを提供します。</span><span class="sxs-lookup"><span data-stu-id="7c748-124">Visual Studio does offer this tool when you are working with a Web Application Project.</span></span>

<span data-ttu-id="7c748-125">Web サイトのコピーツールを使用して、本レビューアプリケーションを運用環境に発行する方法を見てみましょう。</span><span class="sxs-lookup"><span data-stu-id="7c748-125">Let's take a look at using the Copy Web Site tool to publish the Book Review application to production.</span></span> <span data-ttu-id="7c748-126">Web サイトのコピーツールは、Web サイトプロジェクトモデルを使用するプロジェクトでのみ機能するので、BookReviewsWSP プロジェクトでこのツールを使用してのみ調べることができます。</span><span class="sxs-lookup"><span data-stu-id="7c748-126">Because the Copy Web Site tool only works with projects that use the Web Site Project model we can only examine using this tool with the BookReviewsWSP project.</span></span> <span data-ttu-id="7c748-127">そのプロジェクトを開きます。</span><span class="sxs-lookup"><span data-stu-id="7c748-127">Open that project.</span></span>

<span data-ttu-id="7c748-128">ソリューションエクスプローラーの [Web サイトのコピー] アイコンをクリックして、Web サイトのコピーツールプロジェクトを起動します (このアイコンは図1で丸で囲まれています)。または、[Web サイト] メニューの [Web サイトのコピー] オプションを選択することもできます。</span><span class="sxs-lookup"><span data-stu-id="7c748-128">Launch the Copy Web Site tool project by clicking the Copy Web Site icon in the Solution Explorer (this icon is circled in Figure 1); alternatively, you can select the Copy Web Site option from the Website menu.</span></span> <span data-ttu-id="7c748-129">どちらの方法でも、図1に示す Web サイトのコピーのユーザーインターフェイスが起動されます。リモートサーバーにまだ接続していないため、図1の左側のウィンドウだけが設定されます。</span><span class="sxs-lookup"><span data-stu-id="7c748-129">Either approach launches the Copy Web Site user interface shown in Figure 1; only the left pane in Figure 1 is populated because we have yet to connect to a remote server.</span></span>

<span data-ttu-id="7c748-130">[Web サイトのコピーツールのユーザーインターフェイスの ![は、2つのペインに分割されています。](deploying-your-site-using-visual-studio-vb/_static/image2.png)](deploying-your-site-using-visual-studio-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="7c748-130">[![The Copy Web Site Tool's User Interface is Divided Into Two Panes](deploying-your-site-using-visual-studio-vb/_static/image2.png)](deploying-your-site-using-visual-studio-vb/_static/image1.png)</span></span>

<span data-ttu-id="7c748-131">**図 1**: Web サイトのコピーツールのユーザーインターフェイスが2つのペインに分割されている ([クリックしてフルサイズのイメージを表示する](deploying-your-site-using-visual-studio-vb/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="7c748-131">**Figure 1**: The Copy Web Site Tool's User Interface is Divided Into Two Panes ([Click to view full-size image](deploying-your-site-using-visual-studio-vb/_static/image3.png))</span></span>

<span data-ttu-id="7c748-132">サイトをデプロイするには、最初に web ホストプロバイダーに接続する必要があります。</span><span class="sxs-lookup"><span data-stu-id="7c748-132">In order to deploy our site we need to first connect to the web host provider.</span></span> <span data-ttu-id="7c748-133">Web サイトのコピーのユーザーインターフェイスの上部にある [接続] ボタンをクリックします。</span><span class="sxs-lookup"><span data-stu-id="7c748-133">Click the Connect button at the top of the Copy Web Site user interface.</span></span> <span data-ttu-id="7c748-134">これにより、図2に示す [Web サイトを開く] ダイアログボックスが表示されます。</span><span class="sxs-lookup"><span data-stu-id="7c748-134">This displays the Open Web Site dialog box shown in Figure 2.</span></span>

<span data-ttu-id="7c748-135">左の4つのオプションのいずれかを選択して、目的の web サイトに接続できます。</span><span class="sxs-lookup"><span data-stu-id="7c748-135">You can connect to the destination website by selecting one of the four options from the left:</span></span>

- <span data-ttu-id="7c748-136">**[ファイルシステム]** -コンピューターからアクセスできるフォルダーまたはネットワーク共有にサイトを展開するには、このチェックボックスをオンにします。</span><span class="sxs-lookup"><span data-stu-id="7c748-136">**File System** - select this to deploy your site to a folder or network share accessible from your computer.</span></span>
- <span data-ttu-id="7c748-137">**[ローカル iis]** : コンピューターにインストールされている IIS web サーバーにサイトを展開する場合に、このオプションを使用します。</span><span class="sxs-lookup"><span data-stu-id="7c748-137">**Local IIS** - use this option to deploy the site to the IIS web server installed on your computer.</span></span>
- <span data-ttu-id="7c748-138">**Ftp サイト**-ftp を使用してリモート web サイトに接続します。</span><span class="sxs-lookup"><span data-stu-id="7c748-138">**FTP Site** - connect to a remote web site using FTP.</span></span>
- <span data-ttu-id="7c748-139">**リモートサイト**-FrontPage Server Extensions を使用してリモート web サイトに接続します。</span><span class="sxs-lookup"><span data-stu-id="7c748-139">**Remote Site** - connect to a remote website using FrontPage Server Extensions.</span></span>

<span data-ttu-id="7c748-140">ほとんどの web ホストプロバイダーは FTP をサポートしますが、FrontPage Server 拡張機能のサポートはあまりありません。</span><span class="sxs-lookup"><span data-stu-id="7c748-140">Most web host providers support FTP, but fewer offer FrontPage Server Extension support.</span></span> <span data-ttu-id="7c748-141">そのため、[FTP サイト] オプションを選択し、図2に示すように接続情報を入力しました。</span><span class="sxs-lookup"><span data-stu-id="7c748-141">For that reason, I've selected the FTP Site option and then entered the connection information as shown in Figure 2.</span></span>

<span data-ttu-id="7c748-142">[送信先 Web サイトを指定 ![には](deploying-your-site-using-visual-studio-vb/_static/image5.png)](deploying-your-site-using-visual-studio-vb/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="7c748-142">[![Specify the Destination Website](deploying-your-site-using-visual-studio-vb/_static/image5.png)](deploying-your-site-using-visual-studio-vb/_static/image4.png)</span></span>

<span data-ttu-id="7c748-143">**図 2**: 接続先の web サイトを指定[する (クリックすると、フルサイズの画像が表示](deploying-your-site-using-visual-studio-vb/_static/image6.png)されます)</span><span class="sxs-lookup"><span data-stu-id="7c748-143">**Figure 2**: Specify the Destination Website ([Click to view full-size image](deploying-your-site-using-visual-studio-vb/_static/image6.png))</span></span>

<span data-ttu-id="7c748-144">接続後、Web サイトのコピーツールでは、リモートサイトのファイルが右ペインに読み込まれ、各ファイルの状態 (新規、削除済み、変更済み、または変更されていない) が示されます。</span><span class="sxs-lookup"><span data-stu-id="7c748-144">After you connect, the Copy Web Site tool loads the files at the remote site in the right pane and indicates the status of each file: New, Deleted, Changed, or Unchanged.</span></span> <span data-ttu-id="7c748-145">ローカルサイトからリモートサイトにファイルをコピーしたり、その逆をコピーしたりできます。</span><span class="sxs-lookup"><span data-stu-id="7c748-145">You can copy a file from the local site to the remote site, or vice-a-versa.</span></span>

<span data-ttu-id="7c748-146">BookReviewsWSP プロジェクトに新しいページを追加し、それをデプロイして、Web サイトのコピーツールが動作することを確認しましょう。</span><span class="sxs-lookup"><span data-stu-id="7c748-146">Let's add a new page to the BookReviewsWSP project and then deploy it so that we can see the Copy Web Site tool in action.</span></span> <span data-ttu-id="7c748-147">`Privacy.aspx`という名前のルートディレクトリで、Visual Studio で新しい ASP.NET ページを作成します。</span><span class="sxs-lookup"><span data-stu-id="7c748-147">Create a new ASP.NET page in Visual Studio in the root directory named `Privacy.aspx`.</span></span> <span data-ttu-id="7c748-148">ページで `Site.master` マスターページを使用し、サイトのプライバシーポリシーをこのページに追加します。</span><span class="sxs-lookup"><span data-stu-id="7c748-148">Have the page use the master page `Site.master` and add your site's privacy policy to this page.</span></span> <span data-ttu-id="7c748-149">図3は、このページが作成された後の Visual Studio を示しています。</span><span class="sxs-lookup"><span data-stu-id="7c748-149">Figure 3 shows Visual Studio after this page has been created.</span></span>

<span data-ttu-id="7c748-150">[&gt;&lt;コードという名前の新しいページを Web サイトのルートフォルダーに追加 ![ます&gt;&lt;。](deploying-your-site-using-visual-studio-vb/_static/image8.png)](deploying-your-site-using-visual-studio-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="7c748-150">[![Add a New Page Named &lt;code&gt;Privacy.aspx&lt;/code&gt; to the Website's Root Folder](deploying-your-site-using-visual-studio-vb/_static/image8.png)](deploying-your-site-using-visual-studio-vb/_static/image7.png)</span></span>

<span data-ttu-id="7c748-151">**図 3**: `Privacy.aspx` という名前の新しいページを web サイトのルートフォルダーに追加する ([クリックすると、フルサイズの画像が表示](deploying-your-site-using-visual-studio-vb/_static/image9.png)されます)</span><span class="sxs-lookup"><span data-stu-id="7c748-151">**Figure 3**: Add a New Page Named `Privacy.aspx` to the Website's Root Folder ([Click to view full-size image](deploying-your-site-using-visual-studio-vb/_static/image9.png))</span></span>

<span data-ttu-id="7c748-152">次に、[Web サイトのコピー] ユーザーインターフェイスに戻ります。</span><span class="sxs-lookup"><span data-stu-id="7c748-152">Next, return to the Copy Web Site user interface.</span></span> <span data-ttu-id="7c748-153">図4に示すように、左側のウィンドウに新しいファイル `Policy.aspx` と `Policy.aspx.vb`が含まれるようになりました。</span><span class="sxs-lookup"><span data-stu-id="7c748-153">As Figure 4 shows, the left pane now includes the new files - `Policy.aspx` and `Policy.aspx.vb`.</span></span> <span data-ttu-id="7c748-154">さらに、これらのファイルは矢印アイコンでマークされ、[新規] の状態になっています。これは、これらがローカルサイトに存在するがリモートサイトには存在しないことを示しています。</span><span class="sxs-lookup"><span data-stu-id="7c748-154">What's more, these files are marked with an arrow icon and a Status of New, indicating that they exist on the local site but not on the remote site.</span></span>

<span data-ttu-id="7c748-155">[![Web サイトのコピーツールには、新しい &lt;コード&gt;のプライバシーに関する情報が含まれています。このページの左側のウィンドウには、コードが含まれて&gt;&lt;います。](deploying-your-site-using-visual-studio-vb/_static/image11.png)](deploying-your-site-using-visual-studio-vb/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="7c748-155">[![The Copy Web Site Tool Includes the New &lt;code&gt;Privacy.aspx&lt;/code&gt; Page in its Left Pane](deploying-your-site-using-visual-studio-vb/_static/image11.png)](deploying-your-site-using-visual-studio-vb/_static/image10.png)</span></span>

<span data-ttu-id="7c748-156">**図 4**: Web サイトのコピーツールでは、新しい `Privacy.aspx` ページが左側のウィンドウに表示されます ([クリックすると、フルサイズの画像が表示](deploying-your-site-using-visual-studio-vb/_static/image12.png)されます)</span><span class="sxs-lookup"><span data-stu-id="7c748-156">**Figure 4**: The Copy Web Site Tool Includes the New `Privacy.aspx` Page in its Left Pane ([Click to view full-size image](deploying-your-site-using-visual-studio-vb/_static/image12.png))</span></span>

<span data-ttu-id="7c748-157">新しいファイルを展開するには、それらを選択し、矢印アイコンをクリックしてリモートサイトに転送します。</span><span class="sxs-lookup"><span data-stu-id="7c748-157">To deploy the new files select them and then click the arrow icon to transfer them to the remote site.</span></span> <span data-ttu-id="7c748-158">転送が完了すると `Policy.aspx` と、状態が変更されていないローカルとリモートの両方のサイトに `Policy.aspx.vb` ファイルが存在します。</span><span class="sxs-lookup"><span data-stu-id="7c748-158">After the transfer completes the `Policy.aspx` and `Policy.aspx.vb` files exist on both the local and remote sites with the status Unchanged.</span></span>

<span data-ttu-id="7c748-159">Web サイトのコピーツールでは、新しいファイルの一覧表示と共に、ローカルサイトとリモートサイトで異なるファイルが強調表示されます。</span><span class="sxs-lookup"><span data-stu-id="7c748-159">Along with listing new files, the Copy Web Site tool highlights any files that differ between the local and remote sites.</span></span> <span data-ttu-id="7c748-160">実際の動作を確認するには、[`Privacy.aspx`] ページに戻り、プライバシーポリシーにいくつかの単語を追加します。</span><span class="sxs-lookup"><span data-stu-id="7c748-160">To see this in action, return to the `Privacy.aspx` page and add a few more words to the privacy policy.</span></span> <span data-ttu-id="7c748-161">ページを保存し、Web サイトのコピーツールに戻ります。</span><span class="sxs-lookup"><span data-stu-id="7c748-161">Save the page and then return to the Copy Web Site tool.</span></span> <span data-ttu-id="7c748-162">図5に示すように、左側のウィンドウの [`Privacy.aspx`] ページには、リモートサイトと同期していないことを示す [変更] という状態があります。</span><span class="sxs-lookup"><span data-stu-id="7c748-162">As Figure 5 shows, the `Privacy.aspx` page in the left pane has a status of Changed indicating that it is out of sync with the remote site.</span></span>

<span data-ttu-id="7c748-163">[Web サイトのコピーツールを ![と、&lt;コード&gt;のコード&gt; ページが変更されたことを示し&lt;ます。](deploying-your-site-using-visual-studio-vb/_static/image14.png)](deploying-your-site-using-visual-studio-vb/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="7c748-163">[![The Copy Web Site Tool Indicates that the &lt;code&gt;Privacy.aspx&lt;/code&gt; Page has been Changed](deploying-your-site-using-visual-studio-vb/_static/image14.png)](deploying-your-site-using-visual-studio-vb/_static/image13.png)</span></span>

<span data-ttu-id="7c748-164">**図 5**: Web サイトのコピーツールは、`Privacy.aspx` ページが変更されたことを示します ([クリックすると、フルサイズの画像が表示](deploying-your-site-using-visual-studio-vb/_static/image15.png)されます)</span><span class="sxs-lookup"><span data-stu-id="7c748-164">**Figure 5**: The Copy Web Site Tool Indicates that the `Privacy.aspx` Page has been Changed ([Click to view full-size image](deploying-your-site-using-visual-studio-vb/_static/image15.png))</span></span>

<span data-ttu-id="7c748-165">Web サイトのコピーツールは、最後のコピー操作以降にファイルが削除されたかどうかも示します。</span><span class="sxs-lookup"><span data-stu-id="7c748-165">The Copy Web Site tool also indicates if a file has been deleted since the last copy operation.</span></span> <span data-ttu-id="7c748-166">ローカルプロジェクトから `Privacy.aspx` を削除し、Web サイトのコピーツールを更新します。</span><span class="sxs-lookup"><span data-stu-id="7c748-166">Delete the `Privacy.aspx` from the local project and refresh the Copy Web Site tool.</span></span> <span data-ttu-id="7c748-167">`Privacy.aspx` および `Privacy.aspx.vb` ファイルは左側のウィンドウに表示されたままですが、最後のコピー操作以降に削除されたことを示す状態が削除されています。</span><span class="sxs-lookup"><span data-stu-id="7c748-167">The `Privacy.aspx` and `Privacy.aspx.vb` files remain listed in the left pane, but have a Deleted status indicating that they have been removed since the last copy operation.</span></span>

## <a name="publishing-a-web-application"></a><span data-ttu-id="7c748-168">Web アプリケーションの発行</span><span class="sxs-lookup"><span data-stu-id="7c748-168">Publishing a Web Application</span></span>

<span data-ttu-id="7c748-169">Visual Studio 内から web アプリケーションを配置するもう1つの方法は、[ビルド] メニューからアクセスできる [発行] オプションを使用することです。</span><span class="sxs-lookup"><span data-stu-id="7c748-169">Another way to deploy your web application from within Visual Studio is to use the Publish option, which is accessible via the Build menu.</span></span> <span data-ttu-id="7c748-170">Publish オプションは、アプリケーションを明示的にコンパイルし、必要なすべてのファイルを指定されたリモートサイトにコピーします。</span><span class="sxs-lookup"><span data-stu-id="7c748-170">The Publish option explicitly compiles the application and then copies all of the necessary files up to the specified remote site.</span></span> <span data-ttu-id="7c748-171">後で説明するように、Publish オプションは Web サイトのコピーツールよりも無愛想です。</span><span class="sxs-lookup"><span data-stu-id="7c748-171">As we'll see shortly, the Publish option is more blunt than the Copy Web Site tool.</span></span> <span data-ttu-id="7c748-172">Web サイトのコピーツールを使用すると、ローカルサイトおよびリモートサイト上のファイルを確認し、必要に応じて個々のファイルをアップロードまたはダウンロードできるようになります。また、[発行] オプションを使用すると、web アプリケーション全体がデプロイされます。</span><span class="sxs-lookup"><span data-stu-id="7c748-172">Whereas the Copy Web Site tool lets you examine the files on the local and remote sites and permits you to upload or download individual files as needed, the Publish option deploys the entire web application.</span></span>

<span data-ttu-id="7c748-173">必要なすべてのファイルを指定されたリモートサイトにコピーするだけでなく、[発行] オプションを選択すると、アプリケーションも明示的にコンパイルされます。</span><span class="sxs-lookup"><span data-stu-id="7c748-173">In addition to copying all of the needed files to the specified remote site, the Publish option also explicitly compiles the application.</span></span> <span data-ttu-id="7c748-174">Web アプリケーションプロジェクトを明示的にコンパイルする必要がある場合は、Web アプリケーションプロジェクトで [発行] オプションが使用可能であることを意外に考える必要があります。</span><span class="sxs-lookup"><span data-stu-id="7c748-174">Given that Web Application Projects need to be explicitly compiled it should come as no surprise that the Publish option is available for Web Application Projects.</span></span> <span data-ttu-id="7c748-175">少し驚くかもしれませんが、Web サイトプロジェクトで [発行] オプションを使用することもできます。</span><span class="sxs-lookup"><span data-stu-id="7c748-175">What may be a bit surprising is that the Publish option is also available for Web Site Projects.</span></span> <span data-ttu-id="7c748-176">「[*配置する必要があるファイルの決定*](determining-what-files-need-to-be-deployed-vb.md)」チュートリアルで説明したように、Web サイトプロジェクトは、*事前コンパイル*と呼ばれるプロセスを使用して明示的にコンパイルできます。</span><span class="sxs-lookup"><span data-stu-id="7c748-176">As noted in the [*Determining What Files Need to Be Deployed*](determining-what-files-need-to-be-deployed-vb.md) tutorial, Web Site Projects can be explicitly compiled through a process referred to as *pre-compilation*.</span></span> <span data-ttu-id="7c748-177">このチュートリアルでは、Web アプリケーションプロジェクトで発行オプションを使用する方法について説明します。今後のチュートリアルでは、事前コンパイルについて説明します。この時点で、Web サイトプロジェクトで発行オプションを使用する方法を確認します。</span><span class="sxs-lookup"><span data-stu-id="7c748-177">This tutorial focuses on using the Publish option with Web Application Projects; a future tutorial will explore pre-compilation, at which point we'll return to look at using the Publish option with Web Site Projects.</span></span>

> [!NOTE]
> <span data-ttu-id="7c748-178">[発行] オプションは、Web サイトプロジェクトと Web アプリケーションプロジェクトの両方で Visual Studio で使用できますが、Visual Web Developer では、Web アプリケーションプロジェクトの [発行] オプションのみが提供されます。</span><span class="sxs-lookup"><span data-stu-id="7c748-178">While the Publish option is available in Visual Studio for both Web Site Projects and Web Application Projects, Visual Web Developer only offers the Publish option for Web Application Projects.</span></span>

<span data-ttu-id="7c748-179">Publish オプションを使用して、書籍レビューアプリケーションをデプロイする方法を見てみましょう。</span><span class="sxs-lookup"><span data-stu-id="7c748-179">Let's look at deploying the Book Reviews application using the Publish option.</span></span> <span data-ttu-id="7c748-180">まず、Visual Studio で BookReviewsWAP (Web アプリケーションプロジェクト) を開きます。</span><span class="sxs-lookup"><span data-stu-id="7c748-180">Start by opening BookReviewsWAP (the Web Application Project) in Visual Studio.</span></span> <span data-ttu-id="7c748-181">[発行] メニューで、[Build BookReviewsWAP] プロジェクトを選択します。</span><span class="sxs-lookup"><span data-stu-id="7c748-181">From the Publish menu choose the Build BookReviewsWAP project.</span></span> <span data-ttu-id="7c748-182">これにより、他の構成オプションのように、ターゲットの場所を入力するよう求めるダイアログボックスが表示されます (図6を参照)。</span><span class="sxs-lookup"><span data-stu-id="7c748-182">This brings up a dialog box that prompts for the target location, among other configuration options (see Figure 6).</span></span> <span data-ttu-id="7c748-183">Web サイトのコピーツールと同様に、ローカルフォルダー、IIS 上のローカル web サイト、FrontPage Server Extensions をサポートするリモート web サイト、または FTP サーバーのアドレスを指す場所を入力できます。</span><span class="sxs-lookup"><span data-stu-id="7c748-183">Much like with the Copy Web Site tool you can enter a location that points to a local folder, a local website on IIS, a remote website that supports FrontPage Server Extensions, or an FTP server address.</span></span> <span data-ttu-id="7c748-184">リモート web サーバー上のファイルを、展開されたファイルに置き換えるか、または発行前にリモートサイト上のすべてのコンテンツを削除するかを選択できます。</span><span class="sxs-lookup"><span data-stu-id="7c748-184">You can choose whether to replace the files on the remote web server with the deployed files or to delete all of the content on the remote site before publishing.</span></span> <span data-ttu-id="7c748-185">また、次の項目をコピーするかどうかを指定することもできます。</span><span class="sxs-lookup"><span data-stu-id="7c748-185">You can also specify whether to copy:</span></span>

- <span data-ttu-id="7c748-186">プロジェクト内のファイルだけがアプリケーションを実行する必要があります。これにより、不要なソースコードおよびプロジェクト関連ファイルが除外されます。</span><span class="sxs-lookup"><span data-stu-id="7c748-186">Only the files in the project needed to run the application, which omits the unneeded source code and project-related files.</span></span>
- <span data-ttu-id="7c748-187">すべてのプロジェクトファイル。ソースコードファイルと、ソリューションファイルのような Visual Studio プロジェクトファイルが含まれます。</span><span class="sxs-lookup"><span data-stu-id="7c748-187">All project files, which includes the source code files and Visual Studio project files like the Solution file.</span></span>
- <span data-ttu-id="7c748-188">ソースプロジェクトフォルダー内のすべてのファイル。ソースプロジェクトフォルダー内のすべてのファイルが、プロジェクトに含まれているかどうかに関係なくコピーされます。</span><span class="sxs-lookup"><span data-stu-id="7c748-188">All files in the source project folder, which copies all files in the source project folder regardless of whether they're included in the project.</span></span>

<span data-ttu-id="7c748-189">`App_Data` フォルダーの内容をアップロードするオプションもあります。</span><span class="sxs-lookup"><span data-stu-id="7c748-189">There's also an option to upload the contents of the `App_Data` folder.</span></span>

<span data-ttu-id="7c748-190">[送信先 Web サイトを指定 ![には](deploying-your-site-using-visual-studio-vb/_static/image17.png)](deploying-your-site-using-visual-studio-vb/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="7c748-190">[![Specify the Destination Website](deploying-your-site-using-visual-studio-vb/_static/image17.png)](deploying-your-site-using-visual-studio-vb/_static/image16.png)</span></span>

<span data-ttu-id="7c748-191">**図 6**: 接続先の web サイトを指定[する (クリックすると、フルサイズの画像が表示](deploying-your-site-using-visual-studio-vb/_static/image18.png)されます)</span><span class="sxs-lookup"><span data-stu-id="7c748-191">**Figure 6**: Specify the Destination Website ([Click to view full-size image](deploying-your-site-using-visual-studio-vb/_static/image18.png))</span></span>

<span data-ttu-id="7c748-192">Book Review アプリケーションの場合、リモートサイトには、Web サイトのコピーツールを使用して BookReviewsWSP プロジェクトをコピーするときに配置されたファイルが含まれています。</span><span class="sxs-lookup"><span data-stu-id="7c748-192">For the Book Review application the remote site contains the files deployed when copying the BookReviewsWSP project via the Copy Web Site tool.</span></span> <span data-ttu-id="7c748-193">そのため、既存のコンテンツをすべて削除して、Publish オプションを開始してみましょう。</span><span class="sxs-lookup"><span data-stu-id="7c748-193">Therefore, let's have the Publish option start by deleting all existing content.</span></span> <span data-ttu-id="7c748-194">また、不要なソースコードやプロジェクトファイルを使用して運用環境を乱雑にするのではなく、必要なファイルをコピーするだけです。</span><span class="sxs-lookup"><span data-stu-id="7c748-194">Also, let's just copy the necessary files rather than cluttering the production environment with unneeded source code and project files.</span></span> <span data-ttu-id="7c748-195">これらのオプションを指定したら、[発行] ボタンをクリックします。</span><span class="sxs-lookup"><span data-stu-id="7c748-195">After specifying these options, click the Publish button.</span></span> <span data-ttu-id="7c748-196">次の数秒で、Visual Studio は必要なファイルを変換先サイトに配置し、進行状況を出力ウィンドウに表示します。</span><span class="sxs-lookup"><span data-stu-id="7c748-196">Over the next several seconds Visual Studio will deploy the necessary files to the destination site, displaying its progress in the Output window.</span></span>

<span data-ttu-id="7c748-197">図7に、発行操作が完了した後の FTP サイト上のファイルを示します。</span><span class="sxs-lookup"><span data-stu-id="7c748-197">Figure 7 shows the files on the FTP site after the Publish operation has completed.</span></span> <span data-ttu-id="7c748-198">マークアップページと、必要なサーバー側およびクライアント側のサポートファイルのみがアップロードされていることに注意してください。</span><span class="sxs-lookup"><span data-stu-id="7c748-198">Note that only the markup pages and the necessary sever- and client-side support files have been uploaded.</span></span>

<span data-ttu-id="7c748-199">[必要なファイルのみが運用環境に発行された ![](deploying-your-site-using-visual-studio-vb/_static/image20.png)](deploying-your-site-using-visual-studio-vb/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="7c748-199">[![Only the Needed Files Were Published to the Production Environment](deploying-your-site-using-visual-studio-vb/_static/image20.png)](deploying-your-site-using-visual-studio-vb/_static/image19.png)</span></span>

<span data-ttu-id="7c748-200">**図 7**: 必要なファイルのみが運用環境に発行された ([クリックしてフルサイズのイメージを表示する](deploying-your-site-using-visual-studio-vb/_static/image21.png))</span><span class="sxs-lookup"><span data-stu-id="7c748-200">**Figure 7**: Only the Needed Files Were Published to the Production Environment ([Click to view full-size image](deploying-your-site-using-visual-studio-vb/_static/image21.png))</span></span>

<span data-ttu-id="7c748-201">Publish オプションは、Web サイトのコピーツールよりも微妙なツールです。</span><span class="sxs-lookup"><span data-stu-id="7c748-201">The Publish option is a less nuanced tool than the Copy Web Site tool.</span></span> <span data-ttu-id="7c748-202">Web サイトのコピーツールを使用すると、ローカルサイトおよびリモートサイト上のファイルを検査し、それらがどのように異なるかを確認することができます。発行オプションでは、そのようなインターフェイスは提供されません。</span><span class="sxs-lookup"><span data-stu-id="7c748-202">Whereas the Copy Web Site tool allows you to inspect the files on the local and remote sites and see how they differ, the Publish option provides no such interface.</span></span> <span data-ttu-id="7c748-203">さらに、Web サイトのコピーツールを使用すると、個々のファイルをアップロードまたは削除することができます。</span><span class="sxs-lookup"><span data-stu-id="7c748-203">Moreover, the Copy Web Site tool enables you to make one-off changes, uploading or deleting individual files.</span></span> <span data-ttu-id="7c748-204">Publish オプションでは、このような細かい制御が許可されていません。代わりに、アプリケーション*全体*が発行されます。</span><span class="sxs-lookup"><span data-stu-id="7c748-204">The Publish option does not allow such fine-grained control; instead, it publishes the *entire* application.</span></span> <span data-ttu-id="7c748-205">この動作には長所と短所があります。</span><span class="sxs-lookup"><span data-stu-id="7c748-205">This behavior has its pros and cons.</span></span> <span data-ttu-id="7c748-206">プラス側では、発行オプションを使用するときに、重要なファイルのアップロードを忘れることはありません。</span><span class="sxs-lookup"><span data-stu-id="7c748-206">On the plus side, you know when using the Publish option you won't be forgetting to upload an important file.</span></span> <span data-ttu-id="7c748-207">ただし、非常に大規模な web サイトに小さな変更を加えた場合、発行オプションを使用すると、変更されたページを更新することはできず、Visual Studio によってサイト全体が展開されるまで待機する必要があります。</span><span class="sxs-lookup"><span data-stu-id="7c748-207">But consider what happens if you have made a small change to a very large website - with the Publish option you cannot update that page or two that has been modified, but instead you must wait while Visual Studio deploys the entire site.</span></span>

<span data-ttu-id="7c748-208">運用環境と開発環境でコンテンツが異なる特定のファイルが存在することは珍しくありません。</span><span class="sxs-lookup"><span data-stu-id="7c748-208">It's not uncommon for there to be certain files whose content differs between the production and development environments.</span></span> <span data-ttu-id="7c748-209">キーの例としては、アプリケーションの構成ファイル `Web.config`があります。</span><span class="sxs-lookup"><span data-stu-id="7c748-209">A key example is the application's configuration file, `Web.config`.</span></span> <span data-ttu-id="7c748-210">発行オプションによって web アプリケーションファイルが無条件にコピーされるため、運用環境のカスタマイズされた構成ファイルは開発環境のバージョンで上書きされます。</span><span class="sxs-lookup"><span data-stu-id="7c748-210">Because the Publish option blindly copies the web application files it overwrites the production environment's customized configuration files with the version in the development environment.</span></span> <span data-ttu-id="7c748-211">以降のチュートリアルでは、このトピックについて詳しく説明し、このような違いが存在する場合に web アプリケーションをデプロイするためのヒントを提供します。</span><span class="sxs-lookup"><span data-stu-id="7c748-211">The subsequent tutorial explores this topic further and offers tips for deploying a web application when such differences exist.</span></span>

## <a name="summary"></a><span data-ttu-id="7c748-212">まとめ</span><span class="sxs-lookup"><span data-stu-id="7c748-212">Summary</span></span>

<span data-ttu-id="7c748-213">Web サイトを配置するには、必要なファイルを開発環境から運用環境にコピーする必要があります。</span><span class="sxs-lookup"><span data-stu-id="7c748-213">Deploying a website involves copying the necessary files from the development environment to the production environment.</span></span> <span data-ttu-id="7c748-214">前のチュートリアルでは、FileZilla のような FTP クライアントを使用してファイルを転送する方法を説明しました。</span><span class="sxs-lookup"><span data-stu-id="7c748-214">The previous tutorial showed how to transfer files using an FTP client like FileZilla.</span></span> <span data-ttu-id="7c748-215">このチュートリアルでは、Visual Studio の2つの配置ツール (Web サイトのコピーツールと [発行] オプション) を確認しています。</span><span class="sxs-lookup"><span data-stu-id="7c748-215">This tutorial examined two deployment tools in Visual Studio: the Copy Web Site tool and the Publish option.</span></span> <span data-ttu-id="7c748-216">Web サイトのコピーツールは、FTP クライアントに似ています。これは、ローカルコンピューター上のファイルと、2つのコンピューター間でファイルを簡単にアップロードまたはダウンロードできるように指定されたリモートコンピューターの2つのペインからなるインターフェイスがあることです。</span><span class="sxs-lookup"><span data-stu-id="7c748-216">The Copy Web Site tool is similar to an FTP client in that it has a two-paned interface listing the files on the local computer and a specified remote computer that makes it easy to upload or download files between the two computers.</span></span> <span data-ttu-id="7c748-217">Publish オプションは、プロジェクトを明示的にコンパイルし、指定された変換先にアプリケーション全体を配置する、より無愛想ツールです。</span><span class="sxs-lookup"><span data-stu-id="7c748-217">The Publish option is a more blunt tool that explicitly compiles the project and then deploys the entire application to the specified destination.</span></span>

<span data-ttu-id="7c748-218">プログラミングを楽しんでください。</span><span class="sxs-lookup"><span data-stu-id="7c748-218">Happy Programming!</span></span>

### <a name="further-reading"></a><span data-ttu-id="7c748-219">参考資料</span><span class="sxs-lookup"><span data-stu-id="7c748-219">Further Reading</span></span>

<span data-ttu-id="7c748-220">このチュートリアルで説明しているトピックの詳細については、次のリソースを参照してください。</span><span class="sxs-lookup"><span data-stu-id="7c748-220">For more information on the topics discussed in this tutorial, refer to the following resources:</span></span>

- [<span data-ttu-id="7c748-221">Web サイトのコピーツールを使用した Web サイトのコピー</span><span class="sxs-lookup"><span data-stu-id="7c748-221">Copying Web Site with the Copy Web Site Tool</span></span>](https://msdn.microsoft.com/library/1cc82atw.aspx)
- <span data-ttu-id="7c748-222">[操作方法: Web サイトのコピーツールを使用して Web サイトをデプロイ](../../../videos/how-do-i/how-do-i-deploy-a-web-site-using-the-copy-web-site-tool.md)する (ビデオ)</span><span class="sxs-lookup"><span data-stu-id="7c748-222">[How Do I: Deploy a Web Site Using the Copy Web Site Tool](../../../videos/how-do-i/how-do-i-deploy-a-web-site-using-the-copy-web-site-tool.md) (Video)</span></span>
- [<span data-ttu-id="7c748-223">方法: Web アプリケーションプロジェクトを発行する</span><span class="sxs-lookup"><span data-stu-id="7c748-223">How To: Publish Web Application Projects</span></span>](https://msdn.microsoft.com/library/aa983453.aspx)
- [<span data-ttu-id="7c748-224">方法: Web サイトを発行する</span><span class="sxs-lookup"><span data-stu-id="7c748-224">How To: Publish Web Sites</span></span>](https://msdn.microsoft.com/library/20yh9f1b.aspx)
- [<span data-ttu-id="7c748-225">Visual Studio でのセットアッププロジェクトと配置プロジェクト</span><span class="sxs-lookup"><span data-stu-id="7c748-225">Setup and Deployment Projects in Visual Studio</span></span>](https://msdn.microsoft.com/library/wx3b589t.aspx)

> [!div class="step-by-step"]
> <span data-ttu-id="7c748-226">[前へ](deploying-your-site-using-an-ftp-client-vb.md)
> [次へ](common-configuration-differences-between-development-and-production-vb.md)</span><span class="sxs-lookup"><span data-stu-id="7c748-226">[Previous](deploying-your-site-using-an-ftp-client-vb.md)
[Next](common-configuration-differences-between-development-and-production-vb.md)</span></span>

---
uid: web-forms/overview/older-versions-getting-started/deploying-web-site-projects/displaying-a-custom-error-page-vb
title: カスタム エラー ページ (VB) の表示 |Microsoft Docs
author: rick-anderson
description: ユーザーに表示される内容を ASP.NET web アプリケーションでランタイム エラーが発生します。 方法によって異なります web サイトの&lt;customErrors&gt;構成しています.。
ms.author: riande
ms.date: 06/09/2009
ms.assetid: 14873c5d-81a9-455b-bd71-30fb555583e7
msc.legacyurl: /web-forms/overview/older-versions-getting-started/deploying-web-site-projects/displaying-a-custom-error-page-vb
msc.type: authoredcontent
ms.openlocfilehash: 961959300f5481a297ed8a9a17131c076d1dfd69
ms.sourcegitcommit: 51b01b6ff8edde57d8243e4da28c9f1e7f1962b2
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 05/06/2019
ms.locfileid: "65116706"
---
# <a name="displaying-a-custom-error-page-vb"></a><span data-ttu-id="c9e5c-104">カスタム エラー ページを表示する (VB)</span><span class="sxs-lookup"><span data-stu-id="c9e5c-104">Displaying a Custom Error Page (VB)</span></span>

<span data-ttu-id="c9e5c-105">によって[Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="c9e5c-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="c9e5c-106">[コードのダウンロード](http://download.microsoft.com/download/1/0/C/10CC829F-A808-4302-97D3-59989B8F9C01/ASPNET_Hosting_Tutorial_11_VB.zip)または[PDF のダウンロード](http://download.microsoft.com/download/5/C/5/5C57DB8C-5DEA-4B3A-92CA-4405544D313B/aspnet_tutorial11_CustomErrors_vb.pdf)</span><span class="sxs-lookup"><span data-stu-id="c9e5c-106">[Download Code](http://download.microsoft.com/download/1/0/C/10CC829F-A808-4302-97D3-59989B8F9C01/ASPNET_Hosting_Tutorial_11_VB.zip) or [Download PDF](http://download.microsoft.com/download/5/C/5/5C57DB8C-5DEA-4B3A-92CA-4405544D313B/aspnet_tutorial11_CustomErrors_vb.pdf)</span></span>

> <span data-ttu-id="c9e5c-107">ユーザーに表示される内容を ASP.NET web アプリケーションでランタイム エラーが発生します。</span><span class="sxs-lookup"><span data-stu-id="c9e5c-107">What does the user see when a runtime error occurs in an ASP.NET web application?</span></span> <span data-ttu-id="c9e5c-108">方法によって異なります。 web サイトの&lt;customErrors&gt;構成します。</span><span class="sxs-lookup"><span data-stu-id="c9e5c-108">The answer depends on how the website's &lt;customErrors&gt; configuration.</span></span> <span data-ttu-id="c9e5c-109">既定では、ユーザーは、実行時エラーが発生したことを掲げ見苦しいの黄色い画面に表示されます。</span><span class="sxs-lookup"><span data-stu-id="c9e5c-109">By default, users are shown an unsightly yellow screen proclaiming that a runtime error has occurred.</span></span> <span data-ttu-id="c9e5c-110">このチュートリアルでは、サイトのルック アンド フィールに一致するカスタム エラー ページを表示、美しくて心地よいこれらの設定をカスタマイズする方法を示します。</span><span class="sxs-lookup"><span data-stu-id="c9e5c-110">This tutorial shows how to customize these settings to display an aesthetically-pleasing custom error page that matches your site's look and feel.</span></span>

## <a name="introduction"></a><span data-ttu-id="c9e5c-111">はじめに</span><span class="sxs-lookup"><span data-stu-id="c9e5c-111">Introduction</span></span>

<span data-ttu-id="c9e5c-112">理想の世界ではない実行時エラー。</span><span class="sxs-lookup"><span data-stu-id="c9e5c-112">In a perfect world there would be no run-time errors.</span></span> <span data-ttu-id="c9e5c-113">プログラマはコードを記述せずに、バグと、堅牢なユーザー入力の検証と外部データベース サーバーと電子メール サーバーなどのリソースはオフラインで作業しません。</span><span class="sxs-lookup"><span data-stu-id="c9e5c-113">Programmers would write code with nary a bug and with robust user input validation, and external resources like database servers and email servers would never go offline.</span></span> <span data-ttu-id="c9e5c-114">もちろん、実際にはエラーのない避けします。</span><span class="sxs-lookup"><span data-stu-id="c9e5c-114">Of course, in reality errors are inevitable.</span></span> <span data-ttu-id="c9e5c-115">.NET Framework のクラスは、例外をスローしてエラーを通知します。</span><span class="sxs-lookup"><span data-stu-id="c9e5c-115">The classes in the .NET Framework signal an error by throwing an exception.</span></span> <span data-ttu-id="c9e5c-116">オブジェクトの Open メソッドはなど、SqlConnection を呼び出して接続文字列で指定されたデータベースへの接続を確立します。</span><span class="sxs-lookup"><span data-stu-id="c9e5c-116">For example, calling a SqlConnection object's Open method establishes a connection to the database specified by a connection string.</span></span> <span data-ttu-id="c9e5c-117">ただし、データベースがダウンした場合、または接続文字列の資格情報が有効でない場合、Open メソッドがスローされます、`SqlException`します。</span><span class="sxs-lookup"><span data-stu-id="c9e5c-117">However, if the database is down or if the credentials in the connection string are invalid then the Open method throws a `SqlException`.</span></span> <span data-ttu-id="c9e5c-118">使用して例外を処理できる`Try/Catch/Finally`ブロックします。</span><span class="sxs-lookup"><span data-stu-id="c9e5c-118">Exceptions can be handled by the use of `Try/Catch/Finally` blocks.</span></span> <span data-ttu-id="c9e5c-119">場合内のコードを`Try`ブロックが例外をスロー、開発者が、エラーから回復を試みることができます、適切な catch ブロックに制御が移ります。</span><span class="sxs-lookup"><span data-stu-id="c9e5c-119">If code within a `Try` block throws an exception, control is transferred to the appropriate catch block where the developer can attempt to recover from the error.</span></span> <span data-ttu-id="c9e5c-120">一致する catch ブロックがないか、例外が percolates search の呼び出し履歴を例外をスローしたコードが try ブロックにない場合は場合、`Try/Catch/Finally`ブロックします。</span><span class="sxs-lookup"><span data-stu-id="c9e5c-120">If there is no matching catch block, or if the code that threw the exception is not in a try block, the exception percolates up the call stack in search of `Try/Catch/Finally` blocks.</span></span>

<span data-ttu-id="c9e5c-121">場合は、例外が処理されることがなく、ASP.NET ランタイムまでバブル、 [ `HttpApplication`クラス](https://msdn.microsoft.com/library/system.web.httpapplication.aspx)の[`Error`イベント](https://msdn.microsoft.com/library/system.web.httpapplication.error.aspx)が発生し、構成された*エラー ページ*が表示されます。</span><span class="sxs-lookup"><span data-stu-id="c9e5c-121">If the exception bubbles all the way up to the ASP.NET runtime without being handled, the [`HttpApplication` class](https://msdn.microsoft.com/library/system.web.httpapplication.aspx)'s [`Error` event](https://msdn.microsoft.com/library/system.web.httpapplication.error.aspx) is raised and the configured *error page* is displayed.</span></span> <span data-ttu-id="c9e5c-122">既定では、ASP.NET に愛情深いと呼ばれるエラー ページが表示されます、[死の黄色い画面](http://en.wikipedia.org/wiki/Yellow_Screen_of_Death#Yellow)(YSOD)。</span><span class="sxs-lookup"><span data-stu-id="c9e5c-122">By default, ASP.NET displays an error page that is affectionately referred to as the [Yellow Screen of Death](http://en.wikipedia.org/wiki/Yellow_Screen_of_Death#Yellow) (YSOD).</span></span> <span data-ttu-id="c9e5c-123">YSOD の 2 つのバージョンがあります 1 つを示しています、例外の詳細、スタック トレース、およびその他の情報を開発者がアプリケーションのデバッグに役立ちます (を参照してください**図 1**); 実行時エラー (参照があったことを示して、その他。**図 2**)。</span><span class="sxs-lookup"><span data-stu-id="c9e5c-123">There are two versions of the YSOD: one shows the exception details, a stack trace, and other information helpful to developers debugging the application (see **Figure 1**); the other simply states that there was a run-time error (see **Figure 2**).</span></span>

<span data-ttu-id="c9e5c-124">例外の詳細 YSOD 開発者は、アプリケーションのデバッグに非常に便利ですが、YSOD をエンドユーザーに示す安っぽいと不自然です。</span><span class="sxs-lookup"><span data-stu-id="c9e5c-124">The exception details YSOD is quite helpful for developers debugging the application, but showing a YSOD to end users is tacky and unprofessional.</span></span> <span data-ttu-id="c9e5c-125">代わりに、エンドユーザーよりユーザー フレンドリな prose の状況を説明すると、サイトのルック アンド フィールを維持するエラー ページに実行する必要があります。</span><span class="sxs-lookup"><span data-stu-id="c9e5c-125">Instead, end users should be taken to an error page that maintains the site's look and feel with more user-friendly prose describing the situation.</span></span> <span data-ttu-id="c9e5c-126">良い知らせは、このようなカスタム エラー ページを作成することは非常に簡単です。</span><span class="sxs-lookup"><span data-stu-id="c9e5c-126">The good news is that creating such a custom error page is quite easy.</span></span> <span data-ttu-id="c9e5c-127">このチュートリアルでは ASP を参照してください。NET の別のエラー ページ。</span><span class="sxs-lookup"><span data-stu-id="c9e5c-127">This tutorial starts with a look at ASP.NET's different error pages.</span></span> <span data-ttu-id="c9e5c-128">これは、後ユーザー エラーが発生した場合、カスタム エラー ページを表示する web アプリケーションを構成する方法を示します。</span><span class="sxs-lookup"><span data-stu-id="c9e5c-128">It then shows how to configure the web application to show users a custom error page in the face of an error.</span></span>

### <a name="examining-the-three-types-of-error-pages"></a><span data-ttu-id="c9e5c-129">次の 3 つの種類のエラー ページを調べる</span><span class="sxs-lookup"><span data-stu-id="c9e5c-129">Examining the Three Types of Error Pages</span></span>

<span data-ttu-id="c9e5c-130">エラー ページの 3 種類のいずれかの ASP.NET アプリケーションでハンドルされない例外が発生したときに表示されます。</span><span class="sxs-lookup"><span data-stu-id="c9e5c-130">When an unhandled exception arises in an ASP.NET application one of three types of error pages is displayed:</span></span>

- <span data-ttu-id="c9e5c-131">例外の詳細死亡黄色い画面のエラー ページ</span><span class="sxs-lookup"><span data-stu-id="c9e5c-131">The Exception Details Yellow Screen of Death error page,</span></span>
- <span data-ttu-id="c9e5c-132">ランタイム エラー死亡黄色い画面エラー ページ、または</span><span class="sxs-lookup"><span data-stu-id="c9e5c-132">The Runtime Error Yellow Screen of Death error page, or</span></span>
- <span data-ttu-id="c9e5c-133">カスタム エラー ページ</span><span class="sxs-lookup"><span data-stu-id="c9e5c-133">A custom error page</span></span>

<span data-ttu-id="c9e5c-134">エラー ページの開発者は最も一般的では、例外の詳細 YSOD です。</span><span class="sxs-lookup"><span data-stu-id="c9e5c-134">The error page developers are most familiar with is the Exception Details YSOD.</span></span> <span data-ttu-id="c9e5c-135">既定では、このページはローカルにアクセスしているユーザーに表示される、そのため、開発環境で、サイトをテストするときにエラーが発生したときに表示されるページは。</span><span class="sxs-lookup"><span data-stu-id="c9e5c-135">By default, this page is displayed to users who are visiting locally and therefore is the page that you see when an error occurs when testing the site in the development environment.</span></span> <span data-ttu-id="c9e5c-136">その名前が示すように、例外の詳細 YSOD は、種類、メッセージ、およびスタック トレース、例外に関する詳細を提供します。</span><span class="sxs-lookup"><span data-stu-id="c9e5c-136">As its name implies, the Exception Details YSOD provides details about the exception - the type, the message, and the stack trace.</span></span> <span data-ttu-id="c9e5c-137">さらに、ASP.NET ページの分離コード クラス内のコードで例外が発生した場合と、アプリケーションがデバッグ用に構成されている場合、例外の詳細 YSOD も表示されますこの行のコード (および上記のコードとその下に、いくつかの行)。</span><span class="sxs-lookup"><span data-stu-id="c9e5c-137">What's more, if the exception was raised by code in your ASP.NET page's code-behind class and if the application is configured for debugging then the Exception Details YSOD will also show this line of code (and a few lines of code above and below it).</span></span>

<span data-ttu-id="c9e5c-138">**図 1**例外詳細 YSOD ページが表示されます。</span><span class="sxs-lookup"><span data-stu-id="c9e5c-138">**Figure 1** shows the Exception Details YSOD page.</span></span> <span data-ttu-id="c9e5c-139">ブラウザーのアドレス ウィンドウ内の URL に注意してください:`http://localhost:62275/Genre.aspx?ID=foo`します。</span><span class="sxs-lookup"><span data-stu-id="c9e5c-139">Note the URL in the browser's address window: `http://localhost:62275/Genre.aspx?ID=foo`.</span></span> <span data-ttu-id="c9e5c-140">いることを思い出してください、`Genre.aspx`ページには、特定のジャンルの書籍レビューが一覧表示されます。</span><span class="sxs-lookup"><span data-stu-id="c9e5c-140">Recall that the `Genre.aspx` page lists the book reviews in a particular genre.</span></span> <span data-ttu-id="c9e5c-141">必要があります`GenreId`値 (、 `uniqueidentifier`); クエリ文字列を通じて渡される fiction レビューを表示するための適切な URL は、たとえば、`Genre.aspx?ID=7683ab5d-4589-4f03-a139-1c26044d0146`します。</span><span class="sxs-lookup"><span data-stu-id="c9e5c-141">It requires that `GenreId` value (a `uniqueidentifier`) be passed through the querystring; for example, the appropriate URL to view the fiction reviews is `Genre.aspx?ID=7683ab5d-4589-4f03-a139-1c26044d0146`.</span></span> <span data-ttu-id="c9e5c-142">以外の場合`uniqueidentifier`値は、クエリ文字列 ("foo") などを通じて、例外がスローされます。</span><span class="sxs-lookup"><span data-stu-id="c9e5c-142">If a non-`uniqueidentifier` value is passed in through the querystring (such as "foo") an exception is thrown.</span></span>

> [!NOTE]
> <span data-ttu-id="c9e5c-143">デモの web アプリケーションでは、このエラーを再現するダウンロードは`Genre.aspx?ID=foo`直接「、ランタイム エラーを生成する」リンクをクリックしてまたは`Default.aspx`します。</span><span class="sxs-lookup"><span data-stu-id="c9e5c-143">To reproduce this error in the demo web application available for download you can either visit `Genre.aspx?ID=foo` directly or click the "Generate a Runtime Error" link in `Default.aspx`.</span></span>

<span data-ttu-id="c9e5c-144">表示される例外情報に注意してください**図 1**します。</span><span class="sxs-lookup"><span data-stu-id="c9e5c-144">Note the exception information presented in **Figure 1**.</span></span> <span data-ttu-id="c9e5c-145">例外メッセージでは、「変換に失敗した文字の文字列から uniqueidentifier に変換するときに」することは、ページの上部に存在します。</span><span class="sxs-lookup"><span data-stu-id="c9e5c-145">The exception message, "Conversion failed when converting from a character string to uniqueidentifier" is present at the top of the page.</span></span> <span data-ttu-id="c9e5c-146">例外の種類`System.Data.SqlClient.SqlException`も、表示されます。</span><span class="sxs-lookup"><span data-stu-id="c9e5c-146">The type of the exception, `System.Data.SqlClient.SqlException`, is listed, as well.</span></span> <span data-ttu-id="c9e5c-147">スタック トレースもあります。</span><span class="sxs-lookup"><span data-stu-id="c9e5c-147">There's also the stack trace.</span></span>

[![](displaying-a-custom-error-page-vb/_static/image2.png)](displaying-a-custom-error-page-vb/_static/image1.png)

<span data-ttu-id="c9e5c-148">**図 1**:例外の詳細 YSOD 例外に関する情報が含まれています</span><span class="sxs-lookup"><span data-stu-id="c9e5c-148">**Figure 1**: The Exception Details YSOD Includes Information About the Exception</span></span>  
 <span data-ttu-id="c9e5c-149">([フルサイズの画像を表示する をクリックします](displaying-a-custom-error-page-vb/_static/image3.png))。</span><span class="sxs-lookup"><span data-stu-id="c9e5c-149">([Click to view full-size image](displaying-a-custom-error-page-vb/_static/image3.png))</span></span>

<span data-ttu-id="c9e5c-150">YSOD の他の種類に、ランタイム エラー YSOD、**図 2**します。</span><span class="sxs-lookup"><span data-stu-id="c9e5c-150">The other type of YSOD is the Runtime Error YSOD, and is shown in **Figure 2**.</span></span> <span data-ttu-id="c9e5c-151">実行時のエラー YSOD 実行時エラーが発生した、訪問者に通知がスローされた例外に関する情報は含まれません。</span><span class="sxs-lookup"><span data-stu-id="c9e5c-151">The Runtime Error YSOD informs the visitor that a run-time error has occurred, but it does not include any information about the exception that was thrown.</span></span> <span data-ttu-id="c9e5c-152">(変更することで、エラーの詳細を表示できるようにする方法の手順は、提供、`Web.config`ファイルは、このような不自然に見える YSOD の一部です)。</span><span class="sxs-lookup"><span data-stu-id="c9e5c-152">(It does, however, provide instructions on how to make the error details viewable by modifying the `Web.config` file, which is part of what makes such a YSOD look unprofessional.)</span></span>

<span data-ttu-id="c9e5c-153">既定では、ランタイム エラー YSOD がリモート アクセス ユーザーが表示されます (を通じて http://www.yoursite.com) ことで、ブラウザーのアドレス バーに URL からわかるように、**図 2**:`http://httpruntime.web703.discountasp.net/Genre.aspx?ID=foo`です。</span><span class="sxs-lookup"><span data-stu-id="c9e5c-153">By default, the Runtime Error YSOD is shown to users visiting remotely (through http://www.yoursite.com), as evidenced by the URL in the browser's Address bar in **Figure 2**: `http://httpruntime.web703.discountasp.net/Genre.aspx?ID=foo`.</span></span> <span data-ttu-id="c9e5c-154">2 つの異なる YSOD 画面存在開発者は、エラーの詳細に関心が潜在的なセキュリティの脆弱性やその他の機密情報を訪れる人を明らかに可能性がありますが、このような情報をライブ サイトで表示しないため、サイトです。</span><span class="sxs-lookup"><span data-stu-id="c9e5c-154">The two different YSOD screens exist because developers are interested in knowing the error details, but such information should not be shown on a live site as it may reveal potential security vulnerabilities or other sensitive information to anyone who visits your site.</span></span>

> [!NOTE]
> <span data-ttu-id="c9e5c-155">従うし、web ホストとして DiscountASP.NET を使用している場合、ライブ サイトにアクセスすると、ランタイム エラー YSOD は表示されませんお気付きです。</span><span class="sxs-lookup"><span data-stu-id="c9e5c-155">If you are following along and are using DiscountASP.NET as your web host, you may notice that the Runtime Error YSOD does not display when visiting the live site.</span></span> <span data-ttu-id="c9e5c-156">DiscountASP.NET があるそのサーバーが既定では、例外の詳細 YSOD を表示するように構成するためです。</span><span class="sxs-lookup"><span data-stu-id="c9e5c-156">This is because DiscountASP.NET has their servers configured to show the Exception Details YSOD by default.</span></span> <span data-ttu-id="c9e5c-157">良い知らせは、追加してこの既定の動作をオーバーライドすることができます、`<customErrors>`セクションを`Web.config`ファイル。</span><span class="sxs-lookup"><span data-stu-id="c9e5c-157">The good news is that you can override this default behavior by adding a `<customErrors>` section to your `Web.config` file.</span></span> <span data-ttu-id="c9e5c-158">「構成エラー ページが表示される」セクションを調べ、`<customErrors>`この後説明します。</span><span class="sxs-lookup"><span data-stu-id="c9e5c-158">The "Configuring Which Error Page is Displayed" section examines the `<customErrors>` section in detail.</span></span>

[![](displaying-a-custom-error-page-vb/_static/image5.png)](displaying-a-custom-error-page-vb/_static/image4.png)

<span data-ttu-id="c9e5c-159">**図 2**:実行時エラー YSOD では、エラーの詳細は含まれません</span><span class="sxs-lookup"><span data-stu-id="c9e5c-159">**Figure 2**: The Runtime Error YSOD Does Not Include Any Error Details</span></span>  
 <span data-ttu-id="c9e5c-160">([フルサイズの画像を表示する をクリックします](displaying-a-custom-error-page-vb/_static/image6.png))。</span><span class="sxs-lookup"><span data-stu-id="c9e5c-160">([Click to view full-size image](displaying-a-custom-error-page-vb/_static/image6.png))</span></span>

<span data-ttu-id="c9e5c-161">エラー ページの 3 番目の型は、web ページを作成するには、カスタム エラー ページです。</span><span class="sxs-lookup"><span data-stu-id="c9e5c-161">The third type of error page is the custom error page, which is a web page that you create.</span></span> <span data-ttu-id="c9e5c-162">カスタム エラー ページの利点は、ページのルック アンド フィール; と共にユーザーに表示される情報を完全に制御があることです。カスタム エラー ページは、その他のページとして、同じマスター ページやスタイルを使用できます。</span><span class="sxs-lookup"><span data-stu-id="c9e5c-162">The benefit of a custom error page is that you have complete control over the information that is displayed to the user along with the page's look and feel; the custom error page can use the same master page and styles as your other pages.</span></span> <span data-ttu-id="c9e5c-163">「を使用して、カスタム エラー ページ」セクションでは、カスタム エラー ページを作成し、ハンドルされない例外が発生した場合に表示するように構成する手順について説明します。</span><span class="sxs-lookup"><span data-stu-id="c9e5c-163">The "Using a Custom Error Page" section walks through creating a custom error page and configuring it to display in the event of an unhandled exception.</span></span> <span data-ttu-id="c9e5c-164">**図 3**このカスタム エラー ページのヒントのピークを提供します。</span><span class="sxs-lookup"><span data-stu-id="c9e5c-164">**Figure 3** offers a sneak peak of this custom error page.</span></span> <span data-ttu-id="c9e5c-165">ご覧のように、エラー ページのルック アンド フィールはより洗練された外観よりも、黄色の画面の死図 1 と 2 のいずれか。</span><span class="sxs-lookup"><span data-stu-id="c9e5c-165">As you can see, the look and feel of the error page is much more professional-looking than either of the Yellow Screens of Death shown in Figures 1 and 2.</span></span>

[![](displaying-a-custom-error-page-vb/_static/image8.png)](displaying-a-custom-error-page-vb/_static/image7.png)

<span data-ttu-id="c9e5c-166">**図 3**:カスタム エラー ページをより細かく調整されたルック アンド フィールを提供しています</span><span class="sxs-lookup"><span data-stu-id="c9e5c-166">**Figure 3**: A Custom Error Page Offers a More Tailored Look and Feel</span></span>  
 <span data-ttu-id="c9e5c-167">([フルサイズの画像を表示する をクリックします](displaying-a-custom-error-page-vb/_static/image9.png))。</span><span class="sxs-lookup"><span data-stu-id="c9e5c-167">([Click to view full-size image](displaying-a-custom-error-page-vb/_static/image9.png))</span></span>

<span data-ttu-id="c9e5c-168">ブラウザーのアドレス バーを検査する少し**図 3**します。</span><span class="sxs-lookup"><span data-stu-id="c9e5c-168">Take a moment to inspect the browser's Address bar in **Figure 3**.</span></span> <span data-ttu-id="c9e5c-169">アドレス バーには、カスタム エラー ページの URL が表示されます (`/ErrorPages/Oops.aspx`)。</span><span class="sxs-lookup"><span data-stu-id="c9e5c-169">Note that the Address bar shows the URL of the custom error page (`/ErrorPages/Oops.aspx`).</span></span> <span data-ttu-id="c9e5c-170">同じページから、エラーが発生したことで図 1 および 2 で死の黄色い画面が表示されます (`Genre.aspx`)。</span><span class="sxs-lookup"><span data-stu-id="c9e5c-170">In Figures 1 and 2 the Yellow Screens of Death are shown in the same page that the error originated from (`Genre.aspx`).</span></span> <span data-ttu-id="c9e5c-171">カスタム エラー ページを使用して、エラーが発生するページの URL を渡される、`aspxerrorpath`クエリ文字列パラメーター。</span><span class="sxs-lookup"><span data-stu-id="c9e5c-171">The custom error page is passed the URL of the page where the error occurred via the `aspxerrorpath` querystring parameter.</span></span>

## <a name="configuring-which-error-page-is-displayed"></a><span data-ttu-id="c9e5c-172">これは、エラー ページの構成が表示されます。</span><span class="sxs-lookup"><span data-stu-id="c9e5c-172">Configuring Which Error Page is Displayed</span></span>

<span data-ttu-id="c9e5c-173">3 つの可能性のあるエラー ページの表示は、2 つの変数に基づいています。</span><span class="sxs-lookup"><span data-stu-id="c9e5c-173">Which of the three possible error pages is displayed is based on two variables:</span></span>

- <span data-ttu-id="c9e5c-174">構成情報、`<customErrors>`セクションと</span><span class="sxs-lookup"><span data-stu-id="c9e5c-174">The configuration information in the `<customErrors>` section, and</span></span>
- <span data-ttu-id="c9e5c-175">かどうか、ユーザーは、ローカルまたはリモートでサイトを訪問は。</span><span class="sxs-lookup"><span data-stu-id="c9e5c-175">Whether the user is visiting the site locally or remotely.</span></span>

<span data-ttu-id="c9e5c-176">[ `<customErrors>`セクション](https://msdn.microsoft.com/library/h0hfz6fc.aspx)で`Web.config`がどのようなエラー ページが表示に影響する 2 つの属性:`defaultRedirect`と`mode`します。</span><span class="sxs-lookup"><span data-stu-id="c9e5c-176">The [`<customErrors>` section](https://msdn.microsoft.com/library/h0hfz6fc.aspx) in `Web.config` has two attributes that affect what error page is shown: `defaultRedirect` and `mode`.</span></span> <span data-ttu-id="c9e5c-177">
  `defaultRedirect\` 属性は省略できます。</span><span class="sxs-lookup"><span data-stu-id="c9e5c-177">The `defaultRedirect` attribute is optional.</span></span> <span data-ttu-id="c9e5c-178">指定した場合、カスタム エラー ページの URL を指定し、ランタイム エラーの YSOD ではなく、カスタム エラー ページが表示することを示します。</span><span class="sxs-lookup"><span data-stu-id="c9e5c-178">If provided, it specifies the URL of the custom error page and indicates that the custom error page should be shown instead of the Runtime Error YSOD.</span></span> <span data-ttu-id="c9e5c-179">`mode`属性が必要ですし、3 つの値のいずれかを受け入れます。 `On`、 `Off`、または`RemoteOnly`します。</span><span class="sxs-lookup"><span data-stu-id="c9e5c-179">The `mode` attribute is required and accepts one of three values: `On`, `Off`, or `RemoteOnly`.</span></span> <span data-ttu-id="c9e5c-180">これらの値には、次の動作があります。</span><span class="sxs-lookup"><span data-stu-id="c9e5c-180">These values have the following behavior:</span></span>

- <span data-ttu-id="c9e5c-181">`On` -カスタム エラー ページまたはランタイム エラーの YSOD がローカルまたはリモートいるかどうかに関係なく、すべての訪問者に表示されていることを示します。</span><span class="sxs-lookup"><span data-stu-id="c9e5c-181">`On` - indicates that the custom error page or the Runtime Error YSOD is shown to all visitors, regardless of whether they are local or remote.</span></span>
- <span data-ttu-id="c9e5c-182">`Off` -例外の詳細 YSOD がローカルまたはリモートいるかどうかに関係なく、すべての訪問者に表示されることを指定します。</span><span class="sxs-lookup"><span data-stu-id="c9e5c-182">`Off` - specifies that the Exception Details YSOD is displayed to all visitors, regardless of whether they are local or remote.</span></span>
- <span data-ttu-id="c9e5c-183">`RemoteOnly` -カスタム エラー ページまたはランタイム エラーの YSOD が表示されているリモートの訪問者に、例外の詳細 YSOD がローカルの訪問者に表示することを示します。</span><span class="sxs-lookup"><span data-stu-id="c9e5c-183">`RemoteOnly` - indicates that the custom error page or the Runtime Error YSOD is shown to remote visitors, while the Exception Details YSOD is shown to local visitors.</span></span>

<span data-ttu-id="c9e5c-184">ASP.NET が動作しますモード属性を設定している場合、それ以外の場合、指定しない限り`RemoteOnly`が指定されていないと、`defaultRedirect`値。</span><span class="sxs-lookup"><span data-stu-id="c9e5c-184">Unless you specify otherwise, ASP.NET acts as if you had set the mode attribute to `RemoteOnly` and had not specified a `defaultRedirect` value.</span></span> <span data-ttu-id="c9e5c-185">つまり、既定の動作では、ランタイム エラー YSOD がリモートの訪問者に示すように、ローカルの訪問者に例外の詳細 YSOD が表示されます。</span><span class="sxs-lookup"><span data-stu-id="c9e5c-185">In other words, the default behavior is that the Exception Details YSOD is displayed to local visitors while the Runtime Error YSOD is shown to remote visitors.</span></span> <span data-ttu-id="c9e5c-186">追加して、この既定の動作をオーバーライドすることができます、 `<customErrors>` web アプリケーションのセクション `Web.config file.`</span><span class="sxs-lookup"><span data-stu-id="c9e5c-186">You can override this default behavior by adding a `<customErrors>` section to your web application's `Web.config file.`</span></span>

## <a name="using-a-custom-error-page"></a><span data-ttu-id="c9e5c-187">カスタム エラー ページを使用します。</span><span class="sxs-lookup"><span data-stu-id="c9e5c-187">Using a Custom Error Page</span></span>

<span data-ttu-id="c9e5c-188">すべての web アプリケーションでは、カスタム エラー ページが必要です。</span><span class="sxs-lookup"><span data-stu-id="c9e5c-188">Every web application should have a custom error page.</span></span> <span data-ttu-id="c9e5c-189">ランタイム エラーの YSOD より洗練された外観の代替を提供します、簡単に作成するには、およびカスタム エラー ページを使用するアプリケーションを構成するだけに時間がかかります。</span><span class="sxs-lookup"><span data-stu-id="c9e5c-189">It provides a more professional-looking alternative to the Runtime Error YSOD, it is easy to create, and configuring the application to use the custom error page takes only a few moments.</span></span> <span data-ttu-id="c9e5c-190">最初の手順は、カスタム エラー ページを作成します。</span><span class="sxs-lookup"><span data-stu-id="c9e5c-190">The first step is creating the custom error page.</span></span> <span data-ttu-id="c9e5c-191">という名前の書評アプリケーションに新しいフォルダーを追加して`ErrorPages`という名前の新しい ASP.NET ページに追加して`Oops.aspx`します。</span><span class="sxs-lookup"><span data-stu-id="c9e5c-191">I've added a new folder to the Book Reviews application named `ErrorPages` and added to that a new ASP.NET page named `Oops.aspx`.</span></span> <span data-ttu-id="c9e5c-192">同じルック アンド フィールを自動的に継承するように、サイトのページの残りの部分として同じマスター ページを使用して、ページがあります。</span><span class="sxs-lookup"><span data-stu-id="c9e5c-192">Have the page use the same master page as the rest of the pages on your site so that it automatically inherits the same look and feel.</span></span>

[![](displaying-a-custom-error-page-vb/_static/image11.png)](displaying-a-custom-error-page-vb/_static/image10.png)

<span data-ttu-id="c9e5c-193">**図 4**:カスタム エラー ページを作成します。</span><span class="sxs-lookup"><span data-stu-id="c9e5c-193">**Figure 4**: Create a Custom Error Page</span></span>

<span data-ttu-id="c9e5c-194">次に、数分をかけてのエラー ページのコンテンツを作成します。</span><span class="sxs-lookup"><span data-stu-id="c9e5c-194">Next, spend a few minutes creating the content for the error page.</span></span> <span data-ttu-id="c9e5c-195">単純なカスタム エラー ページを示すメッセージが予期しないエラーが発生しました、サイトのホーム ページに戻る、リンクを作成しました。</span><span class="sxs-lookup"><span data-stu-id="c9e5c-195">I've created a rather simple custom error page with a message indicating that there was an unexpected error and a link back to the site's homepage.</span></span>

[![](displaying-a-custom-error-page-vb/_static/image13.png)](displaying-a-custom-error-page-vb/_static/image12.png)

<span data-ttu-id="c9e5c-196">**図 5**:カスタム エラー ページをデザインします。</span><span class="sxs-lookup"><span data-stu-id="c9e5c-196">**Figure 5**: Design Your Custom Error Page</span></span>  
 <span data-ttu-id="c9e5c-197">([フルサイズの画像を表示する をクリックします](displaying-a-custom-error-page-vb/_static/image14.png))。</span><span class="sxs-lookup"><span data-stu-id="c9e5c-197">([Click to view full-size image](displaying-a-custom-error-page-vb/_static/image14.png))</span></span>

<span data-ttu-id="c9e5c-198">完了、エラー ページには、代わりに、ランタイム エラー YSOD カスタム エラー ページを使用する web アプリケーションを構成します。</span><span class="sxs-lookup"><span data-stu-id="c9e5c-198">With the error page completed, configure the web application to use the custom error page in lieu of the Runtime Error YSOD.</span></span> <span data-ttu-id="c9e5c-199">エラー ページの URL を指定することでこれは、`<customErrors>`セクションの`defaultRedirect`属性。</span><span class="sxs-lookup"><span data-stu-id="c9e5c-199">This is accomplished by specifying the URL of the error page in the `<customErrors>` section's `defaultRedirect` attribute.</span></span> <span data-ttu-id="c9e5c-200">次のマークアップをアプリケーションに追加`Web.config`ファイル。</span><span class="sxs-lookup"><span data-stu-id="c9e5c-200">Add the following markup to your application's `Web.config` file:</span></span>

[!code-xml[Main](displaying-a-custom-error-page-vb/samples/sample1.xml)]

<span data-ttu-id="c9e5c-201">上記のマークアップは、例外の詳細 YSOD をリモートでアクセスしてそれらのユーザーを Oops.aspx カスタム エラー ページを使用しながら、ローカルにアクセスするユーザーに表示するアプリケーションを構成します。</span><span class="sxs-lookup"><span data-stu-id="c9e5c-201">The above markup configures the application to show the Exception Details YSOD to users visiting locally, while using the custom error page Oops.aspx for those users visiting remotely.</span></span> <span data-ttu-id="c9e5c-202">アクションの表示は、web サイトの運用環境に配置し、し、無効なクエリ文字列値を持つライブ サイトで Genre.aspx ページを参照してください。</span><span class="sxs-lookup"><span data-stu-id="c9e5c-202">To see this in action, deploy your website to the production environment and then visit the Genre.aspx page on the live site with an invalid querystring value.</span></span> <span data-ttu-id="c9e5c-203">カスタム エラー ページが表示されます (参照**図 3**)。</span><span class="sxs-lookup"><span data-stu-id="c9e5c-203">You should see the custom error page (refer back to **Figure 3**).</span></span>

<span data-ttu-id="c9e5c-204">カスタム エラー ページは、リモート ユーザーにのみ表示を確認するを参照してください。、`Genre.aspx`開発環境から、無効なクエリ文字列を含むページ。</span><span class="sxs-lookup"><span data-stu-id="c9e5c-204">To verify that the custom error page is only shown to remote users, visit the `Genre.aspx` page with an invalid querystring from the development environment.</span></span> <span data-ttu-id="c9e5c-205">例外の詳細 YSOD も表示されます (参照**図 1**)。</span><span class="sxs-lookup"><span data-stu-id="c9e5c-205">You should still see the Exception Details YSOD (refer back to **Figure 1**).</span></span> <span data-ttu-id="c9e5c-206">`RemoteOnly`ローカルで作業する開発者が、例外の詳細を参照してください。 引き続き、実稼働環境で、サイトを訪問するユーザーはカスタム エラー ページをご覧ください。 設定になります。</span><span class="sxs-lookup"><span data-stu-id="c9e5c-206">The `RemoteOnly` setting ensures that users visiting the site on the production environment see the custom error page while developers working locally continue to see the details of the exception.</span></span>

## <a name="notifying-developers-and-logging-error-details"></a><span data-ttu-id="c9e5c-207">開発者を通知して、エラーの詳細をログ記録</span><span class="sxs-lookup"><span data-stu-id="c9e5c-207">Notifying Developers and Logging Error Details</span></span>

<span data-ttu-id="c9e5c-208">開発環境で発生するエラーは、自分のコンピューターに座っている開発者によって発生しました。</span><span class="sxs-lookup"><span data-stu-id="c9e5c-208">Errors that occur in the development environment were caused by the developer sitting at her computer.</span></span> <span data-ttu-id="c9e5c-209">彼女には、例外の詳細 YSOD で例外の情報が表示され、彼女は、エラーが発生したときに実行していた、どのような手順がわかっています。</span><span class="sxs-lookup"><span data-stu-id="c9e5c-209">She is shown the exception's information in the Exception Details YSOD, and she knows what steps she was performing when the error occurred.</span></span> <span data-ttu-id="c9e5c-210">運用環境では、エラーが発生するときに、開発者にナレッジをサイトにアクセスするエンドユーザーにエラーを報告する時間がかかる場合を除き、エラーが発生したことはありません。</span><span class="sxs-lookup"><span data-stu-id="c9e5c-210">But when an error occurs on production, the developer has no knowledge that an error occurred unless the end user visiting the site takes the time to report the error.</span></span> <span data-ttu-id="c9e5c-211">ユーザー例外の種類、メッセージ、およびそれを修正することはおろか、エラーの原因を診断することは難しいスタック トレースを知ることがなく、エラーが発生しました開発チームのアラートを生成する途中から外れた場合でもです。</span><span class="sxs-lookup"><span data-stu-id="c9e5c-211">And even if the user goes out of his way to alert the development team that an error occurred, without knowing the exception type, message, and stack trace it can be difficult to diagnose the cause of the error, let alone fix it.</span></span>

<span data-ttu-id="c9e5c-212">(データベース) などのいくつかの永続的なストアを運用環境でエラーが記録する最優先事項はこれらの理由から、開発者はこのエラーの警告が表示されます。</span><span class="sxs-lookup"><span data-stu-id="c9e5c-212">For these reasons it is paramount that any error in the production environment is logged to some persistent store (such as a database) and that the developers are alerted of this error.</span></span> <span data-ttu-id="c9e5c-213">カスタム エラー ページは、このログ記録および通知を実行する適切な場所のように思えます。</span><span class="sxs-lookup"><span data-stu-id="c9e5c-213">The custom error page may seem like a good place to do this logging and notification.</span></span> <span data-ttu-id="c9e5c-214">残念ながら、カスタム エラー ページが、エラーの詳細にアクセスできないと、この情報をログに使用することはできません。</span><span class="sxs-lookup"><span data-stu-id="c9e5c-214">Unfortunately, the custom error page does not have access to the error details and therefore cannot be used to log this information.</span></span> <span data-ttu-id="c9e5c-215">良い知らせは、エラーの詳細をインターセプトして、ログに記録する方法がいくつかを次の 3 つのチュートリアルでは、このトピックで詳細を確認できます。 には。</span><span class="sxs-lookup"><span data-stu-id="c9e5c-215">The good news is that there are a number of ways to intercept the error details and to log them, and the next three tutorials explore this topic in more detail.</span></span>

## <a name="using-different-custom-error-pages-for-different-http-error-statuses"></a><span data-ttu-id="c9e5c-216">別の HTTP エラー状態の別のカスタム エラー ページの使用</span><span class="sxs-lookup"><span data-stu-id="c9e5c-216">Using Different Custom Error Pages for Different HTTP Error Statuses</span></span>

<span data-ttu-id="c9e5c-217">例外は、ASP.NET ページによってスローされ、処理されない、例外は percolates まで ASP.NET の実行時は、構成済みのエラー ページが表示されます。</span><span class="sxs-lookup"><span data-stu-id="c9e5c-217">When an exception is thrown by an ASP.NET page and is not handled, the exception percolates up to the ASP.NET runtime, which displays the configured error page.</span></span> <span data-ttu-id="c9e5c-218">ファイル アクセス許可が無効になっている要求は、ASP.NET エンジンしますが、何らかの理由は処理できません - など、要求されたファイルが見つからなかったか読み取る場合は、ASP.NET エンジン、`HttpException`します。</span><span class="sxs-lookup"><span data-stu-id="c9e5c-218">If a request comes into the ASP.NET engine but cannot be processed for some reason - perhaps the requested file is not found or Read permissions have been disabled for the file - then the ASP.NET engine raises an `HttpException`.</span></span> <span data-ttu-id="c9e5c-219">ASP.NET ページなどから発生した例外のように、この例外が原因で適切なエラー ページが表示される、実行時までバブルします。</span><span class="sxs-lookup"><span data-stu-id="c9e5c-219">This exception, like exceptions raised from ASP.NET pages, bubbles up to the runtime, causing the appropriate error page to be displayed.</span></span>

<span data-ttu-id="c9e5c-220">実稼働環境で web アプリケーションのつまりされている場合、ユーザーがカスタム エラー ページが表示されますが、存在しないページを要求します。</span><span class="sxs-lookup"><span data-stu-id="c9e5c-220">What this means for the web application in production is that if a user requests a page that is not found then they will see the custom error page.</span></span> <span data-ttu-id="c9e5c-221">**図 6**このような例を示しています。</span><span class="sxs-lookup"><span data-stu-id="c9e5c-221">**Figure 6** shows such an example.</span></span> <span data-ttu-id="c9e5c-222">要求が存在しないページのため、(`NoSuchPage.aspx`)、`HttpException`スローされるとカスタム エラー ページが表示されます (への参照に注意してください`NoSuchPage.aspx`で、`aspxerrorpath`クエリ文字列パラメーター)。</span><span class="sxs-lookup"><span data-stu-id="c9e5c-222">Because the request is for a non-existent page (`NoSuchPage.aspx`), an `HttpException` is thrown and the custom error page is displayed (note the reference to `NoSuchPage.aspx` in the `aspxerrorpath` querystring parameter).</span></span>

<span data-ttu-id="c9e5c-223">[![](displaying-a-custom-error-page-vb/_static/image16.png)](displaying-a-custom-error-page-vb/_static/image15.png)**図 6**:ASP.NET ランタイムは、無効な要求に応答してで、構成済みのエラー ページを表示します。</span><span class="sxs-lookup"><span data-stu-id="c9e5c-223">[![](displaying-a-custom-error-page-vb/_static/image16.png)](displaying-a-custom-error-page-vb/_static/image15.png)**Figure 6**: The ASP.NET Runtime Displays the Configured Error Page In Response to an Invalid Request</span></span>  
 <span data-ttu-id="c9e5c-224">([フルサイズの画像を表示する をクリックします](displaying-a-custom-error-page-vb/_static/image17.png))。</span><span class="sxs-lookup"><span data-stu-id="c9e5c-224">([Click to view full-size image](displaying-a-custom-error-page-vb/_static/image17.png))</span></span> 

<span data-ttu-id="c9e5c-225">既定では、すべての種類のエラーが発生する同じカスタム エラー ページに表示されます。</span><span class="sxs-lookup"><span data-stu-id="c9e5c-225">By default, all types of errors cause the same custom error page to be displayed.</span></span> <span data-ttu-id="c9e5c-226">ただし、特定 HTTP ステータス コードを使用して、別のカスタム エラー ページを指定できます`<error>`内の子要素、`<customErrors>`セクション。</span><span class="sxs-lookup"><span data-stu-id="c9e5c-226">However, you can specify a different custom error page for a specific HTTP status code using `<error>` children elements within the `<customErrors>` section.</span></span> <span data-ttu-id="c9e5c-227">たとえば、更新が見つからないというエラーで、HTTP 状態コード 404 は、ページが発生した場合に表示される別のエラー ページがある、`<customErrors>`セクションに次のマークアップを含めます。</span><span class="sxs-lookup"><span data-stu-id="c9e5c-227">For example, to have a different error page displayed in the event of a page not found error, which has an HTTP status code of 404, update the `<customErrors>` section to include the following markup:</span></span>

[!code-xml[Main](displaying-a-custom-error-page-vb/samples/sample2.xml)]

<span data-ttu-id="c9e5c-228">この変更をリモートでアクセスしたユーザーが存在しない場合、ASP.NET リソースを要求したときにそれらにリダイレクトされます、`404.aspx`の代わりにカスタム エラー ページ`Oops.aspx`します。</span><span class="sxs-lookup"><span data-stu-id="c9e5c-228">With this change in place, whenever a user visiting remotely requests an ASP.NET resource that does not exist, they will be redirected to the `404.aspx` custom error page instead of `Oops.aspx`.</span></span> <span data-ttu-id="c9e5c-229">として**図 7**に示した、`404.aspx`ページは、一般的なカスタム エラー ページよりも具体的なメッセージを含めることができます。</span><span class="sxs-lookup"><span data-stu-id="c9e5c-229">As **Figure 7** illustrates, the `404.aspx` page can include a more specific message than the general custom error page.</span></span>

> [!NOTE]
> <span data-ttu-id="c9e5c-230">チェック アウト[404 エラー ページ、1 つ以上の時間](http://www.smashingmagazine.com/2009/01/29/404-error-pages-one-more-time/)効果的な 404 エラー ページを作成する方法のガイダンスについてはします。</span><span class="sxs-lookup"><span data-stu-id="c9e5c-230">Check out [404 Error Pages, One More Time](http://www.smashingmagazine.com/2009/01/29/404-error-pages-one-more-time/) for guidance on creating effective 404 error pages.</span></span>

<span data-ttu-id="c9e5c-231">[![](displaying-a-custom-error-page-vb/_static/image19.png)](displaying-a-custom-error-page-vb/_static/image18.png)**図 7**:カスタム 404 エラー ページより対象が絞られたメッセージが表示されます。 `Oops.aspx`</span><span class="sxs-lookup"><span data-stu-id="c9e5c-231">[![](displaying-a-custom-error-page-vb/_static/image19.png)](displaying-a-custom-error-page-vb/_static/image18.png)**Figure 7**: The Custom 404 Error Page Displays a More Targeted Message Than `Oops.aspx`</span></span>  
 <span data-ttu-id="c9e5c-232">([フルサイズの画像を表示する をクリックします](displaying-a-custom-error-page-vb/_static/image20.png))。</span><span class="sxs-lookup"><span data-stu-id="c9e5c-232">([Click to view full-size image](displaying-a-custom-error-page-vb/_static/image20.png))</span></span> 

<span data-ttu-id="c9e5c-233">あるとわかっているため、`404.aspx`ページは、ユーザーが見つかりませんページを要求すると、のみと、この特定の種類のエラーに対応するユーザーを支援する機能を含めるには、このカスタム エラー ページを強化できます。</span><span class="sxs-lookup"><span data-stu-id="c9e5c-233">Because you know that the `404.aspx` page is only reached when the user makes a request for a page that was not found, you can enhance this custom error page to include functionality to help the user address this specific type of error.</span></span> <span data-ttu-id="c9e5c-234">たとえば、既知の適切な Url に無効な Url をマップするデータベース テーブルを作成してがし、`404.aspx`カスタム エラー ページに対してクエリを実行すると、テーブルが表示され、ユーザーがアクセスしようページをお勧めします。</span><span class="sxs-lookup"><span data-stu-id="c9e5c-234">For example, you could build a database table that maps known bad URLs to good URLs, and then have the `404.aspx` custom error page run a query against that table and suggest pages the user may be trying to reach.</span></span>

> [!NOTE]
> <span data-ttu-id="c9e5c-235">カスタム エラー ページは、ASP.NET エンジンによって処理されるリソースに要求が行われた場合にのみ表示されます。</span><span class="sxs-lookup"><span data-stu-id="c9e5c-235">The custom error page is only displayed when a request is made to a resource handled by the ASP.NET engine.</span></span> <span data-ttu-id="c9e5c-236">説明したように、 [Core の相違点の間で IIS と ASP.NET 開発サーバー](core-differences-between-iis-and-the-asp-net-development-server-vb.md)チュートリアル, web サーバーが特定の要求を処理自体。</span><span class="sxs-lookup"><span data-stu-id="c9e5c-236">As we discussed in the [Core Differences Between IIS and the ASP.NET Development Server](core-differences-between-iis-and-the-asp-net-development-server-vb.md) tutorial, the web server may handle certain requests itself.</span></span> <span data-ttu-id="c9e5c-237">既定では、IIS web 画像や HTML ファイルなどの静的コンテンツのサーバー プロセスの要求を使用、ASP.NET エンジンを呼び出さずにします。</span><span class="sxs-lookup"><span data-stu-id="c9e5c-237">By default, the IIS web server processes requests for static content like images and HTML files without invoking the ASP.NET engine.</span></span> <span data-ttu-id="c9e5c-238">その結果、ユーザーが存在しないイメージ ファイルを要求した場合は戻る ASP ではなく、IIS の既定の 404 エラー メッセージ。NET のでは、エラー ページを構成します。</span><span class="sxs-lookup"><span data-stu-id="c9e5c-238">Consequently, if the user requests a non-existent image file they will get back IIS's default 404 error message rather than ASP.NET's configured error page.</span></span>

## <a name="summary"></a><span data-ttu-id="c9e5c-239">まとめ</span><span class="sxs-lookup"><span data-stu-id="c9e5c-239">Summary</span></span>

<span data-ttu-id="c9e5c-240">次の 3 つのエラー ページのいずれかを表示、ASP.NET アプリケーションでハンドルされない例外が発生した場合: 例外の詳細黄色い画面の終焉;実行時エラー黄色の死; の画面または、カスタム エラー ページ。</span><span class="sxs-lookup"><span data-stu-id="c9e5c-240">When an unhandled exception occurs in an ASP.NET application, the user is shown one of three error pages: the Exception Details Yellow Screen of Death; the Runtime Error Yellow Screen of Death; or a custom error page.</span></span> <span data-ttu-id="c9e5c-241">アプリケーションのエラー ページが表示される異なります`<customErrors>`構成し、ローカルまたはリモート ユーザーがアクセスしたかどうか。</span><span class="sxs-lookup"><span data-stu-id="c9e5c-241">Which error page is displayed depends on the application's `<customErrors>` configuration and whether the user is visiting locally or remotely.</span></span> <span data-ttu-id="c9e5c-242">既定の動作では、リモートの訪問者にローカルの訪問者に例外の詳細 YSOD とランタイム エラーの YSOD を説明します。</span><span class="sxs-lookup"><span data-stu-id="c9e5c-242">The default behavior is to show the Exception Details YSOD to local visitors and the Runtime Error YSOD to remote visitors.</span></span>

<span data-ttu-id="c9e5c-243">ランタイム エラーの YSOD には、サイトにアクセスするユーザーからの可能性がある機密性の高いエラー情報が非表示に、中にサイトのルック アンド フィールから中断し、により、アプリケーションのバグの外観します。</span><span class="sxs-lookup"><span data-stu-id="c9e5c-243">While the Runtime Error YSOD hides potentially sensitive error information from the user visiting the site, it breaks from your site's look and feel and makes your application look buggy.</span></span> <span data-ttu-id="c9e5c-244">優れたアプローチはカスタム エラー ページで、作成、カスタム エラー ページのデザインとでは、その URL を指定する必要がありますを使用する、`<customErrors>`セクションの`defaultRedirect`属性。</span><span class="sxs-lookup"><span data-stu-id="c9e5c-244">A better approach is to use a custom error page, which entails creating and designing the custom error page and specifying its URL in the `<customErrors>` section's `defaultRedirect` attribute.</span></span> <span data-ttu-id="c9e5c-245">さまざまな HTTP エラー状態に対する複数のカスタム エラー ページのこともできます。</span><span class="sxs-lookup"><span data-stu-id="c9e5c-245">You can even have multiple custom error pages for different HTTP error statuses.</span></span>

<span data-ttu-id="c9e5c-246">カスタム エラー ページは、実稼働環境で web サイトの戦略を処理する包括的なエラーの最初の手順です。</span><span class="sxs-lookup"><span data-stu-id="c9e5c-246">The custom error page is the first step in a comprehensive error handling strategy for a website in production.</span></span> <span data-ttu-id="c9e5c-247">エラーの開発者向けの警告とその詳細をログ記録は、重要な手順ではもです。</span><span class="sxs-lookup"><span data-stu-id="c9e5c-247">Alerting the developer of the error and logging its details are also important steps.</span></span> <span data-ttu-id="c9e5c-248">次の 3 つのチュートリアルでは、エラーの通知とログ記録のための手法について説明します。</span><span class="sxs-lookup"><span data-stu-id="c9e5c-248">The next three tutorials explore techniques for error notification and logging.</span></span>

<span data-ttu-id="c9e5c-249">満足のプログラミングです。</span><span class="sxs-lookup"><span data-stu-id="c9e5c-249">Happy Programming!</span></span>

## <a name="further-reading"></a><span data-ttu-id="c9e5c-250">関連項目</span><span class="sxs-lookup"><span data-stu-id="c9e5c-250">Further Reading</span></span>

<span data-ttu-id="c9e5c-251">このチュートリアルで説明したトピックの詳細については、次の情報を参照してください。</span><span class="sxs-lookup"><span data-stu-id="c9e5c-251">For more information on the topics discussed in this tutorial, refer to the following resources:</span></span>

- [<span data-ttu-id="c9e5c-252">エラー ページ、もう 1 回</span><span class="sxs-lookup"><span data-stu-id="c9e5c-252">Error Pages, One More Time</span></span>](http://www.smashingmagazine.com/2009/01/29/404-error-pages-one-more-time/)
- [<span data-ttu-id="c9e5c-253">例外のデザインのガイドライン</span><span class="sxs-lookup"><span data-stu-id="c9e5c-253">Design Guidelines for Exceptions</span></span>](https://msdn.microsoft.com/library/ms229014.aspx)
- [<span data-ttu-id="c9e5c-254">わかりやすいエラー ページ</span><span class="sxs-lookup"><span data-stu-id="c9e5c-254">User-Friendly Error Pages</span></span>](http://aspnet.4guysfromrolla.com/articles/090606-1.aspx)
- [<span data-ttu-id="c9e5c-255">処理と例外をスロー</span><span class="sxs-lookup"><span data-stu-id="c9e5c-255">Handling and Throwing Exceptions</span></span>](https://msdn.microsoft.com/library/5b2yeyab.aspx)
- [<span data-ttu-id="c9e5c-256">ASP.NET でカスタム エラー ページを正しく使用</span><span class="sxs-lookup"><span data-stu-id="c9e5c-256">Properly Using Custom Error Pages in ASP.NET</span></span>](http://professionalaspnet.com/archive/2007/09/30/Properly-Using-Custom-Error-Pages-in-ASP.NET.aspx)

> [!div class="step-by-step"]
> <span data-ttu-id="c9e5c-257">[前へ](strategies-for-database-development-and-deployment-vb.md)
> [次へ](processing-unhandled-exceptions-vb.md)</span><span class="sxs-lookup"><span data-stu-id="c9e5c-257">[Previous](strategies-for-database-development-and-deployment-vb.md)
[Next](processing-unhandled-exceptions-vb.md)</span></span>

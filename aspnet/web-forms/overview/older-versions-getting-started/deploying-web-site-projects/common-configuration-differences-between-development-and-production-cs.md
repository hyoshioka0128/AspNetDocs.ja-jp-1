---
uid: web-forms/overview/older-versions-getting-started/deploying-web-site-projects/common-configuration-differences-between-development-and-production-cs
title: 開発と運用の間の一般的なC#構成の違い () |Microsoft Docs
author: rick-anderson
description: 前のチュートリアルでは、開発環境から運用環境に関連するすべてのファイルをコピーして、web サイトをデプロイしました。 しかし、
ms.author: riande
ms.date: 04/01/2009
ms.assetid: 721a5c37-7e21-48e0-832e-535c6351dcae
msc.legacyurl: /web-forms/overview/older-versions-getting-started/deploying-web-site-projects/common-configuration-differences-between-development-and-production-cs
msc.type: authoredcontent
ms.openlocfilehash: 60379c87a8cf58b89066a6070ac659e65930b4fa
ms.sourcegitcommit: 22fbd8863672c4ad6693b8388ad5c8e753fb41a2
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 11/28/2019
ms.locfileid: "74620420"
---
# <a name="common-configuration-differences-between-development-and-production-c"></a><span data-ttu-id="bb43e-104">開発と運用の間の一般的な構成の違い (C#)</span><span class="sxs-lookup"><span data-stu-id="bb43e-104">Common Configuration Differences Between Development and Production (C#)</span></span>

<span data-ttu-id="bb43e-105">[Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="bb43e-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

[<span data-ttu-id="bb43e-106">PDF のダウンロード</span><span class="sxs-lookup"><span data-stu-id="bb43e-106">Download PDF</span></span>](https://download.microsoft.com/download/E/8/9/E8920AE6-D441-41A7-8A77-9EF8FF970D8B/aspnet_tutorial05_ConfigDifferences_cs.pdf)

> <span data-ttu-id="bb43e-107">前のチュートリアルでは、開発環境から運用環境に関連するすべてのファイルをコピーして、web サイトをデプロイしました。</span><span class="sxs-lookup"><span data-stu-id="bb43e-107">In earlier tutorials we deployed our website by copying all of the pertinent files from the development environment to the production environment.</span></span> <span data-ttu-id="bb43e-108">ただし、環境によって構成に違いがあることは珍しくありません。そのため、各環境には一意の Web.config ファイルが必要です。</span><span class="sxs-lookup"><span data-stu-id="bb43e-108">However, it is not uncommon for there to be configuration differences between environments, which necessitates that each environment have a unique Web.config file.</span></span> <span data-ttu-id="bb43e-109">このチュートリアルでは、一般的な構成の違いについて説明し、個別の構成情報を保持するための戦略について説明します。</span><span class="sxs-lookup"><span data-stu-id="bb43e-109">This tutorial examines typical configuration differences and looks at strategies for maintaining separate configuration information.</span></span>

## <a name="introduction"></a><span data-ttu-id="bb43e-110">はじめに</span><span class="sxs-lookup"><span data-stu-id="bb43e-110">Introduction</span></span>

<span data-ttu-id="bb43e-111">最後の2つのチュートリアルでは、単純な web アプリケーションのデプロイについて紹介します。</span><span class="sxs-lookup"><span data-stu-id="bb43e-111">The last two tutorials walked through deploying a simple web application.</span></span> <span data-ttu-id="bb43e-112">[*Ftp クライアントを使用したサイトのデプロイ*](deploying-your-site-using-an-ftp-client-cs.md)に関するチュートリアルでは、スタンドアロン ftp クライアントを使用して、開発環境から運用環境に必要なファイルをコピーする方法について説明しました。</span><span class="sxs-lookup"><span data-stu-id="bb43e-112">The [*Deploying Your Site Using an FTP Client*](deploying-your-site-using-an-ftp-client-cs.md) tutorial showed how to use a stand-alone FTP client to copy the necessary files from the development environment up to production.</span></span> <span data-ttu-id="bb43e-113">前のチュートリアル「 [*Visual Studio を使用したサイト*](deploying-your-site-using-visual-studio-cs.md)のデプロイ」では、visual studio の [Web サイトツールのコピー] と [発行] オプションを使用したデプロイについて説明しました。</span><span class="sxs-lookup"><span data-stu-id="bb43e-113">The preceding tutorial, [*Deploying Your Site Using Visual Studio*](deploying-your-site-using-visual-studio-cs.md), looked at deployment using Visual Studio's Copy Web Site tool and Publish option.</span></span> <span data-ttu-id="bb43e-114">どちらのチュートリアルでも、運用環境のすべてのファイルは、開発環境のファイルのコピーでした。</span><span class="sxs-lookup"><span data-stu-id="bb43e-114">In both tutorials every file in the production environment was a copy of a file on the development environment.</span></span> <span data-ttu-id="bb43e-115">ただし、運用環境の構成ファイルは、開発環境とは異なる場合があります。</span><span class="sxs-lookup"><span data-stu-id="bb43e-115">However, it is not uncommon for configuration files in the production environment to differ from those in the development environment.</span></span> <span data-ttu-id="bb43e-116">Web アプリケーションの構成は `Web.config` ファイルに格納され、通常、データベース、web、電子メールサーバーなどの外部リソースに関する情報が含まれます。</span><span class="sxs-lookup"><span data-stu-id="bb43e-116">A web application's configuration is stored in the `Web.config` file and typically includes information about external resources, such as database, web, and email servers.</span></span> <span data-ttu-id="bb43e-117">また、ハンドルされない例外が発生した場合に実行するアクションなど、特定の状況におけるアプリケーションの動作も明らかにします。</span><span class="sxs-lookup"><span data-stu-id="bb43e-117">It also spells out the behavior of the application in certain situations, such as the course of action to take when an unhandled exception occurs.</span></span>

<span data-ttu-id="bb43e-118">Web アプリケーションを展開するときは、正しい構成情報が運用環境で終了することが重要です。</span><span class="sxs-lookup"><span data-stu-id="bb43e-118">When deploying a web application it is important that the correct configuration information end up in the production environment.</span></span> <span data-ttu-id="bb43e-119">ほとんどの場合、開発環境の `Web.config` ファイルを実稼働環境にそのままコピーすることはできません。</span><span class="sxs-lookup"><span data-stu-id="bb43e-119">In most cases the `Web.config` file in the development environment cannot be copied to the production environment as-is.</span></span> <span data-ttu-id="bb43e-120">代わりに、カスタマイズされたバージョンの `Web.config` を運用環境にアップロードする必要があります。</span><span class="sxs-lookup"><span data-stu-id="bb43e-120">Instead, a customized version of `Web.config` needs to be uploaded to production.</span></span> <span data-ttu-id="bb43e-121">このチュートリアルでは、いくつかの一般的な構成の違いについて簡単に説明します。また、環境間でさまざまな構成情報を維持するためのいくつかの手法についても説明します。</span><span class="sxs-lookup"><span data-stu-id="bb43e-121">This tutorial briefly reviews some of the more common configuration differences; it also summarizes some techniques for maintaining different configuration information between the environments.</span></span>

## <a name="typical-configuration-differences-between-the-development-and-production-environments"></a><span data-ttu-id="bb43e-122">開発環境と運用環境の一般的な構成の違い</span><span class="sxs-lookup"><span data-stu-id="bb43e-122">Typical Configuration Differences Between the Development and Production Environments</span></span>

<span data-ttu-id="bb43e-123">`Web.config` ファイルには、ASP.NET アプリケーションの構成情報が含まれています。</span><span class="sxs-lookup"><span data-stu-id="bb43e-123">The `Web.config` file includes an assortment of configuration information for an ASP.NET application.</span></span> <span data-ttu-id="bb43e-124">この構成情報の一部は、環境に関係なく同じです。</span><span class="sxs-lookup"><span data-stu-id="bb43e-124">Some of this configuration information is the same regardless of the environment.</span></span> <span data-ttu-id="bb43e-125">たとえば、`Web.config` ファイルの `<authentication>` 要素と `<authorization>` 要素に記載されている認証設定と URL 承認規則は、通常、環境に関係なく同じです。</span><span class="sxs-lookup"><span data-stu-id="bb43e-125">For instance, the authentication settings and URL authorization rules spelled out in the `Web.config` file's `<authentication>` and `<authorization>` elements are usually the same regardless of the environment.</span></span> <span data-ttu-id="bb43e-126">ただし、外部リソースに関する情報などの他の構成情報は、通常、環境によって異なります。</span><span class="sxs-lookup"><span data-stu-id="bb43e-126">But other configuration information - such as information about external resources - typically differs depending on the environment.</span></span>

<span data-ttu-id="bb43e-127">データベース接続文字列は、環境によって異なる構成情報の代表的な例です。</span><span class="sxs-lookup"><span data-stu-id="bb43e-127">Database connections strings are a prime example of configuration information that differs based on the environment.</span></span> <span data-ttu-id="bb43e-128">Web アプリケーションがデータベースサーバーと通信するときは、まず接続を確立する必要があり、[接続文字列](http://www.connectionstrings.com/Articles/Show/what-is-a-connection-string)を使用して処理を行います。</span><span class="sxs-lookup"><span data-stu-id="bb43e-128">When a web application communicates with a database server it must first establish a connection, and that is achieved through a [connection string](http://www.connectionstrings.com/Articles/Show/what-is-a-connection-string).</span></span> <span data-ttu-id="bb43e-129">データベース接続文字列は、web ページまたはデータベースに接続するコード内で直接ハードコーディングすることができますが、接続文字列情報が1つの一元化された場所にあるように、`Web.config`の[`<connectionStrings>` 要素](https://msdn.microsoft.com/library/bf7sd233.aspx)に配置することをお勧めします。</span><span class="sxs-lookup"><span data-stu-id="bb43e-129">While it is possible to hard-code the database connection string directly in the web pages or the code that connects to the database, it is best to place it `Web.config`'s [`<connectionStrings>` element](https://msdn.microsoft.com/library/bf7sd233.aspx) so that the connection string information is in a single, centralized location.</span></span> <span data-ttu-id="bb43e-130">開発時には、運用環境で使用されるデータベースとは異なるデータベースが使用されることがよくあります。このため、接続文字列情報は環境ごとに一意である必要があります。</span><span class="sxs-lookup"><span data-stu-id="bb43e-130">Oftentimes a different database is used during development than is used in production; consequently, the connection string information must be unique for each environment.</span></span>

> [!NOTE]
> <span data-ttu-id="bb43e-131">今後のチュートリアルでは、データドリブンアプリケーションのデプロイについて説明します。この時点で、データベース接続文字列を構成ファイルに格納する方法の詳細について説明します。</span><span class="sxs-lookup"><span data-stu-id="bb43e-131">Future tutorials explore deploying data-driven applications, at which point we'll dive into the specifics of how database connection strings are stored in the configuration file.</span></span>

<span data-ttu-id="bb43e-132">開発環境と運用環境の動作はかなり異なります。</span><span class="sxs-lookup"><span data-stu-id="bb43e-132">The intended behavior of the development and production environments differs substantially.</span></span> <span data-ttu-id="bb43e-133">開発環境での web アプリケーションの作成、テスト、およびデバッグは、開発者の小さなグループによって行われます。</span><span class="sxs-lookup"><span data-stu-id="bb43e-133">A web application in the development environment is being created, tested, and debugged by a small group of developers.</span></span> <span data-ttu-id="bb43e-134">運用環境では、同じアプリケーションが多数の異なる同時ユーザーによってアクセスされています。</span><span class="sxs-lookup"><span data-stu-id="bb43e-134">In the production environment that same application is being visited by many different simultaneous users.</span></span> <span data-ttu-id="bb43e-135">ASP.NET には、開発者がアプリケーションのテストとデバッグを支援する多くの機能が含まれていますが、運用環境でのパフォーマンスとセキュリティ上の理由から、これらの機能を無効にする必要があります。</span><span class="sxs-lookup"><span data-stu-id="bb43e-135">ASP.NET includes a number of features that help developers in testing and debugging an application, but these features should be disabled for performance and security reasons when in the production environment.</span></span> <span data-ttu-id="bb43e-136">そのような構成設定をいくつか見てみましょう。</span><span class="sxs-lookup"><span data-stu-id="bb43e-136">Let's look at a few such configuration settings.</span></span>

### <a name="configuration-settings-that-impact-performance"></a><span data-ttu-id="bb43e-137">パフォーマンスに影響する構成設定</span><span class="sxs-lookup"><span data-stu-id="bb43e-137">Configuration Settings That Impact Performance</span></span>

<span data-ttu-id="bb43e-138">ASP.NET ページに初めてアクセスしたとき (または、初めて変更された後)、その宣言型マークアップをクラスに変換し、このクラスをコンパイルする必要があります。</span><span class="sxs-lookup"><span data-stu-id="bb43e-138">When an ASP.NET page is visited for the first time (or the first time after it has changed), its declarative markup must be converted into a class and this class must be compiled.</span></span> <span data-ttu-id="bb43e-139">Web アプリケーションが自動コンパイルを使用する場合は、ページの分離コードクラスもコンパイルする必要があります。</span><span class="sxs-lookup"><span data-stu-id="bb43e-139">If the web application uses automatic compilation then the page's code-behind class needs to be compiled, too.</span></span> <span data-ttu-id="bb43e-140">`Web.config` ファイルの[`<compilation>` 要素](https://msdn.microsoft.com/library/s10awwz0.aspx)を使用して、一連のコンパイルオプションを構成できます。</span><span class="sxs-lookup"><span data-stu-id="bb43e-140">You can configure an assortment of compilation options via the `Web.config` file's [`<compilation>` element](https://msdn.microsoft.com/library/s10awwz0.aspx).</span></span>

<span data-ttu-id="bb43e-141">Debug 属性は、`<compilation>` 要素の中で最も重要な属性の1つです。</span><span class="sxs-lookup"><span data-stu-id="bb43e-141">The debug attribute is one of the most important attributes in the `<compilation>` element.</span></span> <span data-ttu-id="bb43e-142">`debug` 属性が "true" に設定されている場合、コンパイルされたアセンブリには、Visual Studio でアプリケーションをデバッグするときに必要なデバッグシンボルが含まれます。</span><span class="sxs-lookup"><span data-stu-id="bb43e-142">If the `debug` attribute is set to "true" then the compiled assemblies include debug symbols, which are needed when debugging an application in Visual Studio.</span></span> <span data-ttu-id="bb43e-143">ただし、デバッグシンボルはアセンブリのサイズを増やし、コードの実行時に追加のメモリ要件を強制します。</span><span class="sxs-lookup"><span data-stu-id="bb43e-143">But debug symbols increase the size of the assembly and impose additional memory requirements when running the code.</span></span> <span data-ttu-id="bb43e-144">さらに、`debug` 属性が "true" に設定されている場合、`WebResource.axd` によって返されるコンテンツはキャッシュされません。つまり、ユーザーがページにアクセスするたびに、`WebResource.axd`によって返された静的コンテンツを再ダウンロードする必要があります。</span><span class="sxs-lookup"><span data-stu-id="bb43e-144">Furthermore, when the `debug` attribute is set to "true" any content returned by `WebResource.axd` is not cached, meaning that each time a user visits a page they will need to re-download the static content returned by `WebResource.axd`.</span></span>

> [!NOTE]
> <span data-ttu-id="bb43e-145">`WebResource.axd` は、ASP.NET 2.0 で導入された組み込みの HTTP ハンドラーであり、サーバーコントロールは、スクリプトファイル、画像、CSS ファイル、その他のコンテンツなどの埋め込みリソースを取得するために使用します。</span><span class="sxs-lookup"><span data-stu-id="bb43e-145">`WebResource.axd` is a built-in HTTP Handler introduced in ASP.NET 2.0 that server controls use to retrieve embedded resources, such as script files, images, CSS files, and other content.</span></span> <span data-ttu-id="bb43e-146">`WebResource.axd` のしくみと、それを使用してカスタムサーバーコントロールから埋め込みリソースにアクセスする方法の詳細については、「 [`WebResource.axd`を使用した URL を使用した埋め込みリソース](http://aspnet.4guysfromrolla.com/articles/080906-1.aspx)へのアクセス」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="bb43e-146">For more information on how `WebResource.axd` works and how you can use it to access embedded resources from your custom server controls, see [Accessing Embedded Resources Through a URL Using `WebResource.axd`](http://aspnet.4guysfromrolla.com/articles/080906-1.aspx).</span></span>

<span data-ttu-id="bb43e-147">`<compilation>` 要素の `debug` 属性は、通常、開発環境では "true" に設定されます。</span><span class="sxs-lookup"><span data-stu-id="bb43e-147">The `<compilation>` element's `debug` attribute is usually set to "true" in the development environment.</span></span> <span data-ttu-id="bb43e-148">実際、web アプリケーションをデバッグするには、この属性を "true" に設定する必要があります。Visual Studio から ASP.NET アプリケーションをデバッグしようとしたときに、`debug` 属性が "false" に設定されている場合、Visual Studio では、`debug` 属性が "true" に設定され、この変更を行うようになるまで、アプリケーションをデバッグできないことを示すメッセージが表示されます。</span><span class="sxs-lookup"><span data-stu-id="bb43e-148">In fact, this attribute must be set to "true" in order to debug a web application; if you try to debug an ASP.NET application from Visual Studio and the `debug` attribute is set to "false", Visual Studio will display a message explaining that the application cannot be debugged until the `debug` attribute is set to "true" and will offer to make this change for you.</span></span>

<span data-ttu-id="bb43e-149">運用環境では、パフォーマンスに影響を与えるため、`debug` 属性を "true" に設定することはでき**ません**。</span><span class="sxs-lookup"><span data-stu-id="bb43e-149">You should **never** have the `debug` attribute set to "true" in a production environment because of its impact on performance.</span></span> <span data-ttu-id="bb43e-150">このトピックの詳細については、 [Scott Guthrie](https://weblogs.asp.net/scottgu/)のブログ記事「 [`debug="true"` が有効になっている運用環境の ASP.NET アプリケーションを実行しない](https://weblogs.asp.net/scottgu/442448)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="bb43e-150">For a more thorough discussion on this topic, refer to [Scott Guthrie](https://weblogs.asp.net/scottgu/)'s blog post, [Don't Run Production ASP.NET Applications With `debug="true"` Enabled](https://weblogs.asp.net/scottgu/442448).</span></span>

### <a name="custom-errors-and-tracing"></a><span data-ttu-id="bb43e-151">カスタムエラーとトレース</span><span class="sxs-lookup"><span data-stu-id="bb43e-151">Custom Errors and Tracing</span></span>

<span data-ttu-id="bb43e-152">ASP.NET アプリケーションでハンドルされない例外が発生すると、次の3つのうちのいずれかが発生した時点で、ランタイムに対してバブルアップします。</span><span class="sxs-lookup"><span data-stu-id="bb43e-152">When an unhandled exception occurs in an ASP.NET application it bubbles up to the runtime at which point one of three things happens:</span></span>

- <span data-ttu-id="bb43e-153">汎用ランタイムエラーメッセージが表示されます。</span><span class="sxs-lookup"><span data-stu-id="bb43e-153">A generic runtime error message is displayed.</span></span> <span data-ttu-id="bb43e-154">このページでは、ランタイムエラーが発生したことがユーザーに通知されますが、エラーの詳細は提供されません。</span><span class="sxs-lookup"><span data-stu-id="bb43e-154">This page informs the user that there was a runtime error, but does not provide any details about the error.</span></span>
- <span data-ttu-id="bb43e-155">例外の詳細メッセージが表示されます。これには、スローされた例外に関する情報が含まれます。</span><span class="sxs-lookup"><span data-stu-id="bb43e-155">An exception details message is displayed, which includes information on the exception that was just thrown.</span></span>
- <span data-ttu-id="bb43e-156">カスタムエラーページが表示されます。これは、目的のメッセージを表示するために作成する ASP.NET ページです。</span><span class="sxs-lookup"><span data-stu-id="bb43e-156">A custom error page is displayed, which is an ASP.NET page that you create that displays any message you desire.</span></span>

<span data-ttu-id="bb43e-157">未処理の例外が発生した場合の処理は、`Web.config` ファイルの[`<customErrors>` セクション](https://msdn.microsoft.com/library/h0hfz6fc.aspx)によって異なります。</span><span class="sxs-lookup"><span data-stu-id="bb43e-157">What happens in the face of an unhandled exception depends on the `Web.config` file's [`<customErrors>` section](https://msdn.microsoft.com/library/h0hfz6fc.aspx).</span></span>

<span data-ttu-id="bb43e-158">アプリケーションを開発およびテストする場合は、ブラウザーで例外の詳細を確認するのに役立ちます。</span><span class="sxs-lookup"><span data-stu-id="bb43e-158">When developing and testing an application it helps to see details of any exception in the browser.</span></span> <span data-ttu-id="bb43e-159">ただし、運用環境のアプリケーションで例外の詳細を表示すると、セキュリティ上のリスクが生じる可能性があります。</span><span class="sxs-lookup"><span data-stu-id="bb43e-159">However, showing exception details in an application on production is a potential security risk.</span></span> <span data-ttu-id="bb43e-160">さらに、unflattering があり、web サイトが不自然見えるになります。</span><span class="sxs-lookup"><span data-stu-id="bb43e-160">Moreover, it's unflattering and makes your website look unprofessional.</span></span> <span data-ttu-id="bb43e-161">理想的には、ハンドルされない例外が発生した場合に、開発環境の web アプリケーションは例外の詳細を表示しますが、運用環境の同じアプリケーションではカスタムエラーページが表示されます。</span><span class="sxs-lookup"><span data-stu-id="bb43e-161">Ideally, in the event of an unhandled exception a web application in the development environment will show the exception's details while the same application in production will show a custom error page.</span></span>

> [!NOTE]
> <span data-ttu-id="bb43e-162">既定の `<customErrors>` セクションの設定では、ページが localhost を介してアクセスされている場合にのみ例外の詳細メッセージが表示され、それ以外の場合は汎用ランタイムエラーページが表示されます。</span><span class="sxs-lookup"><span data-stu-id="bb43e-162">The default `<customErrors>` section setting shows the exception details message only when the page is being visited through localhost, and shows the generic runtime error page otherwise.</span></span> <span data-ttu-id="bb43e-163">これは理想的ではありませんが、既定の動作によって、ローカル以外の訪問者に対する例外の詳細が明らかにならないことを理解しておく必要があります。</span><span class="sxs-lookup"><span data-stu-id="bb43e-163">This isn't ideal, but it's assuring to know that the default behavior doesn't reveal exception details to non-local visitors.</span></span> <span data-ttu-id="bb43e-164">今後のチュートリアルでは、`<customErrors>` のセクションについて詳しく説明し、運用環境でエラーが発生したときにカスタムエラーページを表示する方法を示します。</span><span class="sxs-lookup"><span data-stu-id="bb43e-164">A future tutorial examines the `<customErrors>` section in more detail and shows how to have a custom error page shown when an error occurs in production.</span></span>

<span data-ttu-id="bb43e-165">開発時に役立つもう1つの ASP.NET 機能はトレースです。</span><span class="sxs-lookup"><span data-stu-id="bb43e-165">Another ASP.NET feature that is useful during development is tracing.</span></span> <span data-ttu-id="bb43e-166">トレースを有効にすると、受信した各要求に関する情報が記録され、最近の要求の詳細を表示するための特別な web ページ `Trace.axd`が提供されます。</span><span class="sxs-lookup"><span data-stu-id="bb43e-166">Tracing, if enabled, records information about each incoming request and provides a special web page, `Trace.axd`, for viewing recent request details.</span></span> <span data-ttu-id="bb43e-167">トレースは、`Web.config`の[`<trace>` 要素](https://msdn.microsoft.com/library/6915t83k.aspx)を使用して有効にし、構成することができます。</span><span class="sxs-lookup"><span data-stu-id="bb43e-167">You can turn on and configure tracing via the [`<trace>` element](https://msdn.microsoft.com/library/6915t83k.aspx) in `Web.config`.</span></span>

<span data-ttu-id="bb43e-168">トレースを有効にした場合は、運用環境で無効になっていることを確認してください。</span><span class="sxs-lookup"><span data-stu-id="bb43e-168">If you enable tracing make sure that it is disabled in production.</span></span> <span data-ttu-id="bb43e-169">トレース情報には cookie、セッションデータ、およびその他の機密情報が含まれているため、運用環境でトレースを無効にすることが重要です。</span><span class="sxs-lookup"><span data-stu-id="bb43e-169">Because the trace information includes cookies, session data, and other potentially sensitive information, it is important to disable tracing in production.</span></span> <span data-ttu-id="bb43e-170">既定では、トレースは無効になっています。また、`Trace.axd` ファイルには localhost を通じてのみアクセスできます。</span><span class="sxs-lookup"><span data-stu-id="bb43e-170">The good news is that, by default, tracing is disabled and the `Trace.axd` file is only accessible through localhost.</span></span> <span data-ttu-id="bb43e-171">開発でこれらの既定の設定を変更した場合は、運用環境でそれらの設定がオフになっていることを確認してください。</span><span class="sxs-lookup"><span data-stu-id="bb43e-171">If you change these default settings in development make sure that they are turned back off in production.</span></span>

## <a name="techniques-for-maintaining-separate-configuration-information"></a><span data-ttu-id="bb43e-172">個別の構成情報を保持するための手法</span><span class="sxs-lookup"><span data-stu-id="bb43e-172">Techniques for Maintaining Separate Configuration Information</span></span>

<span data-ttu-id="bb43e-173">開発環境と運用環境の構成設定が異なると、デプロイプロセスが複雑になります。</span><span class="sxs-lookup"><span data-stu-id="bb43e-173">Having different configuration settings in the development and production environments complicates the deployment process.</span></span> <span data-ttu-id="bb43e-174">前の2つのチュートリアルでは、デプロイプロセスによって、必要なすべてのファイルが開発環境から運用環境にコピーされましたが、その方法は、両方の環境で構成情報が同じ場合にのみ機能します。</span><span class="sxs-lookup"><span data-stu-id="bb43e-174">In the previous two tutorials the deployment process involved copying all of the necessary files from development to production, but that approach only works if the configuration information is the same in both environments.</span></span> <span data-ttu-id="bb43e-175">さまざまな構成情報を使用してアプリケーションを展開するには、さまざまな方法があります。</span><span class="sxs-lookup"><span data-stu-id="bb43e-175">There are a variety of techniques for deploying an application with varying configuration information.</span></span> <span data-ttu-id="bb43e-176">ホストされている web アプリケーションに対して、これらのオプションの一部をカタログ化してみましょう。</span><span class="sxs-lookup"><span data-stu-id="bb43e-176">Let's catalog some of these options for hosted web applications.</span></span>

### <a name="manually-deploying-the-production-environment-configuration-file"></a><span data-ttu-id="bb43e-177">運用環境の構成ファイルを手動で展開する</span><span class="sxs-lookup"><span data-stu-id="bb43e-177">Manually Deploying the Production Environment Configuration File</span></span>

<span data-ttu-id="bb43e-178">最も簡単な方法は、`Web.config` ファイルの2つのバージョンを保持することです。1つは開発環境用で、もう1つは運用環境用です。</span><span class="sxs-lookup"><span data-stu-id="bb43e-178">The simplest approach is to maintain two versions of the `Web.config` file: one for the development environment and one for the production environment.</span></span> <span data-ttu-id="bb43e-179">サイトを運用環境に展開するには、`Web.config` ファイルを*除き*、開発環境で運用サーバーにすべてのファイルをコピーすることがあります。</span><span class="sxs-lookup"><span data-stu-id="bb43e-179">Deploying a site to production entails copying all of the files to the production server in the development environment *except* for the `Web.config` file.</span></span> <span data-ttu-id="bb43e-180">代わりに、運用環境固有の `Web.config` ファイルが運用環境にコピーされます。</span><span class="sxs-lookup"><span data-stu-id="bb43e-180">Instead, the production environment-specific `Web.config` file would be copied to production.</span></span>

<span data-ttu-id="bb43e-181">この方法は非常に洗練されていませんが、構成情報があまり頻繁に変更されないため、簡単に実装できます。</span><span class="sxs-lookup"><span data-stu-id="bb43e-181">This approach is not very sophisticated, but it is easy to implement because configuration information changes infrequently.</span></span> <span data-ttu-id="bb43e-182">これは、1つの web サーバーでホストされ、構成情報が頻繁に変更されない小規模な開発チームのアプリケーションに最適です。</span><span class="sxs-lookup"><span data-stu-id="bb43e-182">It works best for applications with a small development team that are hosted on a single web server and whose configuration information is infrequently changed.</span></span> <span data-ttu-id="bb43e-183">スタンドアロン FTP クライアントを使用してアプリケーションファイルを手動で展開する場合は、この方法が最も高くなります。</span><span class="sxs-lookup"><span data-stu-id="bb43e-183">It's most tenable when manually deploying the application files using a stand-alone FTP client.</span></span> <span data-ttu-id="bb43e-184">Visual Studio の [Web サイトのコピー] ツールまたは [発行] オプションを使用する場合は、展開する前に、配置固有の `Web.config` ファイルを実稼働固有のファイルにスワップアウトしてから、配置の完了後にスワップする必要があります。</span><span class="sxs-lookup"><span data-stu-id="bb43e-184">When using Visual Studio's Copy Web Site tool or Publish option you'll need to first swap out the deployment-specific `Web.config` file with the production-specific one before deploying, and then swap them back after deployment completes.</span></span>

### <a name="change-the-configuration-during-the-build-or-deployment-process"></a><span data-ttu-id="bb43e-185">ビルドまたは配置プロセス中に構成を変更する</span><span class="sxs-lookup"><span data-stu-id="bb43e-185">Change the Configuration During the Build or Deployment Process</span></span>

<span data-ttu-id="bb43e-186">これまでに説明したのは、アドホックビルドとデプロイプロセスを想定したものです。</span><span class="sxs-lookup"><span data-stu-id="bb43e-186">The discussions thus far have assumed an ad-hoc build and deployment process.</span></span> <span data-ttu-id="bb43e-187">多くの大規模なソフトウェアプロジェクトには、オープンソース、ホーム拡張、またはサードパーティ製のツールを利用する、より形式化されたプロセスがあります。</span><span class="sxs-lookup"><span data-stu-id="bb43e-187">Many larger software projects have more formalized processes that make use of open-source, home-grown, or third-party tools.</span></span> <span data-ttu-id="bb43e-188">このようなプロジェクトでは、運用環境にプッシュする前に構成情報を適切に変更するように、ビルドまたは配置プロセスをカスタマイズできます。</span><span class="sxs-lookup"><span data-stu-id="bb43e-188">For such projects you can likely customize the build or deployment process to appropriately modify the configuration information before it is pushed to production.</span></span> <span data-ttu-id="bb43e-189">[MSBuild](http://en.wikipedia.org/wiki/MSBuild)、 [NAnt](http://nant.sourceforge.net/)、またはその他のビルドツールを使用して web アプリケーションをビルドする場合、ビルドステップを追加して、`Web.config` ファイルを変更して、実稼働固有の設定を含めることができます。</span><span class="sxs-lookup"><span data-stu-id="bb43e-189">If you build your web application using [MSBuild](http://en.wikipedia.org/wiki/MSBuild), [NAnt](http://nant.sourceforge.net/), or some other build tool, you can likely add a build step to modify the `Web.config` file to include the production-specific settings.</span></span> <span data-ttu-id="bb43e-190">または、展開ワークフローがプログラムを使用してソース管理サーバーに接続し、適切な `Web.config` ファイルを取得することもできます。</span><span class="sxs-lookup"><span data-stu-id="bb43e-190">Or your deployment workflow could programmatically connect to the source control server and retrieve the appropriate `Web.config` file.</span></span>

<span data-ttu-id="bb43e-191">運用環境に適切な構成情報を取得する実際の方法は、ツールとワークフローによって大きく異なります。</span><span class="sxs-lookup"><span data-stu-id="bb43e-191">The actual approach for getting the appropriate configuration information to production varies widely based on your tools and workflow.</span></span> <span data-ttu-id="bb43e-192">そのため、このトピックについては詳しく説明しません。</span><span class="sxs-lookup"><span data-stu-id="bb43e-192">As such, we will not delve into this topic further.</span></span> <span data-ttu-id="bb43e-193">MSBuild や NAnt などの一般的なビルドツールを使用している場合は、web 検索を使用して、これらのツールに固有のデプロイの記事とチュートリアルを見つけることができます。</span><span class="sxs-lookup"><span data-stu-id="bb43e-193">If you are using a popular build tool like MSBuild or NAnt you can find deployment articles and tutorials specific to these tools through a web search.</span></span>

### <a name="managing-configuration-differences-via-the-web-deployment-project-add-in"></a><span data-ttu-id="bb43e-194">Web 配置プロジェクトアドインを使用した構成の違いの管理</span><span class="sxs-lookup"><span data-stu-id="bb43e-194">Managing Configuration Differences via the Web Deployment Project Add-In</span></span>

<span data-ttu-id="bb43e-195">2006では、Microsoft は Visual Studio 2005 用の Web 開発プロジェクトアドインをリリースしました。</span><span class="sxs-lookup"><span data-stu-id="bb43e-195">In 2006 Microsoft released the Web Development Project Add-In for Visual Studio 2005.</span></span> <span data-ttu-id="bb43e-196">Visual Studio 2008 用のアドインが2008でリリースされました。</span><span class="sxs-lookup"><span data-stu-id="bb43e-196">An Add-In for Visual Studio 2008 was released in 2008.</span></span> <span data-ttu-id="bb43e-197">このアドインを使用すると、ASP.NET 開発者は web アプリケーションプロジェクトと共に個別の Web 配置プロジェクトを作成できます。このプロジェクトは、ビルドされると、web アプリケーションを明示的にコンパイルし、ローカル出力ディレクトリに配置するためにファイルをコピーします。</span><span class="sxs-lookup"><span data-stu-id="bb43e-197">This Add-In allows for ASP.NET developers to create a separate Web Deployment Project alongside their web application project that, when built, explicitly compiles the web application and copies the files to deploy to a local output directory.</span></span> <span data-ttu-id="bb43e-198">Web アプリケーションプロジェクトでは、バックグラウンドで MSBuild を使用します。</span><span class="sxs-lookup"><span data-stu-id="bb43e-198">The Web Application Project uses MSBuild behind the scenes.</span></span>

<span data-ttu-id="bb43e-199">既定では、開発環境の `Web.config` ファイルは出力ディレクトリにコピーされますが、Web 配置プロジェクトを設定して、</span><span class="sxs-lookup"><span data-stu-id="bb43e-199">By default, the development environment's `Web.config` file is copied to the output directory, but you can setup the Web Deployment Project to customize the</span></span>

<span data-ttu-id="bb43e-200">このディレクトリにコピーされる構成情報は、次の方法で設定します。</span><span class="sxs-lookup"><span data-stu-id="bb43e-200">configuration information that gets copied to this directory in the following ways:</span></span>

- <span data-ttu-id="bb43e-201">置換するセクションと置換テキストを含む XML ファイルを指定する、`Web.config` file セクションの置換。</span><span class="sxs-lookup"><span data-stu-id="bb43e-201">Via `Web.config` file section replacement, in which you specify the section to replace and an XML file that contains the replacement text.</span></span>
- <span data-ttu-id="bb43e-202">外部構成ソースファイルへのパスを指定する。</span><span class="sxs-lookup"><span data-stu-id="bb43e-202">By providing a path to an external configuration source file.</span></span> <span data-ttu-id="bb43e-203">このオプションを選択すると、Web 配置プロジェクトは、(開発環境で使用される `Web.config` ファイルではなく) 特定の `Web.config` ファイルを出力ディレクトリにコピーします。</span><span class="sxs-lookup"><span data-stu-id="bb43e-203">With this option selected, the Web Deployment Project copies a particular `Web.config` file to the output directory (rather than the `Web.config` file used in the development environment).</span></span>
- <span data-ttu-id="bb43e-204">Web 配置プロジェクトによって使用される MSBuild ファイルにカスタム規則を追加します。</span><span class="sxs-lookup"><span data-stu-id="bb43e-204">By adding custom rules to the MSBuild file used by the Web Deployment Project.</span></span>

<span data-ttu-id="bb43e-205">Web アプリケーションを配置するには、Web 配置プロジェクトをビルドし、プロジェクトの出力フォルダーから運用環境にファイルをコピーします。</span><span class="sxs-lookup"><span data-stu-id="bb43e-205">To deploy the web application build the Web Deployment Project and then copy the files from the project's output folder to the production environment.</span></span>

<span data-ttu-id="bb43e-206">Web デプロイプロジェクトの使用方法の詳細については、 [MSDN マガジン](https://msdn.microsoft.com/magazine/default.aspx)の2007年4月の問題から[この web デプロイプロジェクト](https://msdn.microsoft.com/magazine/cc163448.aspx)に関する記事をご覧ください。または、このチュートリアルの最後にある「関連項目」のリンクを参照してください。</span><span class="sxs-lookup"><span data-stu-id="bb43e-206">To learn more about using the Web Deployment Project check out [this Web Deployment Projects article](https://msdn.microsoft.com/magazine/cc163448.aspx) from the April 2007 issue of [MSDN Magazine](https://msdn.microsoft.com/magazine/default.aspx), or consult the links in the Further Reading section at the end of this tutorial.</span></span>

> [!NOTE]
> <span data-ttu-id="bb43e-207">Web 配置プロジェクトは Visual Studio アドインとして実装されており、Visual Studio Express エディション (Visual Web Developer を含む) ではアドインがサポートされていないため、Visual Web Developer では Web 配置プロジェクトを使用できません。</span><span class="sxs-lookup"><span data-stu-id="bb43e-207">You cannot use the Web Deployment Project with Visual Web Developer because the Web Deployment Project is implemented as a Visual Studio Add-In and the Visual Studio Express Editions (including Visual Web Developer) do not support Add-Ins.</span></span>

## <a name="summary"></a><span data-ttu-id="bb43e-208">要約</span><span class="sxs-lookup"><span data-stu-id="bb43e-208">Summary</span></span>

<span data-ttu-id="bb43e-209">開発における web アプリケーションの外部リソースと動作は、通常、同じアプリケーションが運用環境にある場合とは異なります。</span><span class="sxs-lookup"><span data-stu-id="bb43e-209">The external resources and behavior of a web application in development are typically different than when the same application is in production.</span></span> <span data-ttu-id="bb43e-210">たとえば、データベース接続文字列、コンパイルオプション、および処理されない例外が発生した場合の動作は、通常、環境によって異なります。</span><span class="sxs-lookup"><span data-stu-id="bb43e-210">For instance, database connection strings, compilation options, and the behavior when an unhandled exception occurs commonly differ between environments.</span></span> <span data-ttu-id="bb43e-211">デプロイプロセスでは、これらの違いに対応する必要があります。</span><span class="sxs-lookup"><span data-stu-id="bb43e-211">The deployment process must accommodate these differences.</span></span> <span data-ttu-id="bb43e-212">このチュートリアルで説明したように、最も簡単な方法は、代替構成ファイルを運用環境に手動でコピーすることです。</span><span class="sxs-lookup"><span data-stu-id="bb43e-212">As we discussed in this tutorial, the simplest approach is to manually copy an alternate configuration file to the production environment.</span></span> <span data-ttu-id="bb43e-213">Web 配置プロジェクトアドインを使用する場合や、このようなカスタマイズに対応できる、より形式化されたビルドまたは展開プロセスを使用する場合は、より洗練されたソリューションが可能です。</span><span class="sxs-lookup"><span data-stu-id="bb43e-213">More elegant solutions are possible when using the Web Deployment Project Add-In or with a more formalized build or deployment process that can accommodate such customizations.</span></span>

<span data-ttu-id="bb43e-214">プログラミングを楽しんでください。</span><span class="sxs-lookup"><span data-stu-id="bb43e-214">Happy Programming!</span></span>

### <a name="further-reading"></a><span data-ttu-id="bb43e-215">関連項目</span><span class="sxs-lookup"><span data-stu-id="bb43e-215">Further Reading</span></span>

<span data-ttu-id="bb43e-216">このチュートリアルで説明しているトピックの詳細については、次のリソースを参照してください。</span><span class="sxs-lookup"><span data-stu-id="bb43e-216">For more information on the topics discussed in this tutorial, refer to the following resources:</span></span>

- [<span data-ttu-id="bb43e-217">接続文字列の説明</span><span class="sxs-lookup"><span data-stu-id="bb43e-217">Connection Strings Explained</span></span>](http://www.connectionstrings.com/Articles/Show/what-is-a-connection-string)
- [<span data-ttu-id="bb43e-218">データベース接続文字列 @ ConnectionStrings.com</span><span class="sxs-lookup"><span data-stu-id="bb43e-218">Database Connection Strings @ ConnectionStrings.com</span></span>](http://www.connectionstrings.com/)
- [<span data-ttu-id="bb43e-219">`debug="true"` が有効になっている運用環境の ASP.NET アプリケーションを実行しない</span><span class="sxs-lookup"><span data-stu-id="bb43e-219">Don't Run Production ASP.NET Applications with `debug="true"` Enabled</span></span>](https://weblogs.asp.net/scottgu/Don_1920_t-run-production-ASP.NET-Applications-with-debug_3D001D20_true_1D20_-enabled)
- [<span data-ttu-id="bb43e-220">未処理の例外への適切な応答-ユーザーフレンドリなエラーページの表示</span><span class="sxs-lookup"><span data-stu-id="bb43e-220">Gracefully Responding to Unhandled Exceptions - Displaying User-Friendly Error Pages</span></span>](http://aspnet.4guysfromrolla.com/articles/090606-1.aspx)
- [<span data-ttu-id="bb43e-221">操作方法: Visual Studio 2008 Web 配置プロジェクトを使用する</span><span class="sxs-lookup"><span data-stu-id="bb43e-221">How Do I: Use a Visual Studio 2008 Web Deployment Project?</span></span>](../../../videos/how-do-i/how-do-i-use-a-visual-studio-2008-web-deployment-project.md)
- [<span data-ttu-id="bb43e-222">データベースを配置するときのキーの構成設定</span><span class="sxs-lookup"><span data-stu-id="bb43e-222">Key Configuration Settings When Deploying a Database</span></span>](http://aspnet.4guysfromrolla.com/articles/121008-1.aspx)
- <span data-ttu-id="bb43e-223">Visual studio [2008 web 配置プロジェクトのダウンロード](https://www.microsoft.com/downloads/details.aspx?FamilyId=0AA30AE8-C73B-4BDD-BB1B-FE697256C459&amp;displaylang=en) | [Visual Studio 2005 web 配置プロジェクトのダウンロード](https://download.microsoft.com/download/9/4/9/9496adc4-574e-4043-bb70-bc841e27f13c/WebDeploymentSetup.msi)</span><span class="sxs-lookup"><span data-stu-id="bb43e-223">[Visual Studio 2008 Web Deployment Projects Download](https://www.microsoft.com/downloads/details.aspx?FamilyId=0AA30AE8-C73B-4BDD-BB1B-FE697256C459&amp;displaylang=en) | [Visual Studio 2005 Web Deployment Projects Download](https://download.microsoft.com/download/9/4/9/9496adc4-574e-4043-bb70-bc841e27f13c/WebDeploymentSetup.msi)</span></span>
- <span data-ttu-id="bb43e-224">[Vs 2008 Web 配置](https://weblogs.asp.net/scottgu/archive/2005/11/06/429723.aspx)プロジェクト | [Vs 2008 web 配置プロジェクトのサポートがリリース](https://weblogs.asp.net/scottgu/archive/2008/01/28/vs-2008-web-deployment-project-support-released.aspx)されました</span><span class="sxs-lookup"><span data-stu-id="bb43e-224">[VS 2008 Web Deployment Projects](https://weblogs.asp.net/scottgu/archive/2005/11/06/429723.aspx) | [VS 2008 Web Deployment Project Support Released](https://weblogs.asp.net/scottgu/archive/2008/01/28/vs-2008-web-deployment-project-support-released.aspx)</span></span>
- [<span data-ttu-id="bb43e-225">Web 配置プロジェクト</span><span class="sxs-lookup"><span data-stu-id="bb43e-225">Web Deployment Projects</span></span>](https://msdn.microsoft.com/magazine/cc163448.aspx)

> [!div class="step-by-step"]
> <span data-ttu-id="bb43e-226">[前へ](deploying-your-site-using-visual-studio-cs.md)
> [次へ](core-differences-between-iis-and-the-asp-net-development-server-cs.md)</span><span class="sxs-lookup"><span data-stu-id="bb43e-226">[Previous](deploying-your-site-using-visual-studio-cs.md)
[Next](core-differences-between-iis-and-the-asp-net-development-server-cs.md)</span></span>

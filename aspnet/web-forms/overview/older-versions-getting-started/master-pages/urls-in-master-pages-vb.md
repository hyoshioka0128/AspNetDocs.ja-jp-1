---
uid: web-forms/overview/older-versions-getting-started/master-pages/urls-in-master-pages-vb
title: マスターページの Url (VB) |Microsoft Docs
author: rick-anderson
description: マスターページファイルがコンテンツページとは異なる相対ディレクトリにあることが原因で、マスターページ内の Url がどのように壊れるかを説明します。 リベースを確認します...
ms.author: riande
ms.date: 06/10/2008
ms.assetid: 43d1e83c-0092-4dcf-977c-e709c4dce7c3
msc.legacyurl: /web-forms/overview/older-versions-getting-started/master-pages/urls-in-master-pages-vb
msc.type: authoredcontent
ms.openlocfilehash: 01627988f68bb619969a5fe3cfaae68fe70b5d4f
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 03/06/2020
ms.locfileid: "78441106"
---
# <a name="urls-in-master-pages-vb"></a><span data-ttu-id="6f21b-104">マスター ページの URL (VB)</span><span class="sxs-lookup"><span data-stu-id="6f21b-104">URLs in Master Pages (VB)</span></span>

<span data-ttu-id="6f21b-105">[Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="6f21b-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="6f21b-106">[コードのダウンロード](https://download.microsoft.com/download/e/e/f/eef369f5-743a-4a52-908f-b6532c4ce0a4/ASPNET_MasterPages_Tutorial_04_VB.zip)または[PDF のダウンロード](https://download.microsoft.com/download/8/f/6/8f6349e4-6554-405a-bcd7-9b094ba5089a/ASPNET_MasterPages_Tutorial_04_VB.pdf)</span><span class="sxs-lookup"><span data-stu-id="6f21b-106">[Download Code](https://download.microsoft.com/download/e/e/f/eef369f5-743a-4a52-908f-b6532c4ce0a4/ASPNET_MasterPages_Tutorial_04_VB.zip) or [Download PDF](https://download.microsoft.com/download/8/f/6/8f6349e4-6554-405a-bcd7-9b094ba5089a/ASPNET_MasterPages_Tutorial_04_VB.pdf)</span></span>

> <span data-ttu-id="6f21b-107">マスターページファイルがコンテンツページとは異なる相対ディレクトリにあることが原因で、マスターページ内の Url がどのように壊れるかを説明します。</span><span class="sxs-lookup"><span data-stu-id="6f21b-107">Addresses how URLs in the master page can break due to the master page file being in a different relative directory than the content page.</span></span> <span data-ttu-id="6f21b-108">宣言構文で ~ で Url をリベースし、プログラムで ResolveUrl と ResolveClientUrl を使用する方法について見ていきます。</span><span class="sxs-lookup"><span data-stu-id="6f21b-108">Looks at rebasing URLs via ~ in the declarative syntax and using ResolveUrl and ResolveClientUrl programmatically.</span></span> <span data-ttu-id="6f21b-109">(も参照してください。</span><span class="sxs-lookup"><span data-stu-id="6f21b-109">(Also look at</span></span>

## <a name="introduction"></a><span data-ttu-id="6f21b-110">はじめに</span><span class="sxs-lookup"><span data-stu-id="6f21b-110">Introduction</span></span>

<span data-ttu-id="6f21b-111">これまでに説明したすべての例で、マスターページとコンテンツページは同じフォルダー (web サイトのルートフォルダー) に配置されています。</span><span class="sxs-lookup"><span data-stu-id="6f21b-111">In all the examples we've seen thus far, the master and content pages have been located in the same folder (the website's root folder).</span></span> <span data-ttu-id="6f21b-112">ただし、マスターページとコンテンツページを同じフォルダーに配置する必要がある理由はありません。</span><span class="sxs-lookup"><span data-stu-id="6f21b-112">But there's no reason why the master and content pages must be in the same folder.</span></span> <span data-ttu-id="6f21b-113">もちろん、サブフォルダーにコンテンツページを作成することもできます。</span><span class="sxs-lookup"><span data-stu-id="6f21b-113">You can certainly create content pages in subfolders.</span></span> <span data-ttu-id="6f21b-114">同様に、サイトのマスターページを配置する `~/MasterPages/` フォルダーを作成することもできます。</span><span class="sxs-lookup"><span data-stu-id="6f21b-114">Similarly, you might create a `~/MasterPages/` folder where you place your site's master pages.</span></span>

<span data-ttu-id="6f21b-115">マスターページとコンテンツページを異なるフォルダーに配置した場合の潜在的な問題の1つは、Url の破損です。</span><span class="sxs-lookup"><span data-stu-id="6f21b-115">One potential issue with placing master and content pages in different folders involves broken URLs.</span></span> <span data-ttu-id="6f21b-116">マスターページにハイパーリンク、画像、またはその他の要素の相対 Url が含まれている場合、リンクは別のフォルダーに存在するコンテンツページに対して無効になります。</span><span class="sxs-lookup"><span data-stu-id="6f21b-116">If the master page contains relative URLs in hyperlinks, images, or other elements, the link will be invalid for content pages that reside in a different folder.</span></span> <span data-ttu-id="6f21b-117">このチュートリアルでは、この問題の原因と回避策についても説明します。</span><span class="sxs-lookup"><span data-stu-id="6f21b-117">In this tutorial we examine the source of this problem as well as workarounds.</span></span>

## <a name="the-problem-with-relative-urls"></a><span data-ttu-id="6f21b-118">相対 Url に関する問題</span><span class="sxs-lookup"><span data-stu-id="6f21b-118">The Problem with Relative URLs</span></span>

<span data-ttu-id="6f21b-119">Web ページの URL は、web ページが指すリソースの場所が web サイトのフォルダー構造内の web ページの場所に対して相対的である場合、*相対 url*と呼ばれます。</span><span class="sxs-lookup"><span data-stu-id="6f21b-119">A URL on a web page is said to be a *relative URL* if the location of the resource it points to is relative to the web page's location in the website's folder structure.</span></span> <span data-ttu-id="6f21b-120">先頭のスラッシュ (`/`) またはプロトコル (`http://`など) で始まらない URL は、URL が含まれている web ページの場所に基づいてブラウザーによって解決されるため、相対的になります。</span><span class="sxs-lookup"><span data-stu-id="6f21b-120">Any URL that does not start with a leading forward slash (`/`) or a protocol (such as `http://`) is relative because it is resolved by the browser based on the location of the web page that contains the URL.</span></span>

<span data-ttu-id="6f21b-121">たとえば、web サイトには、`PoweredByASPNET.gif`の1つのイメージファイルを持つ `~/Images/` フォルダーがあります。</span><span class="sxs-lookup"><span data-stu-id="6f21b-121">For example, our website has an `~/Images/` folder with a single image file, `PoweredByASPNET.gif`.</span></span> <span data-ttu-id="6f21b-122">マスターページファイル `Site.master` には、`footerContent` 領域に次のマークアップで `<img>` 要素があります。</span><span class="sxs-lookup"><span data-stu-id="6f21b-122">The master page file `Site.master` has an `<img>` element in the `footerContent` region with the following markup:</span></span>

[!code-html[Main](urls-in-master-pages-vb/samples/sample1.html)]

<span data-ttu-id="6f21b-123">`<img>` 要素の `src` 属性値は `/` または `http://`で始まらないため、相対 URL です。</span><span class="sxs-lookup"><span data-stu-id="6f21b-123">The `src` attribute value in the `<img>` element is a relative URL because it does not start with `/` or `http://`.</span></span> <span data-ttu-id="6f21b-124">つまり、`src` 属性値は、`PoweredByASPNET.gif`という名前のファイルの `Images` サブフォルダーを検索するようにブラウザーに指示します。</span><span class="sxs-lookup"><span data-stu-id="6f21b-124">In short, the `src` attribute value tells the browser to look in the `Images` subfolder for a file named `PoweredByASPNET.gif`.</span></span>

<span data-ttu-id="6f21b-125">コンテンツページにアクセスすると、上記のマークアップがブラウザーに直接送信されます。</span><span class="sxs-lookup"><span data-stu-id="6f21b-125">When visiting a content page, the above markup is sent directly to the browser.</span></span> <span data-ttu-id="6f21b-126">`About.aspx` にアクセスし、ブラウザーに送信される HTML ソースを表示します。</span><span class="sxs-lookup"><span data-stu-id="6f21b-126">Take a moment to visit `About.aspx` and view the HTML source sent to the browser.</span></span> <span data-ttu-id="6f21b-127">マスターページでまったく同じマークアップがブラウザーに送信されたことがわかります。</span><span class="sxs-lookup"><span data-stu-id="6f21b-127">You will find that the exact same markup in the master page was sent to the browser.</span></span>

[!code-html[Main](urls-in-master-pages-vb/samples/sample2.html)]

<span data-ttu-id="6f21b-128">コンテンツページがルートフォルダー (`About.aspx`のように) にある場合は、ルートフォルダーを基準とした `Images` サブフォルダーが存在するため、すべてが予期したとおりに動作します。</span><span class="sxs-lookup"><span data-stu-id="6f21b-128">If the content page is in the root folder (as is `About.aspx`) everything works as expected because there is an `Images` subfolder relative to the root folder.</span></span> <span data-ttu-id="6f21b-129">ただし、コンテンツページがマスターページとは別のフォルダーにある場合は、問題が解消されます。</span><span class="sxs-lookup"><span data-stu-id="6f21b-129">However, things break down if the content page is in a different folder than the master page.</span></span> <span data-ttu-id="6f21b-130">これを説明するために、`Admin`という名前のサブフォルダーを作成します。</span><span class="sxs-lookup"><span data-stu-id="6f21b-130">To illustrate this, create a subfolder named `Admin`.</span></span> <span data-ttu-id="6f21b-131">次に、`Default.aspx` という名前のコンテンツページを `Admin` フォルダーに追加し、新しいページを `Site.master` マスターページにバインドします。</span><span class="sxs-lookup"><span data-stu-id="6f21b-131">Next, add a content page named `Default.aspx` to the `Admin` folder, making sure to bind the new page to the `Site.master` master page.</span></span>

> [!NOTE]
> <span data-ttu-id="6f21b-132">[ *「マスターページでタイトル、メタタグ、およびその他の HTML ヘッダーを指定*](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb.md)する」チュートリアルでは、コンテンツページのタイトルを自動的に設定する `BasePage` という名前のカスタム基本ページクラスを作成しました (明示的に割り当てられていない場合)。</span><span class="sxs-lookup"><span data-stu-id="6f21b-132">In the [*Specifying the Title, Meta Tags, and Other HTML Headers in the Master Page*](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb.md) tutorial we created a custom base page class named `BasePage` that automatically set the content page's title (if it was not explicitly assigned).</span></span> <span data-ttu-id="6f21b-133">新しく作成されたページの分離コードクラスは、この機能を利用できるように `BasePage` から派生したものであることを忘れないでください。</span><span class="sxs-lookup"><span data-stu-id="6f21b-133">Don't forget to have the newly created page's code-behind class derive from `BasePage` so that it can utilize this functionality.</span></span>

<span data-ttu-id="6f21b-134">このコンテンツページを作成した後、ソリューションエクスプローラーは図1のようになります。</span><span class="sxs-lookup"><span data-stu-id="6f21b-134">After you have created this content page, your Solution Explorer should look similar to Figure 1.</span></span>

![新しいフォルダーと ASP.NET ページがプロジェクトに追加されました](urls-in-master-pages-vb/_static/image1.png)

<span data-ttu-id="6f21b-136">**図 01**: 新しいフォルダーと ASP.NET ページがプロジェクトに追加された</span><span class="sxs-lookup"><span data-stu-id="6f21b-136">**Figure 01**: A New Folder and ASP.NET Page Have Been Added to the Project</span></span>

<span data-ttu-id="6f21b-137">次に、このレッスンの新しい `<siteMapNode>` エントリを含めるように `Web.sitemap` ファイルを更新します。</span><span class="sxs-lookup"><span data-stu-id="6f21b-137">Next, update the `Web.sitemap` file to include a new `<siteMapNode>` entry for this lesson.</span></span> <span data-ttu-id="6f21b-138">次の XML は、完全な `Web.sitemap` マークアップを示しています。これには、3番目の `<siteMapNode>` 要素が追加されています。</span><span class="sxs-lookup"><span data-stu-id="6f21b-138">The following XML shows the complete `Web.sitemap` markup, which now includes the addition of a third `<siteMapNode>` element.</span></span>

[!code-xml[Main](urls-in-master-pages-vb/samples/sample3.xml)]

<span data-ttu-id="6f21b-139">新しく作成された `Default.aspx` ページには、`Site.master`の4つの ContentPlaceHolders に対応する4つのコンテンツコントロールが必要です。</span><span class="sxs-lookup"><span data-stu-id="6f21b-139">The newly created `Default.aspx` page should have four Content controls corresponding to the four ContentPlaceHolders in `Site.master`.</span></span> <span data-ttu-id="6f21b-140">`MainContent` ContentPlaceHolder を参照するテキストをコンテンツコントロールに追加し、ブラウザーを使用してページにアクセスします。</span><span class="sxs-lookup"><span data-stu-id="6f21b-140">Add some text to the Content control referencing the `MainContent` ContentPlaceHolder and then visit the page through a browser.</span></span> <span data-ttu-id="6f21b-141">図2に示すように、ブラウザーは `PoweredByASPNET.gif` イメージファイルを見つけることができません。</span><span class="sxs-lookup"><span data-stu-id="6f21b-141">As Figure 2 shows, the browser cannot find the `PoweredByASPNET.gif` image file.</span></span> <span data-ttu-id="6f21b-142">どうなっているのでしょうか?</span><span class="sxs-lookup"><span data-stu-id="6f21b-142">What's going on here?</span></span>

<span data-ttu-id="6f21b-143">`~/Admin/Default.aspx` コンテンツ ページには、`About.aspx` ページと同じ HTML が `footerContent` 領域に送信されます。</span><span class="sxs-lookup"><span data-stu-id="6f21b-143">The `~/Admin/Default.aspx` content page is sent the same HTML for the `footerContent` region as was the `About.aspx` page:</span></span>

[!code-html[Main](urls-in-master-pages-vb/samples/sample4.html)]

<span data-ttu-id="6f21b-144">`<img>` 要素の `src` 属性は相対 URL であるため、ブラウザーは web ページのフォルダーの場所を基準とした `Images` フォルダーの検索を試みます。</span><span class="sxs-lookup"><span data-stu-id="6f21b-144">Because the `<img>` element's `src` attribute is a relative URL, the browser attempts to look for an `Images` folder relative to the web page's folder location.</span></span> <span data-ttu-id="6f21b-145">つまり、ブラウザーは `Admin/Images/PoweredByASPNET.gif`イメージファイルを探しています。</span><span class="sxs-lookup"><span data-stu-id="6f21b-145">In other words, the browser is looking for the image file `Admin/Images/PoweredByASPNET.gif`.</span></span>

<span data-ttu-id="6f21b-146">[PoweredByASPNET .gif イメージファイルが見つからない ![](urls-in-master-pages-vb/_static/image3.png)](urls-in-master-pages-vb/_static/image2.png)</span><span class="sxs-lookup"><span data-stu-id="6f21b-146">[![The PoweredByASPNET.gif Image File Cannot Be Found](urls-in-master-pages-vb/_static/image3.png)](urls-in-master-pages-vb/_static/image2.png)</span></span>

<span data-ttu-id="6f21b-147">**図 02**: `PoweredByASPNET.gif` イメージファイルが見つからない ([クリックしてフルサイズのイメージを表示する](urls-in-master-pages-vb/_static/image4.png))</span><span class="sxs-lookup"><span data-stu-id="6f21b-147">**Figure 02**: The `PoweredByASPNET.gif` Image File Cannot Be Found  ([Click to view full-size image](urls-in-master-pages-vb/_static/image4.png))</span></span>

### <a name="replacing-relative-urls-with-absolute-urls"></a><span data-ttu-id="6f21b-148">相対 Url を絶対 Url に置き換える</span><span class="sxs-lookup"><span data-stu-id="6f21b-148">Replacing Relative URLs with Absolute URLs</span></span>

<span data-ttu-id="6f21b-149">相対 URL とは逆に、*絶対 url*です。これは、スラッシュ (`/`) または `http://`などのプロトコルで始まります。</span><span class="sxs-lookup"><span data-stu-id="6f21b-149">The opposite of a relative URL is an *absolute URL*, which is one that starts with a forward slash (`/`) or a protocol such as `http://`.</span></span> <span data-ttu-id="6f21b-150">絶対 URL は既知の固定ポイントからリソースの場所を指定するため、web ページのフォルダー構造内の web ページの場所に関係なく、すべての web ページで同じ絶対 URL が有効になります。</span><span class="sxs-lookup"><span data-stu-id="6f21b-150">Because an absolute URL specifies the location of a resource from a known fixed point, the same absolute URL is valid in any web page, regardless of the web page's location in the website's folder structure.</span></span>

<span data-ttu-id="6f21b-151">図2に示されている壊れた画像を修正するには、相対 URL ではなく絶対 URL を使用するように `<img>` 要素の `src` 属性を更新する必要があります。</span><span class="sxs-lookup"><span data-stu-id="6f21b-151">To remedy the broken image shown in Figure 2, we need to update the `<img>` element's `src` attribute so that it uses an absolute URL instead of a relative one.</span></span> <span data-ttu-id="6f21b-152">正しい絶対 URL を確認するには、web サイトの web ページのいずれかにアクセスして、アドレスバーを確認します。</span><span class="sxs-lookup"><span data-stu-id="6f21b-152">To determine the correct absolute URL, visit one of the web pages in your website and examine the Address bar.</span></span> <span data-ttu-id="6f21b-153">図2のアドレスバーに示されているように、web アプリケーションへの完全修飾パスは `http://localhost:3908/ASPNET_MasterPages_Tutorial_04_VB/`ます。</span><span class="sxs-lookup"><span data-stu-id="6f21b-153">As the Address bar in Figure 2 shows, the fully qualified path to the web application is `http://localhost:3908/ASPNET_MasterPages_Tutorial_04_VB/`.</span></span> <span data-ttu-id="6f21b-154">そのため、`<img>` 要素の `src` 属性を次の2つの絶対 Url のいずれかに更新することができます。</span><span class="sxs-lookup"><span data-stu-id="6f21b-154">Therefore, we could update the `<img>` element's `src` attribute to either of the following two absolute URLs:</span></span>

- `/ASPNET_MasterPages_Tutorial_04_VB/Images/PoweredByASPNET.gif`
- `http://localhost:3908/ASPNET_MasterPages_Tutorial_04_VB/Images/PoweredByASPNET.gif`

<span data-ttu-id="6f21b-155">前に示した形式のいずれかを使用して、`<img>` 要素の `src` 属性を絶対 URL に更新してから、ブラウザーを使用して `~/Admin/Default.aspx` のページにアクセスします。</span><span class="sxs-lookup"><span data-stu-id="6f21b-155">Take a moment to update the `<img>` element's `src` attribute to an absolute URL using one of the forms shown above and then visit the `~/Admin/Default.aspx` page through a browser.</span></span> <span data-ttu-id="6f21b-156">今度は、ブラウザーは `PoweredByASPNET.gif` イメージファイルを正しく見つけて表示します (図3を参照)。</span><span class="sxs-lookup"><span data-stu-id="6f21b-156">This time the browser will correctly find and display the `PoweredByASPNET.gif` image file (see Figure 3).</span></span>

<span data-ttu-id="6f21b-157">[PoweredByASPNET .gif イメージが表示され ![](urls-in-master-pages-vb/_static/image6.png)](urls-in-master-pages-vb/_static/image5.png)</span><span class="sxs-lookup"><span data-stu-id="6f21b-157">[![The PoweredByASPNET.gif Image is Now Displayed](urls-in-master-pages-vb/_static/image6.png)](urls-in-master-pages-vb/_static/image5.png)</span></span>

<span data-ttu-id="6f21b-158">**図 03**: `PoweredByASPNET.gif` イメージが表示されるようになりました ([クリックすると、フルサイズの画像が表示](urls-in-master-pages-vb/_static/image7.png)されます)</span><span class="sxs-lookup"><span data-stu-id="6f21b-158">**Figure 03**: The `PoweredByASPNET.gif` Image is Now Displayed  ([Click to view full-size image](urls-in-master-pages-vb/_static/image7.png))</span></span>

<span data-ttu-id="6f21b-159">絶対 URL のハードコーディングは機能しますが、HTML を web サイトのサーバーとフォルダーの場所と緊密に結合します。これは変更される可能性があります。</span><span class="sxs-lookup"><span data-stu-id="6f21b-159">While hard coding in the absolute URL works, it tightly couples your HTML to the website's server and folder location, which may change.</span></span> <span data-ttu-id="6f21b-160">`http://localhost:3908/...` フォームの絶対 URL を使用するのは、Visual Studio の組み込みの ASP.NET Development Web サーバーを起動するたびに localhost を前に指定したポート番号が自動的に選択されるため、不安定になります。</span><span class="sxs-lookup"><span data-stu-id="6f21b-160">Using an absolute URL of the form `http://localhost:3908/...` is brittle because the port number preceding localhost is selected automatically each time Visual Studio's built-in ASP.NET Development Web Server is started.</span></span> <span data-ttu-id="6f21b-161">同様に、`http://localhost` 部分は、ローカルでテストする場合にのみ有効です。</span><span class="sxs-lookup"><span data-stu-id="6f21b-161">Similarly, the `http://localhost` part is only valid when testing locally.</span></span> <span data-ttu-id="6f21b-162">コードが実稼働サーバーに配置されると、URL ベースは `http://www.yourserver.com`のように他のものに変更されます。</span><span class="sxs-lookup"><span data-stu-id="6f21b-162">Once the code is deployed to a production server, the URL base will change to something else, like `http://www.yourserver.com`.</span></span> <span data-ttu-id="6f21b-163">また、このアプリケーションのパスが開発サーバーと実稼働サーバーで異なることがよくあるため、フォームの絶対 URL `/ASPNET_MasterPages_Tutorial_04_VB/...` も同じ高まるを持ちます。</span><span class="sxs-lookup"><span data-stu-id="6f21b-163">The absolute URL in the form `/ASPNET_MasterPages_Tutorial_04_VB/...` also suffers from the same brittleness because oftentimes this application path differs between development and production servers.</span></span>

<span data-ttu-id="6f21b-164">ASP.NET は、実行時に有効な相対 URL を生成する方法を提供します。</span><span class="sxs-lookup"><span data-stu-id="6f21b-164">The good news is that ASP.NET offers a method for generating a valid relative URL at runtime.</span></span>

## <a name="usingandresolveclienturl"></a><span data-ttu-id="6f21b-165">`~`と`ResolveClientUrl` の使用</span><span class="sxs-lookup"><span data-stu-id="6f21b-165">Using`~`and`ResolveClientUrl`</span></span>

<span data-ttu-id="6f21b-166">ASP.NET は、絶対 URL をハードコーディングするのではなく、チルダ (`~`) を使用して web アプリケーションのルートを示すことができます。</span><span class="sxs-lookup"><span data-stu-id="6f21b-166">Rather than hard code an absolute URL, ASP.NET allows page developers to use the tilde (`~`) to indicate the root of the web application.</span></span> <span data-ttu-id="6f21b-167">たとえば、このチュートリアルの前半では、`Admin` フォルダーの `Default.aspx` ページを参照するために、テキストの `~/Admin/Default.aspx` 表記を使用しました。</span><span class="sxs-lookup"><span data-stu-id="6f21b-167">For example, earlier in this tutorial I used the notation `~/Admin/Default.aspx` in the text to refer to the `Default.aspx` page in the `Admin` folder.</span></span> <span data-ttu-id="6f21b-168">`~` は、`Admin` フォルダーが web アプリケーションのルートのサブフォルダーであることを示します。</span><span class="sxs-lookup"><span data-stu-id="6f21b-168">The `~` indicates that the `Admin` folder is a subfolder of the web application's root.</span></span>

<span data-ttu-id="6f21b-169">`Control` クラスの[`ResolveClientUrl` メソッド](https://msdn.microsoft.com/library/system.web.ui.control.resolveclienturl.aspx)は、URL を受け取り、そのコントロールが存在する web ページに適した相対 url に変更します。</span><span class="sxs-lookup"><span data-stu-id="6f21b-169">The `Control` class's [`ResolveClientUrl` method](https://msdn.microsoft.com/library/system.web.ui.control.resolveclienturl.aspx) takes a URL and modifies it to a relative URL appropriate for the web page on which the control resides.</span></span> <span data-ttu-id="6f21b-170">たとえば、`About.aspx` から `ResolveClientUrl("~/Images/PoweredByASPNET.gif")` を呼び出すと `Images/PoweredByASPNET.gif`が返されます。</span><span class="sxs-lookup"><span data-stu-id="6f21b-170">For example, calling `ResolveClientUrl("~/Images/PoweredByASPNET.gif")` from `About.aspx` returns `Images/PoweredByASPNET.gif`.</span></span> <span data-ttu-id="6f21b-171">ただし、`~/Admin/Default.aspx`から呼び出すと、`../Images/PoweredByASPNET.gif`が返されます。</span><span class="sxs-lookup"><span data-stu-id="6f21b-171">Calling it from `~/Admin/Default.aspx`, however, returns `../Images/PoweredByASPNET.gif`.</span></span>

> [!NOTE]
> <span data-ttu-id="6f21b-172">すべての ASP.NET サーバーコントロールは `Control` クラスから派生するため、すべてのサーバーコントロールは `ResolveClientUrl` メソッドにアクセスできます。</span><span class="sxs-lookup"><span data-stu-id="6f21b-172">Because all ASP.NET server controls derive from the `Control` class, all server controls have access to the `ResolveClientUrl` method.</span></span> <span data-ttu-id="6f21b-173">`Page` クラスは `Control` クラスから派生しています。つまり、ASP.NET ページの分離コードクラスから直接このメソッドを使用できます。</span><span class="sxs-lookup"><span data-stu-id="6f21b-173">Even the `Page` class derives from the `Control` class, meaning that you can use this method directly from your ASP.NET pages' code-behind classes.</span></span>

### <a name="usingin-the-declarative-markup"></a><span data-ttu-id="6f21b-174">宣言型マークアップでの`~`の使用</span><span class="sxs-lookup"><span data-stu-id="6f21b-174">Using`~`in the Declarative Markup</span></span>

<span data-ttu-id="6f21b-175">いくつかの ASP.NET Web コントロールには、URL 関連のプロパティが含まれています。 HyperLink コントロールには `NavigateUrl` のプロパティがあります。イメージコントロールには `ImageUrl` のプロパティがあります。などなど。</span><span class="sxs-lookup"><span data-stu-id="6f21b-175">Several ASP.NET Web controls include URL-related properties: the HyperLink control has a `NavigateUrl` property; the Image control has an `ImageUrl` property; and so on.</span></span> <span data-ttu-id="6f21b-176">これらのコントロールがレンダリングされると、URL 関連のプロパティ値が `ResolveClientUrl`に渡されます。</span><span class="sxs-lookup"><span data-stu-id="6f21b-176">When rendered, these controls pass their URL-related property values to `ResolveClientUrl`.</span></span> <span data-ttu-id="6f21b-177">そのため、これらのプロパティに web アプリケーションのルートを示す `~` が含まれている場合、URL は有効な相対 URL に変更されます。</span><span class="sxs-lookup"><span data-stu-id="6f21b-177">Consequently, if these properties contain a `~` to indicate the root of the web application, the URL will be modified to a valid relative URL.</span></span>

<span data-ttu-id="6f21b-178">ASP.NET サーバーコントロールのみが URL 関連のプロパティで `~` を変換することに注意してください。</span><span class="sxs-lookup"><span data-stu-id="6f21b-178">Keep in mind that only ASP.NET server controls transform the `~` in their URL-related properties.</span></span> <span data-ttu-id="6f21b-179">`~` が `<img src="~/Images/PoweredByASPNET.gif" />`などの静的な HTML マークアップに表示された場合、ASP.NET エンジンは、HTML コンテンツの残りの部分と共に `~` をブラウザーに送信します。</span><span class="sxs-lookup"><span data-stu-id="6f21b-179">If a `~` appears in static HTML markup, such as `<img src="~/Images/PoweredByASPNET.gif" />`, the ASP.NET engine sends the `~` to the browser along with the rest of the HTML content.</span></span> <span data-ttu-id="6f21b-180">ブラウザーは、`~` が URL の一部であることを前提としています。</span><span class="sxs-lookup"><span data-stu-id="6f21b-180">The browser assumes that the `~` is part of the URL.</span></span> <span data-ttu-id="6f21b-181">たとえば、ブラウザーがマークアップを受け取ると `<img src="~/Images/PoweredByASPNET.gif" />`、`~` という名前のサブフォルダーと、イメージファイル `PoweredByASPNET.gif`を含むサブフォルダー `Images` があると想定されます。</span><span class="sxs-lookup"><span data-stu-id="6f21b-181">For example, if the browser receives the markup `<img src="~/Images/PoweredByASPNET.gif" />` it assumes there is a subfolder named `~` with a subfolder `Images` that contains the image file `PoweredByASPNET.gif`.</span></span>

<span data-ttu-id="6f21b-182">`Site.master`でイメージマークアップを修正するには、既存の `<img>` 要素を ASP.NET Image Web コントロールに置き換えます。</span><span class="sxs-lookup"><span data-stu-id="6f21b-182">To fix the image markup in `Site.master`, replace the existing `<img>` element with an ASP.NET Image Web control.</span></span> <span data-ttu-id="6f21b-183">画像 Web コントロールの `ID` を `PoweredByImage`に、その `ImageUrl` プロパティを `~/Images/PoweredByASPNET.gif`に、その `AlternateText` プロパティを "Powered by ASP.NET!" に設定します。</span><span class="sxs-lookup"><span data-stu-id="6f21b-183">Set the Image Web control's `ID` to `PoweredByImage`, its `ImageUrl` property to `~/Images/PoweredByASPNET.gif`, and its `AlternateText` property to "Powered by ASP.NET!"</span></span>

[!code-aspx[Main](urls-in-master-pages-vb/samples/sample5.aspx)]

<span data-ttu-id="6f21b-184">マスターページにこの変更を加えた後、[`~/Admin/Default.aspx`] ページにもう一度移動します。</span><span class="sxs-lookup"><span data-stu-id="6f21b-184">After making this change to the master page, revisit the `~/Admin/Default.aspx` page again.</span></span> <span data-ttu-id="6f21b-185">今回は、`PoweredByASPNET.gif` イメージファイルがページに表示されます (図3を参照)。</span><span class="sxs-lookup"><span data-stu-id="6f21b-185">This time the `PoweredByASPNET.gif` image file appears in the page (see Figure 3).</span></span> <span data-ttu-id="6f21b-186">イメージ Web コントロールがレンダリングされるときには、`ResolveClientUrl` メソッドを使用して、`ImageUrl` プロパティ値を解決します。</span><span class="sxs-lookup"><span data-stu-id="6f21b-186">When the Image Web control is rendered it uses the `ResolveClientUrl` method to resolve its `ImageUrl` property value.</span></span> <span data-ttu-id="6f21b-187">`~/Admin/Default.aspx` では、次の HTML ソースのスニペットに示すように、`ImageUrl` が適切な相対 URL に変換されます。</span><span class="sxs-lookup"><span data-stu-id="6f21b-187">In `~/Admin/Default.aspx` the `ImageUrl` is converted into an appropriate relative URL, as the following snippet of HTML source shows:</span></span>

[!code-html[Main](urls-in-master-pages-vb/samples/sample6.html)]

> [!NOTE]
> <span data-ttu-id="6f21b-188">URL ベースの Web コントロールプロパティで使用されるだけでなく、`Response.Redirect` および `Server.MapPath` メソッドを呼び出すときに、`~` を使用することもできます。</span><span class="sxs-lookup"><span data-stu-id="6f21b-188">In addition to being used in URL-based Web control properties, the `~` can also be used when calling the `Response.Redirect` and `Server.MapPath` methods, among others.</span></span> <span data-ttu-id="6f21b-189">また、必要に応じて、`ResolveClientUrl` メソッドを ASP.NET またはマスターページの宣言型マークアップから直接呼び出すこともできます。[マークアップで `ResolveClientUrl` を使用し](https://www.pluralsight.com/blogs/fritz/archive/2006/02/06/18596.aspx)た[Fritz オニオン](https://www.pluralsight.com/blogs/fritz/)のブログエントリを参照してください。</span><span class="sxs-lookup"><span data-stu-id="6f21b-189">Also, the `ResolveClientUrl` method may be invoked directly from an ASP.NET or master page's declarative markup, if needed; see [Fritz Onion](https://www.pluralsight.com/blogs/fritz/)'s blog entry [Using `ResolveClientUrl` in Markup](https://www.pluralsight.com/blogs/fritz/archive/2006/02/06/18596.aspx).</span></span>

## <a name="fixing-the-master-pages-remaining-relative-urls"></a><span data-ttu-id="6f21b-190">マスターページの残りの相対 Url を修正しています</span><span class="sxs-lookup"><span data-stu-id="6f21b-190">Fixing the Master Page's Remaining Relative URLs</span></span>

<span data-ttu-id="6f21b-191">先ほど修正した `footerContent` の `<img>` 要素に加えて、マスターページには、注意が必要な相対 URL が1つ追加されています。</span><span class="sxs-lookup"><span data-stu-id="6f21b-191">In addition to the `<img>` element in the `footerContent` that we just fixed, the master page contains one more relative URL that requires our attention.</span></span> <span data-ttu-id="6f21b-192">`topContent` 領域には、`Default.aspx`を示すリンク "マスターページチュートリアル" が含まれています。</span><span class="sxs-lookup"><span data-stu-id="6f21b-192">The `topContent` region includes the link "Master Pages Tutorials," which points to `Default.aspx`.</span></span>

[!code-html[Main](urls-in-master-pages-vb/samples/sample7.html)]

<span data-ttu-id="6f21b-193">この URL は相対 URI であるため、ユーザーがアクセスしているコンテンツページのフォルダー内の `Default.aspx` ページにユーザーを送信します。</span><span class="sxs-lookup"><span data-stu-id="6f21b-193">Because this URL is relative, it will send the user to the `Default.aspx` page in the folder of the content page they are visiting.</span></span> <span data-ttu-id="6f21b-194">このリンクを常にルートフォルダー内の `Default.aspx` をポイントさせるには、`<a>` 要素をハイパーリンク Web コントロールに置き換えて、`~` 表記を使用できるようにする必要があります。</span><span class="sxs-lookup"><span data-stu-id="6f21b-194">To have this link always point to `Default.aspx` in the root folder we need to replace the `<a>` element with a HyperLink Web control so that we can use the `~` notation.</span></span>

<span data-ttu-id="6f21b-195">`<a>` 要素マークアップを削除し、その代わりにハイパーリンクコントロールを追加します。</span><span class="sxs-lookup"><span data-stu-id="6f21b-195">Remove the `<a>` element markup and add a HyperLink control in its place.</span></span> <span data-ttu-id="6f21b-196">ハイパーリンクの `ID` を `lnkHome`に、その `NavigateUrl` プロパティを `~/Default.aspx`に、その `Text` プロパティを "マスターページチュートリアル" に設定します。</span><span class="sxs-lookup"><span data-stu-id="6f21b-196">Set the HyperLink's `ID` to `lnkHome`, its `NavigateUrl` property to `~/Default.aspx`, and its `Text` property to "Master Pages Tutorials."</span></span>

[!code-aspx[Main](urls-in-master-pages-vb/samples/sample8.aspx)]

<span data-ttu-id="6f21b-197">これで完了です。</span><span class="sxs-lookup"><span data-stu-id="6f21b-197">That's it!</span></span> <span data-ttu-id="6f21b-198">この時点で、マスターページ内のすべての Url は、マスターページとコンテンツページが配置されているフォルダーに関係なく、コンテンツページによってレンダリングされるときに、適切に基づいています。</span><span class="sxs-lookup"><span data-stu-id="6f21b-198">At this point all the URLs in our master page are properly based when rendered by a content page regardless of what folders the master page and content page are located in.</span></span>

### <a name="automatic-url-resolution-in-theheadsection"></a><span data-ttu-id="6f21b-199">`<head>`セクションの URL の自動解決</span><span class="sxs-lookup"><span data-stu-id="6f21b-199">Automatic URL Resolution in the`<head>`Section</span></span>

<span data-ttu-id="6f21b-200">「[*マスターページを使用してサイト全体のレイアウトを作成*](creating-a-site-wide-layout-using-master-pages-vb.md)する」チュートリアルでは、`<head>` 領域の `Styles.css` ファイルに `<link>` を追加しました。</span><span class="sxs-lookup"><span data-stu-id="6f21b-200">In the [*Creating a Site-Wide Layout Using Master Pages*](creating-a-site-wide-layout-using-master-pages-vb.md) tutorial we added a `<link>` to the `Styles.css` file in the `<head>` region:</span></span>

[!code-aspx[Main](urls-in-master-pages-vb/samples/sample9.aspx)]

<span data-ttu-id="6f21b-201">`<link>` 要素の `href` 属性は相対属性ですが、実行時に自動的に適切なパスに変換されます。</span><span class="sxs-lookup"><span data-stu-id="6f21b-201">While the `<link>` element's `href` attribute is relative, it's automatically converted to an appropriate path at runtime.</span></span> <span data-ttu-id="6f21b-202">「[*マスターページでタイトル、メタタグ、およびその他の HTML ヘッダーを指定*](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb.md)する」のチュートリアルで説明したように、`<head>` 領域は実際にはサーバー側コントロールであり、レンダリング時に内部コントロールの内容を変更できます。</span><span class="sxs-lookup"><span data-stu-id="6f21b-202">As we discussed in the [*Specifying the Title, Meta Tags, and Other HTML Headers in the Master Page*](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb.md) tutorial, the `<head>` region is actually a server-side control, which enables it to modify the contents of its inner controls when it is rendered.</span></span>

<span data-ttu-id="6f21b-203">これを確認するには、[`~/Admin/Default.aspx`] ページに戻って、ブラウザーに送信された HTML ソースを表示します。</span><span class="sxs-lookup"><span data-stu-id="6f21b-203">To verify this, revisit the `~/Admin/Default.aspx` page and view the HTML source sent to the browser.</span></span> <span data-ttu-id="6f21b-204">次のスニペットに示すように、`<link>` 要素の `href` 属性は、適切な相対 URL `../Styles.css`に自動的に変更されています。</span><span class="sxs-lookup"><span data-stu-id="6f21b-204">As the snippet below illustrates, the `<link>` element's `href` attribute has been automatically modified to an appropriate relative URL, `../Styles.css`.</span></span>

[!code-html[Main](urls-in-master-pages-vb/samples/sample10.html)]

## <a name="summary"></a><span data-ttu-id="6f21b-205">まとめ</span><span class="sxs-lookup"><span data-stu-id="6f21b-205">Summary</span></span>

<span data-ttu-id="6f21b-206">マスターページには、多くの場合、リンク、画像、および URL を使用して指定する必要があるその他の外部リソースが含まれます。</span><span class="sxs-lookup"><span data-stu-id="6f21b-206">Master pages very often include links, images, and other external resources that must be specified via a URL.</span></span> <span data-ttu-id="6f21b-207">マスターページとコンテンツページは同じフォルダー内に存在しない可能性があるため、相対 Url を使用しないように abstain することが重要です。</span><span class="sxs-lookup"><span data-stu-id="6f21b-207">Because the master page and content pages might not exist in the same folder, it is important to abstain from using relative URLs.</span></span> <span data-ttu-id="6f21b-208">ハードコーディングされた絶対 Url を使用することもできますが、絶対 URL を web アプリケーションに密に結合します。</span><span class="sxs-lookup"><span data-stu-id="6f21b-208">While it is possible to use hard coded absolute URLs, doing so tightly couples the absolute URL to the web application.</span></span> <span data-ttu-id="6f21b-209">Web アプリケーションを移動またはデプロイするときのように絶対 URL が変更された場合は、絶対 url を更新してください。</span><span class="sxs-lookup"><span data-stu-id="6f21b-209">If the absolute URL changes - as it often does when moving or deploying a web application - you'll have to remember to go back and update the absolute URLs.</span></span>

<span data-ttu-id="6f21b-210">最適な方法は、ティルダ (`~`) を使用してアプリケーションのルートを示すことです。</span><span class="sxs-lookup"><span data-stu-id="6f21b-210">The ideal approach is to use the tilde (`~`) to indicate the application root.</span></span> <span data-ttu-id="6f21b-211">URL 関連のプロパティを含む ASP.NET Web コントロールは、実行時にアプリケーションルートに `~` をマップします。</span><span class="sxs-lookup"><span data-stu-id="6f21b-211">ASP.NET Web controls that contain URL-related properties map the `~` to the application root at runtime.</span></span> <span data-ttu-id="6f21b-212">内部的には、Web コントロールは `Control` クラスの `ResolveClientUrl` メソッドを使用して、有効な相対 URL を生成します。</span><span class="sxs-lookup"><span data-stu-id="6f21b-212">Internally, the Web controls use the `Control` class's `ResolveClientUrl` method to generate a valid relative URL.</span></span> <span data-ttu-id="6f21b-213">このメソッドはパブリックであり、すべてのサーバーコントロール (`Page` クラスを含む) から使用できます。そのため、必要に応じて、分離コードクラスからプログラムによって使用できます。</span><span class="sxs-lookup"><span data-stu-id="6f21b-213">This method is public and available from every server control (including the `Page` class), so you can use it programmatically from your code-behind classes, if needed.</span></span>

<span data-ttu-id="6f21b-214">プログラミングを楽しんでください。</span><span class="sxs-lookup"><span data-stu-id="6f21b-214">Happy Programming!</span></span>

### <a name="further-reading"></a><span data-ttu-id="6f21b-215">参考資料</span><span class="sxs-lookup"><span data-stu-id="6f21b-215">Further Reading</span></span>

<span data-ttu-id="6f21b-216">このチュートリアルで説明しているトピックの詳細については、次のリソースを参照してください。</span><span class="sxs-lookup"><span data-stu-id="6f21b-216">For more information on the topics discussed in this tutorial, refer to the following resources:</span></span>

- [<span data-ttu-id="6f21b-217">ASP.NET のマスターページ</span><span class="sxs-lookup"><span data-stu-id="6f21b-217">Master Pages in ASP.NET</span></span>](http://www.odetocode.com/Articles/419.aspx)
- [<span data-ttu-id="6f21b-218">マスターページでの URL リベース</span><span class="sxs-lookup"><span data-stu-id="6f21b-218">URL Rebasing in a Master Page</span></span>](https://quickstarts.asp.net/QuickStartv20/aspnet/doc/masterpages/default.aspx#urls)
- [<span data-ttu-id="6f21b-219">マークアップでの `ResolveClientUrl` の使用</span><span class="sxs-lookup"><span data-stu-id="6f21b-219">Using `ResolveClientUrl` in Markup</span></span>](https://www.pluralsight.com/blogs/fritz/archive/2006/02/06/18596.aspx)

### <a name="about-the-author"></a><span data-ttu-id="6f21b-220">著者について</span><span class="sxs-lookup"><span data-stu-id="6f21b-220">About the Author</span></span>

<span data-ttu-id="6f21b-221">1998以降、Microsoft の Web テクノロジを使用して、 [Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml)(複数の asp/創設者4GuysFromRolla.com の執筆者) が Microsoft の Web テクノロジを使用しています。</span><span class="sxs-lookup"><span data-stu-id="6f21b-221">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of multiple ASP/ASP.NET books and founder of 4GuysFromRolla.com, has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="6f21b-222">Scott は、独立したコンサルタント、トレーナー、およびライターとして機能します。</span><span class="sxs-lookup"><span data-stu-id="6f21b-222">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="6f21b-223">彼の最新の書籍は[ *、ASP.NET 3.5 を24時間以内に教え*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)ています。</span><span class="sxs-lookup"><span data-stu-id="6f21b-223">His latest book is [*Sams Teach Yourself ASP.NET 3.5 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="6f21b-224">Scott は、 [mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com)またはブログで[http://ScottOnWriting.NET](http://scottonwriting.net/)にアクセスできます。</span><span class="sxs-lookup"><span data-stu-id="6f21b-224">Scott can be reached at [mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com) or via his blog at [http://ScottOnWriting.NET](http://scottonwriting.net/).</span></span>

### <a name="special-thanks-to"></a><span data-ttu-id="6f21b-225">ありがとうございました。</span><span class="sxs-lookup"><span data-stu-id="6f21b-225">Special Thanks To</span></span>

<span data-ttu-id="6f21b-226">今後の MSDN 記事を確認することに興味がありますか?</span><span class="sxs-lookup"><span data-stu-id="6f21b-226">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="6f21b-227">その場合は、 [mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com)の行を削除します。</span><span class="sxs-lookup"><span data-stu-id="6f21b-227">If so, drop me a line at [mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com).</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="6f21b-228">[前へ](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb.md)
> [次へ](control-id-naming-in-content-pages-vb.md)</span><span class="sxs-lookup"><span data-stu-id="6f21b-228">[Previous](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb.md)
[Next](control-id-naming-in-content-pages-vb.md)</span></span>

---
uid: web-forms/overview/older-versions-getting-started/master-pages/interacting-with-the-master-page-from-the-content-page-vb
title: コンテンツページからマスターページと対話する (VB) |Microsoft Docs
author: rick-anderson
description: コンテンツページのコードからマスターページのメソッドの呼び出し、プロパティの設定などを行う方法について説明します。
ms.author: riande
ms.date: 07/11/2008
ms.assetid: 081fe010-ba0f-4e7d-b4ba-774840b601c2
msc.legacyurl: /web-forms/overview/older-versions-getting-started/master-pages/interacting-with-the-master-page-from-the-content-page-vb
msc.type: authoredcontent
ms.openlocfilehash: fe1f7b80b26ff25c1ce744e4f823e3fb35eea074
ms.sourcegitcommit: 22fbd8863672c4ad6693b8388ad5c8e753fb41a2
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 11/28/2019
ms.locfileid: "74577226"
---
# <a name="interacting-with-the-master-page-from-the-content-page-vb"></a><span data-ttu-id="64a4b-103">コンテンツ ページからマスター ページと対話する (VB)</span><span class="sxs-lookup"><span data-stu-id="64a4b-103">Interacting with the Master Page from the Content Page (VB)</span></span>

<span data-ttu-id="64a4b-104">[Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="64a4b-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="64a4b-105">[コードのダウンロード](https://download.microsoft.com/download/1/8/4/184e24fa-fcc8-47fa-ac99-4b6a52d41e97/ASPNET_MasterPages_Tutorial_06_VB.zip)または[PDF のダウンロード](https://download.microsoft.com/download/e/b/4/eb4abb10-c416-4ba4-9899-32577715b1bd/ASPNET_MasterPages_Tutorial_06_VB.pdf)</span><span class="sxs-lookup"><span data-stu-id="64a4b-105">[Download Code](https://download.microsoft.com/download/1/8/4/184e24fa-fcc8-47fa-ac99-4b6a52d41e97/ASPNET_MasterPages_Tutorial_06_VB.zip) or [Download PDF](https://download.microsoft.com/download/e/b/4/eb4abb10-c416-4ba4-9899-32577715b1bd/ASPNET_MasterPages_Tutorial_06_VB.pdf)</span></span>

> <span data-ttu-id="64a4b-106">コンテンツページのコードからマスターページのメソッドの呼び出し、プロパティの設定などを行う方法について説明します。</span><span class="sxs-lookup"><span data-stu-id="64a4b-106">Examines how to call methods, set properties, etc. of the Master Page from code in the Content Page.</span></span>

## <a name="introduction"></a><span data-ttu-id="64a4b-107">はじめに</span><span class="sxs-lookup"><span data-stu-id="64a4b-107">Introduction</span></span>

<span data-ttu-id="64a4b-108">これまでの5つのチュートリアルでは、マスターページを作成する方法、コンテンツ領域を定義する方法、マスターページに ASP.NET ページをバインドする方法、ページ固有のコンテンツを定義する方法を説明しました。</span><span class="sxs-lookup"><span data-stu-id="64a4b-108">Over the course of the past five tutorials we have looked at how to create a master page, define content regions, bind ASP.NET pages to a master page, and define page-specific content.</span></span> <span data-ttu-id="64a4b-109">ビジターが特定のコンテンツページを要求すると、実行時にコンテンツおよびマスターページのマークアップが1つになり、その結果、統一された制御階層がレンダリングされます。</span><span class="sxs-lookup"><span data-stu-id="64a4b-109">When a visitor requests a particular content page, the content and master pages' markup are fused at runtime, resulting in the rendering of a unified control hierarchy.</span></span> <span data-ttu-id="64a4b-110">したがって、マスターページとそのコンテンツページの相互作用を可能にする方法の1つが既に見られています。コンテンツページでは、マスターページの ContentPlaceHolder コントロールに transfuse するマークアップが指定されています。</span><span class="sxs-lookup"><span data-stu-id="64a4b-110">Therefore, we have already seen one way in which the master page and one of its content pages can interact: the content page spells out the markup to transfuse into the master page's ContentPlaceHolder controls.</span></span>

<span data-ttu-id="64a4b-111">まだ確認していないのは、マスターページとコンテンツページがプログラムによって対話する方法です。</span><span class="sxs-lookup"><span data-stu-id="64a4b-111">What we have yet to examine is how the master page and content page can interact programmatically.</span></span> <span data-ttu-id="64a4b-112">マスターページの ContentPlaceHolder コントロールのマークアップを定義するだけでなく、コンテンツページはマスターページのパブリックプロパティに値を割り当てて、そのパブリックメソッドを呼び出すこともできます。</span><span class="sxs-lookup"><span data-stu-id="64a4b-112">In addition to defining the markup for the master page's ContentPlaceHolder controls, a content page can also assign values to its master page's public properties and invoke its public methods.</span></span> <span data-ttu-id="64a4b-113">同様に、マスターページはそのコンテンツページと対話する場合があります。</span><span class="sxs-lookup"><span data-stu-id="64a4b-113">Similarly, a master page may interact with its content pages.</span></span> <span data-ttu-id="64a4b-114">マスターとコンテンツページ間のプログラムによる対話は、宣言型のマークアップ間の相互作用よりも一般的ではありませんが、このようなプログラムによる操作が必要になるシナリオは多数あります。</span><span class="sxs-lookup"><span data-stu-id="64a4b-114">While programmatic interaction between a master and content page is less common than the interaction between their declarative markups, there are many scenarios where such programmatic interaction is needed.</span></span>

<span data-ttu-id="64a4b-115">このチュートリアルでは、コンテンツページをプログラムでマスターページと対話する方法について説明します。次のチュートリアルでは、マスターページと同様にコンテンツページを操作する方法について説明します。</span><span class="sxs-lookup"><span data-stu-id="64a4b-115">In this tutorial we examine how a content page can programmatically interact with its master page; in the next tutorial we will look at how the master page can similarly interact with its content pages.</span></span>

## <a name="examples-of-programmatic-interaction-between-a-content-page-and-its-master-page"></a><span data-ttu-id="64a4b-116">コンテンツページとそのマスターページ間のプログラムによる対話の例</span><span class="sxs-lookup"><span data-stu-id="64a4b-116">Examples of Programmatic Interaction Between a Content Page and its Master Page</span></span>

<span data-ttu-id="64a4b-117">ページの特定の領域をページ単位で構成する必要がある場合は、ContentPlaceHolder コントロールを使用します。</span><span class="sxs-lookup"><span data-stu-id="64a4b-117">When a particular region of a page needs to be configured on a page-by-page basis, we use a ContentPlaceHolder control.</span></span> <span data-ttu-id="64a4b-118">しかし、ほとんどのページで特定の出力を生成する必要があるものの、他のページを表示するためにページをカスタマイズする必要がある場合はどうでしょうか。</span><span class="sxs-lookup"><span data-stu-id="64a4b-118">But what about situations where the majority of pages need to emit a certain output, but a small number of pages need to customize it to show something else?</span></span> <span data-ttu-id="64a4b-119">このような例の1つは、[*複数の contentplaceholders と既定のコンテンツ*](multiple-contentplaceholders-and-default-content-vb.md)のチュートリアルで調査したもので、各ページにログインインターフェイスを表示することです。</span><span class="sxs-lookup"><span data-stu-id="64a4b-119">One such example, which we examined in the [*Multiple ContentPlaceHolders and Default Content*](multiple-contentplaceholders-and-default-content-vb.md) tutorial, involves displaying a login interface on each page.</span></span> <span data-ttu-id="64a4b-120">ほとんどのページにはログインインターフェイスが含まれている必要がありますが、メインログインページ (`Login.aspx`) など、いくつかのページに対しては抑制する必要があります。[アカウントの作成] ページまた、認証されたユーザーだけがアクセスできるその他のページもあります。</span><span class="sxs-lookup"><span data-stu-id="64a4b-120">While most pages should include a login interface, it should be suppressed for a handful of pages, such as: the main login page (`Login.aspx`); the Create Account page; and other pages that are only accessible to authenticated users.</span></span> <span data-ttu-id="64a4b-121">[*複数の contentplaceholders および既定のコンテンツ*](multiple-contentplaceholders-and-default-content-vb.md)のチュートリアルでは、マスターページで ContentPlaceHolder の既定のコンテンツを定義する方法と、既定のコンテンツを必要としないページで上書きする方法を説明しました。</span><span class="sxs-lookup"><span data-stu-id="64a4b-121">The [*Multiple ContentPlaceHolders and Default Content*](multiple-contentplaceholders-and-default-content-vb.md) tutorial showed how to define the default content for a ContentPlaceHolder in the master page and then how to override it in those pages where the default content was not wanted.</span></span>

<span data-ttu-id="64a4b-122">もう1つの方法は、ログインインターフェイスを表示するか非表示にするかを示す、マスターページ内のパブリックプロパティまたはメソッドを作成することです。</span><span class="sxs-lookup"><span data-stu-id="64a4b-122">Another option is to create a public property or method within the master page that indicates whether to show or hide the login interface.</span></span> <span data-ttu-id="64a4b-123">たとえば、マスターページには `ShowLoginUI` という名前のパブリックプロパティが含まれています。このプロパティを使用して、マスターページの Login コントロールの `Visible` プロパティを設定しています。</span><span class="sxs-lookup"><span data-stu-id="64a4b-123">For example, the master page might include a public property named `ShowLoginUI` whose value was used to set the `Visible` property of the Login control in the master page.</span></span> <span data-ttu-id="64a4b-124">ログインユーザーインターフェイスを抑制する必要があるコンテンツページでは、プログラムによって `ShowLoginUI` プロパティを `False`に設定できます。</span><span class="sxs-lookup"><span data-stu-id="64a4b-124">Those content pages where the login user interface should be suppressed could then programmatically set the `ShowLoginUI` property to `False`.</span></span>

<span data-ttu-id="64a4b-125">コンテンツページに表示されるデータは、何らかのアクションがコンテンツページに発生た後にマスターページに表示されるデータを更新する必要がある場合に、コンテンツやマスターページの相互作用の最も一般的な例になります。</span><span class="sxs-lookup"><span data-stu-id="64a4b-125">Perhaps the most common example of content and master page interaction occurs when data displayed in the master page needs to be refreshed after some action has transpired in the content page.</span></span> <span data-ttu-id="64a4b-126">特定のデータベーステーブルから最近追加された5つのレコードを表示する GridView を含むマスターページがあるとします。このページには、その同じテーブルに新しいレコードを追加するためのインターフェイスが含まれています。</span><span class="sxs-lookup"><span data-stu-id="64a4b-126">Consider a master page that includes a GridView that displays the five most recently added records from a particular database table, and that one of its content pages includes an interface for adding new records to that same table.</span></span>

<span data-ttu-id="64a4b-127">ユーザーがページにアクセスして新しいレコードを追加すると、マスターページに最後に追加された5つのレコードが表示されます。</span><span class="sxs-lookup"><span data-stu-id="64a4b-127">When a user visits the page to add a new record, she sees the five most recently added records displayed in the master page.</span></span> <span data-ttu-id="64a4b-128">新しいレコードの列の値を入力すると、彼女はフォームを送信します。</span><span class="sxs-lookup"><span data-stu-id="64a4b-128">After filling in the values for the new record's columns, she submits the form.</span></span> <span data-ttu-id="64a4b-129">マスターページの GridView の `EnableViewState` プロパティが True (既定値) に設定されている場合、そのコンテンツはビューステートから再読み込みされます。その結果、データベースに新しいレコードが追加された場合でも、5つの同じレコードが表示されます。</span><span class="sxs-lookup"><span data-stu-id="64a4b-129">Assuming that the GridView in the master page has its `EnableViewState` property set to True (the default), its content is reloaded from view state and, consequently, the five same records are displayed even though a newer record was just added to the database.</span></span> <span data-ttu-id="64a4b-130">これにより、ユーザーが混乱する可能性があります。</span><span class="sxs-lookup"><span data-stu-id="64a4b-130">This may confuse the user.</span></span>

> [!NOTE]
> <span data-ttu-id="64a4b-131">GridView のビューステートを無効にして、すべてのポストバックで基になるデータソースに再バインドする場合でも、配置に新しいレコードが追加されたときよりも前にデータがページのライフサイクルの前にバインドされるため、単に追加されたレコードは表示されません。ase.</span><span class="sxs-lookup"><span data-stu-id="64a4b-131">Even if you disable the GridView's view state so that it rebinds to its underlying data source on every postback, it still won't show the just-added record because the data is bound to the GridView earlier in the page lifecycle than when the new record is added to the database.</span></span>

<span data-ttu-id="64a4b-132">これを解決するには、追加したレコードがポストバック時にマスターページの GridView に表示されるようにするには、新しいレコードがデータベースに追加され*た後*に、そのデータソースに再バインドするように GridView に指示する必要があります。</span><span class="sxs-lookup"><span data-stu-id="64a4b-132">To remedy this so that the just-added record is displayed in the master page's GridView on postback we need to instruct the GridView to rebind to its data source *after* the new record has been added to the database.</span></span> <span data-ttu-id="64a4b-133">これには、新しいレコード (およびそのイベントハンドラー) を追加するためのインターフェイスがコンテンツページに含まれているが、更新する必要がある GridView がマスターページ内にあるため、コンテンツとマスターページ間の相互作用が必要です。</span><span class="sxs-lookup"><span data-stu-id="64a4b-133">This requires interaction between the content and master pages because the interface for adding the new record (and its event handlers) are in the content page but the GridView that needs to be refreshed is in the master page.</span></span>

<span data-ttu-id="64a4b-134">コンテンツページのイベントハンドラーからマスターページの表示を更新することは、コンテンツおよびマスターページの相互作用の最も一般的なニーズの1つであるため、このトピックの詳細について説明します。</span><span class="sxs-lookup"><span data-stu-id="64a4b-134">Because refreshing the master page's display from an event handler in the content page is one of the most common needs for content and master page interaction, let's explore this topic in more detail.</span></span> <span data-ttu-id="64a4b-135">このチュートリアルのダウンロードには、web サイトの `App_Data` フォルダーに `NORTHWIND.MDF` という名前の Microsoft SQL Server 2005 Express Edition データベースが含まれています。</span><span class="sxs-lookup"><span data-stu-id="64a4b-135">The download for this tutorial includes a Microsoft SQL Server 2005 Express Edition database named `NORTHWIND.MDF` in the website's `App_Data` folder.</span></span> <span data-ttu-id="64a4b-136">Northwind データベースには、架空の会社である Northwind Traders の製品、従業員、および販売情報が格納されます。</span><span class="sxs-lookup"><span data-stu-id="64a4b-136">The Northwind database stores product, employee, and sales information for a fictitious company, Northwind Traders.</span></span>

<span data-ttu-id="64a4b-137">手順1では、最後に追加した5つの製品を、マスターページの GridView に表示します。</span><span class="sxs-lookup"><span data-stu-id="64a4b-137">Step 1 walks through displaying the five most recently added products in a GridView in the master page.</span></span> <span data-ttu-id="64a4b-138">手順 2. では、新しい製品を追加するためのコンテンツページを作成します。</span><span class="sxs-lookup"><span data-stu-id="64a4b-138">Step 2 creates a content page for adding new products.</span></span> <span data-ttu-id="64a4b-139">手順 3. では、マスターページでパブリックプロパティとメソッドを作成する方法について説明します。手順4は、これらのプロパティとメソッドをコンテンツページからプログラムでインターフェイスする方法を示しています。</span><span class="sxs-lookup"><span data-stu-id="64a4b-139">Step 3 looks at how to create public properties and methods in the master page, and Step 4 illustrates how to programmatically interface with these properties and methods from the content page.</span></span>

> [!NOTE]
> <span data-ttu-id="64a4b-140">このチュートリアルでは、ASP.NET でのデータ操作の詳細については詳しく解説しません。</span><span class="sxs-lookup"><span data-stu-id="64a4b-140">This tutorial does not delve into the specifics of working with data in ASP.NET.</span></span> <span data-ttu-id="64a4b-141">データを表示するためのマスターページとデータを挿入するためのコンテンツページを設定する手順は完了しましたが、まだ入力されていません。</span><span class="sxs-lookup"><span data-stu-id="64a4b-141">The steps for setting up the master page to display data and the content page for inserting data are complete, yet breezy.</span></span> <span data-ttu-id="64a4b-142">データの表示と挿入、SqlDataSource コントロールと GridView コントロールの使用の詳細については、このチュートリアルの最後にある「詳細情報」セクションのリソースを参照してください。</span><span class="sxs-lookup"><span data-stu-id="64a4b-142">For a more in-depth look at displaying and inserting data and using the SqlDataSource and GridView controls, consult the resources in the Further Readings section at the end of this tutorial.</span></span>

## <a name="step-1-displaying-the-five-most-recently-added-products-in-the-master-page"></a><span data-ttu-id="64a4b-143">手順 1: マスターページに最近追加された5つの製品を表示する</span><span class="sxs-lookup"><span data-stu-id="64a4b-143">Step 1: Displaying the Five Most Recently Added Products in the Master Page</span></span>

<span data-ttu-id="64a4b-144">.Master マスターページを開き、ラベルと GridView コントロールを `leftContent` `<div>`に追加します。</span><span class="sxs-lookup"><span data-stu-id="64a4b-144">Open the Site.master master page and add a Label and a GridView control to the `leftContent` `<div>`.</span></span> <span data-ttu-id="64a4b-145">ラベルの `Text` プロパティをクリアし、その `EnableViewState` プロパティを `False`に設定し、その `ID` プロパティを `GridMessage`に設定します。GridView の `ID` プロパティを `RecentProducts`に設定します。</span><span class="sxs-lookup"><span data-stu-id="64a4b-145">Clear out the Label's `Text` property, set its `EnableViewState` property to `False`, and its `ID` property to `GridMessage`; set the GridView's `ID` property to `RecentProducts`.</span></span> <span data-ttu-id="64a4b-146">次に、デザイナーから GridView のスマートタグを展開し、新しいデータソースにバインドするように選択します。</span><span class="sxs-lookup"><span data-stu-id="64a4b-146">Next, from the Designer, expand the GridView's smart tag and choose to bind it to a new data source.</span></span> <span data-ttu-id="64a4b-147">データソース構成ウィザードが起動します。</span><span class="sxs-lookup"><span data-stu-id="64a4b-147">This launches the Data Source Configuration wizard.</span></span> <span data-ttu-id="64a4b-148">`App_Data` フォルダー内の Northwind データベースは Microsoft SQL Server データベースであるため、[] を選択して SqlDataSource の作成を選択します (図1を参照)。SqlDataSource `RecentProductsDataSource`という名前を指定します。</span><span class="sxs-lookup"><span data-stu-id="64a4b-148">Because the Northwind database in the `App_Data` folder is a Microsoft SQL Server database, choose to create a SqlDataSource by selecting (see Figure 1); name the SqlDataSource `RecentProductsDataSource`.</span></span>

<span data-ttu-id="64a4b-149">[GridView を RecentProductsDataSource という名前の SqlDataSource コントロールにバインド ![には](interacting-with-the-master-page-from-the-content-page-vb/_static/image2.png)](interacting-with-the-master-page-from-the-content-page-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="64a4b-149">[![Bind the GridView to a SqlDataSource Control Named RecentProductsDataSource](interacting-with-the-master-page-from-the-content-page-vb/_static/image2.png)](interacting-with-the-master-page-from-the-content-page-vb/_static/image1.png)</span></span>

<span data-ttu-id="64a4b-150">**図 01**: `RecentProductsDataSource` という名前の SqlDataSource コントロールに GridView をバインドする ([クリックすると、フルサイズの画像が表示](interacting-with-the-master-page-from-the-content-page-vb/_static/image3.png)されます)</span><span class="sxs-lookup"><span data-stu-id="64a4b-150">**Figure 01**: Bind the GridView to a SqlDataSource Control Named `RecentProductsDataSource` ([Click to view full-size image](interacting-with-the-master-page-from-the-content-page-vb/_static/image3.png))</span></span>

<span data-ttu-id="64a4b-151">次の手順では、接続先のデータベースを指定するように求められます。</span><span class="sxs-lookup"><span data-stu-id="64a4b-151">The next step asks us to specify what database to connect to.</span></span> <span data-ttu-id="64a4b-152">ドロップダウンリストから `NORTHWIND.MDF` データベースファイルを選択し、[次へ] をクリックします。</span><span class="sxs-lookup"><span data-stu-id="64a4b-152">Choose the `NORTHWIND.MDF` database file from the drop-down list and click Next.</span></span> <span data-ttu-id="64a4b-153">このデータベースを初めて使用したので、このウィザードでは `Web.config`に接続文字列を格納することができます。</span><span class="sxs-lookup"><span data-stu-id="64a4b-153">Because this is the first time we've used this database, the wizard will offer to store the connection string in `Web.config`.</span></span> <span data-ttu-id="64a4b-154">`NorthwindConnectionString`という名前を使用して接続文字列を格納します。</span><span class="sxs-lookup"><span data-stu-id="64a4b-154">Have it store the connection string using the name `NorthwindConnectionString`.</span></span>

<span data-ttu-id="64a4b-155">[Northwind データベースに接続 ![には](interacting-with-the-master-page-from-the-content-page-vb/_static/image5.png)](interacting-with-the-master-page-from-the-content-page-vb/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="64a4b-155">[![Connect to the Northwind Database](interacting-with-the-master-page-from-the-content-page-vb/_static/image5.png)](interacting-with-the-master-page-from-the-content-page-vb/_static/image4.png)</span></span>

<span data-ttu-id="64a4b-156">**図 02**: Northwind データベースに接続する ([クリックすると、フルサイズの画像が表示](interacting-with-the-master-page-from-the-content-page-vb/_static/image6.png)されます)</span><span class="sxs-lookup"><span data-stu-id="64a4b-156">**Figure 02**: Connect to the Northwind Database  ([Click to view full-size image](interacting-with-the-master-page-from-the-content-page-vb/_static/image6.png))</span></span>

<span data-ttu-id="64a4b-157">データソースの構成ウィザードには、データの取得に使用するクエリを指定できる2つの方法があります。</span><span class="sxs-lookup"><span data-stu-id="64a4b-157">The Configure Data Source wizard provides two means by which we can specify the query used to retrieve data:</span></span>

- <span data-ttu-id="64a4b-158">カスタム SQL ステートメントまたはストアドプロシージャを指定することによって、または</span><span class="sxs-lookup"><span data-stu-id="64a4b-158">By specifying a custom SQL statement or stored procedure, or</span></span>
- <span data-ttu-id="64a4b-159">テーブルまたはビューを選択し、返す列を指定する</span><span class="sxs-lookup"><span data-stu-id="64a4b-159">By picking a table or view and then specifying the columns to return</span></span>

<span data-ttu-id="64a4b-160">最近追加された5つの製品のみを取得するため、カスタム SQL ステートメントを指定する必要があります。</span><span class="sxs-lookup"><span data-stu-id="64a4b-160">Because we want to return just the five most recently added products, we need to specify a custom SQL statement.</span></span> <span data-ttu-id="64a4b-161">次の `SELECT` クエリを使用します。</span><span class="sxs-lookup"><span data-stu-id="64a4b-161">Use the following `SELECT` query:</span></span>

[!code-sql[Main](interacting-with-the-master-page-from-the-content-page-vb/samples/sample1.sql)]

<span data-ttu-id="64a4b-162">`TOP 5` キーワードは、クエリから最初の5つのレコードのみを返します。</span><span class="sxs-lookup"><span data-stu-id="64a4b-162">The `TOP 5` keyword returns only the first five records from the query.</span></span> <span data-ttu-id="64a4b-163">`Products` テーブルの主キーである `ProductID`は `IDENTITY` 列です。これにより、テーブルに追加された各新しい製品の値は、前のエントリよりも大きくなります。</span><span class="sxs-lookup"><span data-stu-id="64a4b-163">The `Products` table's primary key, `ProductID`, is an `IDENTITY` column, which assures us that each new product added to the table will have a larger value than the previous entry.</span></span> <span data-ttu-id="64a4b-164">したがって、結果を降順に並べ替えると、最後に作成された製品が返されます。これは、`ProductID` によって降順に並べ替えられます。</span><span class="sxs-lookup"><span data-stu-id="64a4b-164">Therefore, sorting the results by `ProductID` in descending order returns the products starting with the most recently created ones.</span></span>

<span data-ttu-id="64a4b-165">[最近追加された5つの製品を返す ![](interacting-with-the-master-page-from-the-content-page-vb/_static/image8.png)](interacting-with-the-master-page-from-the-content-page-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="64a4b-165">[![Return the Five Most Recently Added Products](interacting-with-the-master-page-from-the-content-page-vb/_static/image8.png)](interacting-with-the-master-page-from-the-content-page-vb/_static/image7.png)</span></span>

<span data-ttu-id="64a4b-166">**図 03**: 最近追加した5つの製品を返す ([クリックすると、フルサイズの画像が表示](interacting-with-the-master-page-from-the-content-page-vb/_static/image9.png)されます)</span><span class="sxs-lookup"><span data-stu-id="64a4b-166">**Figure 03**: Return the Five Most Recently Added Products  ([Click to view full-size image](interacting-with-the-master-page-from-the-content-page-vb/_static/image9.png))</span></span>

<span data-ttu-id="64a4b-167">ウィザードを完了すると、Visual Studio によって、データベースから返された `ProductName` フィールドと `UnitPrice` フィールドを表示するための2つの BoundFields が GridView によって生成されます。</span><span class="sxs-lookup"><span data-stu-id="64a4b-167">After completing the wizard, Visual Studio generates two BoundFields for the GridView to display the `ProductName` and `UnitPrice` fields returned from the database.</span></span> <span data-ttu-id="64a4b-168">この時点で、マスターページの宣言型マークアップには、次のようなマークアップを含める必要があります。</span><span class="sxs-lookup"><span data-stu-id="64a4b-168">At this point your master page's declarative markup should include markup similar to the following:</span></span>

[!code-aspx[Main](interacting-with-the-master-page-from-the-content-page-vb/samples/sample2.aspx)]

<span data-ttu-id="64a4b-169">ご覧のように、マークアップには、ラベル Web コントロール (`GridMessage`) が含まれています。2つの BoundFields を含む GridView `RecentProducts`。最後に追加された5つの製品を返す SqlDataSource コントロールです。</span><span class="sxs-lookup"><span data-stu-id="64a4b-169">As you can see, the markup contains: the Label Web control (`GridMessage`); the GridView `RecentProducts`, with two BoundFields; and a SqlDataSource control that returns the five most recently added products.</span></span>

<span data-ttu-id="64a4b-170">この GridView を作成し、SqlDataSource コントロールを構成したら、ブラウザーを使用して web サイトにアクセスします。</span><span class="sxs-lookup"><span data-stu-id="64a4b-170">With this GridView created and its SqlDataSource control configured, visit the website through a browser.</span></span> <span data-ttu-id="64a4b-171">図4に示すように、最後に追加された5つの製品を一覧表示するグリッドが左下隅に表示されます。</span><span class="sxs-lookup"><span data-stu-id="64a4b-171">As Figure 4 shows, you will see a grid in the lower left corner that lists the five most recently added products.</span></span>

<span data-ttu-id="64a4b-172">[GridView に ![、最近追加された5つの製品が表示されます。](interacting-with-the-master-page-from-the-content-page-vb/_static/image11.png)](interacting-with-the-master-page-from-the-content-page-vb/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="64a4b-172">[![The GridView Displays the Five Most Recently Added Products](interacting-with-the-master-page-from-the-content-page-vb/_static/image11.png)](interacting-with-the-master-page-from-the-content-page-vb/_static/image10.png)</span></span>

<span data-ttu-id="64a4b-173">**図 04**: GridView には、最近追加された5つの製品が表示されます ([クリックすると、フルサイズの画像が表示](interacting-with-the-master-page-from-the-content-page-vb/_static/image12.png)されます)</span><span class="sxs-lookup"><span data-stu-id="64a4b-173">**Figure 04**: The GridView Displays the Five Most Recently Added Products ([Click to view full-size image](interacting-with-the-master-page-from-the-content-page-vb/_static/image12.png))</span></span>

> [!NOTE]
> <span data-ttu-id="64a4b-174">GridView の外観を自由にクリーンアップしてください。</span><span class="sxs-lookup"><span data-stu-id="64a4b-174">Feel free to clean up the appearance of the GridView.</span></span> <span data-ttu-id="64a4b-175">一部の提案には、表示された `UnitPrice` 値を通貨として書式設定する、背景色とフォントを使用してグリッドの外観を向上させることが含まれます。</span><span class="sxs-lookup"><span data-stu-id="64a4b-175">Some suggestions include formatting the displayed `UnitPrice` value as a currency and using background colors and fonts to improve the grid's appearance.</span></span>

## <a name="step-2-creating-a-content-page-to-add-new-products"></a><span data-ttu-id="64a4b-176">手順 2: 新しい製品を追加するためのコンテンツページの作成</span><span class="sxs-lookup"><span data-stu-id="64a4b-176">Step 2: Creating a Content Page to Add New Products</span></span>

<span data-ttu-id="64a4b-177">次のタスクでは、ユーザーが新しい製品を `Products` テーブルに追加できるコンテンツページを作成します。</span><span class="sxs-lookup"><span data-stu-id="64a4b-177">Our next task is to create a content page from which a user can add a new product to the `Products` table.</span></span> <span data-ttu-id="64a4b-178">`AddProduct.aspx`という名前の `Admin` フォルダーに新しいコンテンツページを追加し、`Site.master` マスターページにバインドするようにします。</span><span class="sxs-lookup"><span data-stu-id="64a4b-178">Add a new content page to the `Admin` folder named `AddProduct.aspx`, making sure to bind it to the `Site.master` master page.</span></span> <span data-ttu-id="64a4b-179">図5は、このページが web サイトに追加された後のソリューションエクスプローラーを示しています。</span><span class="sxs-lookup"><span data-stu-id="64a4b-179">Figure 5 shows the Solution Explorer after this page has been added to the website.</span></span>

<span data-ttu-id="64a4b-180">[新しい ASP.NET ページを管理フォルダーに追加 ![には](interacting-with-the-master-page-from-the-content-page-vb/_static/image14.png)](interacting-with-the-master-page-from-the-content-page-vb/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="64a4b-180">[![Add a New ASP.NET Page to the Admin Folder](interacting-with-the-master-page-from-the-content-page-vb/_static/image14.png)](interacting-with-the-master-page-from-the-content-page-vb/_static/image13.png)</span></span>

<span data-ttu-id="64a4b-181">**図 05**: `Admin` フォルダーに新しい ASP.NET ページを追加する ([クリックすると、フルサイズの画像が表示](interacting-with-the-master-page-from-the-content-page-vb/_static/image15.png)されます)</span><span class="sxs-lookup"><span data-stu-id="64a4b-181">**Figure 05**: Add a New ASP.NET Page to the `Admin` Folder ([Click to view full-size image](interacting-with-the-master-page-from-the-content-page-vb/_static/image15.png))</span></span>

<span data-ttu-id="64a4b-182">[ *「マスターページでタイトル、メタタグ、およびその他の HTML ヘッダーを指定*](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb.md)する」チュートリアルでは、明示的に設定されていない場合にページのタイトルを生成する `BasePage` という名前のカスタム基本ページクラスを作成しました。</span><span class="sxs-lookup"><span data-stu-id="64a4b-182">Recall that in the [*Specifying the Title, Meta Tags, and Other HTML Headers in the Master Page*](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb.md) tutorial we created a custom base page class named `BasePage` that generated the page's title if it was not explicitly set.</span></span> <span data-ttu-id="64a4b-183">`AddProduct.aspx` ページの分離コードクラスにアクセスし、`System.Web.UI.Page`からではなく `BasePage` から派生させます。</span><span class="sxs-lookup"><span data-stu-id="64a4b-183">Go to the `AddProduct.aspx` page's code-behind class and have it derive from `BasePage` (instead of from `System.Web.UI.Page`).</span></span>

<span data-ttu-id="64a4b-184">最後に、このレッスンのエントリを含めるように `Web.sitemap` ファイルを更新します。</span><span class="sxs-lookup"><span data-stu-id="64a4b-184">Finally, update the `Web.sitemap` file to include an entry for this lesson.</span></span> <span data-ttu-id="64a4b-185">コントロール ID の名前付けの問題に関するレッスンの `<siteMapNode>` の下に、次のマークアップを追加します。</span><span class="sxs-lookup"><span data-stu-id="64a4b-185">Add the following markup beneath the `<siteMapNode>` for the Control ID Naming Issues lesson:</span></span>

[!code-xml[Main](interacting-with-the-master-page-from-the-content-page-vb/samples/sample3.xml)]

<span data-ttu-id="64a4b-186">図6に示すように、この `<siteMapNode>` 要素の追加はレッスンの一覧に反映されています。</span><span class="sxs-lookup"><span data-stu-id="64a4b-186">As shown in Figure 6, the addition of this `<siteMapNode>` element is reflected in the Lessons list.</span></span>

<span data-ttu-id="64a4b-187">`AddProduct.aspx`に戻ります。</span><span class="sxs-lookup"><span data-stu-id="64a4b-187">Return to `AddProduct.aspx`.</span></span> <span data-ttu-id="64a4b-188">`MainContent` ContentPlaceHolder のコンテンツコントロールで、DetailsView コントロールを追加し、`NewProduct`という名前を指定します。</span><span class="sxs-lookup"><span data-stu-id="64a4b-188">In the Content control for the `MainContent` ContentPlaceHolder, add a DetailsView control and name it `NewProduct`.</span></span> <span data-ttu-id="64a4b-189">DetailsView を `NewProductDataSource`という名前の新しい SqlDataSource コントロールにバインドします。</span><span class="sxs-lookup"><span data-stu-id="64a4b-189">Bind the DetailsView to a new SqlDataSource control named `NewProductDataSource`.</span></span> <span data-ttu-id="64a4b-190">手順 1. の SqlDataSource と同様に、Northwind データベースを使用するようにウィザードを構成し、カスタム SQL ステートメントを指定します。</span><span class="sxs-lookup"><span data-stu-id="64a4b-190">Like with the SqlDataSource in Step 1, configure the wizard so that it uses the Northwind database and choose to specify a custom SQL statement.</span></span> <span data-ttu-id="64a4b-191">DetailsView はデータベースに項目を追加するために使用されるため、`SELECT` ステートメントと `INSERT` ステートメントの両方を指定する必要があります。</span><span class="sxs-lookup"><span data-stu-id="64a4b-191">Because the DetailsView will be used to add items to the database, we need to specify both a `SELECT` statement and an `INSERT` statement.</span></span> <span data-ttu-id="64a4b-192">次の `SELECT` クエリを使用します。</span><span class="sxs-lookup"><span data-stu-id="64a4b-192">Use the following `SELECT` query:</span></span>

[!code-sql[Main](interacting-with-the-master-page-from-the-content-page-vb/samples/sample4.sql)]

<span data-ttu-id="64a4b-193">次に、[挿入] タブで、次の `INSERT` ステートメントを追加します。</span><span class="sxs-lookup"><span data-stu-id="64a4b-193">Then, from the INSERT tab, add the following `INSERT` statement:</span></span>

[!code-sql[Main](interacting-with-the-master-page-from-the-content-page-vb/samples/sample5.sql)]

<span data-ttu-id="64a4b-194">ウィザードが完了したら、DetailsView のスマートタグにアクセスし、[挿入を有効にする] チェックボックスをオンにします。</span><span class="sxs-lookup"><span data-stu-id="64a4b-194">After completing the wizard go to the DetailsView's smart tag and check the "Enable Inserting" checkbox.</span></span> <span data-ttu-id="64a4b-195">これにより、`ShowInsertButton` プロパティが True に設定された CommandField が DetailsView に追加されます。</span><span class="sxs-lookup"><span data-stu-id="64a4b-195">This adds a CommandField to the DetailsView with its `ShowInsertButton` property set to True.</span></span> <span data-ttu-id="64a4b-196">この DetailsView はデータを挿入するためだけに使用されるため、DetailsView の `DefaultMode` プロパティを `Insert`に設定します。</span><span class="sxs-lookup"><span data-stu-id="64a4b-196">Because this DetailsView will be used solely for inserting data, set the DetailsView's `DefaultMode` property to `Insert`.</span></span>

<span data-ttu-id="64a4b-197">必要な作業は以上です。</span><span class="sxs-lookup"><span data-stu-id="64a4b-197">That's all there is to it!</span></span> <span data-ttu-id="64a4b-198">このページをテストしてみましょう。</span><span class="sxs-lookup"><span data-stu-id="64a4b-198">Let's test this page.</span></span> <span data-ttu-id="64a4b-199">ブラウザーを使用して `AddProduct.aspx` にアクセスし、名前と価格を入力します (図6を参照)。</span><span class="sxs-lookup"><span data-stu-id="64a4b-199">Visit `AddProduct.aspx` through a browser, enter a name and price (see Figure 6).</span></span>

<span data-ttu-id="64a4b-200">[新しい製品をデータベースに追加 ![には](interacting-with-the-master-page-from-the-content-page-vb/_static/image17.png)](interacting-with-the-master-page-from-the-content-page-vb/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="64a4b-200">[![Add a New Product to the Database](interacting-with-the-master-page-from-the-content-page-vb/_static/image17.png)](interacting-with-the-master-page-from-the-content-page-vb/_static/image16.png)</span></span>

<span data-ttu-id="64a4b-201">**図 06**: データベースに新しい製品を追加する ([クリックすると、フルサイズの画像が表示](interacting-with-the-master-page-from-the-content-page-vb/_static/image18.png)されます)</span><span class="sxs-lookup"><span data-stu-id="64a4b-201">**Figure 06**: Add a New Product to the Database  ([Click to view full-size image](interacting-with-the-master-page-from-the-content-page-vb/_static/image18.png))</span></span>

<span data-ttu-id="64a4b-202">新しい製品の名前と価格を入力したら、[挿入] ボタンをクリックします。</span><span class="sxs-lookup"><span data-stu-id="64a4b-202">After typing in the name and price for your new product, click the Insert button.</span></span> <span data-ttu-id="64a4b-203">これにより、フォームがポストバックされます。</span><span class="sxs-lookup"><span data-stu-id="64a4b-203">This causes the form to postback.</span></span> <span data-ttu-id="64a4b-204">ポストバック時に、SqlDataSource コントロールの `INSERT` ステートメントが実行されます。2つのパラメーターには、DetailsView の2つの TextBox コントロールにユーザーが入力した値が設定されます。</span><span class="sxs-lookup"><span data-stu-id="64a4b-204">On postback, the SqlDataSource control's `INSERT` statement is executed; its two parameters are populated with the user-entered values in the DetailsView's two TextBox controls.</span></span> <span data-ttu-id="64a4b-205">残念ながら、挿入が発生したことを示す視覚的なフィードバックはありません。</span><span class="sxs-lookup"><span data-stu-id="64a4b-205">Unfortunately, there is no visual feedback that an insert has occurred.</span></span> <span data-ttu-id="64a4b-206">新しいレコードが追加されたことを確認するメッセージが表示されます。</span><span class="sxs-lookup"><span data-stu-id="64a4b-206">It would be nice to have a message displayed, confirming that a new record has been added.</span></span> <span data-ttu-id="64a4b-207">この作業をリーダーの演習として残しておきます。</span><span class="sxs-lookup"><span data-stu-id="64a4b-207">I leave this as an exercise for the reader.</span></span> <span data-ttu-id="64a4b-208">また、DetailsView から新しいレコードを追加した後も、マスターページの GridView には前と同じ5つのレコードが表示されます。これには、追加されたレコードは含まれません。</span><span class="sxs-lookup"><span data-stu-id="64a4b-208">Also, after adding a new record from the DetailsView the GridView in the master page still shows the same five records as before; it does not include the just-added record.</span></span> <span data-ttu-id="64a4b-209">これを解決する方法については、次の手順で説明します。</span><span class="sxs-lookup"><span data-stu-id="64a4b-209">We'll examine how to remedy this in the upcoming steps.</span></span>

> [!NOTE]
> <span data-ttu-id="64a4b-210">挿入が成功したという視覚的なフィードバックをいくつか追加するだけでなく、検証を含めるように DetailsView の挿入インターフェイスを更新することもお勧めします。</span><span class="sxs-lookup"><span data-stu-id="64a4b-210">In addition to adding some form of visual feedback that the insert has succeeded, I'd encourage you to also update the DetailsView's inserting interface to include validation.</span></span> <span data-ttu-id="64a4b-211">現在、検証は行われていません。</span><span class="sxs-lookup"><span data-stu-id="64a4b-211">Currently, there is no validation.</span></span> <span data-ttu-id="64a4b-212">ユーザーが "高すぎる" などの `UnitPrice` フィールドに対して無効な値を入力すると、システムがその文字列を10進数に変換しようとしたときに、ポストバック時に例外がスローされます。</span><span class="sxs-lookup"><span data-stu-id="64a4b-212">If a user enters an invalid value for the `UnitPrice` field, such as "Too expensive," an exception will be thrown on postback when the system attempts to convert that string into a decimal.</span></span> <span data-ttu-id="64a4b-213">挿入インターフェイスをカスタマイズする方法の詳細については、データ[*変更インターフェイスのカスタマイズ*](https://asp.net/learn/data-access/tutorial-20-vb.aspx)に関するチュートリアルを参照して[ください。](../../data-access/index.md)</span><span class="sxs-lookup"><span data-stu-id="64a4b-213">For more information on customizing the inserting interface, refer to the [*Customizing the Data Modification Interface* tutorial](https://asp.net/learn/data-access/tutorial-20-vb.aspx) from my [Working with Data tutorial series](../../data-access/index.md).</span></span>

## <a name="step-3-creating-public-properties-and-methods-in-the-master-page"></a><span data-ttu-id="64a4b-214">手順 3: マスターページでパブリックプロパティとパブリックメソッドを作成する</span><span class="sxs-lookup"><span data-stu-id="64a4b-214">Step 3: Creating Public Properties and Methods in the Master Page</span></span>

<span data-ttu-id="64a4b-215">手順1では、マスターページの GridView の上に `GridMessage` という名前のラベル Web コントロールを追加しました。</span><span class="sxs-lookup"><span data-stu-id="64a4b-215">In Step 1 we added a Label Web control named `GridMessage` above the GridView in the master page.</span></span> <span data-ttu-id="64a4b-216">このラベルは、必要に応じてメッセージを表示することを目的としています。</span><span class="sxs-lookup"><span data-stu-id="64a4b-216">This Label is intended to optionally display a message.</span></span> <span data-ttu-id="64a4b-217">たとえば、`Products` テーブルに新しいレコードを追加した後、"*ProductName*がデータベースに追加されました。" というメッセージが表示される場合があります。</span><span class="sxs-lookup"><span data-stu-id="64a4b-217">For example, after adding a new record to the `Products` table, we might want to show a message that reads: "*ProductName* has been added to the database."</span></span> <span data-ttu-id="64a4b-218">マスターページでこのラベルのテキストをハードコーディングするのではなく、[コンテンツ] ページでメッセージをカスタマイズできるようにすることをお勧めします。</span><span class="sxs-lookup"><span data-stu-id="64a4b-218">Rather than hard-code the text for this Label in the master page, we might want the message to be customizable by the content page.</span></span>

<span data-ttu-id="64a4b-219">ラベルコントロールは、マスターページ内の保護されたメンバー変数として実装されているため、コンテンツページから直接アクセスすることはできません。</span><span class="sxs-lookup"><span data-stu-id="64a4b-219">Because the Label control is implemented as a protected member variable within the master page it cannot be accessed directly from content pages.</span></span> <span data-ttu-id="64a4b-220">コンテンツページ (または、マスターページ内の任意の Web コントロール) からマスターページ内のラベルを操作するには、Web コントロールを公開するマスターページでパブリックプロパティを作成するか、そのプロパティのいずれかを使用してプロキシとして機能させる必要があります。 できる.</span><span class="sxs-lookup"><span data-stu-id="64a4b-220">In order to work with the Label within a master page from the content page (or, for that matter, any Web control in the master page) we need to create a public property in the master page that exposes the Web control or serves as a proxy by which one of its properties can be accessed.</span></span> <span data-ttu-id="64a4b-221">次の構文をマスターページの分離コードクラスに追加して、ラベルの `Text` プロパティを公開します。</span><span class="sxs-lookup"><span data-stu-id="64a4b-221">Add the following syntax to the master page's code-behind class to expose the Label's `Text` property:</span></span>

[!code-vb[Main](interacting-with-the-master-page-from-the-content-page-vb/samples/sample6.vb)]

<span data-ttu-id="64a4b-222">コンテンツページから `Products` テーブルに新しいレコードが追加されたときに、マスターページ内の `RecentProducts` GridView は、基になるデータソースに再バインドする必要があります。</span><span class="sxs-lookup"><span data-stu-id="64a4b-222">When a new record is added to the `Products` table from a content page the `RecentProducts` GridView in the master page needs to rebind to its underlying data source.</span></span> <span data-ttu-id="64a4b-223">GridView を再バインドするには、その `DataBind` メソッドを呼び出します。</span><span class="sxs-lookup"><span data-stu-id="64a4b-223">To rebind the GridView call its `DataBind` method.</span></span> <span data-ttu-id="64a4b-224">マスターページの GridView は、プログラムでコンテンツページにアクセスできないため、マスターページでパブリックメソッドを作成する必要があります。このメソッドを呼び出すと、データが GridView に再バインドされます。</span><span class="sxs-lookup"><span data-stu-id="64a4b-224">Because the GridView in the master page is not programmatically accessible to the content pages, we need to create a public method in the master page that, when called, rebinds the data to the GridView.</span></span> <span data-ttu-id="64a4b-225">マスターページの分離コードクラスに次のメソッドを追加します。</span><span class="sxs-lookup"><span data-stu-id="64a4b-225">Add the following method to the master page's code-behind class:</span></span>

[!code-vb[Main](interacting-with-the-master-page-from-the-content-page-vb/samples/sample7.vb)]

<span data-ttu-id="64a4b-226">`GridMessageText` プロパティと `RefreshRecentProductsGrid` メソッドを使用すると、任意のコンテンツページで `GridMessage` ラベルの `Text` プロパティの値をプログラムによって設定または読み取りたり、データを `RecentProducts` GridView に再バインドしたりできます。</span><span class="sxs-lookup"><span data-stu-id="64a4b-226">With the `GridMessageText` property and `RefreshRecentProductsGrid` method in place, any content page can programmatically set or read the value of the `GridMessage` Label's `Text` property or rebind the data to the `RecentProducts` GridView.</span></span> <span data-ttu-id="64a4b-227">手順 4. では、コンテンツページからマスターページのパブリックプロパティおよびメソッドにアクセスする方法を確認します。</span><span class="sxs-lookup"><span data-stu-id="64a4b-227">Step 4 examines how to access the master page's public properties and methods from a content page.</span></span>

> [!NOTE]
> <span data-ttu-id="64a4b-228">マスターページのプロパティとメソッドを `Public`としてマークすることは忘れないでください。</span><span class="sxs-lookup"><span data-stu-id="64a4b-228">Don't forget to mark the master page's properties and methods as `Public`.</span></span> <span data-ttu-id="64a4b-229">これらのプロパティとメソッドを `Public`として明示的に指定していない場合、コンテンツページからアクセスすることはできません。</span><span class="sxs-lookup"><span data-stu-id="64a4b-229">If you do not explicitly denote these properties and methods as `Public`, they will not be accessible from the content page.</span></span>

## <a name="step-4-calling-the-master-pages-public-members-from-a-content-page"></a><span data-ttu-id="64a4b-230">手順 4: コンテンツページからマスターページのパブリックメンバーを呼び出す</span><span class="sxs-lookup"><span data-stu-id="64a4b-230">Step 4: Calling the Master Page's Public Members from a Content Page</span></span>

<span data-ttu-id="64a4b-231">マスターページに必要なパブリックプロパティとメソッドが用意されたので、[`AddProduct.aspx` コンテンツ] ページからこれらのプロパティとメソッドを呼び出すことができます。</span><span class="sxs-lookup"><span data-stu-id="64a4b-231">Now that the master page has the necessary public properties and methods, we're ready to invoke these properties and methods from the `AddProduct.aspx` content page.</span></span> <span data-ttu-id="64a4b-232">具体的には、新しい製品をデータベースに追加した後で、マスターページの `GridMessageText` プロパティを設定し、その `RefreshRecentProductsGrid` メソッドを呼び出す必要があります。</span><span class="sxs-lookup"><span data-stu-id="64a4b-232">Specifically, we need to set the master page's `GridMessageText` property and call its `RefreshRecentProductsGrid` method after the new product has been added to the database.</span></span> <span data-ttu-id="64a4b-233">すべての ASP.NET データ Web コントロールは、さまざまなタスクが完了する直前と直後にイベントを発生させます。これにより、ページの開発者は、タスクの前後でプログラムによるアクションを簡単に実行できます。</span><span class="sxs-lookup"><span data-stu-id="64a4b-233">All the ASP.NET data Web controls fire events immediately before and after completing various tasks, which make it easy for page developers to take some programmatic action either before or after the task.</span></span> <span data-ttu-id="64a4b-234">たとえば、エンドユーザーが DetailsView の Insert ボタンをクリックすると、ポストバック時に、挿入ワークフローを開始する前に、その `ItemInserting` イベントが発生します。</span><span class="sxs-lookup"><span data-stu-id="64a4b-234">For example, when the end user clicks the DetailsView's Insert button, on postback the DetailsView raises its `ItemInserting` event before beginning the inserting workflow.</span></span> <span data-ttu-id="64a4b-235">次に、レコードをデータベースに挿入します。</span><span class="sxs-lookup"><span data-stu-id="64a4b-235">It then inserts the record into the database.</span></span> <span data-ttu-id="64a4b-236">その後、DetailsView によって `ItemInserted` イベントが発生します。</span><span class="sxs-lookup"><span data-stu-id="64a4b-236">Following that, the DetailsView raises its `ItemInserted` event.</span></span> <span data-ttu-id="64a4b-237">そのため、新しい製品が追加された後にマスターページを操作するには、DetailsView の `ItemInserted` イベントのイベントハンドラーを作成します。</span><span class="sxs-lookup"><span data-stu-id="64a4b-237">Therefore, in order to work with the master page after the new product has been added, create an event handler for the DetailsView's `ItemInserted` event.</span></span>

<span data-ttu-id="64a4b-238">コンテンツページは、次の2つの方法でマスターページとプログラムによってインターフェイスできます。</span><span class="sxs-lookup"><span data-stu-id="64a4b-238">There are two ways that a content page can programmatically interface with its master page:</span></span>

- <span data-ttu-id="64a4b-239">`Page.Master` プロパティを使用します。これは、マスターページへの疎型の参照を返します。</span><span class="sxs-lookup"><span data-stu-id="64a4b-239">Using the `Page.Master` property, which returns a loosely-typed reference to the master page, or</span></span>
- <span data-ttu-id="64a4b-240">`@MasterType` ディレクティブを使用して、ページのマスターページの種類またはファイルパスを指定します。これにより、厳密に型指定されたプロパティが `Master`という名前のページに自動的に追加されます。</span><span class="sxs-lookup"><span data-stu-id="64a4b-240">Specify the page's master page type or file path via a `@MasterType` directive; this automatically adds a strongly-typed property to the page named `Master`.</span></span>

<span data-ttu-id="64a4b-241">両方の方法を検討してみましょう。</span><span class="sxs-lookup"><span data-stu-id="64a4b-241">Let's examine both approaches.</span></span>

### <a name="using-the-loosely-typedpagemasterproperty"></a><span data-ttu-id="64a4b-242">緩やかに型指定された`Page.Master`プロパティの使用</span><span class="sxs-lookup"><span data-stu-id="64a4b-242">Using the Loosely-Typed`Page.Master`Property</span></span>

<span data-ttu-id="64a4b-243">すべての ASP.NET web ページは、`System.Web.UI` 名前空間にある `Page` クラスから派生する必要があります。</span><span class="sxs-lookup"><span data-stu-id="64a4b-243">All ASP.NET web pages must derive from the `Page` class, which is located in the `System.Web.UI` namespace.</span></span> <span data-ttu-id="64a4b-244">`Page` クラスには、ページのマスターページへの参照を返す[`Master` プロパティ](https://msdn.microsoft.com/library/system.web.ui.page.master.aspx)が含まれています。</span><span class="sxs-lookup"><span data-stu-id="64a4b-244">The `Page` class includes a [`Master` property](https://msdn.microsoft.com/library/system.web.ui.page.master.aspx) that returns a reference to the page's master page.</span></span> <span data-ttu-id="64a4b-245">ページにマスターページがない場合 `Master` は `Nothing`を返します。</span><span class="sxs-lookup"><span data-stu-id="64a4b-245">If the page does not have a master page `Master` returns `Nothing`.</span></span>

<span data-ttu-id="64a4b-246">`Master` プロパティは、 [`MasterPage`](https://msdn.microsoft.com/library/system.web.ui.masterpage.aspx)型のオブジェクト (`System.Web.UI` 名前空間にもあります) を返します。これは、すべてのマスターページの派生元である基本型です。</span><span class="sxs-lookup"><span data-stu-id="64a4b-246">The `Master` property returns an object of type [`MasterPage`](https://msdn.microsoft.com/library/system.web.ui.masterpage.aspx) (also located in the `System.Web.UI` namespace) which is the base type from which all master pages derive from.</span></span> <span data-ttu-id="64a4b-247">そのため、web サイトのマスターページで定義されているパブリックプロパティまたはメソッドを使用するには、`Master` プロパティから返された `MasterPage` オブジェクトを適切な型にキャストする必要があります。</span><span class="sxs-lookup"><span data-stu-id="64a4b-247">Therefore, to use public properties or methods defined in our website's master page we must cast the `MasterPage` object returned from the `Master` property to the appropriate type.</span></span> <span data-ttu-id="64a4b-248">マスターページファイルに `Site.master`という名前を付けたので、分離コードクラスの名前は `Site`でした。</span><span class="sxs-lookup"><span data-stu-id="64a4b-248">Because we named our master page file `Site.master`, the code-behind class was named `Site`.</span></span> <span data-ttu-id="64a4b-249">したがって、次のコードは、`Page.Master` プロパティを `Site` クラスのインスタンスにキャストします。</span><span class="sxs-lookup"><span data-stu-id="64a4b-249">Therefore, the following code casts the `Page.Master` property to an instance of the `Site` class.</span></span>

[!code-vb[Main](interacting-with-the-master-page-from-the-content-page-vb/samples/sample8.vb)]

<span data-ttu-id="64a4b-250">これで、疎型の `Page.Master` プロパティがサイトの種類にキャストされました。ここでは、サイトに固有のプロパティとメソッドを参照できます。</span><span class="sxs-lookup"><span data-stu-id="64a4b-250">Now that we have casted the loosely-typed `Page.Master` property to the Site type we can reference the properties and methods specific to Site.</span></span> <span data-ttu-id="64a4b-251">図7に示すように、[パブリック] プロパティ `GridMessageText` は [IntelliSense] ドロップダウンに表示されます。</span><span class="sxs-lookup"><span data-stu-id="64a4b-251">As Figure 7 shows, the public property `GridMessageText` appears in the IntelliSense drop-down.</span></span>

<span data-ttu-id="64a4b-252">[![の IntelliSense は、マスターページのパブリックプロパティとメソッドを表示します](interacting-with-the-master-page-from-the-content-page-vb/_static/image20.png)](interacting-with-the-master-page-from-the-content-page-vb/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="64a4b-252">[![IntelliSense Shows our Master Page's Public Properties and Methods](interacting-with-the-master-page-from-the-content-page-vb/_static/image20.png)](interacting-with-the-master-page-from-the-content-page-vb/_static/image19.png)</span></span>

<span data-ttu-id="64a4b-253">**図 07**: IntelliSense では、マスターページのパブリックプロパティとメソッドが表示されます ([クリックすると、フルサイズの画像が表示](interacting-with-the-master-page-from-the-content-page-vb/_static/image21.png)されます)</span><span class="sxs-lookup"><span data-stu-id="64a4b-253">**Figure 07**: IntelliSense Shows our Master Page's Public Properties and Methods ([Click to view full-size image](interacting-with-the-master-page-from-the-content-page-vb/_static/image21.png))</span></span>

> [!NOTE]
> <span data-ttu-id="64a4b-254">マスターページファイルに名前を付けた場合は、マスターページの分離コードクラス名が `MasterPage``MasterPage.master` ます。</span><span class="sxs-lookup"><span data-stu-id="64a4b-254">If you named your master page file `MasterPage.master` then the master page's code-behind class name is `MasterPage`.</span></span> <span data-ttu-id="64a4b-255">これにより、型 `System.Web.UI.MasterPage` から `MasterPage` クラスにキャストするときに、あいまいなコードが発生する可能性があります。</span><span class="sxs-lookup"><span data-stu-id="64a4b-255">This can lead to ambiguous code when casting from the type `System.Web.UI.MasterPage` to your `MasterPage` class.</span></span> <span data-ttu-id="64a4b-256">つまり、キャスト先の型を完全修飾する必要があります。これは、Web サイトプロジェクトモデルを使用する場合には少し注意が必要です。</span><span class="sxs-lookup"><span data-stu-id="64a4b-256">In short, you need to fully qualify the type you are casting to, which can be a little tricky when using the Web Site Project model.</span></span> <span data-ttu-id="64a4b-257">私の提案としては、マスターページを作成するときに `MasterPage.master` 以外の名前を使用するか、マスターページへの厳密に型指定された参照を作成することをお勧めします。</span><span class="sxs-lookup"><span data-stu-id="64a4b-257">My suggestion would be to either make sure that when you create your master page you name it something other than `MasterPage.master` or, even better, create a strongly-typed reference to the master page.</span></span>

### <a name="creating-a-strongly-typed-reference-with-themastertypedirective"></a><span data-ttu-id="64a4b-258">`@MasterType`ディレクティブを使用した厳密に型指定された参照の作成</span><span class="sxs-lookup"><span data-stu-id="64a4b-258">Creating a Strongly-Typed Reference with the`@MasterType`Directive</span></span>

<span data-ttu-id="64a4b-259">詳細を見ると、ASP.NET ページの分離コードクラスが部分クラスであることがわかります (クラス定義の `Partial` キーワードに注意してください)。</span><span class="sxs-lookup"><span data-stu-id="64a4b-259">If you look closely you can see that an ASP.NET page's code-behind class is a partial class (note the `Partial` keyword in the class definition).</span></span> <span data-ttu-id="64a4b-260">部分クラスは、とC# Visual Basic with.NET Framework 2.0 で導入され、簡単に言うと、クラスのメンバーを複数のファイルにわたって定義できます。</span><span class="sxs-lookup"><span data-stu-id="64a4b-260">Partial classes were introduced in C# and Visual Basic with.NET Framework 2.0 and, in a nutshell, allow for a class's members to be defined across multiple files.</span></span> <span data-ttu-id="64a4b-261">たとえば、コードビハインドクラスファイル `AddProduct.aspx.vb`には、ページ開発者が作成するコードが含まれています。</span><span class="sxs-lookup"><span data-stu-id="64a4b-261">The code-behind class file - `AddProduct.aspx.vb`, for example - contains the code that we, the page developer, create.</span></span> <span data-ttu-id="64a4b-262">ASP.NET エンジンは、コードに加えて、宣言型マークアップをページのクラス階層に変換するのプロパティとイベントハンドラーを含む個別のクラスファイルを自動的に作成します。</span><span class="sxs-lookup"><span data-stu-id="64a4b-262">In addition to our code, the ASP.NET engine automatically creates a separate class file with properties and event handlers in that translate the declarative markup into the page's class hierarchy.</span></span>

<span data-ttu-id="64a4b-263">ASP.NET ページがアクセスされるたびに発生する自動コード生成は、興味深い、役に立つ可能性のある方法を道にしています。</span><span class="sxs-lookup"><span data-stu-id="64a4b-263">The automatic code generation that occurs whenever an ASP.NET page is visited paves the way for some rather interesting and useful possibilities.</span></span> <span data-ttu-id="64a4b-264">マスターページの場合、コンテンツページによって使用されているマスターページを ASP.NET エンジンに通知すると、厳密に型指定された `Master` プロパティが生成されます。</span><span class="sxs-lookup"><span data-stu-id="64a4b-264">In the case of master pages, if we tell the ASP.NET engine what master page is being used by our content page it generates a strongly-typed `Master` property for us.</span></span>

<span data-ttu-id="64a4b-265">コンテンツページのマスターページの種類を ASP.NET エンジンに通知するには、 [`@MasterType` ディレクティブ](https://msdn.microsoft.com/library/ms228274.aspx)を使用します。</span><span class="sxs-lookup"><span data-stu-id="64a4b-265">Use the [`@MasterType` directive](https://msdn.microsoft.com/library/ms228274.aspx) to inform the ASP.NET engine of the content page's master page type.</span></span> <span data-ttu-id="64a4b-266">`@MasterType` ディレクティブは、マスターページの型名またはそのファイルパスを受け入れることができます。</span><span class="sxs-lookup"><span data-stu-id="64a4b-266">The `@MasterType` directive can accept either the type name of the master page or its file path.</span></span> <span data-ttu-id="64a4b-267">`AddProduct.aspx` ページで `Site.master` をマスターページとして使用するように指定するには、`AddProduct.aspx`の先頭に次のディレクティブを追加します。</span><span class="sxs-lookup"><span data-stu-id="64a4b-267">To specify that the `AddProduct.aspx` page uses `Site.master` as its master page, add the following directive to the top of `AddProduct.aspx`:</span></span>

[!code-aspx[Main](interacting-with-the-master-page-from-the-content-page-vb/samples/sample9.aspx)]

<span data-ttu-id="64a4b-268">このディレクティブは、ASP.NET エンジンに対し、`Master`という名前のプロパティを使用して、厳密に型指定された参照をマスターページに追加するように指示します。</span><span class="sxs-lookup"><span data-stu-id="64a4b-268">This directive instructs the ASP.NET engine to add a strongly-typed reference to the master page through a property named `Master`.</span></span> <span data-ttu-id="64a4b-269">`@MasterType` ディレクティブを使用して、`Site.master` マスターページのパブリックプロパティとメソッドを、キャストなしで `Master` プロパティを使用して直接呼び出すことができます。</span><span class="sxs-lookup"><span data-stu-id="64a4b-269">With the `@MasterType` directive in place, we can call the `Site.master` master page's public properties and methods directly through the `Master` property without any casts.</span></span>

> [!NOTE]
> <span data-ttu-id="64a4b-270">`@MasterType` ディレクティブを省略した場合、構文 `Page.Master` と `Master` は、ページのマスターページに対して厳密に型指定されたオブジェクトと同じものを返します。</span><span class="sxs-lookup"><span data-stu-id="64a4b-270">If you omit the `@MasterType` directive, the syntax `Page.Master` and `Master` return the same thing: a loosely-typed object to the page's master page.</span></span> <span data-ttu-id="64a4b-271">`@MasterType` ディレクティブを含めた場合 `Master` は、指定されたマスターページへの厳密に型指定された参照を返します。</span><span class="sxs-lookup"><span data-stu-id="64a4b-271">If you include the `@MasterType` directive then `Master` returns a strongly-typed reference to the specified master page.</span></span> <span data-ttu-id="64a4b-272">ただし `Page.Master`でも、疎型の参照が返されます。</span><span class="sxs-lookup"><span data-stu-id="64a4b-272">`Page.Master`, however, still returns a loosely-typed reference.</span></span> <span data-ttu-id="64a4b-273">詳細については、`@MasterType` ディレクティブが含まれている場合の `Master` のプロパティの作成方法については、「 [K. Scott Allen](http://odetocode.com/blogs/scott/default.aspx)'s blog entry [`@MasterType` in ASP.NET 2.0」](http://odetocode.com/Blogs/scott/archive/2005/07/16/1944.aspx)を参照してください。</span><span class="sxs-lookup"><span data-stu-id="64a4b-273">For a more thorough look at why this is the case and how the `Master` property is constructed when the `@MasterType` directive is included, see [K. Scott Allen](http://odetocode.com/blogs/scott/default.aspx)'s blog entry [`@MasterType` in ASP.NET 2.0](http://odetocode.com/Blogs/scott/archive/2005/07/16/1944.aspx).</span></span>

### <a name="updating-the-master-page-after-adding-a-new-product"></a><span data-ttu-id="64a4b-274">新しい製品を追加した後にマスターページを更新する</span><span class="sxs-lookup"><span data-stu-id="64a4b-274">Updating the Master Page After Adding a New Product</span></span>

<span data-ttu-id="64a4b-275">これで、コンテンツページからマスターページのパブリックプロパティとメソッドを呼び出す方法がわかったので、新しい製品を追加した後にマスターページが更新されるように、`AddProduct.aspx` ページを更新する準備ができました。</span><span class="sxs-lookup"><span data-stu-id="64a4b-275">Now that we know how to invoke a master page's public properties and methods from a content page, we're ready to update the `AddProduct.aspx` page so that the master page is refreshed after adding a new product.</span></span> <span data-ttu-id="64a4b-276">手順4の開始時に、DetailsView コントロールの `ItemInserting` イベントのイベントハンドラーを作成しました。このイベントは、新しい製品がデータベースに追加された直後に実行されます。</span><span class="sxs-lookup"><span data-stu-id="64a4b-276">At the beginning of Step 4 we created an event handler for the DetailsView control's `ItemInserting` event, which executes immediately after the new product has been added to the database.</span></span> <span data-ttu-id="64a4b-277">そのイベントハンドラーに次のコードを追加します。</span><span class="sxs-lookup"><span data-stu-id="64a4b-277">Add the following code to that event handler:</span></span>

[!code-vb[Main](interacting-with-the-master-page-from-the-content-page-vb/samples/sample10.vb)]

<span data-ttu-id="64a4b-278">上記のコードでは、緩やかに型指定された `Page.Master` プロパティと、厳密に型指定された `Master` プロパティの両方を使用します。</span><span class="sxs-lookup"><span data-stu-id="64a4b-278">The above code uses both the loosely-typed `Page.Master` property and the strongly-typed `Master` property.</span></span> <span data-ttu-id="64a4b-279">`GridMessageText` プロパティが "*ProductName*をグリッドに追加..." に設定されていることに注意してください。追加された製品の値には、`e.Values` コレクションからアクセスできます。ご覧のように、追加された `ProductName` 値は `e.Values("ProductName")`経由でアクセスされます。</span><span class="sxs-lookup"><span data-stu-id="64a4b-279">Note that the `GridMessageText` property is set to "*ProductName* added to grid..." The just-added product's values are accessible through the `e.Values` collection; as you can see, the just-added `ProductName` value is accessed via `e.Values("ProductName")`.</span></span>

<span data-ttu-id="64a4b-280">図8は、新しい製品 (Scott のソーダ) がデータベースに追加された直後の `AddProduct.aspx` ページを示しています。</span><span class="sxs-lookup"><span data-stu-id="64a4b-280">Figure 8 shows the `AddProduct.aspx` page immediately after a new product - Scott's Soda - has been added to the database.</span></span> <span data-ttu-id="64a4b-281">追加された製品名はマスターページのラベルに記載されており、GridView が更新され、製品とその価格が含まれていることに注意してください。</span><span class="sxs-lookup"><span data-stu-id="64a4b-281">Note that the just-added product name is noted in the master page's Label and that the GridView has been refreshed to include the product and its price.</span></span>

<span data-ttu-id="64a4b-282">[マスターページのラベルと GridView に ![、追加した製品が表示されます。](interacting-with-the-master-page-from-the-content-page-vb/_static/image23.png)](interacting-with-the-master-page-from-the-content-page-vb/_static/image22.png)</span><span class="sxs-lookup"><span data-stu-id="64a4b-282">[![The Master Page's Label and GridView Show the Just-Added Product](interacting-with-the-master-page-from-the-content-page-vb/_static/image23.png)](interacting-with-the-master-page-from-the-content-page-vb/_static/image22.png)</span></span>

<span data-ttu-id="64a4b-283">**図 08**: マスターページのラベルと GridView は、追加された製品を表示します ([クリックすると、フルサイズの画像が表示](interacting-with-the-master-page-from-the-content-page-vb/_static/image24.png)されます)</span><span class="sxs-lookup"><span data-stu-id="64a4b-283">**Figure 08**: The Master Page's Label and GridView Show the Just-Added Product ([Click to view full-size image](interacting-with-the-master-page-from-the-content-page-vb/_static/image24.png))</span></span>

## <a name="summary"></a><span data-ttu-id="64a4b-284">要約</span><span class="sxs-lookup"><span data-stu-id="64a4b-284">Summary</span></span>

<span data-ttu-id="64a4b-285">マスターページとそのコンテンツページが相互に完全に分離されていることが理想的であり、操作のレベルは必要ありません。</span><span class="sxs-lookup"><span data-stu-id="64a4b-285">Ideally, a master page and its content pages are completely separate from one another and require no level of interaction.</span></span> <span data-ttu-id="64a4b-286">マスターページとコンテンツページはその目標を念頭に置いて設計する必要がありますが、コンテンツページがマスターページとのインターフェイスを必要とする一般的なシナリオがいくつかあります。</span><span class="sxs-lookup"><span data-stu-id="64a4b-286">While master pages and content pages should be designed with that goal in mind, there are a number of common scenarios in which a content page must interface with its master page.</span></span> <span data-ttu-id="64a4b-287">最も一般的な理由の1つは、コンテンツページで発生する何らかのアクションに基づいて、マスターページの特定の部分を更新することです。</span><span class="sxs-lookup"><span data-stu-id="64a4b-287">One of the most common reasons centers around updating a particular portion of the master page display based on some action that transpired in the content page.</span></span>

<span data-ttu-id="64a4b-288">良いニュースとして、プログラムを使用してコンテンツページをマスターページと対話するのは比較的簡単です。</span><span class="sxs-lookup"><span data-stu-id="64a4b-288">The good news is that it's relatively straightforward to have a content page programmatically interact with its master page.</span></span> <span data-ttu-id="64a4b-289">まず、コンテンツページから呼び出す必要がある機能をカプセル化した、マスターページでパブリックプロパティまたはメソッドを作成します。</span><span class="sxs-lookup"><span data-stu-id="64a4b-289">Start by creating public properties or methods in the master page that encapsulate the functionality that needs to be invoked by a content page.</span></span> <span data-ttu-id="64a4b-290">次に、[コンテンツ] ページで、緩やかに型指定された `Page.Master` プロパティを使用してマスターページのプロパティとメソッドにアクセスするか、`@MasterType` ディレクティブを使用して、マスターページへの厳密に型指定された参照を作成します。</span><span class="sxs-lookup"><span data-stu-id="64a4b-290">Then, in the content page, access the master page's properties and methods through the loosely-typed `Page.Master` property or use the `@MasterType` directive to create a strongly-typed reference to the master page.</span></span>

<span data-ttu-id="64a4b-291">次のチュートリアルでは、マスターページがそのコンテンツページの1つをプログラムで操作する方法を確認します。</span><span class="sxs-lookup"><span data-stu-id="64a4b-291">In the next tutorial we examine how to have the master page programmatically interact with one of its content pages.</span></span>

<span data-ttu-id="64a4b-292">プログラミングを楽しんでください。</span><span class="sxs-lookup"><span data-stu-id="64a4b-292">Happy Programming!</span></span>

### <a name="further-reading"></a><span data-ttu-id="64a4b-293">関連項目</span><span class="sxs-lookup"><span data-stu-id="64a4b-293">Further Reading</span></span>

<span data-ttu-id="64a4b-294">このチュートリアルで説明しているトピックの詳細については、次のリソースを参照してください。</span><span class="sxs-lookup"><span data-stu-id="64a4b-294">For more information on the topics discussed in this tutorial, refer to the following resources:</span></span>

- [<span data-ttu-id="64a4b-295">ASP.NET でのデータへのアクセスと更新</span><span class="sxs-lookup"><span data-stu-id="64a4b-295">Accessing and Updating Data in ASP.NET</span></span>](http://aspnet.4guysfromrolla.com/articles/011106-1.aspx)
- [<span data-ttu-id="64a4b-296">ASP.NET マスターページ: ヒント、テクニック、およびトラップ</span><span class="sxs-lookup"><span data-stu-id="64a4b-296">ASP.NET Master Pages: Tips, Tricks, and Traps</span></span>](http://www.odetocode.com/articles/450.aspx)
- [<span data-ttu-id="64a4b-297">ASP.NET 2.0 の `@MasterType`</span><span class="sxs-lookup"><span data-stu-id="64a4b-297">`@MasterType` in ASP.NET 2.0</span></span>](http://odetocode.com/Blogs/scott/archive/2005/07/16/1944.aspx)
- [<span data-ttu-id="64a4b-298">コンテンツとマスターページの間で情報を渡す</span><span class="sxs-lookup"><span data-stu-id="64a4b-298">Passing Information Between Content and Master Pages</span></span>](http://aspnet.4guysfromrolla.com/articles/013107-1.aspx)
- [<span data-ttu-id="64a4b-299">ASP.NET チュートリアルでのデータの操作</span><span class="sxs-lookup"><span data-stu-id="64a4b-299">Working with Data in ASP.NET Tutorials</span></span>](../../data-access/index.md)

### <a name="about-the-author"></a><span data-ttu-id="64a4b-300">作成者について</span><span class="sxs-lookup"><span data-stu-id="64a4b-300">About the Author</span></span>

<span data-ttu-id="64a4b-301">1998以降、Microsoft の Web テクノロジを使用して、 [Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml)(複数の asp/創設者4GuysFromRolla.com の執筆者) が Microsoft の Web テクノロジを使用しています。</span><span class="sxs-lookup"><span data-stu-id="64a4b-301">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of multiple ASP/ASP.NET books and founder of 4GuysFromRolla.com, has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="64a4b-302">Scott は、独立したコンサルタント、トレーナー、およびライターとして機能します。</span><span class="sxs-lookup"><span data-stu-id="64a4b-302">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="64a4b-303">彼の最新の書籍は[ *、ASP.NET 3.5 を24時間以内に教え*](https://www.amazon.com/exec/obidos/ASIN/0672329972/4guysfromrollaco)ています。</span><span class="sxs-lookup"><span data-stu-id="64a4b-303">His latest book is [*Sams Teach Yourself ASP.NET 3.5 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672329972/4guysfromrollaco).</span></span> <span data-ttu-id="64a4b-304">Scott は、 [mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com)またはブログで[http://ScottOnWriting.NET](http://scottonwriting.net/)にアクセスできます。</span><span class="sxs-lookup"><span data-stu-id="64a4b-304">Scott can be reached at [mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com) or via his blog at [http://ScottOnWriting.NET](http://scottonwriting.net/).</span></span>

### <a name="special-thanks-to"></a><span data-ttu-id="64a4b-305">ありがとうございました。</span><span class="sxs-lookup"><span data-stu-id="64a4b-305">Special Thanks To</span></span>

<span data-ttu-id="64a4b-306">このチュートリアルシリーズは、役に立つ多くのレビュー担当者によってレビューされました。</span><span class="sxs-lookup"><span data-stu-id="64a4b-306">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="64a4b-307">このチュートリアルのリードレビューアーは Zack Jones でした。</span><span class="sxs-lookup"><span data-stu-id="64a4b-307">Lead reviewer for this tutorial was Zack Jones.</span></span> <span data-ttu-id="64a4b-308">今後の MSDN 記事を確認することに興味がありますか?</span><span class="sxs-lookup"><span data-stu-id="64a4b-308">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="64a4b-309">その場合は、 [mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com)の行を削除します。</span><span class="sxs-lookup"><span data-stu-id="64a4b-309">If so, drop me a line at [mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="64a4b-310">[前へ](control-id-naming-in-content-pages-vb.md)
> [次へ](interacting-with-the-content-page-from-the-master-page-vb.md)</span><span class="sxs-lookup"><span data-stu-id="64a4b-310">[Previous](control-id-naming-in-content-pages-vb.md)
[Next](interacting-with-the-content-page-from-the-master-page-vb.md)</span></span>

---
uid: web-forms/overview/older-versions-getting-started/master-pages/specifying-the-master-page-programmatically-vb
title: プログラムによるマスターページの指定 (VB) |Microsoft Docs
author: rick-anderson
description: PreInit イベントハンドラーを使用して、プログラムによってコンテンツページのマスターページを設定する方法について見ていきます。
ms.author: riande
ms.date: 07/28/2008
ms.assetid: 0edcd653-f24a-41aa-aef4-75f868fe5ac2
msc.legacyurl: /web-forms/overview/older-versions-getting-started/master-pages/specifying-the-master-page-programmatically-vb
msc.type: authoredcontent
ms.openlocfilehash: 3b039b22bef38ae6ebf80be070820dc1638f87f4
ms.sourcegitcommit: 22fbd8863672c4ad6693b8388ad5c8e753fb41a2
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 11/28/2019
ms.locfileid: "74618670"
---
# <a name="specifying-the-master-page-programmatically-vb"></a><span data-ttu-id="b362a-103">プログラムでマスター ページを指定する (VB)</span><span class="sxs-lookup"><span data-stu-id="b362a-103">Specifying the Master Page Programmatically (VB)</span></span>

<span data-ttu-id="b362a-104">[Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="b362a-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="b362a-105">[コードのダウンロード](https://download.microsoft.com/download/d/6/6/d66ad554-afdd-409e-a5c3-201b774fbb31/ASPNET_MasterPages_Tutorial_09_VB.zip)または[PDF のダウンロード](https://download.microsoft.com/download/d/6/6/d66ad554-afdd-409e-a5c3-201b774fbb31/ASPNET_MasterPages_Tutorial_09_VB.pdf)</span><span class="sxs-lookup"><span data-stu-id="b362a-105">[Download Code](https://download.microsoft.com/download/d/6/6/d66ad554-afdd-409e-a5c3-201b774fbb31/ASPNET_MasterPages_Tutorial_09_VB.zip) or [Download PDF](https://download.microsoft.com/download/d/6/6/d66ad554-afdd-409e-a5c3-201b774fbb31/ASPNET_MasterPages_Tutorial_09_VB.pdf)</span></span>

> <span data-ttu-id="b362a-106">PreInit イベントハンドラーを使用して、プログラムによってコンテンツページのマスターページを設定する方法について見ていきます。</span><span class="sxs-lookup"><span data-stu-id="b362a-106">Looks at setting the content page's master page programmatically via the PreInit event handler.</span></span>

## <a name="introduction"></a><span data-ttu-id="b362a-107">はじめに</span><span class="sxs-lookup"><span data-stu-id="b362a-107">Introduction</span></span>

<span data-ttu-id="b362a-108">初めの例では、[*マスターページを使用してサイト全体のレイアウトを作成*](creating-a-site-wide-layout-using-master-pages-vb.md)しているため、すべてのコンテンツページは、`@Page` ディレクティブの `MasterPageFile` 属性を使用して、そのマスターページを宣言によって参照しています。</span><span class="sxs-lookup"><span data-stu-id="b362a-108">Since the inaugural example in [*Creating a Site-Wide Layout Using Master Pages*](creating-a-site-wide-layout-using-master-pages-vb.md), all content pages have referenced their master page declaratively via the `MasterPageFile` attribute in the `@Page` directive.</span></span> <span data-ttu-id="b362a-109">たとえば、次の `@Page` ディレクティブは、コンテンツページをマスターページ `Site.master`にリンクします。</span><span class="sxs-lookup"><span data-stu-id="b362a-109">For example, the following `@Page` directive links the content page to the master page `Site.master`:</span></span>

[!code-aspx[Main](specifying-the-master-page-programmatically-vb/samples/sample1.aspx)]

<span data-ttu-id="b362a-110">`System.Web.UI` 名前空間の[`Page` クラス](https://msdn.microsoft.com/library/system.web.ui.page.aspx)には、コンテンツページのマスターページへのパスを返す[`MasterPageFile` プロパティ](https://msdn.microsoft.com/library/system.web.ui.page.masterpagefile.aspx)が含まれています。このプロパティは、`@Page` ディレクティブによって設定されます。</span><span class="sxs-lookup"><span data-stu-id="b362a-110">The [`Page` class](https://msdn.microsoft.com/library/system.web.ui.page.aspx) in the `System.Web.UI` namespace includes a [`MasterPageFile` property](https://msdn.microsoft.com/library/system.web.ui.page.masterpagefile.aspx) that returns the path to the content page's master page; it is this property that is set by the `@Page` directive.</span></span> <span data-ttu-id="b362a-111">このプロパティを使用して、プログラムでコンテンツページのマスターページを指定することもできます。</span><span class="sxs-lookup"><span data-stu-id="b362a-111">This property can also be used to programmatically specify the content page's master page.</span></span> <span data-ttu-id="b362a-112">この方法は、ページにアクセスするユーザーなど、外部の要因に基づいてマスターページを動的に割り当てる場合に便利です。</span><span class="sxs-lookup"><span data-stu-id="b362a-112">This approach is useful if you want to dynamically assign the master page based on external factors, such as the user visiting the page.</span></span>

<span data-ttu-id="b362a-113">このチュートリアルでは、web サイトに2番目のマスターページを追加し、実行時に使用するマスターページを動的に決定します。</span><span class="sxs-lookup"><span data-stu-id="b362a-113">In this tutorial we add a second master page to our website and dynamically decide which master page to use at runtime.</span></span>

## <a name="step-1-a-look-at-the-page-lifecycle"></a><span data-ttu-id="b362a-114">手順 1: ページのライフサイクルを確認する</span><span class="sxs-lookup"><span data-stu-id="b362a-114">Step 1: A Look at the Page Lifecycle</span></span>

<span data-ttu-id="b362a-115">コンテンツページである ASP.NET ページに対して web サーバーに要求が到着するたびに、ASP.NET エンジンはページのコンテンツコントロールを、マスターページに対応する ContentPlaceHolder コントロールにヒューズする必要があります。</span><span class="sxs-lookup"><span data-stu-id="b362a-115">Whenever a request arrives at the web server for an ASP.NET page that is a content page, the ASP.NET engine must fuse the page's Content controls into the master page's corresponding ContentPlaceHolder controls.</span></span> <span data-ttu-id="b362a-116">この fusion は、通常のページのライフサイクルを進めることができる1つのコントロール階層を作成します。</span><span class="sxs-lookup"><span data-stu-id="b362a-116">This fusion creates a single control hierarchy that can then proceed through the typical page lifecycle.</span></span>

<span data-ttu-id="b362a-117">図1は、この fusion を示しています。</span><span class="sxs-lookup"><span data-stu-id="b362a-117">Figure 1 illustrates this fusion.</span></span> <span data-ttu-id="b362a-118">図1の手順1は、初期コンテンツとマスターページコントロールの階層を示しています。</span><span class="sxs-lookup"><span data-stu-id="b362a-118">Step 1 in Figure 1 shows the initial content and master page control hierarchies.</span></span> <span data-ttu-id="b362a-119">PreInit 段階の末尾には、ページ内のコンテンツコントロールがマスターページ内の対応する ContentPlaceHolders (手順 2) に追加されます。</span><span class="sxs-lookup"><span data-stu-id="b362a-119">At the tail end of the PreInit stage the Content controls in the page are added to the corresponding ContentPlaceHolders in the master page (Step 2).</span></span> <span data-ttu-id="b362a-120">この fusion の後、マスターページは、ヒューズ制御階層のルートとして機能します。</span><span class="sxs-lookup"><span data-stu-id="b362a-120">After this fusion, the master page serves as the root of the fused control hierarchy.</span></span> <span data-ttu-id="b362a-121">次に、このような、このようにすることができないコントロールの階層をページに追加して、完了したコントロールの階層を生成します (手順 3)。</span><span class="sxs-lookup"><span data-stu-id="b362a-121">This fused control hierarchy is then added to the page to produce the finalized control hierarchy (Step 3).</span></span> <span data-ttu-id="b362a-122">最終的な結果として、ページのコントロール階層には、ヒューズ制御階層が含まれます。</span><span class="sxs-lookup"><span data-stu-id="b362a-122">The net result is that the page's control hierarchy includes the fused control hierarchy.</span></span>

<span data-ttu-id="b362a-123">[PreInit ステージ中にマスターページとコンテンツページのコントロール階層が結合さ ![](specifying-the-master-page-programmatically-vb/_static/image2.png)](specifying-the-master-page-programmatically-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="b362a-123">[![The Master Page and Content Page's Control Hierarchies are Fused Together during the PreInit Stage](specifying-the-master-page-programmatically-vb/_static/image2.png)](specifying-the-master-page-programmatically-vb/_static/image1.png)</span></span>

<span data-ttu-id="b362a-124">**図 01**: マスターページとコンテンツページのコントロール階層は、PreInit ステージ中にまとめられています ([クリックすると、フルサイズの画像が表示](specifying-the-master-page-programmatically-vb/_static/image3.png)されます)</span><span class="sxs-lookup"><span data-stu-id="b362a-124">**Figure 01**: The Master Page and Content Page's Control Hierarchies are Fused Together during the PreInit Stage ([Click to view full-size image](specifying-the-master-page-programmatically-vb/_static/image3.png))</span></span>

## <a name="step-2-setting-themasterpagefileproperty-from-code"></a><span data-ttu-id="b362a-125">手順 2: コードからの`MasterPageFile`プロパティの設定</span><span class="sxs-lookup"><span data-stu-id="b362a-125">Step 2: Setting the`MasterPageFile`Property from Code</span></span>

<span data-ttu-id="b362a-126">この fusion に含まれるマスターページの内容は、`Page` オブジェクトの `MasterPageFile` プロパティの値によって異なります。</span><span class="sxs-lookup"><span data-stu-id="b362a-126">What master page partakes in this fusion depends on the value of the `Page` object's `MasterPageFile` property.</span></span> <span data-ttu-id="b362a-127">`@Page` ディレクティブで `MasterPageFile` 属性を設定すると、初期化段階で `Page`の `MasterPageFile` プロパティを割り当てることによる実質的な効果が得られます。これは、ページのライフサイクルの最初の段階です。</span><span class="sxs-lookup"><span data-stu-id="b362a-127">Setting the `MasterPageFile` attribute in the `@Page` directive has the net effect of assigning the `Page`'s `MasterPageFile` property during the Initialization stage, which is the very first stage of the page's lifecycle.</span></span> <span data-ttu-id="b362a-128">また、このプロパティをプログラムで設定することもできます。</span><span class="sxs-lookup"><span data-stu-id="b362a-128">We can alternatively set this property programmatically.</span></span> <span data-ttu-id="b362a-129">ただし、このプロパティは、図1の fusion が実行される前に設定する必要があります。</span><span class="sxs-lookup"><span data-stu-id="b362a-129">However, it is imperative that this property be set before the fusion in Figure 1 takes place.</span></span>

<span data-ttu-id="b362a-130">PreInit 段階の開始時に、`Page` オブジェクトは[`PreInit` イベント](https://msdn.microsoft.com/library/system.web.ui.page.preinit.aspx)を発生させ、その[`OnPreInit` メソッド](https://msdn.microsoft.com/library/system.web.ui.page.onpreinit.aspx)を呼び出します。</span><span class="sxs-lookup"><span data-stu-id="b362a-130">At the start of the PreInit stage the `Page` object raises its [`PreInit` event](https://msdn.microsoft.com/library/system.web.ui.page.preinit.aspx) and calls its [`OnPreInit` method](https://msdn.microsoft.com/library/system.web.ui.page.onpreinit.aspx).</span></span> <span data-ttu-id="b362a-131">マスターページをプログラムによって設定するには、`PreInit` イベントのイベントハンドラーを作成するか、`OnPreInit` メソッドをオーバーライドします。</span><span class="sxs-lookup"><span data-stu-id="b362a-131">To set the master page programmatically, then, we can either create an event handler for the `PreInit` event or override the `OnPreInit` method.</span></span> <span data-ttu-id="b362a-132">両方の方法を見てみましょう。</span><span class="sxs-lookup"><span data-stu-id="b362a-132">Let's look at both approaches.</span></span>

<span data-ttu-id="b362a-133">まず、サイトのホームページの分離コードクラスファイル `Default.aspx.vb`を開きます。</span><span class="sxs-lookup"><span data-stu-id="b362a-133">Start by opening `Default.aspx.vb`, the code-behind class file for our site's homepage.</span></span> <span data-ttu-id="b362a-134">次のコードを入力して、ページの `PreInit` イベントのイベントハンドラーを追加します。</span><span class="sxs-lookup"><span data-stu-id="b362a-134">Add an event handler for the page's `PreInit` event by typing in the following code:</span></span>

[!code-vb[Main](specifying-the-master-page-programmatically-vb/samples/sample2.vb)]

<span data-ttu-id="b362a-135">ここでは、`MasterPageFile` プロパティを設定できます。</span><span class="sxs-lookup"><span data-stu-id="b362a-135">From here we can set the `MasterPageFile` property.</span></span> <span data-ttu-id="b362a-136">値 "~/Site. master" が `MasterPageFile` プロパティに割り当てられるように、コードを更新します。</span><span class="sxs-lookup"><span data-stu-id="b362a-136">Update the code so that it assigns the value "~/Site.master" to the `MasterPageFile` property.</span></span>

[!code-vb[Main](specifying-the-master-page-programmatically-vb/samples/sample3.vb)]

<span data-ttu-id="b362a-137">ブレークポイントを設定し、デバッグを開始すると、`Default.aspx` ページがアクセスされるたびに、またはこのページへのポストバックが発生するたびに、`Page_PreInit` イベントハンドラーが実行され、`MasterPageFile` プロパティが "~/Site. マスター" に割り当てられます。</span><span class="sxs-lookup"><span data-stu-id="b362a-137">If you set a breakpoint and start with debugging you'll see that whenever the `Default.aspx` page is visited or whenever there's a postback to this page, the `Page_PreInit` event handler executes and the `MasterPageFile` property is assigned to "~/Site.master".</span></span>

<span data-ttu-id="b362a-138">または、`Page` クラスの `OnPreInit` メソッドをオーバーライドし、そこに `MasterPageFile` プロパティを設定することもできます。</span><span class="sxs-lookup"><span data-stu-id="b362a-138">Alternatively, you can override the `Page` class's `OnPreInit` method and set the `MasterPageFile` property there.</span></span> <span data-ttu-id="b362a-139">この例では、`BasePage`ではなく、特定のページにマスターページを設定しないようにします。</span><span class="sxs-lookup"><span data-stu-id="b362a-139">For this example, let's not set the master page in a particular page, but rather from `BasePage`.</span></span> <span data-ttu-id="b362a-140">[*マスターページのチュートリアルで、タイトル、メタタグ、およびその他の HTML ヘッダーを指定*](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb.md)して、カスタムベースページクラス (`BasePage`) を作成したことを思い出してください。</span><span class="sxs-lookup"><span data-stu-id="b362a-140">Recall that we created a custom base page class (`BasePage`) back in the [*Specifying the Title, Meta Tags, and Other HTML Headers in the Master Page*](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb.md) tutorial.</span></span> <span data-ttu-id="b362a-141">現在 `BasePage` は、`Page` クラスの `OnLoadComplete` メソッドをオーバーライドします。ここでは、サイトマップデータに基づいてページの `Title` プロパティを設定します。</span><span class="sxs-lookup"><span data-stu-id="b362a-141">Currently `BasePage` overrides the `Page` class's `OnLoadComplete` method, where it sets the page's `Title` property based on the site map data.</span></span> <span data-ttu-id="b362a-142">`BasePage` を更新して、`OnPreInit` メソッドをオーバーライドして、プログラムを使用してマスターページを指定するようにします。</span><span class="sxs-lookup"><span data-stu-id="b362a-142">Let's update `BasePage` to also override the `OnPreInit` method to programmatically specify the master page.</span></span>

[!code-vb[Main](specifying-the-master-page-programmatically-vb/samples/sample4.vb)]

<span data-ttu-id="b362a-143">すべてのコンテンツページは `BasePage`から派生するので、すべてのページにプログラムで割り当てられたマスターページがあります。</span><span class="sxs-lookup"><span data-stu-id="b362a-143">Because all our content pages derive from `BasePage`, all of them now have their master page programmatically assigned.</span></span> <span data-ttu-id="b362a-144">この時点で、`Default.aspx.vb` の `PreInit` イベントハンドラーは不要です。削除してもかまいません。</span><span class="sxs-lookup"><span data-stu-id="b362a-144">At this point the `PreInit` event handler in `Default.aspx.vb` is superfluous; feel free to remove it.</span></span>

### <a name="what-about-thepagedirective"></a><span data-ttu-id="b362a-145">`@Page`ディレクティブについて</span><span class="sxs-lookup"><span data-stu-id="b362a-145">What About the`@Page`Directive?</span></span>

<span data-ttu-id="b362a-146">少し紛らわしいかもしれませんが、コンテンツページの `MasterPageFile` のプロパティは、`BasePage` クラスの `OnPreInit` メソッドでプログラムによって、また各コンテンツページの `@Page` ディレクティブの `MasterPageFile` 属性を使用して、2か所で指定されるようになりました。</span><span class="sxs-lookup"><span data-stu-id="b362a-146">What may be a little confusing is that the content pages' `MasterPageFile` properties are now being specified in two places: programmatically in the `BasePage` class's `OnPreInit` method as well as through the `MasterPageFile` attribute in each content page's `@Page` directive.</span></span>

<span data-ttu-id="b362a-147">ページライフサイクルの最初の段階は初期化段階です。</span><span class="sxs-lookup"><span data-stu-id="b362a-147">The first stage in the page lifecycle is the Initialization stage.</span></span> <span data-ttu-id="b362a-148">この段階では、`Page` オブジェクトの `MasterPageFile` プロパティに `@Page` ディレクティブの `MasterPageFile` 属性の値が割り当てられます (指定されている場合)。</span><span class="sxs-lookup"><span data-stu-id="b362a-148">During this stage the `Page` object's `MasterPageFile` property is assigned the value of the `MasterPageFile` attribute in the `@Page` directive (if it is provided).</span></span> <span data-ttu-id="b362a-149">PreInit 段階は初期化段階に従います。ここでは、プログラムによって `Page` オブジェクトの `MasterPageFile` プロパティを設定し、`@Page` ディレクティブから割り当てられた値を上書きします。</span><span class="sxs-lookup"><span data-stu-id="b362a-149">The PreInit stage follows the Initialization stage, and it is here where we programmatically set the `Page` object's `MasterPageFile` property, thereby overwriting the value assigned from the `@Page` directive.</span></span> <span data-ttu-id="b362a-150">`Page` オブジェクトの `MasterPageFile` プロパティはプログラムによって設定されるため、エンドユーザーのエクスペリエンスに影響を与えずに、`@Page` ディレクティブから `MasterPageFile` 属性を削除することができます。</span><span class="sxs-lookup"><span data-stu-id="b362a-150">Because we are setting the `Page` object's `MasterPageFile` property programmatically, we could remove the `MasterPageFile` attribute from the `@Page` directive without affecting the end user's experience.</span></span> <span data-ttu-id="b362a-151">このことを納得するために、`Default.aspx` の `@Page` ディレクティブから `MasterPageFile` 属性を削除し、ブラウザーを使用してページにアクセスします。</span><span class="sxs-lookup"><span data-stu-id="b362a-151">To convince yourself of this, go ahead and remove the `MasterPageFile` attribute from the `@Page` directive in `Default.aspx` and then visit the page through a browser.</span></span> <span data-ttu-id="b362a-152">予想されるように、出力は属性が削除される前と同じです。</span><span class="sxs-lookup"><span data-stu-id="b362a-152">As you would expect, the output is the same as before the attribute was removed.</span></span>

<span data-ttu-id="b362a-153">`MasterPageFile` プロパティが `@Page` ディレクティブを使用して設定されるか、またはプログラムによってエンドユーザーのエクスペリエンスに重要ではないか。</span><span class="sxs-lookup"><span data-stu-id="b362a-153">Whether the `MasterPageFile` property is set via the `@Page` directive or programmatically is inconsequential to the end user's experience.</span></span> <span data-ttu-id="b362a-154">ただし、`@Page` ディレクティブの `MasterPageFile` 属性は、デザイナーで WYSIWYG ビューを生成するために、デザイン時に Visual Studio によって使用されます。</span><span class="sxs-lookup"><span data-stu-id="b362a-154">However, the `MasterPageFile` attribute in the `@Page` directive is used by Visual Studio during design-time to produce the WYSIWYG view in the Designer.</span></span> <span data-ttu-id="b362a-155">Visual Studio で `Default.aspx` に戻り、デザイナーに移動すると、"マスターページエラー: マスターページ参照を必要とするコントロールはありますが、指定されていません" というメッセージが表示されます (図2を参照)。</span><span class="sxs-lookup"><span data-stu-id="b362a-155">If you return to `Default.aspx` in Visual Studio and navigate to the Designer you'll see the message, "Master Page error: The page has controls that require a Master Page reference, but none is specified" (see Figure 2).</span></span>

<span data-ttu-id="b362a-156">つまり、Visual Studio の豊富なデザイン時エクスペリエンスを利用するには、`@Page` ディレクティブに `MasterPageFile` 属性を残しておく必要があります。</span><span class="sxs-lookup"><span data-stu-id="b362a-156">In short, you need to leave the `MasterPageFile` attribute in the `@Page` directive to enjoy a rich design-time experience in Visual Studio.</span></span>

<span data-ttu-id="b362a-157">[![Visual Studio では、@Page ディレクティブの MasterPageFile 属性を使用してデザインビューを表示します。](specifying-the-master-page-programmatically-vb/_static/image5.png)](specifying-the-master-page-programmatically-vb/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="b362a-157">[![Visual Studio Uses the @Page Directive's MasterPageFile Attribute to Render the Design View](specifying-the-master-page-programmatically-vb/_static/image5.png)](specifying-the-master-page-programmatically-vb/_static/image4.png)</span></span>

<span data-ttu-id="b362a-158">**図 02**: Visual Studio では、`@Page` ディレクティブの `MasterPageFile` 属性を使用してデザインビューを表示します ([クリックすると、フルサイズの画像が表示](specifying-the-master-page-programmatically-vb/_static/image6.png)されます)</span><span class="sxs-lookup"><span data-stu-id="b362a-158">**Figure 02**: Visual Studio Uses the `@Page` Directive's `MasterPageFile` Attribute to Render the Design View  ([Click to view full-size image](specifying-the-master-page-programmatically-vb/_static/image6.png))</span></span>

## <a name="step-3-creating-an-alternative-master-page"></a><span data-ttu-id="b362a-159">手順 3: 代替マスターページの作成</span><span class="sxs-lookup"><span data-stu-id="b362a-159">Step 3: Creating an Alternative Master Page</span></span>

<span data-ttu-id="b362a-160">コンテンツページのマスターページは実行時にプログラムによって設定できるため、一部の外部条件に基づいて特定のマスターページを動的に読み込むことができます。</span><span class="sxs-lookup"><span data-stu-id="b362a-160">Because a content page's master page can be set programmatically at runtime it's possible to dynamically load a particular master page based on some external criteria.</span></span> <span data-ttu-id="b362a-161">この機能は、ユーザーに応じてサイトのレイアウトを変更する必要がある場合に役立ちます。</span><span class="sxs-lookup"><span data-stu-id="b362a-161">This functionality can be useful in situations where the site's layout needs to vary based on the user.</span></span> <span data-ttu-id="b362a-162">たとえば、ブログエンジン web アプリケーションでは、ユーザーが自分のブログのレイアウトを選択できるようにすることができます。この場合、各レイアウトは異なるマスターページに関連付けられています。</span><span class="sxs-lookup"><span data-stu-id="b362a-162">For instance, a blog engine web application may allow its users to choose a layout for their blog, where each layout is associated with a different master page.</span></span> <span data-ttu-id="b362a-163">実行時には、ビジターがユーザーのブログを閲覧するときに、web アプリケーションがブログのレイアウトを決定し、対応するマスターページをコンテンツページに動的に関連付ける必要があります。</span><span class="sxs-lookup"><span data-stu-id="b362a-163">At runtime, when a visitor is viewing a user's blog, the web application would need to determine the blog's layout and dynamically associate the corresponding master page with the content page.</span></span>

<span data-ttu-id="b362a-164">いくつかの外部条件に基づいて実行時にマスターページを動的に読み込む方法を説明します。</span><span class="sxs-lookup"><span data-stu-id="b362a-164">Let's examine how to dynamically load a master page at runtime based on some external criteria.</span></span> <span data-ttu-id="b362a-165">Web サイトには現在1つのマスターページ (`Site.master`) しか含まれていません。</span><span class="sxs-lookup"><span data-stu-id="b362a-165">Our website currently contains just one master page (`Site.master`).</span></span> <span data-ttu-id="b362a-166">実行時にマスターページを選択するには、別のマスターページが必要です。</span><span class="sxs-lookup"><span data-stu-id="b362a-166">We need another master page to illustrate choosing a master page at runtime.</span></span> <span data-ttu-id="b362a-167">この手順では、新しいマスターページの作成と構成に焦点を当てます。</span><span class="sxs-lookup"><span data-stu-id="b362a-167">This step focuses on creating and configuring the new master page.</span></span> <span data-ttu-id="b362a-168">手順4では、実行時に使用するマスターページの決定について説明します。</span><span class="sxs-lookup"><span data-stu-id="b362a-168">Step 4 looks at determining what master page to use at runtime.</span></span>

<span data-ttu-id="b362a-169">`Alternate.master`という名前のルートフォルダーに新しいマスターページを作成します。</span><span class="sxs-lookup"><span data-stu-id="b362a-169">Create a new master page in the root folder named `Alternate.master`.</span></span> <span data-ttu-id="b362a-170">また、`AlternateStyles.css`という名前の web サイトに新しいスタイルシートを追加します。</span><span class="sxs-lookup"><span data-stu-id="b362a-170">Also add a new style sheet to the website named `AlternateStyles.css`.</span></span>

<span data-ttu-id="b362a-171">[別のマスターページと CSS ファイルを Web サイトに追加 ![には](specifying-the-master-page-programmatically-vb/_static/image8.png)](specifying-the-master-page-programmatically-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="b362a-171">[![Add Another Master Page and CSS File to the Website](specifying-the-master-page-programmatically-vb/_static/image8.png)](specifying-the-master-page-programmatically-vb/_static/image7.png)</span></span>

<span data-ttu-id="b362a-172">**図 03**: 別のマスターページと CSS ファイルを web サイトに追加[する (クリックすると、フルサイズの画像が表示](specifying-the-master-page-programmatically-vb/_static/image9.png)されます)</span><span class="sxs-lookup"><span data-stu-id="b362a-172">**Figure 03**: Add Another Master Page and CSS File to the Website  ([Click to view full-size image](specifying-the-master-page-programmatically-vb/_static/image9.png))</span></span>

<span data-ttu-id="b362a-173">ここでは、ページの上部にタイトルが表示されるように `Alternate.master` マスターページをデザインしました。これは、中央と海軍の背景にあります。</span><span class="sxs-lookup"><span data-stu-id="b362a-173">I've designed the `Alternate.master` master page to have the title displayed at the top of the page, centered and on a navy background.</span></span> <span data-ttu-id="b362a-174">左側の列をディスペンサーし、その内容を `MainContent` ContentPlaceHolder コントロールの下に移動しました。これにより、ページ全体の幅が広がります。</span><span class="sxs-lookup"><span data-stu-id="b362a-174">I've dispensed of the left column and moved that content beneath the `MainContent` ContentPlaceHolder control, which now spans the entire width of the page.</span></span> <span data-ttu-id="b362a-175">さらに、順序付けられていないレッスンリストを nixed し、`MainContent`上の水平方向のリストに置き換えました。</span><span class="sxs-lookup"><span data-stu-id="b362a-175">Furthermore, I nixed the unordered Lessons list and replaced it with a horizontal list above `MainContent`.</span></span> <span data-ttu-id="b362a-176">また、マスターページで使用されるフォントや色 (拡張機能では、コンテンツページ) も更新しました。</span><span class="sxs-lookup"><span data-stu-id="b362a-176">I also updated the fonts and colors used by the master page (and, by extension, its content pages).</span></span> <span data-ttu-id="b362a-177">図4は、`Alternate.master` マスターページを使用する場合の `Default.aspx` を示しています。</span><span class="sxs-lookup"><span data-stu-id="b362a-177">Figure 4 shows `Default.aspx` when using the `Alternate.master` master page.</span></span>

> [!NOTE]
> <span data-ttu-id="b362a-178">ASP.NET には、*テーマ*を定義する機能が含まれています。</span><span class="sxs-lookup"><span data-stu-id="b362a-178">ASP.NET includes the ability to define *Themes*.</span></span> <span data-ttu-id="b362a-179">テーマとは、実行時にページに適用できる画像、CSS ファイル、スタイル関連の Web コントロールプロパティ設定のコレクションです。</span><span class="sxs-lookup"><span data-stu-id="b362a-179">A Theme is a collection of images, CSS files, and style-related Web control property settings that can be applied to a page at runtime.</span></span> <span data-ttu-id="b362a-180">テーマは、サイトのレイアウトが、表示されるイメージとその CSS ルールでのみ異なる場合に使用できます。</span><span class="sxs-lookup"><span data-stu-id="b362a-180">Themes are the way to go if your site's layouts differ only in the images displayed and by their CSS rules.</span></span> <span data-ttu-id="b362a-181">さまざまな Web コントロールを使用する場合や、大幅に異なるレイアウトを使用する場合など、レイアウトが大きく異なる場合は、別のマスターページを使用する必要があります。</span><span class="sxs-lookup"><span data-stu-id="b362a-181">If the layouts differ more substantially, such as using different Web controls or having a radically different layout, then you will need to use separate master pages.</span></span> <span data-ttu-id="b362a-182">テーマの詳細については、このチュートリアルの最後にある「参考資料」セクションを参照してください。</span><span class="sxs-lookup"><span data-stu-id="b362a-182">Consult the Further Reading section at the end of this tutorial for more information on Themes.</span></span>

<span data-ttu-id="b362a-183">[コンテンツページで新しいルックアンドフィールを使用できるようになり ![](specifying-the-master-page-programmatically-vb/_static/image11.png)](specifying-the-master-page-programmatically-vb/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="b362a-183">[![Our Content Pages Can Now Use a New Look and Feel](specifying-the-master-page-programmatically-vb/_static/image11.png)](specifying-the-master-page-programmatically-vb/_static/image10.png)</span></span>

<span data-ttu-id="b362a-184">**図 04**: コンテンツページで新しいルックアンドフィールを使用できるようになりました ([クリックすると、フルサイズの画像が表示](specifying-the-master-page-programmatically-vb/_static/image12.png)されます)</span><span class="sxs-lookup"><span data-stu-id="b362a-184">**Figure 04**: Our Content Pages Can Now Use a New Look and Feel ([Click to view full-size image](specifying-the-master-page-programmatically-vb/_static/image12.png))</span></span>

<span data-ttu-id="b362a-185">マスターページとコンテンツページのマークアップがヒューズになっている場合、`MasterPage` クラスは、コンテンツページ内のすべてのコンテンツコントロールがマスターページ内の ContentPlaceHolder を参照していることを確認します。</span><span class="sxs-lookup"><span data-stu-id="b362a-185">When the master and content pages' markup are fused, the `MasterPage` class checks to ensure that every Content control in the content page references a ContentPlaceHolder in the master page.</span></span> <span data-ttu-id="b362a-186">存在しない ContentPlaceHolder を参照するコンテンツコントロールが見つかった場合は、例外がスローされます。</span><span class="sxs-lookup"><span data-stu-id="b362a-186">An exception is thrown if a Content control that references a non-existent ContentPlaceHolder is found.</span></span> <span data-ttu-id="b362a-187">つまり、コンテンツページに割り当てられているマスターページには、コンテンツページのコンテンツコントロールごとに ContentPlaceHolder があることが必要です。</span><span class="sxs-lookup"><span data-stu-id="b362a-187">In other words, it is imperative that the master page being assigned to the content page have a ContentPlaceHolder for each Content control in the content page.</span></span>

<span data-ttu-id="b362a-188">`Site.master` マスターページには、4つの ContentPlaceHolder コントロールがあります。</span><span class="sxs-lookup"><span data-stu-id="b362a-188">The `Site.master` master page includes four ContentPlaceHolder controls:</span></span>

- `head`
- `MainContent`
- `QuickLoginUI`
- `LeftColumnContent`

<span data-ttu-id="b362a-189">Web サイトのコンテンツページには、1つまたは2つのコンテンツコントロールのみが含まれています。他のユーザーには、利用可能な ContentPlaceHolders ごとにコンテンツコントロールが含まれています。</span><span class="sxs-lookup"><span data-stu-id="b362a-189">Some of the content pages in our website include just one or two Content controls; others include a Content control for each of the available ContentPlaceHolders.</span></span> <span data-ttu-id="b362a-190">新しいマスターページ (`Alternate.master`) が、`Site.master` 内のすべての ContentPlaceHolders のコンテンツコントロールを持つコンテンツページに割り当てられている可能性がある場合、`Alternate.master` も `Site.master`と同じ ContentPlaceHolder コントロールを含める必要があります。</span><span class="sxs-lookup"><span data-stu-id="b362a-190">If our new master page (`Alternate.master`) may ever be assigned to those content pages that have Content controls for all of the ContentPlaceHolders in `Site.master` then it is essential that `Alternate.master` also include the same ContentPlaceHolder controls as `Site.master`.</span></span>

<span data-ttu-id="b362a-191">`Alternate.master` マスターページを手に見えるようにするには (図4を参照)、まず、`AlternateStyles.css` スタイルシートでマスターページのスタイルを定義します。</span><span class="sxs-lookup"><span data-stu-id="b362a-191">To get your `Alternate.master` master page to look similar to mine (see Figure 4), start by defining the master page's styles in the `AlternateStyles.css` style sheet.</span></span> <span data-ttu-id="b362a-192">`AlternateStyles.css`に次の規則を追加します。</span><span class="sxs-lookup"><span data-stu-id="b362a-192">Add the following rules into `AlternateStyles.css`:</span></span>

[!code-css[Main](specifying-the-master-page-programmatically-vb/samples/sample5.css)]

<span data-ttu-id="b362a-193">次に、次の宣言型マークアップを `Alternate.master`に追加します。</span><span class="sxs-lookup"><span data-stu-id="b362a-193">Next, add the following declarative markup to `Alternate.master`.</span></span> <span data-ttu-id="b362a-194">ご覧のように、`Alternate.master` には、`Site.master`の ContentPlaceHolder コントロールと同じ `ID` 値を持つ4つの ContentPlaceHolder コントロールが含まれています。</span><span class="sxs-lookup"><span data-stu-id="b362a-194">As you can see, `Alternate.master` contains four ContentPlaceHolder controls with the same `ID` values as the ContentPlaceHolder controls in `Site.master`.</span></span> <span data-ttu-id="b362a-195">さらに、ASP.NET AJAX フレームワークを使用する web サイトのページに必要な ScriptManager コントロールも含まれています。</span><span class="sxs-lookup"><span data-stu-id="b362a-195">Moreover, it includes a ScriptManager control, which is necessary for those pages in our website that use the ASP.NET AJAX framework.</span></span>

[!code-aspx[Main](specifying-the-master-page-programmatically-vb/samples/sample6.aspx)]

### <a name="testing-the-new-master-page"></a><span data-ttu-id="b362a-196">新しいマスターページのテスト</span><span class="sxs-lookup"><span data-stu-id="b362a-196">Testing the New Master Page</span></span>

<span data-ttu-id="b362a-197">この新しいマスターページをテストするには、`BasePage` クラスの `OnPreInit` メソッドを更新して、`MasterPageFile` プロパティに `"~/Alternate.maser"` 値が割り当てられるようにしてから、web サイトにアクセスします。</span><span class="sxs-lookup"><span data-stu-id="b362a-197">To test this new master page update the `BasePage` class's `OnPreInit` method so that the `MasterPageFile` property is assigned the value `"~/Alternate.maser"` and then visit the website.</span></span> <span data-ttu-id="b362a-198">すべてのページはエラーなしで機能します。ただし、`~/Admin/AddProduct.aspx` と `~/Admin/Products.aspx`は除きます。</span><span class="sxs-lookup"><span data-stu-id="b362a-198">Every page should function without error except for two: `~/Admin/AddProduct.aspx` and `~/Admin/Products.aspx`.</span></span> <span data-ttu-id="b362a-199">`~/Admin/AddProduct.aspx` の DetailsView に製品を追加すると、マスターページの `GridMessageText` プロパティを設定しようとするコード行から `NullReferenceException` が生成されます。</span><span class="sxs-lookup"><span data-stu-id="b362a-199">Adding a product to the DetailsView in `~/Admin/AddProduct.aspx` results in a `NullReferenceException` from the line of code that attempts to set the master page's `GridMessageText` property.</span></span> <span data-ttu-id="b362a-200">`~/Admin/Products.aspx` にアクセスすると、ページの読み込み時に `InvalidCastException` がスローされます。 "型 ' ASP のオブジェクトをキャストできません。別の\_マスター ' を型 ' ASP. サイト\_マスター ' にキャストしてください。</span><span class="sxs-lookup"><span data-stu-id="b362a-200">When visiting `~/Admin/Products.aspx` an `InvalidCastException` is thrown on page load with the message: "Unable to cast object of type 'ASP.alternate\_master' to type 'ASP.site\_master'."</span></span>

<span data-ttu-id="b362a-201">これらのエラーは、`Site.master` 分離コードクラスに、`Alternate.master`で定義されていないパブリックイベント、プロパティ、およびメソッドが含まれているために発生します。</span><span class="sxs-lookup"><span data-stu-id="b362a-201">These errors occur because the `Site.master` code-behind class includes public events, properties, and methods that are not defined in `Alternate.master`.</span></span> <span data-ttu-id="b362a-202">これら2つのページのマークアップ部分には、`Site.master` マスターページを参照する `@MasterType` ディレクティブがあります。</span><span class="sxs-lookup"><span data-stu-id="b362a-202">The markup portion of these two pages have a `@MasterType` directive that references the `Site.master` master page.</span></span>

[!code-aspx[Main](specifying-the-master-page-programmatically-vb/samples/sample7.aspx)]

<span data-ttu-id="b362a-203">また、`~/Admin/AddProduct.aspx` の DetailsView の `ItemInserted` イベントハンドラーには、弱い型指定の `Page.Master` プロパティを `Site`型のオブジェクトにキャストするコードが含まれています。</span><span class="sxs-lookup"><span data-stu-id="b362a-203">Also, the DetailsView's `ItemInserted` event handler in `~/Admin/AddProduct.aspx` includes code that casts the loosely-typed `Page.Master` property to an object of type `Site`.</span></span> <span data-ttu-id="b362a-204">`@MasterType` ディレクティブ (この方法で使用) と `ItemInserted` イベントハンドラーのキャストによって、`~/Admin/AddProduct.aspx` と `~/Admin/Products.aspx` のページが `Site.master` マスターページに密に結合されます。</span><span class="sxs-lookup"><span data-stu-id="b362a-204">The `@MasterType` directive (used this way) and the cast in the `ItemInserted` event handler tightly couples the `~/Admin/AddProduct.aspx` and `~/Admin/Products.aspx` pages to the `Site.master` master page.</span></span>

<span data-ttu-id="b362a-205">この密結合を解除するには、`Site.master` `Alternate.master` して、パブリックメンバーの定義を含む共通の基本クラスから派生させることができます。</span><span class="sxs-lookup"><span data-stu-id="b362a-205">To break this tight coupling we can have `Site.master` and `Alternate.master` derive from a common base class that contains definitions for the public members.</span></span> <span data-ttu-id="b362a-206">その後、この共通の基本型を参照するように `@MasterType` ディレクティブを更新できます。</span><span class="sxs-lookup"><span data-stu-id="b362a-206">Following that, we can update the `@MasterType` directive to reference this common base type.</span></span>

### <a name="creating-a-custom-base-master-page-class"></a><span data-ttu-id="b362a-207">カスタム基本マスターページクラスの作成</span><span class="sxs-lookup"><span data-stu-id="b362a-207">Creating a Custom Base Master Page Class</span></span>

<span data-ttu-id="b362a-208">`BaseMasterPage.vb` という名前の `App_Code` フォルダーに新しいクラスファイルを追加し、`System.Web.UI.MasterPage`から派生させます。</span><span class="sxs-lookup"><span data-stu-id="b362a-208">Add a new class file to the `App_Code` folder named `BaseMasterPage.vb` and have it derive from `System.Web.UI.MasterPage`.</span></span> <span data-ttu-id="b362a-209">`BaseMasterPage`で `RefreshRecentProductsGrid` メソッドと `GridMessageText` プロパティを定義する必要がありますが、これらのメンバーは `Site.master` マスターページ (`RecentProducts` GridView と `GridMessage` Label) に固有の Web コントロールで動作するため、単に `Site.master` から移動することはできません。</span><span class="sxs-lookup"><span data-stu-id="b362a-209">We need to define the `RefreshRecentProductsGrid` method and the `GridMessageText` property in `BaseMasterPage`, but we can't simply move them there from `Site.master` because these members work with Web controls that are specific to the `Site.master` master page (the `RecentProducts` GridView and `GridMessage` Label).</span></span>

<span data-ttu-id="b362a-210">これらのメンバーが定義されているような方法で `BaseMasterPage` を構成する必要がありますが、実際には `BaseMasterPage`の派生クラス (`Site.master` および `Alternate.master`) によって実装されます。</span><span class="sxs-lookup"><span data-stu-id="b362a-210">What we need to do is configure `BaseMasterPage` in such a way that these members are defined there, but are actually implemented by `BaseMasterPage`'s derived classes (`Site.master` and `Alternate.master`).</span></span> <span data-ttu-id="b362a-211">この種の継承は、クラスを `MustInherit` とそのメンバーを `MustOverride`としてマークすることによって可能です。</span><span class="sxs-lookup"><span data-stu-id="b362a-211">This type of inheritance is possible by marking the class as `MustInherit` and its members as `MustOverride`.</span></span> <span data-ttu-id="b362a-212">つまり、これらのキーワードをクラスとその2つのメンバーに追加する `GridMessageText`と、`BaseMasterPage` が実装されておらず、その派生クラスであることが `RefreshRecentProductsGrid` になります。</span><span class="sxs-lookup"><span data-stu-id="b362a-212">In short, adding these keywords to the class and its two members announces that `BaseMasterPage` hasn't implemented `RefreshRecentProductsGrid` and `GridMessageText`, but that its derived classes will.</span></span>

<span data-ttu-id="b362a-213">また、`BaseMasterPage` で `PricesDoubled` イベントを定義し、派生クラスによってイベントを発生させる手段を提供する必要もあります。</span><span class="sxs-lookup"><span data-stu-id="b362a-213">We also need to define the `PricesDoubled` event in `BaseMasterPage` and provide a means by the derived classes to raise the event.</span></span> <span data-ttu-id="b362a-214">この動作を容易にするために .NET Framework で使用されているパターンは、基本クラスでパブリックイベントを作成し、`OnEventName`という名前の保護されたオーバーライド可能なメソッドを追加することです。</span><span class="sxs-lookup"><span data-stu-id="b362a-214">The pattern used in the .NET Framework to facilitate this behavior is to create a public event in the base class and add a protected, overridable method named `OnEventName`.</span></span> <span data-ttu-id="b362a-215">派生クラスはこのメソッドを呼び出してイベントを発生させるか、またはイベントが発生する直前または直後にコードを実行するようにオーバーライドできます。</span><span class="sxs-lookup"><span data-stu-id="b362a-215">Derived classes can then call this method to raise the event or can override it to execute code immediately before or after the event is raised.</span></span>

<span data-ttu-id="b362a-216">次のコードが含まれるように `BaseMasterPage` クラスを更新します。</span><span class="sxs-lookup"><span data-stu-id="b362a-216">Update your `BaseMasterPage` class so that it contains the following code:</span></span>

[!code-vb[Main](specifying-the-master-page-programmatically-vb/samples/sample8.vb)]

<span data-ttu-id="b362a-217">次に、`Site.master` 分離コードクラスにアクセスし、`BaseMasterPage`から派生させます。</span><span class="sxs-lookup"><span data-stu-id="b362a-217">Next, go to the `Site.master` code-behind class and have it derive from `BaseMasterPage`.</span></span> <span data-ttu-id="b362a-218">`BaseMasterPage` `MustOverride` マークされたメンバーが含まれているため、`Site.master`でこれらのメンバーをオーバーライドする必要があります。</span><span class="sxs-lookup"><span data-stu-id="b362a-218">Because `BaseMasterPage` contains members marked `MustOverride` we need to override those members here in `Site.master`.</span></span> <span data-ttu-id="b362a-219">メソッドとプロパティの定義に `Overrides` キーワードを追加します。</span><span class="sxs-lookup"><span data-stu-id="b362a-219">Add the `Overrides` keyword to the method and property definitions.</span></span> <span data-ttu-id="b362a-220">また、`DoublePrice` ボタンの `Click` イベントハンドラーの `PricesDoubled` イベントを発生させるコードを、基本クラスの `OnPricesDoubled` メソッドの呼び出しで更新します。</span><span class="sxs-lookup"><span data-stu-id="b362a-220">Also update the code that raises the `PricesDoubled` event in the `DoublePrice` Button's `Click` event handler with a call to the base class's `OnPricesDoubled` method.</span></span>

<span data-ttu-id="b362a-221">これらの変更を行った後、`Site.master` 分離コードクラスに次のコードが含まれている必要があります。</span><span class="sxs-lookup"><span data-stu-id="b362a-221">After these modifications the `Site.master` code-behind class should contain the following code:</span></span>

[!code-vb[Main](specifying-the-master-page-programmatically-vb/samples/sample9.vb)]

<span data-ttu-id="b362a-222">また、`BaseMasterPage` から派生し、2つの `MustOverride` メンバーをオーバーライドするように `Alternate.master`の分離コードクラスを更新する必要もあります。</span><span class="sxs-lookup"><span data-stu-id="b362a-222">We also need to update `Alternate.master`'s code-behind class to derive from `BaseMasterPage` and override the two `MustOverride` members.</span></span> <span data-ttu-id="b362a-223">ただし `Alternate.master` には、最新の製品を一覧表示する GridView や、新しい製品をデータベースに追加した後にメッセージを表示するラベルが含まれていないため、これらのメソッドは何もする必要はありません。</span><span class="sxs-lookup"><span data-stu-id="b362a-223">But because `Alternate.master` does not contain a GridView that lists the most recent products nor a Label that displays a message after a new product is added to the database, these methods do not need to do anything.</span></span>

[!code-vb[Main](specifying-the-master-page-programmatically-vb/samples/sample10.vb)]

### <a name="referencing-the-base-master-page-class"></a><span data-ttu-id="b362a-224">基本マスターページクラスの参照</span><span class="sxs-lookup"><span data-stu-id="b362a-224">Referencing the Base Master Page Class</span></span>

<span data-ttu-id="b362a-225">これで `BaseMasterPage` クラスが完成し、2つのマスターページが拡張されました。最後に、この共通の型を参照するように `~/Admin/AddProduct.aspx` と `~/Admin/Products.aspx` のページを更新します。</span><span class="sxs-lookup"><span data-stu-id="b362a-225">Now that we have completed the `BaseMasterPage` class and have our two master pages extending it, our final step is to update the `~/Admin/AddProduct.aspx` and `~/Admin/Products.aspx` pages to refer to this common type.</span></span> <span data-ttu-id="b362a-226">まず、次のいずれかのページで `@MasterType` ディレクティブを変更します。</span><span class="sxs-lookup"><span data-stu-id="b362a-226">Start by changing the `@MasterType` directive in both pages from:</span></span>

[!code-aspx[Main](specifying-the-master-page-programmatically-vb/samples/sample11.aspx)]

<span data-ttu-id="b362a-227">宛先:</span><span class="sxs-lookup"><span data-stu-id="b362a-227">To:</span></span>

[!code-aspx[Main](specifying-the-master-page-programmatically-vb/samples/sample12.aspx)]

<span data-ttu-id="b362a-228">`@MasterType` プロパティは、ファイルパスを参照するのではなく、基本データ型 (`BaseMasterPage`) を参照するようになりました。</span><span class="sxs-lookup"><span data-stu-id="b362a-228">Rather than referencing a file path, the `@MasterType` property now references the base type (`BaseMasterPage`).</span></span> <span data-ttu-id="b362a-229">このため、両方のページの分離コードクラスで使用される厳密に型指定された `Master` プロパティは、型 `Site`ではなく `BaseMasterPage` 型になりました。</span><span class="sxs-lookup"><span data-stu-id="b362a-229">Consequently, the strongly-typed `Master` property used in both pages' code-behind classes is now of type `BaseMasterPage` (instead of type `Site`).</span></span> <span data-ttu-id="b362a-230">この変更を行った後、`~/Admin/Products.aspx`を再実行します。</span><span class="sxs-lookup"><span data-stu-id="b362a-230">With this change in place revisit `~/Admin/Products.aspx`.</span></span> <span data-ttu-id="b362a-231">以前は、ページは `Alternate.master` マスターページを使用するように構成されていますが、`@MasterType` ディレクティブは `Site.master` ファイルを参照しているため、キャストエラーが発生しました。</span><span class="sxs-lookup"><span data-stu-id="b362a-231">Previously, this resulted in a casting error because the page is configured to use the `Alternate.master` master page, but the `@MasterType` directive referenced the `Site.master` file.</span></span> <span data-ttu-id="b362a-232">しかし、ページはエラーなしでレンダリングされるようになりました。</span><span class="sxs-lookup"><span data-stu-id="b362a-232">But now the page renders without error.</span></span> <span data-ttu-id="b362a-233">これは、`Alternate.master` マスターページが `BaseMasterPage` 型のオブジェクト (拡張されているため) にキャストできるためです。</span><span class="sxs-lookup"><span data-stu-id="b362a-233">This is because the `Alternate.master` master page can be cast to an object of type `BaseMasterPage` (since it extends it).</span></span>

<span data-ttu-id="b362a-234">`~/Admin/AddProduct.aspx`で行う必要がある小さな変更が1つあります。</span><span class="sxs-lookup"><span data-stu-id="b362a-234">There's one small change that needs to be made in `~/Admin/AddProduct.aspx`.</span></span> <span data-ttu-id="b362a-235">DetailsView コントロールの `ItemInserted` イベントハンドラーは、厳密に型指定された `Master` プロパティと、緩やかに型指定された `Page.Master` プロパティの両方を使用します。</span><span class="sxs-lookup"><span data-stu-id="b362a-235">The DetailsView control's `ItemInserted` event handler uses both the strongly-typed `Master` property and the loosely-typed `Page.Master` property.</span></span> <span data-ttu-id="b362a-236">`@MasterType` ディレクティブを更新したときに、厳密に型指定された参照を修正しましたが、それでも緩やかに型指定された参照を更新する必要があります。</span><span class="sxs-lookup"><span data-stu-id="b362a-236">We fixed the strongly-typed reference when we updated the `@MasterType` directive, but we still need to update the loosely-typed reference.</span></span> <span data-ttu-id="b362a-237">次のコード行を置き換えます。</span><span class="sxs-lookup"><span data-stu-id="b362a-237">Replace the following line of code:</span></span>

[!code-vb[Main](specifying-the-master-page-programmatically-vb/samples/sample13.vb)]

<span data-ttu-id="b362a-238">次のを使用すると、`Page.Master` が基本型にキャストされます。</span><span class="sxs-lookup"><span data-stu-id="b362a-238">With the following, which casts `Page.Master` to the base type:</span></span>

[!code-vb[Main](specifying-the-master-page-programmatically-vb/samples/sample14.vb)]

## <a name="step-4-determining-what-master-page-to-bind-to-the-content-pages"></a><span data-ttu-id="b362a-239">手順 4: コンテンツページにバインドするマスターページを決定する</span><span class="sxs-lookup"><span data-stu-id="b362a-239">Step 4: Determining What Master Page to Bind to the Content Pages</span></span>

<span data-ttu-id="b362a-240">`BasePage` クラスでは、現在、ページライフサイクルの PreInit ステージで、すべてのコンテンツページの `MasterPageFile` プロパティがハードコーディングされた値に設定されています。</span><span class="sxs-lookup"><span data-stu-id="b362a-240">Our `BasePage` class currently sets all content pages' `MasterPageFile` properties to a hard-coded value in the PreInit stage of the page lifecycle.</span></span> <span data-ttu-id="b362a-241">このコードを更新して、マスターページの基礎を外部要因にすることができます。</span><span class="sxs-lookup"><span data-stu-id="b362a-241">We can update this code to base the master page on some external factor.</span></span> <span data-ttu-id="b362a-242">場合によっては、マスターページは、現在ログオンしているユーザーの設定によって異なります。</span><span class="sxs-lookup"><span data-stu-id="b362a-242">Perhaps the master page to load depends on the preferences of the currently logged on user.</span></span> <span data-ttu-id="b362a-243">その場合は、現在アクセスしているユーザーのマスターページの設定を検索する `BasePage` の `OnPreInit` メソッドにコードを記述する必要があります。</span><span class="sxs-lookup"><span data-stu-id="b362a-243">In that case, we'd need to write code in the `OnPreInit` method in `BasePage` that looks up the currently visiting user's master page preferences.</span></span>

<span data-ttu-id="b362a-244">`Site.master` または `Alternate.master` を使用するマスターページをユーザーが選択し、この選択をセッション変数に保存できる web ページを作成してみましょう。</span><span class="sxs-lookup"><span data-stu-id="b362a-244">Let's create a web page that allows the user to choose which master page to use - `Site.master` or `Alternate.master` - and save this choice in a Session variable.</span></span> <span data-ttu-id="b362a-245">まず、`ChooseMasterPage.aspx`という名前のルートディレクトリに新しい web ページを作成します。</span><span class="sxs-lookup"><span data-stu-id="b362a-245">Start by creating a new web page in the root directory named `ChooseMasterPage.aspx`.</span></span> <span data-ttu-id="b362a-246">このページ (またはその他のコンテンツページその後) を作成する場合は、マスターページが `BasePage`でプログラムによって設定されるので、マスターページにバインドする必要はありません。</span><span class="sxs-lookup"><span data-stu-id="b362a-246">When creating this page (or any other content pages henceforth) you don't need to bind it to a master page because the master page is set programmatically in `BasePage`.</span></span> <span data-ttu-id="b362a-247">ただし、新しいページをマスターページにバインドしない場合、新しいページの既定の宣言マークアップには、マスターページによって提供される Web フォームとその他のコンテンツが含まれます。</span><span class="sxs-lookup"><span data-stu-id="b362a-247">However, if you do not bind the new page to a master page then the new page's default declarative markup contains a Web Form and other content supplied by the master page.</span></span> <span data-ttu-id="b362a-248">このマークアップは、適切なコンテンツコントロールに手動で置き換える必要があります。</span><span class="sxs-lookup"><span data-stu-id="b362a-248">You'll need to manually replace this markup with the appropriate Content controls.</span></span> <span data-ttu-id="b362a-249">そのため、新しい ASP.NET ページをマスターページに簡単にバインドできます。</span><span class="sxs-lookup"><span data-stu-id="b362a-249">For that reason, I find it easier to bind the new ASP.NET page to a master page.</span></span>

> [!NOTE]
> <span data-ttu-id="b362a-250">`Site.master` と `Alternate.master` は同じ ContentPlaceHolder コントロールのセットを持つため、新しいコンテンツページを作成するときにどのマスターページを選択するかは関係ありません。</span><span class="sxs-lookup"><span data-stu-id="b362a-250">Because `Site.master` and `Alternate.master` have the same set of ContentPlaceHolder controls it doesn't matter what master page you choose when creating the new content page.</span></span> <span data-ttu-id="b362a-251">一貫性を確保するために、`Site.master`を使用することをお勧めします。</span><span class="sxs-lookup"><span data-stu-id="b362a-251">For consistency, I'd suggest using `Site.master`.</span></span>

<span data-ttu-id="b362a-252">[新しいコンテンツページを Web サイトに追加 ![には](specifying-the-master-page-programmatically-vb/_static/image14.png)](specifying-the-master-page-programmatically-vb/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="b362a-252">[![Add a New Content Page to the Website](specifying-the-master-page-programmatically-vb/_static/image14.png)](specifying-the-master-page-programmatically-vb/_static/image13.png)</span></span>

<span data-ttu-id="b362a-253">**図 05**: web サイトに新しいコンテンツページを追加する ([クリックすると、フルサイズの画像が表示](specifying-the-master-page-programmatically-vb/_static/image15.png)されます)</span><span class="sxs-lookup"><span data-stu-id="b362a-253">**Figure 05**: Add a New Content Page to the Website ([Click to view full-size image](specifying-the-master-page-programmatically-vb/_static/image15.png))</span></span>

<span data-ttu-id="b362a-254">このレッスンのエントリを含めるように `Web.sitemap` ファイルを更新します。</span><span class="sxs-lookup"><span data-stu-id="b362a-254">Update the `Web.sitemap` file to include an entry for this lesson.</span></span> <span data-ttu-id="b362a-255">マスターページと ASP.NET AJAX レッスンの `<siteMapNode>` の下に次のマークアップを追加します。</span><span class="sxs-lookup"><span data-stu-id="b362a-255">Add the following markup beneath the `<siteMapNode>` for the Master Pages and ASP.NET AJAX lesson:</span></span>

[!code-xml[Main](specifying-the-master-page-programmatically-vb/samples/sample15.xml)]

<span data-ttu-id="b362a-256">コンテンツを `ChooseMasterPage.aspx` ページに追加する前に、ページの分離コードクラスを更新して、`BasePage` (`System.Web.UI.Page`ではなく) から派生するようにします。</span><span class="sxs-lookup"><span data-stu-id="b362a-256">Before adding any content to the `ChooseMasterPage.aspx` page take a moment to update the page's code-behind class so that it derives from `BasePage` (rather than `System.Web.UI.Page`).</span></span> <span data-ttu-id="b362a-257">次に、DropDownList コントロールをページに追加し、その `ID` プロパティを `MasterPageChoice`に設定します。さらに、"~/ListItems" の `Text` 値を持つ2つのを追加します。</span><span class="sxs-lookup"><span data-stu-id="b362a-257">Next, add a DropDownList control to the page, set its `ID` property to `MasterPageChoice`, and add two ListItems with the `Text` values of "~/Site.master" and "~/Alternate.master".</span></span>

<span data-ttu-id="b362a-258">ボタン Web コントロールをページに追加し、その `ID` と `Text` プロパティをそれぞれ `SaveLayout` および "レイアウト選択の保存" をそれぞれ設定します。</span><span class="sxs-lookup"><span data-stu-id="b362a-258">Add a Button Web control to the page and set its `ID` and `Text` properties to `SaveLayout` and "Save Layout Choice", respectively.</span></span> <span data-ttu-id="b362a-259">この時点で、ページの宣言型マークアップは次のようになります。</span><span class="sxs-lookup"><span data-stu-id="b362a-259">At this point your page's declarative markup should look similar to the following:</span></span>

[!code-aspx[Main](specifying-the-master-page-programmatically-vb/samples/sample16.aspx)]

<span data-ttu-id="b362a-260">ページに最初にアクセスしたときに、ユーザーが現在選択しているマスターページを表示する必要があります。</span><span class="sxs-lookup"><span data-stu-id="b362a-260">When the page is first visited we need to display the user's currently selected master page choice.</span></span> <span data-ttu-id="b362a-261">`Page_Load` イベントハンドラーを作成し、次のコードを追加します。</span><span class="sxs-lookup"><span data-stu-id="b362a-261">Create a `Page_Load` event handler and add the following code:</span></span>

[!code-vb[Main](specifying-the-master-page-programmatically-vb/samples/sample17.vb)]

<span data-ttu-id="b362a-262">上記のコードは、最初のページにアクセスしたときにのみ実行されます (以降のポストバックでは実行されません)。</span><span class="sxs-lookup"><span data-stu-id="b362a-262">The above code executes only on the first page visit (and not on subsequent postbacks).</span></span> <span data-ttu-id="b362a-263">まず、セッション変数 `MyMasterPage` 存在するかどうかを確認します。</span><span class="sxs-lookup"><span data-stu-id="b362a-263">It first checks to see if the Session variable `MyMasterPage` exists.</span></span> <span data-ttu-id="b362a-264">含まれている場合は、一致する ListItem を `MasterPageChoice` DropDownList で見つけようと試みます。</span><span class="sxs-lookup"><span data-stu-id="b362a-264">If it does, it attempts to find the matching ListItem in the `MasterPageChoice` DropDownList.</span></span> <span data-ttu-id="b362a-265">一致する ListItem が見つかった場合、その `Selected` プロパティは `True`に設定されます。</span><span class="sxs-lookup"><span data-stu-id="b362a-265">If a matching ListItem is found, its `Selected` property is set to `True`.</span></span>

<span data-ttu-id="b362a-266">また、ユーザーの選択を `MyMasterPage` セッション変数に保存するコードも必要です。</span><span class="sxs-lookup"><span data-stu-id="b362a-266">We also need code that saves the user's choice into the `MyMasterPage` Session variable.</span></span> <span data-ttu-id="b362a-267">`SaveLayout` ボタンの `Click` イベントのイベントハンドラーを作成し、次のコードを追加します。</span><span class="sxs-lookup"><span data-stu-id="b362a-267">Create an event handler for the `SaveLayout` Button's `Click` event and add the following code:</span></span>

[!code-vb[Main](specifying-the-master-page-programmatically-vb/samples/sample18.vb)]

> [!NOTE]
> <span data-ttu-id="b362a-268">ポストバック時に `Click` イベントハンドラーが実行されるまでに、マスターページは既に選択されています。</span><span class="sxs-lookup"><span data-stu-id="b362a-268">By the time the `Click` event handler executes on postback, the master page has already been selected.</span></span> <span data-ttu-id="b362a-269">そのため、ユーザーのドロップダウンリストの選択は、次のページにアクセスするまで有効になりません。</span><span class="sxs-lookup"><span data-stu-id="b362a-269">Therefore, the user's drop-down list selection won't be in effect until the next page visit.</span></span> <span data-ttu-id="b362a-270">`Response.Redirect` は、ブラウザーが `ChooseMasterPage.aspx`を再要求します。</span><span class="sxs-lookup"><span data-stu-id="b362a-270">The `Response.Redirect` forces the browser to re-request `ChooseMasterPage.aspx`.</span></span>

<span data-ttu-id="b362a-271">`ChooseMasterPage.aspx` のページが完成したら、最後のタスクとして、`MyMasterPage` Session 変数の値に基づいて `MasterPageFile` プロパティ `BasePage` 割り当てる必要があります。</span><span class="sxs-lookup"><span data-stu-id="b362a-271">With the `ChooseMasterPage.aspx` page complete, our final task is to have `BasePage` assign the `MasterPageFile` property based on the value of the `MyMasterPage` Session variable.</span></span> <span data-ttu-id="b362a-272">セッション変数が設定されていない場合は `BasePage` 既定で `Site.master`になります。</span><span class="sxs-lookup"><span data-stu-id="b362a-272">If the Session variable is not set have `BasePage` default to `Site.master`.</span></span>

[!code-vb[Main](specifying-the-master-page-programmatically-vb/samples/sample19.vb)]

> [!NOTE]
> <span data-ttu-id="b362a-273">ここでは、`Page` オブジェクトの `MasterPageFile` プロパティを `OnPreInit` イベントハンドラーから、2つの別々のメソッドに割り当てるコードを移動しました。</span><span class="sxs-lookup"><span data-stu-id="b362a-273">I moved the code that assigns the `Page` object's `MasterPageFile` property out of the `OnPreInit` event handler and into two separate methods.</span></span> <span data-ttu-id="b362a-274">この最初のメソッド `SetMasterPageFile`は、`MasterPageFile` プロパティを、`GetMasterPageFileFromSession`2 番目のメソッドによって返される値に割り当てます。</span><span class="sxs-lookup"><span data-stu-id="b362a-274">This first method, `SetMasterPageFile`, assigns the `MasterPageFile` property to the value returned by the second method, `GetMasterPageFileFromSession`.</span></span> <span data-ttu-id="b362a-275">`BasePage` を拡張する今後のクラスが必要に応じて、必要に応じてカスタムロジックを実装できるように、`SetMasterPageFile` メソッドを `Overridable` マークしました。</span><span class="sxs-lookup"><span data-stu-id="b362a-275">I marked the `SetMasterPageFile` method `Overridable` so that future classes that extend `BasePage` can optionally override it to implement custom logic, if needed.</span></span> <span data-ttu-id="b362a-276">`BasePage`の `SetMasterPageFile` プロパティをオーバーライドする例については、次のチュートリアルで説明します。</span><span class="sxs-lookup"><span data-stu-id="b362a-276">We'll see an example of overriding `BasePage`'s `SetMasterPageFile` property in the next tutorial.</span></span>

<span data-ttu-id="b362a-277">このコードを配置したら、`ChooseMasterPage.aspx` のページにアクセスします。</span><span class="sxs-lookup"><span data-stu-id="b362a-277">With this code in place, visit the `ChooseMasterPage.aspx` page.</span></span> <span data-ttu-id="b362a-278">最初に、`Site.master` マスターページが選択されています (図6を参照)。ただし、ユーザーはドロップダウンリストから別のマスターページを選択できます。</span><span class="sxs-lookup"><span data-stu-id="b362a-278">Initially, the `Site.master` master page is selected (see Figure 6), but the user can pick a different master page from the drop-down list.</span></span>

<span data-ttu-id="b362a-279">[![コンテンツページは、サイトのマスターマスターページを使用して表示されます。](specifying-the-master-page-programmatically-vb/_static/image17.png)](specifying-the-master-page-programmatically-vb/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="b362a-279">[![Content Pages are Displayed Using the Site.master Master Page](specifying-the-master-page-programmatically-vb/_static/image17.png)](specifying-the-master-page-programmatically-vb/_static/image16.png)</span></span>

<span data-ttu-id="b362a-280">**図 06**: `Site.master` マスターページを使用してコンテンツページを表示[する (クリックすると、フルサイズの画像が表示](specifying-the-master-page-programmatically-vb/_static/image18.png)されます)</span><span class="sxs-lookup"><span data-stu-id="b362a-280">**Figure 06**: Content Pages are Displayed Using the `Site.master` Master Page ([Click to view full-size image](specifying-the-master-page-programmatically-vb/_static/image18.png))</span></span>

<span data-ttu-id="b362a-281">[代替のマスターページを使用して ![コンテンツページが表示されるようになりました。](specifying-the-master-page-programmatically-vb/_static/image20.png)](specifying-the-master-page-programmatically-vb/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="b362a-281">[![Content Pages are Now Displayed Using the Alternate.master Master Page](specifying-the-master-page-programmatically-vb/_static/image20.png)](specifying-the-master-page-programmatically-vb/_static/image19.png)</span></span>

<span data-ttu-id="b362a-282">**図 07**: `Alternate.master` マスターページを使用してコンテンツページが表示されるようになりました ([クリックしてフルサイズのイメージを表示](specifying-the-master-page-programmatically-vb/_static/image21.png))</span><span class="sxs-lookup"><span data-stu-id="b362a-282">**Figure 07**: Content Pages are Now Displayed Using the `Alternate.master` Master Page ([Click to view full-size image](specifying-the-master-page-programmatically-vb/_static/image21.png))</span></span>

## <a name="summary"></a><span data-ttu-id="b362a-283">要約</span><span class="sxs-lookup"><span data-stu-id="b362a-283">Summary</span></span>

<span data-ttu-id="b362a-284">コンテンツページにアクセスすると、そのコンテンツコントロールは、そのマスターページの ContentPlaceHolder コントロールと共に使用されます。</span><span class="sxs-lookup"><span data-stu-id="b362a-284">When a content page is visited, its Content controls are fused with its master page's ContentPlaceHolder controls.</span></span> <span data-ttu-id="b362a-285">コンテンツページのマスターページは `Page` クラスの `MasterPageFile` プロパティによって示されます。このプロパティは、初期化段階で `@Page` ディレクティブの `MasterPageFile` 属性に割り当てられます。</span><span class="sxs-lookup"><span data-stu-id="b362a-285">The content page's master page is denoted by the `Page` class's `MasterPageFile` property, which is assigned to the `@Page` directive's `MasterPageFile` attribute during the Initialization stage.</span></span> <span data-ttu-id="b362a-286">このチュートリアルで説明したように、PreInit 段階の終了前に `MasterPageFile` 値を割り当てることができます。</span><span class="sxs-lookup"><span data-stu-id="b362a-286">As this tutorial showed, we can assign a value to the `MasterPageFile` property as long as we do so before the end of the PreInit stage.</span></span> <span data-ttu-id="b362a-287">プログラムを使用してマスターページを指定することで、外部要因に基づいてコンテンツページをマスターページに動的にバインドするなど、より高度なシナリオのためにドアを開くことができます。</span><span class="sxs-lookup"><span data-stu-id="b362a-287">Being able to programmatically specify the master page opens the door for more advanced scenarios, such as dynamically binding a content page to a master page based on external factors.</span></span>

<span data-ttu-id="b362a-288">プログラミングを楽しんでください。</span><span class="sxs-lookup"><span data-stu-id="b362a-288">Happy Programming!</span></span>

### <a name="further-reading"></a><span data-ttu-id="b362a-289">関連項目</span><span class="sxs-lookup"><span data-stu-id="b362a-289">Further Reading</span></span>

<span data-ttu-id="b362a-290">このチュートリアルで説明しているトピックの詳細については、次のリソースを参照してください。</span><span class="sxs-lookup"><span data-stu-id="b362a-290">For more information on the topics discussed in this tutorial, refer to the following resources:</span></span>

- [<span data-ttu-id="b362a-291">ASP.NET Page ライフサイクル図</span><span class="sxs-lookup"><span data-stu-id="b362a-291">ASP.NET Page Lifecycle Diagram</span></span>](http://emanish.googlepages.com/Asp.Net2.0Lifecycle.PNG)
- [<span data-ttu-id="b362a-292">ASP.NET ページライフサイクルの概要</span><span class="sxs-lookup"><span data-stu-id="b362a-292">ASP.NET Page Lifecycle Overview</span></span>](https://msdn.microsoft.com/library/ms178472.aspx)
- [<span data-ttu-id="b362a-293">ASP.NET テーマとスキンの概要</span><span class="sxs-lookup"><span data-stu-id="b362a-293">ASP.NET Themes and Skins Overview</span></span>](https://msdn.microsoft.com/library/ykzx33wh.aspx)
- [<span data-ttu-id="b362a-294">マスターページ: ヒント、テクニック、およびトラップ</span><span class="sxs-lookup"><span data-stu-id="b362a-294">Master Pages: Tips, Tricks, and Traps</span></span>](http://www.odetocode.com/articles/450.aspx)
- [<span data-ttu-id="b362a-295">ASP.NET のテーマ</span><span class="sxs-lookup"><span data-stu-id="b362a-295">Themes in ASP.NET</span></span>](http://www.odetocode.com/articles/423.aspx)

### <a name="about-the-author"></a><span data-ttu-id="b362a-296">作成者について</span><span class="sxs-lookup"><span data-stu-id="b362a-296">About the Author</span></span>

<span data-ttu-id="b362a-297">1998以降、Microsoft の Web テクノロジを使用して、 [Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml)(複数の asp/創設者4GuysFromRolla.com の執筆者) が Microsoft の Web テクノロジを使用しています。</span><span class="sxs-lookup"><span data-stu-id="b362a-297">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of multiple ASP/ASP.NET books and founder of 4GuysFromRolla.com, has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="b362a-298">Scott は、独立したコンサルタント、トレーナー、およびライターとして機能します。</span><span class="sxs-lookup"><span data-stu-id="b362a-298">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="b362a-299">彼の最新の書籍は[ *、ASP.NET 3.5 を24時間以内に教え*](https://www.amazon.com/exec/obidos/ASIN/0672329972/4guysfromrollaco)ています。</span><span class="sxs-lookup"><span data-stu-id="b362a-299">His latest book is [*Sams Teach Yourself ASP.NET 3.5 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672329972/4guysfromrollaco).</span></span> <span data-ttu-id="b362a-300">Scott は、 [mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com)またはブログで[http://ScottOnWriting.NET](http://scottonwriting.net/)にアクセスできます。</span><span class="sxs-lookup"><span data-stu-id="b362a-300">Scott can be reached at [mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com) or via his blog at [http://ScottOnWriting.NET](http://scottonwriting.net/).</span></span>

### <a name="special-thanks-to"></a><span data-ttu-id="b362a-301">ありがとうございました。</span><span class="sxs-lookup"><span data-stu-id="b362a-301">Special Thanks To</span></span>

<span data-ttu-id="b362a-302">このチュートリアルシリーズは、役に立つ多くのレビュー担当者によってレビューされました。</span><span class="sxs-lookup"><span data-stu-id="b362a-302">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="b362a-303">このチュートリアルのリードレビューアーは、Suchi になりました。</span><span class="sxs-lookup"><span data-stu-id="b362a-303">Lead reviewer for this tutorial was Suchi Banerjee.</span></span> <span data-ttu-id="b362a-304">今後の MSDN 記事を確認することに興味がありますか?</span><span class="sxs-lookup"><span data-stu-id="b362a-304">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="b362a-305">その場合は、 [mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com)の行を削除します。</span><span class="sxs-lookup"><span data-stu-id="b362a-305">If so, drop me a line at [mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="b362a-306">[前へ](master-pages-and-asp-net-ajax-vb.md)
> [次へ](nested-master-pages-vb.md)</span><span class="sxs-lookup"><span data-stu-id="b362a-306">[Previous](master-pages-and-asp-net-ajax-vb.md)
[Next](nested-master-pages-vb.md)</span></span>

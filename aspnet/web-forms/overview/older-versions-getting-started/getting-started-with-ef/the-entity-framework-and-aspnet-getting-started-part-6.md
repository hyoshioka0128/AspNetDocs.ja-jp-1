---
uid: web-forms/overview/older-versions-getting-started/getting-started-with-ef/the-entity-framework-and-aspnet-getting-started-part-6
title: Entity Framework 4.0 Database First および ASP.NET 4 Web フォームでのはじめに-パート 6 |Microsoft Docs
author: tdykstra
description: Contoso 大学のサンプル web アプリケーションは、Entity Framework を使用して ASP.NET Web フォームアプリケーションを作成する方法を示しています。 サンプルアプリケーションは...
ms.author: riande
ms.date: 12/03/2010
ms.assetid: 994a5496-c648-4830-b03c-55bb43f325d2
msc.legacyurl: /web-forms/overview/older-versions-getting-started/getting-started-with-ef/the-entity-framework-and-aspnet-getting-started-part-6
msc.type: authoredcontent
ms.openlocfilehash: 8bfbe74f90eb03ea9aab7610842ef2578e80d113
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 03/06/2020
ms.locfileid: "78454918"
---
# <a name="getting-started-with-entity-framework-40-database-first-and-aspnet-4-web-forms---part-6"></a><span data-ttu-id="90a6c-104">Entity Framework 4.0 Database First および ASP.NET 4 Web フォームでのはじめに-パート6</span><span class="sxs-lookup"><span data-stu-id="90a6c-104">Getting Started with Entity Framework 4.0 Database First and ASP.NET 4 Web Forms - Part 6</span></span>

<span data-ttu-id="90a6c-105">[Tom Dykstra](https://github.com/tdykstra)</span><span class="sxs-lookup"><span data-stu-id="90a6c-105">by [Tom Dykstra](https://github.com/tdykstra)</span></span>

> <span data-ttu-id="90a6c-106">Contoso 大学のサンプル web アプリケーションは、Entity Framework 4.0 と Visual Studio 2010 を使用して ASP.NET Web フォームアプリケーションを作成する方法を示しています。</span><span class="sxs-lookup"><span data-stu-id="90a6c-106">The Contoso University sample web application demonstrates how to create ASP.NET Web Forms applications using the Entity Framework 4.0 and Visual Studio 2010.</span></span> <span data-ttu-id="90a6c-107">チュートリアルシリーズの詳細については、[シリーズの最初のチュートリアル](the-entity-framework-and-aspnet-getting-started-part-1.md)を参照してください。</span><span class="sxs-lookup"><span data-stu-id="90a6c-107">For information about the tutorial series, see [the first tutorial in the series](the-entity-framework-and-aspnet-getting-started-part-1.md)</span></span>

## <a name="implementing-table-per-hierarchy-inheritance"></a><span data-ttu-id="90a6c-108">Table-Per-Hierarchy 継承の実装</span><span class="sxs-lookup"><span data-stu-id="90a6c-108">Implementing Table-per-Hierarchy Inheritance</span></span>

<span data-ttu-id="90a6c-109">前のチュートリアルでは、リレーションシップを追加および削除し、既存のエンティティとのリレーションシップを持つ新しいエンティティを追加することによって、関連データを操作しました。</span><span class="sxs-lookup"><span data-stu-id="90a6c-109">In the previous tutorial you worked with related data by adding and deleting relationships and by adding a new entity that had a relationship to an existing entity.</span></span> <span data-ttu-id="90a6c-110">このチュートリアルでは、データ モデルで継承を実装する方法を示します。</span><span class="sxs-lookup"><span data-stu-id="90a6c-110">This tutorial will show you how to implement inheritance in the data model.</span></span>

<span data-ttu-id="90a6c-111">オブジェクト指向プログラミングでは、継承を使用して、関連するクラスを簡単に操作できるようになります。</span><span class="sxs-lookup"><span data-stu-id="90a6c-111">In object-oriented programming, you can use inheritance to make it easier to work with related classes.</span></span> <span data-ttu-id="90a6c-112">たとえば、`Person` の基底クラスから派生したクラス `Instructor` と `Student` を作成できます。</span><span class="sxs-lookup"><span data-stu-id="90a6c-112">For example, you could create `Instructor` and `Student` classes that derive from a `Person` base class.</span></span> <span data-ttu-id="90a6c-113">Entity Framework では、エンティティ間に同じ種類の継承構造を作成できます。</span><span class="sxs-lookup"><span data-stu-id="90a6c-113">You can create the same kinds of inheritance structures among entities in the Entity Framework.</span></span>

<span data-ttu-id="90a6c-114">チュートリアルのこの部分では、新しい web ページを作成しません。</span><span class="sxs-lookup"><span data-stu-id="90a6c-114">In this part of the tutorial, you won't create any new web pages.</span></span> <span data-ttu-id="90a6c-115">代わりに、派生エンティティをデータモデルに追加し、既存のページを変更して新しいエンティティを使用します。</span><span class="sxs-lookup"><span data-stu-id="90a6c-115">Instead, you'll add derived entities to the data model and modify existing pages to use the new entities.</span></span>

## <a name="table-per-hierarchy-versus-table-per-type-inheritance"></a><span data-ttu-id="90a6c-116">階層ごとのテーブルと型ごとの継承の比較</span><span class="sxs-lookup"><span data-stu-id="90a6c-116">Table-per-Hierarchy versus Table-per-Type Inheritance</span></span>

<span data-ttu-id="90a6c-117">データベースでは、関連するオブジェクトに関する情報を1つのテーブルまたは複数のテーブルに格納できます。</span><span class="sxs-lookup"><span data-stu-id="90a6c-117">A database can store information about related objects in one table or in multiple tables.</span></span> <span data-ttu-id="90a6c-118">たとえば、`School` データベースの場合、`Person` テーブルには、1つのテーブルに学生とインストラクターの両方に関する情報が含まれています。</span><span class="sxs-lookup"><span data-stu-id="90a6c-118">For example, in the `School` database, the `Person` table includes information about both students and instructors in a single table.</span></span> <span data-ttu-id="90a6c-119">一部の列は、インストラクター (`HireDate`) にのみ適用されます。学生のみに (`EnrollmentDate`)、一部は (`LastName`、`FirstName`) にのみ適用されます。</span><span class="sxs-lookup"><span data-stu-id="90a6c-119">Some of the columns apply only to instructors (`HireDate`), some only to students (`EnrollmentDate`), and some to both (`LastName`, `FirstName`).</span></span>

<span data-ttu-id="90a6c-120">[![image11](the-entity-framework-and-aspnet-getting-started-part-6/_static/image2.png)](the-entity-framework-and-aspnet-getting-started-part-6/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="90a6c-120">[![image11](the-entity-framework-and-aspnet-getting-started-part-6/_static/image2.png)](the-entity-framework-and-aspnet-getting-started-part-6/_static/image1.png)</span></span>

<span data-ttu-id="90a6c-121">Entity Framework を構成して、`Person` エンティティから継承する `Instructor` と `Student` エンティティを作成できます。</span><span class="sxs-lookup"><span data-stu-id="90a6c-121">You can configure the Entity Framework to create `Instructor` and `Student` entities that inherit from the `Person` entity.</span></span> <span data-ttu-id="90a6c-122">1つのデータベーステーブルからエンティティの継承構造を生成するこのパターンは、*階層単位*(TPH) の継承と呼ばれます。</span><span class="sxs-lookup"><span data-stu-id="90a6c-122">This pattern of generating an entity inheritance structure from a single database table is called *table-per-hierarchy* (TPH) inheritance.</span></span>

<span data-ttu-id="90a6c-123">コースの場合、`School` データベースは別のパターンを使用します。</span><span class="sxs-lookup"><span data-stu-id="90a6c-123">For courses, the `School` database uses a different pattern.</span></span> <span data-ttu-id="90a6c-124">オンラインコースとオンサイトコースは別々のテーブルに格納されており、各テーブルには `Course` テーブルを指す外部キーがあります。</span><span class="sxs-lookup"><span data-stu-id="90a6c-124">Online courses and onsite courses are stored in separate tables, each of which has a foreign key that points to the `Course` table.</span></span> <span data-ttu-id="90a6c-125">両方のコースの種類に共通する情報は、`Course` テーブルにのみ格納されます。</span><span class="sxs-lookup"><span data-stu-id="90a6c-125">Information common to both course types is stored only in the `Course` table.</span></span>

<span data-ttu-id="90a6c-126">[![image12](the-entity-framework-and-aspnet-getting-started-part-6/_static/image4.png)](the-entity-framework-and-aspnet-getting-started-part-6/_static/image3.png)</span><span class="sxs-lookup"><span data-stu-id="90a6c-126">[![image12](the-entity-framework-and-aspnet-getting-started-part-6/_static/image4.png)](the-entity-framework-and-aspnet-getting-started-part-6/_static/image3.png)</span></span>

<span data-ttu-id="90a6c-127">`OnlineCourse` エンティティと `OnsiteCourse` エンティティが `Course` エンティティから継承されるように、Entity Framework データモデルを構成できます。</span><span class="sxs-lookup"><span data-stu-id="90a6c-127">You can configure the Entity Framework data model so that `OnlineCourse` and `OnsiteCourse` entities inherit from the `Course` entity.</span></span> <span data-ttu-id="90a6c-128">このパターンでは、各型に対して個別のテーブルからエンティティの継承構造を生成しています。各テーブルは、すべての型に共通のデータを格納するテーブルを参照しています。このパターンは、 *table per type* (TPT) 継承と呼ばれます。</span><span class="sxs-lookup"><span data-stu-id="90a6c-128">This pattern of generating an entity inheritance structure from separate tables for each type, with each separate table referring back to a table that stores data common to all types, is called *table per type* (TPT) inheritance.</span></span>

<span data-ttu-id="90a6c-129">TPH 継承パターンを使用すると、一般に、TPT 継承パターンよりも Entity Framework でパフォーマンスが向上します。 TPT パターンでは、複雑な結合クエリが発生する可能性があるためです。</span><span class="sxs-lookup"><span data-stu-id="90a6c-129">TPH inheritance patterns generally deliver better performance in the Entity Framework than TPT inheritance patterns, because TPT patterns can result in complex join queries.</span></span> <span data-ttu-id="90a6c-130">このチュートリアルでは、TPH 継承を実装する方法について説明します。</span><span class="sxs-lookup"><span data-stu-id="90a6c-130">This walkthrough demonstrates how to implement TPH inheritance.</span></span> <span data-ttu-id="90a6c-131">これを行うには、次の手順を実行します。</span><span class="sxs-lookup"><span data-stu-id="90a6c-131">You'll do that by performing the following steps:</span></span>

- <span data-ttu-id="90a6c-132">`Person`から派生するエンティティ型 `Instructor` および `Student` を作成します。</span><span class="sxs-lookup"><span data-stu-id="90a6c-132">Create `Instructor` and `Student` entity types that derive from `Person`.</span></span>
- <span data-ttu-id="90a6c-133">派生エンティティに関連するプロパティを、`Person` エンティティから派生エンティティに移動します。</span><span class="sxs-lookup"><span data-stu-id="90a6c-133">Move properties that pertain to the derived entities from the `Person` entity to the derived entities.</span></span>
- <span data-ttu-id="90a6c-134">派生型のプロパティに制約を設定します。</span><span class="sxs-lookup"><span data-stu-id="90a6c-134">Set constraints on properties in the derived types.</span></span>
- <span data-ttu-id="90a6c-135">`Person` エンティティを抽象エンティティにします。</span><span class="sxs-lookup"><span data-stu-id="90a6c-135">Make the `Person` entity an abstract entity.</span></span>
- <span data-ttu-id="90a6c-136">`Person` の行がその派生型を表すかどうかを判断する方法を指定する条件を使用して、各派生エンティティを `Person` テーブルにマップします。</span><span class="sxs-lookup"><span data-stu-id="90a6c-136">Map each derived entity to the `Person` table with a condition that specifies how to determine whether a `Person` row represents that derived type.</span></span>

## <a name="adding-instructor-and-student-entities"></a><span data-ttu-id="90a6c-137">講師と学生のエンティティの追加</span><span class="sxs-lookup"><span data-stu-id="90a6c-137">Adding Instructor and Student Entities</span></span>

<span data-ttu-id="90a6c-138"><em>SchoolModel</em>ファイルを開き、デザイナーで未使用の領域を右クリックし、[<strong>追加</strong>]、[<strong>エンティティ</strong>] の順に選択し<em>ます。</em></span><span class="sxs-lookup"><span data-stu-id="90a6c-138">Open the <em>SchoolModel.edmx</em> file, right-click an unoccupied area in the designer, select <strong>Add</strong>, then select <strong>Entity</strong><em>.</em></span></span>

<span data-ttu-id="90a6c-139">[![image01](the-entity-framework-and-aspnet-getting-started-part-6/_static/image6.png)](the-entity-framework-and-aspnet-getting-started-part-6/_static/image5.png)</span><span class="sxs-lookup"><span data-stu-id="90a6c-139">[![image01](the-entity-framework-and-aspnet-getting-started-part-6/_static/image6.png)](the-entity-framework-and-aspnet-getting-started-part-6/_static/image5.png)</span></span>

<span data-ttu-id="90a6c-140">**エンティティの追加** ダイアログボックスで、エンティティに `Instructor` という名前を指定し、**基本データ型** オプションを `Person`に設定します。</span><span class="sxs-lookup"><span data-stu-id="90a6c-140">In the **Add Entity** dialog box, name the entity `Instructor` and set its **Base type** option to `Person`.</span></span>

<span data-ttu-id="90a6c-141">[![image02](the-entity-framework-and-aspnet-getting-started-part-6/_static/image8.png)](the-entity-framework-and-aspnet-getting-started-part-6/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="90a6c-141">[![image02](the-entity-framework-and-aspnet-getting-started-part-6/_static/image8.png)](the-entity-framework-and-aspnet-getting-started-part-6/_static/image7.png)</span></span>

<span data-ttu-id="90a6c-142">**[OK]** をクリックします。</span><span class="sxs-lookup"><span data-stu-id="90a6c-142">Click **OK**.</span></span> <span data-ttu-id="90a6c-143">デザイナーは、`Person` エンティティから派生する `Instructor` エンティティを作成します。</span><span class="sxs-lookup"><span data-stu-id="90a6c-143">The designer creates an `Instructor` entity that derives from the `Person` entity.</span></span> <span data-ttu-id="90a6c-144">新しいエンティティにはプロパティがまだありません。</span><span class="sxs-lookup"><span data-stu-id="90a6c-144">The new entity does not yet have any properties.</span></span>

<span data-ttu-id="90a6c-145">[![image03](the-entity-framework-and-aspnet-getting-started-part-6/_static/image10.png)](the-entity-framework-and-aspnet-getting-started-part-6/_static/image9.png)</span><span class="sxs-lookup"><span data-stu-id="90a6c-145">[![image03](the-entity-framework-and-aspnet-getting-started-part-6/_static/image10.png)](the-entity-framework-and-aspnet-getting-started-part-6/_static/image9.png)</span></span>

<span data-ttu-id="90a6c-146">手順を繰り返して、`Person`からも派生する `Student` エンティティを作成します。</span><span class="sxs-lookup"><span data-stu-id="90a6c-146">Repeat the procedure to create a `Student` entity that also derives from `Person`.</span></span>

<span data-ttu-id="90a6c-147">インストラクターのみが入社日を持っているため、そのプロパティを `Person` エンティティから `Instructor` エンティティに移動する必要があります。</span><span class="sxs-lookup"><span data-stu-id="90a6c-147">Only instructors have hire dates, so you need to move that property from the `Person` entity to the `Instructor` entity.</span></span> <span data-ttu-id="90a6c-148">`Person` エンティティで `HireDate` プロパティを右クリックし、 **[切り取り]** をクリックします。</span><span class="sxs-lookup"><span data-stu-id="90a6c-148">In the `Person` entity, right-click the `HireDate` property and click **Cut**.</span></span> <span data-ttu-id="90a6c-149">次に、`Instructor` エンティティで **[プロパティ]** を右クリックし、 **[貼り付け]** をクリックします。</span><span class="sxs-lookup"><span data-stu-id="90a6c-149">Then right-click **Properties** in the `Instructor` entity and click **Paste**.</span></span>

<span data-ttu-id="90a6c-150">[![image04](the-entity-framework-and-aspnet-getting-started-part-6/_static/image12.png)](the-entity-framework-and-aspnet-getting-started-part-6/_static/image11.png)</span><span class="sxs-lookup"><span data-stu-id="90a6c-150">[![image04](the-entity-framework-and-aspnet-getting-started-part-6/_static/image12.png)](the-entity-framework-and-aspnet-getting-started-part-6/_static/image11.png)</span></span>

<span data-ttu-id="90a6c-151">`Instructor` エンティティの入社日を null にすることはできません。</span><span class="sxs-lookup"><span data-stu-id="90a6c-151">The hire date of an `Instructor` entity cannot be null.</span></span> <span data-ttu-id="90a6c-152">`HireDate` プロパティを右クリックし、 **[プロパティ]** をクリックします。次に、 **[プロパティ]** ウィンドウで `Nullable` を `False`に変更します。</span><span class="sxs-lookup"><span data-stu-id="90a6c-152">Right-click the `HireDate` property, click **Properties**, and then in the **Properties** window change `Nullable` to `False`.</span></span>

<span data-ttu-id="90a6c-153">[![image05](the-entity-framework-and-aspnet-getting-started-part-6/_static/image14.png)](the-entity-framework-and-aspnet-getting-started-part-6/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="90a6c-153">[![image05](the-entity-framework-and-aspnet-getting-started-part-6/_static/image14.png)](the-entity-framework-and-aspnet-getting-started-part-6/_static/image13.png)</span></span>

<span data-ttu-id="90a6c-154">この手順を繰り返して、`Person` エンティティから `Student` エンティティに `EnrollmentDate` プロパティを移動します。</span><span class="sxs-lookup"><span data-stu-id="90a6c-154">Repeat the procedure to move the `EnrollmentDate` property from the `Person` entity to the `Student` entity.</span></span> <span data-ttu-id="90a6c-155">`EnrollmentDate` プロパティの `False` に `Nullable` も設定していることを確認します。</span><span class="sxs-lookup"><span data-stu-id="90a6c-155">Make sure that you also set `Nullable` to `False` for the `EnrollmentDate` property.</span></span>

<span data-ttu-id="90a6c-156">`Person` エンティティには、`Instructor` および `Student` のエンティティに共通するプロパティのみがあるため (移動していないナビゲーションプロパティを除く)、エンティティは継承構造の基本エンティティとしてのみ使用できます。</span><span class="sxs-lookup"><span data-stu-id="90a6c-156">Now that a `Person` entity has only the properties that are common to `Instructor` and `Student` entities (aside from navigation properties, which you're not moving), the entity can only be used as a base entity in the inheritance structure.</span></span> <span data-ttu-id="90a6c-157">そのため、独立したエンティティとして扱われないようにする必要があります。</span><span class="sxs-lookup"><span data-stu-id="90a6c-157">Therefore, you need to ensure that it's never treated as an independent entity.</span></span> <span data-ttu-id="90a6c-158">`Person` エンティティを右クリックし、 **[プロパティ]** をクリックします。次に、 **[プロパティ]** ウィンドウで、 **[Abstract]** プロパティの値を**True**に変更します。</span><span class="sxs-lookup"><span data-stu-id="90a6c-158">Right-click the `Person` entity, select **Properties**, and then in the **Properties** window change the value of the **Abstract** property to **True**.</span></span>

<span data-ttu-id="90a6c-159">[![image06](the-entity-framework-and-aspnet-getting-started-part-6/_static/image16.png)](the-entity-framework-and-aspnet-getting-started-part-6/_static/image15.png)</span><span class="sxs-lookup"><span data-stu-id="90a6c-159">[![image06](the-entity-framework-and-aspnet-getting-started-part-6/_static/image16.png)](the-entity-framework-and-aspnet-getting-started-part-6/_static/image15.png)</span></span>

## <a name="mapping-instructor-and-student-entities-to-the-person-table"></a><span data-ttu-id="90a6c-160">インストラクターと学生のエンティティを Person テーブルにマップする</span><span class="sxs-lookup"><span data-stu-id="90a6c-160">Mapping Instructor and Student Entities to the Person Table</span></span>

<span data-ttu-id="90a6c-161">次に、データベース内の `Instructor` エンティティと `Student` エンティティを区別する方法を Entity Framework に指示する必要があります。</span><span class="sxs-lookup"><span data-stu-id="90a6c-161">Now you need to tell the Entity Framework how to differentiate between `Instructor` and `Student` entities in the database.</span></span>

<span data-ttu-id="90a6c-162">`Instructor` エンティティを右クリックし、 **[テーブルマッピング]** を選択します。</span><span class="sxs-lookup"><span data-stu-id="90a6c-162">Right-click the `Instructor` entity and select **Table Mapping**.</span></span> <span data-ttu-id="90a6c-163">**[マッピングの詳細]** ウィンドウで、 **[テーブルまたはビューの追加]** をクリックし、 **[個人]** を選択します。</span><span class="sxs-lookup"><span data-stu-id="90a6c-163">In the **Mapping Details** window, click **Add a Table or View** and select **Person**.</span></span>

<span data-ttu-id="90a6c-164">[![image07](the-entity-framework-and-aspnet-getting-started-part-6/_static/image18.png)](the-entity-framework-and-aspnet-getting-started-part-6/_static/image17.png)</span><span class="sxs-lookup"><span data-stu-id="90a6c-164">[![image07](the-entity-framework-and-aspnet-getting-started-part-6/_static/image18.png)](the-entity-framework-and-aspnet-getting-started-part-6/_static/image17.png)</span></span>

<span data-ttu-id="90a6c-165">**[条件の追加]** をクリックし、 **[HireDate]** を選択します。</span><span class="sxs-lookup"><span data-stu-id="90a6c-165">Click **Add a Condition**, and then select **HireDate**.</span></span>

<span data-ttu-id="90a6c-166">[![image09](the-entity-framework-and-aspnet-getting-started-part-6/_static/image20.png)](the-entity-framework-and-aspnet-getting-started-part-6/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="90a6c-166">[![image09](the-entity-framework-and-aspnet-getting-started-part-6/_static/image20.png)](the-entity-framework-and-aspnet-getting-started-part-6/_static/image19.png)</span></span>

<span data-ttu-id="90a6c-167">**演算子**を**Is**に、**値/プロパティ**を**not Null**に変更します。</span><span class="sxs-lookup"><span data-stu-id="90a6c-167">Change **Operator** to **Is** and **Value / Property** to **Not Null**.</span></span>

<span data-ttu-id="90a6c-168">[![image10](the-entity-framework-and-aspnet-getting-started-part-6/_static/image22.png)](the-entity-framework-and-aspnet-getting-started-part-6/_static/image21.png)</span><span class="sxs-lookup"><span data-stu-id="90a6c-168">[![image10](the-entity-framework-and-aspnet-getting-started-part-6/_static/image22.png)](the-entity-framework-and-aspnet-getting-started-part-6/_static/image21.png)</span></span>

<span data-ttu-id="90a6c-169">`Students` エンティティに対してこの手順を繰り返し、`EnrollmentDate` 列が null でない場合にこのエンティティが `Person` テーブルにマップされるように指定します。</span><span class="sxs-lookup"><span data-stu-id="90a6c-169">Repeat the procedure for the `Students` entity, specifying that this entity maps to the `Person` table when the `EnrollmentDate` column is not null.</span></span> <span data-ttu-id="90a6c-170">次に、データモデルを保存して閉じます。</span><span class="sxs-lookup"><span data-stu-id="90a6c-170">Then save and close the data model.</span></span>

<span data-ttu-id="90a6c-171">新しいエンティティをクラスとして作成し、デザイナーで使用できるようにするために、プロジェクトをビルドします。</span><span class="sxs-lookup"><span data-stu-id="90a6c-171">Build the project in order to create the new entities as classes and make them available in the designer.</span></span>

## <a name="using-the-instructor-and-student-entities"></a><span data-ttu-id="90a6c-172">講師と学生のエンティティの使用</span><span class="sxs-lookup"><span data-stu-id="90a6c-172">Using the Instructor and Student Entities</span></span>

<span data-ttu-id="90a6c-173">学生およびインストラクターのデータを使用する web ページを作成した場合は、それらを `Person` エンティティセットにデータバインドし、`HireDate` または `EnrollmentDate` プロパティをフィルター処理して、返されるデータを学生またはインストラクターに限定します。</span><span class="sxs-lookup"><span data-stu-id="90a6c-173">When you created the web pages that work with student and instructor data, you databound them to the `Person` entity set, and you filtered on the `HireDate` or `EnrollmentDate` property to restrict the returned data to students or instructors.</span></span> <span data-ttu-id="90a6c-174">ただし現在は、各データソースコントロールを `Person` エンティティセットにバインドするときに、`Student` または `Instructor` のエンティティ型のみを選択するように指定できます。</span><span class="sxs-lookup"><span data-stu-id="90a6c-174">However, now when you bind each data source control to the `Person` entity set, you can specify that only `Student` or `Instructor` entity types should be selected.</span></span> <span data-ttu-id="90a6c-175">Entity Framework は、`Person` エンティティセットで学生とインストラクターを区別する方法を認識しているので、手動で入力した `Where` プロパティ設定を削除することができます。</span><span class="sxs-lookup"><span data-stu-id="90a6c-175">Because the Entity Framework knows how to differentiate students and instructors in the `Person` entity set, you can remove the `Where` property settings you entered manually to do that.</span></span>

<span data-ttu-id="90a6c-176">次の例に示すように、Visual Studio デザイナーでは、`EntityDataSource` コントロールが `Configure Data Source` ウィザードの **[EntityTypeFilter]** ボックスで選択する必要があるエンティティ型を指定できます。</span><span class="sxs-lookup"><span data-stu-id="90a6c-176">In the Visual Studio Designer, you can specify the entity type that an `EntityDataSource` control should select in the **EntityTypeFilter** drop-down box of the `Configure Data Source` wizard, as shown in the following example.</span></span>

<span data-ttu-id="90a6c-177">[![image13](the-entity-framework-and-aspnet-getting-started-part-6/_static/image24.png)](the-entity-framework-and-aspnet-getting-started-part-6/_static/image23.png)</span><span class="sxs-lookup"><span data-stu-id="90a6c-177">[![image13](the-entity-framework-and-aspnet-getting-started-part-6/_static/image24.png)](the-entity-framework-and-aspnet-getting-started-part-6/_static/image23.png)</span></span>

<span data-ttu-id="90a6c-178">また、 **[プロパティ]** ウィンドウでは、次の例に示すように、不要になった `Where` 句の値を削除できます。</span><span class="sxs-lookup"><span data-stu-id="90a6c-178">And in the **Properties** window you can remove `Where` clause values that are no longer needed, as shown in the following example.</span></span>

<span data-ttu-id="90a6c-179">[![image14](the-entity-framework-and-aspnet-getting-started-part-6/_static/image26.png)](the-entity-framework-and-aspnet-getting-started-part-6/_static/image25.png)</span><span class="sxs-lookup"><span data-stu-id="90a6c-179">[![image14](the-entity-framework-and-aspnet-getting-started-part-6/_static/image26.png)](the-entity-framework-and-aspnet-getting-started-part-6/_static/image25.png)</span></span>

<span data-ttu-id="90a6c-180">ただし、`ContextTypeName` 属性を使用するように `EntityDataSource` コントロールのマークアップを変更したため、既に作成したコントロールに `EntityDataSource` 対して**データソースの構成**ウィザードを実行することはできません。</span><span class="sxs-lookup"><span data-stu-id="90a6c-180">However, because you've changed the markup for `EntityDataSource` controls to use the `ContextTypeName` attribute, you cannot run the **Configure Data Source** wizard on `EntityDataSource` controls that you've already created.</span></span> <span data-ttu-id="90a6c-181">そのため、代わりにマークアップを変更することによって、必要な変更を行います。</span><span class="sxs-lookup"><span data-stu-id="90a6c-181">Therefore, you'll make the required changes by changing markup instead.</span></span>

<span data-ttu-id="90a6c-182">*Student .aspx*ページを開きます。</span><span class="sxs-lookup"><span data-stu-id="90a6c-182">Open the *Students.aspx* page.</span></span> <span data-ttu-id="90a6c-183">`StudentsEntityDataSource` コントロールで、`Where` 属性を削除し、`EntityTypeFilter="Student"` 属性を追加します。</span><span class="sxs-lookup"><span data-stu-id="90a6c-183">In the `StudentsEntityDataSource` control, remove the `Where` attribute and add an `EntityTypeFilter="Student"` attribute.</span></span> <span data-ttu-id="90a6c-184">マークアップは、次の例のようになります。</span><span class="sxs-lookup"><span data-stu-id="90a6c-184">The markup will now resemble the following example:</span></span>

[!code-aspx[Main](the-entity-framework-and-aspnet-getting-started-part-6/samples/sample1.aspx)]

<span data-ttu-id="90a6c-185">`EntityTypeFilter` 属性を設定すると、`EntityDataSource` コントロールが指定されたエンティティ型のみを選択するようになります。</span><span class="sxs-lookup"><span data-stu-id="90a6c-185">Setting the `EntityTypeFilter` attribute ensures that the `EntityDataSource` control will select only the specified entity type.</span></span> <span data-ttu-id="90a6c-186">`Student` と `Instructor` の両方のエンティティ型を取得する場合は、この属性を設定しません。</span><span class="sxs-lookup"><span data-stu-id="90a6c-186">If you wanted to retrieve both `Student` and `Instructor` entity types, you would not set this attribute.</span></span> <span data-ttu-id="90a6c-187">(読み取り専用データアクセスに対してコントロールを使用している場合にのみ、1つの `EntityDataSource` コントロールを持つ複数のエンティティ型を取得することもできます。</span><span class="sxs-lookup"><span data-stu-id="90a6c-187">(You have the option of retrieving multiple entity types with one `EntityDataSource` control only if you're using the control for read-only data access.</span></span> <span data-ttu-id="90a6c-188">エンティティを挿入、更新、または削除するために `EntityDataSource` コントロールを使用していて、バインドされているエンティティセットに複数の型を含めることができる場合は、1つのエンティティ型のみを使用でき、この属性を設定する必要があります。</span><span class="sxs-lookup"><span data-stu-id="90a6c-188">If you're using an `EntityDataSource` control to insert, update, or delete entities, and if the entity set it's bound to can contain multiple types, you can only work with one entity type, and you have to set this attribute.)</span></span>

<span data-ttu-id="90a6c-189">`SearchEntityDataSource` コントロールに対してこの手順を繰り返します。ただし、プロパティを完全に削除するのではなく `Student` エンティティを選択する `Where` 属性の部分のみを削除します。</span><span class="sxs-lookup"><span data-stu-id="90a6c-189">Repeat the procedure for the `SearchEntityDataSource` control, except remove only the part of the `Where` attribute that selects `Student` entities instead of removing the property altogether.</span></span> <span data-ttu-id="90a6c-190">コントロールの開始タグは、次の例のようになります。</span><span class="sxs-lookup"><span data-stu-id="90a6c-190">The opening tag of the control will now resemble the following example:</span></span>

[!code-aspx[Main](the-entity-framework-and-aspnet-getting-started-part-6/samples/sample2.aspx)]

<span data-ttu-id="90a6c-191">ページを実行して、以前と同じように動作することを確認します。</span><span class="sxs-lookup"><span data-stu-id="90a6c-191">Run the page to verify that it still works as it did before.</span></span>

<span data-ttu-id="90a6c-192">[![image15](the-entity-framework-and-aspnet-getting-started-part-6/_static/image28.png)](the-entity-framework-and-aspnet-getting-started-part-6/_static/image27.png)</span><span class="sxs-lookup"><span data-stu-id="90a6c-192">[![image15](the-entity-framework-and-aspnet-getting-started-part-6/_static/image28.png)](the-entity-framework-and-aspnet-getting-started-part-6/_static/image27.png)</span></span>

<span data-ttu-id="90a6c-193">前のチュートリアルで作成した次のページを更新して、`Person` エンティティではなく新しい `Student` と `Instructor` エンティティを使用し、それを実行して前と同じように動作することを確認します。</span><span class="sxs-lookup"><span data-stu-id="90a6c-193">Update the following pages that you created in earlier tutorials so that they use the new `Student` and `Instructor` entities instead of `Person` entities, then run them to verify that they work as they did before:</span></span>

- <span data-ttu-id="90a6c-194">*StudentsAdd*で、`StudentsEntityDataSource` コントロールに `EntityTypeFilter="Student"` を追加します。</span><span class="sxs-lookup"><span data-stu-id="90a6c-194">In *StudentsAdd.aspx*, add `EntityTypeFilter="Student"` to the `StudentsEntityDataSource` control.</span></span> <span data-ttu-id="90a6c-195">マークアップは、次の例のようになります。</span><span class="sxs-lookup"><span data-stu-id="90a6c-195">The markup will now resemble the following example:</span></span> 

    [!code-aspx[Main](the-entity-framework-and-aspnet-getting-started-part-6/samples/sample3.aspx)]

    <span data-ttu-id="90a6c-196">[![image16](the-entity-framework-and-aspnet-getting-started-part-6/_static/image30.png)](the-entity-framework-and-aspnet-getting-started-part-6/_static/image29.png)</span><span class="sxs-lookup"><span data-stu-id="90a6c-196">[![image16](the-entity-framework-and-aspnet-getting-started-part-6/_static/image30.png)](the-entity-framework-and-aspnet-getting-started-part-6/_static/image29.png)</span></span>
- <span data-ttu-id="90a6c-197">*About .aspx*で、`StudentStatisticsEntityDataSource` コントロールに `EntityTypeFilter="Student"` を追加し、`Where="it.EnrollmentDate is not null"`を削除します。</span><span class="sxs-lookup"><span data-stu-id="90a6c-197">In *About.aspx*, add `EntityTypeFilter="Student"` to the `StudentStatisticsEntityDataSource` control and remove `Where="it.EnrollmentDate is not null"`.</span></span> <span data-ttu-id="90a6c-198">マークアップは、次の例のようになります。</span><span class="sxs-lookup"><span data-stu-id="90a6c-198">The markup will now resemble the following example:</span></span> 

    [!code-aspx[Main](the-entity-framework-and-aspnet-getting-started-part-6/samples/sample4.aspx)]

    <span data-ttu-id="90a6c-199">[![image17](the-entity-framework-and-aspnet-getting-started-part-6/_static/image32.png)](the-entity-framework-and-aspnet-getting-started-part-6/_static/image31.png)</span><span class="sxs-lookup"><span data-stu-id="90a6c-199">[![image17](the-entity-framework-and-aspnet-getting-started-part-6/_static/image32.png)](the-entity-framework-and-aspnet-getting-started-part-6/_static/image31.png)</span></span>
- <span data-ttu-id="90a6c-200">*講師*と*InstructorsCourses*で、`InstructorsEntityDataSource` コントロールに `EntityTypeFilter="Instructor"` を追加し、`Where="it.HireDate is not null"`を削除します。</span><span class="sxs-lookup"><span data-stu-id="90a6c-200">In *Instructors.aspx* and *InstructorsCourses.aspx*, add `EntityTypeFilter="Instructor"` to the `InstructorsEntityDataSource` control and remove `Where="it.HireDate is not null"`.</span></span> <span data-ttu-id="90a6c-201">これで、*講師*のマークアップは次の例のようになります。</span><span class="sxs-lookup"><span data-stu-id="90a6c-201">The markup in *Instructors.aspx* now resembles the following example:</span></span> 

    [!code-aspx[Main](the-entity-framework-and-aspnet-getting-started-part-6/samples/sample5.aspx)]

    <span data-ttu-id="90a6c-202">[![image18](the-entity-framework-and-aspnet-getting-started-part-6/_static/image34.png)](the-entity-framework-and-aspnet-getting-started-part-6/_static/image33.png)</span><span class="sxs-lookup"><span data-stu-id="90a6c-202">[![image18](the-entity-framework-and-aspnet-getting-started-part-6/_static/image34.png)](the-entity-framework-and-aspnet-getting-started-part-6/_static/image33.png)</span></span>

    <span data-ttu-id="90a6c-203">*InstructorsCourses*のマークアップは、次の例のようになります。</span><span class="sxs-lookup"><span data-stu-id="90a6c-203">The markup in *InstructorsCourses.aspx* will now resemble the following example:</span></span>

    [!code-aspx[Main](the-entity-framework-and-aspnet-getting-started-part-6/samples/sample6.aspx)]

    <span data-ttu-id="90a6c-204">[![image19](the-entity-framework-and-aspnet-getting-started-part-6/_static/image36.png)](the-entity-framework-and-aspnet-getting-started-part-6/_static/image35.png)</span><span class="sxs-lookup"><span data-stu-id="90a6c-204">[![image19](the-entity-framework-and-aspnet-getting-started-part-6/_static/image36.png)](the-entity-framework-and-aspnet-getting-started-part-6/_static/image35.png)</span></span>

<span data-ttu-id="90a6c-205">これらの変更の結果として、Contoso 大学アプリケーションの保守容易性がいくつかの点で改善されました。</span><span class="sxs-lookup"><span data-stu-id="90a6c-205">As a result of these changes, you've improved the Contoso University application's maintainability in several ways.</span></span> <span data-ttu-id="90a6c-206">選択と検証のロジックを UI レイヤー ( *.aspx*マークアップ) から移動し、データアクセス層の重要な部分にしました。</span><span class="sxs-lookup"><span data-stu-id="90a6c-206">You've moved selection and validation logic out of the UI layer (*.aspx* markup) and made it an integral part of the data access layer.</span></span> <span data-ttu-id="90a6c-207">これにより、将来的にデータベーススキーマまたはデータモデルに加えられた変更からアプリケーションコードを分離することができます。</span><span class="sxs-lookup"><span data-stu-id="90a6c-207">This helps to isolate your application code from changes that you might make in the future to the database schema or the data model.</span></span> <span data-ttu-id="90a6c-208">たとえば、学生が教師の補助として採用されている可能性があるため、採用日を取得するとします。</span><span class="sxs-lookup"><span data-stu-id="90a6c-208">For example, you could decide that students might be hired as teachers' aids and therefore would get a hire date.</span></span> <span data-ttu-id="90a6c-209">次に、新しいプロパティを追加して、講師と生徒を区別し、データモデルを更新できます。</span><span class="sxs-lookup"><span data-stu-id="90a6c-209">You could then add a new property to differentiate students from instructors and update the data model.</span></span> <span data-ttu-id="90a6c-210">学生の入社日を表示する場合を除き、web アプリケーションのコードを変更する必要はありません。</span><span class="sxs-lookup"><span data-stu-id="90a6c-210">No code in the web application would need to change except where you wanted to show a hire date for students.</span></span> <span data-ttu-id="90a6c-211">`Instructor` エンティティと `Student` エンティティを追加するもう1つの利点は、実際に生徒やインストラクターの `Person` オブジェクトを参照するよりも、コードがより簡単に理解できることです。</span><span class="sxs-lookup"><span data-stu-id="90a6c-211">Another benefit of adding `Instructor` and `Student` entities is that your code is more readily understandable than when it referred to `Person` objects that were actually students or instructors.</span></span>

<span data-ttu-id="90a6c-212">これで、Entity Framework に継承パターンを実装する1つの方法が見られました。</span><span class="sxs-lookup"><span data-stu-id="90a6c-212">You've now seen one way to implement an inheritance pattern in the Entity Framework.</span></span> <span data-ttu-id="90a6c-213">次のチュートリアルでは、Entity Framework がデータベースにアクセスする方法をより細かく制御するために、ストアドプロシージャを使用する方法について説明します。</span><span class="sxs-lookup"><span data-stu-id="90a6c-213">In the following tutorial, you'll learn how to use stored procedures in order to have more control over how the Entity Framework accesses the database.</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="90a6c-214">[前へ](the-entity-framework-and-aspnet-getting-started-part-5.md)
> [次へ](the-entity-framework-and-aspnet-getting-started-part-7.md)</span><span class="sxs-lookup"><span data-stu-id="90a6c-214">[Previous](the-entity-framework-and-aspnet-getting-started-part-5.md)
[Next](the-entity-framework-and-aspnet-getting-started-part-7.md)</span></span>

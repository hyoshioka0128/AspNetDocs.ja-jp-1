---
uid: web-forms/overview/data-access/filtering-scenarios-with-the-datalist-and-repeater/master-detail-filtering-with-a-dropdownlist-datalist-vb
title: DropDownList を使用したマスター/詳細フィルター処理 (VB) |Microsoft Docs
author: rick-anderson
description: このチュートリアルでは、DropDownLists を使用して ' master ' レコードを表示する1つの web ページでマスター/詳細レポートを表示する方法について説明します。
ms.author: riande
ms.date: 07/18/2007
ms.assetid: ad0f1014-1eff-465f-bdc6-93058de00e44
msc.legacyurl: /web-forms/overview/data-access/filtering-scenarios-with-the-datalist-and-repeater/master-detail-filtering-with-a-dropdownlist-datalist-vb
msc.type: authoredcontent
ms.openlocfilehash: 537f8e76bc0cbfa759a014b63ae5f68b5d3ca64d
ms.sourcegitcommit: 22fbd8863672c4ad6693b8388ad5c8e753fb41a2
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 11/28/2019
ms.locfileid: "74629813"
---
# <a name="masterdetail-filtering-with-a-dropdownlist-vb"></a><span data-ttu-id="d867d-103">DropDownList でマスター/詳細をフィルター処理する (VB)</span><span class="sxs-lookup"><span data-stu-id="d867d-103">Master/Detail Filtering With a DropDownList (VB)</span></span>

<span data-ttu-id="d867d-104">[Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="d867d-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="d867d-105">[サンプルアプリのダウンロード](https://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_33_VB.exe)または[PDF のダウンロード](master-detail-filtering-with-a-dropdownlist-datalist-vb/_static/datatutorial33vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="d867d-105">[Download Sample App](https://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_33_VB.exe) or [Download PDF](master-detail-filtering-with-a-dropdownlist-datalist-vb/_static/datatutorial33vb1.pdf)</span></span>

> <span data-ttu-id="d867d-106">このチュートリアルでは、DropDownLists を使用して "マスター" レコードを表示する1つの web ページでマスター/詳細レポートを表示する方法と、"詳細" を表示するための DataList を説明します。</span><span class="sxs-lookup"><span data-stu-id="d867d-106">In this tutorial we see how to display master/detail reports in a single web page using DropDownLists to display the "master" records and a DataList to display the "details".</span></span>

## <a name="introduction"></a><span data-ttu-id="d867d-107">はじめに</span><span class="sxs-lookup"><span data-stu-id="d867d-107">Introduction</span></span>

<span data-ttu-id="d867d-108">最初に DropDownList チュートリアルを使用して以前の[マスター/詳細フィルター](../masterdetail/master-detail-filtering-with-a-dropdownlist-vb.md)の GridView を使用して作成したマスター/詳細レポートは、"マスター" レコードのセットを表示することから始まります。</span><span class="sxs-lookup"><span data-stu-id="d867d-108">The master/detail report, which we first created using a GridView in the earlier [Master/Detail Filtering With a DropDownList](../masterdetail/master-detail-filtering-with-a-dropdownlist-vb.md) tutorial, begins by showing some set of "master" records.</span></span> <span data-ttu-id="d867d-109">その後、ユーザーはマスターレコードのいずれかにドリルダウンして、マスターレコードの "詳細" を表示できます。</span><span class="sxs-lookup"><span data-stu-id="d867d-109">The user can then drill down into one of the master records, thereby viewing that master record's "details."</span></span> <span data-ttu-id="d867d-110">マスター/詳細レポートは、一対多のリレーションシップを視覚化するための最適な選択肢であり、特に多数の列を含むテーブルから詳細情報を表示するために適しています。</span><span class="sxs-lookup"><span data-stu-id="d867d-110">Master/detail reports are an ideal choice for visualizing one-to-many relationships and for displaying detailed information from particularly "wide" tables (ones that have a lot of columns).</span></span> <span data-ttu-id="d867d-111">前のチュートリアルでは、GridView および DetailsView コントロールを使用してマスター/詳細レポートを実装する方法を説明しました。</span><span class="sxs-lookup"><span data-stu-id="d867d-111">We've explored how to implement master/detail reports using the GridView and DetailsView controls in previous tutorials.</span></span> <span data-ttu-id="d867d-112">このチュートリアルと次の2つのチュートリアルでは、これらの概念を再検討しますが、代わりに DataList コントロールと Repeater コントロールの使用に焦点を当てます。</span><span class="sxs-lookup"><span data-stu-id="d867d-112">In this tutorial and the next two, we'll reexamine these concepts, but focus on using DataList and Repeater controls instead.</span></span>

<span data-ttu-id="d867d-113">このチュートリアルでは、DropDownList を使用して "マスター" レコードを格納し、DataList に "details" レコードを表示する方法について説明します。</span><span class="sxs-lookup"><span data-stu-id="d867d-113">In this tutorial, we'll look at using a DropDownList to contain the "master" records, with the "details" records displayed in a DataList.</span></span>

## <a name="step-1-adding-the-masterdetail-tutorial-web-pages"></a><span data-ttu-id="d867d-114">手順 1: マスター/詳細チュートリアル Web ページの追加</span><span class="sxs-lookup"><span data-stu-id="d867d-114">Step 1: Adding the Master/Detail Tutorial Web Pages</span></span>

<span data-ttu-id="d867d-115">このチュートリアルを開始する前に、まず、このチュートリアルに必要なフォルダーと ASP.NET のページを追加し、次の2つのページで、DataList および Repeater コントロールを使用してマスター/詳細レポートを処理してみましょう。</span><span class="sxs-lookup"><span data-stu-id="d867d-115">Before we start this tutorial, let's first take a moment to add the folder and ASP.NET pages we'll need for this tutorial and the next two dealing with master/detail reports using the DataList and Repeater controls.</span></span> <span data-ttu-id="d867d-116">まず、`DataListRepeaterFiltering`という名前のプロジェクトに新しいフォルダーを作成します。</span><span class="sxs-lookup"><span data-stu-id="d867d-116">Start by creating a new folder in the project named `DataListRepeaterFiltering`.</span></span> <span data-ttu-id="d867d-117">次に、次の5つの ASP.NET ページをこのフォルダーに追加します。マスターページ `Site.master`を使用するようにすべてのページを構成します。</span><span class="sxs-lookup"><span data-stu-id="d867d-117">Next, add the following five ASP.NET pages to this folder, having all of them configured to use the master page `Site.master`:</span></span>

- `Default.aspx`
- `FilterByDropDownList.aspx`
- `CategoryListMaster.aspx`
- `ProductsForCategoryDetails.aspx`
- `CategoriesAndProducts.aspx`

![DatASP.NET Strepeaterfiltering フォルダーを作成し、チュートリアルのページを追加します。](master-detail-filtering-with-a-dropdownlist-datalist-vb/_static/image1.png)

<span data-ttu-id="d867d-119">**図 1**: `DataListRepeaterFiltering` フォルダーを作成し、チュートリアル ASP.NET ページを追加する</span><span class="sxs-lookup"><span data-stu-id="d867d-119">**Figure 1**: Create a `DataListRepeaterFiltering` Folder and Add the Tutorial ASP.NET Pages</span></span>

<span data-ttu-id="d867d-120">次に、[`Default.aspx`] ページを開き、`SectionLevelTutorialListing.ascx` ユーザーコントロールを `UserControls` フォルダーからデザイン画面にドラッグします。</span><span class="sxs-lookup"><span data-stu-id="d867d-120">Next, open the `Default.aspx` page and drag the `SectionLevelTutorialListing.ascx` User Control from the `UserControls` folder onto the Design surface.</span></span> <span data-ttu-id="d867d-121">このユーザーコントロールは、[マスターページとサイトナビゲーション](../introduction/master-pages-and-site-navigation-vb.md)チュートリアルで作成したもので、サイトマップを列挙し、現在のセクションのチュートリアルを箇条書きの一覧に表示します。</span><span class="sxs-lookup"><span data-stu-id="d867d-121">This User Control, which we created in the [Master Pages and Site Navigation](../introduction/master-pages-and-site-navigation-vb.md) tutorial, enumerates the site map and displays the tutorials from the current section in a bulleted list.</span></span>

<span data-ttu-id="d867d-122">[SectionLevelTutorialListing ユーザーコントロールを default.aspx に追加 ![には](master-detail-filtering-with-a-dropdownlist-datalist-vb/_static/image3.png)](master-detail-filtering-with-a-dropdownlist-datalist-vb/_static/image2.png)</span><span class="sxs-lookup"><span data-stu-id="d867d-122">[![Add the SectionLevelTutorialListing.ascx User Control to Default.aspx](master-detail-filtering-with-a-dropdownlist-datalist-vb/_static/image3.png)](master-detail-filtering-with-a-dropdownlist-datalist-vb/_static/image2.png)</span></span>

<span data-ttu-id="d867d-123">**図 2**: `Default.aspx` に `SectionLevelTutorialListing.ascx` ユーザーコントロールを追加する ([クリックすると、フルサイズの画像が表示](master-detail-filtering-with-a-dropdownlist-datalist-vb/_static/image4.png)されます)</span><span class="sxs-lookup"><span data-stu-id="d867d-123">**Figure 2**: Add the `SectionLevelTutorialListing.ascx` User Control to `Default.aspx` ([Click to view full-size image](master-detail-filtering-with-a-dropdownlist-datalist-vb/_static/image4.png))</span></span>

<span data-ttu-id="d867d-124">作成するマスター/詳細のチュートリアルを箇条書きに表示するには、サイトマップに追加する必要があります。</span><span class="sxs-lookup"><span data-stu-id="d867d-124">In order to have the bulleted list display the master/detail tutorials we'll be creating, we need to add them to the site map.</span></span> <span data-ttu-id="d867d-125">`Web.sitemap` ファイルを開き、「DataList と Repeater を使用したデータの表示」の後に、次のマークアップを追加します。</span><span class="sxs-lookup"><span data-stu-id="d867d-125">Open the `Web.sitemap` file and add the following markup after the "Displaying Data with the DataList and Repeater" site map node markup:</span></span>

[!code-xml[Main](master-detail-filtering-with-a-dropdownlist-datalist-vb/samples/sample1.xml)]

![新しい ASP.NET ページを含めるようにサイトマップを更新する](master-detail-filtering-with-a-dropdownlist-datalist-vb/_static/image5.png)

<span data-ttu-id="d867d-127">**図 3**: 新しい ASP.NET ページを含めるようにサイトマップを更新する</span><span class="sxs-lookup"><span data-stu-id="d867d-127">**Figure 3**: Update the Site Map to Include the New ASP.NET Pages</span></span>

## <a name="step-2-displaying-the-categories-in-a-dropdownlist"></a><span data-ttu-id="d867d-128">手順 2: DropDownList でカテゴリを表示する</span><span class="sxs-lookup"><span data-stu-id="d867d-128">Step 2: Displaying the Categories in a DropDownList</span></span>

<span data-ttu-id="d867d-129">マスター/詳細レポートには、選択したリストアイテムの製品が DataList のページに表示されるように、DropDownList にカテゴリが一覧表示されます。</span><span class="sxs-lookup"><span data-stu-id="d867d-129">Our master/detail report will list the categories in a DropDownList, with the selected list item's products displayed further down in the page in a DataList.</span></span> <span data-ttu-id="d867d-130">最初のタスクであるのは、カテゴリを DropDownList に表示することです。</span><span class="sxs-lookup"><span data-stu-id="d867d-130">The first task ahead of us, then, is to have the categories displayed in a DropDownList.</span></span> <span data-ttu-id="d867d-131">まず、`DataListRepeaterFiltering` フォルダーの [`FilterByDropDownList.aspx`] ページを開いて、[ツールボックス] から [DropDownList] をページデザイナーにドラッグします。</span><span class="sxs-lookup"><span data-stu-id="d867d-131">Start by opening the `FilterByDropDownList.aspx` page in the `DataListRepeaterFiltering` folder and drag a DropDownList from the Toolbox onto the page's designer.</span></span> <span data-ttu-id="d867d-132">次に、DropDownList の `ID` プロパティを `Categories`に設定します。</span><span class="sxs-lookup"><span data-stu-id="d867d-132">Next, set the DropDownList's `ID` property to `Categories`.</span></span> <span data-ttu-id="d867d-133">DropDownList のスマートタグから [データソースの選択] リンクをクリックし、`CategoriesDataSource`という名前の新しい ObjectDataSource を作成します。</span><span class="sxs-lookup"><span data-stu-id="d867d-133">Click on the Choose Data Source link from the DropDownList's smart tag and create a new ObjectDataSource named `CategoriesDataSource`.</span></span>

<span data-ttu-id="d867d-134">[新しい ObjectDataSource という名前の新しい名前のデータソースを追加 ![には](master-detail-filtering-with-a-dropdownlist-datalist-vb/_static/image7.png)](master-detail-filtering-with-a-dropdownlist-datalist-vb/_static/image6.png)</span><span class="sxs-lookup"><span data-stu-id="d867d-134">[![Add a New ObjectDataSource Named CategoriesDataSource](master-detail-filtering-with-a-dropdownlist-datalist-vb/_static/image7.png)](master-detail-filtering-with-a-dropdownlist-datalist-vb/_static/image6.png)</span></span>

<span data-ttu-id="d867d-135">**図 4**: `CategoriesDataSource` という名前の新しい ObjectDataSource を追加[する (クリックすると、フルサイズの画像が表示](master-detail-filtering-with-a-dropdownlist-datalist-vb/_static/image8.png)される)</span><span class="sxs-lookup"><span data-stu-id="d867d-135">**Figure 4**: Add a New ObjectDataSource Named `CategoriesDataSource` ([Click to view full-size image](master-detail-filtering-with-a-dropdownlist-datalist-vb/_static/image8.png))</span></span>

<span data-ttu-id="d867d-136">`CategoriesBLL` クラスの `GetCategories()` メソッドを呼び出すように、新しい ObjectDataSource を構成します。</span><span class="sxs-lookup"><span data-stu-id="d867d-136">Configure the new ObjectDataSource such that it invokes the `CategoriesBLL` class's `GetCategories()` method.</span></span> <span data-ttu-id="d867d-137">ObjectDataSource を構成した後も、DropDownList に表示するデータソースフィールドを指定し、各リスト項目の値として関連付ける必要があるデータソースフィールドを指定する必要があります。</span><span class="sxs-lookup"><span data-stu-id="d867d-137">After configuring the ObjectDataSource we still need to specify what data source field should be displayed in the DropDownList and which one should be associated as the value for each list item.</span></span> <span data-ttu-id="d867d-138">`CategoryName` フィールドを表示として使用し、各リスト項目の値として `CategoryID` します。</span><span class="sxs-lookup"><span data-stu-id="d867d-138">Have the `CategoryName` field as the display and `CategoryID` as the value for each list item.</span></span>

<span data-ttu-id="d867d-139">[DropDownList で [区分項目] フィールドを表示し、値として CategoryID を使用する ![ます。](master-detail-filtering-with-a-dropdownlist-datalist-vb/_static/image10.png)](master-detail-filtering-with-a-dropdownlist-datalist-vb/_static/image9.png)</span><span class="sxs-lookup"><span data-stu-id="d867d-139">[![Have the DropDownList Display the CategoryName Field and Use CategoryID as the Value](master-detail-filtering-with-a-dropdownlist-datalist-vb/_static/image10.png)](master-detail-filtering-with-a-dropdownlist-datalist-vb/_static/image9.png)</span></span>

<span data-ttu-id="d867d-140">**図 5**: DropDownList に `CategoryName` フィールドが表示され、`CategoryID` を値として使用する ([クリックしてフルサイズの画像を表示する](master-detail-filtering-with-a-dropdownlist-datalist-vb/_static/image11.png))</span><span class="sxs-lookup"><span data-stu-id="d867d-140">**Figure 5**: Have the DropDownList Display the `CategoryName` Field and Use `CategoryID` as the Value ([Click to view full-size image](master-detail-filtering-with-a-dropdownlist-datalist-vb/_static/image11.png))</span></span>

<span data-ttu-id="d867d-141">この時点で、`Categories` テーブルのレコードが設定された DropDownList コントロールがあります (すべての操作は約6秒で完了しました)。</span><span class="sxs-lookup"><span data-stu-id="d867d-141">At this point we have a DropDownList control that's populated with the records from the `Categories` table (all accomplished in about six seconds).</span></span> <span data-ttu-id="d867d-142">図6は、ブラウザーを通じて表示されたときの進行状況を示しています。</span><span class="sxs-lookup"><span data-stu-id="d867d-142">Figure 6 shows our progress thus far when viewed through a browser.</span></span>

<span data-ttu-id="d867d-143">[ドロップダウンリスト ![現在のカテゴリを一覧表示します。](master-detail-filtering-with-a-dropdownlist-datalist-vb/_static/image13.png)](master-detail-filtering-with-a-dropdownlist-datalist-vb/_static/image12.png)</span><span class="sxs-lookup"><span data-stu-id="d867d-143">[![A Drop-Down Lists the Current Categories](master-detail-filtering-with-a-dropdownlist-datalist-vb/_static/image13.png)](master-detail-filtering-with-a-dropdownlist-datalist-vb/_static/image12.png)</span></span>

<span data-ttu-id="d867d-144">**図 6**: ドロップダウンリストに現在のカテゴリが表示される ([クリックすると、フルサイズの画像が表示](master-detail-filtering-with-a-dropdownlist-datalist-vb/_static/image14.png)されます)</span><span class="sxs-lookup"><span data-stu-id="d867d-144">**Figure 6**: A Drop-Down Lists the Current Categories ([Click to view full-size image](master-detail-filtering-with-a-dropdownlist-datalist-vb/_static/image14.png))</span></span>

## <a name="step-2-adding-the-products-datalist"></a><span data-ttu-id="d867d-145">手順 2: 製品の DataList を追加する</span><span class="sxs-lookup"><span data-stu-id="d867d-145">Step 2: Adding the Products DataList</span></span>

<span data-ttu-id="d867d-146">マスター/詳細レポートの最後の手順は、選択したカテゴリに関連付けられている製品を一覧表示することです。</span><span class="sxs-lookup"><span data-stu-id="d867d-146">The last step in our master/detail report is to list the products associated with the selected category.</span></span> <span data-ttu-id="d867d-147">これを実現するには、DataList をページに追加し、`ProductsByCategoryDataSource`という名前の新しい ObjectDataSource を作成します。</span><span class="sxs-lookup"><span data-stu-id="d867d-147">To accomplish this, add a DataList to the page and create a new ObjectDataSource named `ProductsByCategoryDataSource`.</span></span> <span data-ttu-id="d867d-148">`ProductsByCategoryDataSource` コントロールが、`ProductsBLL` クラスの `GetProductsByCategoryID(categoryID)` メソッドからデータを取得するようにします。</span><span class="sxs-lookup"><span data-stu-id="d867d-148">Have the `ProductsByCategoryDataSource` control retrieve its data from the `ProductsBLL` class's `GetProductsByCategoryID(categoryID)` method.</span></span> <span data-ttu-id="d867d-149">このマスター/詳細レポートは読み取り専用であるため、[挿入]、[更新]、および [削除] の各タブで [(なし)] オプションを選択します。</span><span class="sxs-lookup"><span data-stu-id="d867d-149">Since this master/detail report is read-only, choose the (None) option in the INSERT, UPDATE, and DELETE tabs.</span></span>

<span data-ttu-id="d867d-150">[Get製品 Bycategoryid (categoryID) メソッドを選択 ![には](master-detail-filtering-with-a-dropdownlist-datalist-vb/_static/image16.png)](master-detail-filtering-with-a-dropdownlist-datalist-vb/_static/image15.png)</span><span class="sxs-lookup"><span data-stu-id="d867d-150">[![Select the GetProductsByCategoryID(categoryID) Method](master-detail-filtering-with-a-dropdownlist-datalist-vb/_static/image16.png)](master-detail-filtering-with-a-dropdownlist-datalist-vb/_static/image15.png)</span></span>

<span data-ttu-id="d867d-151">**図 7**: `GetProductsByCategoryID(categoryID)` メソッドを選択[する (クリックしてフルサイズのイメージを表示](master-detail-filtering-with-a-dropdownlist-datalist-vb/_static/image17.png))</span><span class="sxs-lookup"><span data-stu-id="d867d-151">**Figure 7**: Select the `GetProductsByCategoryID(categoryID)` Method ([Click to view full-size image](master-detail-filtering-with-a-dropdownlist-datalist-vb/_static/image17.png))</span></span>

<span data-ttu-id="d867d-152">[次へ] をクリックすると、ObjectDataSource ウィザードによって、`GetProductsByCategoryID(categoryID)` メソッドの *`categoryID`* パラメーターの値のソースが要求されます。</span><span class="sxs-lookup"><span data-stu-id="d867d-152">After clicking Next, the ObjectDataSource wizard prompts us for the source of the value for the `GetProductsByCategoryID(categoryID)` method's *`categoryID`* parameter.</span></span> <span data-ttu-id="d867d-153">選択した `categories` DropDownList 項目の値を使用するには、パラメーターソースを制御するように設定し、ControlID を `Categories`に設定します。</span><span class="sxs-lookup"><span data-stu-id="d867d-153">To use the value of the selected `categories` DropDownList item set the Parameter source to Control and the ControlID to `Categories`.</span></span>

<span data-ttu-id="d867d-154">[categoryID パラメーターをカテゴリの DropDownList の値に設定 ![](master-detail-filtering-with-a-dropdownlist-datalist-vb/_static/image19.png)](master-detail-filtering-with-a-dropdownlist-datalist-vb/_static/image18.png)</span><span class="sxs-lookup"><span data-stu-id="d867d-154">[![Set the categoryID Parameter to the Value of the Categories DropDownList](master-detail-filtering-with-a-dropdownlist-datalist-vb/_static/image19.png)](master-detail-filtering-with-a-dropdownlist-datalist-vb/_static/image18.png)</span></span>

<span data-ttu-id="d867d-155">**図 8**: *`categoryID`* パラメーターを `Categories` DropDownList の値に設定する ([クリックすると、フルサイズの画像が表示](master-detail-filtering-with-a-dropdownlist-datalist-vb/_static/image20.png)されます)</span><span class="sxs-lookup"><span data-stu-id="d867d-155">**Figure 8**: Set the *`categoryID`* Parameter to the Value of the `Categories` DropDownList ([Click to view full-size image](master-detail-filtering-with-a-dropdownlist-datalist-vb/_static/image20.png))</span></span>

<span data-ttu-id="d867d-156">データソースの構成ウィザードを完了すると、Visual Studio によって、各データフィールドの名前と値を表示する DataList の `ItemTemplate` が自動的に生成されます。</span><span class="sxs-lookup"><span data-stu-id="d867d-156">Upon completing the Configure Data Source wizard, Visual Studio will automatically generate an `ItemTemplate` for the DataList that displays the name and value of each data field.</span></span> <span data-ttu-id="d867d-157">ここでは、DataList を拡張して、製品の名前、カテゴリ、仕入先、数量/単位、価格だけでなく、各項目の間に `<hr>` 要素を挿入する `SeparatorTemplate` を表示する `ItemTemplate` を使用するようにします。</span><span class="sxs-lookup"><span data-stu-id="d867d-157">Let's enhance the DataList to instead use an `ItemTemplate` that displays just the product's name, category, supplier, quantity per unit, and price along with a `SeparatorTemplate` that injects an `<hr>` element between each item.</span></span> <span data-ttu-id="d867d-158">ここでは、「 [DataList コントロールと Repeater コントロールでデータを表示](../displaying-data-with-the-datalist-and-repeater/displaying-data-with-the-datalist-and-repeater-controls-vb.md)する」チュートリアルの例の `ItemTemplate` を使用しますが、視覚的に魅力のあるテンプレートマークアップを自由に使用できます。</span><span class="sxs-lookup"><span data-stu-id="d867d-158">I'm going to use the `ItemTemplate` from an example in the [Displaying Data with the DataList and Repeater Controls](../displaying-data-with-the-datalist-and-repeater/displaying-data-with-the-datalist-and-repeater-controls-vb.md) tutorial, but feel free to use whatever template markup you find most visually appealing.</span></span>

<span data-ttu-id="d867d-159">これらの変更を行った後、DataList とその ObjectDataSource のマークアップは次のようになります。</span><span class="sxs-lookup"><span data-stu-id="d867d-159">After making these changes, your DataList and its ObjectDataSource's markup should look similar to the following:</span></span>

[!code-aspx[Main](master-detail-filtering-with-a-dropdownlist-datalist-vb/samples/sample2.aspx)]

<span data-ttu-id="d867d-160">ブラウザーで進行状況を確認してみてください。</span><span class="sxs-lookup"><span data-stu-id="d867d-160">Take a moment to check out our progress in a browser.</span></span> <span data-ttu-id="d867d-161">最初にページにアクセスすると、選択したカテゴリ (飲料) に属するこれらの製品が表示されます (図9を参照)。 DropDownList を変更してもデータは更新されません。</span><span class="sxs-lookup"><span data-stu-id="d867d-161">When first visiting the page, those products belonging to the selected category (Beverages) are displayed (as shown in Figure 9), but changing the DropDownList doesn't update the data.</span></span> <span data-ttu-id="d867d-162">これは、DataList を更新するためにポストバックが発生する必要があるためです。</span><span class="sxs-lookup"><span data-stu-id="d867d-162">This is because a postback must occur for the DataList to update.</span></span> <span data-ttu-id="d867d-163">これを実現するには、DropDownList の `AutoPostBack` プロパティを `true` に設定するか、ボタン Web コントロールをページに追加します。</span><span class="sxs-lookup"><span data-stu-id="d867d-163">To accomplish this we can either set the DropDownList's `AutoPostBack` property to `true` or add a Button Web control to the page.</span></span> <span data-ttu-id="d867d-164">このチュートリアルでは、DropDownList の `AutoPostBack` プロパティを `true`に設定することを選択しました。</span><span class="sxs-lookup"><span data-stu-id="d867d-164">For this tutorial, I've opted to set the DropDownList's `AutoPostBack` property to `true`.</span></span>

<span data-ttu-id="d867d-165">図9と10は、マスター/詳細レポートの動作を示しています。</span><span class="sxs-lookup"><span data-stu-id="d867d-165">Figures 9 and 10 illustrate the master/detail report in action.</span></span>

<span data-ttu-id="d867d-166">[ページに初めてアクセスしたときに、飲料製品が表示される ![](master-detail-filtering-with-a-dropdownlist-datalist-vb/_static/image22.png)](master-detail-filtering-with-a-dropdownlist-datalist-vb/_static/image21.png)</span><span class="sxs-lookup"><span data-stu-id="d867d-166">[![When First Visiting the Page, the Beverage Products are Displayed](master-detail-filtering-with-a-dropdownlist-datalist-vb/_static/image22.png)](master-detail-filtering-with-a-dropdownlist-datalist-vb/_static/image21.png)</span></span>

<span data-ttu-id="d867d-167">**図 9**: 最初にページにアクセスしたときに、飲み物の製品が表示される ([クリックすると、フルサイズの画像が表示](master-detail-filtering-with-a-dropdownlist-datalist-vb/_static/image23.png)されます)</span><span class="sxs-lookup"><span data-stu-id="d867d-167">**Figure 9**: When First Visiting the Page, the Beverage Products are Displayed ([Click to view full-size image](master-detail-filtering-with-a-dropdownlist-datalist-vb/_static/image23.png))</span></span>

<span data-ttu-id="d867d-168">[新しい製品 ([生成]) を選択する ![自動的にポストバックが発生し、DataList が更新されます。](master-detail-filtering-with-a-dropdownlist-datalist-vb/_static/image25.png)](master-detail-filtering-with-a-dropdownlist-datalist-vb/_static/image24.png)</span><span class="sxs-lookup"><span data-stu-id="d867d-168">[![Selecting a New Product (Produce) Automatically Causes a PostBack, Updating the DataList](master-detail-filtering-with-a-dropdownlist-datalist-vb/_static/image25.png)](master-detail-filtering-with-a-dropdownlist-datalist-vb/_static/image24.png)</span></span>

<span data-ttu-id="d867d-169">**図 10**: 新しい製品 ([生成]) を選択すると自動的にポストバックが発生し、DataList が更新されます ([クリックすると、フルサイズのイメージが表示](master-detail-filtering-with-a-dropdownlist-datalist-vb/_static/image26.png)されます)</span><span class="sxs-lookup"><span data-stu-id="d867d-169">**Figure 10**: Selecting a New Product (Produce) Automatically Causes a PostBack, Updating the DataList ([Click to view full-size image](master-detail-filtering-with-a-dropdownlist-datalist-vb/_static/image26.png))</span></span>

## <a name="adding-a----choose-a-category----list-item"></a><span data-ttu-id="d867d-170">"--カテゴリの選択--" リスト項目を追加する</span><span class="sxs-lookup"><span data-stu-id="d867d-170">Adding a "-- Choose a Category --" List Item</span></span>

<span data-ttu-id="d867d-171">最初に [`FilterByDropDownList.aspx`] ページにアクセスしたときに、[カテゴリ] の [DropDownList] の最初のリスト項目 (飲料) が既定で選択され、[DataList] の飲料製品が表示されます。</span><span class="sxs-lookup"><span data-stu-id="d867d-171">When first visiting the `FilterByDropDownList.aspx` page the categories DropDownList's first list item (Beverages) is selected by default, showing the beverage products in the DataList.</span></span> <span data-ttu-id="d867d-172">DropDownList チュートリアルを使用した*マスター/詳細フィルター処理*で、既定で選択された dropdownlist に "--Category--" オプションを追加しました。選択すると、データベース内の*すべて*の製品が表示されます。</span><span class="sxs-lookup"><span data-stu-id="d867d-172">In the *Master/Detail Filtering With a DropDownList* tutorial we added a "-- Choose a Category --" option to the DropDownList that was selected by default and, when selected, displayed *all* of the products in the database.</span></span> <span data-ttu-id="d867d-173">このようなアプローチは、GridView で製品を一覧表示するときに管理しやすくなりました。これは、各製品の行が画面の実際のサイズを小さくするためです。</span><span class="sxs-lookup"><span data-stu-id="d867d-173">Such an approach was manageable when listing the products in a GridView, as each product row took up a small amount of screen real estate.</span></span> <span data-ttu-id="d867d-174">ただし、DataList では、各製品の情報が画面のチャンクを大幅に消費します。</span><span class="sxs-lookup"><span data-stu-id="d867d-174">With the DataList, however, each product's information consumes a much larger chunk of the screen.</span></span> <span data-ttu-id="d867d-175">引き続き "--Category を選択する--" オプションを追加して、既定で選択します。ただし、選択したすべての製品を表示するのではなく、製品が表示されないように構成します。</span><span class="sxs-lookup"><span data-stu-id="d867d-175">Let's still add a "-- Choose a Category --" option and have it selected by default, but instead of having it show all products when selected, let's configure it so that it shows no products.</span></span>

<span data-ttu-id="d867d-176">新しいリストアイテムを DropDownList に追加するには、プロパティウィンドウにアクセスし、`Items` プロパティの省略記号をクリックします。</span><span class="sxs-lookup"><span data-stu-id="d867d-176">To add a new list item to the DropDownList, go to the Properties window and click on the ellipses in the `Items` property.</span></span> <span data-ttu-id="d867d-177">`Text` "--Category--" と `Value` `0`を持つ新しいリスト項目を追加します。</span><span class="sxs-lookup"><span data-stu-id="d867d-177">Add a new list item with the `Text` "-- Choose a Category --" and the `Value` `0`.</span></span>

![を追加する](master-detail-filtering-with-a-dropdownlist-datalist-vb/_static/image27.png)

<span data-ttu-id="d867d-179">**図 11**: "--カテゴリを選択する--" リスト項目を追加する</span><span class="sxs-lookup"><span data-stu-id="d867d-179">**Figure 11**: Add a "-- Choose a Category --" List Item</span></span>

<span data-ttu-id="d867d-180">または、次のマークアップを DropDownList に追加して、リスト項目を追加することもできます。</span><span class="sxs-lookup"><span data-stu-id="d867d-180">Alternatively, you can add the list item by adding the following markup to the DropDownList:</span></span>

[!code-aspx[Main](master-detail-filtering-with-a-dropdownlist-datalist-vb/samples/sample3.aspx)]

<span data-ttu-id="d867d-181">さらに、DropDownList コントロールの `AppendDataBoundItems` を `true` に設定する必要があります。これは `false` (既定) に設定されている場合、カテゴリが ObjectDataSource から DropDownList にバインドされると、手動で追加したリスト項目が上書きされるためです。</span><span class="sxs-lookup"><span data-stu-id="d867d-181">Additionally, we need to set the DropDownList control's `AppendDataBoundItems` to `true` because if it's set to `false` (the default), when the categories are bound to the DropDownList from the ObjectDataSource they'll overwrite any manually-added list items.</span></span>

![AppendDataBoundItems プロパティを True に設定します。](master-detail-filtering-with-a-dropdownlist-datalist-vb/_static/image28.png)

<span data-ttu-id="d867d-183">**図 12**: `AppendDataBoundItems` プロパティを True に設定する</span><span class="sxs-lookup"><span data-stu-id="d867d-183">**Figure 12**: Set the `AppendDataBoundItems` Property to True</span></span>

<span data-ttu-id="d867d-184">"--カテゴリの選択--" リスト項目の値 `0` を選択した理由は、システムには値が `0`であるカテゴリが存在しないため、"--カテゴリの選択--" リスト項目が選択されたときに製品レコードが返されないためです。</span><span class="sxs-lookup"><span data-stu-id="d867d-184">The reason we chose the value `0` for the "-- Choose a Category --" list item is because there are no categories in the system with a value of `0`, hence no product records will be returned when the "-- Choose a Category --" list item is selected.</span></span> <span data-ttu-id="d867d-185">これを確認するには、ブラウザーを使用してページにアクセスします。</span><span class="sxs-lookup"><span data-stu-id="d867d-185">To confirm this, take a moment to visit the page through a browser.</span></span> <span data-ttu-id="d867d-186">図13に示されているように、最初にページを表示すると、"--カテゴリを選択--" リスト項目が選択され、製品が表示されません。</span><span class="sxs-lookup"><span data-stu-id="d867d-186">As Figure 13 shows, when initially viewing the page the "-- Choose a Category --" list item is selected and no products are displayed.</span></span>

<span data-ttu-id="d867d-187">[![](master-detail-filtering-with-a-dropdownlist-datalist-vb/_static/image30.png)](master-detail-filtering-with-a-dropdownlist-datalist-vb/_static/image29.png)</span><span class="sxs-lookup"><span data-stu-id="d867d-187">[![When the](master-detail-filtering-with-a-dropdownlist-datalist-vb/_static/image30.png)](master-detail-filtering-with-a-dropdownlist-datalist-vb/_static/image29.png)</span></span>

<span data-ttu-id="d867d-188">**図 13**: "--カテゴリの選択--" リスト項目が選択されている場合、製品は表示されません ([クリックすると、フルサイズの画像が表示](master-detail-filtering-with-a-dropdownlist-datalist-vb/_static/image31.png)されます)</span><span class="sxs-lookup"><span data-stu-id="d867d-188">**Figure 13**: When the "-- Choose a Category --" List Item is Selected, No Products are Displayed ([Click to view full-size image](master-detail-filtering-with-a-dropdownlist-datalist-vb/_static/image31.png))</span></span>

<span data-ttu-id="d867d-189">[--カテゴリの選択--] オプションを選択したときに*すべて*の製品を表示する場合は、代わりに値 `-1` を使用します。</span><span class="sxs-lookup"><span data-stu-id="d867d-189">If you'd rather display *all* of the products when the "-- Choose a Category --" option is selected, use a value of `-1` instead.</span></span> <span data-ttu-id="d867d-190">ずる賢い reader は、DropDownList チュートリアルを使用し*てマスター/詳細フィルター処理*を行ったことを思い出して、`-1` の *`categoryID`* 値が渡された場合に、すべての製品レコードが返されるように `ProductsBLL` クラスの `GetProductsByCategoryID(categoryID)` メソッドを更新しました。</span><span class="sxs-lookup"><span data-stu-id="d867d-190">The astute reader will recall that back in the *Master/Detail Filtering With a DropDownList* tutorial we updated the `ProductsBLL` class's `GetProductsByCategoryID(categoryID)` method so that if a *`categoryID`* value of `-1` was passed in, all product records were returned.</span></span>

## <a name="summary"></a><span data-ttu-id="d867d-191">要約</span><span class="sxs-lookup"><span data-stu-id="d867d-191">Summary</span></span>

<span data-ttu-id="d867d-192">階層的に関連するデータを表示する場合は、多くの場合、マスター/詳細レポートを使用してデータを表示することができます。この場合、ユーザーは階層の最上位からデータのつい man を開始し、詳細にドリルダウンできます。</span><span class="sxs-lookup"><span data-stu-id="d867d-192">When displaying hierarchically-related data, it often helps to present the data using master/detail reports, from which the user can start perusing the data from the top of the hierarchy and drill down into details.</span></span> <span data-ttu-id="d867d-193">このチュートリアルでは、選択したカテゴリの製品を示す単純なマスター/詳細レポートを作成する方法を説明しました。</span><span class="sxs-lookup"><span data-stu-id="d867d-193">In this tutorial we examined building a simple master/detail report showing a selected category's products.</span></span> <span data-ttu-id="d867d-194">これを実現するには、選択したカテゴリに属する製品のカテゴリの一覧に DropDownList を使用します。</span><span class="sxs-lookup"><span data-stu-id="d867d-194">This was accomplished by using a DropDownList for the list of categories and a DataList for the products belonging to the selected category.</span></span>

<span data-ttu-id="d867d-195">次のチュートリアルでは、2ページでマスターレコードと詳細レコードを分離する方法について説明します。</span><span class="sxs-lookup"><span data-stu-id="d867d-195">In the next tutorial we'll look at separating the master and details records across two pages.</span></span> <span data-ttu-id="d867d-196">最初のページには、"マスター" レコードの一覧と、詳細を表示するためのリンクが表示されます。</span><span class="sxs-lookup"><span data-stu-id="d867d-196">In the first page, a list of "master" records will be displayed, with a link to view the details.</span></span> <span data-ttu-id="d867d-197">リンクをクリックすると、ユーザーが2番目のページに whisk、選択したマスターレコードの詳細が表示されます。</span><span class="sxs-lookup"><span data-stu-id="d867d-197">Clicking on the link will whisk the user to the second page, which will display the details for the selected master record.</span></span>

<span data-ttu-id="d867d-198">プログラミングを楽しんでください。</span><span class="sxs-lookup"><span data-stu-id="d867d-198">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="d867d-199">作成者について</span><span class="sxs-lookup"><span data-stu-id="d867d-199">About the Author</span></span>

<span data-ttu-id="d867d-200">1998以来、 [Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml)は 7 asp/創設者 of [4GuysFromRolla.com](http://www.4guysfromrolla.com)の執筆者であり、Microsoft Web テクノロジを使用しています。</span><span class="sxs-lookup"><span data-stu-id="d867d-200">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="d867d-201">Scott は、独立したコンサルタント、トレーナー、およびライターとして機能します。</span><span class="sxs-lookup"><span data-stu-id="d867d-201">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="d867d-202">彼の最新の書籍は[ *、ASP.NET 2.0 を24時間以内に教え*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)ています。</span><span class="sxs-lookup"><span data-stu-id="d867d-202">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="d867d-203">mitchell@4GuysFromRolla.comでアクセスでき[ます。](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="d867d-203">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="d867d-204">または彼のブログを参照してください。これは[http://ScottOnWriting.NET](http://ScottOnWriting.NET)にあります。</span><span class="sxs-lookup"><span data-stu-id="d867d-204">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="d867d-205">ありがとうございました。</span><span class="sxs-lookup"><span data-stu-id="d867d-205">Special Thanks To…</span></span>

<span data-ttu-id="d867d-206">このチュートリアルシリーズは、役に立つ多くのレビュー担当者によってレビューされました。</span><span class="sxs-lookup"><span data-stu-id="d867d-206">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="d867d-207">このチュートリアルのリードレビュー担当者は、Randy になりました。</span><span class="sxs-lookup"><span data-stu-id="d867d-207">Lead reviewer for this tutorial was Randy Schmidt.</span></span> <span data-ttu-id="d867d-208">今後の MSDN 記事を確認することに興味がありますか?</span><span class="sxs-lookup"><span data-stu-id="d867d-208">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="d867d-209">その場合は、mitchell@4GuysFromRolla.comの行を削除[します。](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="d867d-209">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="d867d-210">[前へ](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs.md)
> [次へ](master-detail-filtering-acess-two-pages-datalist-vb.md)</span><span class="sxs-lookup"><span data-stu-id="d867d-210">[Previous](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs.md)
[Next](master-detail-filtering-acess-two-pages-datalist-vb.md)</span></span>

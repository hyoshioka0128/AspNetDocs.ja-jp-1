---
uid: web-forms/overview/data-access/filtering-scenarios-with-the-datalist-and-repeater/master-detail-filtering-acess-two-pages-datalist-vb
title: 2つのページでマスター/詳細をフィルター処理する (VB) |Microsoft Docs
author: rick-anderson
description: このチュートリアルでは、マスター/詳細レポートを2ページに分割する方法について説明します。 ' マスター ' ページで、Repeater コントロールを使用して categ の一覧を表示しています...
ms.author: riande
ms.date: 10/30/2010
ms.assetid: f1a1be2c-6fd9-4a09-916e-aa1b98d5cf17
msc.legacyurl: /web-forms/overview/data-access/filtering-scenarios-with-the-datalist-and-repeater/master-detail-filtering-acess-two-pages-datalist-vb
msc.type: authoredcontent
ms.openlocfilehash: 037e5f47efff88bfcbec57b11efa4fec04f9542d
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 03/06/2020
ms.locfileid: "78491476"
---
# <a name="masterdetail-filtering-across-two-pages-vb"></a><span data-ttu-id="c9e6c-104">2 つのページでマスター/詳細をフィルター処理する (VB)</span><span class="sxs-lookup"><span data-stu-id="c9e6c-104">Master/Detail Filtering Across Two Pages (VB)</span></span>

<span data-ttu-id="c9e6c-105">[Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="c9e6c-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="c9e6c-106">[サンプルアプリのダウンロード](https://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_34_VB.exe)または[PDF のダウンロード](master-detail-filtering-acess-two-pages-datalist-vb/_static/datatutorial34vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="c9e6c-106">[Download Sample App](https://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_34_VB.exe) or [Download PDF](master-detail-filtering-acess-two-pages-datalist-vb/_static/datatutorial34vb1.pdf)</span></span>

> <span data-ttu-id="c9e6c-107">このチュートリアルでは、マスター/詳細レポートを2ページに分割する方法について説明します。</span><span class="sxs-lookup"><span data-stu-id="c9e6c-107">In this tutorial we look at how to separate a master/detail report across two pages.</span></span> <span data-ttu-id="c9e6c-108">[マスター] ページで、Repeater コントロールを使用してカテゴリの一覧を表示します。クリックすると、ユーザーは [詳細] ページに移動します。このページには、選択したカテゴリに属する製品が表示されます。</span><span class="sxs-lookup"><span data-stu-id="c9e6c-108">In the "master" page we use a Repeater control to render a list of categories that, when clicked, will take the user to the "details" page where a two-column DataList shows those products belonging to the selected category.</span></span>

## <a name="introduction"></a><span data-ttu-id="c9e6c-109">はじめに</span><span class="sxs-lookup"><span data-stu-id="c9e6c-109">Introduction</span></span>

<span data-ttu-id="c9e6c-110">[2 ページでのマスター/詳細のフィルター処理](../masterdetail/master-detail-filtering-across-two-pages-vb.md)のチュートリアルでは、システム内のすべてのサプライヤーを表示する GridView を使用して、このパターンを調べています。</span><span class="sxs-lookup"><span data-stu-id="c9e6c-110">In the [Master/Detail Filtering Across Two Pages](../masterdetail/master-detail-filtering-across-two-pages-vb.md) tutorial, we examined this pattern using a GridView to display all of the suppliers in the system.</span></span> <span data-ttu-id="c9e6c-111">この GridView には、2番目のページへのリンクとして表示されるハイパーリンクフィールドが含まれています。これは、クエリ文字列内の `SupplierID` に従って渡されます。</span><span class="sxs-lookup"><span data-stu-id="c9e6c-111">This GridView included a HyperLinkField, which rendered as a link to a second page, passing along the `SupplierID` in the querystring.</span></span> <span data-ttu-id="c9e6c-112">2番目のページでは、GridView を使用して、選択した業者によって提供される製品を一覧表示します。</span><span class="sxs-lookup"><span data-stu-id="c9e6c-112">The second page used a GridView to list those products provided by the selected supplier.</span></span>

<span data-ttu-id="c9e6c-113">このような2ページのマスター/詳細レポートは、DataList コントロールと Repeater コントロールを使用しても実行できます。</span><span class="sxs-lookup"><span data-stu-id="c9e6c-113">Such two-page master/detail reports can be accomplished using DataList and Repeater controls as well.</span></span> <span data-ttu-id="c9e6c-114">唯一の違いは、DataList も Repeater もハイパーリンクフィールドコントロールをサポートしないことです。</span><span class="sxs-lookup"><span data-stu-id="c9e6c-114">The only difference is that neither the DataList nor the Repeater provides support for the HyperLinkField control.</span></span> <span data-ttu-id="c9e6c-115">代わりに、コントロールの `ItemTemplate`内に、ハイパーリンク Web コントロールまたはアンカー HTML 要素 (`<a>`) を追加する必要があります。</span><span class="sxs-lookup"><span data-stu-id="c9e6c-115">Instead, we must add a HyperLink Web control or an anchor HTML element (`<a>`) within the control's `ItemTemplate`.</span></span> <span data-ttu-id="c9e6c-116">ハイパーリンクの `NavigateUrl` プロパティまたはアンカーの `href` 属性は、宣言型またはプログラムによる方法を使用してカスタマイズできます。</span><span class="sxs-lookup"><span data-stu-id="c9e6c-116">The HyperLink's `NavigateUrl` property or the anchor's `href` attribute can then be customized using declarative or programmatic approaches.</span></span>

<span data-ttu-id="c9e6c-117">このチュートリアルでは、Repeater コントロールを使用して、1ページの箇条書きのカテゴリを一覧表示する例を紹介します。</span><span class="sxs-lookup"><span data-stu-id="c9e6c-117">In this tutorial we'll explore an example that lists the categories in a bulleted list on one page using a Repeater control.</span></span> <span data-ttu-id="c9e6c-118">各リスト項目には、カテゴリの名前と説明が含まれ、カテゴリ名は2番目のページへのリンクとして表示されます。</span><span class="sxs-lookup"><span data-stu-id="c9e6c-118">Each list item will include the category's name and description, with the category name displayed as a link to a second page.</span></span> <span data-ttu-id="c9e6c-119">このリンクをクリックすると、ユーザーが2番目のページに whisk ます。ここで、選択したカテゴリに属する製品が DataList によって表示されます。</span><span class="sxs-lookup"><span data-stu-id="c9e6c-119">Clicking on this link will whisk the user to the second page, where a DataList will show those products that belong to the selected category.</span></span>

## <a name="step-1-displaying-the-categories-in-a-bulleted-list"></a><span data-ttu-id="c9e6c-120">手順 1: 箇条書きの一覧にカテゴリを表示する</span><span class="sxs-lookup"><span data-stu-id="c9e6c-120">Step 1: Displaying the Categories in a Bulleted List</span></span>

<span data-ttu-id="c9e6c-121">マスター/詳細レポートを作成する最初の手順は、"マスター" レコードを表示することによって開始することです。</span><span class="sxs-lookup"><span data-stu-id="c9e6c-121">The first step in creating any master/detail report is to start by displaying the "master" records.</span></span> <span data-ttu-id="c9e6c-122">そのため、最初のタスクは、"マスター" ページにカテゴリを表示することです。</span><span class="sxs-lookup"><span data-stu-id="c9e6c-122">Therefore, our first task is to display the categories in the "master" page.</span></span> <span data-ttu-id="c9e6c-123">`DataListRepeaterFiltering` フォルダーの [`CategoryListMaster.aspx`] ページを開き、Repeater コントロールを追加し、スマートタグから新しい ObjectDataSource を追加することを選択します。</span><span class="sxs-lookup"><span data-stu-id="c9e6c-123">Open the `CategoryListMaster.aspx` page in the `DataListRepeaterFiltering` folder, add a Repeater control, and, from the smart tag, opt to add a new ObjectDataSource.</span></span> <span data-ttu-id="c9e6c-124">`CategoriesBLL` クラスの `GetCategories` メソッドからデータにアクセスするように新しい ObjectDataSource を構成します (図1を参照)。</span><span class="sxs-lookup"><span data-stu-id="c9e6c-124">Configure the new ObjectDataSource so that it accesses its data from the `CategoriesBLL` class's `GetCategories` method (see Figure 1).</span></span>

<span data-ttu-id="c9e6c-125">[カテゴリ Bll クラスの GetCategories メソッドを使用するように ObjectDataSource を構成 ![には](master-detail-filtering-acess-two-pages-datalist-vb/_static/image2.png)](master-detail-filtering-acess-two-pages-datalist-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="c9e6c-125">[![Configure the ObjectDataSource to Use the CategoriesBLL Class's GetCategories Method](master-detail-filtering-acess-two-pages-datalist-vb/_static/image2.png)](master-detail-filtering-acess-two-pages-datalist-vb/_static/image1.png)</span></span>

<span data-ttu-id="c9e6c-126">**図 1**: `CategoriesBLL` クラスの `GetCategories` メソッドを使用するように ObjectDataSource を構成する ([クリックしてフルサイズのイメージを表示する](master-detail-filtering-acess-two-pages-datalist-vb/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="c9e6c-126">**Figure 1**: Configure the ObjectDataSource to Use the `CategoriesBLL` Class's `GetCategories` Method ([Click to view full-size image](master-detail-filtering-acess-two-pages-datalist-vb/_static/image3.png))</span></span>

<span data-ttu-id="c9e6c-127">次に、各カテゴリの名前と説明を箇条書きの項目として表示するように、リピータのテンプレートを定義します。</span><span class="sxs-lookup"><span data-stu-id="c9e6c-127">Next, define the Repeater's templates such that it displays each category name and description as an item in a bulleted list.</span></span> <span data-ttu-id="c9e6c-128">ここでは、各カテゴリが詳細ページにリンクされていることについて心配する必要はありません。</span><span class="sxs-lookup"><span data-stu-id="c9e6c-128">Let's not yet worry about having each category link to the details page.</span></span> <span data-ttu-id="c9e6c-129">Repeater および ObjectDataSource の宣言型マークアップを次に示します。</span><span class="sxs-lookup"><span data-stu-id="c9e6c-129">The following shows the declarative markup for the Repeater and ObjectDataSource:</span></span>

[!code-aspx[Main](master-detail-filtering-acess-two-pages-datalist-vb/samples/sample1.aspx)]

<span data-ttu-id="c9e6c-130">このマークアップが完了したら、ブラウザーで進行状況を確認してください。</span><span class="sxs-lookup"><span data-stu-id="c9e6c-130">With this markup complete, take a moment to view our progress through a browser.</span></span> <span data-ttu-id="c9e6c-131">図2に示すように、リピータは、各カテゴリの名前と説明を示す箇条書きリストとしてレンダリングします。</span><span class="sxs-lookup"><span data-stu-id="c9e6c-131">As Figure 2 shows, the Repeater renders as a bulleted list showing each category's name and description.</span></span>

<span data-ttu-id="c9e6c-132">[各カテゴリ ![箇条書き項目として表示されます](master-detail-filtering-acess-two-pages-datalist-vb/_static/image5.png)](master-detail-filtering-acess-two-pages-datalist-vb/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="c9e6c-132">[![Each Category is Displayed as a Bulleted List Item](master-detail-filtering-acess-two-pages-datalist-vb/_static/image5.png)](master-detail-filtering-acess-two-pages-datalist-vb/_static/image4.png)</span></span>

<span data-ttu-id="c9e6c-133">**図 2**: 各カテゴリは箇条書き項目として表示されます ([クリックすると、フルサイズの画像が表示](master-detail-filtering-acess-two-pages-datalist-vb/_static/image6.png)されます)</span><span class="sxs-lookup"><span data-stu-id="c9e6c-133">**Figure 2**: Each Category is Displayed as a Bulleted List Item ([Click to view full-size image](master-detail-filtering-acess-two-pages-datalist-vb/_static/image6.png))</span></span>

## <a name="step-2-turning-the-category-name-into-a-link-to-the-details-page"></a><span data-ttu-id="c9e6c-134">手順 2: カテゴリ名を詳細ページへのリンクに変える</span><span class="sxs-lookup"><span data-stu-id="c9e6c-134">Step 2: Turning the Category Name into a Link to the Details Page</span></span>

<span data-ttu-id="c9e6c-135">ユーザーが特定のカテゴリの "詳細" 情報を表示できるようにするには、各箇条書き項目へのリンクを追加する必要があります。これは、クリックすると、ユーザーが2番目のページ (`ProductsForCategoryDetails.aspx`) に移動します。</span><span class="sxs-lookup"><span data-stu-id="c9e6c-135">To allow a user to display the "details" information for a given category, we need to add a link to each bulleted list item that, when clicked, will take the user to the second page (`ProductsForCategoryDetails.aspx`).</span></span> <span data-ttu-id="c9e6c-136">この2番目のページには、DataList を使用して、選択したカテゴリの製品が表示されます。</span><span class="sxs-lookup"><span data-stu-id="c9e6c-136">This second page will then display the products for the selected category using a DataList.</span></span> <span data-ttu-id="c9e6c-137">リンクがクリックされたカテゴリを確認するには、いくつかのメカニズムを使用して、クリックしたカテゴリの `CategoryID` を2番目のページに渡す必要があります。</span><span class="sxs-lookup"><span data-stu-id="c9e6c-137">In order to determine the category whose link was clicked, we need to pass the clicked category's `CategoryID` to the second page through some mechanism.</span></span> <span data-ttu-id="c9e6c-138">1つのページから別のページにスカラーデータを転送する最も簡単で最も簡単な方法は、このチュートリアルで使用するオプションであるクエリ文字列を使用することです。</span><span class="sxs-lookup"><span data-stu-id="c9e6c-138">The simplest, most straightforward way to transfer scalar data from one page to another is through the querystring, which is the option we'll use in this tutorial.</span></span> <span data-ttu-id="c9e6c-139">特に、[`ProductsForCategoryDetails.aspx`] ページでは、選択した *`categoryID`* 値が `CategoryID`という名前の querystring フィールドを介して渡されることを想定しています。</span><span class="sxs-lookup"><span data-stu-id="c9e6c-139">In particular, the `ProductsForCategoryDetails.aspx` page will expect the selected *`categoryID`* value to be passed through a querystring field named `CategoryID`.</span></span> <span data-ttu-id="c9e6c-140">たとえば、`CategoryID` が1である飲み物カテゴリの製品を表示するには、ユーザーが `ProductsForCategoryDetails.aspx?CategoryID=1`にアクセスします。</span><span class="sxs-lookup"><span data-stu-id="c9e6c-140">For example, to view the products for the Beverages category, which has a `CategoryID` of 1, a user would visit `ProductsForCategoryDetails.aspx?CategoryID=1`.</span></span>

<span data-ttu-id="c9e6c-141">リピータの箇条書き項目ごとにハイパーリンクを作成するには、ハイパーリンク Web コントロールまたは HTML アンカー要素 (`<a>`) を `ItemTemplate`に追加する必要があります。</span><span class="sxs-lookup"><span data-stu-id="c9e6c-141">To create a hyperlink for each bulleted list item in the Repeater we need to either add a HyperLink Web control or an HTML anchor element (`<a>`) to the `ItemTemplate`.</span></span> <span data-ttu-id="c9e6c-142">ハイパーリンクが各行に対して同じように表示されるシナリオでは、どちらの方法でも十分です。</span><span class="sxs-lookup"><span data-stu-id="c9e6c-142">In scenarios where the hyperlink is displayed the same for each row, either approach will suffice.</span></span> <span data-ttu-id="c9e6c-143">リピータの場合は、anchor 要素を使用します。</span><span class="sxs-lookup"><span data-stu-id="c9e6c-143">For Repeaters, I prefer using the anchor element.</span></span> <span data-ttu-id="c9e6c-144">アンカー要素を使用するには、リピータの ItemTemplate を次のように更新します。</span><span class="sxs-lookup"><span data-stu-id="c9e6c-144">To use the anchor element, update the Repeater's ItemTemplate to:</span></span>

[!code-aspx[Main](master-detail-filtering-acess-two-pages-datalist-vb/samples/sample2.aspx)]

<span data-ttu-id="c9e6c-145">`CategoryID` は、アンカー要素の `href` 属性内に直接挿入できることに注意してください。ただし、そのためには、`href` 属性内の `Eval` メソッドが引用符で囲まれた文字列 (`"CategoryID"`) を区切るため、`href` 属性の値をアポストロフィ (および note 引用符) で区切る必要があります。</span><span class="sxs-lookup"><span data-stu-id="c9e6c-145">Note that the `CategoryID` can be injected directly within the anchor element's `href` attribute; however, to do so be certain to delimit the `href` attribute's value with apostrophes (and note quotation marks) since the `Eval` method within the `href` attribute delimits its string (`"CategoryID"`) with quotation marks.</span></span> <span data-ttu-id="c9e6c-146">代わりに、HyperLink Web コントロールを使用することもできます。</span><span class="sxs-lookup"><span data-stu-id="c9e6c-146">Alternatively, a HyperLink Web control can be used instead:</span></span>

[!code-aspx[Main](master-detail-filtering-acess-two-pages-datalist-vb/samples/sample3.aspx)]

<span data-ttu-id="c9e6c-147">URL の静的な部分 (`ProductsForCategoryDetails.aspx?CategoryID`) が、文字列の連結を使用してデータバインド構文内の `Eval("CategoryID")` の結果に直接追加されることに注意してください。</span><span class="sxs-lookup"><span data-stu-id="c9e6c-147">Note how the static portion of the URL — `ProductsForCategoryDetails.aspx?CategoryID` — is appended to the result of `Eval("CategoryID")` directly within the databinding syntax using string concatenation.</span></span>

<span data-ttu-id="c9e6c-148">HyperLink コントロールを使用する利点の1つは、必要に応じて、Repeater の `ItemDataBound` イベントハンドラーからプログラムでアクセスできることです。</span><span class="sxs-lookup"><span data-stu-id="c9e6c-148">One benefit of using the HyperLink control is that it can be programmatically accessed from the Repeater's `ItemDataBound` event handler, if needed.</span></span> <span data-ttu-id="c9e6c-149">たとえば、商品が関連付けられていないカテゴリのリンクとしてではなく、カテゴリ名をテキストとして表示することができます。</span><span class="sxs-lookup"><span data-stu-id="c9e6c-149">For example, you might want to display the category name as text rather than as a link for categories with no associated products.</span></span> <span data-ttu-id="c9e6c-150">このようなチェックは、プログラムで `ItemDataBound` イベントハンドラーで実行できます。製品が関連付けられていないカテゴリの場合、ハイパーリンクの `NavigateUrl` プロパティを空の文字列に設定すると、その結果、特定のカテゴリ名がリンクとしてではなくプレーンテキストとして表示される可能性があります。</span><span class="sxs-lookup"><span data-stu-id="c9e6c-150">Such a check could be programmatically performed in the `ItemDataBound` event handler; for categories with no associated products, the HyperLink's `NavigateUrl` property could be set to a blank string, thereby resulting in that particular category name rendering as plain text (rather than as a link).</span></span> <span data-ttu-id="c9e6c-151">`ItemDataBound` イベントハンドラーを使用してプログラムロジックに基づいて DataList と Repeater の内容を書式設定する方法の詳細については、「[データに基づいて datalist と repeater を書式設定](../displaying-data-with-the-datalist-and-repeater/formatting-the-datalist-and-repeater-based-upon-data-vb.md)する」のチュートリアルを参照してください。</span><span class="sxs-lookup"><span data-stu-id="c9e6c-151">Refer back to the [Formatting the DataList and Repeater Based Upon Data](../displaying-data-with-the-datalist-and-repeater/formatting-the-datalist-and-repeater-based-upon-data-vb.md) tutorial for more information on formatting the DataList and Repeater's contents based on programmatic logic through the `ItemDataBound` event handler.</span></span>

<span data-ttu-id="c9e6c-152">フォローしている場合は、ページでアンカー要素またはハイパーリンクコントロールのいずれかの方法を自由に使用できます。</span><span class="sxs-lookup"><span data-stu-id="c9e6c-152">If you are following along, feel free to use either the anchor element or HyperLink control approach in your page.</span></span> <span data-ttu-id="c9e6c-153">方法に関係なく、ブラウザーを使用してページを表示する場合は、各カテゴリ名を `ProductsForCategoryDetails.aspx`へのリンクとしてレンダリングし、該当する `CategoryID` 値を渡す必要があります (図3を参照)。</span><span class="sxs-lookup"><span data-stu-id="c9e6c-153">Regardless of the approach, when viewing the page through a browser each category name should be rendered as a link to `ProductsForCategoryDetails.aspx`, passing in the applicable `CategoryID` value (see Figure 3).</span></span>

<span data-ttu-id="c9e6c-154">[カテゴリ名を ![して、製品のカテゴリの詳細にリンクします。](master-detail-filtering-acess-two-pages-datalist-vb/_static/image8.png)](master-detail-filtering-acess-two-pages-datalist-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="c9e6c-154">[![The Category Names Now Link to ProductsForCategoryDetails.aspx](master-detail-filtering-acess-two-pages-datalist-vb/_static/image8.png)](master-detail-filtering-acess-two-pages-datalist-vb/_static/image7.png)</span></span>

<span data-ttu-id="c9e6c-155">**図 3**: カテゴリ名が `ProductsForCategoryDetails.aspx` にリンクされる ([クリックすると、フルサイズの画像が表示](master-detail-filtering-acess-two-pages-datalist-vb/_static/image9.png)されます)</span><span class="sxs-lookup"><span data-stu-id="c9e6c-155">**Figure 3**: The Category Names Now Link to `ProductsForCategoryDetails.aspx` ([Click to view full-size image](master-detail-filtering-acess-two-pages-datalist-vb/_static/image9.png))</span></span>

## <a name="step-3-listing-the-products-that-belong-to-the-selected-category"></a><span data-ttu-id="c9e6c-156">手順 3: 選択したカテゴリに属する製品を一覧表示する</span><span class="sxs-lookup"><span data-stu-id="c9e6c-156">Step 3: Listing the Products that Belong to the Selected Category</span></span>

<span data-ttu-id="c9e6c-157">`CategoryListMaster.aspx` のページが完成したら、[詳細] ページの `ProductsForCategoryDetails.aspx`を実装することに注意する必要があります。</span><span class="sxs-lookup"><span data-stu-id="c9e6c-157">With the `CategoryListMaster.aspx` page complete, we're ready to turn our attention to implementing the "details" page, `ProductsForCategoryDetails.aspx`.</span></span> <span data-ttu-id="c9e6c-158">このページを開き、ツールボックスから DataList をデザイナーにドラッグし、その `ID` プロパティを `ProductsInCategory`に設定します。</span><span class="sxs-lookup"><span data-stu-id="c9e6c-158">Open this page, drag a DataList from the Toolbox onto the Designer, and set its `ID` property to `ProductsInCategory`.</span></span> <span data-ttu-id="c9e6c-159">次に、DataList のスマートタグから、ページに新しい ObjectDataSource を追加して、`ProductsInCategoryDataSource`名前を付けます。</span><span class="sxs-lookup"><span data-stu-id="c9e6c-159">Next, from the DataList's smart tag choose to add a new ObjectDataSource to the page, naming it `ProductsInCategoryDataSource`.</span></span> <span data-ttu-id="c9e6c-160">`ProductsBLL` クラスの `GetProductsByCategoryID(categoryID)` メソッドを呼び出すように構成します。[挿入]、[更新]、および [削除] の各タブのドロップダウンリストを [(なし)] に設定します。</span><span class="sxs-lookup"><span data-stu-id="c9e6c-160">Configure it such that it calls the `ProductsBLL` class's `GetProductsByCategoryID(categoryID)` method; set the drop-down lists in the INSERT, UPDATE, and DELETE tabs to (None).</span></span>

<span data-ttu-id="c9e6c-161">[製品の Bll クラスの Get$ Bycategoryid (categoryID) メソッドを使用するように ObjectDataSource を構成 ![](master-detail-filtering-acess-two-pages-datalist-vb/_static/image11.png)](master-detail-filtering-acess-two-pages-datalist-vb/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="c9e6c-161">[![Configure the ObjectDataSource to Use the ProductsBLL Class's GetProductsByCategoryID(categoryID) Method](master-detail-filtering-acess-two-pages-datalist-vb/_static/image11.png)](master-detail-filtering-acess-two-pages-datalist-vb/_static/image10.png)</span></span>

<span data-ttu-id="c9e6c-162">**図 4**: `ProductsBLL` クラスの `GetProductsByCategoryID(categoryID)` メソッドを使用するように ObjectDataSource を構成する ([クリックしてフルサイズのイメージを表示する](master-detail-filtering-acess-two-pages-datalist-vb/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="c9e6c-162">**Figure 4**: Configure the ObjectDataSource to Use the `ProductsBLL` Class's `GetProductsByCategoryID(categoryID)` Method ([Click to view full-size image](master-detail-filtering-acess-two-pages-datalist-vb/_static/image12.png))</span></span>

<span data-ttu-id="c9e6c-163">`GetProductsByCategoryID(categoryID)` メソッドは入力パラメーター ( *`categoryID`* ) を受け入れるため、データソースの選択ウィザードでは、パラメーターのソースを指定することができます。</span><span class="sxs-lookup"><span data-stu-id="c9e6c-163">Since the `GetProductsByCategoryID(categoryID)` method accepts an input parameter (*`categoryID`*), the Choose Data Source wizard offers us an opportunity to specify the parameter's source.</span></span> <span data-ttu-id="c9e6c-164">QueryStringField `CategoryID`を使用して、パラメーターソースを QueryString に設定します。</span><span class="sxs-lookup"><span data-stu-id="c9e6c-164">Set the parameter source to QueryString using the QueryStringField `CategoryID`.</span></span>

<span data-ttu-id="c9e6c-165">[パラメーターのソースとして Querystring フィールド CategoryID を使用 ![](master-detail-filtering-acess-two-pages-datalist-vb/_static/image14.png)](master-detail-filtering-acess-two-pages-datalist-vb/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="c9e6c-165">[![Use the Querystring Field CategoryID as the Parameter's Source](master-detail-filtering-acess-two-pages-datalist-vb/_static/image14.png)](master-detail-filtering-acess-two-pages-datalist-vb/_static/image13.png)</span></span>

<span data-ttu-id="c9e6c-166">**図 5**: クエリ文字列フィールド `CategoryID` をパラメーターのソースとして使用する ([クリックすると、フルサイズの画像が表示](master-detail-filtering-acess-two-pages-datalist-vb/_static/image15.png)されます)</span><span class="sxs-lookup"><span data-stu-id="c9e6c-166">**Figure 5**: Use the Querystring Field `CategoryID` as the Parameter's Source ([Click to view full-size image](master-detail-filtering-acess-two-pages-datalist-vb/_static/image15.png))</span></span>

<span data-ttu-id="c9e6c-167">前のチュートリアルで見たように、データソースの選択ウィザードを完了すると、Visual Studio によって、各データフィールドの名前と値を一覧表示する DataList の `ItemTemplate` が自動的に作成されます。</span><span class="sxs-lookup"><span data-stu-id="c9e6c-167">As we've seen in previous tutorials, after completing the Choose Data Source wizard, Visual Studio automatically creates an `ItemTemplate` for the DataList that lists each data field name and value.</span></span> <span data-ttu-id="c9e6c-168">このテンプレートを、製品の名前、供給業者、価格のみを一覧表示するものに置き換えます。</span><span class="sxs-lookup"><span data-stu-id="c9e6c-168">Replace this template with one that lists only the product's name, supplier, and price.</span></span> <span data-ttu-id="c9e6c-169">また、DataList の `RepeatColumns` プロパティを2に設定します。</span><span class="sxs-lookup"><span data-stu-id="c9e6c-169">Also, set the DataList's `RepeatColumns` property to 2.</span></span> <span data-ttu-id="c9e6c-170">これらの変更が完了すると、DataList および ObjectDataSource の宣言型マークアップは次のようになります。</span><span class="sxs-lookup"><span data-stu-id="c9e6c-170">After these changes, your DataList and ObjectDataSource's declarative markup should look similar to the following:</span></span>

[!code-aspx[Main](master-detail-filtering-acess-two-pages-datalist-vb/samples/sample4.aspx)]

<span data-ttu-id="c9e6c-171">このページを実際に表示するには、[`CategoryListMaster.aspx`] ページから開始します。次に、[カテゴリ] 箇条書きのリンクをクリックします。</span><span class="sxs-lookup"><span data-stu-id="c9e6c-171">To view this page in action, start from the `CategoryListMaster.aspx` page; next, click on a link in the categories bulleted list.</span></span> <span data-ttu-id="c9e6c-172">これにより、`ProductsForCategoryDetails.aspx`に移動し、クエリ文字列を使用して `CategoryID` を渡します。</span><span class="sxs-lookup"><span data-stu-id="c9e6c-172">Doing so will take you to `ProductsForCategoryDetails.aspx`, passing along the `CategoryID` through the querystring.</span></span> <span data-ttu-id="c9e6c-173">`ProductsForCategoryDetails.aspx` の `ProductsInCategoryDataSource` ObjectDataSource は、指定されたカテゴリの製品だけを取得し、それを DataList に表示します。これにより、行ごとに2つの製品がレンダリングされます。</span><span class="sxs-lookup"><span data-stu-id="c9e6c-173">The `ProductsInCategoryDataSource` ObjectDataSource in `ProductsForCategoryDetails.aspx` will then get just those products for the specified category and display them in the DataList, which renders two products per row.</span></span> <span data-ttu-id="c9e6c-174">図6は、飲み物を表示するときに `ProductsForCategoryDetails.aspx` のスクリーンショットを示しています。</span><span class="sxs-lookup"><span data-stu-id="c9e6c-174">Figure 6 shows a screenshot of `ProductsForCategoryDetails.aspx` when viewing the Beverages.</span></span>

<span data-ttu-id="c9e6c-175">[飲み物が表示される ![、行ごとに2つ](master-detail-filtering-acess-two-pages-datalist-vb/_static/image17.png)](master-detail-filtering-acess-two-pages-datalist-vb/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="c9e6c-175">[![The Beverages are Displayed, Two per Row](master-detail-filtering-acess-two-pages-datalist-vb/_static/image17.png)](master-detail-filtering-acess-two-pages-datalist-vb/_static/image16.png)</span></span>

<span data-ttu-id="c9e6c-176">**図 6**: 飲み物が表示され、行ごとに2つ ([クリックすると、フルサイズの画像が表示](master-detail-filtering-acess-two-pages-datalist-vb/_static/image18.png)されます)</span><span class="sxs-lookup"><span data-stu-id="c9e6c-176">**Figure 6**: The Beverages are Displayed, Two per Row ([Click to view full-size image](master-detail-filtering-acess-two-pages-datalist-vb/_static/image18.png))</span></span>

## <a name="step-4-displaying-category-information-on-productsforcategorydetailsaspx"></a><span data-ttu-id="c9e6c-177">手順 4: 製品のカテゴリ情報を表示する詳細 .aspx</span><span class="sxs-lookup"><span data-stu-id="c9e6c-177">Step 4: Displaying Category Information on ProductsForCategoryDetails.aspx</span></span>

<span data-ttu-id="c9e6c-178">ユーザーが `CategoryListMaster.aspx`でカテゴリをクリックすると、選択したカテゴリに属する製品が `ProductsForCategoryDetails.aspx` に表示されます。</span><span class="sxs-lookup"><span data-stu-id="c9e6c-178">When a user clicks on a category in `CategoryListMaster.aspx`, they are taken to `ProductsForCategoryDetails.aspx` and shown the products that belong to the selected category.</span></span> <span data-ttu-id="c9e6c-179">ただし `ProductsForCategoryDetails.aspx` では、どのカテゴリが選択されたかについての視覚的な手掛かりはありません。</span><span class="sxs-lookup"><span data-stu-id="c9e6c-179">However, in `ProductsForCategoryDetails.aspx` there are no visual cues as to what category was selected.</span></span> <span data-ttu-id="c9e6c-180">[飲み物] をクリックしたが、誤って Condiments をクリックしたユーザーは、`ProductsForCategoryDetails.aspx`になると誤ってその間違いを認識することはできません。</span><span class="sxs-lookup"><span data-stu-id="c9e6c-180">A user that meant to click Beverages, but accidentally clicked Condiments, has no way of realizing their mistake once they reach `ProductsForCategoryDetails.aspx`.</span></span> <span data-ttu-id="c9e6c-181">この潜在的な問題を軽減するには、[`ProductsForCategoryDetails.aspx`] ページの上部にある、選択したカテゴリ (名前と説明) に関する情報を表示します。</span><span class="sxs-lookup"><span data-stu-id="c9e6c-181">To alleviate this potential problem, we can display information about the selected category — its name and description — at the top of the `ProductsForCategoryDetails.aspx` page.</span></span>

<span data-ttu-id="c9e6c-182">これを実現するには、`ProductsForCategoryDetails.aspx`で Repeater コントロールの上に FormView を追加します。</span><span class="sxs-lookup"><span data-stu-id="c9e6c-182">To accomplish this, add a FormView above the Repeater control in `ProductsForCategoryDetails.aspx`.</span></span> <span data-ttu-id="c9e6c-183">次に、`CategoryDataSource` という名前の FormView のスマートタグからページに新しい ObjectDataSource を追加し、`CategoriesBLL` クラスの `GetCategoryByCategoryID(categoryID)` メソッドを使用するように構成します。</span><span class="sxs-lookup"><span data-stu-id="c9e6c-183">Next, add a new ObjectDataSource to the page from the FormView's smart tag named `CategoryDataSource` and configure it to use the `CategoriesBLL` class's `GetCategoryByCategoryID(categoryID)` method.</span></span>

<span data-ttu-id="c9e6c-184">[カテゴリ Bll クラスの Getcategory Bycategoryid (categoryID) メソッドを使用して、カテゴリに関する情報にアクセス ![](master-detail-filtering-acess-two-pages-datalist-vb/_static/image20.png)](master-detail-filtering-acess-two-pages-datalist-vb/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="c9e6c-184">[![Access Information about the Category through the CategoriesBLL Class's GetCategoryByCategoryID(categoryID) Method](master-detail-filtering-acess-two-pages-datalist-vb/_static/image20.png)](master-detail-filtering-acess-two-pages-datalist-vb/_static/image19.png)</span></span>

<span data-ttu-id="c9e6c-185">**図 7**: `CategoriesBLL` クラスの `GetCategoryByCategoryID(categoryID)` メソッドを使用してカテゴリに関する情報にアクセス[する (クリックすると、フルサイズの画像が表示](master-detail-filtering-acess-two-pages-datalist-vb/_static/image21.png)されます)</span><span class="sxs-lookup"><span data-stu-id="c9e6c-185">**Figure 7**: Access Information about the Category through the `CategoriesBLL` Class's `GetCategoryByCategoryID(categoryID)` Method ([Click to view full-size image](master-detail-filtering-acess-two-pages-datalist-vb/_static/image21.png))</span></span>

<span data-ttu-id="c9e6c-186">手順 3. で追加した `ProductsInCategoryDataSource` ObjectDataSource と同様に、`CategoryDataSource`のデータソース構成ウィザードによって、`GetCategoryByCategoryID(categoryID)` メソッドの入力パラメーターのソースが要求されます。</span><span class="sxs-lookup"><span data-stu-id="c9e6c-186">As with the `ProductsInCategoryDataSource` ObjectDataSource added in Step 3, the `CategoryDataSource`'s Configure Data Source wizard prompts us for a source for the `GetCategoryByCategoryID(categoryID)` method's input parameter.</span></span> <span data-ttu-id="c9e6c-187">以前とまったく同じ設定を使用し、パラメーターソースを QueryString に、QueryStringField 値を `CategoryID` に設定します (図5を参照)。</span><span class="sxs-lookup"><span data-stu-id="c9e6c-187">Use the exact same settings as before, setting the parameter source to QueryString and the QueryStringField value to `CategoryID` (refer back to Figure 5).</span></span>

<span data-ttu-id="c9e6c-188">ウィザードを完了すると、Visual Studio によって、FormView の `ItemTemplate`、`EditItemTemplate`、および `InsertItemTemplate` が自動的に作成されます。</span><span class="sxs-lookup"><span data-stu-id="c9e6c-188">After completing the wizard, Visual Studio automatically creates an `ItemTemplate`, `EditItemTemplate`, and `InsertItemTemplate` for the FormView.</span></span> <span data-ttu-id="c9e6c-189">読み取り専用のインターフェイスを提供しているので、`EditItemTemplate` と `InsertItemTemplate`を削除してもかまいません。</span><span class="sxs-lookup"><span data-stu-id="c9e6c-189">Since we're providing a read-only interface, feel free to remove the `EditItemTemplate` and `InsertItemTemplate`.</span></span> <span data-ttu-id="c9e6c-190">また、FormView の `ItemTemplate`を自由にカスタマイズすることもできます。</span><span class="sxs-lookup"><span data-stu-id="c9e6c-190">Also, feel free to customize the FormView's `ItemTemplate`.</span></span> <span data-ttu-id="c9e6c-191">余分なテンプレートを削除し、ItemTemplate をカスタマイズした後、FormView および ObjectDataSource の宣言型マークアップは次のようになります。</span><span class="sxs-lookup"><span data-stu-id="c9e6c-191">After removing the superfluous templates and customizing the ItemTemplate, your FormView and ObjectDataSource's declarative markup should look similar to the following:</span></span>

[!code-aspx[Main](master-detail-filtering-acess-two-pages-datalist-vb/samples/sample5.aspx)]

<span data-ttu-id="c9e6c-192">図8は、ブラウザーを使用してこのページを表示する際のスクリーンショットを示しています。</span><span class="sxs-lookup"><span data-stu-id="c9e6c-192">Figure 8 shows a screen shot when viewing this page through a browser.</span></span>

> [!NOTE]
> <span data-ttu-id="c9e6c-193">FormView に加えて、ユーザーがカテゴリの一覧 (`CategoryListMaster.aspx`) に戻るように、FormView の上に HyperLink コントロールも追加しました。</span><span class="sxs-lookup"><span data-stu-id="c9e6c-193">In addition to the FormView, I've also added a HyperLink control above the FormView that will take the user back to the list of categories (`CategoryListMaster.aspx`).</span></span> <span data-ttu-id="c9e6c-194">このリンクを他の場所に配置するか、完全に省略することをお勧めします。</span><span class="sxs-lookup"><span data-stu-id="c9e6c-194">Feel free to place this link elsewhere or to omit it altogether.</span></span>

<span data-ttu-id="c9e6c-195">[![カテゴリ情報がページの上部に表示されるようになりました](master-detail-filtering-acess-two-pages-datalist-vb/_static/image23.png)](master-detail-filtering-acess-two-pages-datalist-vb/_static/image22.png)</span><span class="sxs-lookup"><span data-stu-id="c9e6c-195">[![Category Information is Now Displayed at the Top of the Page](master-detail-filtering-acess-two-pages-datalist-vb/_static/image23.png)](master-detail-filtering-acess-two-pages-datalist-vb/_static/image22.png)</span></span>

<span data-ttu-id="c9e6c-196">**図 8**: カテゴリ情報がページの上部に表示されるようになりました ([クリックすると、フルサイズの画像が表示](master-detail-filtering-acess-two-pages-datalist-vb/_static/image24.png)されます)</span><span class="sxs-lookup"><span data-stu-id="c9e6c-196">**Figure 8**: Category Information is Now Displayed at the Top of the Page ([Click to view full-size image](master-detail-filtering-acess-two-pages-datalist-vb/_static/image24.png))</span></span>

## <a name="step-5-displaying-a-message-if-no-products-belong-to-the-selected-category"></a><span data-ttu-id="c9e6c-197">手順 5: 選択したカテゴリに属している製品がない場合にメッセージを表示する</span><span class="sxs-lookup"><span data-stu-id="c9e6c-197">Step 5: Displaying a Message if No Products Belong to the Selected Category</span></span>

<span data-ttu-id="c9e6c-198">[`CategoryListMaster.aspx`] ページには、関連付けられている製品があるかどうかに関係なく、システム内のすべてのカテゴリが一覧表示されます。</span><span class="sxs-lookup"><span data-stu-id="c9e6c-198">The `CategoryListMaster.aspx` page lists all categories in the system, regardless of whether there are any associated products.</span></span> <span data-ttu-id="c9e6c-199">製品が関連付けられていないカテゴリをユーザーがクリックした場合、そのデータソースには項目が含まれていないため、`ProductsForCategoryDetails.aspx` の DataList はレンダリングされません。</span><span class="sxs-lookup"><span data-stu-id="c9e6c-199">If a user clicks on a category with no associated products, the DataList in `ProductsForCategoryDetails.aspx` will not be rendered, as its data source will not have any items.</span></span> <span data-ttu-id="c9e6c-200">これまでのチュートリアルで説明したように、GridView には、データソースにレコードが存在しない場合に表示するテキストメッセージを指定するために使用できる `EmptyDataText` のプロパティが用意されています。</span><span class="sxs-lookup"><span data-stu-id="c9e6c-200">As we've seen in past tutorials, the GridView provides an `EmptyDataText` property that can be used to specify a text message to display if there are no records in its data source.</span></span> <span data-ttu-id="c9e6c-201">残念ながら、DataList も Repeater もこのようなプロパティを持っていません。</span><span class="sxs-lookup"><span data-stu-id="c9e6c-201">Unfortunately, neither the DataList nor Repeater has such a property.</span></span>

<span data-ttu-id="c9e6c-202">選択したカテゴリに一致する製品がないことをユーザーに通知するメッセージを表示するには、対応する製品がない場合に表示するメッセージが `Text` プロパティに割り当てられているページにラベルコントロールを追加する必要があります。</span><span class="sxs-lookup"><span data-stu-id="c9e6c-202">In order to display a message informing the user that there are no matching products for the selected category, we need to add a Label control to the page whose `Text` property is assigned the message to display in the event that there are no matching products.</span></span> <span data-ttu-id="c9e6c-203">次に、DataList に項目が含まれているかどうかに基づいて、プログラムによって `Visible` プロパティを設定する必要があります。</span><span class="sxs-lookup"><span data-stu-id="c9e6c-203">We then need to programmatically set its `Visible` property based on whether or not the DataList contains any items.</span></span>

<span data-ttu-id="c9e6c-204">これを実現するには、まず、DataList の下にラベルを追加します。</span><span class="sxs-lookup"><span data-stu-id="c9e6c-204">To accomplish this, start by adding a Label beneath the DataList.</span></span> <span data-ttu-id="c9e6c-205">`ID` プロパティを `NoProductsMessage` に設定し、その `Text` プロパティを "選択したカテゴリの製品がありません..." に設定します。次に、データが `ProductsInCategory` DataList にバインドされているかどうかに基づいて、このラベルの `Visible` プロパティをプログラムで設定する必要があります。</span><span class="sxs-lookup"><span data-stu-id="c9e6c-205">Set its `ID` property to `NoProductsMessage` and its `Text` property to "There are no products for the selected category…" Next, we need to programmatically set this Label's `Visible` property based on whether or not any data was bound to the `ProductsInCategory` DataList.</span></span> <span data-ttu-id="c9e6c-206">この割り当ては、データが DataList にバインドされた後に行う必要があります。</span><span class="sxs-lookup"><span data-stu-id="c9e6c-206">This assignment must be made after the data has been bound to the DataList.</span></span> <span data-ttu-id="c9e6c-207">GridView、DetailsView、および FormView では、コントロールの `DataBound` イベントのイベントハンドラーを作成できます。これは、データバインドが完了した後に発生します。</span><span class="sxs-lookup"><span data-stu-id="c9e6c-207">For the GridView, DetailsView, and FormView, we could create an event handler for the control's `DataBound` event, which fires after databinding has completed.</span></span> <span data-ttu-id="c9e6c-208">ただし、DataList も Repeater も `DataBound` イベントは使用できません。</span><span class="sxs-lookup"><span data-stu-id="c9e6c-208">However, neither the DataList nor the Repeater has a `DataBound` event available.</span></span>

<span data-ttu-id="c9e6c-209">この例では、ページの `Load` イベントの前に DataList にデータが割り当てられているため、`Page_Load` イベントハンドラーでラベルの `Visible` プロパティを割り当てることができます。</span><span class="sxs-lookup"><span data-stu-id="c9e6c-209">For this particular example we can assign the Label's `Visible` property in the `Page_Load` event handler, since the data will have been assigned to the DataList prior to the page's `Load` event.</span></span> <span data-ttu-id="c9e6c-210">ただし、この方法は一般的なケースでは機能しません。これは、ObjectDataSource からのデータが、後でページのライフサイクルの DataList にバインドされる可能性があるためです。</span><span class="sxs-lookup"><span data-stu-id="c9e6c-210">However, this approach would not work in the general case, as the data from the ObjectDataSource might be bound to the DataList later in the page's lifecycle.</span></span> <span data-ttu-id="c9e6c-211">たとえば、表示されたデータが別のコントロールの値に基づいている場合 (たとえば、DropDownList を使用してマスター/詳細レポートを表示し、"マスター" レコードを保持する場合など)、データはページのライフサイクルの `PreRender` 段階まで、データ Web コントロールに再バインドされない可能性があります。</span><span class="sxs-lookup"><span data-stu-id="c9e6c-211">For example, if the displayed data is based upon the value in another control, such as it is when displaying a master/detail report using a DropDownList to hold the "master" records, the data may not rebound to the data Web control until the `PreRender` stage in the page's life cycle.</span></span>

<span data-ttu-id="c9e6c-212">どのような場合でも機能する1つの解決策は、`Item` または `AlternatingItem`の項目の種類をバインドするときに、DataList の `ItemDataBound` (または `ItemCreated`) イベントハンドラーの `False` に `Visible` プロパティを割り当てることです。</span><span class="sxs-lookup"><span data-stu-id="c9e6c-212">One solution which will work for all cases is to assign the `Visible` property to `False` in the DataList's `ItemDataBound` (or `ItemCreated`) event handler when binding an item type of `Item` or `AlternatingItem`.</span></span> <span data-ttu-id="c9e6c-213">このような場合は、データソースに少なくとも1つのデータ項目があることがわかっているため、`NoProductsMessage` ラベルを非表示にすることができます。</span><span class="sxs-lookup"><span data-stu-id="c9e6c-213">In such a case we know that there is at least one data item in the data source and therefore can hide the `NoProductsMessage` Label.</span></span> <span data-ttu-id="c9e6c-214">このイベントハンドラーに加えて、DataList の `DataBinding` イベントのイベントハンドラーも必要です。ここでは、ラベルの `Visible` プロパティを `True`に初期化します。</span><span class="sxs-lookup"><span data-stu-id="c9e6c-214">In addition to this event handler, we also need an event handler for the DataList's `DataBinding` event, where we initialize the Label's `Visible` property to `True`.</span></span> <span data-ttu-id="c9e6c-215">`DataBinding` イベントは `ItemDataBound` イベントの前に発生するため、ラベルの `Visible` プロパティは最初は `True`に設定されます。ただし、データ項目がある場合は、`False`に設定されます。</span><span class="sxs-lookup"><span data-stu-id="c9e6c-215">Since the `DataBinding` event fires before the `ItemDataBound` events, the Label's `Visible` property will initially be set to `True`; if there are any data items, however, it will be set to `False`.</span></span> <span data-ttu-id="c9e6c-216">次のコードは、このロジックを実装しています。</span><span class="sxs-lookup"><span data-stu-id="c9e6c-216">The following code implements this logic:</span></span>

[!code-vb[Main](master-detail-filtering-acess-two-pages-datalist-vb/samples/sample6.vb)]

<span data-ttu-id="c9e6c-217">Northwind データベースのすべてのカテゴリは、1つまたは複数の製品に関連付けられています。</span><span class="sxs-lookup"><span data-stu-id="c9e6c-217">All of the categories in the Northwind database are associated with one or more products.</span></span> <span data-ttu-id="c9e6c-218">この機能をテストするには、このチュートリアルで Northwind データベースを手動で調整し、[生成] カテゴリに関連付けられているすべての製品 (`CategoryID` = 7) をシーフードカテゴリ (`CategoryID` = 8) に再割り当てします。</span><span class="sxs-lookup"><span data-stu-id="c9e6c-218">To test this feature, I've manually adjusted the Northwind database for this tutorial, reassigning all products associated with the Produce category (`CategoryID` = 7) to the Seafood category (`CategoryID` = 8).</span></span> <span data-ttu-id="c9e6c-219">これを行うには、[新しいクエリ] を選択し、次の `UPDATE` ステートメントを使用して、サーバーエクスプローラーを実行します。</span><span class="sxs-lookup"><span data-stu-id="c9e6c-219">This can be accomplished from the Server Explorer by choosing New Query and using the following `UPDATE` statement:</span></span>

[!code-sql[Main](master-detail-filtering-acess-two-pages-datalist-vb/samples/sample7.sql)]

<span data-ttu-id="c9e6c-220">必要に応じてデータベースを更新した後、[`CategoryListMaster.aspx`] ページに戻り、[生成] リンクをクリックします。</span><span class="sxs-lookup"><span data-stu-id="c9e6c-220">After updating the database accordingly, return to the `CategoryListMaster.aspx` page and click on the Produce link.</span></span> <span data-ttu-id="c9e6c-221">生成カテゴリに属する製品はなくなったため、"選択したカテゴリの製品はありません..." と表示されます。メッセージ (図9を参照)。</span><span class="sxs-lookup"><span data-stu-id="c9e6c-221">Since there are no longer any products belonging to the Produce category, you should see the "There are no products for the selected category…" message, as shown in Figure 9.</span></span>

<span data-ttu-id="c9e6c-222">[選択したカテゴリに属する製品がない場合、メッセージが表示さ ![](master-detail-filtering-acess-two-pages-datalist-vb/_static/image26.png)](master-detail-filtering-acess-two-pages-datalist-vb/_static/image25.png)</span><span class="sxs-lookup"><span data-stu-id="c9e6c-222">[![A Message is Displayed if there are No Products Belonging to the Selected Category](master-detail-filtering-acess-two-pages-datalist-vb/_static/image26.png)](master-detail-filtering-acess-two-pages-datalist-vb/_static/image25.png)</span></span>

<span data-ttu-id="c9e6c-223">**図 9**: 選択したカテゴリに属する製品がない場合は、メッセージが表示されます ([クリックすると、フルサイズの画像が表示](master-detail-filtering-acess-two-pages-datalist-vb/_static/image27.png)されます)</span><span class="sxs-lookup"><span data-stu-id="c9e6c-223">**Figure 9**: A Message is Displayed if there are No Products Belonging to the Selected Category ([Click to view full-size image](master-detail-filtering-acess-two-pages-datalist-vb/_static/image27.png))</span></span>

## <a name="summary"></a><span data-ttu-id="c9e6c-224">まとめ</span><span class="sxs-lookup"><span data-stu-id="c9e6c-224">Summary</span></span>

<span data-ttu-id="c9e6c-225">マスター/詳細レポートでは、マスターレコードと詳細レコードの両方を1ページに表示できますが、多くの web サイトでは、2つの web ページに分割されています。</span><span class="sxs-lookup"><span data-stu-id="c9e6c-225">While master/detail reports can display both the master and detail records on a single page, in many websites they are separated out across two web pages.</span></span> <span data-ttu-id="c9e6c-226">このチュートリアルでは、マスター/詳細レポートを実装する方法について説明しました。これには、"マスター" web ページでリピータを使用し、[詳細] ページに一覧表示されている関連する製品を使用して、リストにカテゴリを表示します。</span><span class="sxs-lookup"><span data-stu-id="c9e6c-226">In this tutorial we looked at how to implement such a master/detail report by having the categories listed in a bulleted list using a Repeater in the "master" web page and the associated products listed in the "details" page.</span></span> <span data-ttu-id="c9e6c-227">マスター web ページの各リスト項目には、行の `CategoryID` 値に従って渡された詳細ページへのリンクが含まれていました。</span><span class="sxs-lookup"><span data-stu-id="c9e6c-227">Each list item in the master web page contained a link to the details page that passed along the row's `CategoryID` value.</span></span>

<span data-ttu-id="c9e6c-228">詳細ページでは、指定された業者のこれらの製品を取得するために、`ProductsBLL` クラスの `GetProductsByCategoryID(categoryID)` 方法を使用しました。</span><span class="sxs-lookup"><span data-stu-id="c9e6c-228">In the details page retrieving those products for the specified supplier was accomplished through the `ProductsBLL` class's `GetProductsByCategoryID(categoryID)` method.</span></span> <span data-ttu-id="c9e6c-229">*`categoryID`* パラメーターの値が、パラメーターソースとして `CategoryID` querystring の値を使用して宣言的に指定されました。</span><span class="sxs-lookup"><span data-stu-id="c9e6c-229">The *`categoryID`* parameter value was specified declaratively using the `CategoryID` querystring value as the parameter source.</span></span> <span data-ttu-id="c9e6c-230">また、FormView を使用して詳細ページにカテゴリの詳細を表示する方法と、選択したカテゴリに属している製品がない場合にメッセージを表示する方法についても説明しました。</span><span class="sxs-lookup"><span data-stu-id="c9e6c-230">We also looked at how to display category details in the details page using a FormView and how to display a message if there were no products belonging to the selected category.</span></span>

<span data-ttu-id="c9e6c-231">プログラミングを楽しんでください。</span><span class="sxs-lookup"><span data-stu-id="c9e6c-231">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="c9e6c-232">著者について</span><span class="sxs-lookup"><span data-stu-id="c9e6c-232">About the Author</span></span>

<span data-ttu-id="c9e6c-233">1998以来、 [Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml)は 7 asp/創設者 of [4GuysFromRolla.com](http://www.4guysfromrolla.com)の執筆者であり、Microsoft Web テクノロジを使用しています。</span><span class="sxs-lookup"><span data-stu-id="c9e6c-233">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="c9e6c-234">Scott は、独立したコンサルタント、トレーナー、およびライターとして機能します。</span><span class="sxs-lookup"><span data-stu-id="c9e6c-234">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="c9e6c-235">彼の最新の書籍は[ *、ASP.NET 2.0 を24時間以内に教え*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)ています。</span><span class="sxs-lookup"><span data-stu-id="c9e6c-235">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="c9e6c-236">mitchell@4GuysFromRolla.comでアクセスでき[ます。](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="c9e6c-236">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="c9e6c-237">または彼のブログを参照してください。これは[http://ScottOnWriting.NET](http://ScottOnWriting.NET)にあります。</span><span class="sxs-lookup"><span data-stu-id="c9e6c-237">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="c9e6c-238">ありがとうございました。</span><span class="sxs-lookup"><span data-stu-id="c9e6c-238">Special Thanks To…</span></span>

<span data-ttu-id="c9e6c-239">このチュートリアルシリーズは、役に立つ多くのレビュー担当者によってレビューされました。</span><span class="sxs-lookup"><span data-stu-id="c9e6c-239">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="c9e6c-240">このチュートリアルのリードレビュー担当者は、Zack Jones と Liz Shulok でした。</span><span class="sxs-lookup"><span data-stu-id="c9e6c-240">Lead reviewers for this tutorial were Zack Jones and Liz Shulok.</span></span> <span data-ttu-id="c9e6c-241">今後の MSDN 記事を確認することに興味がありますか?</span><span class="sxs-lookup"><span data-stu-id="c9e6c-241">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="c9e6c-242">その場合は、mitchell@4GuysFromRolla.comの行を削除[します。](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="c9e6c-242">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="c9e6c-243">[前へ](master-detail-filtering-with-a-dropdownlist-datalist-vb.md)
> [次へ](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb.md)</span><span class="sxs-lookup"><span data-stu-id="c9e6c-243">[Previous](master-detail-filtering-with-a-dropdownlist-datalist-vb.md)
[Next](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb.md)</span></span>

---
uid: web-forms/overview/data-access/advanced-data-access-scenarios/working-with-computed-columns-cs
title: 計算列を使用するC#() |Microsoft Docs
author: rick-anderson
description: Microsoft SQL Server では、データベーステーブルを作成するときに、通常は、式から計算される値を持つ計算列を定義できます。
ms.author: riande
ms.date: 08/03/2007
ms.assetid: 57459065-ed7c-4dfe-ac9c-54c093abc261
msc.legacyurl: /web-forms/overview/data-access/advanced-data-access-scenarios/working-with-computed-columns-cs
msc.type: authoredcontent
ms.openlocfilehash: ad6a96f2721510c2478f707c8eed018ae797f27a
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 03/06/2020
ms.locfileid: "78427120"
---
# <a name="working-with-computed-columns-c"></a><span data-ttu-id="0f794-103">計算列を使用する (C#)</span><span class="sxs-lookup"><span data-stu-id="0f794-103">Working with Computed Columns (C#)</span></span>

<span data-ttu-id="0f794-104">[Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="0f794-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="0f794-105">[コードのダウンロード](https://download.microsoft.com/download/3/9/f/39f92b37-e92e-4ab3-909e-b4ef23d01aa3/ASPNET_Data_Tutorial_71_CS.zip)または[PDF のダウンロード](working-with-computed-columns-cs/_static/datatutorial71cs1.pdf)</span><span class="sxs-lookup"><span data-stu-id="0f794-105">[Download Code](https://download.microsoft.com/download/3/9/f/39f92b37-e92e-4ab3-909e-b4ef23d01aa3/ASPNET_Data_Tutorial_71_CS.zip) or [Download PDF](working-with-computed-columns-cs/_static/datatutorial71cs1.pdf)</span></span>

> <span data-ttu-id="0f794-106">Microsoft SQL Server では、データベーステーブルを作成するときに、同じデータベースレコード内の他の値を参照する式から値を計算する計算列を定義できます。</span><span class="sxs-lookup"><span data-stu-id="0f794-106">When creating a database table, Microsoft SQL Server allows you to define a computed column whose value is calculated from an expression that usually references other values in the same database record.</span></span> <span data-ttu-id="0f794-107">このような値はデータベースで読み取り専用であるため、Tableadapter を操作するときに特別な考慮が必要です。</span><span class="sxs-lookup"><span data-stu-id="0f794-107">Such values are read-only at the database, which requires special considerations when working with TableAdapters.</span></span> <span data-ttu-id="0f794-108">このチュートリアルでは、計算列によって生じる課題を満たす方法について説明します。</span><span class="sxs-lookup"><span data-stu-id="0f794-108">In this tutorial we learn how to meet the challenges posed by computed columns.</span></span>

## <a name="introduction"></a><span data-ttu-id="0f794-109">はじめに</span><span class="sxs-lookup"><span data-stu-id="0f794-109">Introduction</span></span>

<span data-ttu-id="0f794-110">Microsoft SQL Server では、 *[計算列](https://msdn.microsoft.com/library/ms191250.aspx)* を使用できます。これは、通常、同じテーブル内の他の列から値を参照する式から値が計算される列です。</span><span class="sxs-lookup"><span data-stu-id="0f794-110">Microsoft SQL Server allows for *[computed columns](https://msdn.microsoft.com/library/ms191250.aspx)*, which are columns whose values are calculated from an expression that usually references the values from other columns in the same table.</span></span> <span data-ttu-id="0f794-111">たとえば、時間追跡データモデルには、`ServicePerformed`、`EmployeeID`、`Rate`、`Duration`などの列を含む `ServiceLog` という名前のテーブルがある場合があります。</span><span class="sxs-lookup"><span data-stu-id="0f794-111">As an example, a time tracking data model might have a table named `ServiceLog` with columns including `ServicePerformed`, `EmployeeID`, `Rate`, and `Duration`, among others.</span></span> <span data-ttu-id="0f794-112">サービス項目あたりの使用量 (期間を乗算した値) は、web ページまたは他のプログラムインターフェイスを使用して計算できますが、この情報を報告した `AmountDue` という名前の `ServiceLog` テーブルに列を含めると便利な場合があります。</span><span class="sxs-lookup"><span data-stu-id="0f794-112">While the amount due per service item (being the rate multiplied by the duration) could be calculated through a web page or other programmatic interface, it might be handy to include a column in the `ServiceLog` table named `AmountDue` that reported this information.</span></span> <span data-ttu-id="0f794-113">この列は通常の列として作成できますが、`Rate` または `Duration` の列の値が変更された場合はいつでも更新する必要があります。</span><span class="sxs-lookup"><span data-stu-id="0f794-113">This column could be created as a normal column, but it would need to be updated anytime the `Rate` or `Duration` column values changed.</span></span> <span data-ttu-id="0f794-114">より適切な方法は、`Rate * Duration`式を使用して、`AmountDue` 列を計算列にすることです。</span><span class="sxs-lookup"><span data-stu-id="0f794-114">A better approach would be to make the `AmountDue` column a computed column using the expression `Rate * Duration`.</span></span> <span data-ttu-id="0f794-115">この操作を行うと、クエリで参照されたときに `AmountDue` 列の値が SQL Server によって自動的に計算されます。</span><span class="sxs-lookup"><span data-stu-id="0f794-115">Doing so would cause SQL Server to automatically calculate the `AmountDue` column value whenever it was referenced in a query.</span></span>

<span data-ttu-id="0f794-116">計算列の値は式によって決定されるため、このような列は読み取り専用であるため、`INSERT` または `UPDATE` のステートメントで値を代入することはできません。</span><span class="sxs-lookup"><span data-stu-id="0f794-116">Since a computed column s value is determined by an expression, such columns are read-only and therefore cannot have values assigned to them in `INSERT` or `UPDATE` statements.</span></span> <span data-ttu-id="0f794-117">ただし、アドホック SQL ステートメントを使用する TableAdapter のメインクエリに計算列が含まれている場合は、自動生成された `INSERT` および `UPDATE` ステートメントに自動的に含まれます。</span><span class="sxs-lookup"><span data-stu-id="0f794-117">However, when computed columns are part of the main query for a TableAdapter that uses ad-hoc SQL statements, they are automatically included in the auto-generated `INSERT` and `UPDATE` statements.</span></span> <span data-ttu-id="0f794-118">その結果、TableAdapter の `INSERT` と `UPDATE` クエリと `InsertCommand` および `UpdateCommand` プロパティを更新して、計算列への参照を削除する必要があります。</span><span class="sxs-lookup"><span data-stu-id="0f794-118">Consequently, the TableAdapter s `INSERT` and `UPDATE` queries and `InsertCommand` and `UpdateCommand` properties must be updated to remove references to any computed columns.</span></span>

<span data-ttu-id="0f794-119">アドホック SQL ステートメントを使用する TableAdapter で計算列を使用する場合の1つの問題は、tableadapter 構成ウィザードが完了するたびに、TableAdapter s `INSERT` および `UPDATE` クエリが自動的に再生成されることです。</span><span class="sxs-lookup"><span data-stu-id="0f794-119">One challenge of using computed columns with a TableAdapter that uses ad-hoc SQL statements is that the TableAdapter s `INSERT` and `UPDATE` queries are automatically regenerated any time the TableAdapter Configuration wizard is completed.</span></span> <span data-ttu-id="0f794-120">このため、計算列は `INSERT` から手動で削除され、ウィザードを再実行すると `UPDATE` クエリは再表示されます。</span><span class="sxs-lookup"><span data-stu-id="0f794-120">Therefore, the computed columns manually removed from the `INSERT` and `UPDATE` queries will reappear if the wizard is re-run.</span></span> <span data-ttu-id="0f794-121">ストアドプロシージャを使用する Tableadapter はこの高まるの影響を受けませんが、手順3で対処する独自の特性があります。</span><span class="sxs-lookup"><span data-stu-id="0f794-121">Although TableAdapters that use stored procedures don t suffer from this brittleness, they do have their own quirks that we will address in Step 3.</span></span>

<span data-ttu-id="0f794-122">このチュートリアルでは、Northwind データベースの `Suppliers` テーブルに計算列を追加し、対応する TableAdapter を作成して、このテーブルとその計算列を操作します。</span><span class="sxs-lookup"><span data-stu-id="0f794-122">In this tutorial we will add a computed column to the `Suppliers` table in the Northwind database and then create a corresponding TableAdapter to work with this table and its computed column.</span></span> <span data-ttu-id="0f794-123">Tableadapter 構成ウィザードの使用時にカスタマイズが失われないよう、アドホック SQL ステートメントではなくストアドプロシージャを使用します。</span><span class="sxs-lookup"><span data-stu-id="0f794-123">We will have our TableAdapter use stored procedures instead of ad-hoc SQL statements so that our customizations aren't lost when the TableAdapter Configuration wizard is used.</span></span>

<span data-ttu-id="0f794-124">始めましょう!</span><span class="sxs-lookup"><span data-stu-id="0f794-124">Let s get started!</span></span>

## <a name="step-1-adding-a-computed-column-to-thesupplierstable"></a><span data-ttu-id="0f794-125">手順 1:`Suppliers`テーブルに計算列を追加する</span><span class="sxs-lookup"><span data-stu-id="0f794-125">Step 1: Adding a Computed Column to the`Suppliers`Table</span></span>

<span data-ttu-id="0f794-126">Northwind データベースには計算列がないため、自分で追加する必要があります。</span><span class="sxs-lookup"><span data-stu-id="0f794-126">The Northwind database does not have any computed columns so we will need to add one ourselves.</span></span> <span data-ttu-id="0f794-127">このチュートリアルでは、`ContactName` (`ContactTitle`、`CompanyName`) の形式で、連絡先の名前、役職、および会社の勤務先を返す `FullContactName` という `Suppliers` テーブルに計算列を追加します。</span><span class="sxs-lookup"><span data-stu-id="0f794-127">For this tutorial let s add a computed column to the `Suppliers` table called `FullContactName` that returns the contact s name, title, and the company they work for in the following format: `ContactName` (`ContactTitle`, `CompanyName`).</span></span> <span data-ttu-id="0f794-128">この計算列は、仕入先に関する情報を表示するときにレポートで使用される場合があります。</span><span class="sxs-lookup"><span data-stu-id="0f794-128">This computed column might be used in reports when displaying information about suppliers.</span></span>

<span data-ttu-id="0f794-129">まず、サーバーエクスプローラーの `Suppliers` テーブルを右クリックし、コンテキストメニューから [テーブル定義を開く] を選択して `Suppliers` テーブル定義を開きます。</span><span class="sxs-lookup"><span data-stu-id="0f794-129">Start by opening the `Suppliers` table definition by right-clicking on the `Suppliers` table in the Server Explorer and choosing Open Table Definition from the context-menu.</span></span> <span data-ttu-id="0f794-130">これにより、テーブルの列とそのプロパティ (データ型、`NULL` が許可されているかどうかなど) が表示されます。</span><span class="sxs-lookup"><span data-stu-id="0f794-130">This will display the columns of the table and their properties, such as their data type, whether they allow `NULL` s, and so forth.</span></span> <span data-ttu-id="0f794-131">計算列を追加するには、まず、列の名前をテーブル定義に入力します。</span><span class="sxs-lookup"><span data-stu-id="0f794-131">To add a computed column, start by typing in the name of the column into the table definition.</span></span> <span data-ttu-id="0f794-132">次に、列プロパティウィンドウの [計算列の指定] セクションの [(式)] ボックスに式を入力します (図1を参照)。</span><span class="sxs-lookup"><span data-stu-id="0f794-132">Next, enter its expression into the (Formula) textbox under the Computed Column Specification section in the Column Properties window (see Figure 1).</span></span> <span data-ttu-id="0f794-133">計算列に `FullContactName` という名前を指定し、次の式を使用します。</span><span class="sxs-lookup"><span data-stu-id="0f794-133">Name the computed column `FullContactName` and use the following expression:</span></span>

[!code-sql[Main](working-with-computed-columns-cs/samples/sample1.sql)]

<span data-ttu-id="0f794-134">`+` 演算子を使用して、SQL で文字列を連結できることに注意してください。</span><span class="sxs-lookup"><span data-stu-id="0f794-134">Note that strings can be concatenated in SQL using the `+` operator.</span></span> <span data-ttu-id="0f794-135">`CASE` ステートメントは、従来のプログラミング言語の条件のように使用できます。</span><span class="sxs-lookup"><span data-stu-id="0f794-135">The `CASE` statement can be used like a conditional in a traditional programming language.</span></span> <span data-ttu-id="0f794-136">上の式では、`CASE` ステートメントをとして読み取ることができます。 `ContactTitle` が `NULL` ない場合は、`ContactTitle` 値をコンマで連結して出力します。それ以外の場合は、何も出力しません。</span><span class="sxs-lookup"><span data-stu-id="0f794-136">In the above expression the `CASE` statement can be read as: If `ContactTitle` is not `NULL` then output the `ContactTitle` value concatenated with a comma, otherwise emit nothing.</span></span> <span data-ttu-id="0f794-137">`CASE` ステートメントの有用性の詳細については、「 [SQL `CASE` ステートメントの機能](http://www.4guysfromrolla.com/webtech/102704-1.shtml)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="0f794-137">For more on the usefulness of the `CASE` statement, see [The Power of SQL `CASE` Statements](http://www.4guysfromrolla.com/webtech/102704-1.shtml).</span></span>

> [!NOTE]
> <span data-ttu-id="0f794-138">ここでは、`CASE` ステートメントを使用する代わりに、代わりに `ISNULL(ContactTitle, '')`を使用することもできます。</span><span class="sxs-lookup"><span data-stu-id="0f794-138">Instead of using a `CASE` statement here, we could have alternatively used `ISNULL(ContactTitle, '')`.</span></span> <span data-ttu-id="0f794-139">NULL 以外の場合、 [`ISNULL(checkExpression, replacementValue)`](https://msdn.microsoft.com/library/ms184325.aspx)は*checkexpression*を返します。それ以外の場合は、 *replacementValue*を返します。</span><span class="sxs-lookup"><span data-stu-id="0f794-139">[`ISNULL(checkExpression, replacementValue)`](https://msdn.microsoft.com/library/ms184325.aspx) returns *checkExpression* if it is non-NULL, otherwise it returns *replacementValue*.</span></span> <span data-ttu-id="0f794-140">このインスタンスでは `ISNULL` または `CASE` のいずれかを使用できますが、`CASE` ステートメントの柔軟性が `ISNULL`で一致しない複雑なシナリオがあります。</span><span class="sxs-lookup"><span data-stu-id="0f794-140">While either `ISNULL` or `CASE` will work in this instance, there are more intricate scenarios where the flexibility of the `CASE` statement cannot be matched by `ISNULL`.</span></span>

<span data-ttu-id="0f794-141">この計算列を追加すると、画面は図1のスクリーンショットのようになります。</span><span class="sxs-lookup"><span data-stu-id="0f794-141">After adding this computed column your screen should look like the screen shot in Figure 1.</span></span>

<span data-ttu-id="0f794-142">[FullContactName という名前の計算列を [仕入先テーブルに追加するには](working-with-computed-columns-cs/_static/image2.png)](working-with-computed-columns-cs/_static/image1.png)!</span><span class="sxs-lookup"><span data-stu-id="0f794-142">[![Add a Computed Column Named FullContactName to the Suppliers Table](working-with-computed-columns-cs/_static/image2.png)](working-with-computed-columns-cs/_static/image1.png)</span></span>

<span data-ttu-id="0f794-143">**図 1**: `FullContactName` という名前の計算列を `Suppliers` テーブルに追加[する (クリックすると、フルサイズの画像が表示](working-with-computed-columns-cs/_static/image3.png)されます)</span><span class="sxs-lookup"><span data-stu-id="0f794-143">**Figure 1**: Add a Computed Column Named `FullContactName` to the `Suppliers` Table ([Click to view full-size image](working-with-computed-columns-cs/_static/image3.png))</span></span>

<span data-ttu-id="0f794-144">計算列に名前を付け、その式を入力したら、ツールバーの [保存] アイコンをクリックするか、Ctrl キーを押しながら S キーを押すか、または [ファイル] メニューに移動して [`Suppliers`の保存] をクリックして、テーブルへの変更を保存します。</span><span class="sxs-lookup"><span data-stu-id="0f794-144">After naming the computed column and entering its expression, save the changes to the table by clicking the Save icon in the toolbar, by hitting Ctrl+S, or by going to the File menu and choosing Save `Suppliers`.</span></span>

<span data-ttu-id="0f794-145">テーブルを保存すると、[`Suppliers` table s 列] ボックスの一覧にある [追加] 列を含むサーバーエクスプローラーが更新されます。</span><span class="sxs-lookup"><span data-stu-id="0f794-145">Saving the table should refresh the Server Explorer, including the just-added column in the `Suppliers` table s column list.</span></span> <span data-ttu-id="0f794-146">さらに、(数式) テキストボックスに入力した式は、不要な空白を除去する同等の式に自動的に調整されます。これにより、列名が角かっこ (`[]`) で囲まれ、より明示的に操作の順序が示されます。</span><span class="sxs-lookup"><span data-stu-id="0f794-146">Furthermore, the expression entered into the (Formula) textbox will automatically adjust to an equivalent expression that strips unnecessary whitespace, surrounds column names with brackets (`[]`), and includes parentheses to more explicitly show the order of operations:</span></span>

[!code-sql[Main](working-with-computed-columns-cs/samples/sample2.sql)]

<span data-ttu-id="0f794-147">Microsoft SQL Server の計算列の詳細については、[技術ドキュメント](https://msdn.microsoft.com/library/ms191250.aspx)を参照してください。</span><span class="sxs-lookup"><span data-stu-id="0f794-147">For more information on computed columns in Microsoft SQL Server, refer to the [technical documentation](https://msdn.microsoft.com/library/ms191250.aspx).</span></span> <span data-ttu-id="0f794-148">また、計算列を作成する手順については、 [「方法: 計算列を指定する](https://msdn.microsoft.com/library/ms188300.aspx)」をご覧ください。</span><span class="sxs-lookup"><span data-stu-id="0f794-148">Also check out the [How to: Specify Computed Columns](https://msdn.microsoft.com/library/ms188300.aspx) for a step-by-step walkthrough of creating computed columns.</span></span>

> [!NOTE]
> <span data-ttu-id="0f794-149">既定では、計算列は物理的にテーブルに格納されるのではなく、クエリで参照されるたびに再計算されます。</span><span class="sxs-lookup"><span data-stu-id="0f794-149">By default, computed columns are not physically stored in the table but are instead recalculated each time they are referenced in a query.</span></span> <span data-ttu-id="0f794-150">ただし、[保存されている] チェックボックスをオンにすると、計算列をテーブルに物理的に格納するように SQL Server に指示できます。</span><span class="sxs-lookup"><span data-stu-id="0f794-150">By checking the Is Persisted checkbox, however, you can instruct SQL Server to physically store the computed column in the table.</span></span> <span data-ttu-id="0f794-151">これにより、計算列にインデックスを作成できます。これにより、`WHERE` 句で計算列の値を使用するクエリのパフォーマンスが向上します。</span><span class="sxs-lookup"><span data-stu-id="0f794-151">Doing so allows an index to be created on the computed column, which can improve the performance of queries that use the computed column value in their `WHERE` clauses.</span></span> <span data-ttu-id="0f794-152">詳細については、「[計算列にインデックスを作成する](https://msdn.microsoft.com/library/ms189292.aspx)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="0f794-152">See [Creating Indexes on Computed Columns](https://msdn.microsoft.com/library/ms189292.aspx) for more information.</span></span>

## <a name="step-2-viewing-the-computed-column-s-values"></a><span data-ttu-id="0f794-153">手順 2: 計算列の値の表示</span><span class="sxs-lookup"><span data-stu-id="0f794-153">Step 2: Viewing the Computed Column s Values</span></span>

<span data-ttu-id="0f794-154">データアクセス層での作業を開始する前に、`FullContactName` の値を表示するのに1分かかります。</span><span class="sxs-lookup"><span data-stu-id="0f794-154">Before we start work on the Data Access Layer, let s take a minute to view the `FullContactName` values.</span></span> <span data-ttu-id="0f794-155">サーバーエクスプローラーから、`Suppliers` テーブル名を右クリックし、コンテキストメニューから [新しいクエリ] を選択します。</span><span class="sxs-lookup"><span data-stu-id="0f794-155">From the Server Explorer, right-click on the `Suppliers` table name and choose New Query from the context-menu.</span></span> <span data-ttu-id="0f794-156">クエリに含めるテーブルを選択するように求めるクエリウィンドウが表示されます。</span><span class="sxs-lookup"><span data-stu-id="0f794-156">This will bring up a Query window that prompts us to choose what tables to include in the query.</span></span> <span data-ttu-id="0f794-157">`Suppliers` テーブルを追加し、[閉じる] をクリックします。</span><span class="sxs-lookup"><span data-stu-id="0f794-157">Add the `Suppliers` table and click Close.</span></span> <span data-ttu-id="0f794-158">次に、[仕入先] テーブルの `CompanyName`、`ContactName`、`ContactTitle`、および `FullContactName` の各列を確認します。</span><span class="sxs-lookup"><span data-stu-id="0f794-158">Next, check the `CompanyName`, `ContactName`, `ContactTitle`, and `FullContactName` columns from the Suppliers table.</span></span> <span data-ttu-id="0f794-159">最後に、ツールバーの赤い感嘆符アイコンをクリックしてクエリを実行し、結果を表示します。</span><span class="sxs-lookup"><span data-stu-id="0f794-159">Finally, click the red exclamation point icon in the Toolbar to execute the query and view the results.</span></span>

<span data-ttu-id="0f794-160">図2に示すように、結果には、ldquo の形式を使用して `CompanyName`、`ContactName`、および `ContactTitle` 列を一覧表示する `FullContactName`が含まれています。`ContactName` (`ContactTitle`、`CompanyName`)。</span><span class="sxs-lookup"><span data-stu-id="0f794-160">As Figure 2 shows, the results include `FullContactName`, which lists the `CompanyName`, `ContactName`, and `ContactTitle` columns using the format ldquo;`ContactName` (`ContactTitle`, `CompanyName`) .</span></span>

<span data-ttu-id="0f794-161">[FullContactName は、[宛先] 形式 ([部署]、[CompanyName]) を使用します。](working-with-computed-columns-cs/_static/image5.png)](working-with-computed-columns-cs/_static/image4.png)![</span><span class="sxs-lookup"><span data-stu-id="0f794-161">[![The FullContactName Uses the Format ContactName (ContactTitle, CompanyName)](working-with-computed-columns-cs/_static/image5.png)](working-with-computed-columns-cs/_static/image4.png)</span></span>

<span data-ttu-id="0f794-162">**図 2**: `FullContactName` は `ContactName` (`ContactTitle`、`CompanyName`) の形式を使用します ([クリックすると、フルサイズの画像が表示](working-with-computed-columns-cs/_static/image6.png)されます)。</span><span class="sxs-lookup"><span data-stu-id="0f794-162">**Figure 2**: The `FullContactName` Uses the Format `ContactName` (`ContactTitle`, `CompanyName`) ([Click to view full-size image](working-with-computed-columns-cs/_static/image6.png))</span></span>

## <a name="step-3-adding-thesupplierstableadapterto-the-data-access-layer"></a><span data-ttu-id="0f794-163">手順 3: データアクセス層への`SuppliersTableAdapter`の追加</span><span class="sxs-lookup"><span data-stu-id="0f794-163">Step 3: Adding the`SuppliersTableAdapter`to the Data Access Layer</span></span>

<span data-ttu-id="0f794-164">アプリケーションでサプライヤー情報を操作するには、まず、DAL に TableAdapter と DataTable を作成する必要があります。</span><span class="sxs-lookup"><span data-stu-id="0f794-164">In order to work with the supplier information in our application we need to first create a TableAdapter and DataTable in our DAL.</span></span> <span data-ttu-id="0f794-165">これは、前のチュートリアルで確認したのと同じ簡単な手順を使用して実現するのが理想的です。</span><span class="sxs-lookup"><span data-stu-id="0f794-165">Ideally, this would be accomplished using the same straightforward steps examined in earlier tutorials.</span></span> <span data-ttu-id="0f794-166">ただし、計算列を使用すると、議論に役立ついくつかのしわが生じます。</span><span class="sxs-lookup"><span data-stu-id="0f794-166">However, working with computed columns introduces a few wrinkles that merit discussion.</span></span>

<span data-ttu-id="0f794-167">アドホック SQL ステートメントを使用する TableAdapter を使用している場合は、tableadapter 構成ウィザードを使用して、単に tableadapter s メインクエリに計算列を含めることができます。</span><span class="sxs-lookup"><span data-stu-id="0f794-167">If you are using a TableAdapter that uses ad-hoc SQL statements, you can simply include the computed column in the TableAdapter s main query via the TableAdapter Configuration wizard.</span></span> <span data-ttu-id="0f794-168">ただし、この場合は、計算列を含む `INSERT` および `UPDATE` ステートメントが自動生成されます。</span><span class="sxs-lookup"><span data-stu-id="0f794-168">This, however, will auto-generate `INSERT` and `UPDATE` statements that include the computed column.</span></span> <span data-ttu-id="0f794-169">これらのメソッドのいずれかを実行しようとすると `SqlException`、列*ColumnName*を変更できません。これは、計算列であるか、UNION 演算子の結果がスローされるためです。</span><span class="sxs-lookup"><span data-stu-id="0f794-169">If you attempt to execute one of these methods, a `SqlException` with the message The column *ColumnName* cannot be modified because it is either a computed column or is the result of a UNION operator will be thrown.</span></span> <span data-ttu-id="0f794-170">`INSERT` および `UPDATE` ステートメントは、TableAdapter の `InsertCommand` および `UpdateCommand` プロパティを使用して手動で調整できますが、TableAdapter 構成ウィザードを再実行するたびに、これらのカスタマイズは失われます。</span><span class="sxs-lookup"><span data-stu-id="0f794-170">While the `INSERT` and `UPDATE` statement can be manually adjusted through the TableAdapter s `InsertCommand` and `UpdateCommand` properties, these customizations will be lost whenever the TableAdapter Configuration wizard is re-run.</span></span>

<span data-ttu-id="0f794-171">アドホック SQL ステートメントを使用する Tableadapter の高まるにより、計算列を操作するときはストアドプロシージャを使用することをお勧めします。</span><span class="sxs-lookup"><span data-stu-id="0f794-171">Due to the brittleness of TableAdapters that use ad-hoc SQL statements, it is recommended that we use stored procedures when working with computed columns.</span></span> <span data-ttu-id="0f794-172">既存のストアドプロシージャを使用する場合は、「[型指定されたデータセットの tableadapter の既存のストアドプロシージャの使用](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs.md)」のチュートリアルで説明されているように、単に tableadapter を構成します。</span><span class="sxs-lookup"><span data-stu-id="0f794-172">If you are using existing stored procedures, simply configure the TableAdapter as discussed in the [Using Existing Stored Procedures for the Typed DataSet s TableAdapters](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs.md) tutorial.</span></span> <span data-ttu-id="0f794-173">ただし、TableAdapter ウィザードを使用してストアドプロシージャを作成する場合は、最初にメインクエリから計算列を省略することが重要です。</span><span class="sxs-lookup"><span data-stu-id="0f794-173">If you have the TableAdapter wizard create the stored procedures for you, however, it is important to initially omit any computed columns from the main query.</span></span> <span data-ttu-id="0f794-174">メインクエリに計算列を含めると、完了時に、対応するストアドプロシージャを作成できないことが TableAdapter 構成ウィザードによって通知されます。</span><span class="sxs-lookup"><span data-stu-id="0f794-174">If you include a computed column in the main query, the TableAdapter Configuration wizard will inform you, upon completion, that it cannot create the corresponding stored procedures.</span></span> <span data-ttu-id="0f794-175">つまり、最初に計算列のないメインクエリを使用して TableAdapter を構成してから、対応するストアドプロシージャと TableAdapter s `SelectCommand` を手動で更新して計算列を含める必要があります。</span><span class="sxs-lookup"><span data-stu-id="0f794-175">In short, we need to initially configure the TableAdapter using a computed column-free main query and then manually update the corresponding stored procedure and the TableAdapter s `SelectCommand` to include the computed column.</span></span> <span data-ttu-id="0f794-176">この方法は`JOIN`*s*チュートリアルを[使用するように TableAdapter を更新](updating-the-tableadapter-to-use-joins-cs.md)する方法と似ています。</span><span class="sxs-lookup"><span data-stu-id="0f794-176">This approach is similar to the one used in the [Updating the TableAdapter to Use](updating-the-tableadapter-to-use-joins-cs.md)`JOIN`*s* tutorial.</span></span>

<span data-ttu-id="0f794-177">このチュートリアルでは、新しい TableAdapter を追加し、自動的にストアドプロシージャを作成するようにします。</span><span class="sxs-lookup"><span data-stu-id="0f794-177">For this tutorial, let s add a new TableAdapter and have it automatically create the stored procedures for us.</span></span> <span data-ttu-id="0f794-178">そのため、最初にメインクエリから計算列 `FullContactName` を省略する必要があります。</span><span class="sxs-lookup"><span data-stu-id="0f794-178">Consequently, we will need to initially omit the `FullContactName` computed column from the main query.</span></span>

<span data-ttu-id="0f794-179">まず、`~/App_Code/DAL` フォルダー内の `NorthwindWithSprocs` データセットを開きます。</span><span class="sxs-lookup"><span data-stu-id="0f794-179">Start by opening the `NorthwindWithSprocs` DataSet in the `~/App_Code/DAL` folder.</span></span> <span data-ttu-id="0f794-180">デザイナー内を右クリックし、コンテキストメニューから [新しい TableAdapter の追加] を選択します。</span><span class="sxs-lookup"><span data-stu-id="0f794-180">Right-click in the Designer and, from the context-menu, choose to add a new TableAdapter.</span></span> <span data-ttu-id="0f794-181">これにより、TableAdapter 構成ウィザードが起動します。</span><span class="sxs-lookup"><span data-stu-id="0f794-181">This will launch the TableAdapter Configuration wizard.</span></span> <span data-ttu-id="0f794-182">データを照会するデータベース (`Web.config`から`NORTHWNDConnectionString`) を指定し、[次へ] をクリックします。</span><span class="sxs-lookup"><span data-stu-id="0f794-182">Specify the database to query data from (`NORTHWNDConnectionString` from `Web.config`) and click Next.</span></span> <span data-ttu-id="0f794-183">`Suppliers` テーブルに対してクエリまたは変更を行うストアドプロシージャをまだ作成していないので、[新しいストアドプロシージャの作成] オプションを選択して、ウィザードによってテーブルが作成されるようにして、[次へ] をクリックします。</span><span class="sxs-lookup"><span data-stu-id="0f794-183">Since we have not yet created any stored procedures for querying or modifying the `Suppliers` table, select the Create new stored procedures option so that the wizard will create them for us and click Next.</span></span>

<span data-ttu-id="0f794-184">[![[新しいストアドプロシージャの作成] オプションを選択する](working-with-computed-columns-cs/_static/image8.png)](working-with-computed-columns-cs/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="0f794-184">[![Choose the Create new stored procedures Option](working-with-computed-columns-cs/_static/image8.png)](working-with-computed-columns-cs/_static/image7.png)</span></span>

<span data-ttu-id="0f794-185">**図 3**: [新しいストアドプロシージャを作成する] オプションを選択[する (クリックすると、フルサイズの画像が表示](working-with-computed-columns-cs/_static/image9.png)されます)</span><span class="sxs-lookup"><span data-stu-id="0f794-185">**Figure 3**: Choose the Create new stored procedures Option ([Click to view full-size image](working-with-computed-columns-cs/_static/image9.png))</span></span>

<span data-ttu-id="0f794-186">次の手順では、メインクエリを入力するように求められます。</span><span class="sxs-lookup"><span data-stu-id="0f794-186">The subsequent step prompts us for the main query.</span></span> <span data-ttu-id="0f794-187">次のクエリを入力します。これにより、各仕入先の `SupplierID`、`CompanyName`、`ContactName`、および `ContactTitle` 列が返されます。</span><span class="sxs-lookup"><span data-stu-id="0f794-187">Enter the following query, which returns the `SupplierID`, `CompanyName`, `ContactName`, and `ContactTitle` columns for each supplier.</span></span> <span data-ttu-id="0f794-188">このクエリでは、計算列 (`FullContactName`) が意図的に省略されていることに注意してください。ここでは、対応するストアドプロシージャを更新して、手順 4. でこの列を含めます。</span><span class="sxs-lookup"><span data-stu-id="0f794-188">Note that this query purposefully omits the computed column (`FullContactName`); we will update the corresponding stored procedure to include this column in Step 4.</span></span>

[!code-sql[Main](working-with-computed-columns-cs/samples/sample3.sql)]

<span data-ttu-id="0f794-189">メインクエリを入力して [次へ] をクリックすると、ウィザードによって生成される4つのストアドプロシージャに名前を指定できるようになります。</span><span class="sxs-lookup"><span data-stu-id="0f794-189">After entering the main query and clicking Next, the wizard allows us to name the four stored procedures it will generate.</span></span> <span data-ttu-id="0f794-190">図4に示すように、これらのストアドプロシージャ `Suppliers_Select`、`Suppliers_Insert`、`Suppliers_Update`、および `Suppliers_Delete`に名前を付けます。</span><span class="sxs-lookup"><span data-stu-id="0f794-190">Name these stored procedures `Suppliers_Select`, `Suppliers_Insert`, `Suppliers_Update`, and `Suppliers_Delete`, as Figure 4 illustrates.</span></span>

<span data-ttu-id="0f794-191">[自動生成されたストアドプロシージャの名前をカスタマイズ ![には](working-with-computed-columns-cs/_static/image11.png)](working-with-computed-columns-cs/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="0f794-191">[![Customize the Names of the Auto-Generated Stored Procedures](working-with-computed-columns-cs/_static/image11.png)](working-with-computed-columns-cs/_static/image10.png)</span></span>

<span data-ttu-id="0f794-192">**図 4**: 自動生成されたストアドプロシージャの名前をカスタマイズ[する (クリックすると、フルサイズの画像が表示](working-with-computed-columns-cs/_static/image12.png)されます)</span><span class="sxs-lookup"><span data-stu-id="0f794-192">**Figure 4**: Customize the Names of the Auto-Generated Stored Procedures ([Click to view full-size image](working-with-computed-columns-cs/_static/image12.png))</span></span>

<span data-ttu-id="0f794-193">次のウィザードステップでは、TableAdapter のメソッドに名前を指定し、データにアクセスして更新するために使用するパターンを指定することができます。</span><span class="sxs-lookup"><span data-stu-id="0f794-193">The next wizard step allows us to name the TableAdapter s methods and specify the patterns used to access and update data.</span></span> <span data-ttu-id="0f794-194">3つのチェックボックスをすべてオンにしたままにして、`GetData` メソッドの名前を `GetSuppliers`に変更します。</span><span class="sxs-lookup"><span data-stu-id="0f794-194">Leave all three checkboxes checked, but rename the `GetData` method to `GetSuppliers`.</span></span> <span data-ttu-id="0f794-195">[完了] をクリックしてウィザードを終了します。</span><span class="sxs-lookup"><span data-stu-id="0f794-195">Click Finish to complete the wizard.</span></span>

<span data-ttu-id="0f794-196">[GetData メソッドの名前を GetSuppliers に変更 ![には](working-with-computed-columns-cs/_static/image14.png)](working-with-computed-columns-cs/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="0f794-196">[![Rename the GetData Method to GetSuppliers](working-with-computed-columns-cs/_static/image14.png)](working-with-computed-columns-cs/_static/image13.png)</span></span>

<span data-ttu-id="0f794-197">**図 5**: `GetData` メソッドの名前を `GetSuppliers` に変更する ([クリックすると、フルサイズの画像が表示](working-with-computed-columns-cs/_static/image15.png)されます)</span><span class="sxs-lookup"><span data-stu-id="0f794-197">**Figure 5**: Rename the `GetData` Method to `GetSuppliers` ([Click to view full-size image](working-with-computed-columns-cs/_static/image15.png))</span></span>

<span data-ttu-id="0f794-198">[完了] をクリックすると、ウィザードによって4つのストアドプロシージャが作成され、TableAdapter および対応する DataTable が型指定されたデータセットに追加されます。</span><span class="sxs-lookup"><span data-stu-id="0f794-198">Upon clicking Finish, the wizard will create the four stored procedures and add the TableAdapter and corresponding DataTable to the Typed DataSet.</span></span>

## <a name="step-4-including-the-computed-column-in-the-tableadapter-s-main-query"></a><span data-ttu-id="0f794-199">手順 4: TableAdapter s メインクエリに計算列を含める</span><span class="sxs-lookup"><span data-stu-id="0f794-199">Step 4: Including the Computed Column in the TableAdapter s Main Query</span></span>

<span data-ttu-id="0f794-200">ここで、手順 3. で作成した TableAdapter と DataTable を更新して、`FullContactName` 計算列を含める必要があります。</span><span class="sxs-lookup"><span data-stu-id="0f794-200">We now need to update the TableAdapter and DataTable created in Step 3 to include the `FullContactName` computed column.</span></span> <span data-ttu-id="0f794-201">これには、次の 2 つの手順があります。</span><span class="sxs-lookup"><span data-stu-id="0f794-201">This involves two steps:</span></span>

1. <span data-ttu-id="0f794-202">`FullContactName` 計算列を返すように `Suppliers_Select` ストアドプロシージャを更新する</span><span class="sxs-lookup"><span data-stu-id="0f794-202">Updating the `Suppliers_Select` stored procedure to return the `FullContactName` computed column, and</span></span>
2. <span data-ttu-id="0f794-203">対応する `FullContactName` 列を含むように DataTable を更新しています。</span><span class="sxs-lookup"><span data-stu-id="0f794-203">Updating the DataTable to include a corresponding `FullContactName` column.</span></span>

<span data-ttu-id="0f794-204">まず、サーバーエクスプローラーに移動し、[ストアドプロシージャ] フォルダーにドリルダウンします。</span><span class="sxs-lookup"><span data-stu-id="0f794-204">Start by navigating to the Server Explorer and drilling down into the Stored Procedures folder.</span></span> <span data-ttu-id="0f794-205">`Suppliers_Select` ストアドプロシージャを開き、`FullContactName` 計算列を含めるように `SELECT` クエリを更新します。</span><span class="sxs-lookup"><span data-stu-id="0f794-205">Open the `Suppliers_Select` stored procedure and update the `SELECT` query to include the `FullContactName` computed column:</span></span>

[!code-sql[Main](working-with-computed-columns-cs/samples/sample4.sql)]

<span data-ttu-id="0f794-206">ツールバーの [保存] アイコンをクリックするか、Ctrl キーを押しながら S キーを押すか、または [ファイル] メニューの [`Suppliers_Select` の保存] オプションを選択して、ストアドプロシージャへの変更を保存します。</span><span class="sxs-lookup"><span data-stu-id="0f794-206">Save the changes to the stored procedure by clicking the Save icon in the Toolbar, by hitting Ctrl+S, or by choosing the Save `Suppliers_Select` option from the File menu.</span></span>

<span data-ttu-id="0f794-207">次に、データセットデザイナーに戻り、`SuppliersTableAdapter`を右クリックして、コンテキストメニューから [構成] を選択します。</span><span class="sxs-lookup"><span data-stu-id="0f794-207">Next, return to the DataSet Designer, right-click on the `SuppliersTableAdapter`, and choose Configure from the context-menu.</span></span> <span data-ttu-id="0f794-208">`Suppliers_Select` 列のデータ列コレクションに `FullContactName` 列が含まれるようになったことに注意してください。</span><span class="sxs-lookup"><span data-stu-id="0f794-208">Note that the `Suppliers_Select` column now includes the `FullContactName` column in its Data Columns collection.</span></span>

<span data-ttu-id="0f794-209">[TableAdapter s 構成ウィザードを実行して DataTable の列を更新 ![には](working-with-computed-columns-cs/_static/image17.png)](working-with-computed-columns-cs/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="0f794-209">[![Run the TableAdapter s Configuration Wizard to Update the DataTable s Columns](working-with-computed-columns-cs/_static/image17.png)](working-with-computed-columns-cs/_static/image16.png)</span></span>

<span data-ttu-id="0f794-210">**図 6**: TableAdapter の構成ウィザードを実行して DataTable の列を更新する ([クリックすると、フルサイズのイメージが表示](working-with-computed-columns-cs/_static/image18.png)されます)</span><span class="sxs-lookup"><span data-stu-id="0f794-210">**Figure 6**: Run the TableAdapter s Configuration Wizard to Update the DataTable s Columns ([Click to view full-size image](working-with-computed-columns-cs/_static/image18.png))</span></span>

<span data-ttu-id="0f794-211">[完了] をクリックしてウィザードを終了します。</span><span class="sxs-lookup"><span data-stu-id="0f794-211">Click Finish to complete the wizard.</span></span> <span data-ttu-id="0f794-212">これにより、対応する列が `SuppliersDataTable`に自動的に追加されます。</span><span class="sxs-lookup"><span data-stu-id="0f794-212">This will automatically add a corresponding column to the `SuppliersDataTable`.</span></span> <span data-ttu-id="0f794-213">TableAdapter ウィザードは、`FullContactName` 列が計算列であるため、読み取り専用であることを検出するのに十分なスマートです。</span><span class="sxs-lookup"><span data-stu-id="0f794-213">The TableAdapter wizard is smart enough to detect that the `FullContactName` column is a computed column and therefore read-only.</span></span> <span data-ttu-id="0f794-214">その結果、列 s `ReadOnly` プロパティが `true`に設定されます。</span><span class="sxs-lookup"><span data-stu-id="0f794-214">Consequently, it sets the column s `ReadOnly` property to `true`.</span></span> <span data-ttu-id="0f794-215">これを確認するには、`SuppliersDataTable` から列を選択し、プロパティウィンドウにアクセスします (図7を参照)。</span><span class="sxs-lookup"><span data-stu-id="0f794-215">To verify this, select the column from the `SuppliersDataTable` and then go to the Properties window (see Figure 7).</span></span> <span data-ttu-id="0f794-216">`FullContactName` 列 s `DataType` と `MaxLength` プロパティも、それに応じて設定されることに注意してください。</span><span class="sxs-lookup"><span data-stu-id="0f794-216">Note that the `FullContactName` column s `DataType` and `MaxLength` properties are also set accordingly.</span></span>

<span data-ttu-id="0f794-217">[FullContactName 列が読み取り専用としてマークされている](working-with-computed-columns-cs/_static/image20.png)](working-with-computed-columns-cs/_static/image19.png)![</span><span class="sxs-lookup"><span data-stu-id="0f794-217">[![The FullContactName Column is Marked as Read-Only](working-with-computed-columns-cs/_static/image20.png)](working-with-computed-columns-cs/_static/image19.png)</span></span>

<span data-ttu-id="0f794-218">**図 7**: `FullContactName` 列が読み取り専用としてマークされている ([クリックすると、フルサイズの画像が表示](working-with-computed-columns-cs/_static/image21.png)されます)</span><span class="sxs-lookup"><span data-stu-id="0f794-218">**Figure 7**: The `FullContactName` Column is Marked as Read-Only ([Click to view full-size image](working-with-computed-columns-cs/_static/image21.png))</span></span>

## <a name="step-5-adding-agetsupplierbysupplieridmethod-to-the-tableadapter"></a><span data-ttu-id="0f794-219">手順 5:`GetSupplierBySupplierID`メソッドを TableAdapter に追加する</span><span class="sxs-lookup"><span data-stu-id="0f794-219">Step 5: Adding a`GetSupplierBySupplierID`Method to the TableAdapter</span></span>

<span data-ttu-id="0f794-220">このチュートリアルでは、仕入先を更新可能なグリッドで表示する ASP.NET ページを作成します。</span><span class="sxs-lookup"><span data-stu-id="0f794-220">For this tutorial we will create an ASP.NET page that displays the suppliers in an updateable grid.</span></span> <span data-ttu-id="0f794-221">これまでのチュートリアルでは、厳密に型指定された DataTable として DAL から特定のレコードを取得し、そのプロパティを更新して、変更を反映するために更新された DataTable を DAL に送り返すことで、ビジネスロジック層から1つのレコードを更新しました。データベース。</span><span class="sxs-lookup"><span data-stu-id="0f794-221">In past tutorials we have updated a single record from the Business Logic Layer by retrieving that particular record from the DAL as a strongly-typed DataTable, updating its properties, and then sending the updated DataTable back to the DAL to propagate the changes to the database.</span></span> <span data-ttu-id="0f794-222">この最初の手順を実行するには、DAL から更新されるレコードを取得する必要があります。まず、`GetSupplierBySupplierID(supplierID)` メソッドを DAL に追加する必要があります。</span><span class="sxs-lookup"><span data-stu-id="0f794-222">To accomplish this first step - retrieving the record being updated from the DAL - we need to first add a `GetSupplierBySupplierID(supplierID)` method to the DAL.</span></span>

<span data-ttu-id="0f794-223">データセットのデザインで `SuppliersTableAdapter` を右クリックし、コンテキストメニューから [クエリの追加] オプションを選択します。</span><span class="sxs-lookup"><span data-stu-id="0f794-223">Right-click on the `SuppliersTableAdapter` in the DataSet Design and choose the Add Query option from the context-menu.</span></span> <span data-ttu-id="0f794-224">手順 3. で行ったように、[新しいストアドプロシージャの作成] オプションを選択して、ウィザードで新しいストアドプロシージャを生成します (このウィザードの手順のスクリーンショットについては、図3を参照してください)。</span><span class="sxs-lookup"><span data-stu-id="0f794-224">As we did in Step 3, let the wizard generate a new stored procedure for us by selecting the Create new stored procedure option (refer back to Figure 3 for a screenshot of this wizard step).</span></span> <span data-ttu-id="0f794-225">このメソッドは複数の列を含むレコードを返すため、行を返す SELECT である SQL クエリを使用することを指定し、[次へ] をクリックします。</span><span class="sxs-lookup"><span data-stu-id="0f794-225">Since this method will return a record with multiple columns, indicate that we want to use a SQL query that is a SELECT which returns rows and click Next.</span></span>

<span data-ttu-id="0f794-226">[![[行を返す] オプションを選択します。](working-with-computed-columns-cs/_static/image23.png)](working-with-computed-columns-cs/_static/image22.png)</span><span class="sxs-lookup"><span data-stu-id="0f794-226">[![Choose the SELECT which returns rows Option](working-with-computed-columns-cs/_static/image23.png)](working-with-computed-columns-cs/_static/image22.png)</span></span>

<span data-ttu-id="0f794-227">**図 8**: [行を返す] オプションを選択[する (クリックすると、フルサイズの画像が表示](working-with-computed-columns-cs/_static/image24.png)されます)</span><span class="sxs-lookup"><span data-stu-id="0f794-227">**Figure 8**: Choose the SELECT which returns rows Option ([Click to view full-size image](working-with-computed-columns-cs/_static/image24.png))</span></span>

<span data-ttu-id="0f794-228">後続の手順では、このメソッドに使用するクエリを入力するように求められます。</span><span class="sxs-lookup"><span data-stu-id="0f794-228">The subsequent step prompts us for the query to use for this method.</span></span> <span data-ttu-id="0f794-229">次のように入力します。これにより、メインクエリと同じデータフィールドが返されますが、特定の仕入先についてはを返します。</span><span class="sxs-lookup"><span data-stu-id="0f794-229">Enter the following, which returns the same data fields as the main query but for a particular supplier.</span></span>

[!code-sql[Main](working-with-computed-columns-cs/samples/sample5.sql)]

<span data-ttu-id="0f794-230">次の画面では、自動生成されるストアドプロシージャに名前を指定するように求められます。</span><span class="sxs-lookup"><span data-stu-id="0f794-230">The next screen asks us to name the stored procedure that will be auto-generated.</span></span> <span data-ttu-id="0f794-231">このストアドプロシージャに名前を `Suppliers_SelectBySupplierID`、[次へ] をクリックします。</span><span class="sxs-lookup"><span data-stu-id="0f794-231">Name this stored procedure `Suppliers_SelectBySupplierID` and click Next.</span></span>

<span data-ttu-id="0f794-232">[ストアドプロシージャの名前を ![Suppliers_SelectBySupplierID](working-with-computed-columns-cs/_static/image26.png)](working-with-computed-columns-cs/_static/image25.png)</span><span class="sxs-lookup"><span data-stu-id="0f794-232">[![Name the Stored Procedure Suppliers_SelectBySupplierID](working-with-computed-columns-cs/_static/image26.png)](working-with-computed-columns-cs/_static/image25.png)</span></span>

<span data-ttu-id="0f794-233">**図 9**: ストアドプロシージャに `Suppliers_SelectBySupplierID` という名前[を指定する (クリックしてフルサイズの画像を表示する](working-with-computed-columns-cs/_static/image27.png))</span><span class="sxs-lookup"><span data-stu-id="0f794-233">**Figure 9**: Name the Stored Procedure `Suppliers_SelectBySupplierID` ([Click to view full-size image](working-with-computed-columns-cs/_static/image27.png))</span></span>

<span data-ttu-id="0f794-234">最後に、TableAdapter に使用するデータアクセスパターンとメソッド名を入力するように求められます。</span><span class="sxs-lookup"><span data-stu-id="0f794-234">Lastly, the wizard prompts us for the data access patterns and method names to use for the TableAdapter.</span></span> <span data-ttu-id="0f794-235">両方のチェックボックスをオンのままにしますが、`FillBy` および `GetDataBy` メソッドの名前をそれぞれ `FillBySupplierID` および `GetSupplierBySupplierID`に変更します。</span><span class="sxs-lookup"><span data-stu-id="0f794-235">Leave both checkboxes checked, but rename the `FillBy` and `GetDataBy` methods to `FillBySupplierID` and `GetSupplierBySupplierID`, respectively.</span></span>

<span data-ttu-id="0f794-236">[TableAdapter メソッドに FillBySupplierID およびという名前を ![](working-with-computed-columns-cs/_static/image29.png)](working-with-computed-columns-cs/_static/image28.png)</span><span class="sxs-lookup"><span data-stu-id="0f794-236">[![Name the TableAdapter Methods FillBySupplierID and GetSupplierBySupplierID](working-with-computed-columns-cs/_static/image29.png)](working-with-computed-columns-cs/_static/image28.png)</span></span>

<span data-ttu-id="0f794-237">**図 10**: TableAdapter メソッド `FillBySupplierID` および `GetSupplierBySupplierID` の名前を指定[する (クリックすると、フルサイズのイメージが表示](working-with-computed-columns-cs/_static/image30.png)されます)</span><span class="sxs-lookup"><span data-stu-id="0f794-237">**Figure 10**: Name the TableAdapter Methods `FillBySupplierID` and `GetSupplierBySupplierID` ([Click to view full-size image](working-with-computed-columns-cs/_static/image30.png))</span></span>

<span data-ttu-id="0f794-238">[完了] をクリックしてウィザードを終了します。</span><span class="sxs-lookup"><span data-stu-id="0f794-238">Click Finish to complete the wizard.</span></span>

## <a name="step-6-creating-the-business-logic-layer"></a><span data-ttu-id="0f794-239">手順 6: ビジネスロジック層を作成する</span><span class="sxs-lookup"><span data-stu-id="0f794-239">Step 6: Creating the Business Logic Layer</span></span>

<span data-ttu-id="0f794-240">手順1で作成した計算列を使用する ASP.NET ページを作成する前に、まず、BLL に対応するメソッドを追加する必要があります。</span><span class="sxs-lookup"><span data-stu-id="0f794-240">Before we create an ASP.NET page that uses the computed column created in Step 1, we first need to add the corresponding methods in the BLL.</span></span> <span data-ttu-id="0f794-241">手順 7. で作成した ASP.NET ページでは、ユーザーがサプライヤーを表示および編集できるようになります。</span><span class="sxs-lookup"><span data-stu-id="0f794-241">Our ASP.NET page, which we will create in Step 7, will allow users to view and edit suppliers.</span></span> <span data-ttu-id="0f794-242">そのため、少なくとも、すべてのサプライヤーを取得するためのメソッドを提供し、特定の業者を更新するために、BLL が必要です。</span><span class="sxs-lookup"><span data-stu-id="0f794-242">Therefore, we need our BLL to provide, at minimum, a method to get all of the suppliers and another to update a particular supplier.</span></span>

<span data-ttu-id="0f794-243">`~/App_Code/BLL` フォルダーに `SuppliersBLLWithSprocs` という名前の新しいクラスファイルを作成し、次のコードを追加します。</span><span class="sxs-lookup"><span data-stu-id="0f794-243">Create a new class file named `SuppliersBLLWithSprocs` in the `~/App_Code/BLL` folder and add the following code:</span></span>

[!code-csharp[Main](working-with-computed-columns-cs/samples/sample6.cs)]

<span data-ttu-id="0f794-244">他の BLL クラスと同様に、`SuppliersBLLWithSprocs` には、`public` と `GetSuppliers` の2つの `UpdateSupplier`メソッドと共に `SuppliersTableAdapter` クラスのインスタンスを返す `protected` `Adapter` プロパティがあります。</span><span class="sxs-lookup"><span data-stu-id="0f794-244">Like the other BLL classes, `SuppliersBLLWithSprocs` has a `protected` `Adapter` property that returns an instance of the `SuppliersTableAdapter` class along with two `public` methods: `GetSuppliers` and `UpdateSupplier`.</span></span> <span data-ttu-id="0f794-245">`GetSuppliers` メソッドはを呼び出し、データアクセス層の対応する `GetSupplier` メソッドによって返された `SuppliersDataTable` を返します。</span><span class="sxs-lookup"><span data-stu-id="0f794-245">The `GetSuppliers` method calls and returns the `SuppliersDataTable` returned by the corresponding `GetSupplier` method in the Data Access Layer.</span></span> <span data-ttu-id="0f794-246">`UpdateSupplier` メソッドは、DAL の `GetSupplierBySupplierID(supplierID)` メソッドの呼び出しによって更新される特定の供給業者に関する情報を取得します。</span><span class="sxs-lookup"><span data-stu-id="0f794-246">The `UpdateSupplier` method retrieves information about the particular supplier being updated via a call to the DAL s `GetSupplierBySupplierID(supplierID)` method.</span></span> <span data-ttu-id="0f794-247">次に、`CategoryName`、`ContactName`、および `ContactTitle` の各プロパティを更新し、変更された `SuppliersRow` オブジェクトを渡して、データアクセス層 s `Update` メソッドを呼び出して、これらの変更をデータベースにコミットします。</span><span class="sxs-lookup"><span data-stu-id="0f794-247">It then updates the `CategoryName`, `ContactName`, and `ContactTitle` properties and commits these changes to the database by calling the Data Access Layer s `Update` method, passing in the modified `SuppliersRow` object.</span></span>

> [!NOTE]
> <span data-ttu-id="0f794-248">`SupplierID` と `CompanyName`を除き、仕入先テーブルのすべての列で `NULL` 値が許可されます。</span><span class="sxs-lookup"><span data-stu-id="0f794-248">Except for `SupplierID` and `CompanyName`, all columns in the Suppliers table allow `NULL` values.</span></span> <span data-ttu-id="0f794-249">したがって、渡された `contactName` パラメーターまたは `contactTitle` パラメーターが `null` 場合、それぞれ `ContactTitle` メソッドと `NULL` メソッドを使用して、対応する `ContactName` および `SetContactNameNull` プロパティを `SetContactTitleNull` データベース値に設定する必要があります。</span><span class="sxs-lookup"><span data-stu-id="0f794-249">Therefore, if the passed-in `contactName` or `contactTitle` parameters are `null` we need to set the corresponding `ContactName` and `ContactTitle` properties to a `NULL` database value using the `SetContactNameNull` and `SetContactTitleNull` methods, respectively.</span></span>

## <a name="step-7-working-with-the-computed-column-from-the-presentation-layer"></a><span data-ttu-id="0f794-250">手順 7: プレゼンテーション層から計算列を操作する</span><span class="sxs-lookup"><span data-stu-id="0f794-250">Step 7: Working with the Computed Column from the Presentation Layer</span></span>

<span data-ttu-id="0f794-251">計算列が `Suppliers` テーブルに追加され、DAL と BLL がそれに従って更新されると、`FullContactName` 計算列で動作する ASP.NET ページを作成する準備が整います。</span><span class="sxs-lookup"><span data-stu-id="0f794-251">With the computed column added to the `Suppliers` table and the DAL and BLL updated accordingly, we are ready to build an ASP.NET page that works with the `FullContactName` computed column.</span></span> <span data-ttu-id="0f794-252">まず、`AdvancedDAL` フォルダーの [`ComputedColumns.aspx`] ページを開き、ツールボックスから GridView をデザイナーにドラッグします。</span><span class="sxs-lookup"><span data-stu-id="0f794-252">Start by opening the `ComputedColumns.aspx` page in the `AdvancedDAL` folder and drag a GridView from the Toolbox onto the Designer.</span></span> <span data-ttu-id="0f794-253">GridView s `ID` プロパティを `Suppliers` に設定し、そのスマートタグから `SuppliersDataSource`という名前の新しい ObjectDataSource にバインドします。</span><span class="sxs-lookup"><span data-stu-id="0f794-253">Set the GridView s `ID` property to `Suppliers` and, from its smart tag, bind it to a new ObjectDataSource named `SuppliersDataSource`.</span></span> <span data-ttu-id="0f794-254">手順6でもう一度追加した `SuppliersBLLWithSprocs` クラスを使用するように ObjectDataSource を構成し、[次へ] をクリックします。</span><span class="sxs-lookup"><span data-stu-id="0f794-254">Configure the ObjectDataSource to use the `SuppliersBLLWithSprocs` class we added back in Step 6 and click Next.</span></span>

<span data-ttu-id="0f794-255">[SuppliersBLLWithSprocs クラスを使用するように ObjectDataSource を構成 ![には](working-with-computed-columns-cs/_static/image32.png)](working-with-computed-columns-cs/_static/image31.png)</span><span class="sxs-lookup"><span data-stu-id="0f794-255">[![Configure the ObjectDataSource to Use the SuppliersBLLWithSprocs Class](working-with-computed-columns-cs/_static/image32.png)](working-with-computed-columns-cs/_static/image31.png)</span></span>

<span data-ttu-id="0f794-256">**図 11**: `SuppliersBLLWithSprocs` クラスを使用するように ObjectDataSource を構成する ([クリックしてフルサイズのイメージを表示する](working-with-computed-columns-cs/_static/image33.png))</span><span class="sxs-lookup"><span data-stu-id="0f794-256">**Figure 11**: Configure the ObjectDataSource to Use the `SuppliersBLLWithSprocs` Class ([Click to view full-size image](working-with-computed-columns-cs/_static/image33.png))</span></span>

<span data-ttu-id="0f794-257">`SuppliersBLLWithSprocs` クラスで定義されているメソッドは、`GetSuppliers` と `UpdateSupplier`の2つだけです。</span><span class="sxs-lookup"><span data-stu-id="0f794-257">There are only two methods defined in the `SuppliersBLLWithSprocs` class: `GetSuppliers` and `UpdateSupplier`.</span></span> <span data-ttu-id="0f794-258">[選択] タブと [更新] タブでこれら2つのメソッドが指定されていることを確認し、[完了] をクリックして ObjectDataSource の構成を完了します。</span><span class="sxs-lookup"><span data-stu-id="0f794-258">Ensure that these two methods are specified in the SELECT and UPDATE tabs, respectively, and click Finish to complete the configuration of the ObjectDataSource.</span></span>

<span data-ttu-id="0f794-259">データソース構成ウィザードが完了すると、返された各データフィールドの BoundField が Visual Studio によって追加されます。</span><span class="sxs-lookup"><span data-stu-id="0f794-259">Upon completion of the Data Source Configuration wizard, Visual Studio will add a BoundField for each of the data fields returned.</span></span> <span data-ttu-id="0f794-260">`SupplierID` BoundField を削除し、`CompanyName`、`ContactName`、`ContactTitle`、および `FullContactName` BoundFields の `HeaderText` プロパティをそれぞれ会社、連絡先名、タイトル、完全な連絡先名に変更します。</span><span class="sxs-lookup"><span data-stu-id="0f794-260">Remove the `SupplierID` BoundField and change the `HeaderText` properties of the `CompanyName`, `ContactName`, `ContactTitle`, and `FullContactName` BoundFields to Company, Contact Name, Title, and Full Contact Name, respectively.</span></span> <span data-ttu-id="0f794-261">スマートタグから、[編集を有効にする] チェックボックスをオンにして、GridView の組み込み編集機能をオンにします。</span><span class="sxs-lookup"><span data-stu-id="0f794-261">From the smart tag, check the Enable Editing checkbox to turn on the GridView s built-in editing capabilities.</span></span>

<span data-ttu-id="0f794-262">BoundFields を GridView に追加するだけでなく、データソースウィザードを完了すると、Visual Studio によって ObjectDataSource s `OldValuesParameterFormatString` プロパティが元の\_{0}に設定されます。</span><span class="sxs-lookup"><span data-stu-id="0f794-262">In addition to adding BoundFields to the GridView, completion of the Data Source Wizard also causes Visual Studio to set the ObjectDataSource s `OldValuesParameterFormatString` property to original\_{0}.</span></span> <span data-ttu-id="0f794-263">この設定を既定値の {0} に戻します。</span><span class="sxs-lookup"><span data-stu-id="0f794-263">Revert this setting back to its default value, {0} .</span></span>

<span data-ttu-id="0f794-264">GridView および ObjectDataSource に対してこれらの編集を行った後、宣言型マークアップは次のようになります。</span><span class="sxs-lookup"><span data-stu-id="0f794-264">After making these edits to the GridView and ObjectDataSource, their declarative markup should look similar to the following:</span></span>

[!code-aspx[Main](working-with-computed-columns-cs/samples/sample7.aspx)]

<span data-ttu-id="0f794-265">次に、ブラウザーを使用してこのページにアクセスします。</span><span class="sxs-lookup"><span data-stu-id="0f794-265">Next, visit this page through a browser.</span></span> <span data-ttu-id="0f794-266">図12に示すように、各仕入先は `FullContactName` 列を含むグリッドに一覧表示されます。値は、`ContactName` (`ContactTitle`、`CompanyName`) として書式設定された他の3つの列を連結したものにすぎません。</span><span class="sxs-lookup"><span data-stu-id="0f794-266">As Figure 12 shows, each supplier is listed in a grid that includes the `FullContactName` column, whose value is simply the concatenation of the other three columns formatted as `ContactName` (`ContactTitle`, `CompanyName`) .</span></span>

<span data-ttu-id="0f794-267">[各業者がグリッドに表示され ![](working-with-computed-columns-cs/_static/image35.png)](working-with-computed-columns-cs/_static/image34.png)</span><span class="sxs-lookup"><span data-stu-id="0f794-267">[![Each Supplier is Listed in the Grid](working-with-computed-columns-cs/_static/image35.png)](working-with-computed-columns-cs/_static/image34.png)</span></span>

<span data-ttu-id="0f794-268">**図 12**: 各供給業者がグリッドに表示される ([クリックすると、フルサイズの画像が表示](working-with-computed-columns-cs/_static/image36.png)されます)</span><span class="sxs-lookup"><span data-stu-id="0f794-268">**Figure 12**: Each Supplier is Listed in the Grid ([Click to view full-size image](working-with-computed-columns-cs/_static/image36.png))</span></span>

<span data-ttu-id="0f794-269">特定の業者の [編集] ボタンをクリックすると、ポストバックが発生し、その行が編集インターフェイスに表示されます (図13を参照)。</span><span class="sxs-lookup"><span data-stu-id="0f794-269">Clicking the Edit button for a particular supplier causes a postback and has that row rendered in its editing interface (see Figure 13).</span></span> <span data-ttu-id="0f794-270">最初の3つの列は、既定の編集インターフェイスを表示します。 `Text` プロパティがデータフィールドの値に設定されている TextBox コントロールです。</span><span class="sxs-lookup"><span data-stu-id="0f794-270">The first three columns render in their default editing interface - a TextBox control whose `Text` property is set to the value of the data field.</span></span> <span data-ttu-id="0f794-271">ただし、`FullContactName` 列はテキストとして残ります。</span><span class="sxs-lookup"><span data-stu-id="0f794-271">The `FullContactName` column, however, remains as text.</span></span> <span data-ttu-id="0f794-272">データソース構成ウィザードの完了時に、BoundFields が GridView に追加されたときに、`FullContactName` BoundField s `ReadOnly` プロパティが `true` に設定されました。これは、`SuppliersDataTable` 内の対応する `FullContactName` 列の `ReadOnly` プロパティが `true`に設定されているためです。</span><span class="sxs-lookup"><span data-stu-id="0f794-272">When the BoundFields were added to the GridView at the completion of the Data Source Configuration wizard, the `FullContactName` BoundField s `ReadOnly` property was set to `true` because the corresponding `FullContactName` column in the `SuppliersDataTable` has its `ReadOnly` property set to `true`.</span></span> <span data-ttu-id="0f794-273">手順 4. で説明したように、TableAdapter によって列が計算列であることが検出されたため、`FullContactName` s `ReadOnly` プロパティが `true` に設定されました。</span><span class="sxs-lookup"><span data-stu-id="0f794-273">As noted in Step 4, the `FullContactName` s `ReadOnly` property was set to `true` because the TableAdapter detected that the column was a computed column.</span></span>

<span data-ttu-id="0f794-274">[FullContactName 宛先列を編集できない ![](working-with-computed-columns-cs/_static/image38.png)](working-with-computed-columns-cs/_static/image37.png)</span><span class="sxs-lookup"><span data-stu-id="0f794-274">[![The FullContactName Column is Not Editable](working-with-computed-columns-cs/_static/image38.png)](working-with-computed-columns-cs/_static/image37.png)</span></span>

<span data-ttu-id="0f794-275">**図 13**: `FullContactName` 列は編集できません ([クリックすると、フルサイズの画像が表示](working-with-computed-columns-cs/_static/image39.png)されます)</span><span class="sxs-lookup"><span data-stu-id="0f794-275">**Figure 13**: The `FullContactName` Column is Not Editable ([Click to view full-size image](working-with-computed-columns-cs/_static/image39.png))</span></span>

<span data-ttu-id="0f794-276">1つまたは複数の編集可能な列の値を更新し、[更新] をクリックします。</span><span class="sxs-lookup"><span data-stu-id="0f794-276">Go ahead and update the value of one or more of the editable columns and click Update.</span></span> <span data-ttu-id="0f794-277">変更を反映するために、`FullContactName` s 値が自動的に更新されることに注意してください。</span><span class="sxs-lookup"><span data-stu-id="0f794-277">Note how the `FullContactName` s value is automatically updated to reflect the change.</span></span>

> [!NOTE]
> <span data-ttu-id="0f794-278">GridView では、現在、編集可能なフィールドに連結フィールドが使用され、その結果、既定の編集インターフェイスが使用されます。</span><span class="sxs-lookup"><span data-stu-id="0f794-278">The GridView currently uses BoundFields for the editable fields, resulting in the default editing interface.</span></span> <span data-ttu-id="0f794-279">`CompanyName` フィールドは必須であるため、RequiredFieldValidator を含む TemplateField に変換する必要があります。</span><span class="sxs-lookup"><span data-stu-id="0f794-279">Since the `CompanyName` field is required, it should be converted into a TemplateField that includes a RequiredFieldValidator.</span></span> <span data-ttu-id="0f794-280">これは関心のある読者のための演習として残されています。</span><span class="sxs-lookup"><span data-stu-id="0f794-280">I leave this as an exercise for the interested reader.</span></span> <span data-ttu-id="0f794-281">BoundField を TemplateField に変換し、検証コントロールを追加するための詳細な手順については、「[編集および挿入インターフェイスに検証コントロールを追加する](../editing-inserting-and-deleting-data/adding-validation-controls-to-the-editing-and-inserting-interfaces-cs.md)」のチュートリアルを参照してください。</span><span class="sxs-lookup"><span data-stu-id="0f794-281">Consult the [Adding Validation Controls to the Editing and Inserting Interfaces](../editing-inserting-and-deleting-data/adding-validation-controls-to-the-editing-and-inserting-interfaces-cs.md) tutorial for step-by-step instructions on converting a BoundField to a TemplateField and adding validation controls.</span></span>

## <a name="summary"></a><span data-ttu-id="0f794-282">まとめ</span><span class="sxs-lookup"><span data-stu-id="0f794-282">Summary</span></span>

<span data-ttu-id="0f794-283">テーブルのスキーマを定義すると、Microsoft SQL Server によって計算列を含めることができます。</span><span class="sxs-lookup"><span data-stu-id="0f794-283">When defining the schema for a table, Microsoft SQL Server allows the inclusion of computed columns.</span></span> <span data-ttu-id="0f794-284">これらは、通常、同じレコード内の他の列の値を参照する式から値が計算される列です。</span><span class="sxs-lookup"><span data-stu-id="0f794-284">These are columns whose values are calculated from an expression that usually references the values from other columns in the same record.</span></span> <span data-ttu-id="0f794-285">計算列の値は式に基づいているため、これらは読み取り専用であり、`INSERT` または `UPDATE` ステートメントで値を代入することはできません。</span><span class="sxs-lookup"><span data-stu-id="0f794-285">Since the values for computed columns are based on an expression, they are read-only and cannot be assigned a value in an `INSERT` or `UPDATE` statement.</span></span> <span data-ttu-id="0f794-286">これにより、対応する `INSERT`、`UPDATE`、および `DELETE` ステートメントを自動的に生成しようとする TableAdapter のメインクエリで計算列を使用する場合の課題が生じます。</span><span class="sxs-lookup"><span data-stu-id="0f794-286">This introduces challenges when using a computed column in the main query of a TableAdapter that tries to automatically generate corresponding `INSERT`, `UPDATE`, and `DELETE` statements.</span></span>

<span data-ttu-id="0f794-287">このチュートリアルでは、計算列によって生じる問題を回避するための手法について説明しました。</span><span class="sxs-lookup"><span data-stu-id="0f794-287">In this tutorial we discussed techniques for circumventing the challenges posed by computed columns.</span></span> <span data-ttu-id="0f794-288">具体的には、TableAdapter でストアドプロシージャを使用して、アドホック SQL ステートメントを使用する Tableadapter に固有の高まるを克服しています。</span><span class="sxs-lookup"><span data-stu-id="0f794-288">In particular, we used stored procedures in our TableAdapter to overcome the brittleness inherent in TableAdapters that use ad-hoc SQL statements.</span></span> <span data-ttu-id="0f794-289">TableAdapter ウィザードで新しいストアドプロシージャを作成する場合は、データ変更ストアドプロシージャが生成されないようにするため、メインクエリで計算列を最初に省略することが重要です。</span><span class="sxs-lookup"><span data-stu-id="0f794-289">When having the TableAdapter wizard create new stored procedures, it is important that we have the main query initially omit any computed columns because their presence prevents the data modification stored procedures from being generated.</span></span> <span data-ttu-id="0f794-290">TableAdapter が最初に構成された後は、その `SelectCommand` ストアドプロシージャを再設定して、計算列を含めることができます。</span><span class="sxs-lookup"><span data-stu-id="0f794-290">After the TableAdapter has been initially configured, its `SelectCommand` stored procedure can be retooled to include any computed columns.</span></span>

<span data-ttu-id="0f794-291">プログラミングを楽しんでください。</span><span class="sxs-lookup"><span data-stu-id="0f794-291">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="0f794-292">著者について</span><span class="sxs-lookup"><span data-stu-id="0f794-292">About the Author</span></span>

<span data-ttu-id="0f794-293">1998以来、 [Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml)は 7 asp/創設者 of [4GuysFromRolla.com](http://www.4guysfromrolla.com)の執筆者であり、Microsoft Web テクノロジを使用しています。</span><span class="sxs-lookup"><span data-stu-id="0f794-293">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="0f794-294">Scott は、独立したコンサルタント、トレーナー、およびライターとして機能します。</span><span class="sxs-lookup"><span data-stu-id="0f794-294">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="0f794-295">彼の最新の書籍は[ *、ASP.NET 2.0 を24時間以内に教え*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)ています。</span><span class="sxs-lookup"><span data-stu-id="0f794-295">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="0f794-296">mitchell@4GuysFromRolla.comでアクセスでき[ます。](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="0f794-296">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="0f794-297">または彼のブログを参照してください。これは[http://ScottOnWriting.NET](http://ScottOnWriting.NET)にあります。</span><span class="sxs-lookup"><span data-stu-id="0f794-297">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="0f794-298">ありがとうございました。</span><span class="sxs-lookup"><span data-stu-id="0f794-298">Special Thanks To</span></span>

<span data-ttu-id="0f794-299">このチュートリアルシリーズは、役に立つ多くのレビュー担当者によってレビューされました。</span><span class="sxs-lookup"><span data-stu-id="0f794-299">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="0f794-300">このチュートリアルのリードレビュー担当者は、Hilton Geisenow and Teresa Murphy でした。</span><span class="sxs-lookup"><span data-stu-id="0f794-300">Lead reviewers for this tutorial were Hilton Geisenow and Teresa Murphy.</span></span> <span data-ttu-id="0f794-301">今後の MSDN 記事を確認することに興味がありますか?</span><span class="sxs-lookup"><span data-stu-id="0f794-301">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="0f794-302">その場合は、mitchell@4GuysFromRolla.comの行を削除[します。](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="0f794-302">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="0f794-303">[前へ](adding-additional-datatable-columns-cs.md)
> [次へ](configuring-the-data-access-layer-s-connection-and-command-level-settings-cs.md)</span><span class="sxs-lookup"><span data-stu-id="0f794-303">[Previous](adding-additional-datatable-columns-cs.md)
[Next](configuring-the-data-access-layer-s-connection-and-command-level-settings-cs.md)</span></span>

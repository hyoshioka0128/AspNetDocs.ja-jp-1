---
uid: web-forms/overview/data-access/advanced-data-access-scenarios/working-with-computed-columns-vb
title: 計算列 (VB) を使用する |Microsoft Docs
author: rick-anderson
description: Microsoft SQL Server を使用すると、その値が式から計算されますが、計算列の定義、データベース テーブルを作成するときに通常、referen.
ms.author: riande
ms.date: 08/03/2007
ms.assetid: 5811b8ff-ed56-40fc-9397-6b69ae09a8f6
msc.legacyurl: /web-forms/overview/data-access/advanced-data-access-scenarios/working-with-computed-columns-vb
msc.type: authoredcontent
ms.openlocfilehash: ba01931dd4c728067975f2949d4ed81adcd97e2f
ms.sourcegitcommit: 51b01b6ff8edde57d8243e4da28c9f1e7f1962b2
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 05/06/2019
ms.locfileid: "65108619"
---
# <a name="working-with-computed-columns-vb"></a><span data-ttu-id="21e38-103">計算列を使用する (VB)</span><span class="sxs-lookup"><span data-stu-id="21e38-103">Working with Computed Columns (VB)</span></span>

<span data-ttu-id="21e38-104">によって[Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="21e38-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="21e38-105">[コードのダウンロード](http://download.microsoft.com/download/3/9/f/39f92b37-e92e-4ab3-909e-b4ef23d01aa3/ASPNET_Data_Tutorial_71_VB.zip)または[PDF のダウンロード](working-with-computed-columns-vb/_static/datatutorial71vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="21e38-105">[Download Code](http://download.microsoft.com/download/3/9/f/39f92b37-e92e-4ab3-909e-b4ef23d01aa3/ASPNET_Data_Tutorial_71_VB.zip) or [Download PDF](working-with-computed-columns-vb/_static/datatutorial71vb1.pdf)</span></span>

> <span data-ttu-id="21e38-106">データベース テーブルを作成するときは、Microsoft SQL Server を使用すると、その値は通常、同じデータベース レコードには、その他の値を参照する式から計算されます、計算列を定義できます。</span><span class="sxs-lookup"><span data-stu-id="21e38-106">When creating a database table, Microsoft SQL Server allows you to define a computed column whose value is calculated from an expression that usually references other values in the same database record.</span></span> <span data-ttu-id="21e38-107">このような値とは、Tableadapter を使用する場合は、特別な考慮事項を必要とすると、データベースは読み取り専用です。</span><span class="sxs-lookup"><span data-stu-id="21e38-107">Such values are read-only at the database, which requires special considerations when working with TableAdapters.</span></span> <span data-ttu-id="21e38-108">このチュートリアルでは、計算列によってもたらされる課題に対応する方法について説明します。</span><span class="sxs-lookup"><span data-stu-id="21e38-108">In this tutorial we learn how to meet the challenges posed by computed columns.</span></span>

## <a name="introduction"></a><span data-ttu-id="21e38-109">はじめに</span><span class="sxs-lookup"><span data-stu-id="21e38-109">Introduction</span></span>

<span data-ttu-id="21e38-110">Microsoft SQL Server では、 *[計算列](https://msdn.microsoft.com/library/ms191250.aspx)*、これらは列の値は通常、同じテーブル内の他の列から値を参照する式から計算されます。</span><span class="sxs-lookup"><span data-stu-id="21e38-110">Microsoft SQL Server allows for *[computed columns](https://msdn.microsoft.com/library/ms191250.aspx)*, which are columns whose values are calculated from an expression that usually references the values from other columns in the same table.</span></span> <span data-ttu-id="21e38-111">たとえば、データ モデルを追跡する時間がという名前のテーブルを必要があります`ServiceLog`を含む列を含む`ServicePerformed`、 `EmployeeID`、 `Rate`、および`Duration`、他のユーザーの間で。</span><span class="sxs-lookup"><span data-stu-id="21e38-111">As an example, a time tracking data model might have a table named `ServiceLog` with columns including `ServicePerformed`, `EmployeeID`, `Rate`, and `Duration`, among others.</span></span> <span data-ttu-id="21e38-112">支払額を中にサービスごと項目 (期間を掛けた料金をされている) は、web ページまたはその他のプログラム インターフェイスを介して計算でした、内の列を含める便利な場合があります、`ServiceLog`という名前のテーブル`AmountDue`これを報告します。情報。</span><span class="sxs-lookup"><span data-stu-id="21e38-112">While the amount due per service item (being the rate multiplied by the duration) could be calculated through a web page or other programmatic interface, it might be handy to include a column in the `ServiceLog` table named `AmountDue` that reported this information.</span></span> <span data-ttu-id="21e38-113">この列は、通常の列として作成する可能性がありますが、いつでも更新することは、`Rate`または`Duration`列値を変更します。</span><span class="sxs-lookup"><span data-stu-id="21e38-113">This column could be created as a normal column, but it would need to be updated anytime the `Rate` or `Duration` column values changed.</span></span> <span data-ttu-id="21e38-114">優れたアプローチするように設定、`AmountDue`列、式を使用して計算列`Rate * Duration`します。</span><span class="sxs-lookup"><span data-stu-id="21e38-114">A better approach would be to make the `AmountDue` column a computed column using the expression `Rate * Duration`.</span></span> <span data-ttu-id="21e38-115">これにより、SQL Server を自動的に計算、`AmountDue`クエリで参照されていたときに、列の値。</span><span class="sxs-lookup"><span data-stu-id="21e38-115">Doing so would cause SQL Server to automatically calculate the `AmountDue` column value whenever it was referenced in a query.</span></span>

<span data-ttu-id="21e38-116">計算列の値は、式によって決まりますがため、このような列は読み取り専用とそのためことはできませんが値に割り当てられたで`INSERT`または`UPDATE`ステートメント。</span><span class="sxs-lookup"><span data-stu-id="21e38-116">Since a computed column s value is determined by an expression, such columns are read-only and therefore cannot have values assigned to them in `INSERT` or `UPDATE` statements.</span></span> <span data-ttu-id="21e38-117">ただし、計算列が、アドホック SQL ステートメントを使用する TableAdapter のメイン クエリの一部である場合は、これらは自動的に追加で自動生成された`INSERT`と`UPDATE`ステートメント。</span><span class="sxs-lookup"><span data-stu-id="21e38-117">However, when computed columns are part of the main query for a TableAdapter that uses ad-hoc SQL statements, they are automatically included in the auto-generated `INSERT` and `UPDATE` statements.</span></span> <span data-ttu-id="21e38-118">Tableadapter ではその結果、`INSERT`と`UPDATE`クエリと`InsertCommand`と`UpdateCommand`計算列への参照を削除するプロパティを更新する必要があります。</span><span class="sxs-lookup"><span data-stu-id="21e38-118">Consequently, the TableAdapter s `INSERT` and `UPDATE` queries and `InsertCommand` and `UpdateCommand` properties must be updated to remove references to any computed columns.</span></span>

<span data-ttu-id="21e38-119">使用しての課題の 1 つは、アドホック SQL ステートメントを使用する TableAdapter の列を計算する、tableadapter は、`INSERT`と`UPDATE`クエリには、いつでも、TableAdapter 構成ウィザードの完了が自動的に再生成します。</span><span class="sxs-lookup"><span data-stu-id="21e38-119">One challenge of using computed columns with a TableAdapter that uses ad-hoc SQL statements is that the TableAdapter s `INSERT` and `UPDATE` queries are automatically regenerated any time the TableAdapter Configuration wizard is completed.</span></span> <span data-ttu-id="21e38-120">そのため、手動で計算列がから削除、`INSERT`と`UPDATE`ウィザードが再実行クエリが表示されなくなります。</span><span class="sxs-lookup"><span data-stu-id="21e38-120">Therefore, the computed columns manually removed from the `INSERT` and `UPDATE` queries will reappear if the wizard is re-run.</span></span> <span data-ttu-id="21e38-121">ストアド プロシージャを使用する Tableadapter のないこの脆弱性の低下が、手順 3 で扱うは独自の癖が。</span><span class="sxs-lookup"><span data-stu-id="21e38-121">Although TableAdapters that use stored procedures don t suffer from this brittleness, they do have their own quirks that we will address in Step 3.</span></span>

<span data-ttu-id="21e38-122">このチュートリアルでは、計算列を追加は、 `Suppliers` Northwind データベースのテーブルが表示され、このテーブルとその計算列を操作する対応する TableAdapter を作成します。</span><span class="sxs-lookup"><span data-stu-id="21e38-122">In this tutorial we will add a computed column to the `Suppliers` table in the Northwind database and then create a corresponding TableAdapter to work with this table and its computed column.</span></span> <span data-ttu-id="21e38-123">TableAdapter 構成ウィザードを使用すると、カスタマイズの喪失がないように、アドホック SQL ステートメントの代わりにストアド プロシージャを使用して、TableAdapter に、します。</span><span class="sxs-lookup"><span data-stu-id="21e38-123">We will have our TableAdapter use stored procedures instead of ad-hoc SQL statements so that our customizations aren't lost when the TableAdapter Configuration wizard is used.</span></span>

<span data-ttu-id="21e38-124">Let s を始めましょう。</span><span class="sxs-lookup"><span data-stu-id="21e38-124">Let s get started!</span></span>

## <a name="step-1-adding-a-computed-column-to-thesupplierstable"></a><span data-ttu-id="21e38-125">手順 1: 計算列を追加する、`Suppliers`テーブル</span><span class="sxs-lookup"><span data-stu-id="21e38-125">Step 1: Adding a Computed Column to the`Suppliers`Table</span></span>

<span data-ttu-id="21e38-126">Northwind データベースには計算列はないので、私たちは自分たちの 1 つを追加する必要があります。</span><span class="sxs-lookup"><span data-stu-id="21e38-126">The Northwind database does not have any computed columns so we will need to add one ourselves.</span></span> <span data-ttu-id="21e38-127">このチュートリアルが s の計算列を追加できるようにするため、`Suppliers`という名前のテーブル`FullContactName`連絡先の名前、タイトル、および各自が勤務する会社を返す、次の形式: `ContactName` (`ContactTitle`、 `CompanyName`)。</span><span class="sxs-lookup"><span data-stu-id="21e38-127">For this tutorial let s add a computed column to the `Suppliers` table called `FullContactName` that returns the contact s name, title, and the company they work for in the following format: `ContactName` (`ContactTitle`, `CompanyName`).</span></span> <span data-ttu-id="21e38-128">これは、計算列は仕入先に関する情報を表示するときに、レポートで使用する場合があります。</span><span class="sxs-lookup"><span data-stu-id="21e38-128">This computed column might be used in reports when displaying information about suppliers.</span></span>

<span data-ttu-id="21e38-129">開いて開始、`Suppliers`テーブル定義を右クリックして、`Suppliers`サーバー エクスプ ローラーでテーブルし、テーブル定義を開くのコンテキスト メニューから選択します。</span><span class="sxs-lookup"><span data-stu-id="21e38-129">Start by opening the `Suppliers` table definition by right-clicking on the `Suppliers` table in the Server Explorer and choosing Open Table Definition from the context-menu.</span></span> <span data-ttu-id="21e38-130">これが可能になるかどうか、テーブルとそれらのデータ型などのプロパティの列が表示されます`NULL`s など。</span><span class="sxs-lookup"><span data-stu-id="21e38-130">This will display the columns of the table and their properties, such as their data type, whether they allow `NULL` s, and so forth.</span></span> <span data-ttu-id="21e38-131">計算列を追加するには、テーブルの定義に列の名前を入力して起動します。</span><span class="sxs-lookup"><span data-stu-id="21e38-131">To add a computed column, start by typing in the name of the column into the table definition.</span></span> <span data-ttu-id="21e38-132">列のプロパティ ウィンドウで計算列の指定 セクション (数式) テキスト ボックスに次に、その式を入力します (図 1 参照)。</span><span class="sxs-lookup"><span data-stu-id="21e38-132">Next, enter its expression into the (Formula) textbox under the Computed Column Specification section in the Column Properties window (see Figure 1).</span></span> <span data-ttu-id="21e38-133">計算列の名前を`FullContactName`し、次の式を使用します。</span><span class="sxs-lookup"><span data-stu-id="21e38-133">Name the computed column `FullContactName` and use the following expression:</span></span>

[!code-sql[Main](working-with-computed-columns-vb/samples/sample1.sql)]

<span data-ttu-id="21e38-134">Sql 文字列を連結できることに注意してください。 を使用して、`+`演算子。</span><span class="sxs-lookup"><span data-stu-id="21e38-134">Note that strings can be concatenated in SQL using the `+` operator.</span></span> <span data-ttu-id="21e38-135">`CASE`と従来のプログラミング言語での条件付きステートメントに使用できます。</span><span class="sxs-lookup"><span data-stu-id="21e38-135">The `CASE` statement can be used like a conditional in a traditional programming language.</span></span> <span data-ttu-id="21e38-136">上記の式で、`CASE`としてステートメントを読み取ることができます。場合`ContactTitle`ない`NULL`出力し、`ContactTitle`それ以外の場合に、コンマで連結した値が何を出力します。</span><span class="sxs-lookup"><span data-stu-id="21e38-136">In the above expression the `CASE` statement can be read as: If `ContactTitle` is not `NULL` then output the `ContactTitle` value concatenated with a comma, otherwise emit nothing.</span></span> <span data-ttu-id="21e38-137">詳細の有用性について、`CASE`ステートメントを参照してください[SQL の電源`CASE`ステートメント](http://www.4guysfromrolla.com/webtech/102704-1.shtml)します。</span><span class="sxs-lookup"><span data-stu-id="21e38-137">For more on the usefulness of the `CASE` statement, see [The Power of SQL `CASE` Statements](http://www.4guysfromrolla.com/webtech/102704-1.shtml).</span></span>

> [!NOTE]
> <span data-ttu-id="21e38-138">使用する代わりに、`CASE`ステートメントは、ここでは、別の方法として使用できます`ISNULL(ContactTitle, '')`します。</span><span class="sxs-lookup"><span data-stu-id="21e38-138">Instead of using a `CASE` statement here, we could have alternatively used `ISNULL(ContactTitle, '')`.</span></span> <span data-ttu-id="21e38-139">[`ISNULL(checkExpression, replacementValue)`](https://msdn.microsoft.com/library/ms184325.aspx) 返します*checkExpression* NULL 以外の場合、それ以外の場合を返します*replacementValue*します。</span><span class="sxs-lookup"><span data-stu-id="21e38-139">[`ISNULL(checkExpression, replacementValue)`](https://msdn.microsoft.com/library/ms184325.aspx) returns *checkExpression* if it is non-NULL, otherwise it returns *replacementValue*.</span></span> <span data-ttu-id="21e38-140">中にいずれか`ISNULL`または`CASE`作業は、このインスタンスより複雑なシナリオでの柔軟性、`CASE`ステートメントは、によって照合されることはできません`ISNULL`。</span><span class="sxs-lookup"><span data-stu-id="21e38-140">While either `ISNULL` or `CASE` will work in this instance, there are more intricate scenarios where the flexibility of the `CASE` statement cannot be matched by `ISNULL`.</span></span>

<span data-ttu-id="21e38-141">この計算列を追加した後、画面が図 1 でスクリーン ショットのようになります。</span><span class="sxs-lookup"><span data-stu-id="21e38-141">After adding this computed column your screen should look like the screen shot in Figure 1.</span></span>

<span data-ttu-id="21e38-142">[![Suppliers テーブルを FullContactName をという名前の計算列を追加します。](working-with-computed-columns-vb/_static/image2.png)](working-with-computed-columns-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="21e38-142">[![Add a Computed Column Named FullContactName to the Suppliers Table](working-with-computed-columns-vb/_static/image2.png)](working-with-computed-columns-vb/_static/image1.png)</span></span>

<span data-ttu-id="21e38-143">**図 1**:計算列という追加`FullContactName`を`Suppliers`テーブル ([フルサイズの画像を表示する をクリックします](working-with-computed-columns-vb/_static/image3.png))。</span><span class="sxs-lookup"><span data-stu-id="21e38-143">**Figure 1**: Add a Computed Column Named `FullContactName` to the `Suppliers` Table ([Click to view full-size image](working-with-computed-columns-vb/_static/image3.png))</span></span>

<span data-ttu-id="21e38-144">計算列の名前を付け、その式を入力して後に、変更を保存の表に、ツールバーの [保存] アイコンをクリックして、[ファイル] メニューに移動して保存を選択または Ctrl + S を押す`Suppliers`します。</span><span class="sxs-lookup"><span data-stu-id="21e38-144">After naming the computed column and entering its expression, save the changes to the table by clicking the Save icon in the toolbar, by hitting Ctrl+S, or by going to the File menu and choosing Save `Suppliers`.</span></span>

<span data-ttu-id="21e38-145">テーブルを保存だけで追加した列を含む、サーバー エクスプ ローラーを更新する必要があります、`Suppliers`テーブル列のリスト。</span><span class="sxs-lookup"><span data-stu-id="21e38-145">Saving the table should refresh the Server Explorer, including the just-added column in the `Suppliers` table s column list.</span></span> <span data-ttu-id="21e38-146">(式) のテキスト ボックスに入力された式が不要な空白文字を削除、列名を角かっこで囲まれている同等の式を自動的に調整されてさらに、(`[]`) より明示的に表示するためにかっこが含まれています操作の順序:</span><span class="sxs-lookup"><span data-stu-id="21e38-146">Furthermore, the expression entered into the (Formula) textbox will automatically adjust to an equivalent expression that strips unnecessary whitespace, surrounds column names with brackets (`[]`), and includes parentheses to more explicitly show the order of operations:</span></span>

[!code-sql[Main](working-with-computed-columns-vb/samples/sample2.sql)]

<span data-ttu-id="21e38-147">Microsoft SQL Server の計算列の詳細についてを参照してください、[のテクニカル ドキュメント](https://msdn.microsoft.com/library/ms191250.aspx)します。</span><span class="sxs-lookup"><span data-stu-id="21e38-147">For more information on computed columns in Microsoft SQL Server, refer to the [technical documentation](https://msdn.microsoft.com/library/ms191250.aspx).</span></span> <span data-ttu-id="21e38-148">チェック アウトも、[方法。計算列を指定する](https://msdn.microsoft.com/library/ms188300.aspx)詳しい手順については、計算列を作成します。</span><span class="sxs-lookup"><span data-stu-id="21e38-148">Also check out the [How to: Specify Computed Columns](https://msdn.microsoft.com/library/ms188300.aspx) for a step-by-step walkthrough of creating computed columns.</span></span>

> [!NOTE]
> <span data-ttu-id="21e38-149">計算列は既定では、テーブルに物理的に格納されませんが代わりに、クエリで参照されるたびに再計算されます。</span><span class="sxs-lookup"><span data-stu-id="21e38-149">By default, computed columns are not physically stored in the table but are instead recalculated each time they are referenced in a query.</span></span> <span data-ttu-id="21e38-150">ただし、永続化は、チェック ボックスをオンは、物理的にテーブルに計算列を格納する SQL Server を指示できます。</span><span class="sxs-lookup"><span data-stu-id="21e38-150">By checking the Is Persisted checkbox, however, you can instruct SQL Server to physically store the computed column in the table.</span></span> <span data-ttu-id="21e38-151">これにより、計算列の値を使用するクエリのパフォーマンスを向上させることができます、計算列上に作成されるインデックス、`WHERE`句。</span><span class="sxs-lookup"><span data-stu-id="21e38-151">Doing so allows an index to be created on the computed column, which can improve the performance of queries that use the computed column value in their `WHERE` clauses.</span></span> <span data-ttu-id="21e38-152">参照してください[計算列でインデックスを作成する](https://msdn.microsoft.com/library/ms189292.aspx)詳細についてはします。</span><span class="sxs-lookup"><span data-stu-id="21e38-152">See [Creating Indexes on Computed Columns](https://msdn.microsoft.com/library/ms189292.aspx) for more information.</span></span>

## <a name="step-2-viewing-the-computed-column-s-values"></a><span data-ttu-id="21e38-153">手順 2: 計算列の値を表示します。</span><span class="sxs-lookup"><span data-stu-id="21e38-153">Step 2: Viewing the Computed Column s Values</span></span>

<span data-ttu-id="21e38-154">Let s を表示するには、1 分でデータ アクセス層の作業を始める前に、`FullContactName`値。</span><span class="sxs-lookup"><span data-stu-id="21e38-154">Before we start work on the Data Access Layer, let s take a minute to view the `FullContactName` values.</span></span> <span data-ttu-id="21e38-155">サーバー エクスプ ローラーを右クリックし、`Suppliers`テーブル名と、コンテキスト メニューから新しいクエリを選択します。</span><span class="sxs-lookup"><span data-stu-id="21e38-155">From the Server Explorer, right-click on the `Suppliers` table name and choose New Query from the context-menu.</span></span> <span data-ttu-id="21e38-156">これは、クエリに含めるには、どのようなテーブルを選択することを要求するクエリ ウィンドウが表示されます。</span><span class="sxs-lookup"><span data-stu-id="21e38-156">This will bring up a Query window that prompts us to choose what tables to include in the query.</span></span> <span data-ttu-id="21e38-157">追加、`Suppliers`テーブルし、[閉じる] をクリックします。</span><span class="sxs-lookup"><span data-stu-id="21e38-157">Add the `Suppliers` table and click Close.</span></span> <span data-ttu-id="21e38-158">次に、確認、 `CompanyName`、 `ContactName`、 `ContactTitle`、および`FullContactName`Suppliers テーブルから列。</span><span class="sxs-lookup"><span data-stu-id="21e38-158">Next, check the `CompanyName`, `ContactName`, `ContactTitle`, and `FullContactName` columns from the Suppliers table.</span></span> <span data-ttu-id="21e38-159">最後に、クエリを実行し、結果を表示するには、ツールバーの赤色の感嘆符アイコンをクリックします。</span><span class="sxs-lookup"><span data-stu-id="21e38-159">Finally, click the red exclamation point icon in the Toolbar to execute the query and view the results.</span></span>

<span data-ttu-id="21e38-160">図 2 は、結果が含まれます`FullContactName`が一覧表示、 `CompanyName`、 `ContactName`、および`ContactTitle`形式を使用して列`ContactName`(`ContactTitle`、 `CompanyName`)。</span><span class="sxs-lookup"><span data-stu-id="21e38-160">As Figure 2 shows, the results include `FullContactName`, which lists the `CompanyName`, `ContactName`, and `ContactTitle` columns using the format `ContactName` (`ContactTitle`, `CompanyName`) .</span></span>

<span data-ttu-id="21e38-161">[![FullContactName 形式 ContactName (部署、CompanyName) を使用します。](working-with-computed-columns-vb/_static/image5.png)](working-with-computed-columns-vb/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="21e38-161">[![The FullContactName Uses the Format ContactName (ContactTitle, CompanyName)](working-with-computed-columns-vb/_static/image5.png)](working-with-computed-columns-vb/_static/image4.png)</span></span>

<span data-ttu-id="21e38-162">**図 2**:`FullContactName`形式を使用して`ContactName`(`ContactTitle`、 `CompanyName`) ([フルサイズの画像を表示する をクリックします](working-with-computed-columns-vb/_static/image6.png))。</span><span class="sxs-lookup"><span data-stu-id="21e38-162">**Figure 2**: The `FullContactName` Uses the Format `ContactName` (`ContactTitle`, `CompanyName`) ([Click to view full-size image](working-with-computed-columns-vb/_static/image6.png))</span></span>

## <a name="step-3-adding-thesupplierstableadapterto-the-data-access-layer"></a><span data-ttu-id="21e38-163">手順 3: 追加、`SuppliersTableAdapter`データ アクセス層に</span><span class="sxs-lookup"><span data-stu-id="21e38-163">Step 3: Adding the`SuppliersTableAdapter`to the Data Access Layer</span></span>

<span data-ttu-id="21e38-164">アプリケーションでは、仕入先情報を処理するためには、まず、DAL で TableAdapter と DataTable を作成する必要があります。</span><span class="sxs-lookup"><span data-stu-id="21e38-164">In order to work with the supplier information in our application we need to first create a TableAdapter and DataTable in our DAL.</span></span> <span data-ttu-id="21e38-165">理想的には、これを達成する前のチュートリアルで同じ簡単な手順を使用します。</span><span class="sxs-lookup"><span data-stu-id="21e38-165">Ideally, this would be accomplished using the same straightforward steps examined in earlier tutorials.</span></span> <span data-ttu-id="21e38-166">ただし、計算列の使用には、ディスカッションだけの価値をいくつかのしわが導入されています。</span><span class="sxs-lookup"><span data-stu-id="21e38-166">However, working with computed columns introduces a few wrinkles that merit discussion.</span></span>

<span data-ttu-id="21e38-167">アドホック SQL ステートメントを使用する TableAdapter を使用している場合、TableAdapter 構成ウィザードを使用して TableAdapter のメイン クエリで計算列を単純に含めることができます。</span><span class="sxs-lookup"><span data-stu-id="21e38-167">If you are using a TableAdapter that uses ad-hoc SQL statements, you can simply include the computed column in the TableAdapter s main query via the TableAdapter Configuration wizard.</span></span> <span data-ttu-id="21e38-168">これは、ただし、自動生成`INSERT`と`UPDATE`計算列を含むステートメント。</span><span class="sxs-lookup"><span data-stu-id="21e38-168">This, however, will auto-generate `INSERT` and `UPDATE` statements that include the computed column.</span></span> <span data-ttu-id="21e38-169">これらのメソッドのいずれかを実行しようとした場合、`SqlException`メッセージ列*ColumnName*か計算列、または UNION 演算子の結果がスローされますがために変更できません。</span><span class="sxs-lookup"><span data-stu-id="21e38-169">If you attempt to execute one of these methods, a `SqlException` with the message The column *ColumnName* cannot be modified because it is either a computed column or is the result of a UNION operator will be thrown.</span></span> <span data-ttu-id="21e38-170">中に、`INSERT`と`UPDATE`ステートメントは、tableadapter で手動で調整`InsertCommand`と`UpdateCommand`プロパティ、これらのカスタマイズは失われます TableAdapter 構成ウィザードが再実行されるたびにします。</span><span class="sxs-lookup"><span data-stu-id="21e38-170">While the `INSERT` and `UPDATE` statement can be manually adjusted through the TableAdapter s `InsertCommand` and `UpdateCommand` properties, these customizations will be lost whenever the TableAdapter Configuration wizard is re-run.</span></span>

<span data-ttu-id="21e38-171">アドホック SQL ステートメントを使用して Tableadapter の脆弱性、により、計算列を使用する場合、ストアド プロシージャを使用しましたをお勧めします。</span><span class="sxs-lookup"><span data-stu-id="21e38-171">Due to the brittleness of TableAdapters that use ad-hoc SQL statements, it is recommended that we use stored procedures when working with computed columns.</span></span> <span data-ttu-id="21e38-172">既存のストアド プロシージャを使用している場合だけ、TableAdapter でを構成、[型指定されたデータセット s Tableadapter の既存のストアド プロシージャの使用](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb.md)チュートリアル。</span><span class="sxs-lookup"><span data-stu-id="21e38-172">If you are using existing stored procedures, simply configure the TableAdapter as discussed in the [Using Existing Stored Procedures for the Typed DataSet s TableAdapters](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb.md) tutorial.</span></span> <span data-ttu-id="21e38-173">ストアド プロシージャは作成、TableAdapter ウィザードを使っている場合が最初に、メイン クエリの計算列を省略する場合に重要です。</span><span class="sxs-lookup"><span data-stu-id="21e38-173">If you have the TableAdapter wizard create the stored procedures for you, however, it is important to initially omit any computed columns from the main query.</span></span> <span data-ttu-id="21e38-174">場合は、メイン クエリで計算列を含めると、TableAdapter 構成ウィザードが表示されます、完了すると、対応するストアド プロシージャを作成することはできません。</span><span class="sxs-lookup"><span data-stu-id="21e38-174">If you include a computed column in the main query, the TableAdapter Configuration wizard will inform you, upon completion, that it cannot create the corresponding stored procedures.</span></span> <span data-ttu-id="21e38-175">つまり、最初に計算列のないメイン クエリを使用して、TableAdapter を構成し、対応するストアド プロシージャと、tableadapter を手動で更新する必要があります`SelectCommand`計算列を含めるようにします。</span><span class="sxs-lookup"><span data-stu-id="21e38-175">In short, we need to initially configure the TableAdapter using a computed column-free main query and then manually update the corresponding stored procedure and the TableAdapter s `SelectCommand` to include the computed column.</span></span> <span data-ttu-id="21e38-176">このアプローチで使用されるものと似ています、 [TableAdapter を使用する更新](updating-the-tableadapter-to-use-joins-vb.md)`JOIN`*s*チュートリアル。</span><span class="sxs-lookup"><span data-stu-id="21e38-176">This approach is similar to the one used in the [Updating the TableAdapter to Use](updating-the-tableadapter-to-use-joins-vb.md)`JOIN`*s* tutorial.</span></span>

<span data-ttu-id="21e38-177">このチュートリアルでは新しい TableAdapter を追加し、私たちのストアド プロシージャを自動的に作成させることができます。</span><span class="sxs-lookup"><span data-stu-id="21e38-177">For this tutorial, let s add a new TableAdapter and have it automatically create the stored procedures for us.</span></span> <span data-ttu-id="21e38-178">最初に省略する必要がありますが、その結果、`FullContactName`メイン クエリから列を計算します。</span><span class="sxs-lookup"><span data-stu-id="21e38-178">Consequently, we will need to initially omit the `FullContactName` computed column from the main query.</span></span>

<span data-ttu-id="21e38-179">開いて開始、`NorthwindWithSprocs`データセットで、`~/App_Code/DAL`フォルダー。</span><span class="sxs-lookup"><span data-stu-id="21e38-179">Start by opening the `NorthwindWithSprocs` DataSet in the `~/App_Code/DAL` folder.</span></span> <span data-ttu-id="21e38-180">デザイナーを右クリックし、コンテキスト メニューから新しい TableAdapter を追加することもできます。</span><span class="sxs-lookup"><span data-stu-id="21e38-180">Right-click in the Designer and, from the context-menu, choose to add a new TableAdapter.</span></span> <span data-ttu-id="21e38-181">これにより、TableAdapter 構成ウィザードが起動します。</span><span class="sxs-lookup"><span data-stu-id="21e38-181">This will launch the TableAdapter Configuration wizard.</span></span> <span data-ttu-id="21e38-182">データをクエリするデータベースを指定 (`NORTHWNDConnectionString`から`Web.config`) [次へ] をクリックします。</span><span class="sxs-lookup"><span data-stu-id="21e38-182">Specify the database to query data from (`NORTHWNDConnectionString` from `Web.config`) and click Next.</span></span> <span data-ttu-id="21e38-183">クエリまたは変更するための任意のストアド プロシージャを作成しないしましたので、`Suppliers`テーブルで、新しいストアド プロシージャはオプション ウィザードを作成し、次へ を作成 を選択します。</span><span class="sxs-lookup"><span data-stu-id="21e38-183">Since we have not yet created any stored procedures for querying or modifying the `Suppliers` table, select the Create new stored procedures option so that the wizard will create them for us and click Next.</span></span>

<span data-ttu-id="21e38-184">[![作成する新しいストアド プロシージャ オプションを選択します。](working-with-computed-columns-vb/_static/image8.png)](working-with-computed-columns-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="21e38-184">[![Choose the Create new stored procedures Option](working-with-computed-columns-vb/_static/image8.png)](working-with-computed-columns-vb/_static/image7.png)</span></span>

<span data-ttu-id="21e38-185">**図 3**:作成する新しいストアド プロシージャ オプションの選択 ([フルサイズの画像を表示する をクリックします](working-with-computed-columns-vb/_static/image9.png))。</span><span class="sxs-lookup"><span data-stu-id="21e38-185">**Figure 3**: Choose the Create new stored procedures Option ([Click to view full-size image](working-with-computed-columns-vb/_static/image9.png))</span></span>

<span data-ttu-id="21e38-186">後続の手順には、メイン クエリのことが求められます。</span><span class="sxs-lookup"><span data-stu-id="21e38-186">The subsequent step prompts us for the main query.</span></span> <span data-ttu-id="21e38-187">返す次のクエリを入力して、 `SupplierID`、 `CompanyName`、 `ContactName`、および`ContactTitle`各仕入先の列。</span><span class="sxs-lookup"><span data-stu-id="21e38-187">Enter the following query, which returns the `SupplierID`, `CompanyName`, `ContactName`, and `ContactTitle` columns for each supplier.</span></span> <span data-ttu-id="21e38-188">このクエリは、計算列を意図的省略に注意してください (`FullContactName`); 手順 4. でこの列を含めるように対応するストアド プロシージャが更新されます。</span><span class="sxs-lookup"><span data-stu-id="21e38-188">Note that this query purposefully omits the computed column (`FullContactName`); we will update the corresponding stored procedure to include this column in Step 4.</span></span>

[!code-sql[Main](working-with-computed-columns-vb/samples/sample3.sql)]

<span data-ttu-id="21e38-189">ウィザードでは、メインのクエリを入力し、次にクリックするを生成する 4 つのストアド プロシージャの名前を付けることができます。</span><span class="sxs-lookup"><span data-stu-id="21e38-189">After entering the main query and clicking Next, the wizard allows us to name the four stored procedures it will generate.</span></span> <span data-ttu-id="21e38-190">これらのストアド プロシージャの名前を付けます`Suppliers_Select`、 `Suppliers_Insert`、 `Suppliers_Update`、および`Suppliers_Delete`図 4 に示すようにします。</span><span class="sxs-lookup"><span data-stu-id="21e38-190">Name these stored procedures `Suppliers_Select`, `Suppliers_Insert`, `Suppliers_Update`, and `Suppliers_Delete`, as Figure 4 illustrates.</span></span>

<span data-ttu-id="21e38-191">[![自動生成ストアド プロシージャの名前をカスタマイズします。](working-with-computed-columns-vb/_static/image11.png)](working-with-computed-columns-vb/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="21e38-191">[![Customize the Names of the Auto-Generated Stored Procedures](working-with-computed-columns-vb/_static/image11.png)](working-with-computed-columns-vb/_static/image10.png)</span></span>

<span data-ttu-id="21e38-192">**図 4**:Auto-Generated ストアド プロシージャの名前をカスタマイズ ([フルサイズの画像を表示する をクリックします](working-with-computed-columns-vb/_static/image12.png))。</span><span class="sxs-lookup"><span data-stu-id="21e38-192">**Figure 4**: Customize the Names of the Auto-Generated Stored Procedures ([Click to view full-size image](working-with-computed-columns-vb/_static/image12.png))</span></span>

<span data-ttu-id="21e38-193">ウィザードの次の手順では、メソッド、TableAdapter の名前し、データにアクセスして更新するために使用するパターンを指定できます。</span><span class="sxs-lookup"><span data-stu-id="21e38-193">The next wizard step allows us to name the TableAdapter s methods and specify the patterns used to access and update data.</span></span> <span data-ttu-id="21e38-194">すべての 3 つチェック ボックスをオンにしたままにしますが、名前を変更、`GetData`メソッドを`GetSuppliers`します。</span><span class="sxs-lookup"><span data-stu-id="21e38-194">Leave all three checkboxes checked, but rename the `GetData` method to `GetSuppliers`.</span></span> <span data-ttu-id="21e38-195">ウィザードを完了するには、[完了] をクリックします。</span><span class="sxs-lookup"><span data-stu-id="21e38-195">Click Finish to complete the wizard.</span></span>

<span data-ttu-id="21e38-196">[![GetSuppliers に GetData メソッドの名前を変更します。](working-with-computed-columns-vb/_static/image14.png)](working-with-computed-columns-vb/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="21e38-196">[![Rename the GetData Method to GetSuppliers](working-with-computed-columns-vb/_static/image14.png)](working-with-computed-columns-vb/_static/image13.png)</span></span>

<span data-ttu-id="21e38-197">**図 5**:名前の変更、`GetData`メソッドを`GetSuppliers`([フルサイズの画像を表示する をクリックします](working-with-computed-columns-vb/_static/image15.png))。</span><span class="sxs-lookup"><span data-stu-id="21e38-197">**Figure 5**: Rename the `GetData` Method to `GetSuppliers` ([Click to view full-size image](working-with-computed-columns-vb/_static/image15.png))</span></span>

<span data-ttu-id="21e38-198">[完了] をクリックすると、ウィザードは 4 つのストアド プロシージャを作成し、型指定されたデータセットに TableAdapter と対応する DataTable を追加します。</span><span class="sxs-lookup"><span data-stu-id="21e38-198">Upon clicking Finish, the wizard will create the four stored procedures and add the TableAdapter and corresponding DataTable to the Typed DataSet.</span></span>

## <a name="step-4-including-the-computed-column-in-the-tableadapter-s-main-query"></a><span data-ttu-id="21e38-199">手順 4: TableAdapter のメイン クエリで計算列を含む</span><span class="sxs-lookup"><span data-stu-id="21e38-199">Step 4: Including the Computed Column in the TableAdapter s Main Query</span></span>

<span data-ttu-id="21e38-200">これで、TableAdapter を更新する必要があり、DataTable の作成に含める手順 3. で、`FullContactName`計算列。</span><span class="sxs-lookup"><span data-stu-id="21e38-200">We now need to update the TableAdapter and DataTable created in Step 3 to include the `FullContactName` computed column.</span></span> <span data-ttu-id="21e38-201">これには、2 つの手順が含まれます。</span><span class="sxs-lookup"><span data-stu-id="21e38-201">This involves two steps:</span></span>

1. <span data-ttu-id="21e38-202">更新、`Suppliers_Select`ストアド プロシージャから返される、`FullContactName`計算列、および</span><span class="sxs-lookup"><span data-stu-id="21e38-202">Updating the `Suppliers_Select` stored procedure to return the `FullContactName` computed column, and</span></span>
2. <span data-ttu-id="21e38-203">更新に対応する DataTable`FullContactName`列。</span><span class="sxs-lookup"><span data-stu-id="21e38-203">Updating the DataTable to include a corresponding `FullContactName` column.</span></span>

<span data-ttu-id="21e38-204">サーバー エクスプ ローラーに移動し、ストアド プロシージャ フォルダーにドリル ダウンを開始します。</span><span class="sxs-lookup"><span data-stu-id="21e38-204">Start by navigating to the Server Explorer and drilling down into the Stored Procedures folder.</span></span> <span data-ttu-id="21e38-205">開く、`Suppliers_Select`ストアド プロシージャと更新プログラム、`SELECT`クエリに含まれる、`FullContactName`計算列。</span><span class="sxs-lookup"><span data-stu-id="21e38-205">Open the `Suppliers_Select` stored procedure and update the `SELECT` query to include the `FullContactName` computed column:</span></span>

[!code-sql[Main](working-with-computed-columns-vb/samples/sample4.sql)]

<span data-ttu-id="21e38-206">ツールバーの 保存 アイコンをクリックすると、Ctrl + S を押す、または保存を選択して、ストアド プロシージャに変更を保存`Suppliers_Select`ファイル メニュー オプション。</span><span class="sxs-lookup"><span data-stu-id="21e38-206">Save the changes to the stored procedure by clicking the Save icon in the Toolbar, by hitting Ctrl+S, or by choosing the Save `Suppliers_Select` option from the File menu.</span></span>

<span data-ttu-id="21e38-207">次に、データセット デザイナーに戻り、右クリックし、 `SuppliersTableAdapter`、コンテキスト メニューから構成を選択します。</span><span class="sxs-lookup"><span data-stu-id="21e38-207">Next, return to the DataSet Designer, right-click on the `SuppliersTableAdapter`, and choose Configure from the context-menu.</span></span> <span data-ttu-id="21e38-208">なお、`Suppliers_Select`列が含まれています、`FullContactName`データ列がコレクション内の列。</span><span class="sxs-lookup"><span data-stu-id="21e38-208">Note that the `Suppliers_Select` column now includes the `FullContactName` column in its Data Columns collection.</span></span>

<span data-ttu-id="21e38-209">[![DataTable の列を更新するには、TableAdapter の構成ウィザードを実行します。](working-with-computed-columns-vb/_static/image17.png)](working-with-computed-columns-vb/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="21e38-209">[![Run the TableAdapter s Configuration Wizard to Update the DataTable s Columns](working-with-computed-columns-vb/_static/image17.png)](working-with-computed-columns-vb/_static/image16.png)</span></span>

<span data-ttu-id="21e38-210">**図 6**:Tableadapter の DataTable の列を更新する構成ウィザードを実行 ([フルサイズの画像を表示する をクリックします](working-with-computed-columns-vb/_static/image18.png))。</span><span class="sxs-lookup"><span data-stu-id="21e38-210">**Figure 6**: Run the TableAdapter s Configuration Wizard to Update the DataTable s Columns ([Click to view full-size image](working-with-computed-columns-vb/_static/image18.png))</span></span>

<span data-ttu-id="21e38-211">ウィザードを完了するには、[完了] をクリックします。</span><span class="sxs-lookup"><span data-stu-id="21e38-211">Click Finish to complete the wizard.</span></span> <span data-ttu-id="21e38-212">これに対応する列を自動的に追加されます、`SuppliersDataTable`します。</span><span class="sxs-lookup"><span data-stu-id="21e38-212">This will automatically add a corresponding column to the `SuppliersDataTable`.</span></span> <span data-ttu-id="21e38-213">TableAdapter ウィザードでは、ことを検出するのに十分なスマート、`FullContactName`列が計算列および読み取り専用です。</span><span class="sxs-lookup"><span data-stu-id="21e38-213">The TableAdapter wizard is smart enough to detect that the `FullContactName` column is a computed column and therefore read-only.</span></span> <span data-ttu-id="21e38-214">その結果、s の列を設定`ReadOnly`プロパティを`true`します。</span><span class="sxs-lookup"><span data-stu-id="21e38-214">Consequently, it sets the column s `ReadOnly` property to `true`.</span></span> <span data-ttu-id="21e38-215">これを確認するから列を選択、`SuppliersDataTable`し、[プロパティ] ウィンドウに移動します (図 7 を参照してください)。</span><span class="sxs-lookup"><span data-stu-id="21e38-215">To verify this, select the column from the `SuppliersDataTable` and then go to the Properties window (see Figure 7).</span></span> <span data-ttu-id="21e38-216">なお、`FullContactName`列 s`DataType`と`MaxLength`プロパティが適宜設定もします。</span><span class="sxs-lookup"><span data-stu-id="21e38-216">Note that the `FullContactName` column s `DataType` and `MaxLength` properties are also set accordingly.</span></span>

<span data-ttu-id="21e38-217">[![FullContactName 列が読み取り専用としてマークされています。](working-with-computed-columns-vb/_static/image20.png)](working-with-computed-columns-vb/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="21e38-217">[![The FullContactName Column is Marked as Read-Only](working-with-computed-columns-vb/_static/image20.png)](working-with-computed-columns-vb/_static/image19.png)</span></span>

<span data-ttu-id="21e38-218">**図 7**:`FullContactName`列は読み取り専用とマークされている ([フルサイズの画像を表示する をクリックします](working-with-computed-columns-vb/_static/image21.png))。</span><span class="sxs-lookup"><span data-stu-id="21e38-218">**Figure 7**: The `FullContactName` Column is Marked as Read-Only ([Click to view full-size image](working-with-computed-columns-vb/_static/image21.png))</span></span>

## <a name="step-5-adding-agetsupplierbysupplieridmethod-to-the-tableadapter"></a><span data-ttu-id="21e38-219">手順 5: 追加、`GetSupplierBySupplierID`TableAdapter にメソッド</span><span class="sxs-lookup"><span data-stu-id="21e38-219">Step 5: Adding a`GetSupplierBySupplierID`Method to the TableAdapter</span></span>

<span data-ttu-id="21e38-220">このチュートリアルでは、更新可能なグリッドで仕入先を表示する ASP.NET ページを作成します。</span><span class="sxs-lookup"><span data-stu-id="21e38-220">For this tutorial we will create an ASP.NET page that displays the suppliers in an updateable grid.</span></span> <span data-ttu-id="21e38-221">過去のチュートリアルを更新したビジネス ロジック層から 1 つのレコードに変更を反映する DAL バックアップとして厳密に型指定された DataTable、そのプロパティを更新し、更新された DataTable を送信 DAL から特定のレコードを取得することによってデータベースです。</span><span class="sxs-lookup"><span data-stu-id="21e38-221">In past tutorials we have updated a single record from the Business Logic Layer by retrieving that particular record from the DAL as a strongly-typed DataTable, updating its properties, and then sending the updated DataTable back to the DAL to propagate the changes to the database.</span></span> <span data-ttu-id="21e38-222">最初に追加する - DAL から更新されるレコードの取得 - この最初の手順を実行する、 `GetSupplierBySupplierID(supplierID)` DAL に対するメソッド。</span><span class="sxs-lookup"><span data-stu-id="21e38-222">To accomplish this first step - retrieving the record being updated from the DAL - we need to first add a `GetSupplierBySupplierID(supplierID)` method to the DAL.</span></span>

<span data-ttu-id="21e38-223">右クリックし、`SuppliersTableAdapter`データセット デザインで、コンテキスト メニューから、クエリの追加オプションを選択します。</span><span class="sxs-lookup"><span data-stu-id="21e38-223">Right-click on the `SuppliersTableAdapter` in the DataSet Design and choose the Add Query option from the context-menu.</span></span> <span data-ttu-id="21e38-224">手順 3 で行ったように、私たちにとって新しいストアド プロシージャの作成 オプションを選択して、新しいストアド プロシージャを生成するウィザード (参照図 3 のこの手順のスクリーン ショット)。</span><span class="sxs-lookup"><span data-stu-id="21e38-224">As we did in Step 3, let the wizard generate a new stored procedure for us by selecting the Create new stored procedure option (refer back to Figure 3 for a screenshot of this wizard step).</span></span> <span data-ttu-id="21e38-225">このメソッドでは、複数の列を持つレコードを返します、ため複数行を返す SELECT である SQL クエリを使用し、[次へ] をクリックすることを示します。</span><span class="sxs-lookup"><span data-stu-id="21e38-225">Since this method will return a record with multiple columns, indicate that we want to use a SQL query that is a SELECT which returns rows and click Next.</span></span>

<span data-ttu-id="21e38-226">[![選択 オプションを複数行を返す](working-with-computed-columns-vb/_static/image23.png)](working-with-computed-columns-vb/_static/image22.png)</span><span class="sxs-lookup"><span data-stu-id="21e38-226">[![Choose the SELECT which returns rows Option](working-with-computed-columns-vb/_static/image23.png)](working-with-computed-columns-vb/_static/image22.png)</span></span>

<span data-ttu-id="21e38-227">**図 8**:[選択] オプションを複数行を返す ([フルサイズの画像を表示する をクリックします](working-with-computed-columns-vb/_static/image24.png))。</span><span class="sxs-lookup"><span data-stu-id="21e38-227">**Figure 8**: Choose the SELECT which returns rows Option ([Click to view full-size image](working-with-computed-columns-vb/_static/image24.png))</span></span>

<span data-ttu-id="21e38-228">後続の手順では、このメソッドを使用するクエリの場合、us ように求められます。</span><span class="sxs-lookup"><span data-stu-id="21e38-228">The subsequent step prompts us for the query to use for this method.</span></span> <span data-ttu-id="21e38-229">特定仕入先が、メインのクエリとしては、同じデータ フィールドを返すと、次を入力します。</span><span class="sxs-lookup"><span data-stu-id="21e38-229">Enter the following, which returns the same data fields as the main query but for a particular supplier.</span></span>

[!code-sql[Main](working-with-computed-columns-vb/samples/sample5.sql)]

<span data-ttu-id="21e38-230">次の画面は、自動生成されるストアド プロシージャの名前にします。</span><span class="sxs-lookup"><span data-stu-id="21e38-230">The next screen asks us to name the stored procedure that will be auto-generated.</span></span> <span data-ttu-id="21e38-231">このストアド プロシージャの名前を付けます`Suppliers_SelectBySupplierID`[次へ] をクリックします。</span><span class="sxs-lookup"><span data-stu-id="21e38-231">Name this stored procedure `Suppliers_SelectBySupplierID` and click Next.</span></span>

<span data-ttu-id="21e38-232">[![ストアド プロシージャ Suppliers_SelectBySupplierID 名](working-with-computed-columns-vb/_static/image26.png)](working-with-computed-columns-vb/_static/image25.png)</span><span class="sxs-lookup"><span data-stu-id="21e38-232">[![Name the Stored Procedure Suppliers_SelectBySupplierID](working-with-computed-columns-vb/_static/image26.png)](working-with-computed-columns-vb/_static/image25.png)</span></span>

<span data-ttu-id="21e38-233">**図 9**:ストアド プロシージャの名前を付けます`Suppliers_SelectBySupplierID`([フルサイズの画像を表示する をクリックします](working-with-computed-columns-vb/_static/image27.png))。</span><span class="sxs-lookup"><span data-stu-id="21e38-233">**Figure 9**: Name the Stored Procedure `Suppliers_SelectBySupplierID` ([Click to view full-size image](working-with-computed-columns-vb/_static/image27.png))</span></span>

<span data-ttu-id="21e38-234">最後に、ウィザードの指示、データの場合、us へのアクセス パターンと、TableAdapter を使用するメソッドの名前。</span><span class="sxs-lookup"><span data-stu-id="21e38-234">Lastly, the wizard prompts us for the data access patterns and method names to use for the TableAdapter.</span></span> <span data-ttu-id="21e38-235">両方のチェック ボックスがオンのままにしますが、名前を変更、`FillBy`と`GetDataBy`メソッド`FillBySupplierID`と`GetSupplierBySupplierID`、それぞれします。</span><span class="sxs-lookup"><span data-stu-id="21e38-235">Leave both checkboxes checked, but rename the `FillBy` and `GetDataBy` methods to `FillBySupplierID` and `GetSupplierBySupplierID`, respectively.</span></span>

<span data-ttu-id="21e38-236">[![名前、TableAdapter メソッド FillBySupplierID と GetSupplierBySupplierID](working-with-computed-columns-vb/_static/image29.png)](working-with-computed-columns-vb/_static/image28.png)</span><span class="sxs-lookup"><span data-stu-id="21e38-236">[![Name the TableAdapter Methods FillBySupplierID and GetSupplierBySupplierID](working-with-computed-columns-vb/_static/image29.png)](working-with-computed-columns-vb/_static/image28.png)</span></span>

<span data-ttu-id="21e38-237">**図 10**:TableAdapter のメソッドの名前を付けます`FillBySupplierID`と`GetSupplierBySupplierID`([フルサイズの画像を表示する をクリックします](working-with-computed-columns-vb/_static/image30.png))。</span><span class="sxs-lookup"><span data-stu-id="21e38-237">**Figure 10**: Name the TableAdapter Methods `FillBySupplierID` and `GetSupplierBySupplierID` ([Click to view full-size image](working-with-computed-columns-vb/_static/image30.png))</span></span>

<span data-ttu-id="21e38-238">ウィザードを完了するには、[完了] をクリックします。</span><span class="sxs-lookup"><span data-stu-id="21e38-238">Click Finish to complete the wizard.</span></span>

## <a name="step-6-creating-the-business-logic-layer"></a><span data-ttu-id="21e38-239">手順 6: ビジネス ロジック層を作成します。</span><span class="sxs-lookup"><span data-stu-id="21e38-239">Step 6: Creating the Business Logic Layer</span></span>

<span data-ttu-id="21e38-240">手順 1 で作成した計算列を使用する ASP.NET ページを作成する前にまず BLL に対応するメソッドを追加する必要があります。</span><span class="sxs-lookup"><span data-stu-id="21e38-240">Before we create an ASP.NET page that uses the computed column created in Step 1, we first need to add the corresponding methods in the BLL.</span></span> <span data-ttu-id="21e38-241">ASP.NET ページで、手順 7. で作成しますが、これにより、ユーザーを表示および suppliers を編集します。</span><span class="sxs-lookup"><span data-stu-id="21e38-241">Our ASP.NET page, which we will create in Step 7, will allow users to view and edit suppliers.</span></span> <span data-ttu-id="21e38-242">そのため、当社 BLL には少なくとも、すべての仕入先と別特定のサプライヤーの更新を取得する方法を提供する必要があります。</span><span class="sxs-lookup"><span data-stu-id="21e38-242">Therefore, we need our BLL to provide, at minimum, a method to get all of the suppliers and another to update a particular supplier.</span></span>

<span data-ttu-id="21e38-243">という名前の新しいクラス ファイルを作成`SuppliersBLLWithSprocs`で、`~/App_Code/BLL`フォルダーし、次のコードを追加します。</span><span class="sxs-lookup"><span data-stu-id="21e38-243">Create a new class file named `SuppliersBLLWithSprocs` in the `~/App_Code/BLL` folder and add the following code:</span></span>

[!code-vb[Main](working-with-computed-columns-vb/samples/sample6.vb)]

<span data-ttu-id="21e38-244">などの他の BLL クラス`SuppliersBLLWithSprocs`が、 `Protected` `Adapter`プロパティのインスタンスを返す、`SuppliersTableAdapter`クラスと共に使用する 2 つ`Public`メソッド:`GetSuppliers`と`UpdateSupplier`します。</span><span class="sxs-lookup"><span data-stu-id="21e38-244">Like the other BLL classes, `SuppliersBLLWithSprocs` has a `Protected` `Adapter` property that returns an instance of the `SuppliersTableAdapter` class along with two `Public` methods: `GetSuppliers` and `UpdateSupplier`.</span></span> <span data-ttu-id="21e38-245">`GetSuppliers`メソッドの呼び出しを返します、 `SuppliersDataTable` 、対応するによって返される`GetSupplier`データ アクセス層のメソッド。</span><span class="sxs-lookup"><span data-stu-id="21e38-245">The `GetSuppliers` method calls and returns the `SuppliersDataTable` returned by the corresponding `GetSupplier` method in the Data Access Layer.</span></span> <span data-ttu-id="21e38-246">`UpdateSupplier`メソッド呼び出し DAL 秒に更新されている特定の仕入先に関する情報を取得`GetSupplierBySupplierID(supplierID)`メソッド。</span><span class="sxs-lookup"><span data-stu-id="21e38-246">The `UpdateSupplier` method retrieves information about the particular supplier being updated via a call to the DAL s `GetSupplierBySupplierID(supplierID)` method.</span></span> <span data-ttu-id="21e38-247">これは、後更新、 `CategoryName`、 `ContactName`、および`ContactTitle`プロパティとデータ アクセス層の s を呼び出すことによって、これらの変更をデータベースにコミット`Update`メソッドで変更された`SuppliersRow`オブジェクト。</span><span class="sxs-lookup"><span data-stu-id="21e38-247">It then updates the `CategoryName`, `ContactName`, and `ContactTitle` properties and commits these changes to the database by calling the Data Access Layer s `Update` method, passing in the modified `SuppliersRow` object.</span></span>

> [!NOTE]
> <span data-ttu-id="21e38-248">除く`SupplierID`と`CompanyName`、Suppliers テーブルのすべての列を許可する`NULL`値。</span><span class="sxs-lookup"><span data-stu-id="21e38-248">Except for `SupplierID` and `CompanyName`, all columns in the Suppliers table allow `NULL` values.</span></span> <span data-ttu-id="21e38-249">そのため場合、渡されたで`contactName`または`contactTitle`パラメーターは`Nothing`、対応するを設定する必要があります`ContactName`と`ContactTitle`プロパティを`NULL`データベース値を使用して、`SetContactNameNull`と`SetContactTitleNull`メソッドでは、それぞれします。</span><span class="sxs-lookup"><span data-stu-id="21e38-249">Therefore, if the passed-in `contactName` or `contactTitle` parameters are `Nothing` we need to set the corresponding `ContactName` and `ContactTitle` properties to a `NULL` database value using the `SetContactNameNull` and `SetContactTitleNull` methods, respectively.</span></span>

## <a name="step-7-working-with-the-computed-column-from-the-presentation-layer"></a><span data-ttu-id="21e38-250">手順 7: プレゼンテーション層から計算列の使用</span><span class="sxs-lookup"><span data-stu-id="21e38-250">Step 7: Working with the Computed Column from the Presentation Layer</span></span>

<span data-ttu-id="21e38-251">追加された計算列で、`Suppliers`テーブルと、DAL と BLL 適宜更新されるようで動作する ASP.NET ページを作成する準備ができました、`FullContactName`計算列。</span><span class="sxs-lookup"><span data-stu-id="21e38-251">With the computed column added to the `Suppliers` table and the DAL and BLL updated accordingly, we are ready to build an ASP.NET page that works with the `FullContactName` computed column.</span></span> <span data-ttu-id="21e38-252">開いて開始、`ComputedColumns.aspx`ページで、`AdvancedDAL`フォルダーとツールボックスからデザイナーにドラッグする GridView。</span><span class="sxs-lookup"><span data-stu-id="21e38-252">Start by opening the `ComputedColumns.aspx` page in the `AdvancedDAL` folder and drag a GridView from the Toolbox onto the Designer.</span></span> <span data-ttu-id="21e38-253">GridView s 設定`ID`プロパティを`Suppliers`し、スマート タグ、という名前の新しい ObjectDataSource にバインドする`SuppliersDataSource`します。</span><span class="sxs-lookup"><span data-stu-id="21e38-253">Set the GridView s `ID` property to `Suppliers` and, from its smart tag, bind it to a new ObjectDataSource named `SuppliersDataSource`.</span></span> <span data-ttu-id="21e38-254">構成を使用する ObjectDataSource、`SuppliersBLLWithSprocs`クラスを追加しましたは手順 6. でバックアップし、[次へ] をクリックします。</span><span class="sxs-lookup"><span data-stu-id="21e38-254">Configure the ObjectDataSource to use the `SuppliersBLLWithSprocs` class we added back in Step 6 and click Next.</span></span>

<span data-ttu-id="21e38-255">[![SuppliersBLLWithSprocs クラスを使用する ObjectDataSource を構成します。](working-with-computed-columns-vb/_static/image32.png)](working-with-computed-columns-vb/_static/image31.png)</span><span class="sxs-lookup"><span data-stu-id="21e38-255">[![Configure the ObjectDataSource to Use the SuppliersBLLWithSprocs Class](working-with-computed-columns-vb/_static/image32.png)](working-with-computed-columns-vb/_static/image31.png)</span></span>

<span data-ttu-id="21e38-256">**図 11**:構成に使用する ObjectDataSource、`SuppliersBLLWithSprocs`クラス ([フルサイズの画像を表示する をクリックします](working-with-computed-columns-vb/_static/image33.png))。</span><span class="sxs-lookup"><span data-stu-id="21e38-256">**Figure 11**: Configure the ObjectDataSource to Use the `SuppliersBLLWithSprocs` Class ([Click to view full-size image](working-with-computed-columns-vb/_static/image33.png))</span></span>

<span data-ttu-id="21e38-257">定義されている 2 つのメソッドがある、`SuppliersBLLWithSprocs`クラス:`GetSuppliers`と`UpdateSupplier`します。</span><span class="sxs-lookup"><span data-stu-id="21e38-257">There are only two methods defined in the `SuppliersBLLWithSprocs` class: `GetSuppliers` and `UpdateSupplier`.</span></span> <span data-ttu-id="21e38-258">いることを確認これら 2 つのメソッドは、SELECT で指定と、それぞれのタブを更新 ObjectDataSource の構成を完了するには、[完了] をクリックします。</span><span class="sxs-lookup"><span data-stu-id="21e38-258">Ensure that these two methods are specified in the SELECT and UPDATE tabs, respectively, and click Finish to complete the configuration of the ObjectDataSource.</span></span>

<span data-ttu-id="21e38-259">データ ソース構成ウィザードの完了したら、Visual Studio は、返されるデータ フィールドの各、BoundField を追加します。</span><span class="sxs-lookup"><span data-stu-id="21e38-259">Upon completion of the Data Source Configuration wizard, Visual Studio will add a BoundField for each of the data fields returned.</span></span> <span data-ttu-id="21e38-260">削除、 `SupplierID` BoundField を変更して、`HeaderText`のプロパティ、 `CompanyName`、 `ContactName`、`ContactTitle`と`FullContactName`BoundFields する会社、連絡先の名前、タイトル、および連絡先の氏名、それぞれします。</span><span class="sxs-lookup"><span data-stu-id="21e38-260">Remove the `SupplierID` BoundField and change the `HeaderText` properties of the `CompanyName`, `ContactName`, `ContactTitle`, and `FullContactName` BoundFields to Company, Contact Name, Title, and Full Contact Name, respectively.</span></span> <span data-ttu-id="21e38-261">スマート タグからには、GridView s 組み込み編集機能を有効にする編集を有効にするチェック ボックスをオンします。</span><span class="sxs-lookup"><span data-stu-id="21e38-261">From the smart tag, check the Enable Editing checkbox to turn on the GridView s built-in editing capabilities.</span></span>

<span data-ttu-id="21e38-262">BoundFields を GridView に追加するだけでなく、データ ソース ウィザードの完了も Visual Studio によって ObjectDataSource s を設定する`OldValuesParameterFormatString`プロパティを元に\_{0}します。</span><span class="sxs-lookup"><span data-stu-id="21e38-262">In addition to adding BoundFields to the GridView, completion of the Data Source Wizard also causes Visual Studio to set the ObjectDataSource s `OldValuesParameterFormatString` property to original\_{0}.</span></span> <span data-ttu-id="21e38-263">この設定を元の既定値に戻す{0}します。</span><span class="sxs-lookup"><span data-stu-id="21e38-263">Revert this setting back to its default value, {0} .</span></span>

<span data-ttu-id="21e38-264">GridView と ObjectDataSource にこれらの編集を行った後、宣言型マークアップは次のようになります。</span><span class="sxs-lookup"><span data-stu-id="21e38-264">After making these edits to the GridView and ObjectDataSource, their declarative markup should look similar to the following:</span></span>

[!code-aspx[Main](working-with-computed-columns-vb/samples/sample7.aspx)]

<span data-ttu-id="21e38-265">次に、ブラウザーからこのページを参照してください。</span><span class="sxs-lookup"><span data-stu-id="21e38-265">Next, visit this page through a browser.</span></span> <span data-ttu-id="21e38-266">含むグリッドの各仕入先が表示されている図 12 に示すよう、`FullContactName`として書式設定された値が他の 3 つの列を連結したものでは単に列`ContactName`(`ContactTitle`、 `CompanyName`)。</span><span class="sxs-lookup"><span data-stu-id="21e38-266">As Figure 12 shows, each supplier is listed in a grid that includes the `FullContactName` column, whose value is simply the concatenation of the other three columns formatted as `ContactName` (`ContactTitle`, `CompanyName`) .</span></span>

<span data-ttu-id="21e38-267">[![各仕入先がグリッドに一覧表示します。](working-with-computed-columns-vb/_static/image35.png)](working-with-computed-columns-vb/_static/image34.png)</span><span class="sxs-lookup"><span data-stu-id="21e38-267">[![Each Supplier is Listed in the Grid](working-with-computed-columns-vb/_static/image35.png)](working-with-computed-columns-vb/_static/image34.png)</span></span>

<span data-ttu-id="21e38-268">**図 12**:各仕入先のグリッドが記載されています ([フルサイズの画像を表示する をクリックします](working-with-computed-columns-vb/_static/image36.png))。</span><span class="sxs-lookup"><span data-stu-id="21e38-268">**Figure 12**: Each Supplier is Listed in the Grid ([Click to view full-size image](working-with-computed-columns-vb/_static/image36.png))</span></span>

<span data-ttu-id="21e38-269">特定のサプライヤーがポストバックを発生するがその行で表示、編集ボタンをクリックして (図 13 を参照してください) の編集インターフェイスします。</span><span class="sxs-lookup"><span data-stu-id="21e38-269">Clicking the Edit button for a particular supplier causes a postback and has that row rendered in its editing interface (see Figure 13).</span></span> <span data-ttu-id="21e38-270">最初の 3 つの列は、既定のインターフェイスの編集でレンダリング - いるテキスト ボックス コントロール`Text`プロパティがデータ フィールドの値に設定します。</span><span class="sxs-lookup"><span data-stu-id="21e38-270">The first three columns render in their default editing interface - a TextBox control whose `Text` property is set to the value of the data field.</span></span> <span data-ttu-id="21e38-271">`FullContactName`テキストとしてただし、列のままです。</span><span class="sxs-lookup"><span data-stu-id="21e38-271">The `FullContactName` column, however, remains as text.</span></span> <span data-ttu-id="21e38-272">GridView、データ ソース構成ウィザードの完了時に、BoundFields が追加されたときに、 `FullContactName` BoundField s`ReadOnly`プロパティに設定されました`True`ため、対応する`FullContactName`内の列、 `SuppliersDataTable`その`ReadOnly`プロパティに設定`True`します。</span><span class="sxs-lookup"><span data-stu-id="21e38-272">When the BoundFields were added to the GridView at the completion of the Data Source Configuration wizard, the `FullContactName` BoundField s `ReadOnly` property was set to `True` because the corresponding `FullContactName` column in the `SuppliersDataTable` has its `ReadOnly` property set to `True`.</span></span> <span data-ttu-id="21e38-273">手順 4 で説明したように、 `FullContactName` s`ReadOnly`プロパティに設定されました`True`TableAdapter の列が計算列が検出されたためです。</span><span class="sxs-lookup"><span data-stu-id="21e38-273">As noted in Step 4, the `FullContactName` s `ReadOnly` property was set to `True` because the TableAdapter detected that the column was a computed column.</span></span>

<span data-ttu-id="21e38-274">[![FullContactName 列が編集できません。](working-with-computed-columns-vb/_static/image38.png)](working-with-computed-columns-vb/_static/image37.png)</span><span class="sxs-lookup"><span data-stu-id="21e38-274">[![The FullContactName Column is Not Editable](working-with-computed-columns-vb/_static/image38.png)](working-with-computed-columns-vb/_static/image37.png)</span></span>

<span data-ttu-id="21e38-275">**図 13**:`FullContactName`列が編集できない ([フルサイズの画像を表示する をクリックします](working-with-computed-columns-vb/_static/image39.png))。</span><span class="sxs-lookup"><span data-stu-id="21e38-275">**Figure 13**: The `FullContactName` Column is Not Editable ([Click to view full-size image](working-with-computed-columns-vb/_static/image39.png))</span></span>

<span data-ttu-id="21e38-276">1 つまたは複数の編集可能な列の値を更新して更新 をクリックします。</span><span class="sxs-lookup"><span data-stu-id="21e38-276">Go ahead and update the value of one or more of the editable columns and click Update.</span></span> <span data-ttu-id="21e38-277">注方法、`FullContactName`秒の値が変更を反映するように自動的に更新します。</span><span class="sxs-lookup"><span data-stu-id="21e38-277">Note how the `FullContactName` s value is automatically updated to reflect the change.</span></span>

> [!NOTE]
> <span data-ttu-id="21e38-278">GridView 現在使用して BoundFields 編集可能なフィールドの編集インターフェイス、既定値します。</span><span class="sxs-lookup"><span data-stu-id="21e38-278">The GridView currently uses BoundFields for the editable fields, resulting in the default editing interface.</span></span> <span data-ttu-id="21e38-279">以降、`CompanyName`フィールドは必須です、それを含む、RequiredFieldValidator TemplateField に変換します。</span><span class="sxs-lookup"><span data-stu-id="21e38-279">Since the `CompanyName` field is required, it should be converted into a TemplateField that includes a RequiredFieldValidator.</span></span> <span data-ttu-id="21e38-280">ままを演習として興味を持った読者にします。</span><span class="sxs-lookup"><span data-stu-id="21e38-280">I leave this as an exercise for the interested reader.</span></span> <span data-ttu-id="21e38-281">参照してください、[編集および挿入インターフェイスに検証コントロールを追加](../editing-inserting-and-deleting-data/adding-validation-controls-to-the-editing-and-inserting-interfaces-vb.md)チュートリアル手順について、BoundField を TemplateField に変換して、検証コントロールを追加します。</span><span class="sxs-lookup"><span data-stu-id="21e38-281">Consult the [Adding Validation Controls to the Editing and Inserting Interfaces](../editing-inserting-and-deleting-data/adding-validation-controls-to-the-editing-and-inserting-interfaces-vb.md) tutorial for step-by-step instructions on converting a BoundField to a TemplateField and adding validation controls.</span></span>

## <a name="summary"></a><span data-ttu-id="21e38-282">まとめ</span><span class="sxs-lookup"><span data-stu-id="21e38-282">Summary</span></span>

<span data-ttu-id="21e38-283">テーブルのスキーマを定義するときに Microsoft SQL Server によって計算列を含めることができます。</span><span class="sxs-lookup"><span data-stu-id="21e38-283">When defining the schema for a table, Microsoft SQL Server allows the inclusion of computed columns.</span></span> <span data-ttu-id="21e38-284">これらは列の値は通常、同じレコード内の他の列から値を参照する式から計算されます。</span><span class="sxs-lookup"><span data-stu-id="21e38-284">These are columns whose values are calculated from an expression that usually references the values from other columns in the same record.</span></span> <span data-ttu-id="21e38-285">値から計算列は、式に基づく、読み取り専用の値を割り当てることができません、`INSERT`または`UPDATE`ステートメント。</span><span class="sxs-lookup"><span data-stu-id="21e38-285">Since the values for computed columns are based on an expression, they are read-only and cannot be assigned a value in an `INSERT` or `UPDATE` statement.</span></span> <span data-ttu-id="21e38-286">対応するを自動的に生成しようとする TableAdapter のメイン クエリで計算列を使用する場合の課題が生じます`INSERT`、 `UPDATE`、および`DELETE`ステートメント。</span><span class="sxs-lookup"><span data-stu-id="21e38-286">This introduces challenges when using a computed column in the main query of a TableAdapter that tries to automatically generate corresponding `INSERT`, `UPDATE`, and `DELETE` statements.</span></span>

<span data-ttu-id="21e38-287">このチュートリアルでは、計算列によってもたらされる課題を回避する方法について説明します。</span><span class="sxs-lookup"><span data-stu-id="21e38-287">In this tutorial we discussed techniques for circumventing the challenges posed by computed columns.</span></span> <span data-ttu-id="21e38-288">具体的には、使用してストアド プロシージャ、TableAdapter でアドホック SQL ステートメントを使用して Tableadapter で本質的な脆弱性を克服しました。</span><span class="sxs-lookup"><span data-stu-id="21e38-288">In particular, we used stored procedures in our TableAdapter to overcome the brittleness inherent in TableAdapters that use ad-hoc SQL statements.</span></span> <span data-ttu-id="21e38-289">ストアド プロシージャを新規作成、TableAdapter ウィザードを使用する場合は、最初に自分の存在により、データの変更ストアド プロシージャが生成されているため、計算列を省略するメインのクエリがあることが重要です。</span><span class="sxs-lookup"><span data-stu-id="21e38-289">When having the TableAdapter wizard create new stored procedures, it is important that we have the main query initially omit any computed columns because their presence prevents the data modification stored procedures from being generated.</span></span> <span data-ttu-id="21e38-290">TableAdapter が最初に構成した後、`SelectCommand`ストアド プロシージャは、計算列を含める retooled ことができます。</span><span class="sxs-lookup"><span data-stu-id="21e38-290">After the TableAdapter has been initially configured, its `SelectCommand` stored procedure can be retooled to include any computed columns.</span></span>

<span data-ttu-id="21e38-291">満足のプログラミングです。</span><span class="sxs-lookup"><span data-stu-id="21e38-291">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="21e38-292">執筆者紹介</span><span class="sxs-lookup"><span data-stu-id="21e38-292">About the Author</span></span>

<span data-ttu-id="21e38-293">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml)、7 つ受け取りますブックおよびの創設者の著者[4GuysFromRolla.com](http://www.4guysfromrolla.com)、Microsoft Web テクノロジと 1998 年から携わっています。</span><span class="sxs-lookup"><span data-stu-id="21e38-293">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="21e38-294">Scott は、フリーのコンサルタント、トレーナー、およびライターとして動作します。</span><span class="sxs-lookup"><span data-stu-id="21e38-294">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="21e38-295">最新の著書は[ *Sams 教える自分で ASP.NET 2.0 24 時間以内に*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)します。</span><span class="sxs-lookup"><span data-stu-id="21e38-295">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="21e38-296">彼に到達できる[mitchell@4GuysFromRolla.comします。](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="21e38-296">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="21e38-297">彼のブログにあるでまたは[ http://ScottOnWriting.NET](http://ScottOnWriting.NET)します。</span><span class="sxs-lookup"><span data-stu-id="21e38-297">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="21e38-298">特別なに感謝します。</span><span class="sxs-lookup"><span data-stu-id="21e38-298">Special Thanks To</span></span>

<span data-ttu-id="21e38-299">このチュートリアル シリーズは、多くの便利なレビュー担当者によってレビューされました。</span><span class="sxs-lookup"><span data-stu-id="21e38-299">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="21e38-300">このチュートリアルでは、潜在顧客レビュー担当者では、Hilton Geisenow Teresa Murphy はでした。</span><span class="sxs-lookup"><span data-stu-id="21e38-300">Lead reviewers for this tutorial were Hilton Geisenow and Teresa Murphy.</span></span> <span data-ttu-id="21e38-301">今後、MSDN の記事を確認したいですか。</span><span class="sxs-lookup"><span data-stu-id="21e38-301">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="21e38-302">場合は、筆者に[mitchell@4GuysFromRolla.comします。](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="21e38-302">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="21e38-303">[前へ](adding-additional-datatable-columns-vb.md)
> [次へ](configuring-the-data-access-layer-s-connection-and-command-level-settings-vb.md)</span><span class="sxs-lookup"><span data-stu-id="21e38-303">[Previous](adding-additional-datatable-columns-vb.md)
[Next](configuring-the-data-access-layer-s-connection-and-command-level-settings-vb.md)</span></span>

---
uid: web-forms/overview/data-access/masterdetail/master-detail-filtering-across-two-pages-vb
title: 2つのページでマスター/詳細をフィルター処理する (VB) |Microsoft Docs
author: rick-anderson
description: このチュートリアルでは、GridView を使用してデータベース内のサプライヤーを一覧表示することで、このパターンを実装します。 GridView の各 supplier 行には、ビューが含まれています...
ms.author: riande
ms.date: 03/31/2010
ms.assetid: 361d6a44-3f1f-4daf-85df-d4c2b8bf065d
msc.legacyurl: /web-forms/overview/data-access/masterdetail/master-detail-filtering-across-two-pages-vb
msc.type: authoredcontent
ms.openlocfilehash: 252c6d5e48aff0087e090e3ddc1f58c84a2c030e
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 03/06/2020
ms.locfileid: "78424780"
---
# <a name="masterdetail-filtering-across-two-pages-vb"></a><span data-ttu-id="7186e-104">2 つのページでマスター/詳細をフィルター処理する (VB)</span><span class="sxs-lookup"><span data-stu-id="7186e-104">Master/Detail Filtering Across Two Pages (VB)</span></span>

<span data-ttu-id="7186e-105">[Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="7186e-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="7186e-106">[サンプルアプリのダウンロード](https://download.microsoft.com/download/5/d/7/5d7571fc-d0b7-4798-ad4a-c976c02363ce/ASPNET_Data_Tutorial_9_VB.exe)または[PDF のダウンロード](master-detail-filtering-across-two-pages-vb/_static/datatutorial09vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="7186e-106">[Download Sample App](https://download.microsoft.com/download/5/d/7/5d7571fc-d0b7-4798-ad4a-c976c02363ce/ASPNET_Data_Tutorial_9_VB.exe) or [Download PDF](master-detail-filtering-across-two-pages-vb/_static/datatutorial09vb1.pdf)</span></span>

> <span data-ttu-id="7186e-107">このチュートリアルでは、GridView を使用してデータベース内のサプライヤーを一覧表示することで、このパターンを実装します。</span><span class="sxs-lookup"><span data-stu-id="7186e-107">In this tutorial we'll implement this pattern by using a GridView to list the suppliers in the database.</span></span> <span data-ttu-id="7186e-108">GridView の各仕入先の行には、[製品の表示] リンクが含まれています。このリンクをクリックすると、選択した業者の製品が一覧表示された別のページに移動します。</span><span class="sxs-lookup"><span data-stu-id="7186e-108">Each supplier row in the GridView will contain a View Products link that, when clicked, will take the user to a separate page that lists those products for the selected supplier.</span></span>

## <a name="introduction"></a><span data-ttu-id="7186e-109">はじめに</span><span class="sxs-lookup"><span data-stu-id="7186e-109">Introduction</span></span>

<span data-ttu-id="7186e-110">前の2つのチュートリアルでは、DropDownLists を使用して "マスター" レコードを表示する1つの web ページでマスター/詳細レポートを表示する方法、および "詳細" を表示するための[GridView](master-detail-filtering-with-a-dropdownlist-vb.md)または[DetailsView](master-detail-filtering-with-two-dropdownlists-vb.md)コントロールについて説明しました。</span><span class="sxs-lookup"><span data-stu-id="7186e-110">In the previous two tutorials we saw how to display master/detail reports in a single web page using DropDownLists to display the "master" records and a [GridView](master-detail-filtering-with-a-dropdownlist-vb.md) or [DetailsView](master-detail-filtering-with-two-dropdownlists-vb.md) control to display the "details."</span></span> <span data-ttu-id="7186e-111">マスター/詳細レポートに使用されるもう1つの一般的なパターンは、1つの web ページにマスターレコードを作成し、その詳細を別の web ページに表示することです。</span><span class="sxs-lookup"><span data-stu-id="7186e-111">Another common pattern used for master/details reports is to have the master records on one web page and the details shown on another.</span></span> <span data-ttu-id="7186e-112">フォーラムの web サイト ( [ASP.NET フォーラム](https://forums.asp.net/)など) は、このパターンを実践するための好例です。</span><span class="sxs-lookup"><span data-stu-id="7186e-112">A forum website, like [the ASP.NET Forums](https://forums.asp.net/), is a great example of this pattern in practice.</span></span> <span data-ttu-id="7186e-113">ASP.NET フォーラムは、さまざまなフォーラムはじめに、Web フォーム、データ表示コントロールなどで構成されています。</span><span class="sxs-lookup"><span data-stu-id="7186e-113">The ASP.NET Forums are composed of a variety of forums Getting Started, Web Forms, Data Presentation Controls, and so on.</span></span> <span data-ttu-id="7186e-114">各フォーラムは多くのスレッドで構成されており、各スレッドは多数の投稿で構成されています。</span><span class="sxs-lookup"><span data-stu-id="7186e-114">Each forum is composed of many threads and each thread is composed of a number of posts.</span></span> <span data-ttu-id="7186e-115">ASP.NET フォーラムのホームページに、フォーラムが表示されます。</span><span class="sxs-lookup"><span data-stu-id="7186e-115">On the ASP.NET Forums homepage, the forums are listed.</span></span> <span data-ttu-id="7186e-116">フォーラムをクリックすると、そのフォーラムのスレッドが一覧表示される `ShowForum.aspx` ページに whisks ます。</span><span class="sxs-lookup"><span data-stu-id="7186e-116">Clicking on a forum whisks you to a `ShowForum.aspx` page, which lists the threads for that forum.</span></span> <span data-ttu-id="7186e-117">同様に、スレッドをクリックすると `ShowPost.aspx`に移動し、クリックされたスレッドの投稿が表示されます。</span><span class="sxs-lookup"><span data-stu-id="7186e-117">Likewise, clicking on a thread takes you to `ShowPost.aspx`, which displays the posts for the thread that was clicked.</span></span>

<span data-ttu-id="7186e-118">このチュートリアルでは、GridView を使用してデータベース内のサプライヤーを一覧表示することで、このパターンを実装します。</span><span class="sxs-lookup"><span data-stu-id="7186e-118">In this tutorial we'll implement this pattern by using a GridView to list the suppliers in the database.</span></span> <span data-ttu-id="7186e-119">GridView の各仕入先の行には、[製品の表示] リンクが含まれています。このリンクをクリックすると、選択した業者の製品が一覧表示された別のページに移動します。</span><span class="sxs-lookup"><span data-stu-id="7186e-119">Each supplier row in the GridView will contain a View Products link that, when clicked, will take the user to a separate page that lists those products for the selected supplier.</span></span>

## <a name="step-1-addingsupplierlistmasteraspxandproductsforsupplierdetailsaspxpages-to-thefilteringfolder"></a><span data-ttu-id="7186e-120">手順 1:`SupplierListMaster.aspx`ページと`ProductsForSupplierDetails.aspx`ページを`Filtering`フォルダーに追加する</span><span class="sxs-lookup"><span data-stu-id="7186e-120">Step 1: Adding`SupplierListMaster.aspx`and`ProductsForSupplierDetails.aspx`Pages to the`Filtering`Folder</span></span>

<span data-ttu-id="7186e-121">3番目のチュートリアルでページレイアウトを定義すると、`BasicReporting`、`Filtering`、および `CustomFormatting` フォルダーに多数の "starter" ページが追加されました。</span><span class="sxs-lookup"><span data-stu-id="7186e-121">When defining the page layout in the third tutorial we added a number of "starter" pages in the `BasicReporting`, `Filtering`, and `CustomFormatting` folders.</span></span> <span data-ttu-id="7186e-122">ただし、その時点でこのチュートリアルのスタートページを追加していません。そのため、`SupplierListMaster.aspx` と `ProductsForSupplierDetails.aspx`の2つの新しいページを `Filtering` フォルダーに追加してみましょう。</span><span class="sxs-lookup"><span data-stu-id="7186e-122">However, we did not add a starter page for this tutorial at that time, so take a moment to add two new pages to the `Filtering` folder: `SupplierListMaster.aspx` and `ProductsForSupplierDetails.aspx`.</span></span> <span data-ttu-id="7186e-123">`SupplierListMaster.aspx` `ProductsForSupplierDetails.aspx` には、選択した業者の製品が表示されますが、"マスター" レコード (業者) が一覧表示されます。</span><span class="sxs-lookup"><span data-stu-id="7186e-123">`SupplierListMaster.aspx` will list the "master" records (the suppliers) while `ProductsForSupplierDetails.aspx` will display the products for the selected supplier.</span></span>

<span data-ttu-id="7186e-124">これら2つの新しいページを作成する場合は、`Site.master` マスターページに関連付ける必要があります。</span><span class="sxs-lookup"><span data-stu-id="7186e-124">When creating these two new pages be certain to associate them with the `Site.master` master page.</span></span>

![SupplierListMaster および ProductsForSupplierDetails ページをフィルター処理フォルダーに追加します。](master-detail-filtering-across-two-pages-vb/_static/image1.png)

<span data-ttu-id="7186e-126">**図 1**: `SupplierListMaster.aspx` ページと `ProductsForSupplierDetails.aspx` ページを `Filtering` フォルダーに追加する</span><span class="sxs-lookup"><span data-stu-id="7186e-126">**Figure 1**: Add the `SupplierListMaster.aspx` and `ProductsForSupplierDetails.aspx` Pages to the `Filtering` Folder</span></span>

<span data-ttu-id="7186e-127">また、新しいページをプロジェクトに追加するときは、必ずサイトマップファイルを更新してください (`Web.sitemap`)。</span><span class="sxs-lookup"><span data-stu-id="7186e-127">Also, when adding new pages to the project, be sure to update the site map file, `Web.sitemap`, accordingly.</span></span> <span data-ttu-id="7186e-128">このチュートリアルでは、次の XML コンテンツをフィルター処理する `<siteMapNode>` 要素の子として使用して、`SupplierListMaster.aspx` ページをサイトマップに追加するだけです。</span><span class="sxs-lookup"><span data-stu-id="7186e-128">For this tutorial simply add the `SupplierListMaster.aspx` page to the site map using the following XML content as a child of the Filtering Reports `<siteMapNode>` element:</span></span>

[!code-xml[Main](master-detail-filtering-across-two-pages-vb/samples/sample1.xml)]

> [!NOTE]
> <span data-ttu-id="7186e-129">K を使用して新しい ASP.NET ページを追加するときに、サイトマップファイルの更新プロセスを自動化でき[ます。 Scott Allen](http://odetocode.com/Blogs/scott/)の無料の Visual Studio[サイトマップマクロ](http://odetocode.com/Blogs/scott/archive/2005/11/29/2537.aspx)です。</span><span class="sxs-lookup"><span data-stu-id="7186e-129">You can help automate the process of updating the site map file when adding new ASP.NET pages using [K. Scott Allen](http://odetocode.com/Blogs/scott/)'s free Visual Studio [Site Map Macro](http://odetocode.com/Blogs/scott/archive/2005/11/29/2537.aspx).</span></span>

## <a name="step-2-displaying-the-supplier-list-insupplierlistmasteraspx"></a><span data-ttu-id="7186e-130">手順 2:`SupplierListMaster.aspx` での業者の一覧の表示</span><span class="sxs-lookup"><span data-stu-id="7186e-130">Step 2: Displaying the Supplier List in`SupplierListMaster.aspx`</span></span>

<span data-ttu-id="7186e-131">`SupplierListMaster.aspx` と `ProductsForSupplierDetails.aspx` のページが作成されたので、次の手順は `SupplierListMaster.aspx`でサプライヤーの GridView を作成することです。</span><span class="sxs-lookup"><span data-stu-id="7186e-131">With the `SupplierListMaster.aspx` and `ProductsForSupplierDetails.aspx` pages created, our next step is to create the GridView of suppliers in `SupplierListMaster.aspx`.</span></span> <span data-ttu-id="7186e-132">GridView をページに追加し、新しい ObjectDataSource にバインドします。</span><span class="sxs-lookup"><span data-stu-id="7186e-132">Add a GridView to the page and bind it to a new ObjectDataSource.</span></span> <span data-ttu-id="7186e-133">この ObjectDataSource では、`SuppliersBLL` クラスの `GetSuppliers()` メソッドを使用して、すべての業者を返す必要があります。</span><span class="sxs-lookup"><span data-stu-id="7186e-133">This ObjectDataSource should use the `SuppliersBLL` class's `GetSuppliers()` method to return all suppliers.</span></span>

<span data-ttu-id="7186e-134">[SuppliersBLL クラスを選択 ![には](master-detail-filtering-across-two-pages-vb/_static/image3.png)](master-detail-filtering-across-two-pages-vb/_static/image2.png)</span><span class="sxs-lookup"><span data-stu-id="7186e-134">[![Select the SuppliersBLL Class](master-detail-filtering-across-two-pages-vb/_static/image3.png)](master-detail-filtering-across-two-pages-vb/_static/image2.png)</span></span>

<span data-ttu-id="7186e-135">**図 2**: `SuppliersBLL` クラスを選択[する (クリックすると、フルサイズの画像が表示](master-detail-filtering-across-two-pages-vb/_static/image4.png)されます)</span><span class="sxs-lookup"><span data-stu-id="7186e-135">**Figure 2**: Select the `SuppliersBLL` Class ([Click to view full-size image](master-detail-filtering-across-two-pages-vb/_static/image4.png))</span></span>

<span data-ttu-id="7186e-136">[GetSuppliers () メソッドを使用するように ObjectDataSource を構成 ![には](master-detail-filtering-across-two-pages-vb/_static/image6.png)](master-detail-filtering-across-two-pages-vb/_static/image5.png)</span><span class="sxs-lookup"><span data-stu-id="7186e-136">[![Configure the ObjectDataSource to Use the GetSuppliers() Method](master-detail-filtering-across-two-pages-vb/_static/image6.png)](master-detail-filtering-across-two-pages-vb/_static/image5.png)</span></span>

<span data-ttu-id="7186e-137">**図 3**: `GetSuppliers()` メソッドを使用するように ObjectDataSource を構成する ([クリックしてフルサイズのイメージを表示する](master-detail-filtering-across-two-pages-vb/_static/image7.png))</span><span class="sxs-lookup"><span data-stu-id="7186e-137">**Figure 3**: Configure the ObjectDataSource to Use the `GetSuppliers()` Method ([Click to view full-size image](master-detail-filtering-across-two-pages-vb/_static/image7.png))</span></span>

<span data-ttu-id="7186e-138">クリックすると、ユーザーが選択した行の `SupplierID` 値をクエリ文字列を使用して渡す `ProductsForSupplierDetails.aspx` するために、各 GridView 行に「Products」というタイトルのリンクを含める必要があります。</span><span class="sxs-lookup"><span data-stu-id="7186e-138">We need to include a link titled View Products in each GridView row that, when clicked, takes the user to `ProductsForSupplierDetails.aspx` passing in the selected row's `SupplierID` value through the querystring.</span></span> <span data-ttu-id="7186e-139">たとえば、ユーザーが東京 Traders 業者の [Products の表示] リンクをクリックした場合 (`SupplierID` 値は 4)、`ProductsForSupplierDetails.aspx?SupplierID=4`に送信する必要があります。</span><span class="sxs-lookup"><span data-stu-id="7186e-139">For example, if user clicks on the View Products link for the Tokyo Traders supplier (which has a `SupplierID` value of 4), they should be sent to `ProductsForSupplierDetails.aspx?SupplierID=4`.</span></span>

<span data-ttu-id="7186e-140">これを行うには、GridView に hyperlink[フィールド](https://msdn.microsoft.com/library/system.web.ui.webcontrols.hyperlinkfield.aspx)を追加します。これにより、各 gridview 行にハイパーリンクが追加されます。</span><span class="sxs-lookup"><span data-stu-id="7186e-140">To accomplish this, add a [HyperLinkField](https://msdn.microsoft.com/library/system.web.ui.webcontrols.hyperlinkfield.aspx) to the GridView, which adds a hyperlink to each GridView row.</span></span> <span data-ttu-id="7186e-141">まず、GridView のスマートタグから [列の編集] リンクをクリックします。</span><span class="sxs-lookup"><span data-stu-id="7186e-141">Start by clicking the Edit Columns link from the GridView's smart tag.</span></span> <span data-ttu-id="7186e-142">次に、左上の一覧から [ハイパーリンク] フィールドを選択し、[追加] をクリックして、GridView のフィールドリストにハイパーリンクフィールドを含めます。</span><span class="sxs-lookup"><span data-stu-id="7186e-142">Next, select the HyperLinkField from the list in the upper left and click Add to include the HyperLinkField in the GridView's field list.</span></span>

<span data-ttu-id="7186e-143">[GridView にハイパーリンクフィールドを追加 ![には](master-detail-filtering-across-two-pages-vb/_static/image9.png)](master-detail-filtering-across-two-pages-vb/_static/image8.png)</span><span class="sxs-lookup"><span data-stu-id="7186e-143">[![Add a HyperLinkField to the GridView](master-detail-filtering-across-two-pages-vb/_static/image9.png)](master-detail-filtering-across-two-pages-vb/_static/image8.png)</span></span>

<span data-ttu-id="7186e-144">**図 4**: GridView にハイパーリンクフィールドを追加する ([クリックすると、フルサイズのイメージが表示](master-detail-filtering-across-two-pages-vb/_static/image10.png)されます)</span><span class="sxs-lookup"><span data-stu-id="7186e-144">**Figure 4**: Add a HyperLinkField to the GridView ([Click to view full-size image](master-detail-filtering-across-two-pages-vb/_static/image10.png))</span></span>

<span data-ttu-id="7186e-145">ハイパーリンクフィールドは、各 GridView 行のリンクに同じテキストまたは URL 値を使用するように構成できます。また、各行にバインドされたデータ値に基づいてこれらの値を指定することもできます。</span><span class="sxs-lookup"><span data-stu-id="7186e-145">The HyperLinkField can be configured to use the same text or URL values the link in each GridView row, or can base these values on the data values bound to each particular row.</span></span> <span data-ttu-id="7186e-146">すべての行に対して静的な値を指定するには、ハイパーリンクフィールドの `Text` または `NavigateUrl` プロパティを使用します。</span><span class="sxs-lookup"><span data-stu-id="7186e-146">To specify a static value across all rows use the HyperLinkField's `Text` or `NavigateUrl` properties.</span></span> <span data-ttu-id="7186e-147">すべての行でリンクテキストを同じにするため、ハイパーリンクフィールドの `Text` プロパティを設定して、製品を表示します。</span><span class="sxs-lookup"><span data-stu-id="7186e-147">Since we want the link text to be the same for all rows, set the HyperLinkField's `Text` property to View Products.</span></span>

<span data-ttu-id="7186e-148">[ハイパーリンクフィールドの Text プロパティを設定して製品を表示 ![には](master-detail-filtering-across-two-pages-vb/_static/image12.png)](master-detail-filtering-across-two-pages-vb/_static/image11.png)</span><span class="sxs-lookup"><span data-stu-id="7186e-148">[![Set the HyperLinkField's Text Property to View Products](master-detail-filtering-across-two-pages-vb/_static/image12.png)](master-detail-filtering-across-two-pages-vb/_static/image11.png)</span></span>

<span data-ttu-id="7186e-149">**図 5**: ハイパーリンクフィールドの `Text` プロパティを設定して製品を表示する ([クリックすると、フルサイズの画像が表示](master-detail-filtering-across-two-pages-vb/_static/image13.png)されます)</span><span class="sxs-lookup"><span data-stu-id="7186e-149">**Figure 5**: Set the HyperLinkField's `Text` Property to View Products ([Click to view full-size image](master-detail-filtering-across-two-pages-vb/_static/image13.png))</span></span>

<span data-ttu-id="7186e-150">GridView 行にバインドされている基になるデータに基づいてテキストまたは URL の値を設定するには、`DataTextField` または `DataNavigateUrlFields` のプロパティで、テキストまたは URL の値を取得するデータフィールドを指定します。</span><span class="sxs-lookup"><span data-stu-id="7186e-150">To set the text or URL values to be based on the underlying data bound to the GridView row, specify the data fields the text or URL values should be pulled from in the `DataTextField` or `DataNavigateUrlFields` properties.</span></span> <span data-ttu-id="7186e-151">`DataTextField` は、1つのデータフィールドにのみ設定できます。ただし `DataNavigateUrlFields`は、データフィールドのコンマ区切りの一覧に設定できます。</span><span class="sxs-lookup"><span data-stu-id="7186e-151">`DataTextField` can only be set to a single data field; `DataNavigateUrlFields`, however, can be set to a comma-delimited list of data fields.</span></span> <span data-ttu-id="7186e-152">多くの場合、現在の行のデータフィールド値といくつかの静的マークアップの組み合わせに基づいて、テキストまたは URL を指定する必要があります。</span><span class="sxs-lookup"><span data-stu-id="7186e-152">We frequently need to base the text or URL on a combination of the current row's data field value and some static markup.</span></span> <span data-ttu-id="7186e-153">このチュートリアルでは、たとえば、ハイパーリンクフィールドのリンクの URL を `ProductsForSupplierDetails.aspx?SupplierID=supplierID`にする必要があります。 *`supplierID`* は各 GridView の行の `SupplierID` 値です。</span><span class="sxs-lookup"><span data-stu-id="7186e-153">In this tutorial, for example, we want the URL of the HyperLinkField's links to be `ProductsForSupplierDetails.aspx?SupplierID=supplierID`, where *`supplierID`* is each GridView's row's `SupplierID` value.</span></span> <span data-ttu-id="7186e-154">ここでは、静的な値とデータドリブン値の両方が必要であることに注意してください。リンクの URL の `ProductsForSupplierDetails.aspx?SupplierID=` 部分は静的であるのに対し、 *`supplierID`* 部分はそれぞれの行独自の `SupplierID` 値であるため、データドリブンです。</span><span class="sxs-lookup"><span data-stu-id="7186e-154">Notice that we need both static and data-driven values here: the `ProductsForSupplierDetails.aspx?SupplierID=` portion of the link's URL is static, whereas the *`supplierID`* portion is data-driven as its value is each row's own `SupplierID` value.</span></span>

<span data-ttu-id="7186e-155">静的な値とデータドリブン値の組み合わせを示すには、`DataTextFormatString` プロパティと `DataNavigateUrlFormatString` プロパティを使用します。</span><span class="sxs-lookup"><span data-stu-id="7186e-155">To indicate a combination of static and data-driven values, use the `DataTextFormatString` and `DataNavigateUrlFormatString` properties.</span></span> <span data-ttu-id="7186e-156">これらのプロパティでは、必要に応じて静的なマークアップを入力し、[`DataTextField`] または [`DataNavigateUrlFields`] プロパティで指定したフィールドの値を表示するマーカー `{0}` を使用します。</span><span class="sxs-lookup"><span data-stu-id="7186e-156">In these properties enter the static markup as needed and then use the marker `{0}` where you want the value of the field specified in the `DataTextField` or `DataNavigateUrlFields` properties to appear.</span></span> <span data-ttu-id="7186e-157">`DataNavigateUrlFields` プロパティに複数のフィールドが指定されている場合は、最初のフィールド値を挿入する場所に `{0}` を使用し、2番目のフィールド値を `{1}` します。</span><span class="sxs-lookup"><span data-stu-id="7186e-157">If the `DataNavigateUrlFields` property has multiple fields specified use `{0}` where you want the first field value inserted, `{1}` for the second field value, and so on.</span></span>

<span data-ttu-id="7186e-158">このチュートリアルにこれを適用するには、`DataNavigateUrlFields` プロパティを `SupplierID`に設定する必要があります。これは、行ごとにカスタマイズする必要がある値を持つデータフィールドと、`ProductsForSupplierDetails.aspx?SupplierID={0}`する `DataNavigateUrlFormatString` プロパティであるためです。</span><span class="sxs-lookup"><span data-stu-id="7186e-158">Applying this to our tutorial, we need to set the `DataNavigateUrlFields` property to `SupplierID`, since that's the data field whose value we need to customize on a per-row basis, and the `DataNavigateUrlFormatString` property to `ProductsForSupplierDetails.aspx?SupplierID={0}`.</span></span>

<span data-ttu-id="7186e-159">[[ハイパーリンク] フィールドを構成して、仕入先に基づく適切なリンク URL を含める ![](master-detail-filtering-across-two-pages-vb/_static/image15.png)](master-detail-filtering-across-two-pages-vb/_static/image14.png)</span><span class="sxs-lookup"><span data-stu-id="7186e-159">[![Configure the HyperLinkField to Include the Proper Link URL Based Upon the SupplierID](master-detail-filtering-across-two-pages-vb/_static/image15.png)](master-detail-filtering-across-two-pages-vb/_static/image14.png)</span></span>

<span data-ttu-id="7186e-160">**図 6**: `SupplierID` に基づく適切なリンク URL を含めるようにハイパーリンクフィールドを構成する ([クリックしてフルサイズのイメージを表示する](master-detail-filtering-across-two-pages-vb/_static/image16.png))</span><span class="sxs-lookup"><span data-stu-id="7186e-160">**Figure 6**: Configure the HyperLinkField to Include the Proper Link URL Based Upon the `SupplierID` ([Click to view full-size image](master-detail-filtering-across-two-pages-vb/_static/image16.png))</span></span>

<span data-ttu-id="7186e-161">ハイパーリンクフィールドを追加した後は、GridView のフィールドのカスタマイズと順序変更を自由に行うことができます。</span><span class="sxs-lookup"><span data-stu-id="7186e-161">After adding the HyperLinkField, feel free to customize and reorder the GridView's fields.</span></span> <span data-ttu-id="7186e-162">次のマークアップは、いくつかの細かいフィールドレベルのカスタマイズを行った後の GridView を示しています。</span><span class="sxs-lookup"><span data-stu-id="7186e-162">The following markup shows the GridView after I've made some minor field-level customizations.</span></span>

[!code-aspx[Main](master-detail-filtering-across-two-pages-vb/samples/sample2.aspx)]

<span data-ttu-id="7186e-163">ブラウザーで `SupplierListMaster.aspx` ページを表示してみましょう。</span><span class="sxs-lookup"><span data-stu-id="7186e-163">Take a moment to view the `SupplierListMaster.aspx` page through a browser.</span></span> <span data-ttu-id="7186e-164">図7に示すように、現在のページには、[製品の表示] リンクを含むすべての仕入先が表示されています。</span><span class="sxs-lookup"><span data-stu-id="7186e-164">As Figure 7 shows, the page currently lists all of the suppliers including a View Products link.</span></span> <span data-ttu-id="7186e-165">[製品の表示] リンクをクリックすると、`ProductsForSupplierDetails.aspx`に移動し、クエリ文字列で業者の `SupplierID` を渡します。</span><span class="sxs-lookup"><span data-stu-id="7186e-165">Clicking on the View Products link will take you to `ProductsForSupplierDetails.aspx`, passing along the supplier's `SupplierID` in the querystring.</span></span>

<span data-ttu-id="7186e-166">[各 Supplier 行に ![ビュー製品のリンクが含まれています](master-detail-filtering-across-two-pages-vb/_static/image18.png)](master-detail-filtering-across-two-pages-vb/_static/image17.png)</span><span class="sxs-lookup"><span data-stu-id="7186e-166">[![Each Supplier Row Contains a View Products Link](master-detail-filtering-across-two-pages-vb/_static/image18.png)](master-detail-filtering-across-two-pages-vb/_static/image17.png)</span></span>

<span data-ttu-id="7186e-167">**図 7**: 各仕入先の行に [製品の表示] リンクが含まれている ([クリックしてフルサイズの画像を表示する](master-detail-filtering-across-two-pages-vb/_static/image19.png))</span><span class="sxs-lookup"><span data-stu-id="7186e-167">**Figure 7**: Each Supplier Row Contains a View Products Link ([Click to view full-size image](master-detail-filtering-across-two-pages-vb/_static/image19.png))</span></span>

## <a name="step-3-listing-the-suppliers-products-inproductsforsupplierdetailsaspx"></a><span data-ttu-id="7186e-168">手順 3:`ProductsForSupplierDetails.aspx` で仕入先の製品を一覧表示する</span><span class="sxs-lookup"><span data-stu-id="7186e-168">Step 3: Listing the Supplier's Products in`ProductsForSupplierDetails.aspx`</span></span>

<span data-ttu-id="7186e-169">この時点で、`SupplierListMaster.aspx` ページが `ProductsForSupplierDetails.aspx`にユーザーを送信し、選択した業者の `SupplierID` を querystring に渡します。</span><span class="sxs-lookup"><span data-stu-id="7186e-169">At this point the `SupplierListMaster.aspx` page is sending users to `ProductsForSupplierDetails.aspx`, passing the selected supplier's `SupplierID` in the querystring.</span></span> <span data-ttu-id="7186e-170">チュートリアルの最後の手順は、クエリ文字列を使用して渡された `SupplierID` と等しい `SupplierID` を持つ `ProductsForSupplierDetails.aspx` の GridView に製品を表示することです。</span><span class="sxs-lookup"><span data-stu-id="7186e-170">The tutorial's final step is to display the products in a GridView in `ProductsForSupplierDetails.aspx` whose `SupplierID` equals the `SupplierID` passed in through the querystring.</span></span> <span data-ttu-id="7186e-171">これを行うには、GridView を `ProductsForSupplierDetails.aspx` ページに追加します。そのためには、`ProductsBLL` クラスから `GetProductsBySupplierID(supplierID)` メソッドを呼び出す `ProductsBySupplierDataSource` という名前の新しい ObjectDataSource コントロールを使用します。</span><span class="sxs-lookup"><span data-stu-id="7186e-171">To accomplish this start by adding a GridView to the `ProductsForSupplierDetails.aspx` page, using a new ObjectDataSource control named `ProductsBySupplierDataSource` that invokes the `GetProductsBySupplierID(supplierID)` method from the `ProductsBLL` class.</span></span>

<span data-ttu-id="7186e-172">[ProductsBySupplierDataSource という名前の新しい ObjectDataSource を追加 ![には](master-detail-filtering-across-two-pages-vb/_static/image21.png)](master-detail-filtering-across-two-pages-vb/_static/image20.png)</span><span class="sxs-lookup"><span data-stu-id="7186e-172">[![Add a New ObjectDataSource Named ProductsBySupplierDataSource](master-detail-filtering-across-two-pages-vb/_static/image21.png)](master-detail-filtering-across-two-pages-vb/_static/image20.png)</span></span>

<span data-ttu-id="7186e-173">**図 8**: `ProductsBySupplierDataSource` という名前の新しい ObjectDataSource を追加[する (クリックすると、フルサイズの画像が表示](master-detail-filtering-across-two-pages-vb/_static/image22.png)される)</span><span class="sxs-lookup"><span data-stu-id="7186e-173">**Figure 8**: Add a New ObjectDataSource Named `ProductsBySupplierDataSource` ([Click to view full-size image](master-detail-filtering-across-two-pages-vb/_static/image22.png))</span></span>

<span data-ttu-id="7186e-174">[製品の Bll クラスを選択 ![には](master-detail-filtering-across-two-pages-vb/_static/image24.png)](master-detail-filtering-across-two-pages-vb/_static/image23.png)</span><span class="sxs-lookup"><span data-stu-id="7186e-174">[![Select the ProductsBLL Class](master-detail-filtering-across-two-pages-vb/_static/image24.png)](master-detail-filtering-across-two-pages-vb/_static/image23.png)</span></span>

<span data-ttu-id="7186e-175">**図 9**: `ProductsBLL` クラスを選択[する (クリックすると、フルサイズの画像が表示](master-detail-filtering-across-two-pages-vb/_static/image25.png)されます)</span><span class="sxs-lookup"><span data-stu-id="7186e-175">**Figure 9**: Select the `ProductsBLL` Class ([Click to view full-size image](master-detail-filtering-across-two-pages-vb/_static/image25.png))</span></span>

<span data-ttu-id="7186e-176">[ObjectDataSource が Get$ By仕入先 (仕入先) メソッドを呼び出す ![](master-detail-filtering-across-two-pages-vb/_static/image27.png)](master-detail-filtering-across-two-pages-vb/_static/image26.png)</span><span class="sxs-lookup"><span data-stu-id="7186e-176">[![Have the ObjectDataSource Invoke the GetProductsBySupplierID(supplierID) Method](master-detail-filtering-across-two-pages-vb/_static/image27.png)](master-detail-filtering-across-two-pages-vb/_static/image26.png)</span></span>

<span data-ttu-id="7186e-177">**図 10**: ObjectDataSource で `GetProductsBySupplierID(supplierID)` メソッドを呼び出す ([クリックしてフルサイズのイメージを表示する](master-detail-filtering-across-two-pages-vb/_static/image28.png))</span><span class="sxs-lookup"><span data-stu-id="7186e-177">**Figure 10**: Have the ObjectDataSource Invoke the `GetProductsBySupplierID(supplierID)` Method ([Click to view full-size image](master-detail-filtering-across-two-pages-vb/_static/image28.png))</span></span>

<span data-ttu-id="7186e-178">データソースの構成ウィザードの最後の手順では、`GetProductsBySupplierID(supplierID)` メソッドの *`supplierID`* パラメーターのソースを指定するように求められます。</span><span class="sxs-lookup"><span data-stu-id="7186e-178">The final step of the Configure Data Source wizard asks us to provide the source of the `GetProductsBySupplierID(supplierID)` method's *`supplierID`* parameter.</span></span> <span data-ttu-id="7186e-179">Querystring 値を使用するには、パラメーターソースを QueryString に設定し、QueryStringField テキストボックス (`SupplierID`) で使用する querystring 値の名前を入力します。</span><span class="sxs-lookup"><span data-stu-id="7186e-179">To use the querystring value, set the Parameter source to QueryString and enter the name of the querystring value to use in the QueryStringField textbox (`SupplierID`).</span></span>

<span data-ttu-id="7186e-180">[仕入先のパラメーター値を仕入先のクエリ文字列の値から設定 ![](master-detail-filtering-across-two-pages-vb/_static/image30.png)](master-detail-filtering-across-two-pages-vb/_static/image29.png)</span><span class="sxs-lookup"><span data-stu-id="7186e-180">[![Populate the supplierID Parameter Value from the SupplierID Querystring Value](master-detail-filtering-across-two-pages-vb/_static/image30.png)](master-detail-filtering-across-two-pages-vb/_static/image29.png)</span></span>

<span data-ttu-id="7186e-181">**図 11**: `SupplierID` Querystring 値から *`supplierID`* パラメーター値を設定する ([クリックしてフルサイズのイメージを表示する](master-detail-filtering-across-two-pages-vb/_static/image31.png))</span><span class="sxs-lookup"><span data-stu-id="7186e-181">**Figure 11**: Populate the *`supplierID`* Parameter Value from the `SupplierID` Querystring Value ([Click to view full-size image](master-detail-filtering-across-two-pages-vb/_static/image31.png))</span></span>

<span data-ttu-id="7186e-182">これですべて完了です。</span><span class="sxs-lookup"><span data-stu-id="7186e-182">That's all there is to it!</span></span> <span data-ttu-id="7186e-183">図12は、`SupplierListMaster.aspx`から [東京 Traders] リンクをクリックしてアクセスしたときの `ProductsForSupplierDetails.aspx` ページを示しています。</span><span class="sxs-lookup"><span data-stu-id="7186e-183">Figure 12 shows the `ProductsForSupplierDetails.aspx` page when visited by clicking the Tokyo Traders link from `SupplierListMaster.aspx`.</span></span>

<span data-ttu-id="7186e-184">[東京 Traders 社によって提供される製品が ![表示されます。](master-detail-filtering-across-two-pages-vb/_static/image33.png)](master-detail-filtering-across-two-pages-vb/_static/image32.png)</span><span class="sxs-lookup"><span data-stu-id="7186e-184">[![The Products Supplied by Tokyo Traders are Shown](master-detail-filtering-across-two-pages-vb/_static/image33.png)](master-detail-filtering-across-two-pages-vb/_static/image32.png)</span></span>

<span data-ttu-id="7186e-185">**図 12**: 東京 Traders が提供する製品が表示されます ([クリックすると、フルサイズの画像が表示](master-detail-filtering-across-two-pages-vb/_static/image34.png)されます)</span><span class="sxs-lookup"><span data-stu-id="7186e-185">**Figure 12**: The Products Supplied by Tokyo Traders are Shown ([Click to view full-size image](master-detail-filtering-across-two-pages-vb/_static/image34.png))</span></span>

## <a name="displaying-supplier-information-inproductsforsupplierdetailsaspx"></a><span data-ttu-id="7186e-186">`ProductsForSupplierDetails.aspx` での仕入先情報の表示</span><span class="sxs-lookup"><span data-stu-id="7186e-186">Displaying Supplier Information in`ProductsForSupplierDetails.aspx`</span></span>

<span data-ttu-id="7186e-187">図12に示すように、[`ProductsForSupplierDetails.aspx`] ページには、クエリ文字列に指定された `SupplierID` によって提供される製品の一覧が表示されます。</span><span class="sxs-lookup"><span data-stu-id="7186e-187">As Figure 12 shows, the `ProductsForSupplierDetails.aspx` page simply lists the products that are supplied by the `SupplierID` specified in the querystring.</span></span> <span data-ttu-id="7186e-188">ただし、このページに直接送信されたユーザーは、図12に東京 Traders 社の製品が表示されていることはわかりません。</span><span class="sxs-lookup"><span data-stu-id="7186e-188">Someone sent directly to this page, however, would not know that Figure 12 is showing Tokyo Traders' products.</span></span> <span data-ttu-id="7186e-189">この問題を解決するには、このページでサプライヤー情報を表示することもできます。</span><span class="sxs-lookup"><span data-stu-id="7186e-189">To remedy this we can display supplier information in this page as well.</span></span>

<span data-ttu-id="7186e-190">まず、products GridView の上に FormView を追加します。</span><span class="sxs-lookup"><span data-stu-id="7186e-190">Start by adding a FormView above the products GridView.</span></span> <span data-ttu-id="7186e-191">`SuppliersBLL` クラスの `GetSupplierBySupplierID(supplierID)` メソッドを呼び出す `SuppliersDataSource` という名前の新しい ObjectDataSource コントロールを作成します。</span><span class="sxs-lookup"><span data-stu-id="7186e-191">Create a new ObjectDataSource control named `SuppliersDataSource` that invokes the `SuppliersBLL` class's `GetSupplierBySupplierID(supplierID)` method.</span></span>

<span data-ttu-id="7186e-192">[SuppliersBLL クラスを選択 ![には](master-detail-filtering-across-two-pages-vb/_static/image36.png)](master-detail-filtering-across-two-pages-vb/_static/image35.png)</span><span class="sxs-lookup"><span data-stu-id="7186e-192">[![Select the SuppliersBLL Class](master-detail-filtering-across-two-pages-vb/_static/image36.png)](master-detail-filtering-across-two-pages-vb/_static/image35.png)</span></span>

<span data-ttu-id="7186e-193">**図 13**: `SuppliersBLL` クラスを選択[する (クリックすると、フルサイズの画像が表示](master-detail-filtering-across-two-pages-vb/_static/image37.png)されます)</span><span class="sxs-lookup"><span data-stu-id="7186e-193">**Figure 13**: Select the `SuppliersBLL` Class ([Click to view full-size image](master-detail-filtering-across-two-pages-vb/_static/image37.png))</span></span>

<span data-ttu-id="7186e-194">[![ObjectDataSource Invoke GetSupplierBySupplierID (仕入先) メソッド](master-detail-filtering-across-two-pages-vb/_static/image39.png)](master-detail-filtering-across-two-pages-vb/_static/image38.png)</span><span class="sxs-lookup"><span data-stu-id="7186e-194">[![Have the ObjectDataSource Invoke the GetSupplierBySupplierID(supplierID) Method](master-detail-filtering-across-two-pages-vb/_static/image39.png)](master-detail-filtering-across-two-pages-vb/_static/image38.png)</span></span>

<span data-ttu-id="7186e-195">**図 14**: ObjectDataSource で `GetSupplierBySupplierID(supplierID)` メソッドを呼び出す ([クリックしてフルサイズのイメージを表示する](master-detail-filtering-across-two-pages-vb/_static/image40.png))</span><span class="sxs-lookup"><span data-stu-id="7186e-195">**Figure 14**: Have the ObjectDataSource Invoke the `GetSupplierBySupplierID(supplierID)` Method ([Click to view full-size image](master-detail-filtering-across-two-pages-vb/_static/image40.png))</span></span>

<span data-ttu-id="7186e-196">`ProductsBySupplierDataSource`と同様に、 *`supplierID`* パラメーターに `SupplierID` querystring 値の値が割り当てられている必要があります。</span><span class="sxs-lookup"><span data-stu-id="7186e-196">As with the `ProductsBySupplierDataSource`, have the *`supplierID`* parameter assigned the value of the `SupplierID` querystring value.</span></span>

<span data-ttu-id="7186e-197">[仕入先のパラメーター値を仕入先のクエリ文字列の値から設定 ![](master-detail-filtering-across-two-pages-vb/_static/image42.png)](master-detail-filtering-across-two-pages-vb/_static/image41.png)</span><span class="sxs-lookup"><span data-stu-id="7186e-197">[![Populate the supplierID Parameter Value from the SupplierID Querystring Value](master-detail-filtering-across-two-pages-vb/_static/image42.png)](master-detail-filtering-across-two-pages-vb/_static/image41.png)</span></span>

<span data-ttu-id="7186e-198">**図 15**: `SupplierID` Querystring 値から *`supplierID`* パラメーター値を設定する ([クリックしてフルサイズのイメージを表示する](master-detail-filtering-across-two-pages-vb/_static/image43.png))</span><span class="sxs-lookup"><span data-stu-id="7186e-198">**Figure 15**: Populate the *`supplierID`* Parameter Value from the `SupplierID` Querystring Value ([Click to view full-size image](master-detail-filtering-across-two-pages-vb/_static/image43.png))</span></span>

<span data-ttu-id="7186e-199">デザインビューで FormView を ObjectDataSource にバインドすると、Visual Studio は、ObjectDataSource によって返される各データフィールドに対して、ラベルとテキストボックス Web コントロールを含む FormView の `ItemTemplate`、`InsertItemTemplate`、および `EditItemTemplate` を自動的に作成します。</span><span class="sxs-lookup"><span data-stu-id="7186e-199">When binding the FormView to the ObjectDataSource in the Design view, Visual Studio will automatically create the FormView's `ItemTemplate`, `InsertItemTemplate`, and `EditItemTemplate` with Label and TextBox Web controls for each of the data fields returned by the ObjectDataSource.</span></span> <span data-ttu-id="7186e-200">仕入先情報を表示するだけなので、`InsertItemTemplate` と `EditItemTemplate`を削除してもかまいません。</span><span class="sxs-lookup"><span data-stu-id="7186e-200">Since we just want to display supplier information feel free to remove the `InsertItemTemplate` and `EditItemTemplate`.</span></span> <span data-ttu-id="7186e-201">次に、ItemTemplate を編集して、仕入先の会社名を `<h3>` 要素に、住所、市区町村、国、電話番号を会社名の下に表示するようにします。</span><span class="sxs-lookup"><span data-stu-id="7186e-201">Next, edit the ItemTemplate so that it displays the supplier's company name in an `<h3>` element and the address, city, country, and phone number beneath the company name.</span></span> <span data-ttu-id="7186e-202">または、FormView の `DataSourceID` を手動で設定し、「ObjectDataSource を使用した[データの表示](../basic-reporting/displaying-data-with-the-objectdatasource-cs.md)」のチュートリアルで説明したように、`ItemTemplate` マークアップを作成することもできます。</span><span class="sxs-lookup"><span data-stu-id="7186e-202">Alternatively, you can manually set the FormView's `DataSourceID` and create the `ItemTemplate` markup, as we did back in the "[Displaying Data With the ObjectDataSource](../basic-reporting/displaying-data-with-the-objectdatasource-cs.md)" tutorial.</span></span>

<span data-ttu-id="7186e-203">これらの編集の後、FormView の宣言型マークアップは次のようになります。</span><span class="sxs-lookup"><span data-stu-id="7186e-203">After these edits the FormView's declarative markup should look similar to the following:</span></span>

[!code-aspx[Main](master-detail-filtering-across-two-pages-vb/samples/sample3.aspx)]

<span data-ttu-id="7186e-204">図16は、上記で説明した業者情報が含まれていた後の `ProductsForSupplierDetails.aspx` ページのスクリーンショットを示しています。</span><span class="sxs-lookup"><span data-stu-id="7186e-204">Figure 16 shows a screen shot of the `ProductsForSupplierDetails.aspx` page after the supplier information detailed above has been included.</span></span>

<span data-ttu-id="7186e-205">[製品の一覧に ![業者に関する概要が記載されています。](master-detail-filtering-across-two-pages-vb/_static/image45.png)](master-detail-filtering-across-two-pages-vb/_static/image44.png)</span><span class="sxs-lookup"><span data-stu-id="7186e-205">[![The List of Products Includes a Summary About the Supplier](master-detail-filtering-across-two-pages-vb/_static/image45.png)](master-detail-filtering-across-two-pages-vb/_static/image44.png)</span></span>

<span data-ttu-id="7186e-206">**図 16**: 製品の一覧には、業者に関する概要が含まれています ([クリックすると、フルサイズの画像が表示](master-detail-filtering-across-two-pages-vb/_static/image46.png)されます)</span><span class="sxs-lookup"><span data-stu-id="7186e-206">**Figure 16**: The List of Products Includes a Summary About the Supplier ([Click to view full-size image](master-detail-filtering-across-two-pages-vb/_static/image46.png))</span></span>

## <a name="applying-the-final-touches-for-theproductsforsupplierdetailsaspxui"></a><span data-ttu-id="7186e-207">`ProductsForSupplierDetails.aspx`UI の最後のタッチを適用する</span><span class="sxs-lookup"><span data-stu-id="7186e-207">Applying the Final Touches for the`ProductsForSupplierDetails.aspx`UI</span></span>

<span data-ttu-id="7186e-208">このレポートのユーザーエクスペリエンスを向上させるために、`ProductsForSupplierDetails.aspx` のページに対していくつかの追加機能が用意されています。</span><span class="sxs-lookup"><span data-stu-id="7186e-208">To improve the user experience for this report there are a couple of additions we ought to make to the `ProductsForSupplierDetails.aspx` page.</span></span> <span data-ttu-id="7186e-209">現在、ユーザーが `ProductsForSupplierDetails.aspx` ページからサプライヤーの一覧に戻ることができる唯一の方法は、ブラウザーの [戻る] ボタンをクリックすることです。</span><span class="sxs-lookup"><span data-stu-id="7186e-209">Currently the only way a user can go from the `ProductsForSupplierDetails.aspx` page back to the list of suppliers is to click their browser's back button.</span></span> <span data-ttu-id="7186e-210">`SupplierListMaster.aspx`に戻るハイパーリンクコントロールを `ProductsForSupplierDetails.aspx` ページに追加して、ユーザーがマスターリストに戻るための別の方法を提供してみましょう。</span><span class="sxs-lookup"><span data-stu-id="7186e-210">Let's add a HyperLink control to the `ProductsForSupplierDetails.aspx` page that links back to `SupplierListMaster.aspx`, providing another way for the user to return to the master list.</span></span>

<span data-ttu-id="7186e-211">[![ハイパーリンクコントロールを追加して、ユーザーを SupplierListMaster に戻します。](master-detail-filtering-across-two-pages-vb/_static/image48.png)](master-detail-filtering-across-two-pages-vb/_static/image47.png)</span><span class="sxs-lookup"><span data-stu-id="7186e-211">[![Add a HyperLink Control to Take the User Back to SupplierListMaster.aspx](master-detail-filtering-across-two-pages-vb/_static/image48.png)](master-detail-filtering-across-two-pages-vb/_static/image47.png)</span></span>

<span data-ttu-id="7186e-212">**図 17**: ハイパーリンクコントロールを追加してユーザーを `SupplierListMaster.aspx` に戻す ([クリックしてフルサイズの画像を表示する](master-detail-filtering-across-two-pages-vb/_static/image49.png))</span><span class="sxs-lookup"><span data-stu-id="7186e-212">**Figure 17**: Add a HyperLink Control to Take the User Back to `SupplierListMaster.aspx` ([Click to view full-size image](master-detail-filtering-across-two-pages-vb/_static/image49.png))</span></span>

<span data-ttu-id="7186e-213">製品が存在しない業者の [製品の表示] リンクをクリックすると、`ProductsForSupplierDetails.aspx` の `ProductsBySupplierDataSource` ObjectDataSource では結果が返されません。</span><span class="sxs-lookup"><span data-stu-id="7186e-213">If the user clicks on the View Products link for a supplier that doesn't have any products, the `ProductsBySupplierDataSource` ObjectDataSource in `ProductsForSupplierDetails.aspx` won't return any results.</span></span> <span data-ttu-id="7186e-214">ObjectDataSource にバインドされている GridView では、ユーザーのブラウザーのページに空白の領域が生じるマークアップはレンダリングされません。</span><span class="sxs-lookup"><span data-stu-id="7186e-214">The GridView bound to the ObjectDataSource won't render any markup resulting in a blank region on the page in the user's browser.</span></span> <span data-ttu-id="7186e-215">選択した業者に関連付けられている製品がないことをユーザーにより明確に伝えるために、GridView の `EmptyDataText` プロパティを、このような状況が発生したときに表示するメッセージに設定できます。</span><span class="sxs-lookup"><span data-stu-id="7186e-215">To more clearly communicate to the user that there are no products associated with the selected supplier we can set the GridView's `EmptyDataText` property to the message we want displayed when such a situation arises.</span></span> <span data-ttu-id="7186e-216">このプロパティを "この供給業者によって提供される製品はありません" に設定しました。</span><span class="sxs-lookup"><span data-stu-id="7186e-216">I've set this property to "There are no products provided by this supplier�"</span></span>

<span data-ttu-id="7186e-217">既定では、Northwinds データベースのすべての仕入先は、少なくとも1つの製品を提供します。</span><span class="sxs-lookup"><span data-stu-id="7186e-217">By default, all suppliers in the Northwinds database provide at least one product.</span></span> <span data-ttu-id="7186e-218">ただし、このチュートリアルでは、supplier Escargots Nouveaux が製品に関連付けられないように、`Products` テーブルを手動で変更しました。</span><span class="sxs-lookup"><span data-stu-id="7186e-218">However, for this tutorial I've manually modified the `Products` table so that the supplier Escargots Nouveaux is no longer associated with any products.</span></span> <span data-ttu-id="7186e-219">図18は、この変更が行われた後の Escargots Nouveaux の詳細ページを示しています。</span><span class="sxs-lookup"><span data-stu-id="7186e-219">Figure 18 shows the details page for Escargots Nouveaux after this change has been made.</span></span>

<span data-ttu-id="7186e-220">[![ユーザーには、業者が製品を提供していないことが通知されます。](master-detail-filtering-across-two-pages-vb/_static/image51.png)](master-detail-filtering-across-two-pages-vb/_static/image50.png)</span><span class="sxs-lookup"><span data-stu-id="7186e-220">[![Users are Informed that the Supplier Doesn't Provide Any Products](master-detail-filtering-across-two-pages-vb/_static/image51.png)](master-detail-filtering-across-two-pages-vb/_static/image50.png)</span></span>

<span data-ttu-id="7186e-221">**図 18**: 業者が製品を提供していないことがユーザーに通知される ([クリックすると、フルサイズの画像が表示](master-detail-filtering-across-two-pages-vb/_static/image52.png)されます)</span><span class="sxs-lookup"><span data-stu-id="7186e-221">**Figure 18**: Users are Informed that the Supplier Doesn't Provide Any Products ([Click to view full-size image](master-detail-filtering-across-two-pages-vb/_static/image52.png))</span></span>

## <a name="summary"></a><span data-ttu-id="7186e-222">まとめ</span><span class="sxs-lookup"><span data-stu-id="7186e-222">Summary</span></span>

<span data-ttu-id="7186e-223">マスター/詳細レポートでは、マスターレコードと詳細レコードの両方を1ページに表示できますが、多くの web サイトでは、2つの web ページに分割されています。</span><span class="sxs-lookup"><span data-stu-id="7186e-223">While master/detail reports can display both the master and detail records on a single page, in many websites they are separated out across two web pages.</span></span> <span data-ttu-id="7186e-224">このチュートリアルでは、このようなマスター/詳細レポートを実装する方法について説明しました。これには、"マスター" web ページの GridView にサプライヤーを一覧表示し、[詳細] ページに一覧表示されている関連製品を表示します。</span><span class="sxs-lookup"><span data-stu-id="7186e-224">In this tutorial we looked at how to implement such a master/detail report by having the suppliers listed in a GridView in the "master" web page and the associated products listed in the "details" page.</span></span> <span data-ttu-id="7186e-225">マスター web ページの各 supplier 行には、行の `SupplierID` 値に従って渡された詳細ページへのリンクが含まれていました。</span><span class="sxs-lookup"><span data-stu-id="7186e-225">Each supplier row in the master web page contained a link to the details page that passed along the row's `SupplierID` value.</span></span> <span data-ttu-id="7186e-226">このような行固有のリンクは、GridView の [ハイパーリンク] フィールドを使用して簡単に追加できます。</span><span class="sxs-lookup"><span data-stu-id="7186e-226">Such row-specific links can be easily added using the GridView's HyperLinkField.</span></span>

<span data-ttu-id="7186e-227">詳細ページで、`ProductsBLL` クラスの `GetProductsBySupplierID(supplierID)` メソッドを呼び出すことによって、指定された業者のこれらの製品を取得しました。</span><span class="sxs-lookup"><span data-stu-id="7186e-227">In the details page retrieving those products for the specified supplier was accomplished by invoking the `ProductsBLL` class's `GetProductsBySupplierID(supplierID)` method.</span></span> <span data-ttu-id="7186e-228">*`supplierID`* パラメーター値は、querystring をパラメーターソースとして使用して宣言的に指定されました。</span><span class="sxs-lookup"><span data-stu-id="7186e-228">The *`supplierID`* parameter value was specified declaratively using the querystring as the parameter source.</span></span> <span data-ttu-id="7186e-229">また、FormView を使用して詳細ページでサプライヤーの詳細を表示する方法についても説明しました。</span><span class="sxs-lookup"><span data-stu-id="7186e-229">We also looked at how to display the supplier details in the details page using a FormView.</span></span>

<span data-ttu-id="7186e-230">[次のチュートリアル](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb.md)では、マスター/詳細レポートについて説明します。</span><span class="sxs-lookup"><span data-stu-id="7186e-230">Our [next tutorial](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb.md) is the final one on master/detail reports.</span></span> <span data-ttu-id="7186e-231">GridView で製品の一覧を表示する方法について説明します。各行には [選択] ボタンがあります。</span><span class="sxs-lookup"><span data-stu-id="7186e-231">We'll look at how to display a list of products in a GridView where each row has a Select button.</span></span> <span data-ttu-id="7186e-232">[選択] ボタンをクリックすると、同じページの DetailsView コントロールにその製品の詳細が表示されます。</span><span class="sxs-lookup"><span data-stu-id="7186e-232">Clicking on the Select button will display that product's details in a DetailsView control on the same page.</span></span>

<span data-ttu-id="7186e-233">プログラミングを楽しんでください。</span><span class="sxs-lookup"><span data-stu-id="7186e-233">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="7186e-234">著者について</span><span class="sxs-lookup"><span data-stu-id="7186e-234">About the Author</span></span>

<span data-ttu-id="7186e-235">1998以来、 [Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml)は 7 asp/創設者 of [4GuysFromRolla.com](http://www.4guysfromrolla.com)の執筆者であり、Microsoft Web テクノロジを使用しています。</span><span class="sxs-lookup"><span data-stu-id="7186e-235">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="7186e-236">Scott は、独立したコンサルタント、トレーナー、およびライターとして機能します。</span><span class="sxs-lookup"><span data-stu-id="7186e-236">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="7186e-237">彼の最新の書籍は[ *、ASP.NET 2.0 を24時間以内に教え*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)ています。</span><span class="sxs-lookup"><span data-stu-id="7186e-237">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="7186e-238">mitchell@4GuysFromRolla.comでアクセスでき[ます。](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="7186e-238">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="7186e-239">または彼のブログを参照してください。これは[http://ScottOnWriting.NET](http://ScottOnWriting.NET)にあります。</span><span class="sxs-lookup"><span data-stu-id="7186e-239">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="7186e-240">ありがとうございました。</span><span class="sxs-lookup"><span data-stu-id="7186e-240">Special Thanks To</span></span>

<span data-ttu-id="7186e-241">このチュートリアルシリーズは、役に立つ多くのレビュー担当者によってレビューされました。</span><span class="sxs-lookup"><span data-stu-id="7186e-241">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="7186e-242">このチュートリアルのリードレビュー担当者は、Hilton Giesenow でした。</span><span class="sxs-lookup"><span data-stu-id="7186e-242">Lead reviewer for this tutorial was Hilton Giesenow.</span></span> <span data-ttu-id="7186e-243">今後の MSDN 記事を確認することに興味がありますか?</span><span class="sxs-lookup"><span data-stu-id="7186e-243">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="7186e-244">その場合は、mitchell@4GuysFromRolla.comの行を削除[します。](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="7186e-244">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="7186e-245">[前へ](master-detail-filtering-with-two-dropdownlists-vb.md)
> [次へ](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb.md)</span><span class="sxs-lookup"><span data-stu-id="7186e-245">[Previous](master-detail-filtering-with-two-dropdownlists-vb.md)
[Next](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb.md)</span></span>

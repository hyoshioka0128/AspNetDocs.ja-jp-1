---
uid: web-forms/overview/data-access/masterdetail/master-detail-filtering-with-two-dropdownlists-vb
title: 2つの DropDownLists を使用したマスター/詳細フィルター処理 (VB) |Microsoft Docs
author: rick-anderson
description: このチュートリアルでは、マスター/詳細リレーションシップを展開して3番目のレイヤーを追加し、2つの DropDownList コントロールを使用して目的の親を選択します。
ms.author: riande
ms.date: 03/31/2010
ms.assetid: 11ae4f64-01ba-4823-95f4-a2fe1f84f7d7
msc.legacyurl: /web-forms/overview/data-access/masterdetail/master-detail-filtering-with-two-dropdownlists-vb
msc.type: authoredcontent
ms.openlocfilehash: 166d6a7664a326361dc2a3f115eddb988cd39d20
ms.sourcegitcommit: 22fbd8863672c4ad6693b8388ad5c8e753fb41a2
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 11/28/2019
ms.locfileid: "74577979"
---
# <a name="masterdetail-filtering-with-two-dropdownlists-vb"></a><span data-ttu-id="fa1b0-103">2 つの DropDownList でマスター/詳細をフィルター処理する (VB)</span><span class="sxs-lookup"><span data-stu-id="fa1b0-103">Master/Detail Filtering With Two DropDownLists (VB)</span></span>

<span data-ttu-id="fa1b0-104">[Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="fa1b0-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="fa1b0-105">[サンプルアプリのダウンロード](https://download.microsoft.com/download/5/d/7/5d7571fc-d0b7-4798-ad4a-c976c02363ce/ASPNET_Data_Tutorial_8_VB.exe)または[PDF のダウンロード](master-detail-filtering-with-two-dropdownlists-vb/_static/datatutorial08vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="fa1b0-105">[Download Sample App](https://download.microsoft.com/download/5/d/7/5d7571fc-d0b7-4798-ad4a-c976c02363ce/ASPNET_Data_Tutorial_8_VB.exe) or [Download PDF](master-detail-filtering-with-two-dropdownlists-vb/_static/datatutorial08vb1.pdf)</span></span>

> <span data-ttu-id="fa1b0-106">このチュートリアルでは、マスター/詳細リレーションシップを展開して3番目のレイヤーを追加します。2つの DropDownList コントロールを使用して、目的の親レコードと祖父母レコードを選択します。</span><span class="sxs-lookup"><span data-stu-id="fa1b0-106">This tutorial expands the master/detail relationship to add a third layer, using two DropDownList controls to select the desired parent and grandparent records.</span></span>

## <a name="introduction"></a><span data-ttu-id="fa1b0-107">はじめに</span><span class="sxs-lookup"><span data-stu-id="fa1b0-107">Introduction</span></span>

<span data-ttu-id="fa1b0-108">前の[チュートリアル](master-detail-filtering-with-a-dropdownlist-vb.md)では、カテゴリが設定された1つの DropDownList と、選択したカテゴリに属する製品を示す GridView を使用して、単純なマスター/詳細レポートを表示する方法を説明しました。</span><span class="sxs-lookup"><span data-stu-id="fa1b0-108">In the [previous tutorial](master-detail-filtering-with-a-dropdownlist-vb.md) we examined how to display a simple master/details report using a single DropDownList populated with the categories and a GridView showing those products that belong to the selected category.</span></span> <span data-ttu-id="fa1b0-109">このレポートパターンは、一対多のリレーションシップを持つレコードを表示する場合に適しています。また、複数の一対多リレーションシップを含むシナリオで機能するように簡単に拡張できます。</span><span class="sxs-lookup"><span data-stu-id="fa1b0-109">This report pattern works well when displaying records that have a one-to-many relationship and can easily be extended to work for scenarios that include multiple one-to-many relationships.</span></span> <span data-ttu-id="fa1b0-110">たとえば、注文入力システムには、顧客、注文、および注文品目に対応するテーブルがあります。</span><span class="sxs-lookup"><span data-stu-id="fa1b0-110">For example, an order entry system would have tables that correspond to customers, orders, and order line items.</span></span> <span data-ttu-id="fa1b0-111">特定の顧客には、注文ごとに複数の注文が含まれている場合があります。</span><span class="sxs-lookup"><span data-stu-id="fa1b0-111">A given customer may have multiple orders with each order consisting of multiple items.</span></span> <span data-ttu-id="fa1b0-112">このようなデータは、2つの DropDownLists と GridView を使用してユーザーに提示できます。</span><span class="sxs-lookup"><span data-stu-id="fa1b0-112">Such data can be presented to the user with two DropDownLists and a GridView.</span></span> <span data-ttu-id="fa1b0-113">最初の DropDownList には、データベース内の顧客ごとに、2番目の内容が選択した顧客によって配置された注文であるというリストアイテムがあります。</span><span class="sxs-lookup"><span data-stu-id="fa1b0-113">The first DropDownList would have a list item for each customer in the database with the second one's contents being the orders placed by the selected customer.</span></span> <span data-ttu-id="fa1b0-114">GridView では、選択した順序で行項目が一覧表示されます。</span><span class="sxs-lookup"><span data-stu-id="fa1b0-114">A GridView would list the line items from the selected order.</span></span>

<span data-ttu-id="fa1b0-115">Northwind データベースには、`Customers`、`Orders`、および `Order Details` の各テーブルに、正規の顧客/注文/注文の詳細情報が含まれていますが、これらのテーブルはアーキテクチャではキャプチャされません。</span><span class="sxs-lookup"><span data-stu-id="fa1b0-115">While the Northwind database include the canonical customer/order/order details information in its `Customers`, `Orders`, and `Order Details` tables, these tables aren't captured in our architecture.</span></span> <span data-ttu-id="fa1b0-116">それでも、2つの依存する DropDownLists を使用して説明することはできます。</span><span class="sxs-lookup"><span data-stu-id="fa1b0-116">Nonetheless, we can still illustrate using two dependent DropDownLists.</span></span> <span data-ttu-id="fa1b0-117">最初の DropDownList にカテゴリと、選択したカテゴリに属する2番目の製品が一覧表示されます。</span><span class="sxs-lookup"><span data-stu-id="fa1b0-117">The first DropDownList will list the categories and the second the products belonging to the selected category.</span></span> <span data-ttu-id="fa1b0-118">次に、選択した製品の詳細が表示されます。</span><span class="sxs-lookup"><span data-stu-id="fa1b0-118">A DetailsView will then list the details of the selected product.</span></span>

## <a name="step-1-creating-and-populating-the-categories-dropdownlist"></a><span data-ttu-id="fa1b0-119">手順 1: カテゴリの作成と設定 DropDownList</span><span class="sxs-lookup"><span data-stu-id="fa1b0-119">Step 1: Creating and Populating the Categories DropDownList</span></span>

<span data-ttu-id="fa1b0-120">最初の目標は、カテゴリを一覧表示する DropDownList を追加することです。</span><span class="sxs-lookup"><span data-stu-id="fa1b0-120">Our first goal is to add the DropDownList that lists the categories.</span></span> <span data-ttu-id="fa1b0-121">これらの手順の詳細については、前のチュートリアルで詳しく説明しましたが、ここでは完全を期すためにまとめました。</span><span class="sxs-lookup"><span data-stu-id="fa1b0-121">These steps were examined in detail in the preceding tutorial, but are summarized here for completeness.</span></span>

<span data-ttu-id="fa1b0-122">`Filtering` フォルダーの [`MasterDetailsDetails.aspx`] ページを開き、DropDownList をページに追加します。その `ID` プロパティを [`Categories`] に設定し、そのスマートタグの [データソースの構成] リンクをクリックします。</span><span class="sxs-lookup"><span data-stu-id="fa1b0-122">Open the `MasterDetailsDetails.aspx` page in the `Filtering` folder, add a DropDownList to the page, set its `ID` property to `Categories`, and then click the Configure Data Source link in its smart tag.</span></span> <span data-ttu-id="fa1b0-123">データソース構成ウィザードから、新しいデータソースの追加を選択します。</span><span class="sxs-lookup"><span data-stu-id="fa1b0-123">From the Data Source Configuration Wizard choose to add a new data source.</span></span>

<span data-ttu-id="fa1b0-124">[DropDownList の新しいデータソースを追加 ![には](master-detail-filtering-with-two-dropdownlists-vb/_static/image2.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="fa1b0-124">[![Add a New Data Source for the DropDownList](master-detail-filtering-with-two-dropdownlists-vb/_static/image2.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image1.png)</span></span>

<span data-ttu-id="fa1b0-125">**図 1**: DropDownList の新しいデータソースを追加する ([クリックすると、フルサイズの画像が表示](master-detail-filtering-with-two-dropdownlists-vb/_static/image3.png)されます)</span><span class="sxs-lookup"><span data-stu-id="fa1b0-125">**Figure 1**: Add a New Data Source for the DropDownList ([Click to view full-size image](master-detail-filtering-with-two-dropdownlists-vb/_static/image3.png))</span></span>

<span data-ttu-id="fa1b0-126">新しいデータソースは、当然、ObjectDataSource である必要があります。</span><span class="sxs-lookup"><span data-stu-id="fa1b0-126">The new data source should, naturally, be an ObjectDataSource.</span></span> <span data-ttu-id="fa1b0-127">この新しい ObjectDataSource `CategoriesDataSource` という名前を指定し、`CategoriesBLL` オブジェクトの `GetCategories()` メソッドを呼び出すようにします。</span><span class="sxs-lookup"><span data-stu-id="fa1b0-127">Name this new ObjectDataSource `CategoriesDataSource` and have it invoke the `CategoriesBLL` object's `GetCategories()` method.</span></span>

<span data-ttu-id="fa1b0-128">[カテゴリ Bll クラスの使用を選択 ![](master-detail-filtering-with-two-dropdownlists-vb/_static/image5.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="fa1b0-128">[![Choose to Use the CategoriesBLL Class](master-detail-filtering-with-two-dropdownlists-vb/_static/image5.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image4.png)</span></span>

<span data-ttu-id="fa1b0-129">**図 2**: `CategoriesBLL` クラスの使用を選択する ([クリックしてフルサイズのイメージを表示する](master-detail-filtering-with-two-dropdownlists-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="fa1b0-129">**Figure 2**: Choose to Use the `CategoriesBLL` Class ([Click to view full-size image](master-detail-filtering-with-two-dropdownlists-vb/_static/image6.png))</span></span>

<span data-ttu-id="fa1b0-130">[GetCategories () メソッドを使用するように ObjectDataSource を構成 ![には](master-detail-filtering-with-two-dropdownlists-vb/_static/image8.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="fa1b0-130">[![Configure the ObjectDataSource to Use the GetCategories() Method](master-detail-filtering-with-two-dropdownlists-vb/_static/image8.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image7.png)</span></span>

<span data-ttu-id="fa1b0-131">**図 3**: `GetCategories()` メソッドを使用するように ObjectDataSource を構成する ([クリックしてフルサイズのイメージを表示する](master-detail-filtering-with-two-dropdownlists-vb/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="fa1b0-131">**Figure 3**: Configure the ObjectDataSource to Use the `GetCategories()` Method ([Click to view full-size image](master-detail-filtering-with-two-dropdownlists-vb/_static/image9.png))</span></span>

<span data-ttu-id="fa1b0-132">ObjectDataSource を構成した後も、`Categories` DropDownList に表示するデータソースフィールドを指定し、リストアイテムの値として構成する必要があるデータソースフィールドを指定する必要があります。</span><span class="sxs-lookup"><span data-stu-id="fa1b0-132">After configuring the ObjectDataSource we still need to specify which data source field should be displayed in the `Categories` DropDownList and which one should be configured as the value for the list item.</span></span> <span data-ttu-id="fa1b0-133">`CategoryName` フィールドを表示として設定し、各リスト項目の値として `CategoryID` します。</span><span class="sxs-lookup"><span data-stu-id="fa1b0-133">Set the `CategoryName` field as the display and `CategoryID` as the value for each list item.</span></span>

<span data-ttu-id="fa1b0-134">[DropDownList で [区分項目] フィールドを表示し、値として CategoryID を使用する ![ます。](master-detail-filtering-with-two-dropdownlists-vb/_static/image11.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="fa1b0-134">[![Have the DropDownList Display the CategoryName Field and Use CategoryID as the Value](master-detail-filtering-with-two-dropdownlists-vb/_static/image11.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image10.png)</span></span>

<span data-ttu-id="fa1b0-135">**図 4**: DropDownList に `CategoryName` フィールドが表示され、`CategoryID` を値として使用する ([クリックしてフルサイズの画像を表示する](master-detail-filtering-with-two-dropdownlists-vb/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="fa1b0-135">**Figure 4**: Have the DropDownList Display the `CategoryName` Field and Use `CategoryID` as the Value ([Click to view full-size image](master-detail-filtering-with-two-dropdownlists-vb/_static/image12.png))</span></span>

<span data-ttu-id="fa1b0-136">この時点で、`Categories` テーブルのレコードが設定された DropDownList コントロール (`Categories`) があります。</span><span class="sxs-lookup"><span data-stu-id="fa1b0-136">At this point we have a DropDownList control (`Categories`) that's populated with the records from the `Categories` table.</span></span> <span data-ttu-id="fa1b0-137">ユーザーが DropDownList から新しいカテゴリを選択すると、手順 2. で作成しようとしている製品の DropDownList を更新するためにポストバックが発生します。</span><span class="sxs-lookup"><span data-stu-id="fa1b0-137">When the user chooses a new category from the DropDownList we'll want a postback to occur in order to refresh the product DropDownList that we're going to create in Step 2.</span></span> <span data-ttu-id="fa1b0-138">そのため、`categories` DropDownList のスマートタグから [AutoPostBack を有効にする] オプションをオンにします。</span><span class="sxs-lookup"><span data-stu-id="fa1b0-138">Therefore, check the Enable AutoPostBack option from the `categories` DropDownList's smart tag.</span></span>

<span data-ttu-id="fa1b0-139">[カテゴリの DropDownList に対して AutoPostBack を有効に ![](master-detail-filtering-with-two-dropdownlists-vb/_static/image14.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="fa1b0-139">[![Enable AutoPostBack for the Categories DropDownList](master-detail-filtering-with-two-dropdownlists-vb/_static/image14.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image13.png)</span></span>

<span data-ttu-id="fa1b0-140">**図 5**: `Categories` DropDownList の AutoPostBack を有効[にする (クリックしてフルサイズのイメージを表示する](master-detail-filtering-with-two-dropdownlists-vb/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="fa1b0-140">**Figure 5**: Enable AutoPostBack for the `Categories` DropDownList ([Click to view full-size image](master-detail-filtering-with-two-dropdownlists-vb/_static/image15.png))</span></span>

## <a name="step-2-displaying-the-selected-categorys-products-in-a-second-dropdownlist"></a><span data-ttu-id="fa1b0-141">手順 2: 選択したカテゴリの製品を2番目の DropDownList に表示する</span><span class="sxs-lookup"><span data-stu-id="fa1b0-141">Step 2: Displaying the Selected Category's Products in a Second DropDownList</span></span>

<span data-ttu-id="fa1b0-142">`Categories` DropDownList が完了したら、次の手順では、選択したカテゴリに属する製品の DropDownList を表示します。</span><span class="sxs-lookup"><span data-stu-id="fa1b0-142">With the `Categories` DropDownList completed, our next step is to display a DropDownList of products belonging to the selected category.</span></span> <span data-ttu-id="fa1b0-143">これを行うには、`ProductsByCategory`という名前のページに別の DropDownList を追加します。</span><span class="sxs-lookup"><span data-stu-id="fa1b0-143">To accomplish this, add another DropDownList to the page named `ProductsByCategory`.</span></span> <span data-ttu-id="fa1b0-144">`Categories` DropDownList と同様に、`ProductsByCategoryDataSource`という名前の `ProductsByCategory` DropDownList の新しい ObjectDataSource を作成します。</span><span class="sxs-lookup"><span data-stu-id="fa1b0-144">As with the `Categories` DropDownList, create a new ObjectDataSource for the `ProductsByCategory` DropDownList named `ProductsByCategoryDataSource`.</span></span>

<span data-ttu-id="fa1b0-145">[製品 Bycategory の DropDownList の新しいデータソースを追加 ![には](master-detail-filtering-with-two-dropdownlists-vb/_static/image17.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="fa1b0-145">[![Add a New Data Source for the ProductsByCategory DropDownList](master-detail-filtering-with-two-dropdownlists-vb/_static/image17.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image16.png)</span></span>

<span data-ttu-id="fa1b0-146">**図 6**: `ProductsByCategory` DropDownList の新しいデータソースを追加する ([クリックすると、フルサイズの画像が表示](master-detail-filtering-with-two-dropdownlists-vb/_static/image18.png)されます)</span><span class="sxs-lookup"><span data-stu-id="fa1b0-146">**Figure 6**: Add a New Data Source for the `ProductsByCategory` DropDownList ([Click to view full-size image](master-detail-filtering-with-two-dropdownlists-vb/_static/image18.png))</span></span>

<span data-ttu-id="fa1b0-147">[新しい ObjectDataSource という名前の新しい ![を作成します。](master-detail-filtering-with-two-dropdownlists-vb/_static/image20.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="fa1b0-147">[![Create a New ObjectDataSource Named ProductsByCategoryDataSource](master-detail-filtering-with-two-dropdownlists-vb/_static/image20.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image19.png)</span></span>

<span data-ttu-id="fa1b0-148">**図 7**: `ProductsByCategoryDataSource` という名前の新しい ObjectDataSource を作成[する (クリックすると、フルサイズの画像が表示](master-detail-filtering-with-two-dropdownlists-vb/_static/image21.png)される)</span><span class="sxs-lookup"><span data-stu-id="fa1b0-148">**Figure 7**: Create a New ObjectDataSource Named `ProductsByCategoryDataSource` ([Click to view full-size image](master-detail-filtering-with-two-dropdownlists-vb/_static/image21.png))</span></span>

<span data-ttu-id="fa1b0-149">`ProductsByCategory` DropDownList は選択されたカテゴリに属する製品のみを表示する必要があるため、ObjectDataSource は `ProductsBLL` オブジェクトから `GetProductsByCategoryID(categoryID)` メソッドを呼び出します。</span><span class="sxs-lookup"><span data-stu-id="fa1b0-149">Since the `ProductsByCategory` DropDownList needs to display just those products belonging to the selected category, have the ObjectDataSource invoke the `GetProductsByCategoryID(categoryID)` method from the `ProductsBLL` object.</span></span>

<span data-ttu-id="fa1b0-150">[製品の Bll クラスの使用を選択 ![](master-detail-filtering-with-two-dropdownlists-vb/_static/image23.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image22.png)</span><span class="sxs-lookup"><span data-stu-id="fa1b0-150">[![Choose to Use the ProductsBLL Class](master-detail-filtering-with-two-dropdownlists-vb/_static/image23.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image22.png)</span></span>

<span data-ttu-id="fa1b0-151">**図 8**: `ProductsBLL` クラスの使用を選択する ([クリックしてフルサイズのイメージを表示する](master-detail-filtering-with-two-dropdownlists-vb/_static/image24.png))</span><span class="sxs-lookup"><span data-stu-id="fa1b0-151">**Figure 8**: Choose to Use the `ProductsBLL` Class ([Click to view full-size image](master-detail-filtering-with-two-dropdownlists-vb/_static/image24.png))</span></span>

<span data-ttu-id="fa1b0-152">[Get$ Bycategoryid (categoryID) メソッドを使用するように ObjectDataSource を構成 ![には](master-detail-filtering-with-two-dropdownlists-vb/_static/image26.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image25.png)</span><span class="sxs-lookup"><span data-stu-id="fa1b0-152">[![Configure the ObjectDataSource to Use the GetProductsByCategoryID(categoryID) Method](master-detail-filtering-with-two-dropdownlists-vb/_static/image26.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image25.png)</span></span>

<span data-ttu-id="fa1b0-153">**図 9**: `GetProductsByCategoryID(categoryID)` メソッドを使用するように ObjectDataSource を構成する ([クリックしてフルサイズのイメージを表示する](master-detail-filtering-with-two-dropdownlists-vb/_static/image27.png))</span><span class="sxs-lookup"><span data-stu-id="fa1b0-153">**Figure 9**: Configure the ObjectDataSource to Use the `GetProductsByCategoryID(categoryID)` Method ([Click to view full-size image](master-detail-filtering-with-two-dropdownlists-vb/_static/image27.png))</span></span>

<span data-ttu-id="fa1b0-154">ウィザードの最後の手順では、 *`categoryID`* パラメーターの値を指定する必要があります。</span><span class="sxs-lookup"><span data-stu-id="fa1b0-154">In the final step of the wizard we need to specify the value of the *`categoryID`* parameter.</span></span> <span data-ttu-id="fa1b0-155">このパラメーターを `Categories` DropDownList から選択した項目に割り当てます。</span><span class="sxs-lookup"><span data-stu-id="fa1b0-155">Assign this parameter to the selected item from the `Categories` DropDownList.</span></span>

<span data-ttu-id="fa1b0-156">[カテゴリの DropDownList から categoryID パラメーター値をプル ![には](master-detail-filtering-with-two-dropdownlists-vb/_static/image29.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image28.png)</span><span class="sxs-lookup"><span data-stu-id="fa1b0-156">[![Pull the categoryID Parameter Value from the Categories DropDownList](master-detail-filtering-with-two-dropdownlists-vb/_static/image29.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image28.png)</span></span>

<span data-ttu-id="fa1b0-157">**図 10**: `Categories` DropDownList から *`categoryID`* パラメーターの値を取得[する (クリックしてフルサイズのイメージを表示する](master-detail-filtering-with-two-dropdownlists-vb/_static/image30.png))</span><span class="sxs-lookup"><span data-stu-id="fa1b0-157">**Figure 10**: Pull the *`categoryID`* Parameter Value from the `Categories` DropDownList ([Click to view full-size image](master-detail-filtering-with-two-dropdownlists-vb/_static/image30.png))</span></span>

<span data-ttu-id="fa1b0-158">ObjectDataSource が構成されていれば、DropDownList の項目の表示と値に使用されるデータソースフィールドを指定するだけです。</span><span class="sxs-lookup"><span data-stu-id="fa1b0-158">With the ObjectDataSource configured, all that remains is to specify what data source fields are used for the display and value of the DropDownList's items.</span></span> <span data-ttu-id="fa1b0-159">[`ProductName`] フィールドを表示し、[`ProductID`] フィールドを値として使用します。</span><span class="sxs-lookup"><span data-stu-id="fa1b0-159">Display the `ProductName` field and use the `ProductID` field as the value.</span></span>

<span data-ttu-id="fa1b0-160">[DropDownList の ListItems のテキストと値のプロパティに使用されるデータソースフィールドを指定 ![](master-detail-filtering-with-two-dropdownlists-vb/_static/image32.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image31.png)</span><span class="sxs-lookup"><span data-stu-id="fa1b0-160">[![Specify the Data Source Fields Used for the DropDownList's ListItems' Text and Value Properties](master-detail-filtering-with-two-dropdownlists-vb/_static/image32.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image31.png)</span></span>

<span data-ttu-id="fa1b0-161">**図 11**: DropDownList の `ListItem` s ' `Text` と `Value` プロパティに使用されるデータソースフィールドを指定[する (クリックしてフルサイズの画像を表示する](master-detail-filtering-with-two-dropdownlists-vb/_static/image33.png))</span><span class="sxs-lookup"><span data-stu-id="fa1b0-161">**Figure 11**: Specify the Data Source Fields Used for the DropDownList's `ListItem` s' `Text` and `Value` Properties ([Click to view full-size image](master-detail-filtering-with-two-dropdownlists-vb/_static/image33.png))</span></span>

<span data-ttu-id="fa1b0-162">ObjectDataSource と `ProductsByCategory` DropDownList が構成されている場合、ページには2つの DropDownLists が表示されます。1つ目はすべてのカテゴリを一覧表示し、2番目のリストは選択したカテゴリに属する製品を一覧表示します。</span><span class="sxs-lookup"><span data-stu-id="fa1b0-162">With the ObjectDataSource and `ProductsByCategory` DropDownList configured our page will display two DropDownLists: the first will list all of the categories while the second will list those products belonging to the selected category.</span></span> <span data-ttu-id="fa1b0-163">ユーザーが最初の DropDownList から新しいカテゴリを選択すると、ポストバックは議論され、2番目の DropDownList は再バインドされ、新しく選択されたカテゴリに属する製品が表示されます。</span><span class="sxs-lookup"><span data-stu-id="fa1b0-163">When the user selects a new category from the first DropDownList, a postback will ensue and the second DropDownList will be rebound, showing those products that belong to the newly selected category.</span></span> <span data-ttu-id="fa1b0-164">図12および13は、ブラウザーで表示したときに `MasterDetailsDetails.aspx` の動作を示しています。</span><span class="sxs-lookup"><span data-stu-id="fa1b0-164">Figures 12 and 13 show `MasterDetailsDetails.aspx` in action when viewed through a browser.</span></span>

<span data-ttu-id="fa1b0-165">[![最初にページにアクセスしたときに、飲み物のカテゴリが選択されます。](master-detail-filtering-with-two-dropdownlists-vb/_static/image35.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image34.png)</span><span class="sxs-lookup"><span data-stu-id="fa1b0-165">[![When First Visiting the Page, the Beverages Category is Selected](master-detail-filtering-with-two-dropdownlists-vb/_static/image35.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image34.png)</span></span>

<span data-ttu-id="fa1b0-166">**図 12**: 最初にページにアクセスしたときに飲み物のカテゴリが選択されている ([クリックすると、フルサイズの画像が表示](master-detail-filtering-with-two-dropdownlists-vb/_static/image36.png)されます)</span><span class="sxs-lookup"><span data-stu-id="fa1b0-166">**Figure 12**: When First Visiting the Page, the Beverages Category is Selected ([Click to view full-size image](master-detail-filtering-with-two-dropdownlists-vb/_static/image36.png))</span></span>

<span data-ttu-id="fa1b0-167">[別のカテゴリを選択 ![と、新しいカテゴリの製品が表示されます](master-detail-filtering-with-two-dropdownlists-vb/_static/image38.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image37.png)</span><span class="sxs-lookup"><span data-stu-id="fa1b0-167">[![Choosing a Different Category Displays the New Category's Products](master-detail-filtering-with-two-dropdownlists-vb/_static/image38.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image37.png)</span></span>

<span data-ttu-id="fa1b0-168">**図 13**: 別のカテゴリを選択すると、新しいカテゴリの製品が表示されます ([クリックすると、フルサイズの画像が表示](master-detail-filtering-with-two-dropdownlists-vb/_static/image39.png)されます)</span><span class="sxs-lookup"><span data-stu-id="fa1b0-168">**Figure 13**: Choosing a Different Category Displays the New Category's Products ([Click to view full-size image](master-detail-filtering-with-two-dropdownlists-vb/_static/image39.png))</span></span>

<span data-ttu-id="fa1b0-169">現在 `productsByCategory` DropDownList は、変更された場合、ポストバックを発生*させません*。</span><span class="sxs-lookup"><span data-stu-id="fa1b0-169">Currently the `productsByCategory` DropDownList, when changed, does *not* cause a postback.</span></span> <span data-ttu-id="fa1b0-170">ただし、選択した製品の詳細を表示するために DetailsView を追加した後に、ポストバックが発生するようにします (手順 3)。</span><span class="sxs-lookup"><span data-stu-id="fa1b0-170">However, we will want a postback to occur once we add a DetailsView to display the selected product's details (Step 3).</span></span> <span data-ttu-id="fa1b0-171">そのため、`productsByCategory` DropDownList のスマートタグから [AutoPostBack を有効にする] チェックボックスをオンにします。</span><span class="sxs-lookup"><span data-stu-id="fa1b0-171">Therefore, check the Enable AutoPostBack checkbox from the `productsByCategory` DropDownList's smart tag.</span></span>

<span data-ttu-id="fa1b0-172">[製品 Bycategory の DropDownList の AutoPostBack 機能を有効 ![には](master-detail-filtering-with-two-dropdownlists-vb/_static/image41.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image40.png)</span><span class="sxs-lookup"><span data-stu-id="fa1b0-172">[![Enable the AutoPostBack Feature for the productsByCategory DropDownList](master-detail-filtering-with-two-dropdownlists-vb/_static/image41.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image40.png)</span></span>

<span data-ttu-id="fa1b0-173">**図 14**: `productsByCategory` DropDownList の AutoPostBack 機能を有効にする ([クリックしてフルサイズのイメージを表示する](master-detail-filtering-with-two-dropdownlists-vb/_static/image42.png))</span><span class="sxs-lookup"><span data-stu-id="fa1b0-173">**Figure 14**: Enable the AutoPostBack Feature for the `productsByCategory` DropDownList ([Click to view full-size image](master-detail-filtering-with-two-dropdownlists-vb/_static/image42.png))</span></span>

## <a name="step-3-using-a-detailsview-to-display-details-for-the-selected-product"></a><span data-ttu-id="fa1b0-174">手順 3: DetailsView を使用して選択した製品の詳細を表示する</span><span class="sxs-lookup"><span data-stu-id="fa1b0-174">Step 3: Using a DetailsView to Display Details for the Selected Product</span></span>

<span data-ttu-id="fa1b0-175">最後の手順は、選択した製品の詳細を DetailsView で表示することです。</span><span class="sxs-lookup"><span data-stu-id="fa1b0-175">The final step is to display the details for the selected product in a DetailsView.</span></span> <span data-ttu-id="fa1b0-176">これを行うには、DetailsView をページに追加し、その `ID` プロパティを `ProductDetails`に設定して、新しい ObjectDataSource を作成します。</span><span class="sxs-lookup"><span data-stu-id="fa1b0-176">To accomplish this, add a DetailsView to the page, set its `ID` property to `ProductDetails`, and create a new ObjectDataSource for it.</span></span> <span data-ttu-id="fa1b0-177">この ObjectDataSource を構成して、 *`productID`* パラメーターの値に対して `ProductsByCategory` DropDownList の選択された値を使用して、`ProductsBLL` クラスの `GetProductByProductID(productID)` メソッドからデータをプルします。</span><span class="sxs-lookup"><span data-stu-id="fa1b0-177">Configure this ObjectDataSource to pull its data from the `ProductsBLL` class's `GetProductByProductID(productID)` method using the selected value of the `ProductsByCategory` DropDownList for the value of the *`productID`* parameter.</span></span>

<span data-ttu-id="fa1b0-178">[製品の Bll クラスの使用を選択 ![](master-detail-filtering-with-two-dropdownlists-vb/_static/image44.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image43.png)</span><span class="sxs-lookup"><span data-stu-id="fa1b0-178">[![Choose to Use the ProductsBLL Class](master-detail-filtering-with-two-dropdownlists-vb/_static/image44.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image43.png)</span></span>

<span data-ttu-id="fa1b0-179">**図 15**: `ProductsBLL` クラスの使用を選択する ([クリックしてフルサイズのイメージを表示する](master-detail-filtering-with-two-dropdownlists-vb/_static/image45.png))</span><span class="sxs-lookup"><span data-stu-id="fa1b0-179">**Figure 15**: Choose to Use the `ProductsBLL` Class ([Click to view full-size image](master-detail-filtering-with-two-dropdownlists-vb/_static/image45.png))</span></span>

<span data-ttu-id="fa1b0-180">[GetProductByProductID (productID) メソッドを使用するように ObjectDataSource を構成 ![には](master-detail-filtering-with-two-dropdownlists-vb/_static/image47.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image46.png)</span><span class="sxs-lookup"><span data-stu-id="fa1b0-180">[![Configure the ObjectDataSource to Use the GetProductByProductID(productID) Method](master-detail-filtering-with-two-dropdownlists-vb/_static/image47.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image46.png)</span></span>

<span data-ttu-id="fa1b0-181">**図 16**: `GetProductByProductID(productID)` メソッドを使用するように ObjectDataSource を構成する ([クリックしてフルサイズのイメージを表示する](master-detail-filtering-with-two-dropdownlists-vb/_static/image48.png))</span><span class="sxs-lookup"><span data-stu-id="fa1b0-181">**Figure 16**: Configure the ObjectDataSource to Use the `GetProductByProductID(productID)` Method ([Click to view full-size image](master-detail-filtering-with-two-dropdownlists-vb/_static/image48.png))</span></span>

<span data-ttu-id="fa1b0-182">[製品 Bycategory の DropDownList から productID パラメーター値をプル ![には](master-detail-filtering-with-two-dropdownlists-vb/_static/image50.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image49.png)</span><span class="sxs-lookup"><span data-stu-id="fa1b0-182">[![Pull the productID Parameter Value from the ProductsByCategory DropDownList](master-detail-filtering-with-two-dropdownlists-vb/_static/image50.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image49.png)</span></span>

<span data-ttu-id="fa1b0-183">**図 17**: `ProductsByCategory` DropDownList から *`productID`* パラメーター値を取得する ([クリックすると、フルサイズの画像が表示](master-detail-filtering-with-two-dropdownlists-vb/_static/image51.png)されます)</span><span class="sxs-lookup"><span data-stu-id="fa1b0-183">**Figure 17**: Pull the *`productID`* Parameter Value from the `ProductsByCategory` DropDownList ([Click to view full-size image](master-detail-filtering-with-two-dropdownlists-vb/_static/image51.png))</span></span>

<span data-ttu-id="fa1b0-184">`ProductDetails` DetailsView で使用可能なフィールドを表示するように選択できます。</span><span class="sxs-lookup"><span data-stu-id="fa1b0-184">You can choose to display any of the available fields in the `ProductDetails` DetailsView.</span></span> <span data-ttu-id="fa1b0-185">`ProductID`、`SupplierID`、および `CategoryID` フィールドを削除し、残りのフィールドの並べ替えと書式設定を行いました。</span><span class="sxs-lookup"><span data-stu-id="fa1b0-185">I've opted to remove the `ProductID`, `SupplierID`, and `CategoryID` fields and reordered and formatted the remaining fields.</span></span> <span data-ttu-id="fa1b0-186">さらに、DetailsView の `Height` と `Width` プロパティをクリアし、指定されたサイズに制限されるのではなく、データを最適に表示するために必要な幅まで DetailsView を拡張できるようにしました。</span><span class="sxs-lookup"><span data-stu-id="fa1b0-186">In addition, I cleared out the DetailsView's `Height` and `Width` properties, allowing the DetailsView to expand to the width needed to best display its data rather than having it constrained to a specified size.</span></span> <span data-ttu-id="fa1b0-187">完全なマークアップが以下に表示されます。</span><span class="sxs-lookup"><span data-stu-id="fa1b0-187">The full markup appears below:</span></span>

[!code-aspx[Main](master-detail-filtering-with-two-dropdownlists-vb/samples/sample1.aspx)]

<span data-ttu-id="fa1b0-188">ブラウザーで `MasterDetailsDetails.aspx` のページを試してみましょう。</span><span class="sxs-lookup"><span data-stu-id="fa1b0-188">Take a moment to try out the `MasterDetailsDetails.aspx` page in a browser.</span></span> <span data-ttu-id="fa1b0-189">一見すると、すべてが必要に応じて動作しているように見えるかもしれませんが、微妙な問題があります。</span><span class="sxs-lookup"><span data-stu-id="fa1b0-189">At first glance it may appear that everything is working as desired, but there's a subtle problem.</span></span> <span data-ttu-id="fa1b0-190">新しいカテゴリを選択すると `ProductsByCategory` DropDownList は選択されたカテゴリの製品を含むように更新されますが、`ProductDetails` DetailsView は以前の製品情報を表示し続けます。</span><span class="sxs-lookup"><span data-stu-id="fa1b0-190">When you choose a new category the `ProductsByCategory` DropDownList is updated to include those products for the selected category, but the `ProductDetails` DetailsView continued to show the previous product information.</span></span> <span data-ttu-id="fa1b0-191">選択したカテゴリに対して別の製品を選択すると、DetailsView が更新されます。</span><span class="sxs-lookup"><span data-stu-id="fa1b0-191">The DetailsView is updated when choosing a different product for the selected category.</span></span> <span data-ttu-id="fa1b0-192">さらに、十分にテストした場合は、新しいカテゴリ (`Categories` DropDownList からの飲み物の選択、Condiments、Confections など) を選択すると、他のすべてのカテゴリの選択によって `ProductDetails` の DetailsView が更新されることがわかります。</span><span class="sxs-lookup"><span data-stu-id="fa1b0-192">Furthermore, if you test thoroughly enough, you'll find that if you continually choose new categories (such as choosing Beverages from the `Categories` DropDownList, then Condiments, then Confections) every other category selection causes the `ProductDetails` DetailsView to be refreshed.</span></span>

<span data-ttu-id="fa1b0-193">この問題をを具体化ために、特定の例を見てみましょう。</span><span class="sxs-lookup"><span data-stu-id="fa1b0-193">To help concretize this problem, let's look at a specific example.</span></span> <span data-ttu-id="fa1b0-194">ページに初めてアクセスすると、飲み物カテゴリが選択され、関連する製品が `ProductsByCategory` DropDownList に読み込まれます。</span><span class="sxs-lookup"><span data-stu-id="fa1b0-194">When you first visit the page the Beverages category is selected and the related products are loaded in the `ProductsByCategory` DropDownList.</span></span> <span data-ttu-id="fa1b0-195">Chai は選択された製品で、図18に示すように、`ProductDetails` の DetailsView にその詳細が表示されます。</span><span class="sxs-lookup"><span data-stu-id="fa1b0-195">Chai is the selected product and its details are displayed in the `ProductDetails` DetailsView, as shown in Figure 18.</span></span>

<span data-ttu-id="fa1b0-196">[選択した製品の詳細が DetailsView に表示される ![](master-detail-filtering-with-two-dropdownlists-vb/_static/image53.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image52.png)</span><span class="sxs-lookup"><span data-stu-id="fa1b0-196">[![The Selected Product's Details are Displayed in a DetailsView](master-detail-filtering-with-two-dropdownlists-vb/_static/image53.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image52.png)</span></span>

<span data-ttu-id="fa1b0-197">**図 18**: 選択した製品の詳細が DetailsView に表示される ([クリックすると、フルサイズの画像が表示](master-detail-filtering-with-two-dropdownlists-vb/_static/image54.png)されます)</span><span class="sxs-lookup"><span data-stu-id="fa1b0-197">**Figure 18**: The Selected Product's Details are Displayed in a DetailsView ([Click to view full-size image](master-detail-filtering-with-two-dropdownlists-vb/_static/image54.png))</span></span>

<span data-ttu-id="fa1b0-198">カテゴリの選択を飲み物から Condiments に変更すると、ポストバックが発生し、それに応じて `ProductsByCategory` DropDownList が更新されますが、DetailsView には、Chai の詳細が表示されます。</span><span class="sxs-lookup"><span data-stu-id="fa1b0-198">If you change the category selection from Beverages to Condiments, a postback occurs and the `ProductsByCategory` DropDownList is updated accordingly, but the DetailsView still displays details for Chai.</span></span>

<span data-ttu-id="fa1b0-199">[以前に選択した製品の詳細が表示され ![](master-detail-filtering-with-two-dropdownlists-vb/_static/image56.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image55.png)</span><span class="sxs-lookup"><span data-stu-id="fa1b0-199">[![The Previously Selected Product's Details are Still Displayed](master-detail-filtering-with-two-dropdownlists-vb/_static/image56.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image55.png)</span></span>

<span data-ttu-id="fa1b0-200">**図 19**: 以前に選択された製品の詳細が表示される ([クリックすると、フルサイズの画像が表示](master-detail-filtering-with-two-dropdownlists-vb/_static/image57.png)されます)</span><span class="sxs-lookup"><span data-stu-id="fa1b0-200">**Figure 19**: The Previously Selected Product's Details are Still Displayed ([Click to view full-size image](master-detail-filtering-with-two-dropdownlists-vb/_static/image57.png))</span></span>

<span data-ttu-id="fa1b0-201">一覧から新しい製品を選択すると、必要に応じて DetailsView が更新されます。</span><span class="sxs-lookup"><span data-stu-id="fa1b0-201">Picking a new product from the list refreshes the DetailsView as expected.</span></span> <span data-ttu-id="fa1b0-202">製品を変更した後で新しいカテゴリを選択しても、DetailsView は再更新されません。</span><span class="sxs-lookup"><span data-stu-id="fa1b0-202">If you pick a new category after changing the product, the DetailsView again won't refresh.</span></span> <span data-ttu-id="fa1b0-203">ただし、新しいカテゴリを選択して新しい製品を選択するのではなく、DetailsView が更新されます。</span><span class="sxs-lookup"><span data-stu-id="fa1b0-203">However, if instead of choosing a new product you selected a new category, the DetailsView would refresh.</span></span> <span data-ttu-id="fa1b0-204">ここでは、世界中で何が起こっているのでしょうか。</span><span class="sxs-lookup"><span data-stu-id="fa1b0-204">What in the world is going on here?</span></span>

<span data-ttu-id="fa1b0-205">問題は、ページのライフサイクルのタイミングの問題です。</span><span class="sxs-lookup"><span data-stu-id="fa1b0-205">The problem is a timing issue in the page's lifecycle.</span></span> <span data-ttu-id="fa1b0-206">ページが要求されるたびに、レンダリングとしていくつかの手順を実行します。</span><span class="sxs-lookup"><span data-stu-id="fa1b0-206">Whenever a page is requested it proceeds through a number of steps as its rendering.</span></span> <span data-ttu-id="fa1b0-207">これらの手順のいずれかで、ObjectDataSource コントロールは `SelectParameters` 値が変更されているかどうかを確認します。</span><span class="sxs-lookup"><span data-stu-id="fa1b0-207">In one of these steps the ObjectDataSource controls check to see if any of their `SelectParameters` values have changed.</span></span> <span data-ttu-id="fa1b0-208">その場合、ObjectDataSource にバインドされているデータ Web コントロールは、表示を更新する必要があることを認識しています。</span><span class="sxs-lookup"><span data-stu-id="fa1b0-208">If so, the data Web control bound to the ObjectDataSource knows that it needs to refresh its display.</span></span> <span data-ttu-id="fa1b0-209">たとえば、新しいカテゴリが選択されている場合、`ProductsByCategoryDataSource` ObjectDataSource はそのパラメーター値が変更されたことを検出し、`ProductsByCategory` DropDownList がそれ自体を再バインドして、選択されたカテゴリの製品を取得します。</span><span class="sxs-lookup"><span data-stu-id="fa1b0-209">For example, when a new category is selected, the `ProductsByCategoryDataSource` ObjectDataSource detects that its parameter values have changed and the `ProductsByCategory` DropDownList rebinds itself, getting the products for the selected category.</span></span>

<span data-ttu-id="fa1b0-210">この状況で発生する問題は、変更されたパラメーターの ObjectDataSources ソースチェックが、関連付けられたデータ Web コントロールの再バインドの*前に*発生することを示す、ページのライフサイクルのポイントです。</span><span class="sxs-lookup"><span data-stu-id="fa1b0-210">The problem that arises in this situation is that the point in the page lifecycle that the ObjectDataSources check for changed parameters occurs *before* the rebinding of the associated data Web controls.</span></span> <span data-ttu-id="fa1b0-211">したがって、新しいカテゴリを選択すると `ProductsByCategoryDataSource` ObjectDataSource によって、パラメーターの値の変更が検出されます。</span><span class="sxs-lookup"><span data-stu-id="fa1b0-211">Therefore, when selecting a new category the `ProductsByCategoryDataSource` ObjectDataSource detects a change in its parameter's value.</span></span> <span data-ttu-id="fa1b0-212">ただし、`ProductDetails` DetailsView で使用される ObjectDataSource は、`ProductsByCategory` DropDownList がまだ再バインドされていないため、このような変更はメモしていません。</span><span class="sxs-lookup"><span data-stu-id="fa1b0-212">The ObjectDataSource used by the `ProductDetails` DetailsView, however, doesn't note any such changes because the `ProductsByCategory` DropDownList has yet to be rebound.</span></span> <span data-ttu-id="fa1b0-213">その後、ライフサイクルの `ProductsByCategory` DropDownList を ObjectDataSource に再バインドし、新しく選択したカテゴリの製品を取得します。</span><span class="sxs-lookup"><span data-stu-id="fa1b0-213">Later in the lifecycle the `ProductsByCategory` DropDownList rebinds to its ObjectDataSource, grabbing the products for the newly selected category.</span></span> <span data-ttu-id="fa1b0-214">`ProductsByCategory` DropDownList の値が変更されましたが、`ProductDetails` DetailsView の ObjectDataSource のパラメーター値のチェックが既に完了しています。そのため、DetailsView は前の結果を表示します。</span><span class="sxs-lookup"><span data-stu-id="fa1b0-214">While the `ProductsByCategory` DropDownList's value has changed, the `ProductDetails` DetailsView's ObjectDataSource has already done its parameter value check; therefore, the DetailsView displays its previous results.</span></span> <span data-ttu-id="fa1b0-215">この相互作用は、図20に示されています。</span><span class="sxs-lookup"><span data-stu-id="fa1b0-215">This interaction is depicted in Figure 20.</span></span>

<span data-ttu-id="fa1b0-216">[ProductDetails DetailsView の ObjectDataSource が変更されたかどうかを確認した後に、Productbycategory の DropDownList 値の変更を ![します](master-detail-filtering-with-two-dropdownlists-vb/_static/image59.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image58.png)</span><span class="sxs-lookup"><span data-stu-id="fa1b0-216">[![The ProductsByCategory DropDownList Value Changes After the ProductDetails DetailsView's ObjectDataSource Checks for Changes](master-detail-filtering-with-two-dropdownlists-vb/_static/image59.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image58.png)</span></span>

<span data-ttu-id="fa1b0-217">**図 20**: `ProductDetails` DetailsView の ObjectDataSource の ObjectDataSource によって変更がチェックされた後の `ProductsByCategory` DropDownList 値の変更 ([クリックすると、フルサイズの画像が表示](master-detail-filtering-with-two-dropdownlists-vb/_static/image60.png)されます)</span><span class="sxs-lookup"><span data-stu-id="fa1b0-217">**Figure 20**: The `ProductsByCategory` DropDownList Value Changes After the `ProductDetails` DetailsView's ObjectDataSource Checks for Changes ([Click to view full-size image](master-detail-filtering-with-two-dropdownlists-vb/_static/image60.png))</span></span>

<span data-ttu-id="fa1b0-218">これを解決するには、`ProductsByCategory` DropDownList がバインドされた後に `ProductDetails` DetailsView を明示的に再バインドする必要があります。</span><span class="sxs-lookup"><span data-stu-id="fa1b0-218">To remedy this we need to explicitly rebind the `ProductDetails` DetailsView after the `ProductsByCategory` DropDownList has been bound.</span></span> <span data-ttu-id="fa1b0-219">これは、`ProductsByCategory` DropDownList の `DataBound` イベントが発生したときに `ProductDetails` DetailsView の `DataBind()` メソッドを呼び出すことによって実現できます。</span><span class="sxs-lookup"><span data-stu-id="fa1b0-219">We can accomplish this by calling the `ProductDetails` DetailsView's `DataBind()` method when the `ProductsByCategory` DropDownList's `DataBound` event fires.</span></span> <span data-ttu-id="fa1b0-220">次のイベントハンドラーコードを `MasterDetailsDetails.aspx` ページの分離コードクラスに追加します (イベントハンドラーを追加する方法の詳細については、「[ObjectDataSource のパラメーター値をプログラムで設定](../basic-reporting/programmatically-setting-the-objectdatasource-s-parameter-values-cs.md)する」を参照してください)。</span><span class="sxs-lookup"><span data-stu-id="fa1b0-220">Add the following event handler code to the `MasterDetailsDetails.aspx` page's code-behind class (refer to the "[Programmatically Setting the ObjectDataSource's Parameter Values](../basic-reporting/programmatically-setting-the-objectdatasource-s-parameter-values-cs.md)" for a discussion on how to add an event handler):</span></span>

[!code-vb[Main](master-detail-filtering-with-two-dropdownlists-vb/samples/sample2.vb)]

<span data-ttu-id="fa1b0-221">`ProductDetails` DetailsView の `DataBind()` メソッドのこの明示的な呼び出しが追加されると、このチュートリアルは想定どおりに動作します。</span><span class="sxs-lookup"><span data-stu-id="fa1b0-221">After this explicit call to the `ProductDetails` DetailsView's `DataBind()` method has been added, the tutorial works as expected.</span></span> <span data-ttu-id="fa1b0-222">図21は、この変更が以前の問題を解決した方法を示しています。</span><span class="sxs-lookup"><span data-stu-id="fa1b0-222">Figure 21 highlights how this changed remedied our earlier problem.</span></span>

<span data-ttu-id="fa1b0-223">[Productbycategory の DropDownList のデータバインドイベントが発生したときに、ProductDetails の DetailsView が明示的に更新さ ![](master-detail-filtering-with-two-dropdownlists-vb/_static/image62.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image61.png)</span><span class="sxs-lookup"><span data-stu-id="fa1b0-223">[![The ProductDetails DetailsView is Explicitly Refreshed When the ProductsByCategory DropDownList's DataBound Event Fires](master-detail-filtering-with-two-dropdownlists-vb/_static/image62.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image61.png)</span></span>

<span data-ttu-id="fa1b0-224">**図 21**: `ProductsByCategory` DropDownList の `DataBound` イベントが発生したときに `ProductDetails` DetailsView が明示的に更新される ([クリックしてフルサイズの画像を表示する](master-detail-filtering-with-two-dropdownlists-vb/_static/image63.png))</span><span class="sxs-lookup"><span data-stu-id="fa1b0-224">**Figure 21**: The `ProductDetails` DetailsView is Explicitly Refreshed When the `ProductsByCategory` DropDownList's `DataBound` Event Fires ([Click to view full-size image](master-detail-filtering-with-two-dropdownlists-vb/_static/image63.png))</span></span>

## <a name="summary"></a><span data-ttu-id="fa1b0-225">要約</span><span class="sxs-lookup"><span data-stu-id="fa1b0-225">Summary</span></span>

<span data-ttu-id="fa1b0-226">DropDownList はマスター/詳細レポートの理想的なユーザーインターフェイス要素として機能し、マスターレコードと詳細レコードの間に一対多のリレーションシップが存在します。</span><span class="sxs-lookup"><span data-stu-id="fa1b0-226">The DropDownList serves as an ideal user interface element for master/detail reports where there is a one-to-many relationship between the master and detail records.</span></span> <span data-ttu-id="fa1b0-227">前のチュートリアルでは、1つの DropDownList を使用して、選択したカテゴリによって表示される製品をフィルター処理する方法を説明しました。</span><span class="sxs-lookup"><span data-stu-id="fa1b0-227">In the preceding tutorial we saw how to use a single DropDownList to filter the products displayed by the selected category.</span></span> <span data-ttu-id="fa1b0-228">このチュートリアルでは、製品の GridView を DropDownList に置き換え、DetailsView を使用して選択した製品の詳細を表示しました。</span><span class="sxs-lookup"><span data-stu-id="fa1b0-228">In this tutorial we replaced the GridView of products with a DropDownList, and used a DetailsView to display the details of the selected product.</span></span> <span data-ttu-id="fa1b0-229">このチュートリアルで説明する概念は、顧客、注文、注文品目など、複数の一対多リレーションシップを含むデータモデルに簡単に拡張できます。</span><span class="sxs-lookup"><span data-stu-id="fa1b0-229">The concepts discussed in this tutorial can easily be extended to data models involving multiple one-to-many relationships, such as customers, orders, and order items.</span></span> <span data-ttu-id="fa1b0-230">一般に、一対多のリレーションシップでは、"one" エンティティごとに DropDownList をいつでも追加できます。</span><span class="sxs-lookup"><span data-stu-id="fa1b0-230">In general, you can always add a DropDownList for each of the "one" entities in the one-to-many relationships.</span></span>

<span data-ttu-id="fa1b0-231">プログラミングを楽しんでください。</span><span class="sxs-lookup"><span data-stu-id="fa1b0-231">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="fa1b0-232">作成者について</span><span class="sxs-lookup"><span data-stu-id="fa1b0-232">About the Author</span></span>

<span data-ttu-id="fa1b0-233">1998以来、 [Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml)は 7 asp/創設者 of [4GuysFromRolla.com](http://www.4guysfromrolla.com)の執筆者であり、Microsoft Web テクノロジを使用しています。</span><span class="sxs-lookup"><span data-stu-id="fa1b0-233">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="fa1b0-234">Scott は、独立したコンサルタント、トレーナー、およびライターとして機能します。</span><span class="sxs-lookup"><span data-stu-id="fa1b0-234">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="fa1b0-235">彼の最新の書籍は[ *、ASP.NET 2.0 を24時間以内に教え*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)ています。</span><span class="sxs-lookup"><span data-stu-id="fa1b0-235">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="fa1b0-236">mitchell@4GuysFromRolla.comでアクセスでき[ます。](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="fa1b0-236">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="fa1b0-237">または彼のブログを参照してください。これは[http://ScottOnWriting.NET](http://ScottOnWriting.NET)にあります。</span><span class="sxs-lookup"><span data-stu-id="fa1b0-237">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="fa1b0-238">ありがとうございました。</span><span class="sxs-lookup"><span data-stu-id="fa1b0-238">Special Thanks To</span></span>

<span data-ttu-id="fa1b0-239">このチュートリアルシリーズは、役に立つ多くのレビュー担当者によってレビューされました。</span><span class="sxs-lookup"><span data-stu-id="fa1b0-239">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="fa1b0-240">このチュートリアルのリードレビュー担当者は、Hilton Giesenow でした。</span><span class="sxs-lookup"><span data-stu-id="fa1b0-240">Lead reviewer for this tutorial was Hilton Giesenow.</span></span> <span data-ttu-id="fa1b0-241">今後の MSDN 記事を確認することに興味がありますか?</span><span class="sxs-lookup"><span data-stu-id="fa1b0-241">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="fa1b0-242">その場合は、mitchell@4GuysFromRolla.comの行を削除[します。](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="fa1b0-242">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="fa1b0-243">[前へ](master-detail-filtering-with-a-dropdownlist-vb.md)
> [次へ](master-detail-filtering-across-two-pages-vb.md)</span><span class="sxs-lookup"><span data-stu-id="fa1b0-243">[Previous](master-detail-filtering-with-a-dropdownlist-vb.md)
[Next](master-detail-filtering-across-two-pages-vb.md)</span></span>

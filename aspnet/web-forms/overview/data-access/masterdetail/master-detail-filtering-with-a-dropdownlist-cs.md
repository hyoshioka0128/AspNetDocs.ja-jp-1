---
uid: web-forms/overview/data-access/masterdetail/master-detail-filtering-with-a-dropdownlist-cs
title: DropDownList (C#) を使用したマスター/詳細のフィルター処理Microsoft Docs
author: rick-anderson
description: このチュートリアルでは、DropDownList コントロールのマスターレコードと、GridView で選択したリスト項目の詳細を表示する方法について説明します。
ms.author: riande
ms.date: 03/31/2010
ms.assetid: 53e659cc-eefb-40c1-a1dc-559481c99443
msc.legacyurl: /web-forms/overview/data-access/masterdetail/master-detail-filtering-with-a-dropdownlist-cs
msc.type: authoredcontent
ms.openlocfilehash: 3ec549f9da7a2b3a021e77827f0039e6ae60b5c5
ms.sourcegitcommit: 22fbd8863672c4ad6693b8388ad5c8e753fb41a2
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 11/28/2019
ms.locfileid: "74616069"
---
# <a name="masterdetail-filtering-with-a-dropdownlist-c"></a><span data-ttu-id="baf54-103">DropDownList でマスター/詳細をフィルター処理する (C#)</span><span class="sxs-lookup"><span data-stu-id="baf54-103">Master/Detail Filtering With a DropDownList (C#)</span></span>

<span data-ttu-id="baf54-104">[Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="baf54-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="baf54-105">[サンプルアプリのダウンロード](https://download.microsoft.com/download/4/6/3/463cf87c-4724-4cbc-b7b5-3f866f43ba50/ASPNET_Data_Tutorial_7_CS.exe)または[PDF のダウンロード](master-detail-filtering-with-a-dropdownlist-cs/_static/datatutorial07cs1.pdf)</span><span class="sxs-lookup"><span data-stu-id="baf54-105">[Download Sample App](https://download.microsoft.com/download/4/6/3/463cf87c-4724-4cbc-b7b5-3f866f43ba50/ASPNET_Data_Tutorial_7_CS.exe) or [Download PDF](master-detail-filtering-with-a-dropdownlist-cs/_static/datatutorial07cs1.pdf)</span></span>

> <span data-ttu-id="baf54-106">このチュートリアルでは、DropDownList コントロールのマスターレコードと、GridView で選択したリスト項目の詳細を表示する方法について説明します。</span><span class="sxs-lookup"><span data-stu-id="baf54-106">In this tutorial we'll see how to display the master records in a DropDownList control and the details of the selected list item in a GridView.</span></span>

## <a name="introduction"></a><span data-ttu-id="baf54-107">はじめに</span><span class="sxs-lookup"><span data-stu-id="baf54-107">Introduction</span></span>

<span data-ttu-id="baf54-108">一般的なレポートの種類として、*マスター/詳細レポート*があります。このレポートでは、"マスター" レコードのセットが表示されます。</span><span class="sxs-lookup"><span data-stu-id="baf54-108">A common type of report is the *master/detail report*, in which the report begins by showing some set of "master" records.</span></span> <span data-ttu-id="baf54-109">その後、ユーザーはマスターレコードのいずれかにドリルダウンして、マスターレコードの "詳細" を表示できます。</span><span class="sxs-lookup"><span data-stu-id="baf54-109">The user can then drill down into one of the master records, thereby viewing that master record's "details."</span></span> <span data-ttu-id="baf54-110">マスター/詳細レポートは、すべてのカテゴリを表示し、ユーザーが特定のカテゴリを選択し、関連付けられている製品を表示できるようにするレポートなど、1対多のリレーションシップを視覚化するために最適な選択肢です。</span><span class="sxs-lookup"><span data-stu-id="baf54-110">Master/detail reports are an ideal choice for visualizing one-to-many relationships, such as a report showing all of the categories and then allowing a user to select a particular category and display its associated products.</span></span> <span data-ttu-id="baf54-111">さらに、マスター/詳細レポートは、特に多くの列を持つテーブルから詳細情報を表示する場合に便利です。</span><span class="sxs-lookup"><span data-stu-id="baf54-111">Additionally, master/detail reports are useful for displaying detailed information from particularly "wide" tables (ones that have a lot of columns).</span></span> <span data-ttu-id="baf54-112">たとえば、マスター/詳細レポートの "マスター" レベルでは、製品名とデータベース内の製品の単価だけが表示され、特定の製品をドリルダウンすると、追加の製品フィールド (カテゴリ、仕入先、単位あたりの数量など) が表示されます。</span><span class="sxs-lookup"><span data-stu-id="baf54-112">For example, the "master" level of a master/detail report might show just the product name and unit price of the products in the database, and drilling down into a particular product would show the additional product fields (category, supplier, quantity per unit, and so on).</span></span>

<span data-ttu-id="baf54-113">マスター/詳細レポートを実装するには、さまざまな方法があります。</span><span class="sxs-lookup"><span data-stu-id="baf54-113">There are many ways with which a master/detail report can be implemented.</span></span> <span data-ttu-id="baf54-114">このチュートリアルと次の3つのチュートリアルでは、さまざまなマスター/詳細レポートについて説明します。</span><span class="sxs-lookup"><span data-stu-id="baf54-114">Over this and the next three tutorials we'll look at a variety of master/detail reports.</span></span> <span data-ttu-id="baf54-115">このチュートリアルでは、 [DropDownList コントロール](https://msdn.microsoft.com/library/dtx91y0z.aspx)のマスターレコードと、GridView で選択したリスト項目の詳細を表示する方法について説明します。</span><span class="sxs-lookup"><span data-stu-id="baf54-115">In this tutorial we'll see how to display the master records in a [DropDownList control](https://msdn.microsoft.com/library/dtx91y0z.aspx) and the details of the selected list item in a GridView.</span></span> <span data-ttu-id="baf54-116">特に、このチュートリアルのマスター/詳細レポートには、カテゴリと製品情報が一覧表示されます。</span><span class="sxs-lookup"><span data-stu-id="baf54-116">In particular, this tutorial's master/detail report will list category and product information.</span></span>

## <a name="step-1-displaying-the-categories-in-a-dropdownlist"></a><span data-ttu-id="baf54-117">手順 1: DropDownList でカテゴリを表示する</span><span class="sxs-lookup"><span data-stu-id="baf54-117">Step 1: Displaying the Categories in a DropDownList</span></span>

<span data-ttu-id="baf54-118">マスター/詳細レポートには、選択したリストアイテムの製品が GridView のページに表示されるように、DropDownList にカテゴリが一覧表示されます。</span><span class="sxs-lookup"><span data-stu-id="baf54-118">Our master/detail report will list the categories in a DropDownList, with the selected list item's products displayed further down in the page in a GridView.</span></span> <span data-ttu-id="baf54-119">最初のタスクであるのは、カテゴリを DropDownList に表示することです。</span><span class="sxs-lookup"><span data-stu-id="baf54-119">The first task ahead of us, then, is to have the categories displayed in a DropDownList.</span></span> <span data-ttu-id="baf54-120">`Filtering` フォルダーの [`FilterByDropDownList.aspx`] ページを開き、[ツールボックス] の DropDownList をページデザイナーにドラッグして、その `ID` プロパティを [`Categories`] に設定します。</span><span class="sxs-lookup"><span data-stu-id="baf54-120">Open the `FilterByDropDownList.aspx` page in the `Filtering` folder, drag on a DropDownList from the Toolbox onto the page's designer, and set its `ID` property to `Categories`.</span></span> <span data-ttu-id="baf54-121">次に、DropDownList のスマートタグから [データソースの選択] リンクをクリックします。</span><span class="sxs-lookup"><span data-stu-id="baf54-121">Next, click on the Choose Data Source link from the DropDownList's smart tag.</span></span> <span data-ttu-id="baf54-122">データソース構成ウィザードが表示されます。</span><span class="sxs-lookup"><span data-stu-id="baf54-122">This will display the Data Source Configuration wizard.</span></span>

<span data-ttu-id="baf54-123">[DropDownList のデータソースを指定 ![には](master-detail-filtering-with-a-dropdownlist-cs/_static/image2.png)](master-detail-filtering-with-a-dropdownlist-cs/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="baf54-123">[![Specify the DropDownList's Data Source](master-detail-filtering-with-a-dropdownlist-cs/_static/image2.png)](master-detail-filtering-with-a-dropdownlist-cs/_static/image1.png)</span></span>

<span data-ttu-id="baf54-124">**図 1**: DropDownList のデータソースを指定[する (クリックすると、フルサイズの画像が表示](master-detail-filtering-with-a-dropdownlist-cs/_static/image3.png)されます)</span><span class="sxs-lookup"><span data-stu-id="baf54-124">**Figure 1**: Specify the DropDownList's Data Source ([Click to view full-size image](master-detail-filtering-with-a-dropdownlist-cs/_static/image3.png))</span></span>

<span data-ttu-id="baf54-125">`CategoriesBLL` クラスの `GetCategories()` メソッドを呼び出す `CategoriesDataSource` という名前の新しい ObjectDataSource を追加します。</span><span class="sxs-lookup"><span data-stu-id="baf54-125">Choose to add a new ObjectDataSource named `CategoriesDataSource` that invokes the `CategoriesBLL` class's `GetCategories()` method.</span></span>

<span data-ttu-id="baf54-126">[新しい ObjectDataSource という名前の新しい名前のデータソースを追加 ![には](master-detail-filtering-with-a-dropdownlist-cs/_static/image5.png)](master-detail-filtering-with-a-dropdownlist-cs/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="baf54-126">[![Add a New ObjectDataSource Named CategoriesDataSource](master-detail-filtering-with-a-dropdownlist-cs/_static/image5.png)](master-detail-filtering-with-a-dropdownlist-cs/_static/image4.png)</span></span>

<span data-ttu-id="baf54-127">**図 2**: `CategoriesDataSource` という名前の新しい ObjectDataSource を追加[する (クリックすると、フルサイズの画像が表示](master-detail-filtering-with-a-dropdownlist-cs/_static/image6.png)される)</span><span class="sxs-lookup"><span data-stu-id="baf54-127">**Figure 2**: Add a New ObjectDataSource Named `CategoriesDataSource` ([Click to view full-size image](master-detail-filtering-with-a-dropdownlist-cs/_static/image6.png))</span></span>

<span data-ttu-id="baf54-128">[カテゴリ Bll クラスの使用を選択 ![](master-detail-filtering-with-a-dropdownlist-cs/_static/image8.png)](master-detail-filtering-with-a-dropdownlist-cs/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="baf54-128">[![Choose to Use the CategoriesBLL Class](master-detail-filtering-with-a-dropdownlist-cs/_static/image8.png)](master-detail-filtering-with-a-dropdownlist-cs/_static/image7.png)</span></span>

<span data-ttu-id="baf54-129">**図 3**: `CategoriesBLL` クラスの使用を選択する ([クリックすると、フルサイズの画像が表示](master-detail-filtering-with-a-dropdownlist-cs/_static/image9.png)されます)</span><span class="sxs-lookup"><span data-stu-id="baf54-129">**Figure 3**: Choose to Use the `CategoriesBLL` Class ([Click to view full-size image](master-detail-filtering-with-a-dropdownlist-cs/_static/image9.png))</span></span>

<span data-ttu-id="baf54-130">[GetCategories () メソッドを使用するように ObjectDataSource を構成 ![には](master-detail-filtering-with-a-dropdownlist-cs/_static/image11.png)](master-detail-filtering-with-a-dropdownlist-cs/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="baf54-130">[![Configure the ObjectDataSource to Use the GetCategories() Method](master-detail-filtering-with-a-dropdownlist-cs/_static/image11.png)](master-detail-filtering-with-a-dropdownlist-cs/_static/image10.png)</span></span>

<span data-ttu-id="baf54-131">**図 4**: `GetCategories()` メソッドを使用するように ObjectDataSource を構成する ([クリックしてフルサイズのイメージを表示する](master-detail-filtering-with-a-dropdownlist-cs/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="baf54-131">**Figure 4**: Configure the ObjectDataSource to Use the `GetCategories()` Method ([Click to view full-size image](master-detail-filtering-with-a-dropdownlist-cs/_static/image12.png))</span></span>

<span data-ttu-id="baf54-132">ObjectDataSource を構成した後も、DropDownList に表示するデータソースフィールドと、リストアイテムの値として関連付ける必要があるデータソースフィールドを指定する必要があります。</span><span class="sxs-lookup"><span data-stu-id="baf54-132">After configuring the ObjectDataSource we still need to specify what data source field should be displayed in DropDownList and which one should be associated as the value for the list item.</span></span> <span data-ttu-id="baf54-133">`CategoryName` フィールドを表示として使用し、各リスト項目の値として `CategoryID` します。</span><span class="sxs-lookup"><span data-stu-id="baf54-133">Have the `CategoryName` field as the display and `CategoryID` as the value for each list item.</span></span>

<span data-ttu-id="baf54-134">[DropDownList で [区分項目] フィールドを表示し、値として CategoryID を使用する ![ます。](master-detail-filtering-with-a-dropdownlist-cs/_static/image14.png)](master-detail-filtering-with-a-dropdownlist-cs/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="baf54-134">[![Have the DropDownList Display the CategoryName Field and Use CategoryID as the Value](master-detail-filtering-with-a-dropdownlist-cs/_static/image14.png)](master-detail-filtering-with-a-dropdownlist-cs/_static/image13.png)</span></span>

<span data-ttu-id="baf54-135">**図 5**: DropDownList に `CategoryName` フィールドが表示され、`CategoryID` を値として使用する ([クリックしてフルサイズの画像を表示する](master-detail-filtering-with-a-dropdownlist-cs/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="baf54-135">**Figure 5**: Have the DropDownList Display the `CategoryName` Field and Use `CategoryID` as the Value ([Click to view full-size image](master-detail-filtering-with-a-dropdownlist-cs/_static/image15.png))</span></span>

<span data-ttu-id="baf54-136">この時点で、`Categories` テーブルのレコードが設定された DropDownList コントロールがあります (すべての操作は約6秒で完了しました)。</span><span class="sxs-lookup"><span data-stu-id="baf54-136">At this point we have a DropDownList control that's populated with the records from the `Categories` table (all accomplished in about six seconds).</span></span> <span data-ttu-id="baf54-137">図6は、ブラウザーを通じて表示されたときの進行状況を示しています。</span><span class="sxs-lookup"><span data-stu-id="baf54-137">Figure 6 shows our progress thus far when viewed through a browser.</span></span>

<span data-ttu-id="baf54-138">[ドロップダウンリスト ![現在のカテゴリを一覧表示します。](master-detail-filtering-with-a-dropdownlist-cs/_static/image17.png)](master-detail-filtering-with-a-dropdownlist-cs/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="baf54-138">[![A Drop-Down Lists the Current Categories](master-detail-filtering-with-a-dropdownlist-cs/_static/image17.png)](master-detail-filtering-with-a-dropdownlist-cs/_static/image16.png)</span></span>

<span data-ttu-id="baf54-139">**図 6**: ドロップダウンリストに現在のカテゴリが表示される ([クリックすると、フルサイズの画像が表示](master-detail-filtering-with-a-dropdownlist-cs/_static/image18.png)されます)</span><span class="sxs-lookup"><span data-stu-id="baf54-139">**Figure 6**: A Drop-Down Lists the Current Categories ([Click to view full-size image](master-detail-filtering-with-a-dropdownlist-cs/_static/image18.png))</span></span>

## <a name="step-2-adding-the-products-gridview"></a><span data-ttu-id="baf54-140">手順 2: 製品の GridView を追加する</span><span class="sxs-lookup"><span data-stu-id="baf54-140">Step 2: Adding the Products GridView</span></span>

<span data-ttu-id="baf54-141">マスター/詳細レポートの最後の手順は、選択したカテゴリに関連付けられている製品を一覧表示することです。</span><span class="sxs-lookup"><span data-stu-id="baf54-141">That last step in our master/detail report is to list the products associated with the selected category.</span></span> <span data-ttu-id="baf54-142">これを実現するには、GridView をページに追加し、`productsDataSource`という名前の新しい ObjectDataSource を作成します。</span><span class="sxs-lookup"><span data-stu-id="baf54-142">To accomplish this, add a GridView to the page and create a new ObjectDataSource named `productsDataSource`.</span></span> <span data-ttu-id="baf54-143">`productsDataSource` コントロールが、`ProductsBLL` クラスの `GetProductsByCategoryID(categoryID)` メソッドからのデータをカリングするようにします。</span><span class="sxs-lookup"><span data-stu-id="baf54-143">Have the `productsDataSource` control cull its data from the `ProductsBLL` class's `GetProductsByCategoryID(categoryID)` method.</span></span>

<span data-ttu-id="baf54-144">[Get製品 Bycategoryid (categoryID) メソッドを選択 ![には](master-detail-filtering-with-a-dropdownlist-cs/_static/image20.png)](master-detail-filtering-with-a-dropdownlist-cs/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="baf54-144">[![Select the GetProductsByCategoryID(categoryID) Method](master-detail-filtering-with-a-dropdownlist-cs/_static/image20.png)](master-detail-filtering-with-a-dropdownlist-cs/_static/image19.png)</span></span>

<span data-ttu-id="baf54-145">**図 7**: `GetProductsByCategoryID(categoryID)` メソッドを選択[する (クリックしてフルサイズのイメージを表示](master-detail-filtering-with-a-dropdownlist-cs/_static/image21.png))</span><span class="sxs-lookup"><span data-stu-id="baf54-145">**Figure 7**: Select the `GetProductsByCategoryID(categoryID)` Method ([Click to view full-size image](master-detail-filtering-with-a-dropdownlist-cs/_static/image21.png))</span></span>

<span data-ttu-id="baf54-146">このメソッドを選択すると、ObjectDataSource ウィザードによって、メソッドの *`categoryID`* パラメーターの値を入力するように求められます。</span><span class="sxs-lookup"><span data-stu-id="baf54-146">After choosing this method, the ObjectDataSource wizard prompts us for the value for the method's *`categoryID`* parameter.</span></span> <span data-ttu-id="baf54-147">選択した `categories` DropDownList 項目の値を使用するには、パラメーターソースを制御するように設定し、ControlID を `Categories`に設定します。</span><span class="sxs-lookup"><span data-stu-id="baf54-147">To use the value of the selected `categories` DropDownList item set the Parameter source to Control and the ControlID to `Categories`.</span></span>

<span data-ttu-id="baf54-148">[categoryID パラメーターをカテゴリの DropDownList の値に設定 ![](master-detail-filtering-with-a-dropdownlist-cs/_static/image23.png)](master-detail-filtering-with-a-dropdownlist-cs/_static/image22.png)</span><span class="sxs-lookup"><span data-stu-id="baf54-148">[![Set the categoryID Parameter to the Value of the Categories DropDownList](master-detail-filtering-with-a-dropdownlist-cs/_static/image23.png)](master-detail-filtering-with-a-dropdownlist-cs/_static/image22.png)</span></span>

<span data-ttu-id="baf54-149">**図 8**: *`categoryID`* パラメーターを `Categories` DropDownList の値に設定する ([クリックすると、フルサイズの画像が表示](master-detail-filtering-with-a-dropdownlist-cs/_static/image24.png)されます)</span><span class="sxs-lookup"><span data-stu-id="baf54-149">**Figure 8**: Set the *`categoryID`* Parameter to the Value of the `Categories` DropDownList ([Click to view full-size image](master-detail-filtering-with-a-dropdownlist-cs/_static/image24.png))</span></span>

<span data-ttu-id="baf54-150">ブラウザーで進行状況を確認してみてください。</span><span class="sxs-lookup"><span data-stu-id="baf54-150">Take a moment to check out our progress in a browser.</span></span> <span data-ttu-id="baf54-151">最初にページにアクセスしたときに、選択したカテゴリ (飲料) に属している製品が表示されます (図9を参照)。 DropDownList を変更してもデータは更新されません。</span><span class="sxs-lookup"><span data-stu-id="baf54-151">When first visiting the page, those products belong to the selected category (Beverages) are displayed (as shown in Figure 9), but changing the DropDownList doesn't update the data.</span></span> <span data-ttu-id="baf54-152">これは、GridView を更新するためにポストバックが発生する必要があるためです。</span><span class="sxs-lookup"><span data-stu-id="baf54-152">This is because a postback must occur for the GridView to update.</span></span> <span data-ttu-id="baf54-153">これを実現するには、次の2つのオプションがあります (どちらの方法でもコードを記述する必要はありません)。</span><span class="sxs-lookup"><span data-stu-id="baf54-153">To accomplish this we have two options (neither of which requires writing any code):</span></span>

- <span data-ttu-id="baf54-154">**[カテゴリ] [DropDownList の\*\*[AutoPostBack] プロパティ](https://msdn.microsoft.com/library/system.web.ui.webcontrols.listcontrol.autopostback%28VS.80%29.aspx)**を [True] に設定します。\*\*</span><span class="sxs-lookup"><span data-stu-id="baf54-154">**Set the categories DropDownList's**[AutoPostBack property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.listcontrol.autopostback%28VS.80%29.aspx)**to True.**</span></span> <span data-ttu-id="baf54-155">(これを行うには、DropDownList のスマートタグの [AutoPostBack を有効にする] オプションをオンにします)。これにより、DropDownList の選択項目がユーザーによって変更されるたびにポストバックがトリガーされます。</span><span class="sxs-lookup"><span data-stu-id="baf54-155">(You can accomplish this by checking the Enable AutoPostBack option in the DropDownList's smart tag.) This will trigger a postback whenever the DropDownList's selected item is changed by the user.</span></span> <span data-ttu-id="baf54-156">このため、ユーザーが DropDownList から新しいカテゴリを選択すると、ポストバックは議論し、新しく選択されたカテゴリの製品で GridView が更新されます。</span><span class="sxs-lookup"><span data-stu-id="baf54-156">Therefore, when the user selects a new category from the DropDownList a postback will ensue and the GridView will be updated with the products for the newly selected category.</span></span> <span data-ttu-id="baf54-157">(これは、このチュートリアルで使用した方法です)。</span><span class="sxs-lookup"><span data-stu-id="baf54-157">(This is the approach I've used in this tutorial.)</span></span>
- <span data-ttu-id="baf54-158">**DropDownList の横にボタン Web コントロールを追加します。**</span><span class="sxs-lookup"><span data-stu-id="baf54-158">**Add a Button Web control next to the DropDownList.**</span></span> <span data-ttu-id="baf54-159">`Text` プロパティを更新するように設定します。</span><span class="sxs-lookup"><span data-stu-id="baf54-159">Set its `Text` property to Refresh or something similar.</span></span> <span data-ttu-id="baf54-160">この方法では、ユーザーは新しいカテゴリを選択し、ボタンをクリックする必要があります。</span><span class="sxs-lookup"><span data-stu-id="baf54-160">With this approach, the user will need to select a new category and then click the Button.</span></span> <span data-ttu-id="baf54-161">このボタンをクリックすると、ポストバックが発生し、GridView が更新されて、選択したカテゴリの製品が一覧表示されます。</span><span class="sxs-lookup"><span data-stu-id="baf54-161">Clicking the Button will cause a postback and update the GridView to list those products of the selected category.</span></span>

<span data-ttu-id="baf54-162">図9と10は、マスター/詳細レポートの動作を示しています。</span><span class="sxs-lookup"><span data-stu-id="baf54-162">Figures 9 and 10 illustrate the master/detail report in action.</span></span>

<span data-ttu-id="baf54-163">[ページに初めてアクセスしたときに、飲料製品が表示される ![](master-detail-filtering-with-a-dropdownlist-cs/_static/image26.png)](master-detail-filtering-with-a-dropdownlist-cs/_static/image25.png)</span><span class="sxs-lookup"><span data-stu-id="baf54-163">[![When First Visiting the Page, the Beverage Products are Displayed](master-detail-filtering-with-a-dropdownlist-cs/_static/image26.png)](master-detail-filtering-with-a-dropdownlist-cs/_static/image25.png)</span></span>

<span data-ttu-id="baf54-164">**図 9**: 最初にページにアクセスしたときに、飲み物の製品が表示される ([クリックすると、フルサイズの画像が表示](master-detail-filtering-with-a-dropdownlist-cs/_static/image27.png)されます)</span><span class="sxs-lookup"><span data-stu-id="baf54-164">**Figure 9**: When First Visiting the Page, the Beverage Products are Displayed ([Click to view full-size image](master-detail-filtering-with-a-dropdownlist-cs/_static/image27.png))</span></span>

<span data-ttu-id="baf54-165">[新しい製品 ([生成]) を選択する ![自動的にポストバックが発生し、GridView が更新されます。](master-detail-filtering-with-a-dropdownlist-cs/_static/image29.png)](master-detail-filtering-with-a-dropdownlist-cs/_static/image28.png)</span><span class="sxs-lookup"><span data-stu-id="baf54-165">[![Selecting a New Product (Produce) Automatically Causes a PostBack, Updating the GridView](master-detail-filtering-with-a-dropdownlist-cs/_static/image29.png)](master-detail-filtering-with-a-dropdownlist-cs/_static/image28.png)</span></span>

<span data-ttu-id="baf54-166">**図 10**: 新しい製品 ([生成]) を選択すると自動的にポストバックが発生し、GridView が更新されます ([クリックすると、フルサイズのイメージが表示](master-detail-filtering-with-a-dropdownlist-cs/_static/image30.png)されます)</span><span class="sxs-lookup"><span data-stu-id="baf54-166">**Figure 10**: Selecting a New Product (Produce) Automatically Causes a PostBack, Updating the GridView ([Click to view full-size image](master-detail-filtering-with-a-dropdownlist-cs/_static/image30.png))</span></span>

## <a name="adding-a----choose-a-category----list-item"></a><span data-ttu-id="baf54-167">"--カテゴリの選択--" リスト項目を追加する</span><span class="sxs-lookup"><span data-stu-id="baf54-167">Adding a "-- Choose a Category --" List Item</span></span>

<span data-ttu-id="baf54-168">最初に [`FilterByDropDownList.aspx`] ページにアクセスしたときに、[カテゴリ] [DropDownList の最初のリスト項目 (飲料)] が既定で選択されており、GridView の飲料製品が表示されます。</span><span class="sxs-lookup"><span data-stu-id="baf54-168">When first visiting the `FilterByDropDownList.aspx` page the categories DropDownList's first list item (Beverages) is selected by default, showing the beverage products in the GridView.</span></span> <span data-ttu-id="baf54-169">最初のカテゴリの製品を表示するのではなく、"--カテゴリの選択--" のような DropDownList 項目を選択しておくことをお勧めします。</span><span class="sxs-lookup"><span data-stu-id="baf54-169">Rather than showing the first category's products, we may want to instead have a DropDownList item selected that says something like, "-- Choose a Category --".</span></span>

<span data-ttu-id="baf54-170">新しいリストアイテムを DropDownList に追加するには、プロパティウィンドウにアクセスし、`Items` プロパティの省略記号をクリックします。</span><span class="sxs-lookup"><span data-stu-id="baf54-170">To add a new list item to the DropDownList, go to the Properties window and click on the ellipses in the `Items` property.</span></span> <span data-ttu-id="baf54-171">`Text` "--Category--" と `Value` `-1`を持つ新しいリスト項目を追加します。</span><span class="sxs-lookup"><span data-stu-id="baf54-171">Add a new list item with the `Text` "-- Choose a Category --" and the `Value` `-1`.</span></span>

<span data-ttu-id="baf54-172">[![の追加--カテゴリの選択--リスト項目](master-detail-filtering-with-a-dropdownlist-cs/_static/image32.png)](master-detail-filtering-with-a-dropdownlist-cs/_static/image31.png)</span><span class="sxs-lookup"><span data-stu-id="baf54-172">[![Add a -- Choose a Category -- List Item](master-detail-filtering-with-a-dropdownlist-cs/_static/image32.png)](master-detail-filtering-with-a-dropdownlist-cs/_static/image31.png)</span></span>

<span data-ttu-id="baf54-173">**図 11**: 追加 a--カテゴリの選択--リスト項目 ([クリックすると、フルサイズの画像が表示](master-detail-filtering-with-a-dropdownlist-cs/_static/image33.png)される)</span><span class="sxs-lookup"><span data-stu-id="baf54-173">**Figure 11**: Add a -- Choose a Category -- List Item ([Click to view full-size image](master-detail-filtering-with-a-dropdownlist-cs/_static/image33.png))</span></span>

<span data-ttu-id="baf54-174">または、次のマークアップを DropDownList に追加して、リスト項目を追加することもできます。</span><span class="sxs-lookup"><span data-stu-id="baf54-174">Alternatively, you can add the list item by adding the following markup to the DropDownList:</span></span>

[!code-aspx[Main](master-detail-filtering-with-a-dropdownlist-cs/samples/sample1.aspx)]

<span data-ttu-id="baf54-175">また、`AppendDataBoundItems` が True でない場合は、項目が ObjectDataSource から DropDownList にバインドされると、手動で追加されたリスト項目が上書きされるので、DropDownList コントロールの `AppendDataBoundItems` を True に設定する必要があります。</span><span class="sxs-lookup"><span data-stu-id="baf54-175">Additionally, we need to set the DropDownList control's `AppendDataBoundItems` to True because when the categories are bound to the DropDownList from the ObjectDataSource they'll overwrite any manually-added list items if `AppendDataBoundItems` isn't True.</span></span>

![AppendDataBoundItems プロパティを True に設定します。](master-detail-filtering-with-a-dropdownlist-cs/_static/image34.png)

<span data-ttu-id="baf54-177">**図 12**: `AppendDataBoundItems` プロパティを True に設定する</span><span class="sxs-lookup"><span data-stu-id="baf54-177">**Figure 12**: Set the `AppendDataBoundItems` Property to True</span></span>

<span data-ttu-id="baf54-178">これらの変更が完了すると、最初にページにアクセスしたときに、[--カテゴリを選択--] オプションが選択され、製品は表示されません。</span><span class="sxs-lookup"><span data-stu-id="baf54-178">After these changes, when first visiting the page the "-- Choose a Category --" option is selected and no products are displayed.</span></span>

<span data-ttu-id="baf54-179">[最初のページの読み込みで ![製品が表示されない](master-detail-filtering-with-a-dropdownlist-cs/_static/image36.png)](master-detail-filtering-with-a-dropdownlist-cs/_static/image35.png)</span><span class="sxs-lookup"><span data-stu-id="baf54-179">[![On the Initial Page Load No Products are Displayed](master-detail-filtering-with-a-dropdownlist-cs/_static/image36.png)](master-detail-filtering-with-a-dropdownlist-cs/_static/image35.png)</span></span>

<span data-ttu-id="baf54-180">**図 13**: 初期ページの読み込み時に製品が表示されない ([クリックすると、フルサイズの画像が表示](master-detail-filtering-with-a-dropdownlist-cs/_static/image37.png)されます)</span><span class="sxs-lookup"><span data-stu-id="baf54-180">**Figure 13**: On the Initial Page Load No Products are Displayed ([Click to view full-size image](master-detail-filtering-with-a-dropdownlist-cs/_static/image37.png))</span></span>

<span data-ttu-id="baf54-181">"--カテゴリの選択--" リスト項目が選択されているために、製品が表示されない理由は、その値が `-1` で、データベースに `-1`の `CategoryID` を持つ製品が存在しないためです。</span><span class="sxs-lookup"><span data-stu-id="baf54-181">The reason no products are displayed when because the "-- Choose a Category --" list item is selected is because its value is `-1` and there are no products in the database with a `CategoryID` of `-1`.</span></span> <span data-ttu-id="baf54-182">この動作が必要な場合は、この時点で完了です。</span><span class="sxs-lookup"><span data-stu-id="baf54-182">If this is the behavior you want then you're done at this point!</span></span> <span data-ttu-id="baf54-183">ただし、"--カテゴリの選択--" リスト項目が選択されているときに*すべて*のカテゴリを表示する場合は、`ProductsBLL` クラスに戻り、`GetProductsByCategoryID(categoryID)` メソッドをカスタマイズして、渡された *`categoryID`* パラメーターがゼロ未満の場合に `GetProducts()` メソッドを呼び出すようにします。</span><span class="sxs-lookup"><span data-stu-id="baf54-183">If, however, you want to display *all* of the categories when the "-- Choose a Category --" list item is selected, return to the `ProductsBLL` class and customize the `GetProductsByCategoryID(categoryID)` method so that it invokes the `GetProducts()` method if the passed in *`categoryID`* parameter is less than zero:</span></span>

[!code-csharp[Main](master-detail-filtering-with-a-dropdownlist-cs/samples/sample2.cs)]

<span data-ttu-id="baf54-184">ここで使用する手法は、[宣言型パラメーター](../basic-reporting/declarative-parameters-cs.md)のチュートリアルですべてのサプライヤーを表示する方法と似ています。この例では、`-1` の値を使用して、`null`ではなくすべてのレコードを取得するように指定しています。</span><span class="sxs-lookup"><span data-stu-id="baf54-184">The technique used here is similar to the approach we used to display all suppliers back in the [Declarative Parameters](../basic-reporting/declarative-parameters-cs.md) tutorial, although for this example we're using a value of `-1` to indicate that all records should be retrieved as opposed to `null`.</span></span> <span data-ttu-id="baf54-185">これは、`GetProductsByCategoryID(categoryID)` メソッドの *`categoryID`* パラメーターには、渡された整数値が必要であるのに対し、宣言型パラメーターのチュートリアルでは、文字列入力パラメーターを渡しているためです。</span><span class="sxs-lookup"><span data-stu-id="baf54-185">This is because the *`categoryID`* parameter of the `GetProductsByCategoryID(categoryID)` method expects as integer value passed in, whereas in the Declarative Parameters tutorial we were passing in a string input parameter.</span></span>

<span data-ttu-id="baf54-186">図14は、"--カテゴリの選択--" オプションが選択されている場合の `FilterByDropDownList.aspx` のスクリーンショットを示しています。</span><span class="sxs-lookup"><span data-stu-id="baf54-186">Figure 14 shows a screen shot of `FilterByDropDownList.aspx` when the "-- Choose a Category --" option is selected.</span></span> <span data-ttu-id="baf54-187">ここでは、すべての製品が既定で表示され、ユーザーは特定のカテゴリを選択して表示を絞り込むことができます。</span><span class="sxs-lookup"><span data-stu-id="baf54-187">Here, all of the products are displayed by default, and the user can narrow the display by choosing a specific category.</span></span>

<span data-ttu-id="baf54-188">[すべての製品が既定で一覧表示されるように ![](master-detail-filtering-with-a-dropdownlist-cs/_static/image39.png)](master-detail-filtering-with-a-dropdownlist-cs/_static/image38.png)</span><span class="sxs-lookup"><span data-stu-id="baf54-188">[![All of the Products are Now Listed By Default](master-detail-filtering-with-a-dropdownlist-cs/_static/image39.png)](master-detail-filtering-with-a-dropdownlist-cs/_static/image38.png)</span></span>

<span data-ttu-id="baf54-189">**図 14**: 既定ですべての製品が表示される ([クリックすると、フルサイズの画像が表示](master-detail-filtering-with-a-dropdownlist-cs/_static/image40.png)されます)</span><span class="sxs-lookup"><span data-stu-id="baf54-189">**Figure 14**: All of the Products are Now Listed By Default ([Click to view full-size image](master-detail-filtering-with-a-dropdownlist-cs/_static/image40.png))</span></span>

## <a name="summary"></a><span data-ttu-id="baf54-190">要約</span><span class="sxs-lookup"><span data-stu-id="baf54-190">Summary</span></span>

<span data-ttu-id="baf54-191">階層的に関連するデータを表示する場合は、多くの場合、マスター/詳細レポートを使用してデータを表示することができます。この場合、ユーザーは階層の最上位からデータのつい man を開始し、詳細にドリルダウンできます。</span><span class="sxs-lookup"><span data-stu-id="baf54-191">When displaying hierarchically-related data, it often helps to present the data using master/detail reports, from which the user can start perusing the data from the top of the hierarchy and drill down into details.</span></span> <span data-ttu-id="baf54-192">このチュートリアルでは、選択したカテゴリの製品を示す単純なマスター/詳細レポートを作成する方法を説明しました。</span><span class="sxs-lookup"><span data-stu-id="baf54-192">In this tutorial we examined building a simple master/detail report showing a selected category's products.</span></span> <span data-ttu-id="baf54-193">これを実現するには、選択したカテゴリに属する製品のカテゴリの一覧の DropDownList と GridView を使用します。</span><span class="sxs-lookup"><span data-stu-id="baf54-193">This was accomplished by using a DropDownList for the list of categories and a GridView for the products belonging to the selected category.</span></span>

<span data-ttu-id="baf54-194">次の[チュートリアル](master-detail-filtering-with-two-dropdownlists-cs.md)では、2つの dropdownlists を使用して、DropDownList インターフェイスを1ステップ進めます。</span><span class="sxs-lookup"><span data-stu-id="baf54-194">In the [next tutorial](master-detail-filtering-with-two-dropdownlists-cs.md) we'll take the DropDownList interface one step further, using two DropDownLists.</span></span>

<span data-ttu-id="baf54-195">プログラミングを楽しんでください。</span><span class="sxs-lookup"><span data-stu-id="baf54-195">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="baf54-196">作成者について</span><span class="sxs-lookup"><span data-stu-id="baf54-196">About the Author</span></span>

<span data-ttu-id="baf54-197">1998以来、 [Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml)は 7 asp/創設者 of [4GuysFromRolla.com](http://www.4guysfromrolla.com)の執筆者であり、Microsoft Web テクノロジを使用しています。</span><span class="sxs-lookup"><span data-stu-id="baf54-197">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="baf54-198">Scott は、独立したコンサルタント、トレーナー、およびライターとして機能します。</span><span class="sxs-lookup"><span data-stu-id="baf54-198">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="baf54-199">彼の最新の書籍は[ *、ASP.NET 2.0 を24時間以内に教え*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)ています。</span><span class="sxs-lookup"><span data-stu-id="baf54-199">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="baf54-200">mitchell@4GuysFromRolla.comでアクセスでき[ます。](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="baf54-200">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="baf54-201">または彼のブログを参照してください。これは[http://ScottOnWriting.NET](http://ScottOnWriting.NET)にあります。</span><span class="sxs-lookup"><span data-stu-id="baf54-201">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

> [!div class="step-by-step"]
> [<span data-ttu-id="baf54-202">次へ</span><span class="sxs-lookup"><span data-stu-id="baf54-202">Next</span></span>](master-detail-filtering-with-two-dropdownlists-cs.md)

---
uid: web-forms/overview/data-access/paging-and-sorting-with-the-datalist-and-repeater/paging-report-data-in-a-datalist-or-repeater-control-vb
title: DataList または Repeater コントロールでのレポートデータのページング (VB) |Microsoft Docs
author: rick-anderson
description: このチュートリアルでは、自動ページングまたは並べ替えをサポートしているのではなく、DataList または Repeater にページングサポートを追加する方法についても説明してい,...
ms.author: riande
ms.date: 11/13/2006
ms.assetid: bbd6b7f7-b98a-48b4-93f3-341d6a4f53c0
msc.legacyurl: /web-forms/overview/data-access/paging-and-sorting-with-the-datalist-and-repeater/paging-report-data-in-a-datalist-or-repeater-control-vb
msc.type: authoredcontent
ms.openlocfilehash: 5c65ca1f263e41748d99323dbdf1c28fdd077246
ms.sourcegitcommit: 22fbd8863672c4ad6693b8388ad5c8e753fb41a2
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 11/28/2019
ms.locfileid: "74570222"
---
# <a name="paging-report-data-in-a-datalist-or-repeater-control-vb"></a><span data-ttu-id="f5e38-103">DataList または Repeater コントロールのレポート データをページングする (VB)</span><span class="sxs-lookup"><span data-stu-id="f5e38-103">Paging Report Data in a DataList or Repeater Control (VB)</span></span>

<span data-ttu-id="f5e38-104">[Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="f5e38-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="f5e38-105">[サンプルアプリのダウンロード](https://download.microsoft.com/download/4/a/7/4a7a3b18-d80e-4014-8e53-a6a2427f0d93/ASPNET_Data_Tutorial_44_VB.exe)または[PDF のダウンロード](paging-report-data-in-a-datalist-or-repeater-control-vb/_static/datatutorial44vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="f5e38-105">[Download Sample App](https://download.microsoft.com/download/4/a/7/4a7a3b18-d80e-4014-8e53-a6a2427f0d93/ASPNET_Data_Tutorial_44_VB.exe) or [Download PDF](paging-report-data-in-a-datalist-or-repeater-control-vb/_static/datatutorial44vb1.pdf)</span></span>

> <span data-ttu-id="f5e38-106">このチュートリアルでは、自動ページングまたは並べ替えをサポートしているのではなく、DataList または Repeater にページングサポートを追加する方法についても説明します。</span><span class="sxs-lookup"><span data-stu-id="f5e38-106">While neither the DataList nor Repeater offer automatic paging or sorting support, this tutorial shows how to add paging support to the DataList or Repeater, which allows for much more flexible paging and data display interfaces.</span></span>

## <a name="introduction"></a><span data-ttu-id="f5e38-107">はじめに</span><span class="sxs-lookup"><span data-stu-id="f5e38-107">Introduction</span></span>

<span data-ttu-id="f5e38-108">ページングと並べ替えは、オンラインアプリケーションにデータを表示するときの2つの非常に一般的な機能です。</span><span class="sxs-lookup"><span data-stu-id="f5e38-108">Paging and sorting are two very common features when displaying data in an online application.</span></span> <span data-ttu-id="f5e38-109">たとえば、オンライン書店で ASP.NET books を検索する場合、このような書籍は多数存在する可能性がありますが、検索結果を一覧表示するレポートでは、1ページあたり10件の一致のみが一覧表示されます。</span><span class="sxs-lookup"><span data-stu-id="f5e38-109">For example, when searching for ASP.NET books at an online bookstore, there may be hundreds of such books, but the report listing the search results lists only ten matches per page.</span></span> <span data-ttu-id="f5e38-110">さらに、結果はタイトル、価格、ページ数、作成者名などで並べ替えることができます。</span><span class="sxs-lookup"><span data-stu-id="f5e38-110">Moreover, the results can be sorted by title, price, page count, author name, and so on.</span></span> <span data-ttu-id="f5e38-111">「[レポートデータのページングと並べ替え](../paging-and-sorting/paging-and-sorting-report-data-vb.md)」のチュートリアルで説明したように、GridView、DetailsView、および FormView コントロールには、チェックボックスの目盛りで有効にできる組み込みのページングサポートが用意されています。</span><span class="sxs-lookup"><span data-stu-id="f5e38-111">As we discussed in the [Paging and Sorting Report Data](../paging-and-sorting/paging-and-sorting-report-data-vb.md) tutorial, the GridView, DetailsView, and FormView controls all provide built-in paging support that can be enabled at the tick of a checkbox.</span></span> <span data-ttu-id="f5e38-112">GridView には、並べ替えのサポートも含まれています。</span><span class="sxs-lookup"><span data-stu-id="f5e38-112">The GridView also includes sorting support.</span></span>

<span data-ttu-id="f5e38-113">残念ながら、自動ページングや並べ替えはサポートされていません。</span><span class="sxs-lookup"><span data-stu-id="f5e38-113">Unfortunately, neither the DataList nor Repeater offer automatic paging or sorting support.</span></span> <span data-ttu-id="f5e38-114">このチュートリアルでは、DataList または Repeater にページングサポートを追加する方法について説明します。</span><span class="sxs-lookup"><span data-stu-id="f5e38-114">In this tutorial we'll examine how to add paging support to the DataList or Repeater.</span></span> <span data-ttu-id="f5e38-115">ページングインターフェイスを手動で作成し、適切なレコードページを表示し、ポストバック間でアクセスされているページを記憶しておく必要があります。</span><span class="sxs-lookup"><span data-stu-id="f5e38-115">We must manually create the paging interface, display the appropriate page of records, and remember the page being visited across postbacks.</span></span> <span data-ttu-id="f5e38-116">この処理には GridView、DetailsView、または FormView よりも時間とコードが必要ですが、DataList と Repeater では、より柔軟なページングとデータ表示インターフェイスを使用できます。</span><span class="sxs-lookup"><span data-stu-id="f5e38-116">While this does take more time and code than with the GridView, DetailsView, or FormView, the DataList and Repeater allow for much more flexible paging and data display interfaces.</span></span>

> [!NOTE]
> <span data-ttu-id="f5e38-117">このチュートリアルでは、ページングのみを中心に説明します。</span><span class="sxs-lookup"><span data-stu-id="f5e38-117">This tutorial focuses exclusively on paging.</span></span> <span data-ttu-id="f5e38-118">次のチュートリアルでは、並べ替え機能の追加に注目します。</span><span class="sxs-lookup"><span data-stu-id="f5e38-118">In the next tutorial we'll turn our attention to adding sorting capabilities.</span></span>

## <a name="step-1-adding-the-paging-and-sorting-tutorial-web-pages"></a><span data-ttu-id="f5e38-119">手順 1: ページングと並べ替えのチュートリアル Web ページの追加</span><span class="sxs-lookup"><span data-stu-id="f5e38-119">Step 1: Adding the Paging and Sorting Tutorial Web Pages</span></span>

<span data-ttu-id="f5e38-120">このチュートリアルを開始する前に、まず、このチュートリアルに必要な ASP.NET ページと次のページを追加してみましょう。</span><span class="sxs-lookup"><span data-stu-id="f5e38-120">Before we start this tutorial, let s first take a moment to add the ASP.NET pages we'll need for this tutorial and the next one.</span></span> <span data-ttu-id="f5e38-121">まず、`PagingSortingDataListRepeater`という名前のプロジェクトに新しいフォルダーを作成します。</span><span class="sxs-lookup"><span data-stu-id="f5e38-121">Start by creating a new folder in the project named `PagingSortingDataListRepeater`.</span></span> <span data-ttu-id="f5e38-122">次に、次の5つの ASP.NET ページをこのフォルダーに追加します。マスターページ `Site.master`を使用するようにすべてのページを構成します。</span><span class="sxs-lookup"><span data-stu-id="f5e38-122">Next, add the following five ASP.NET pages to this folder, having all of them configured to use the master page `Site.master`:</span></span>

- `Default.aspx`
- `Paging.aspx`
- `Sorting.aspx`
- `SortingWithDefaultPaging.aspx`
- `SortingWithCustomPaging.aspx`

![PagingSortingDataListRepeater フォルダーを作成し、チュートリアル ASP.NET ページを追加します。](paging-report-data-in-a-datalist-or-repeater-control-vb/_static/image1.png)

<span data-ttu-id="f5e38-124">**図 1**: `PagingSortingDataListRepeater` フォルダーを作成し、チュートリアル ASP.NET ページを追加する</span><span class="sxs-lookup"><span data-stu-id="f5e38-124">**Figure 1**: Create a `PagingSortingDataListRepeater` Folder and Add the Tutorial ASP.NET Pages</span></span>

<span data-ttu-id="f5e38-125">次に、[`Default.aspx`] ページを開き、`SectionLevelTutorialListing.ascx` ユーザーコントロールを `UserControls` フォルダーからデザイン画面にドラッグします。</span><span class="sxs-lookup"><span data-stu-id="f5e38-125">Next, open the `Default.aspx` page and drag the `SectionLevelTutorialListing.ascx` User Control from the `UserControls` folder onto the Design surface.</span></span> <span data-ttu-id="f5e38-126">このユーザーコントロールは、[マスターページとサイトナビゲーション](../introduction/master-pages-and-site-navigation-vb.md)チュートリアルで作成したもので、サイトマップを列挙し、現在のセクションに記載されているチュートリアルを箇条書きの一覧に表示します。</span><span class="sxs-lookup"><span data-stu-id="f5e38-126">This User Control, which we created in the [Master Pages and Site Navigation](../introduction/master-pages-and-site-navigation-vb.md) tutorial, enumerates the site map and displays those tutorials in the current section in a bulleted list.</span></span>

<span data-ttu-id="f5e38-127">[SectionLevelTutorialListing ユーザーコントロールを default.aspx に追加 ![には](paging-report-data-in-a-datalist-or-repeater-control-vb/_static/image3.png)](paging-report-data-in-a-datalist-or-repeater-control-vb/_static/image2.png)</span><span class="sxs-lookup"><span data-stu-id="f5e38-127">[![Add the SectionLevelTutorialListing.ascx User Control to Default.aspx](paging-report-data-in-a-datalist-or-repeater-control-vb/_static/image3.png)](paging-report-data-in-a-datalist-or-repeater-control-vb/_static/image2.png)</span></span>

<span data-ttu-id="f5e38-128">**図 2**: `Default.aspx` に `SectionLevelTutorialListing.ascx` ユーザーコントロールを追加する ([クリックすると、フルサイズの画像が表示](paging-report-data-in-a-datalist-or-repeater-control-vb/_static/image4.png)されます)</span><span class="sxs-lookup"><span data-stu-id="f5e38-128">**Figure 2**: Add the `SectionLevelTutorialListing.ascx` User Control to `Default.aspx` ([Click to view full-size image](paging-report-data-in-a-datalist-or-repeater-control-vb/_static/image4.png))</span></span>

<span data-ttu-id="f5e38-129">箇条書きの一覧に、作成するページングと並べ替えのチュートリアルが表示されるようにするには、サイトマップに追加する必要があります。</span><span class="sxs-lookup"><span data-stu-id="f5e38-129">In order to have the bulleted list display the paging and sorting tutorials we'll be creating, we need to add them to the site map.</span></span> <span data-ttu-id="f5e38-130">`Web.sitemap` ファイルを開き、DataList サイトマップノードマークアップを使用して編集および削除の後に、次のマークアップを追加します。</span><span class="sxs-lookup"><span data-stu-id="f5e38-130">Open the `Web.sitemap` file and add the following markup after the Editing and Deleting with the DataList site map node markup:</span></span>

[!code-xml[Main](paging-report-data-in-a-datalist-or-repeater-control-vb/samples/sample1.xml)]

![新しい ASP.NET ページを含めるようにサイトマップを更新する](paging-report-data-in-a-datalist-or-repeater-control-vb/_static/image5.png)

<span data-ttu-id="f5e38-132">**図 3**: 新しい ASP.NET ページを含めるようにサイトマップを更新する</span><span class="sxs-lookup"><span data-stu-id="f5e38-132">**Figure 3**: Update the Site Map to Include the New ASP.NET Pages</span></span>

## <a name="a-review-of-paging"></a><span data-ttu-id="f5e38-133">ページングのレビュー</span><span class="sxs-lookup"><span data-stu-id="f5e38-133">A Review of Paging</span></span>

<span data-ttu-id="f5e38-134">前のチュートリアルでは、GridView、DetailsView、および FormView コントロールのデータをページ表示する方法を説明しました。</span><span class="sxs-lookup"><span data-stu-id="f5e38-134">In previous tutorials we saw how to page through the data in the GridView, DetailsView, and FormView controls.</span></span> <span data-ttu-id="f5e38-135">これら3つのコントロールは、*既定のページング*と呼ばれる単純な形式のページングを提供します。これは、control s スマートタグの [ページングを有効にする] オプションをオンにするだけで実装できます。</span><span class="sxs-lookup"><span data-stu-id="f5e38-135">These three controls offer a simple form of paging called *default paging* that can be implemented by simply checking the Enable Paging option in the control s smart tag.</span></span> <span data-ttu-id="f5e38-136">既定のページングでは、最初のページにアクセスしたときにデータのページが要求されるたびに、またはユーザーが別のデータページに移動したときに、GridView、DetailsView、または FormView コントロールが ObjectDataSource からの*すべて*のデータを再要求します。</span><span class="sxs-lookup"><span data-stu-id="f5e38-136">With default paging, each time a page of data is requested either on the first page visit or when the user navigates to a different page of data the GridView, DetailsView, or FormView control re-requests *all* of the data from the ObjectDataSource.</span></span> <span data-ttu-id="f5e38-137">次に、要求されたページインデックスとページごとに表示するレコードの数を指定して、表示する特定のレコードのセットを切り取ります。</span><span class="sxs-lookup"><span data-stu-id="f5e38-137">It then snips out the particular set of records to display given the requested page index and the number of records to display per page.</span></span> <span data-ttu-id="f5e38-138">既定のページングについては、「[レポートデータのページングと並べ替え](../paging-and-sorting/paging-and-sorting-report-data-vb.md)」のチュートリアルで説明しました。</span><span class="sxs-lookup"><span data-stu-id="f5e38-138">We discussed default paging in detail in the [Paging and Sorting Report Data](../paging-and-sorting/paging-and-sorting-report-data-vb.md) tutorial.</span></span>

<span data-ttu-id="f5e38-139">既定のページングでは各ページのすべてのレコードが再要求されるため、十分に大量のデータをページングする場合は実用的ではありません。</span><span class="sxs-lookup"><span data-stu-id="f5e38-139">Since default paging re-requests all records for each page, it is not practical when paging through sufficiently large amounts of data.</span></span> <span data-ttu-id="f5e38-140">たとえば、ページサイズが10の5万レコードのページングを考えてみます。</span><span class="sxs-lookup"><span data-stu-id="f5e38-140">For example, imagine paging through 50,000 records with a page size of 10.</span></span> <span data-ttu-id="f5e38-141">ユーザーが新しいページに移動するたびに、10個のレコードが1つしか表示されない場合でも、すべての5万レコードをデータベースから取得する必要があります。</span><span class="sxs-lookup"><span data-stu-id="f5e38-141">Each time the user moves to a new page, all 50,000 records must be retrieved from the database, even though only ten of them are displayed.</span></span>

<span data-ttu-id="f5e38-142">*カスタムページング*は、要求されたページに表示するレコードの正確なサブセットのみを取得することで、既定のページングのパフォーマンスの問題を解決します。</span><span class="sxs-lookup"><span data-stu-id="f5e38-142">*Custom paging* solves the performance concerns of default paging by grabbing only the precise subset of records to display on the requested page.</span></span> <span data-ttu-id="f5e38-143">カスタムページングを実装する場合は、正しいレコードセットだけを効率的に返す SQL クエリを記述する必要があります。</span><span class="sxs-lookup"><span data-stu-id="f5e38-143">When implementing custom paging, we must write the SQL query that will efficiently return just the correct set of records.</span></span> <span data-ttu-id="f5e38-144">このようなクエリを作成する方法については、「[大量のデータを使用](../paging-and-sorting/efficiently-paging-through-large-amounts-of-data-vb.md)した効率的なページング」チュートリアルで SQL Server 2005 s new [`ROW_NUMBER()` キーワード](http://www.4guysfromrolla.com/webtech/010406-1.shtml)を使用して作成する方法について説明しました。</span><span class="sxs-lookup"><span data-stu-id="f5e38-144">We saw how to create such a query using SQL Server 2005 s new [`ROW_NUMBER()` keyword](http://www.4guysfromrolla.com/webtech/010406-1.shtml) back in the [Efficiently Paging Through Large Amounts of Data](../paging-and-sorting/efficiently-paging-through-large-amounts-of-data-vb.md) tutorial.</span></span>

<span data-ttu-id="f5e38-145">DataList または Repeater コントロールに既定のページングを実装するには、 [`PagedDataSource` クラス](https://msdn.microsoft.com/library/system.web.ui.webcontrols.pageddatasource.aspx)を、内容がページングされている `ProductsDataTable` のラッパーとして使用できます。</span><span class="sxs-lookup"><span data-stu-id="f5e38-145">To implement default paging in the DataList or Repeater controls, we can use the [`PagedDataSource` class](https://msdn.microsoft.com/library/system.web.ui.webcontrols.pageddatasource.aspx) as a wrapper around the `ProductsDataTable` whose contents are being paged.</span></span> <span data-ttu-id="f5e38-146">`PagedDataSource` クラスには、任意の列挙可能なオブジェクトに割り当てることができる `DataSource` プロパティと、1ページあたりのレコード数と現在のページインデックスを示す[`PageSize`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.pageddatasource.pagesize.aspx)および[`CurrentPageIndex`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.pageddatasource.currentpageindex.aspx)プロパティがあります。</span><span class="sxs-lookup"><span data-stu-id="f5e38-146">The `PagedDataSource` class has a `DataSource` property that can be assigned to any enumerable object and [`PageSize`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.pageddatasource.pagesize.aspx) and [`CurrentPageIndex`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.pageddatasource.currentpageindex.aspx) properties that indicate how many records to show per page and the current page index.</span></span> <span data-ttu-id="f5e38-147">これらのプロパティを設定した後は、任意のデータ Web コントロールのデータソースとして `PagedDataSource` を使用できます。</span><span class="sxs-lookup"><span data-stu-id="f5e38-147">Once these properties have been set, the `PagedDataSource` can be used as the data source of any data Web control.</span></span> <span data-ttu-id="f5e38-148">列挙された `PagedDataSource`は、`PageSize` および `CurrentPageIndex` プロパティに基づいて、内部 `DataSource` のレコードの適切なサブセットのみを返します。</span><span class="sxs-lookup"><span data-stu-id="f5e38-148">The `PagedDataSource`, when enumerated, will only return the appropriate subset of records of its inner `DataSource` based on the `PageSize` and `CurrentPageIndex` properties.</span></span> <span data-ttu-id="f5e38-149">図4は、`PagedDataSource` クラスの機能を示しています。</span><span class="sxs-lookup"><span data-stu-id="f5e38-149">Figure 4 depicts the functionality of the `PagedDataSource` class.</span></span>

![PagedDataSource は、ページング可能なインターフェイスを使用して列挙可能なオブジェクトをラップします。](paging-report-data-in-a-datalist-or-repeater-control-vb/_static/image6.png)

<span data-ttu-id="f5e38-151">**図 4**: `PagedDataSource` は、ページング可能なインターフェイスを使用して列挙可能なオブジェクトをラップする</span><span class="sxs-lookup"><span data-stu-id="f5e38-151">**Figure 4**: The `PagedDataSource` Wraps an Enumerable Object with a Pageable Interface</span></span>

<span data-ttu-id="f5e38-152">`PagedDataSource` オブジェクトは、ビジネスロジック層から直接作成して構成し、ObjectDataSource を介して DataList または Repeater にバインドするか、ASP.NET ページの分離コードクラスで直接作成して構成することができます。</span><span class="sxs-lookup"><span data-stu-id="f5e38-152">The `PagedDataSource` object can be created and configured directly from the Business Logic Layer and bound to a DataList or Repeater through an ObjectDataSource, or can be created and configured directly in the ASP.NET page s code-behind class.</span></span> <span data-ttu-id="f5e38-153">後者の方法を使用する場合は、ObjectDataSource を使用して済ませるする必要があります。代わりに、ページングされたデータを DataList または Repeater にプログラムでバインドします。</span><span class="sxs-lookup"><span data-stu-id="f5e38-153">If the latter approach is used, we must forgo using the ObjectDataSource and instead bind the paged data to the DataList or Repeater programmatically.</span></span>

<span data-ttu-id="f5e38-154">`PagedDataSource` オブジェクトには、カスタムページングをサポートするプロパティもあります。</span><span class="sxs-lookup"><span data-stu-id="f5e38-154">The `PagedDataSource` object also has properties to support custom paging.</span></span> <span data-ttu-id="f5e38-155">ただし、カスタムページングには `PagedDataSource` を使用しないようにすることができます。これは、表示する正確なレコードを返すカスタムページング用にデザインされた `ProductsBLL` クラスに既に BLL メソッドがあるためです。</span><span class="sxs-lookup"><span data-stu-id="f5e38-155">However, we can bypass using a `PagedDataSource` for custom paging because we already have BLL methods in the `ProductsBLL` class designed for custom paging that return the precise records to display.</span></span>

<span data-ttu-id="f5e38-156">このチュートリアルでは、適切に構成された `PagedDataSource` オブジェクトを返す `ProductsBLL` クラスに新しいメソッドを追加することによって、DataList に既定のページングを実装する方法について説明します。</span><span class="sxs-lookup"><span data-stu-id="f5e38-156">In this tutorial we'll look at implementing default paging in a DataList by adding a new method to the `ProductsBLL` class that returns an appropriately configured `PagedDataSource` object.</span></span> <span data-ttu-id="f5e38-157">次のチュートリアルでは、カスタムページングの使用方法について説明します。</span><span class="sxs-lookup"><span data-stu-id="f5e38-157">In the next tutorial, we'll see how to use custom paging.</span></span>

## <a name="step-2-adding-a-default-paging-method-in-the-business-logic-layer"></a><span data-ttu-id="f5e38-158">手順 2: ビジネスロジック層に既定のページングメソッドを追加する</span><span class="sxs-lookup"><span data-stu-id="f5e38-158">Step 2: Adding a Default Paging Method in the Business Logic Layer</span></span>

<span data-ttu-id="f5e38-159">現在、`ProductsBLL` クラスには、すべての製品情報 `GetProducts()` を返すメソッドと、開始インデックス `GetProductsPaged(startRowIndex, maximumRows)`で製品の特定のサブセットを返すためのメソッドがあります。</span><span class="sxs-lookup"><span data-stu-id="f5e38-159">The `ProductsBLL` class currently has a method for returning all product information `GetProducts()` and one for returning a particular subset of products at a starting index `GetProductsPaged(startRowIndex, maximumRows)`.</span></span> <span data-ttu-id="f5e38-160">既定のページングでは、GridView、DetailsView、FormView コントロールはすべて、`GetProducts()` メソッドを使用してすべての製品を取得しますが、内部的に `PagedDataSource` を使用して、レコードの正しいサブセットのみを表示します。</span><span class="sxs-lookup"><span data-stu-id="f5e38-160">With default paging, the GridView, DetailsView, and FormView controls all use the `GetProducts()` method to retrieve all products, but then use a `PagedDataSource` internally to display only the correct subset of records.</span></span> <span data-ttu-id="f5e38-161">DataList コントロールと Repeater コントロールを使用してこの機能をレプリケートするには、この動作を模倣する新しいメソッドを BLL に作成します。</span><span class="sxs-lookup"><span data-stu-id="f5e38-161">To replicate this functionality with the DataList and Repeater controls, we can create a new method in the BLL that mimics this behavior.</span></span>

<span data-ttu-id="f5e38-162">2つの整数入力パラメーターを受け取る `GetProductsAsPagedDataSource` という名前の `ProductsBLL` クラスにメソッドを追加します。</span><span class="sxs-lookup"><span data-stu-id="f5e38-162">Add a method to the `ProductsBLL` class named `GetProductsAsPagedDataSource` that takes in two integer input parameters:</span></span>

- <span data-ttu-id="f5e38-163">表示するページのインデックスを `pageIndex` し、0でインデックスを作成します。</span><span class="sxs-lookup"><span data-stu-id="f5e38-163">`pageIndex` the index of the page to display, indexed at zero, and</span></span>
- <span data-ttu-id="f5e38-164">ページごとに表示するレコードの数 `pageSize` ます。</span><span class="sxs-lookup"><span data-stu-id="f5e38-164">`pageSize` the number of records to display per page.</span></span>

<span data-ttu-id="f5e38-165">`GetProductsAsPagedDataSource` は、`GetProducts()`から*すべて*のレコードを取得することによって開始されます。</span><span class="sxs-lookup"><span data-stu-id="f5e38-165">`GetProductsAsPagedDataSource` starts by retrieving *all* of the records from `GetProducts()`.</span></span> <span data-ttu-id="f5e38-166">次に、`PagedDataSource` オブジェクトを作成し、その `CurrentPageIndex` と `PageSize` プロパティを、渡された `pageIndex` と `pageSize` パラメーターの値に設定します。</span><span class="sxs-lookup"><span data-stu-id="f5e38-166">It then creates a `PagedDataSource` object, setting its `CurrentPageIndex` and `PageSize` properties to the values of the passed-in `pageIndex` and `pageSize` parameters.</span></span> <span data-ttu-id="f5e38-167">メソッドは、この構成された `PagedDataSource`を返すことによって終了します。</span><span class="sxs-lookup"><span data-stu-id="f5e38-167">The method concludes by returning this configured `PagedDataSource`:</span></span>

[!code-vb[Main](paging-report-data-in-a-datalist-or-repeater-control-vb/samples/sample2.vb)]

## <a name="step-3-displaying-product-information-in-a-datalist-using-default-paging"></a><span data-ttu-id="f5e38-168">手順 3: 既定のページングを使用して DataList に製品情報を表示する</span><span class="sxs-lookup"><span data-stu-id="f5e38-168">Step 3: Displaying Product Information in a DataList Using Default Paging</span></span>

<span data-ttu-id="f5e38-169">`ProductsBLL` クラスに `GetProductsAsPagedDataSource` メソッドを追加して、既定のページングを提供する DataList または Repeater を作成できるようになりました。</span><span class="sxs-lookup"><span data-stu-id="f5e38-169">With the `GetProductsAsPagedDataSource` method added to the `ProductsBLL` class, we can now create a DataList or Repeater that provides default paging.</span></span> <span data-ttu-id="f5e38-170">まず、`PagingSortingDataListRepeater` フォルダーの [`Paging.aspx`] ページを開き、DataList をツールボックスからデザイナーにドラッグして、DataList s `ID` プロパティを `ProductsDefaultPaging`に設定します。</span><span class="sxs-lookup"><span data-stu-id="f5e38-170">Start by opening the `Paging.aspx` page in the `PagingSortingDataListRepeater` folder and drag a DataList from the Toolbox onto the Designer, setting the DataList s `ID` property to `ProductsDefaultPaging`.</span></span> <span data-ttu-id="f5e38-171">DataList s スマートタグから `ProductsDefaultPagingDataSource` という名前の新しい ObjectDataSource を作成し、`GetProductsAsPagedDataSource` メソッドを使用してデータを取得するように構成します。</span><span class="sxs-lookup"><span data-stu-id="f5e38-171">From the DataList s smart tag, create a new ObjectDataSource named `ProductsDefaultPagingDataSource` and configure it so that it retrieves data using the `GetProductsAsPagedDataSource` method.</span></span>

<span data-ttu-id="f5e38-172">[ObjectDataSource を作成 ![、GetProductsAsPagedDataSource () メソッドを使用するように構成します。](paging-report-data-in-a-datalist-or-repeater-control-vb/_static/image8.png)](paging-report-data-in-a-datalist-or-repeater-control-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="f5e38-172">[![Create an ObjectDataSource and Configure it to Use the GetProductsAsPagedDataSource () Method](paging-report-data-in-a-datalist-or-repeater-control-vb/_static/image8.png)](paging-report-data-in-a-datalist-or-repeater-control-vb/_static/image7.png)</span></span>

<span data-ttu-id="f5e38-173">**図 5**: ObjectDataSource を作成し、`GetProductsAsPagedDataSource` `()` メソッドを使用するように構成する ([クリックしてフルサイズのイメージを表示](paging-report-data-in-a-datalist-or-repeater-control-vb/_static/image9.png)する)</span><span class="sxs-lookup"><span data-stu-id="f5e38-173">**Figure 5**: Create an ObjectDataSource and Configure it to Use the `GetProductsAsPagedDataSource` `()` Method ([Click to view full-size image](paging-report-data-in-a-datalist-or-repeater-control-vb/_static/image9.png))</span></span>

<span data-ttu-id="f5e38-174">[更新]、[挿入]、[削除] の各タブのドロップダウンリストを [(なし)] に設定します。</span><span class="sxs-lookup"><span data-stu-id="f5e38-174">Set the drop-down lists in the UPDATE, INSERT, and DELETE tabs to (None) .</span></span>

<span data-ttu-id="f5e38-175">[[更新]、[挿入]、[削除] の各タブのドロップダウンリストを [(なし)] に設定 ![ます。](paging-report-data-in-a-datalist-or-repeater-control-vb/_static/image11.png)](paging-report-data-in-a-datalist-or-repeater-control-vb/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="f5e38-175">[![Set the Drop-Down Lists in the UPDATE, INSERT, and DELETE tabs to (None)](paging-report-data-in-a-datalist-or-repeater-control-vb/_static/image11.png)](paging-report-data-in-a-datalist-or-repeater-control-vb/_static/image10.png)</span></span>

<span data-ttu-id="f5e38-176">**図 6**: [更新]、[挿入]、[削除] の各タブのドロップダウンリストを (なし) に設定する ([クリックしてフルサイズの画像を表示する](paging-report-data-in-a-datalist-or-repeater-control-vb/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="f5e38-176">**Figure 6**: Set the Drop-Down Lists in the UPDATE, INSERT, and DELETE tabs to (None) ([Click to view full-size image](paging-report-data-in-a-datalist-or-repeater-control-vb/_static/image12.png))</span></span>

<span data-ttu-id="f5e38-177">`GetProductsAsPagedDataSource` メソッドでは2つの入力パラメーターが必要であるため、これらのパラメーター値のソースを要求するプロンプトが表示されます。</span><span class="sxs-lookup"><span data-stu-id="f5e38-177">Since the `GetProductsAsPagedDataSource` method expects two input parameters, the wizard prompts us for the source of these parameter values.</span></span>

<span data-ttu-id="f5e38-178">ページインデックスとページサイズの値は、ポストバック間で記録する必要があります。</span><span class="sxs-lookup"><span data-stu-id="f5e38-178">The page index and page size values must be remembered across postbacks.</span></span> <span data-ttu-id="f5e38-179">ビューステートに格納したり、クエリ文字列に永続化したり、セッション変数に格納したり、他の方法を使用して記憶したりすることができます。</span><span class="sxs-lookup"><span data-stu-id="f5e38-179">They can be stored in view state, persisted to the querystring, stored in session variables, or remembered using some other technique.</span></span> <span data-ttu-id="f5e38-180">このチュートリアルでは、querystring を使用します。これには、データの特定のページにブックマークを設定することができるという利点があります。</span><span class="sxs-lookup"><span data-stu-id="f5e38-180">For this tutorial we'll use the querystring, which has the advantage of allowing a particular page of data to be bookmarked.</span></span>

<span data-ttu-id="f5e38-181">特に、`pageIndex` パラメーターと `pageSize` パラメーターには、クエリ文字列フィールドの pageIndex と pageSize をそれぞれ使用します (図7を参照)。</span><span class="sxs-lookup"><span data-stu-id="f5e38-181">In particular, use the querystring fields pageIndex and pageSize for the `pageIndex` and `pageSize` parameters, respectively (see Figure 7).</span></span> <span data-ttu-id="f5e38-182">ユーザーが最初にこのページにアクセスしたときに querystring 値が表示されないため、これらのパラメーターの既定値を設定してください。</span><span class="sxs-lookup"><span data-stu-id="f5e38-182">Take a moment to set the default values for these parameters, as the querystring values won't be present when a user first visits this page.</span></span> <span data-ttu-id="f5e38-183">`pageIndex`には、既定値を 0 (データの最初のページが表示されます) に設定し、`pageSize` s の既定値を4に設定します。</span><span class="sxs-lookup"><span data-stu-id="f5e38-183">For `pageIndex`, set the default value to 0 (which will show the first page of data) and `pageSize` s default value to 4.</span></span>

<span data-ttu-id="f5e38-184">[![、pageIndex および pageSize パラメーターのソースとしてクエリ文字列を使用します。](paging-report-data-in-a-datalist-or-repeater-control-vb/_static/image14.png)](paging-report-data-in-a-datalist-or-repeater-control-vb/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="f5e38-184">[![Use the QueryString as the Source for the pageIndex and pageSize Parameters](paging-report-data-in-a-datalist-or-repeater-control-vb/_static/image14.png)](paging-report-data-in-a-datalist-or-repeater-control-vb/_static/image13.png)</span></span>

<span data-ttu-id="f5e38-185">**図 7**: `pageIndex` および `pageSize` パラメーターのソースとしてクエリ文字列を使用する ([クリックしてフルサイズのイメージを表示する](paging-report-data-in-a-datalist-or-repeater-control-vb/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="f5e38-185">**Figure 7**: Use the QueryString as the Source for the `pageIndex` and `pageSize` Parameters ([Click to view full-size image](paging-report-data-in-a-datalist-or-repeater-control-vb/_static/image15.png))</span></span>

<span data-ttu-id="f5e38-186">ObjectDataSource を構成すると、Visual Studio によって DataList の `ItemTemplate` が自動的に作成されます。</span><span class="sxs-lookup"><span data-stu-id="f5e38-186">After configuring the ObjectDataSource, Visual Studio automatically creates an `ItemTemplate` for the DataList.</span></span> <span data-ttu-id="f5e38-187">製品の名前、カテゴリ、および業者のみが表示されるように `ItemTemplate` をカスタマイズします。</span><span class="sxs-lookup"><span data-stu-id="f5e38-187">Customize the `ItemTemplate` so that only the product s name, category, and supplier are shown.</span></span> <span data-ttu-id="f5e38-188">また、DataList s `RepeatColumns` プロパティを2に、`Width` を100% に設定し、`ItemStyle` s `Width` を50% に設定します。</span><span class="sxs-lookup"><span data-stu-id="f5e38-188">Also set the DataList s `RepeatColumns` property to 2, its `Width` to 100%, and its `ItemStyle` s `Width` to 50%.</span></span> <span data-ttu-id="f5e38-189">これらの幅の設定では、2つの列に対して同じ間隔が使用されます。</span><span class="sxs-lookup"><span data-stu-id="f5e38-189">These width settings will provide equal spacing for the two columns.</span></span>

<span data-ttu-id="f5e38-190">これらの変更を行った後、DataList および ObjectDataSource s マークアップは次のようになります。</span><span class="sxs-lookup"><span data-stu-id="f5e38-190">After making these changes, the DataList and ObjectDataSource s markup should look similar to the following:</span></span>

[!code-aspx[Main](paging-report-data-in-a-datalist-or-repeater-control-vb/samples/sample3.aspx)]

> [!NOTE]
> <span data-ttu-id="f5e38-191">このチュートリアルでは、更新または削除の機能を実行していないので、表示されるページサイズを減らすために、DataList s ビューステートを無効にすることができます。</span><span class="sxs-lookup"><span data-stu-id="f5e38-191">Since we are not performing any update or delete functionality in this tutorial, you may disable the DataList s view state to reduce the rendered page size.</span></span>

<span data-ttu-id="f5e38-192">ブラウザーを使用して最初にこのページにアクセスしたときに、`pageIndex` も `pageSize` のクエリ文字列パラメーターも指定されていません。</span><span class="sxs-lookup"><span data-stu-id="f5e38-192">When initially visiting this page through a browser, neither the `pageIndex` nor `pageSize` querystring parameters are provided.</span></span> <span data-ttu-id="f5e38-193">そのため、既定値の0と4が使用されます。</span><span class="sxs-lookup"><span data-stu-id="f5e38-193">Hence, the default values of 0 and 4 are used.</span></span> <span data-ttu-id="f5e38-194">図8に示すように、これにより、最初の4つの製品を表示する DataList が生成されます。</span><span class="sxs-lookup"><span data-stu-id="f5e38-194">As Figure 8 shows, this results in a DataList that displays the first four products.</span></span>

<span data-ttu-id="f5e38-195">[最初の4つの製品が一覧表示され ![](paging-report-data-in-a-datalist-or-repeater-control-vb/_static/image17.png)](paging-report-data-in-a-datalist-or-repeater-control-vb/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="f5e38-195">[![The First Four Products are Listed](paging-report-data-in-a-datalist-or-repeater-control-vb/_static/image17.png)](paging-report-data-in-a-datalist-or-repeater-control-vb/_static/image16.png)</span></span>

<span data-ttu-id="f5e38-196">**図 8**: 最初の4つの製品が一覧表示されます ([クリックすると、フルサイズの画像が表示](paging-report-data-in-a-datalist-or-repeater-control-vb/_static/image18.png)されます)</span><span class="sxs-lookup"><span data-stu-id="f5e38-196">**Figure 8**: The First Four Products are Listed ([Click to view full-size image](paging-report-data-in-a-datalist-or-repeater-control-vb/_static/image18.png))</span></span>

<span data-ttu-id="f5e38-197">ページングインターフェイスを使用しない場合、ユーザーがデータの2ページ目に移動するための簡単な方法はありません。</span><span class="sxs-lookup"><span data-stu-id="f5e38-197">Without a paging interface, there s currently no straightforward means for a user to navigate to the second page of data.</span></span> <span data-ttu-id="f5e38-198">ここでは、手順 4. でページングインターフェイスを作成します。</span><span class="sxs-lookup"><span data-stu-id="f5e38-198">We'll create a paging interface in step 4.</span></span> <span data-ttu-id="f5e38-199">現時点では、ページングは、クエリ文字列のページング条件を直接指定することによってのみ実現できます。</span><span class="sxs-lookup"><span data-stu-id="f5e38-199">For now, though, paging can only be accomplished by directly specifying the paging criteria in the querystring.</span></span> <span data-ttu-id="f5e38-200">たとえば、2番目のページを表示するには、ブラウザーのアドレスバーの URL を `Paging.aspx` から `Paging.aspx?pageIndex=2` に変更し、Enter キーを押します。</span><span class="sxs-lookup"><span data-stu-id="f5e38-200">For example, to view the second page, change the URL in the browser s Address bar from `Paging.aspx` to `Paging.aspx?pageIndex=2` and hit Enter.</span></span> <span data-ttu-id="f5e38-201">これにより、データの2ページ目が表示されます (図9を参照)。</span><span class="sxs-lookup"><span data-stu-id="f5e38-201">This causes the second page of data to be displayed (see Figure 9).</span></span>

<span data-ttu-id="f5e38-202">[![データの2ページ目が表示されます。](paging-report-data-in-a-datalist-or-repeater-control-vb/_static/image20.png)](paging-report-data-in-a-datalist-or-repeater-control-vb/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="f5e38-202">[![The Second Page of Data is Displayed](paging-report-data-in-a-datalist-or-repeater-control-vb/_static/image20.png)](paging-report-data-in-a-datalist-or-repeater-control-vb/_static/image19.png)</span></span>

<span data-ttu-id="f5e38-203">**図 9**: データの2番目のページが表示される ([クリックすると、フルサイズの画像が表示](paging-report-data-in-a-datalist-or-repeater-control-vb/_static/image21.png)されます)</span><span class="sxs-lookup"><span data-stu-id="f5e38-203">**Figure 9**: The Second Page of Data is Displayed ([Click to view full-size image](paging-report-data-in-a-datalist-or-repeater-control-vb/_static/image21.png))</span></span>

## <a name="step-4-creating-the-paging-interface"></a><span data-ttu-id="f5e38-204">手順 4: ページングインターフェイスを作成する</span><span class="sxs-lookup"><span data-stu-id="f5e38-204">Step 4: Creating the Paging Interface</span></span>

<span data-ttu-id="f5e38-205">実装できるさまざまなページングインターフェイスがあります。</span><span class="sxs-lookup"><span data-stu-id="f5e38-205">There are a variety of different paging interfaces that can be implemented.</span></span> <span data-ttu-id="f5e38-206">GridView、DetailsView、および FormView コントロールは、次の4つの異なるインターフェイスを使用して選択できます。</span><span class="sxs-lookup"><span data-stu-id="f5e38-206">The GridView, DetailsView, and FormView controls provide four different interfaces to choose among:</span></span>

- <span data-ttu-id="f5e38-207">**次に、前**のユーザーは、一度に1ページずつ移動できます。</span><span class="sxs-lookup"><span data-stu-id="f5e38-207">**Next, Previous** users can move one page at a time, to either the next or previous one.</span></span>
- <span data-ttu-id="f5e38-208">次**に**、[次へ] ボタンと [戻る] ボタンに加えて、このインターフェイスには、最初または最後のページに移動するための最初と最後のボタンが含まれています。</span><span class="sxs-lookup"><span data-stu-id="f5e38-208">**Next, Previous, First, Last** in addition to Next and Previous buttons, this interface includes First and Last buttons for moving to the very first or very last page.</span></span>
- <span data-ttu-id="f5e38-209">**[数値]** ページングインターフェイス内のページ番号を一覧表示し、ユーザーが特定のページにすばやく移動できるようにします。</span><span class="sxs-lookup"><span data-stu-id="f5e38-209">**Numeric** lists the page numbers in the paging interface, allowing a user to quickly jump to a particular page.</span></span>
- <span data-ttu-id="f5e38-210">数値のページ番号に加えて、**最初**または最後のページに移動するためのボタンが含まれています。</span><span class="sxs-lookup"><span data-stu-id="f5e38-210">**Numeric, First, Last** in addition to the numeric page numbers, includes buttons for moving to the very first or very last page.</span></span>

<span data-ttu-id="f5e38-211">DataList と Repeater では、ページングインターフェイスを決定し、実装する責任があります。</span><span class="sxs-lookup"><span data-stu-id="f5e38-211">For the DataList and Repeater, we are responsible for deciding upon a paging interface and implementing it.</span></span> <span data-ttu-id="f5e38-212">これには、ページで必要な Web コントロールを作成し、特定のページングインターフェイスボタンがクリックされたときに要求されたページを表示する作業が含まれます。</span><span class="sxs-lookup"><span data-stu-id="f5e38-212">This involves creating the needed Web controls in the page and displaying the requested page when a particular paging interface button is clicked.</span></span> <span data-ttu-id="f5e38-213">また、特定のページングインターフェイスコントロールを無効にする必要がある場合もあります。</span><span class="sxs-lookup"><span data-stu-id="f5e38-213">Additionally, certain paging interface controls may need to be disabled.</span></span> <span data-ttu-id="f5e38-214">たとえば、Next、Previous、First、Last の各インターフェイスを使用してデータの最初のページを表示すると、最初のボタンと前のボタンの両方が無効になります。</span><span class="sxs-lookup"><span data-stu-id="f5e38-214">For example, when viewing the first page of data using the Next, Previous, First, Last interface, both the First and Previous buttons would be disabled.</span></span>

<span data-ttu-id="f5e38-215">このチュートリアルでは、を使用して、Next、Previous、First、Last の各インターフェイスを使用します。</span><span class="sxs-lookup"><span data-stu-id="f5e38-215">For this tutorial, let s use the Next, Previous, First, Last interface.</span></span> <span data-ttu-id="f5e38-216">4つのボタン Web コントロールをページに追加し、その `ID` を `FirstPage`、`PrevPage`、`NextPage`、`LastPage`に設定します。</span><span class="sxs-lookup"><span data-stu-id="f5e38-216">Add four Button Web controls to the page and set their `ID` s to `FirstPage`, `PrevPage`, `NextPage`, and `LastPage`.</span></span> <span data-ttu-id="f5e38-217">`Text` のプロパティを &lt;&lt; First、&lt; Prev、Next &gt;、および Last &gt;&gt; に設定します。</span><span class="sxs-lookup"><span data-stu-id="f5e38-217">Set the `Text` properties to &lt;&lt; First, &lt; Prev, Next &gt;, and Last &gt;&gt; .</span></span>

[!code-aspx[Main](paging-report-data-in-a-datalist-or-repeater-control-vb/samples/sample4.aspx)]

<span data-ttu-id="f5e38-218">次に、これらの各ボタンの `Click` イベントハンドラーを作成します。</span><span class="sxs-lookup"><span data-stu-id="f5e38-218">Next, create a `Click` event handler for each of these Buttons.</span></span> <span data-ttu-id="f5e38-219">この時点で、要求されたページを表示するために必要なコードを追加します。</span><span class="sxs-lookup"><span data-stu-id="f5e38-219">In a moment we'll add the code necessary to display the requested page.</span></span>

## <a name="remembering-the-total-number-of-records-being-paged-through"></a><span data-ttu-id="f5e38-220">ページングされているレコードの合計数を記憶する</span><span class="sxs-lookup"><span data-stu-id="f5e38-220">Remembering the Total Number of Records Being Paged Through</span></span>

<span data-ttu-id="f5e38-221">選択したページングインターフェイスに関係なく、ページングされているレコードの合計数を計算して記憶する必要があります。</span><span class="sxs-lookup"><span data-stu-id="f5e38-221">Regardless of the paging interface selected, we need to compute and remember the total number of records being paged through.</span></span> <span data-ttu-id="f5e38-222">合計行数 (ページサイズと共に) によって、ページングされるデータの合計ページ数が決まります。これにより、どのページングインターフェイスコントロールが追加または有効になるかが決まります。</span><span class="sxs-lookup"><span data-stu-id="f5e38-222">The total row count (in conjunction with the page size) determines how many total pages of data are being paged through, which determines what paging interface controls are added or are enabled.</span></span> <span data-ttu-id="f5e38-223">次に作成する、最初の、最後のインターフェイスでは、ページ数は2つの方法で使用されます。</span><span class="sxs-lookup"><span data-stu-id="f5e38-223">In the Next, Previous, First, Last interface that we are building, the page count is used in two ways:</span></span>

- <span data-ttu-id="f5e38-224">最後のページを表示しているかどうかを判断するために、[次へ] と [最後] のボタンは無効になっています。</span><span class="sxs-lookup"><span data-stu-id="f5e38-224">To determine whether we are viewing the last page, in which case the Next and Last buttons are disabled.</span></span>
- <span data-ttu-id="f5e38-225">ユーザーが最後のボタンをクリックした場合、最後のページに whisk する必要があります。インデックスはページカウントよりも1小さい値です。</span><span class="sxs-lookup"><span data-stu-id="f5e38-225">If the user clicks the Last button we need to whisk them to the last page, whose index is one less than the page count.</span></span>

<span data-ttu-id="f5e38-226">ページ数は、合計行数がページサイズで割った値として計算されます。</span><span class="sxs-lookup"><span data-stu-id="f5e38-226">The page count is calculated as the ceiling of the total row count divided by the page size.</span></span> <span data-ttu-id="f5e38-227">たとえば、ページごとに4つのレコードを含む79レコードをページングする場合、ページ数は 20 (79/4 の切り上げ) になります。</span><span class="sxs-lookup"><span data-stu-id="f5e38-227">For example, if we are paging through 79 records with four records per page, then the page count is 20 (the ceiling of 79 / 4).</span></span> <span data-ttu-id="f5e38-228">数値ページングインターフェイスを使用している場合、この情報によって、表示する数値ページボタンの数が通知されます。ページングインターフェイスに次のボタンまたは最後のボタンが含まれている場合は、ページ数を使用して、次のボタンまたは最後のボタンをいつ無効にするかを決定します。</span><span class="sxs-lookup"><span data-stu-id="f5e38-228">If we are using the Numeric paging interface, this information informs us as to how many numeric page buttons to display; if our paging interface includes Next or Last buttons, the page count is used to determine when to disable the Next or Last buttons.</span></span>

<span data-ttu-id="f5e38-229">ページングインターフェイスに最後のボタンが含まれている場合は、最後のボタンをクリックしたときに最後のページインデックスを決定できるように、ポストバック間でページングされるレコードの合計数を記憶する必要があります。</span><span class="sxs-lookup"><span data-stu-id="f5e38-229">If the paging interface includes a Last button, it is imperative that the total number of records being paged through be remembered across postbacks so that when the Last button is clicked we can determine the last page index.</span></span> <span data-ttu-id="f5e38-230">これを容易にするには、ASP.NET ページの分離コードクラスで `TotalRowCount` プロパティを作成し、その値をビューステートに永続化します。</span><span class="sxs-lookup"><span data-stu-id="f5e38-230">To facilitate this, create a `TotalRowCount` property in the ASP.NET page s code-behind class that persists its value to view state:</span></span>

[!code-vb[Main](paging-report-data-in-a-datalist-or-repeater-control-vb/samples/sample5.vb)]

<span data-ttu-id="f5e38-231">`TotalRowCount`に加えて、ページインデックス、ページサイズ、およびページ数に簡単にアクセスできるように、読み取り専用のページレベルのプロパティを作成するのに1分かかります。</span><span class="sxs-lookup"><span data-stu-id="f5e38-231">In addition to `TotalRowCount`, take a minute to create read-only page-level properties for easily accessing the page index, page size, and page count:</span></span>

[!code-vb[Main](paging-report-data-in-a-datalist-or-repeater-control-vb/samples/sample6.vb)]

## <a name="determining-the-total-number-of-records-being-paged-through"></a><span data-ttu-id="f5e38-232">ページングされているレコードの合計数を確認する</span><span class="sxs-lookup"><span data-stu-id="f5e38-232">Determining the Total Number of Records Being Paged Through</span></span>

<span data-ttu-id="f5e38-233">ObjectDataSource s `Select()` メソッドから返された `PagedDataSource` オブジェクトは、それらのサブセットだけが DataList に表示される場合でも、*すべて*の製品レコードに含まれます。</span><span class="sxs-lookup"><span data-stu-id="f5e38-233">The `PagedDataSource` object returned from the ObjectDataSource s `Select()` method has within it *all* of the product records, even though only a subset of them are displayed in the DataList.</span></span> <span data-ttu-id="f5e38-234">`PagedDataSource` s [`Count` プロパティ](https://msdn.microsoft.com/library/system.web.ui.webcontrols.pageddatasource.count.aspx)は、DataList に表示される項目の数のみを返します。[`DataSourceCount` プロパティ](https://msdn.microsoft.com/library/system.web.ui.webcontrols.pageddatasource.datasourcecount.aspx)は、`PagedDataSource`内の項目の合計数を返します。</span><span class="sxs-lookup"><span data-stu-id="f5e38-234">The `PagedDataSource` s [`Count` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.pageddatasource.count.aspx) returns only the number of items that will be displayed in the DataList; the [`DataSourceCount` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.pageddatasource.datasourcecount.aspx) returns the total number of items within the `PagedDataSource`.</span></span> <span data-ttu-id="f5e38-235">したがって、ASP.NET page s `TotalRowCount` プロパティ `PagedDataSource` s `DataSourceCount` プロパティの値を割り当てる必要があります。</span><span class="sxs-lookup"><span data-stu-id="f5e38-235">Therefore, we need to assign the ASP.NET page s `TotalRowCount` property the value of the `PagedDataSource` s `DataSourceCount` property.</span></span>

<span data-ttu-id="f5e38-236">これを実現するには、ObjectDataSource s `Selected` イベントのイベントハンドラーを作成します。</span><span class="sxs-lookup"><span data-stu-id="f5e38-236">To accomplish this, create an event handler for the ObjectDataSource s `Selected` event.</span></span> <span data-ttu-id="f5e38-237">`Selected` イベントハンドラーでは、ObjectDataSource s `Select()` メソッドの戻り値 (この場合は `PagedDataSource`) にアクセスできます。</span><span class="sxs-lookup"><span data-stu-id="f5e38-237">In the `Selected` event handler we have access to the return value of the ObjectDataSource s `Select()` method in this case, the `PagedDataSource`.</span></span>

[!code-vb[Main](paging-report-data-in-a-datalist-or-repeater-control-vb/samples/sample7.vb)]

## <a name="displaying-the-requested-page-of-data"></a><span data-ttu-id="f5e38-238">要求されたデータページの表示</span><span class="sxs-lookup"><span data-stu-id="f5e38-238">Displaying the Requested Page of Data</span></span>

<span data-ttu-id="f5e38-239">ユーザーがページングインターフェイスのボタンのいずれかをクリックすると、要求されたデータページを表示する必要があります。</span><span class="sxs-lookup"><span data-stu-id="f5e38-239">When the user clicks one of the buttons in the paging interface, we need to display the requested page of data.</span></span> <span data-ttu-id="f5e38-240">ページングパラメーターはクエリ文字列を介して指定されるため、要求されたデータページを表示するには `Response.Redirect(url)` 使用して、ユーザーのブラウザーが `Paging.aspx` ページに適切なページングパラメーターを再要求します。</span><span class="sxs-lookup"><span data-stu-id="f5e38-240">Since the paging parameters are specified via the querystring, to show the requested page of data use `Response.Redirect(url)` to have the user s browser re-request the `Paging.aspx` page with the appropriate paging parameters.</span></span> <span data-ttu-id="f5e38-241">たとえば、データの2ページ目を表示するには、ユーザーを `Paging.aspx?pageIndex=1`にリダイレクトします。</span><span class="sxs-lookup"><span data-stu-id="f5e38-241">For example, to display the second page of data, we would redirect the user to `Paging.aspx?pageIndex=1`.</span></span>

<span data-ttu-id="f5e38-242">これを容易にするには、ユーザーを `Paging.aspx?pageIndex=sendUserToPageIndex`にリダイレクトする `RedirectUser(sendUserToPageIndex)` メソッドを作成します。</span><span class="sxs-lookup"><span data-stu-id="f5e38-242">To facilitate this, create a `RedirectUser(sendUserToPageIndex)` method that redirects the user to `Paging.aspx?pageIndex=sendUserToPageIndex`.</span></span> <span data-ttu-id="f5e38-243">次に、4つのボタン `Click` イベントハンドラーからこのメソッドを呼び出します。</span><span class="sxs-lookup"><span data-stu-id="f5e38-243">Then, call this method from the four Button `Click` event handlers.</span></span> <span data-ttu-id="f5e38-244">`FirstPage` `Click` イベントハンドラーで `RedirectUser(0)`を呼び出して、最初のページに送信します。`PrevPage` `Click` イベントハンドラーで、ページインデックスとして `PageIndex - 1` を使用します。などなど。</span><span class="sxs-lookup"><span data-stu-id="f5e38-244">In the `FirstPage` `Click` event handler, call `RedirectUser(0)`, to send them to the first page; in the `PrevPage` `Click` event handler, use `PageIndex - 1` as the page index; and so on.</span></span>

[!code-vb[Main](paging-report-data-in-a-datalist-or-repeater-control-vb/samples/sample8.vb)]

<span data-ttu-id="f5e38-245">`Click` イベントハンドラーが完了したら、ボタンをクリックすることで、DataList s レコードをページングできます。</span><span class="sxs-lookup"><span data-stu-id="f5e38-245">With the `Click` event handlers complete, the DataList s records can be paged through by clicking the buttons.</span></span> <span data-ttu-id="f5e38-246">試してみてください。</span><span class="sxs-lookup"><span data-stu-id="f5e38-246">Take a moment to try it out!</span></span>

## <a name="disabling-paging-interface-controls"></a><span data-ttu-id="f5e38-247">無効化 (ページングインターフェイスコントロールを)</span><span class="sxs-lookup"><span data-stu-id="f5e38-247">Disabling Paging Interface Controls</span></span>

<span data-ttu-id="f5e38-248">現在、4つのボタンはすべて、表示されているページに関係なく有効になっています。</span><span class="sxs-lookup"><span data-stu-id="f5e38-248">Currently, all four buttons are enabled regardless of the page being viewed.</span></span> <span data-ttu-id="f5e38-249">ただし、データの最初のページを表示するときに、最初のボタンと前のボタンを無効にし、最後のページを表示するときに [次へ] と [最後] のボタンを無効にする必要があります。</span><span class="sxs-lookup"><span data-stu-id="f5e38-249">However, we want to disable the First and Previous buttons when showing the first page of data, and the Next and Last buttons when showing the last page.</span></span> <span data-ttu-id="f5e38-250">ObjectDataSource s `Select()` メソッドによって返される `PagedDataSource` オブジェクトには、データの最初または最後のページを表示しているかどうかを確認するために確認できるプロパティ[`IsFirstPage`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.pageddatasource.isfirstpage.aspx)および[`IsLastPage`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.pageddatasource.islastpage.aspx)があります。</span><span class="sxs-lookup"><span data-stu-id="f5e38-250">The `PagedDataSource` object returned by the ObjectDataSource s `Select()` method has properties [`IsFirstPage`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.pageddatasource.isfirstpage.aspx) and [`IsLastPage`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.pageddatasource.islastpage.aspx) that we can examine to determine if we are viewing the first or last page of data.</span></span>

<span data-ttu-id="f5e38-251">ObjectDataSource s `Selected` イベントハンドラーに次のを追加します。</span><span class="sxs-lookup"><span data-stu-id="f5e38-251">Add the following to the ObjectDataSource s `Selected` event handler:</span></span>

[!code-vb[Main](paging-report-data-in-a-datalist-or-repeater-control-vb/samples/sample9.vb)]

<span data-ttu-id="f5e38-252">この追加により、最初のページを表示しているときに、最初のボタンと前のボタンが無効になります。最後のページを表示すると、[次へ] ボタンと [最後のボタン] は無効になります。</span><span class="sxs-lookup"><span data-stu-id="f5e38-252">With this addition, the First and Previous buttons will be disabled when viewing the first page, while the Next and Last buttons will be disabled when viewing the last page.</span></span>

<span data-ttu-id="f5e38-253">現在表示しているページと合計ページ数をユーザーに通知して、ページングインターフェイスを完成させます。</span><span class="sxs-lookup"><span data-stu-id="f5e38-253">Let s complete the paging interface by informing the user what page they re currently viewing and how many total pages exist.</span></span> <span data-ttu-id="f5e38-254">ページにラベル Web コントロールを追加し、その `ID` プロパティを `CurrentPageNumber`に設定します。</span><span class="sxs-lookup"><span data-stu-id="f5e38-254">Add a Label Web control to the page and set its `ID` property to `CurrentPageNumber`.</span></span> <span data-ttu-id="f5e38-255">ObjectDataSource s 選択イベントハンドラーで `Text` プロパティを設定します。これにより、現在表示されているページ (`PageIndex + 1`) と総ページ数 (`PageCount`) が含まれるようになります。</span><span class="sxs-lookup"><span data-stu-id="f5e38-255">Set its `Text` property in the ObjectDataSource s Selected event handler such that it includes the current page being viewed (`PageIndex + 1`) and the total number of pages (`PageCount`).</span></span>

[!code-vb[Main](paging-report-data-in-a-datalist-or-repeater-control-vb/samples/sample10.vb)]

<span data-ttu-id="f5e38-256">図10に、最初にアクセスしたときの `Paging.aspx` を示します。</span><span class="sxs-lookup"><span data-stu-id="f5e38-256">Figure 10 shows `Paging.aspx` when first visited.</span></span> <span data-ttu-id="f5e38-257">Querystring は空であるため、DataList は既定で最初の4つの製品を表示します。最初のボタンと前のボタンは無効になっています。</span><span class="sxs-lookup"><span data-stu-id="f5e38-257">Since the querystring is empty, the DataList defaults to showing the first four products; the First and Previous buttons are disabled.</span></span> <span data-ttu-id="f5e38-258">[次へ] をクリックすると、次の4つのレコードが表示されます (図11を参照)。1つ目と前のボタンが有効になります。</span><span class="sxs-lookup"><span data-stu-id="f5e38-258">Clicking Next displays the next four records (see Figure 11); the First and Previous buttons are now enabled.</span></span>

<span data-ttu-id="f5e38-259">[データの最初のページが表示される ![](paging-report-data-in-a-datalist-or-repeater-control-vb/_static/image23.png)](paging-report-data-in-a-datalist-or-repeater-control-vb/_static/image22.png)</span><span class="sxs-lookup"><span data-stu-id="f5e38-259">[![The First Page of Data is Displayed](paging-report-data-in-a-datalist-or-repeater-control-vb/_static/image23.png)](paging-report-data-in-a-datalist-or-repeater-control-vb/_static/image22.png)</span></span>

<span data-ttu-id="f5e38-260">**図 10**: データの最初のページが表示される ([クリックすると、フルサイズの画像が表示](paging-report-data-in-a-datalist-or-repeater-control-vb/_static/image24.png)されます)</span><span class="sxs-lookup"><span data-stu-id="f5e38-260">**Figure 10**: The First Page of Data is Displayed ([Click to view full-size image](paging-report-data-in-a-datalist-or-repeater-control-vb/_static/image24.png))</span></span>

<span data-ttu-id="f5e38-261">[![データの2ページ目が表示されます。](paging-report-data-in-a-datalist-or-repeater-control-vb/_static/image26.png)](paging-report-data-in-a-datalist-or-repeater-control-vb/_static/image25.png)</span><span class="sxs-lookup"><span data-stu-id="f5e38-261">[![The Second Page of Data is Displayed](paging-report-data-in-a-datalist-or-repeater-control-vb/_static/image26.png)](paging-report-data-in-a-datalist-or-repeater-control-vb/_static/image25.png)</span></span>

<span data-ttu-id="f5e38-262">**図 11**: データの2番目のページが表示される ([クリックすると、フルサイズの画像が表示](paging-report-data-in-a-datalist-or-repeater-control-vb/_static/image27.png)されます)</span><span class="sxs-lookup"><span data-stu-id="f5e38-262">**Figure 11**: The Second Page of Data is Displayed ([Click to view full-size image](paging-report-data-in-a-datalist-or-repeater-control-vb/_static/image27.png))</span></span>

> [!NOTE]
> <span data-ttu-id="f5e38-263">ページングインターフェイスをさらに拡張するには、ユーザーがページごとに表示するページ数を指定できるようにします。</span><span class="sxs-lookup"><span data-stu-id="f5e38-263">The paging interface can be further enhanced by allowing the user to specify how many pages to view per page.</span></span> <span data-ttu-id="f5e38-264">たとえば、"5"、"10"、"25"、"50"、"すべて" のようなページサイズオプションを追加できます。</span><span class="sxs-lookup"><span data-stu-id="f5e38-264">For example, a DropDownList could be added listing page size options like 5, 10, 25, 50, and All.</span></span> <span data-ttu-id="f5e38-265">ページサイズを選択するときは、ユーザーを `Paging.aspx?pageIndex=0&pageSize=selectedPageSize`にリダイレクトする必要があります。</span><span class="sxs-lookup"><span data-stu-id="f5e38-265">Upon selecting a page size, the user would need to be redirected back to `Paging.aspx?pageIndex=0&pageSize=selectedPageSize`.</span></span> <span data-ttu-id="f5e38-266">この拡張機能の実装は、リーダーの演習として行っています。</span><span class="sxs-lookup"><span data-stu-id="f5e38-266">I leave implementing this enhancement as an exercise for the reader.</span></span>

## <a name="using-custom-paging"></a><span data-ttu-id="f5e38-267">カスタムページングの使用</span><span class="sxs-lookup"><span data-stu-id="f5e38-267">Using Custom Paging</span></span>

<span data-ttu-id="f5e38-268">DataList ページは、非効率的な既定のページング手法を使用してデータを処理します。</span><span class="sxs-lookup"><span data-stu-id="f5e38-268">The DataList pages through its data using the inefficient default paging technique.</span></span> <span data-ttu-id="f5e38-269">大量のデータをページングする場合は、カスタムページングを使用する必要があります。</span><span class="sxs-lookup"><span data-stu-id="f5e38-269">When paging through sufficiently large amounts of data, it is imperative that custom paging be used.</span></span> <span data-ttu-id="f5e38-270">実装の詳細は若干異なりますが、DataList でのカスタムページングの実装の背後にある概念は、既定のページングの場合と同じです。</span><span class="sxs-lookup"><span data-stu-id="f5e38-270">Although the implementation details differ slightly, the concepts behind implementing custom paging in a DataList are the same as with default paging.</span></span> <span data-ttu-id="f5e38-271">カスタムページングを使用する場合は、`ProductBLL` クラス s `GetProductsPaged` メソッド (`GetProductsAsPagedDataSource`ではなく) を使用します。</span><span class="sxs-lookup"><span data-stu-id="f5e38-271">With custom paging, use the `ProductBLL` class s `GetProductsPaged` method (instead of `GetProductsAsPagedDataSource`).</span></span> <span data-ttu-id="f5e38-272">「[大量のデータを使用](../paging-and-sorting/efficiently-paging-through-large-amounts-of-data-vb.md)した効率的なページング」で説明されているように、`GetProductsPaged` には、開始行インデックスと返される最大行数を渡す必要があります。</span><span class="sxs-lookup"><span data-stu-id="f5e38-272">As discussed in the [Efficiently Paging Through Large Amounts of Data](../paging-and-sorting/efficiently-paging-through-large-amounts-of-data-vb.md) tutorial, `GetProductsPaged` must be passed the start row index and maximum number of rows to return.</span></span> <span data-ttu-id="f5e38-273">これらのパラメーターは、既定のページングで使用される `pageIndex` や `pageSize` パラメーターと同様に、querystring を使用して管理できます。</span><span class="sxs-lookup"><span data-stu-id="f5e38-273">These parameters can be maintained through the querystring just like the `pageIndex` and `pageSize` parameters used in default paging.</span></span>

<span data-ttu-id="f5e38-274">カスタムページングを使用した `PagedDataSource` はないため、ページングされるレコードの合計数と、データの最初または最後のページを表示するかどうかを決定するために、代替手法を使用する必要があります。</span><span class="sxs-lookup"><span data-stu-id="f5e38-274">Since there s no `PagedDataSource` with custom paging, alternative techniques must be used to determine the total number of records being paged through and whether we re displaying the first or last page of data.</span></span> <span data-ttu-id="f5e38-275">`ProductsBLL` クラスの `TotalNumberOfProducts()` メソッドは、ページングされている製品の合計数を返します。</span><span class="sxs-lookup"><span data-stu-id="f5e38-275">The `TotalNumberOfProducts()` method in the `ProductsBLL` class returns the total number of products being paged through.</span></span> <span data-ttu-id="f5e38-276">データの最初のページが表示されているかどうかを調べるには、開始行のインデックスが0の場合は、最初のページが表示されていることを確認します。</span><span class="sxs-lookup"><span data-stu-id="f5e38-276">To determine if the first page of data is being viewed, examine the start row index if it is zero, then the first page is being viewed.</span></span> <span data-ttu-id="f5e38-277">先頭行のインデックスと返される最大行数が、ページングされているレコードの合計数以上の場合、最後のページが表示されます。</span><span class="sxs-lookup"><span data-stu-id="f5e38-277">The last page is being viewed if the start row index plus the maximum rows to return is greater than or equal to the total number of records being paged through.</span></span>

<span data-ttu-id="f5e38-278">カスタムページングの実装については、次のチュートリアルでさらに詳しく説明します。</span><span class="sxs-lookup"><span data-stu-id="f5e38-278">We'll explore implementing custom paging in greater detail in the next tutorial.</span></span>

## <a name="summary"></a><span data-ttu-id="f5e38-279">要約</span><span class="sxs-lookup"><span data-stu-id="f5e38-279">Summary</span></span>

<span data-ttu-id="f5e38-280">DataList も Repeater も、GridView、DetailsView、FormView コントロールで検出されたインボックスページングサポートを提供しませんが、このような機能は最小限の労力で追加できます。</span><span class="sxs-lookup"><span data-stu-id="f5e38-280">While neither the DataList nor Repeater offers the out of the box paging support found in the GridView, DetailsView, and FormView controls, such functionality can be added with minimal effort.</span></span> <span data-ttu-id="f5e38-281">既定のページングを実装する最も簡単な方法は、`PagedDataSource` 内で製品セット全体をラップし、その `PagedDataSource` を DataList または Repeater にバインドすることです。</span><span class="sxs-lookup"><span data-stu-id="f5e38-281">The easiest way to implement default paging is to wrap the entire set of products within a `PagedDataSource` and then bind the `PagedDataSource` to the DataList or Repeater.</span></span> <span data-ttu-id="f5e38-282">このチュートリアルでは、`PagedDataSource`を返すために、`ProductsBLL` クラスに `GetProductsAsPagedDataSource` メソッドを追加しました。</span><span class="sxs-lookup"><span data-stu-id="f5e38-282">In this tutorial we added the `GetProductsAsPagedDataSource` method to the `ProductsBLL` class to return the `PagedDataSource`.</span></span> <span data-ttu-id="f5e38-283">`ProductsBLL` クラスには、カスタムページング `GetProductsPaged` と `TotalNumberOfProducts`に必要なメソッドが既に含まれています。</span><span class="sxs-lookup"><span data-stu-id="f5e38-283">The `ProductsBLL` class already contains the methods needed for custom paging `GetProductsPaged` and `TotalNumberOfProducts`.</span></span>

<span data-ttu-id="f5e38-284">既定のページングのために、カスタムページングまたは `PagedDataSource` 内のすべてのレコードについて表示する正確なレコードセットを取得すると共に、ページングインターフェイスを手動で追加する必要もあります。</span><span class="sxs-lookup"><span data-stu-id="f5e38-284">Along with retrieving either the precise set of records to display for custom paging or all records in a `PagedDataSource` for default paging, we also need to manually add the paging interface.</span></span> <span data-ttu-id="f5e38-285">このチュートリアルでは、4つのボタン Web コントロールを使用して、Next、Previous、First、Last の各インターフェイスを作成しました。</span><span class="sxs-lookup"><span data-stu-id="f5e38-285">For this tutorial we created a Next, Previous, First, Last interface with four Button Web controls.</span></span> <span data-ttu-id="f5e38-286">また、現在のページ番号と合計ページ数を表示するラベルコントロールも追加されました。</span><span class="sxs-lookup"><span data-stu-id="f5e38-286">Also, a Label control displaying the current page number and total number of pages was added.</span></span>

<span data-ttu-id="f5e38-287">次のチュートリアルでは、DataList と Repeater に並べ替えサポートを追加する方法について説明します。</span><span class="sxs-lookup"><span data-stu-id="f5e38-287">In the next tutorial we'll see how to add sorting support to the DataList and Repeater.</span></span> <span data-ttu-id="f5e38-288">また、ページングと並べ替えの両方が可能な DataList を作成する方法についても説明します (既定のページングとカスタムページングを使用した例を参照)。</span><span class="sxs-lookup"><span data-stu-id="f5e38-288">We'll also see how to create a DataList that can be both paged and sorted (with examples using default and custom paging).</span></span>

<span data-ttu-id="f5e38-289">プログラミングを楽しんでください。</span><span class="sxs-lookup"><span data-stu-id="f5e38-289">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="f5e38-290">作成者について</span><span class="sxs-lookup"><span data-stu-id="f5e38-290">About the Author</span></span>

<span data-ttu-id="f5e38-291">1998以来、 [Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml)は 7 asp/創設者 of [4GuysFromRolla.com](http://www.4guysfromrolla.com)の執筆者であり、Microsoft Web テクノロジを使用しています。</span><span class="sxs-lookup"><span data-stu-id="f5e38-291">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="f5e38-292">Scott は、独立したコンサルタント、トレーナー、およびライターとして機能します。</span><span class="sxs-lookup"><span data-stu-id="f5e38-292">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="f5e38-293">彼の最新の書籍は[ *、ASP.NET 2.0 を24時間以内に教え*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)ています。</span><span class="sxs-lookup"><span data-stu-id="f5e38-293">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="f5e38-294">mitchell@4GuysFromRolla.comでアクセスでき[ます。](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="f5e38-294">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="f5e38-295">または彼のブログを参照してください。これは[http://ScottOnWriting.NET](http://ScottOnWriting.NET)にあります。</span><span class="sxs-lookup"><span data-stu-id="f5e38-295">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="f5e38-296">ありがとうございました。</span><span class="sxs-lookup"><span data-stu-id="f5e38-296">Special Thanks To</span></span>

<span data-ttu-id="f5e38-297">このチュートリアルシリーズは、役に立つ多くのレビュー担当者によってレビューされました。</span><span class="sxs-lookup"><span data-stu-id="f5e38-297">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="f5e38-298">このチュートリアルのリードレビュー担当者は、Liz Shulok、Ken p Isa、および Bernadette Leigh でした。</span><span class="sxs-lookup"><span data-stu-id="f5e38-298">Lead reviewers for this tutorial were Liz Shulok, Ken Pespisa, and Bernadette Leigh.</span></span> <span data-ttu-id="f5e38-299">今後の MSDN 記事を確認することに興味がありますか?</span><span class="sxs-lookup"><span data-stu-id="f5e38-299">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="f5e38-300">その場合は、mitchell@4GuysFromRolla.comの行を削除[します。](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="f5e38-300">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="f5e38-301">[前へ](sorting-data-in-a-datalist-or-repeater-control-cs.md)
> [次へ](sorting-data-in-a-datalist-or-repeater-control-vb.md)</span><span class="sxs-lookup"><span data-stu-id="f5e38-301">[Previous](sorting-data-in-a-datalist-or-repeater-control-cs.md)
[Next](sorting-data-in-a-datalist-or-repeater-control-vb.md)</span></span>

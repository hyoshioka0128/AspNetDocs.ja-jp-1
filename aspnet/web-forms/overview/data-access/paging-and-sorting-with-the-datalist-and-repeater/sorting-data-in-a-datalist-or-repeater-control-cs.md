---
uid: web-forms/overview/data-access/paging-and-sorting-with-the-datalist-and-repeater/sorting-data-in-a-datalist-or-repeater-control-cs
title: DataList または Repeater コントロール (c#) データを並べ替える |Microsoft Docs
author: rick-anderson
description: このチュートリアルでは並べ替えを DataList と Repeater、サポートを含める方法と、データが含まれることができます、DataList または Repeater を構築する方法について説明します.
ms.author: riande
ms.date: 11/13/2006
ms.assetid: f52c302a-1b7c-46fe-8a13-8412c95cbf6d
msc.legacyurl: /web-forms/overview/data-access/paging-and-sorting-with-the-datalist-and-repeater/sorting-data-in-a-datalist-or-repeater-control-cs
msc.type: authoredcontent
ms.openlocfilehash: e3512758dbfdf43d788eca643fe48ca918c142fe
ms.sourcegitcommit: 51b01b6ff8edde57d8243e4da28c9f1e7f1962b2
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 05/06/2019
ms.locfileid: "65128061"
---
# <a name="sorting-data-in-a-datalist-or-repeater-control-c"></a><span data-ttu-id="1d7ed-103">DataList または Repeater コントロールのデータを並べ替える (C#)</span><span class="sxs-lookup"><span data-stu-id="1d7ed-103">Sorting Data in a DataList or Repeater Control (C#)</span></span>

<span data-ttu-id="1d7ed-104">によって[Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="1d7ed-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="1d7ed-105">[サンプル アプリをダウンロード](http://download.microsoft.com/download/4/a/7/4a7a3b18-d80e-4014-8e53-a6a2427f0d93/ASPNET_Data_Tutorial_45_CS.exe)または[PDF のダウンロード](sorting-data-in-a-datalist-or-repeater-control-cs/_static/datatutorial45cs1.pdf)</span><span class="sxs-lookup"><span data-stu-id="1d7ed-105">[Download Sample App](http://download.microsoft.com/download/4/a/7/4a7a3b18-d80e-4014-8e53-a6a2427f0d93/ASPNET_Data_Tutorial_45_CS.exe) or [Download PDF](sorting-data-in-a-datalist-or-repeater-control-cs/_static/datatutorial45cs1.pdf)</span></span>

> <span data-ttu-id="1d7ed-106">このチュートリアルでは、ここに並べ替えを DataList と Repeater、サポートを含める方法と、DataList または Repeater データのページングし、並べ替えできますを構築する方法について説明します。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-106">In this tutorial we'll examine how to include sorting support in the DataList and Repeater, as well as how to construct a DataList or Repeater whose data can be paged and sorted.</span></span>

## <a name="introduction"></a><span data-ttu-id="1d7ed-107">はじめに</span><span class="sxs-lookup"><span data-stu-id="1d7ed-107">Introduction</span></span>

<span data-ttu-id="1d7ed-108">[前のチュートリアル](paging-report-data-in-a-datalist-or-repeater-control-cs.md)DataList にページング サポートを追加する方法について確認しました。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-108">In the [previous tutorial](paging-report-data-in-a-datalist-or-repeater-control-cs.md) we examined how to add paging support to a DataList.</span></span> <span data-ttu-id="1d7ed-109">新しいメソッドを作成した、`ProductsBLL`クラス (`GetProductsAsPagedDataSource`) 返される、`PagedDataSource`オブジェクト。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-109">We created a new method in the `ProductsBLL` class (`GetProductsAsPagedDataSource`) that returned a `PagedDataSource` object.</span></span> <span data-ttu-id="1d7ed-110">DataList または Repeater にバインドするとき、DataList または Repeater は、データの要求されたページだけが表示されます。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-110">When bound to a DataList or Repeater, the DataList or Repeater would display just the requested page of data.</span></span> <span data-ttu-id="1d7ed-111">この手法は、組み込みの既定のページング機能を提供する GridView、DetailsView、FormView コントロールによって内部的にどのような使用に似ています。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-111">This technique is similar to what is used internally by the GridView, DetailsView, and FormView controls to provide their built-in default paging functionality.</span></span>

<span data-ttu-id="1d7ed-112">ページング サポートを提供するだけでなく、GridView は並べ替えをサポートするボックスも含まれます。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-112">In addition to offering paging support, the GridView also includes out of the box sorting support.</span></span> <span data-ttu-id="1d7ed-113">DataList と Repeater のどちらも、組み込みの並べ替え機能を提供します。ただし、少しのコードには、並べ替え機能を追加できます。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-113">Neither the DataList nor Repeater provides built-in sorting functionality; however, sorting features can be added with a bit of code.</span></span> <span data-ttu-id="1d7ed-114">このチュートリアルでは、ここに並べ替えを DataList と Repeater、サポートを含める方法と、DataList または Repeater データのページングし、並べ替えできますを構築する方法について説明します。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-114">In this tutorial we'll examine how to include sorting support in the DataList and Repeater, as well as how to construct a DataList or Repeater whose data can be paged and sorted.</span></span>

## <a name="a-review-of-sorting"></a><span data-ttu-id="1d7ed-115">並べ替えのレビュー</span><span class="sxs-lookup"><span data-stu-id="1d7ed-115">A Review of Sorting</span></span>

<span data-ttu-id="1d7ed-116">説明したように、[レポート データの並べ替えとページング](../paging-and-sorting/paging-and-sorting-report-data-cs.md)チュートリアルでは、並べ替えをサポートなし、GridView コントロールを提供します。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-116">As we saw in the [Paging and Sorting Report Data](../paging-and-sorting/paging-and-sorting-report-data-cs.md) tutorial, the GridView control provides out of the box sorting support.</span></span> <span data-ttu-id="1d7ed-117">GridView の各フィールドが関連付けられていることができますが`SortExpression`データの並べ替えに使用するデータ フィールドを示します。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-117">Each GridView field can have an associated `SortExpression`, which indicates the data field by which to sort the data.</span></span> <span data-ttu-id="1d7ed-118">ときに GridView s`AllowSorting`プロパティに設定されて`true`、各 GridView フィールドを持つ、`SortExpression`プロパティ値は、ヘッダー、LinkButton としてレンダリングされます。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-118">When the GridView s `AllowSorting` property is set to `true`, each GridView field that has a `SortExpression` property value has its header rendered as a LinkButton.</span></span> <span data-ttu-id="1d7ed-119">ユーザーには、特定の GridView フィールドのヘッダーがクリックすると、ポストバックが発生し、データがクリックされたフィールド s に従って並び替え`SortExpression`します。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-119">When a user clicks a particular GridView field s header, a postback occurs and the data is sorted according to the clicked field s `SortExpression`.</span></span>

<span data-ttu-id="1d7ed-120">GridView コントロールは、`SortExpression`プロパティも、格納、`SortExpression`で GridView フィールドのデータが並べ替えられます。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-120">The GridView control has a `SortExpression` property as well, which stores the `SortExpression` of the GridView field the data is sorted by.</span></span> <span data-ttu-id="1d7ed-121">さらに、`SortDirection`プロパティは、データが昇順または降順 (場合連続して、並べ替え順序で 2 回特定 GridView フィールドのヘッダー リンクが切り替えられたユーザーのクリック) の順序で並べ替えられるかどうかを示します。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-121">Additionally, a `SortDirection` property indicates whether the data is to be sorted in ascending or descending order (if a user clicks a particular GridView field s header link twice in succession, the sort order is toggled).</span></span>

<span data-ttu-id="1d7ed-122">渡す、GridView がそのデータ ソース コントロールにバインドされると、その`SortExpression`と`SortDirection`プロパティをデータ ソース コントロール。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-122">When the GridView is bound to its data source control, it hands off its `SortExpression` and `SortDirection` properties to the data source control.</span></span> <span data-ttu-id="1d7ed-123">データ ソース コントロールがデータを取得し、指定に従って並べ替えられます`SortExpression`と`SortDirection`プロパティ。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-123">The data source control retrieves the data and then sorts it according to the supplied `SortExpression` and `SortDirection` properties.</span></span> <span data-ttu-id="1d7ed-124">データの並べ替えの後、データ ソース コントロールは、それを GridView に返します。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-124">After sorting the data, the data source control returns it to the GridView.</span></span>

<span data-ttu-id="1d7ed-125">DataList または Repeater コントロールでのこの機能をレプリケートするには、必要があります。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-125">To replicate this functionality with the DataList or Repeater controls, we must:</span></span>

- <span data-ttu-id="1d7ed-126">並べ替えのインターフェイスを作成します。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-126">Create a sorting interface</span></span>
- <span data-ttu-id="1d7ed-127">データ フィールドを並べ替えるには、昇順または降順で並べ替えるかどうかに注意してください。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-127">Remember the data field to sort by and whether to sort in ascending or descending order</span></span>
- <span data-ttu-id="1d7ed-128">特定のデータ フィールドでデータを並べ替える ObjectDataSource を指示します。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-128">Instruct the ObjectDataSource to sort the data by a particular data field</span></span>

<span data-ttu-id="1d7ed-129">手順 3 と 4 でこれらの 3 つのタスクに取り組むします。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-129">We'll tackle these three tasks in steps 3 and 4.</span></span> <span data-ttu-id="1d7ed-130">次に、ページングと並べ替えを DataList または Repeater のサポートの両方を含める方法を説明します。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-130">Following that, we'll examine how to include both paging and sorting support in a DataList or Repeater.</span></span>

## <a name="step-2-displaying-the-products-in-a-repeater"></a><span data-ttu-id="1d7ed-131">手順 2: Repeater で製品を表示します。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-131">Step 2: Displaying the Products in a Repeater</span></span>

<span data-ttu-id="1d7ed-132">並べ替え関連の機能のいずれかの実装について気にし、前に、s を Repeater コントロールでは、製品の一覧を表示して起動を使用できます。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-132">Before we worry about implementing any of the sorting-related functionality, let s start by listing the products in a Repeater control.</span></span> <span data-ttu-id="1d7ed-133">開いて開始、`Sorting.aspx`ページで、`PagingSortingDataListRepeater`フォルダー。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-133">Start by opening the `Sorting.aspx` page in the `PagingSortingDataListRepeater` folder.</span></span> <span data-ttu-id="1d7ed-134">Repeater コントロールを追加、web ページで、設定をその`ID`プロパティを`SortableProducts`します。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-134">Add a Repeater control to the web page, setting its `ID` property to `SortableProducts`.</span></span> <span data-ttu-id="1d7ed-135">Repeater s のスマート タグからの作成という名前の新しい ObjectDataSource`ProductsDataSource`からデータを取得するように構成し、`ProductsBLL`クラスの`GetProducts()`メソッド。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-135">From the Repeater s smart tag, create a new ObjectDataSource named `ProductsDataSource` and configure it to retrieve data from the `ProductsBLL` class s `GetProducts()` method.</span></span> <span data-ttu-id="1d7ed-136">INSERT、UPDATE、および DELETE の各タブで、ドロップダウン リストから (なし) オプションを選択します。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-136">Select the (None) option from the drop-down lists in the INSERT, UPDATE, and DELETE tabs.</span></span>

<span data-ttu-id="1d7ed-137">[![ObjectDataSource を作成し、GetProductsAsPagedDataSource() メソッドを使用するように構成します。](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image2.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="1d7ed-137">[![Create an ObjectDataSource and Configure it to Use the GetProductsAsPagedDataSource() Method](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image2.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image1.png)</span></span>

<span data-ttu-id="1d7ed-138">**図 1**:ObjectDataSource を作成し、使用するように構成、`GetProductsAsPagedDataSource()`メソッド ([フルサイズの画像を表示する をクリックします](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image3.png))。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-138">**Figure 1**: Create an ObjectDataSource and Configure it to Use the `GetProductsAsPagedDataSource()` Method ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image3.png))</span></span>

<span data-ttu-id="1d7ed-139">[![UPDATE、INSERT で、ドロップダウン リストを設定し、(なし) タブを削除します。](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image5.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="1d7ed-139">[![Set the Drop-Down Lists in the UPDATE, INSERT, and DELETE tabs to (None)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image5.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image4.png)</span></span>

<span data-ttu-id="1d7ed-140">**図 2**:UPDATE、INSERT で、ドロップダウン リストを設定し、[(なし) タブを削除する ([フルサイズの画像を表示する] をクリックします](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image6.png))。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-140">**Figure 2**: Set the Drop-Down Lists in the UPDATE, INSERT, and DELETE tabs to (None) ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image6.png))</span></span>

<span data-ttu-id="1d7ed-141">異なり、DataList で Visual Studio は自動的に作成されません、`ItemTemplate`データ ソースにバインドした後、Repeater コントロール。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-141">Unlike with the DataList, Visual Studio does not automatically create an `ItemTemplate` for the Repeater control after binding it to a data source.</span></span> <span data-ttu-id="1d7ed-142">さらに、これを追加します`ItemTemplate`宣言に、Repeater コントロールのスマート タグ DataList s であるテンプレートの編集オプションが不足しています。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-142">Furthermore, we must add this `ItemTemplate` declaratively, as the Repeater control s smart tag lacks the Edit Templates option found in the DataList s.</span></span> <span data-ttu-id="1d7ed-143">Let s を使用して同じ`ItemTemplate`s の製品名、供給業者、およびカテゴリに表示される前のチュートリアルから。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-143">Let s use the same `ItemTemplate` from the previous tutorial, which displayed the product s name, supplier, and category.</span></span>

<span data-ttu-id="1d7ed-144">追加した後、 `ItemTemplate`Repeater、ObjectDataSource s 宣言型マークアップは、次のようになります。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-144">After adding the `ItemTemplate`, the Repeater and ObjectDataSource s declarative markup should look similar to the following:</span></span>

[!code-aspx[Main](sorting-data-in-a-datalist-or-repeater-control-cs/samples/sample1.aspx)]

<span data-ttu-id="1d7ed-145">図 3 は、ブラウザーで表示した場合は、このページを示します。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-145">Figure 3 shows this page when viewed through a browser.</span></span>

<span data-ttu-id="1d7ed-146">[![各製品の名前、供給業者、およびカテゴリが表示されます。](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image8.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="1d7ed-146">[![Each Product s Name, Supplier, and Category is Displayed](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image8.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image7.png)</span></span>

<span data-ttu-id="1d7ed-147">**図 3**:各製品名、供給業者、およびカテゴリが表示されます ([フルサイズの画像を表示する をクリックします](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image9.png))。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-147">**Figure 3**: Each Product s Name, Supplier, and Category is Displayed ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image9.png))</span></span>

## <a name="step-3-instructing-the-objectdatasource-to-sort-the-data"></a><span data-ttu-id="1d7ed-148">手順 3: データの並べ替えを ObjectDataSource に指示します。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-148">Step 3: Instructing the ObjectDataSource to Sort the Data</span></span>

<span data-ttu-id="1d7ed-149">Repeater で表示されるデータを並べ替えるには、データを並べ替える必要があります、並べ替え式の ObjectDataSource に通知する必要があります。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-149">To sort the data displayed in the Repeater, we need to inform the ObjectDataSource of the sort expression by which the data should be sorted.</span></span> <span data-ttu-id="1d7ed-150">最初に発生させる、ObjectDataSource は、そのデータを取得する前にその[`Selecting`イベント](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.selecting.aspx)並べ替え式を指定する機会を提供します。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-150">Before the ObjectDataSource retrieves its data, it first fires its [`Selecting` event](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.selecting.aspx), which provides an opportunity for us to specify a sort expression.</span></span> <span data-ttu-id="1d7ed-151">`Selecting`イベント ハンドラーの型のオブジェクトが渡される[ `ObjectDataSourceSelectingEventArgs` ](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasourceselectingeventargs.aspx)、という名前のプロパティを持つ[ `Arguments` ](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasourceselectingeventargs.arguments.aspx)型の[ `DataSourceSelectArguments`](https://msdn.microsoft.com/library/system.web.ui.datasourceselectarguments.aspx)します。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-151">The `Selecting` event handler is passed an object of type [`ObjectDataSourceSelectingEventArgs`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasourceselectingeventargs.aspx), which has a property named [`Arguments`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasourceselectingeventargs.arguments.aspx) of type [`DataSourceSelectArguments`](https://msdn.microsoft.com/library/system.web.ui.datasourceselectarguments.aspx).</span></span> <span data-ttu-id="1d7ed-152">`DataSourceSelectArguments`クラスが、データ ソース コントロールにデータのコンシューマーからのデータ関連の要求を渡す設計されておりが含まれています、 [ `SortExpression`プロパティ](https://msdn.microsoft.com/library/system.web.ui.datasourceselectarguments.sortexpression.aspx)します。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-152">The `DataSourceSelectArguments` class is designed to pass data-related requests from a consumer of data to the data source control, and includes a [`SortExpression` property](https://msdn.microsoft.com/library/system.web.ui.datasourceselectarguments.sortexpression.aspx).</span></span>

<span data-ttu-id="1d7ed-153">ObjectDataSource に、ASP.NET ページから並べ替え情報を渡すためのイベント ハンドラーを作成、`Selecting`イベントと、次のコードを使用します。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-153">To pass sorting information from the ASP.NET page to the ObjectDataSource, create an event handler for the `Selecting` event and use the following code:</span></span>

[!code-csharp[Main](sorting-data-in-a-datalist-or-repeater-control-cs/samples/sample2.cs)]

<span data-ttu-id="1d7ed-154">*SortExpression* (ProductName) など、データの並べ替えにデータ フィールドの名前の値を割り当てる必要があります。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-154">The *sortExpression* value should be assigned the name of the data field to sort the data by (such as ProductName ).</span></span> <span data-ttu-id="1d7ed-155">並べ替えの方向に関連するプロパティがない、降順でデータを並べ替える場合が文字列 DESC を追加するために、 *sortExpression* (ProductName DESC) などの値。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-155">There is no sort direction-related property, so if you want to sort the data in descending order, append the string DESC to the *sortExpression* value (such as ProductName DESC ).</span></span>

<span data-ttu-id="1d7ed-156">使用して別のハード コーディングされた値をみましょう*sortExpression*し、ブラウザーで結果をテストします。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-156">Go ahead and try some different hard-coded values for *sortExpression* and test the results in a browser.</span></span> <span data-ttu-id="1d7ed-157">図 4 に示すとして ProductName DESC を使用する場合、 *sortExpression*製品がアルファベットの逆順での名前で並べ替えられます。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-157">As Figure 4 shows, when using ProductName DESC as the *sortExpression*, the products are sorted by their name in reverse alphabetical order.</span></span>

<span data-ttu-id="1d7ed-158">[![製品は名前がアルファベット順の逆順で順に並べ替えられます。](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image11.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="1d7ed-158">[![The Products are Sorted by their Name in Reverse Alphabetical Order](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image11.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image10.png)</span></span>

<span data-ttu-id="1d7ed-159">**図 4**:製品はアルファベット順の逆で、名前で並べ替えられます ([フルサイズの画像を表示する をクリックします](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image12.png))。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-159">**Figure 4**: The Products are Sorted by their Name in Reverse Alphabetical Order ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image12.png))</span></span>

## <a name="step-4-creating-the-sorting-interface-and-remembering-the-sort-expression-and-direction"></a><span data-ttu-id="1d7ed-160">手順 4: 並べ替えのインターフェイスを作成し、並べ替え式と方向を記憶</span><span class="sxs-lookup"><span data-stu-id="1d7ed-160">Step 4: Creating the Sorting Interface and Remembering the Sort Expression and Direction</span></span>

<span data-ttu-id="1d7ed-161">LinkButton に各並べ替え可能なフィールドのヘッダー テキストを変換する並べ替えを gridview サポートの有効化をクリックすると、それに応じてデータを並べ替えます。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-161">Turning on sorting support in the GridView converts each sortable field s header text into a LinkButton that, when clicked, sorts the data accordingly.</span></span> <span data-ttu-id="1d7ed-162">このような並べ替えのインターフェイスでは、そのデータが整然とレイアウトの列に、GridView の合理的です。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-162">Such a sorting interface makes sense for the GridView, where its data is neatly laid out in columns.</span></span> <span data-ttu-id="1d7ed-163">DataList と Repeater コントロールで、ただし、別の並べ替えインターフェイスが必要です。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-163">For the DataList and Repeater controls, however, a different sorting interface is needed.</span></span> <span data-ttu-id="1d7ed-164">(グリッド データ) ではなくデータの一覧については、共通の並べ替えインターフェイスは、データの並べ替えられて、フィールドを提供するドロップダウン リストです。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-164">A common sorting interface for a list of data (as opposed to a grid of data), is a drop-down list that provides the fields by which the data can be sorted.</span></span> <span data-ttu-id="1d7ed-165">このチュートリアルでは、このようなインターフェイスを実装して使用できます。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-165">Let s implement such an interface for this tutorial.</span></span>

<span data-ttu-id="1d7ed-166">上記の DropDownList Web コントロールを追加、 `SortableProducts` Repeater およびセットの`ID`プロパティを`SortBy`します。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-166">Add a DropDownList Web control above the `SortableProducts` Repeater and set its `ID` property to `SortBy`.</span></span> <span data-ttu-id="1d7ed-167">[プロパティ] ウィンドウから、内の省略記号をクリックします。、 `Items` ListItem コレクション エディターを表示するプロパティ。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-167">From the Properties window, click the ellipses in the `Items` property to bring up the ListItem Collection Editor.</span></span> <span data-ttu-id="1d7ed-168">追加`ListItem`、データの並べ替えを`ProductName`、 `CategoryName`、および`SupplierName`フィールド。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-168">Add `ListItem` s to sort the data by the `ProductName`, `CategoryName`, and `SupplierName` fields.</span></span> <span data-ttu-id="1d7ed-169">追加も、`ListItem`製品の名前がアルファベットの逆順で並べ替える。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-169">Also add a `ListItem` to sort the products by their name in reverse alphabetical order.</span></span>

<span data-ttu-id="1d7ed-170">`ListItem` `Text` (名) などの任意の値にプロパティを設定することができますが、 `Value` (ProductName) などのデータ フィールドの名前にプロパティを設定する必要があります。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-170">The `ListItem` `Text` properties can be set to any value (such as Name ), but the `Value` properties must be set to the name of the data field (such as ProductName ).</span></span> <span data-ttu-id="1d7ed-171">降順で結果の並べ替えには、ProductName DESC のように、データ フィールドの名前に文字列 DESC を追加します。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-171">To sort the results in descending order, append the string DESC to the data field name, like ProductName DESC .</span></span>

![ListItem を各並べ替え可能なデータ フィールドの追加します。](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image13.png)

<span data-ttu-id="1d7ed-173">**図 5**:追加、`ListItem`各並べ替え可能なデータ フィールド</span><span class="sxs-lookup"><span data-stu-id="1d7ed-173">**Figure 5**: Add a `ListItem` for Each of the Sortable Data Fields</span></span>

<span data-ttu-id="1d7ed-174">最後に、次のドロップダウン リストの右側にボタンの Web コントロールを追加します。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-174">Finally, add a Button Web control to the right of the DropDownList.</span></span> <span data-ttu-id="1d7ed-175">設定の`ID`に`RefreshRepeater`とその`Text`プロパティを更新します。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-175">Set its `ID` to `RefreshRepeater` and its `Text` property to Refresh .</span></span>

<span data-ttu-id="1d7ed-176">作成した後、`ListItem`の更新 ボタンを追加して、DropDownList とボタンの宣言構文を次のようななります。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-176">After creating the `ListItem` s and adding the Refresh button, the DropDownList and Button s declarative syntax should look similar to the following:</span></span>

[!code-aspx[Main](sorting-data-in-a-datalist-or-repeater-control-cs/samples/sample3.aspx)]

<span data-ttu-id="1d7ed-177">完全な並べ替えの DropDownList で次に更新する必要が ObjectDataSource s ある`Selecting`イベント ハンドラーの使用、選択するように`SortBy``ListItem`s`Value`ハード コーディングされた並べ替え式ではなくプロパティ。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-177">With the sorting DropDownList complete, we next need to update the ObjectDataSource s `Selecting` event handler so that it uses the selected `SortBy``ListItem` s `Value` property as opposed to a hard-coded sort expression.</span></span>

[!code-csharp[Main](sorting-data-in-a-datalist-or-repeater-control-cs/samples/sample4.cs)]

<span data-ttu-id="1d7ed-178">最初のページにアクセスすると、この時点で、製品は初期状態で並べ替えられます、`ProductName`ほどのデータ フィールド s、 `SortBy` `ListItem`既定で選択されます (図 6 参照)。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-178">At this point when first visiting the page the products will initially be sorted by the `ProductName` data field, as it s the `SortBy` `ListItem` selected by default (see Figure 6).</span></span> <span data-ttu-id="1d7ed-179">さまざまな並べ替えカテゴリなどのオプションと [更新] を選択、ポストバックを発生させるし、再、図 7 に示すように、それらのカテゴリ名で、データを並べ替えます。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-179">Selecting a different sorting option such as Category and clicking Refresh will cause a postback and re-sort the data by the category name, as Figure 7 shows.</span></span>

<span data-ttu-id="1d7ed-180">[![製品は、最初の名前で並べ替え](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image15.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image14.png)</span><span class="sxs-lookup"><span data-stu-id="1d7ed-180">[![The Products are Initially Sorted by their Name](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image15.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image14.png)</span></span>

<span data-ttu-id="1d7ed-181">**図 6**:製品が最初に、名前で並べ替えられます ([フルサイズの画像を表示する をクリックします](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image16.png))。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-181">**Figure 6**: The Products are Initially Sorted by their Name ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image16.png))</span></span>

<span data-ttu-id="1d7ed-182">[![製品がカテゴリで並べ替えられます](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image18.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image17.png)</span><span class="sxs-lookup"><span data-stu-id="1d7ed-182">[![The Products are Now Sorted by Category](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image18.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image17.png)</span></span>

<span data-ttu-id="1d7ed-183">**図 7**:製品がカテゴリで並べ替えられます ([フルサイズの画像を表示する をクリックします](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image19.png))。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-183">**Figure 7**: The Products are Now Sorted by Category ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image19.png))</span></span>

> [!NOTE]
> <span data-ttu-id="1d7ed-184">更新 ボタンをクリックすると、データを自動的に再度並べ替えた Repeater s のビュー ステートが無効になっている、ため、原因となり、ポストバックのたびにそのデータ ソースにバインドする中継ぎ局です。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-184">Clicking the Refresh button causes the data to automatically be re-sorted because the Repeater s view state has been disabled, thereby causing the Repeater to rebind to its data source on every postback.</span></span> <span data-ttu-id="1d7ed-185">ドロップダウン リスト、並べ替えの変更が有効な Repeater のビュー ステートのままにしている場合、一覧は並べ替え順序に影響を必要はありません。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-185">If you ve left the Repeater s view state enabled, changing the sorting drop-down list won't have any affect on the sort order.</span></span> <span data-ttu-id="1d7ed-186">これを解決するには、[更新] ボタンのイベント ハンドラーを作成`Click`イベントとそのデータ ソースを Repeater を再バインド (s Repeater を呼び出すことによって`DataBind()`メソッド)。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-186">To remedy this, create an event handler for the Refresh Button s `Click` event and rebind the Repeater to its data source (by calling the Repeater s `DataBind()` method).</span></span>

## <a name="remembering-the-sort-expression-and-direction"></a><span data-ttu-id="1d7ed-187">並べ替え式と方向を記憶</span><span class="sxs-lookup"><span data-stu-id="1d7ed-187">Remembering the Sort Expression and Direction</span></span>

<span data-ttu-id="1d7ed-188">並べ替え以外に関係しているポストバックが発生すると、ページの並べ替え可能な DataList または Repeater を作成するときに、秒の命令型の並べ替え式と方向は、ポストバック間で記憶されます。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-188">When creating a sortable DataList or Repeater on a page where non-sort related postbacks may occur, it s imperative that the sort expression and direction be remembered across postbacks.</span></span> <span data-ttu-id="1d7ed-189">たとえば、各製品で [削除] ボタンを含めるには、このチュートリアルでは、Repeater を更新しました。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-189">For example, imagine that we updated the Repeater in this tutorial to include a Delete button with each product.</span></span> <span data-ttu-id="1d7ed-190">削除ボタンをクリックすると d は、選択した製品を削除し、Repeater にデータをバインドするコードを実行します。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-190">When the user clicks the Delete button we d run some code to delete the selected product and then rebind the data to the Repeater.</span></span> <span data-ttu-id="1d7ed-191">並べ替えの詳細については、ポストバック間では保持されません、画面に表示されるデータの元の並べ替え順序に戻ります。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-191">If the sort details are not persisted across postback, the data displayed on screen will revert to the original sort order.</span></span>

<span data-ttu-id="1d7ed-192">このチュートリアルでは、DropDownList 暗黙的を保存、並べ替え式と方向のビュー状態で私たちにとってします。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-192">For this tutorial, the DropDownList implicitly saves the sort expression and direction in its view state for us.</span></span> <span data-ttu-id="1d7ed-193">使用すると、さまざまな並べ替えオプションを指定すると答えると、ある 1 つ別の並べ替えインターフェイスを使用していた場合 d をポストバック間での並べ替え順序を覚えておくように注意する必要があります。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-193">If we were using a different sorting interface one with, say, LinkButtons that provided the various sorting options we d need to take care to remember the sort order across postbacks.</span></span> <span data-ttu-id="1d7ed-194">これは、クエリ文字列、またはその他の状態の永続化手法では、並べ替えパラメーターを含めることによって、ページ s のビュー ステートに並べ替えパラメーターを格納することで実現可能性があります。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-194">This could be accomplished by storing the sorting parameters in the page s view state, by including the sort parameter in the querystring, or through some other state persistence technique.</span></span>

<span data-ttu-id="1d7ed-195">このチュートリアルの今後の例では、並べ替えの詳細ページのビューステートを保存する方法について説明します。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-195">Future examples in this tutorial explore how to persist the sorting details in the page s view state.</span></span>

## <a name="step-5-adding-sorting-support-to-a-datalist-that-uses-default-paging"></a><span data-ttu-id="1d7ed-196">手順 5: 並べ替えを既定のページングを使用する DataList にサポートを追加します。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-196">Step 5: Adding Sorting Support to a DataList that Uses Default Paging</span></span>

<span data-ttu-id="1d7ed-197">[前のチュートリアル](paging-report-data-in-a-datalist-or-repeater-control-cs.md)DataList で既定のページングを実装する方法について確認しました。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-197">In the [preceding tutorial](paging-report-data-in-a-datalist-or-repeater-control-cs.md) we examined how to implement default paging with a DataList.</span></span> <span data-ttu-id="1d7ed-198">S、ページングされたデータの並べ替え機能は、この前の例を拡張することができます。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-198">Let s extend this previous example to include the ability to sort the paged data.</span></span> <span data-ttu-id="1d7ed-199">開いて開始、`SortingWithDefaultPaging.aspx`と`Paging.aspx`ページで、`PagingSortingDataListRepeater`フォルダー。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-199">Start by opening the `SortingWithDefaultPaging.aspx` and `Paging.aspx` pages in the `PagingSortingDataListRepeater` folder.</span></span> <span data-ttu-id="1d7ed-200">`Paging.aspx`  ページで、ページの宣言型マークアップを表示する ソース ボタンをクリックします。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-200">From the `Paging.aspx` page, click on the Source button to view the page s declarative markup.</span></span> <span data-ttu-id="1d7ed-201">選択したテキストをコピー (図 8 参照) の宣言型マークアップを貼り付けます`SortingWithDefaultPaging.aspx`間、`<asp:Content>`タグ。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-201">Copy the selected text (see Figure 8) and paste it into the declarative markup of `SortingWithDefaultPaging.aspx` between the `<asp:Content>` tags.</span></span>

<span data-ttu-id="1d7ed-202">[![宣言型マークアップをレプリケート、 &lt;Asp:content&gt; SortingWithDefaultPaging.aspx Paging.aspx からタグ](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image21.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image20.png)</span><span class="sxs-lookup"><span data-stu-id="1d7ed-202">[![Replicate the Declarative Markup in the &lt;asp:Content&gt; Tags from Paging.aspx to SortingWithDefaultPaging.aspx](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image21.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image20.png)</span></span>

<span data-ttu-id="1d7ed-203">**図 8**:宣言型マークアップをレプリケート、`<asp:Content>`からタグ`Paging.aspx`に`SortingWithDefaultPaging.aspx`([フルサイズの画像を表示する をクリックします](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image22.png))。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-203">**Figure 8**: Replicate the Declarative Markup in the `<asp:Content>` Tags from `Paging.aspx` to `SortingWithDefaultPaging.aspx` ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image22.png))</span></span>

<span data-ttu-id="1d7ed-204">宣言型マークアップをコピーした後、メソッドとプロパティをコピー、`Paging.aspx`ページの分離コード クラスに分離コード クラスを s`SortingWithDefaultPaging.aspx`します。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-204">After copying the declarative markup, copy the methods and properties in the `Paging.aspx` page s code-behind class to the code-behind class for `SortingWithDefaultPaging.aspx`.</span></span> <span data-ttu-id="1d7ed-205">表示する次に、少し、`SortingWithDefaultPaging.aspx`ブラウザーでページ。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-205">Next, take a moment to view the `SortingWithDefaultPaging.aspx` page in a browser.</span></span> <span data-ttu-id="1d7ed-206">同じ機能と外観を示す必要があります`Paging.aspx`します。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-206">It should exhibit the same functionality and appearance as `Paging.aspx`.</span></span>

## <a name="enhancing-productsbll-to-include-a-default-paging-and-sorting-method"></a><span data-ttu-id="1d7ed-207">ページングと並べ替え方法には、既定値を含める ProductsBLL の強化</span><span class="sxs-lookup"><span data-stu-id="1d7ed-207">Enhancing ProductsBLL to Include a Default Paging and Sorting Method</span></span>

<span data-ttu-id="1d7ed-208">前のチュートリアルで作成した、`GetProductsAsPagedDataSource(pageIndex, pageSize)`メソッドで、`ProductsBLL`返されるクラス、`PagedDataSource`オブジェクト。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-208">In the previous tutorial we created a `GetProductsAsPagedDataSource(pageIndex, pageSize)` method in the `ProductsBLL` class that returned a `PagedDataSource` object.</span></span> <span data-ttu-id="1d7ed-209">これは、`PagedDataSource`オブジェクトが設定されている*すべて*、製品の (BLL s を使用して`GetProducts()`メソッド)、指定したに対応するレコードのみを DataList にバインドされると、 *pageIndex* *pageSize* 入力パラメーターが表示されます。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-209">This `PagedDataSource` object was populated with *all* of the products (via the BLL s `GetProducts()` method), but when bound to the DataList only those records corresponding to the specified *pageIndex* and *pageSize* input parameters were displayed.</span></span>

<span data-ttu-id="1d7ed-210">このチュートリアルの前半で ObjectDataSource s から、並べ替え式を指定することで並べ替えのサポートを追加しました`Selecting`イベント ハンドラー。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-210">Earlier in this tutorial we added sorting support by specifying the sort expression from the ObjectDataSource s `Selecting` event handler.</span></span> <span data-ttu-id="1d7ed-211">これは、ObjectDataSource に並べ替えることができる、このようなオブジェクトが返される場合もと動作、`ProductsDataTable`によって返される、`GetProducts()`メソッド。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-211">This works well when the ObjectDataSource is returned an object that can be sorted, like the `ProductsDataTable` returned by the `GetProducts()` method.</span></span> <span data-ttu-id="1d7ed-212">ただし、`PagedDataSource`によって返されるオブジェクト、`GetProductsAsPagedDataSource`メソッドは、その内部データ ソースの並べ替えをサポートしていません。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-212">However, the `PagedDataSource` object returned by the `GetProductsAsPagedDataSource` method does not support sorting of its inner data source.</span></span> <span data-ttu-id="1d7ed-213">代わりから返される結果を並べ替える必要があります、`GetProducts()`メソッド*する前に*を入力しました、`PagedDataSource`します。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-213">Instead, we need to sort the results returned from the `GetProducts()` method *before* we put it in the `PagedDataSource`.</span></span>

<span data-ttu-id="1d7ed-214">これを実現するで新しいメソッドを作成、`ProductsBLL`クラス、`GetProductsSortedAsPagedDataSource(sortExpression, pageIndex, pageSize)`します。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-214">To accomplish this, create a new method in the `ProductsBLL` class, `GetProductsSortedAsPagedDataSource(sortExpression, pageIndex, pageSize)`.</span></span> <span data-ttu-id="1d7ed-215">並べ替え、`ProductsDataTable`によって返される、`GetProducts()`メソッドを指定、`Sort`プロパティの既定の`DataTableView`:</span><span class="sxs-lookup"><span data-stu-id="1d7ed-215">To sort the `ProductsDataTable` returned by the `GetProducts()` method, specify the `Sort` property of its default `DataTableView`:</span></span>

[!code-csharp[Main](sorting-data-in-a-datalist-or-repeater-control-cs/samples/sample5.cs)]

<span data-ttu-id="1d7ed-216">`GetProductsSortedAsPagedDataSource`メソッドの違いから、`GetProductsAsPagedDataSource`前のチュートリアルで作成したメソッド。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-216">The `GetProductsSortedAsPagedDataSource` method differs only slightly from the `GetProductsAsPagedDataSource` method created in the previous tutorial.</span></span> <span data-ttu-id="1d7ed-217">具体的には、`GetProductsSortedAsPagedDataSource`追加の入力パラメーターを受け取り`sortExpression`にこの値が割り当てられます、`Sort`のプロパティ、 `ProductDataTable` s`DefaultView`します。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-217">In particular, `GetProductsSortedAsPagedDataSource` accepts an additional input parameter `sortExpression` and assigns this value to the `Sort` property of the `ProductDataTable` s `DefaultView`.</span></span> <span data-ttu-id="1d7ed-218">数行のコードを後で、`PagedDataSource`オブジェクト データ ソースが割り当てられている、 `ProductDataTable` s`DefaultView`します。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-218">A few lines of code later, the `PagedDataSource` object s DataSource is assigned the `ProductDataTable` s `DefaultView`.</span></span>

## <a name="calling-the-getproductssortedaspageddatasource-method-and-specifying-the-value-for-the-sortexpression-input-parameter"></a><span data-ttu-id="1d7ed-219">GetProductsSortedAsPagedDataSource メソッドを呼び出すと、SortExpression 入力パラメーターの値を指定します。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-219">Calling the GetProductsSortedAsPagedDataSource Method and Specifying the Value for the SortExpression Input Parameter</span></span>

<span data-ttu-id="1d7ed-220">`GetProductsSortedAsPagedDataSource`このパラメーターの値を提供するメソッドの完全な次の手順は。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-220">With the `GetProductsSortedAsPagedDataSource` method complete, the next step is to provide the value for this parameter.</span></span> <span data-ttu-id="1d7ed-221">ObjectDataSource`SortingWithDefaultPaging.aspx`を呼び出すには、現在構成されている、`GetProductsAsPagedDataSource`メソッドを呼び出し、2 つを 2 つの入力パラメーターで`QueryStringParameters`で指定される、`SelectParameters`コレクション。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-221">The ObjectDataSource in `SortingWithDefaultPaging.aspx` is currently configured to call the `GetProductsAsPagedDataSource` method and passes in the two input parameters through its two `QueryStringParameters`, which are specified in the `SelectParameters` collection.</span></span> <span data-ttu-id="1d7ed-222">これらの 2 つ`QueryStringParameters`ことを示すためのソース、`GetProductsAsPagedDataSource`メソッド s *pageIndex*と*pageSize*パラメーターを取得するクエリ文字列フィールドから`pageIndex`と`pageSize`します。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-222">These two `QueryStringParameters` indicate that the source for the `GetProductsAsPagedDataSource` method s *pageIndex* and *pageSize* parameters come from the querystring fields `pageIndex` and `pageSize`.</span></span>

<span data-ttu-id="1d7ed-223">ObjectDataSource %s 更新`SelectMethod`プロパティを呼び出す新しい`GetProductsSortedAsPagedDataSource`メソッド。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-223">Update the ObjectDataSource s `SelectMethod` property so that it invokes the new `GetProductsSortedAsPagedDataSource` method.</span></span> <span data-ttu-id="1d7ed-224">次に、新しい追加`QueryStringParameter`ように、 *sortExpression*入力パラメーターがクエリ文字列フィールドからアクセス`sortExpression`します。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-224">Then, add a new `QueryStringParameter` so that the *sortExpression* input parameter is accessed from the querystring field `sortExpression`.</span></span> <span data-ttu-id="1d7ed-225">設定、 `QueryStringParameter` s `DefaultValue` ProductName にします。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-225">Set the `QueryStringParameter` s `DefaultValue` to ProductName .</span></span>

<span data-ttu-id="1d7ed-226">これらの変更後よう ObjectDataSource s の宣言型マークアップになります。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-226">After these changes, the ObjectDataSource s declarative markup should look like:</span></span>

[!code-aspx[Main](sorting-data-in-a-datalist-or-repeater-control-cs/samples/sample6.aspx)]

<span data-ttu-id="1d7ed-227">この時点で、`SortingWithDefaultPaging.aspx`ページは、製品名、その結果をアルファベット順に並べ替えが (図 9 参照)。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-227">At this point, the `SortingWithDefaultPaging.aspx` page will sort its results alphabetically by the product name (see Figure 9).</span></span> <span data-ttu-id="1d7ed-228">既定では、商品名の値として渡されるため、これは、`GetProductsSortedAsPagedDataSource`メソッド s *sortExpression*パラメーター。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-228">This is because, by default, a value of ProductName is passed in as the `GetProductsSortedAsPagedDataSource` method s *sortExpression* parameter.</span></span>

<span data-ttu-id="1d7ed-229">[![既定では、結果が商品名で並べ替えられます。](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image24.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image23.png)</span><span class="sxs-lookup"><span data-stu-id="1d7ed-229">[![By Default, the Results are Sorted by ProductName](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image24.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image23.png)</span></span>

<span data-ttu-id="1d7ed-230">**図 9**:既定では、結果は並べ`ProductName`([フルサイズの画像を表示する をクリックします](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image25.png))。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-230">**Figure 9**: By Default, the Results are Sorted by `ProductName` ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image25.png))</span></span>

<span data-ttu-id="1d7ed-231">手動で追加する場合、`sortExpression`などのクエリ文字列フィールド`SortingWithDefaultPaging.aspx?sortExpression=CategoryName`結果は並べ替え、指定した`sortExpression`します。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-231">If you manually add a `sortExpression` querystring field such as `SortingWithDefaultPaging.aspx?sortExpression=CategoryName` the results will be sorted by the specified `sortExpression`.</span></span> <span data-ttu-id="1d7ed-232">ただし、この`sortExpression`データの別のページに移動するときに、パラメーターは、クエリ文字列に含まれません。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-232">However, this `sortExpression` parameter is not included in the querystring when moving to a different page of data.</span></span> <span data-ttu-id="1d7ed-233">米国にバックアップが実際には、ボタン、[次へ] または最後のページをクリックすると`Paging.aspx`!</span><span class="sxs-lookup"><span data-stu-id="1d7ed-233">In fact, clicking on the Next or Last page buttons takes us back to `Paging.aspx`!</span></span> <span data-ttu-id="1d7ed-234">さらに、s が現在の並べ替えインターフェイスなし。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-234">Furthermore, there s currently no sorting interface.</span></span> <span data-ttu-id="1d7ed-235">ユーザーは、ページングされたデータの並べ替え順序を変更できる唯一の方法は、クエリ文字列を直接操作することによってです。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-235">The only way a user can change the sort order of the paged data is by manipulating the querystring directly.</span></span>

## <a name="creating-the-sorting-interface"></a><span data-ttu-id="1d7ed-236">並べ替えのインターフェイスを作成します。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-236">Creating the Sorting Interface</span></span>

<span data-ttu-id="1d7ed-237">最初に更新する必要があります、`RedirectUser`メソッドをユーザーに送信する`SortingWithDefaultPaging.aspx`(の代わりに`Paging.aspx`) を含めると、`sortExpression`クエリ文字列値。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-237">We first need to update the `RedirectUser` method to send the user to `SortingWithDefaultPaging.aspx` (instead of `Paging.aspx`) and to include the `sortExpression` value in the querystring.</span></span> <span data-ttu-id="1d7ed-238">読み取り専用ページ レベルという名前を付け加えておきます`SortExpression`プロパティ。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-238">We should also add a read-only, page-level named `SortExpression` property.</span></span> <span data-ttu-id="1d7ed-239">同様に、このプロパティ、`PageIndex`と`PageSize`前のチュートリアルで作成されたプロパティの値を返します、`sortExpression`存在する場合、クエリ文字列フィールドと、既定 (ProductName) をそれ以外の場合値します。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-239">This property, similar to the `PageIndex` and `PageSize` properties created in the previous tutorial, returns the value of the `sortExpression` querystring field if it exists, and the default value ( ProductName ) otherwise.</span></span>

<span data-ttu-id="1d7ed-240">現在、`RedirectUser`メソッドは、のみ 1 つの入力パラメーターを表示するページのインデックスを受け取ります。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-240">Currently the `RedirectUser` method accepts only a single input parameter the index of the page to display.</span></span> <span data-ttu-id="1d7ed-241">ただし、新機能、クエリ文字列で指定した以外の並べ替え式を使用してデータの特定のページにユーザーをリダイレクトする場合もあります。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-241">However, there may be times when we want to redirect the user to a particular page of data using a sort expression other than what s specified in the querystring.</span></span> <span data-ttu-id="1d7ed-242">すぐにこのページには、一連の指定した列でデータを並べ替えるためのボタンの Web コントロールが含まれる並べ替えインターフェイスを作成します。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-242">In a moment we'll create the sorting interface for this page, which will include a series of Button Web controls for sorting the data by a specified column.</span></span> <span data-ttu-id="1d7ed-243">これらのボタンのいずれかがクリックされたときに適切に並べ替える式の値を渡して、ユーザーをリダイレクトします。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-243">When one of those Buttons is clicked, we want to redirect the user passing in the appropriate sort expression value.</span></span> <span data-ttu-id="1d7ed-244">この機能を提供する 2 つのバージョンを作成、`RedirectUser`メソッド。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-244">To provide this functionality, create two versions of the `RedirectUser` method.</span></span> <span data-ttu-id="1d7ed-245">1 つ目は、2 つ目は、ページのインデックスおよび並べ替え式を受け入れる中に、表示するページのインデックスだけを受け入れる必要があります。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-245">The first one should accept just the page index to display, while the second one accepts the page index and sort expression.</span></span>

[!code-csharp[Main](sorting-data-in-a-datalist-or-repeater-control-cs/samples/sample7.cs)]

<span data-ttu-id="1d7ed-246">このチュートリアルでは最初の例では、DropDownList を使用して並べ替えインターフェイスを作成しました。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-246">In the first example in this tutorial, we created a sorting interface using a DropDownList.</span></span> <span data-ttu-id="1d7ed-247">この例では、let s 使用によって並べ替え DataList いずれかの上に配置する 3 つのボタンの Web コントロール`ProductName`、1 つの`CategoryName`とに 1 つ`SupplierName`。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-247">For this example, let s use three Button Web controls positioned above the DataList one for sorting by `ProductName`, one for `CategoryName`, and one for `SupplierName`.</span></span> <span data-ttu-id="1d7ed-248">3 つのボタンの Web コントロールの設定を追加、`ID`と`Text`プロパティ適切に。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-248">Add the three Button Web controls, setting their `ID` and `Text` properties appropriately:</span></span>

[!code-aspx[Main](sorting-data-in-a-datalist-or-repeater-control-cs/samples/sample8.aspx)]

<span data-ttu-id="1d7ed-249">次に、作成、`Click`ごとにイベント ハンドラー。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-249">Next, create a `Click` event handler for each.</span></span> <span data-ttu-id="1d7ed-250">イベント ハンドラーを呼び出す必要があります、`RedirectUser`適切な並べ替え式を使用して最初のページにユーザーを返すメソッド。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-250">The event handlers should call the `RedirectUser` method, returning the user to the first page using the appropriate sort expression.</span></span>

[!code-csharp[Main](sorting-data-in-a-datalist-or-repeater-control-cs/samples/sample9.cs)]

<span data-ttu-id="1d7ed-251">データがアルファベット順に並べ替え、製品名によって、ページを最初にアクセスして、ときに (戻るは図 9 を参照してください)。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-251">When first visiting the page, the data is sorted by the product name alphabetically (refer back to Figure 9).</span></span> <span data-ttu-id="1d7ed-252">データの 2 番目のページに進みカテゴリ ボタンによって、並べ替えをクリックして [次へ] ボタンをクリックします。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-252">Click the Next button to advance to the second page of data and then click the Sort by Category button.</span></span> <span data-ttu-id="1d7ed-253">カテゴリ名で並べ替えられた、データの最初のページに戻ること (図 10 参照)。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-253">This returns us to the first page of data, sorted by category name (see Figure 10).</span></span> <span data-ttu-id="1d7ed-254">同様に、サプライヤー ボタンによって、並べ替えをクリックすると、仕入先データの最初のページから開始して、データが並べ替えられます。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-254">Likewise, clicking the Sort by Supplier button sorts the data by supplier starting from the first page of data.</span></span> <span data-ttu-id="1d7ed-255">を通じて、データをページングと並べ替えの基準が記憶されます。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-255">The sort choice is remembered as the data is paged through.</span></span> <span data-ttu-id="1d7ed-256">図 11 は、カテゴリでの並べ替えとデータの 13 番目のページに昇格し、後のページを示します。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-256">Figure 11 shows the page after sorting by category and then advancing to the thirteenth page of data.</span></span>

<span data-ttu-id="1d7ed-257">[![製品はカテゴリ順に並べ替えられます。](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image27.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image26.png)</span><span class="sxs-lookup"><span data-stu-id="1d7ed-257">[![The Products are Sorted by Category](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image27.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image26.png)</span></span>

<span data-ttu-id="1d7ed-258">**図 10**:製品はカテゴリで並べ替えられます ([フルサイズの画像を表示する をクリックします](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image28.png))。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-258">**Figure 10**: The Products are Sorted by Category ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image28.png))</span></span>

<span data-ttu-id="1d7ed-259">[![並べ替え式は記憶とページングを通じてデータ](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image30.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image29.png)</span><span class="sxs-lookup"><span data-stu-id="1d7ed-259">[![The Sort Expression is Remembered When Paging Through the Data](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image30.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image29.png)</span></span>

<span data-ttu-id="1d7ed-260">**図 11**:並べ替え式は記憶とページングを通じて、データ ([フルサイズの画像を表示する をクリックします](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image31.png))。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-260">**Figure 11**: The Sort Expression is Remembered When Paging Through the Data ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image31.png))</span></span>

## <a name="step-6-custom-paging-through-records-in-a-repeater"></a><span data-ttu-id="1d7ed-261">手順 6: Repeater 内のレコードをカスタム ページング</span><span class="sxs-lookup"><span data-stu-id="1d7ed-261">Step 6: Custom Paging Through Records in a Repeater</span></span>

<span data-ttu-id="1d7ed-262">DataList 例では、非効率的な既定のページングの手法を使用してそのデータを 5 つのページの手順で検査されます。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-262">The DataList example examined in step 5 pages through its data using the inefficient default paging technique.</span></span> <span data-ttu-id="1d7ed-263">十分に大量のデータのページング、ときに、カスタム ページングを使用することが重要です。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-263">When paging through sufficiently large amounts of data, it is imperative that custom paging be used.</span></span> <span data-ttu-id="1d7ed-264">戻り、[効率的にページングを大規模な量のデータ](../paging-and-sorting/efficiently-paging-through-large-amounts-of-data-cs.md)と[カスタム ページングされたデータの並べ替え](../paging-and-sorting/sorting-custom-paged-data-cs.md)の BLL の既定およびカスタム ページングと作成されたメソッドの違いを調べてチュートリアル、カスタム ページングと並べ替えカスタム ページングされたデータを使用しています。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-264">Back in the [Efficiently Paging Through Large Amounts of Data](../paging-and-sorting/efficiently-paging-through-large-amounts-of-data-cs.md) and [Sorting Custom Paged Data](../paging-and-sorting/sorting-custom-paged-data-cs.md) tutorials, we examined the differences between default and custom paging and created methods in the BLL for utilizing custom paging and sorting custom paged data.</span></span> <span data-ttu-id="1d7ed-265">次の 3 つのメソッドが追加これら 2 つ前のチュートリアルで具体的には、`ProductsBLL`クラス。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-265">In particular, in these two previous tutorials we added the following three methods to the `ProductsBLL` class:</span></span>

- <span data-ttu-id="1d7ed-266">`GetProductsPaged(startRowIndex, maximumRows)` 開始位置としてレコードの特定のサブセットを返します*startRowIndex*を超過していないと*maximumRows*します。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-266">`GetProductsPaged(startRowIndex, maximumRows)` returns a particular subset of records starting at *startRowIndex* and not exceeding *maximumRows*.</span></span>
- <span data-ttu-id="1d7ed-267">`GetProductsPagedAndSorted(sortExpression, startRowIndex, maximumRows)` 指定したで並べ替えたレコードの特定のサブセットを返します*sortExpression*入力パラメーター。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-267">`GetProductsPagedAndSorted(sortExpression, startRowIndex, maximumRows)` returns a particular subset of records sorted by the specified *sortExpression* input parameter.</span></span>
- <span data-ttu-id="1d7ed-268">`TotalNumberOfProducts()` 内のレコードの合計数を提供します、`Products`データベース テーブル。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-268">`TotalNumberOfProducts()` provides the total number of records in the `Products` database table.</span></span>

<span data-ttu-id="1d7ed-269">効率的にページおよび DataList または Repeater コントロールを使用してデータを並べ替えるには、これらのメソッドを使用できます。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-269">These methods can be used to efficiently page and sort through data using a DataList or Repeater control.</span></span> <span data-ttu-id="1d7ed-270">これを説明するには、ようにカスタム ページング サポートを Repeater コントロールを作成して開始 s並べ替え機能を追加します。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-270">To illustrate this, let s start by creating a Repeater control with custom paging support; we'll then add sorting capabilities.</span></span>

<span data-ttu-id="1d7ed-271">開く、`SortingWithCustomPaging.aspx`ページで、`PagingSortingDataListRepeater`フォルダー設定 ページで、Repeater に追加し、その`ID`プロパティを`Products`します。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-271">Open the `SortingWithCustomPaging.aspx` page in the `PagingSortingDataListRepeater` folder and add a Repeater to the page, setting its `ID` property to `Products`.</span></span> <span data-ttu-id="1d7ed-272">Repeater s のスマート タグからの作成という名前の新しい ObjectDataSource`ProductsDataSource`します。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-272">From the Repeater s smart tag, create a new ObjectDataSource named `ProductsDataSource`.</span></span> <span data-ttu-id="1d7ed-273">データを選択するように構成、`ProductsBLL`クラスの`GetProductsPaged`メソッド。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-273">Configure it to select its data from the `ProductsBLL` class s `GetProductsPaged` method.</span></span>

<span data-ttu-id="1d7ed-274">[![ObjectDataSource ProductsBLL クラスの GetProductsPaged メソッドを使用して構成します。](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image33.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image32.png)</span><span class="sxs-lookup"><span data-stu-id="1d7ed-274">[![Configure the ObjectDataSource to Use the ProductsBLL Class s GetProductsPaged Method](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image33.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image32.png)</span></span>

<span data-ttu-id="1d7ed-275">**図 12**:構成に使用する ObjectDataSource、`ProductsBLL`クラス s`GetProductsPaged`メソッド ([フルサイズの画像を表示する をクリックします](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image34.png))。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-275">**Figure 12**: Configure the ObjectDataSource to Use the `ProductsBLL` Class s `GetProductsPaged` Method ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image34.png))</span></span>

<span data-ttu-id="1d7ed-276">UPDATE、INSERT でドロップダウン リストを設定 (None) にタブを削除して、[次へ] ボタンをクリックします。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-276">Set the drop-down lists in the UPDATE, INSERT, and DELETE tabs to (None) and then click the Next button.</span></span> <span data-ttu-id="1d7ed-277">データ ソースの構成ウィザードでのソースをようになりましたが、`GetProductsPaged`メソッド s *startRowIndex*と*maximumRows*パラメーターを入力します。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-277">The Configure Data Source wizard now prompts for the sources of the `GetProductsPaged` method s *startRowIndex* and *maximumRows* input parameters.</span></span> <span data-ttu-id="1d7ed-278">実際には、これらの入力パラメーターは無視されます。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-278">In actuality, these input parameters are ignored.</span></span> <span data-ttu-id="1d7ed-279">代わりに、 *startRowIndex*と*maximumRows*経由で値が渡された、 `Arguments` ObjectDataSource s プロパティ`Selecting`イベント ハンドラーを指定した方法と同じように、*sortExpression*でこのチュートリアルの最初のデモです。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-279">Instead, the *startRowIndex* and *maximumRows* values will be passed in through the `Arguments` property in the ObjectDataSource s `Selecting` event handler, just like how we specified the *sortExpression* in this tutorial s first demo.</span></span> <span data-ttu-id="1d7ed-280">そのため、パラメーター ソースを None に設定ウィザードで、ドロップダウン リストままにします。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-280">Therefore, leave the parameter source drop-down lists in the wizard set at None .</span></span>

<span data-ttu-id="1d7ed-281">[![[なし] に、パラメーター ソースの設定をそのまま使用します。](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image36.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image35.png)</span><span class="sxs-lookup"><span data-stu-id="1d7ed-281">[![Leave the Parameter Sources Set to None](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image36.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image35.png)</span></span>

<span data-ttu-id="1d7ed-282">**図 13**:[なし] にパラメーターのソースの設定のままに ([フルサイズの画像を表示する をクリックします](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image37.png))。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-282">**Figure 13**: Leave the Parameter Sources Set to None ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image37.png))</span></span>

> [!NOTE]
> <span data-ttu-id="1d7ed-283">*いない*ObjectDataSource s 設定`EnablePaging`プロパティを`true`。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-283">Do *not* set the ObjectDataSource s `EnablePaging` property to `true`.</span></span> <span data-ttu-id="1d7ed-284">これにより、独自に自動的に含める ObjectDataSource *startRowIndex*と*maximumRows*パラメーターを`SelectMethod`s 既存のパラメーター リスト。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-284">This will cause the ObjectDataSource to automatically include its own *startRowIndex* and *maximumRows* parameters to the `SelectMethod` s existing parameter list.</span></span> <span data-ttu-id="1d7ed-285">`EnablePaging`プロパティは、バインドのカスタム ページングされた GridView、DetailsView、FormView コントロールにデータがこれらのコントロールは、ObjectDataSource s から特定の動作を想定しているため場合に便利な場合にのみ使用できます`EnablePaging`プロパティが`true`します。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-285">The `EnablePaging` property is useful when binding custom paged data to a GridView, DetailsView, or FormView control because these controls expect certain behavior from the ObjectDataSource that s only available when `EnablePaging` property is `true`.</span></span> <span data-ttu-id="1d7ed-286">DataList と Repeater のページング サポートを手動で追加するがあるためこのプロパティに設定のままに`false`(既定)、ように、ASP.NET ページ内に直接必要な機能に焼き付けるします。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-286">Since we have to manually add the paging support for the DataList and Repeater, leave this property set to `false` (the default), as we'll bake in the needed functionality directly within our ASP.NET page.</span></span>

<span data-ttu-id="1d7ed-287">最後に、Repeater s を定義`ItemTemplate`s の製品名、カテゴリ、および仕入先が表示されるようにします。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-287">Finally, define the Repeater s `ItemTemplate` so that the product s name, category, and supplier are shown.</span></span> <span data-ttu-id="1d7ed-288">これらの変更後 Repeater、ObjectDataSource s の宣言構文に、次のようになります。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-288">After these changes, the Repeater and ObjectDataSource s declarative syntax should look similar to the following:</span></span>

[!code-aspx[Main](sorting-data-in-a-datalist-or-repeater-control-cs/samples/sample10.aspx)]

<span data-ttu-id="1d7ed-289">ご協力にブラウザーを使用してページにアクセスし、レコードが返されないことに注意してください。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-289">Take a moment to visit the page through a browser and note that no records are returned.</span></span> <span data-ttu-id="1d7ed-290">これはを指定するには、まだ ve、 *startRowIndex*と*maximumRows*パラメーターの値の両方でそのため、0 の値を渡されます。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-290">This is because we ve yet to specify the *startRowIndex* and *maximumRows* parameter values; therefore, values of 0 are being passed in for both.</span></span> <span data-ttu-id="1d7ed-291">これらの値を指定するには、ObjectDataSource s のイベント ハンドラーを作成`Selecting`イベントとこれらのパラメーター値をプログラムでの 0 から 5、ハード コーディングされた値にそれぞれ設定します。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-291">To specify these values, create an event handler for the ObjectDataSource s `Selecting` event and set these parameters values programmatically to hard-coded values of 0 and 5, respectively:</span></span>

[!code-csharp[Main](sorting-data-in-a-datalist-or-repeater-control-cs/samples/sample11.cs)]

<span data-ttu-id="1d7ed-292">この変更によりは、ブラウザーで表示したときに、ページには、最初の 5 つの製品が表示されます。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-292">With this change, the page, when viewed through a browser, shows the first five products.</span></span>

<span data-ttu-id="1d7ed-293">[![最初の 5 つのレコードが表示されます。](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image39.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image38.png)</span><span class="sxs-lookup"><span data-stu-id="1d7ed-293">[![The First Five Records are Displayed](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image39.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image38.png)</span></span>

<span data-ttu-id="1d7ed-294">**図 14**:最初の 5 つのレコードが表示されます ([フルサイズの画像を表示する をクリックします](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image40.png))。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-294">**Figure 14**: The First Five Records are Displayed ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image40.png))</span></span>

> [!NOTE]
> <span data-ttu-id="1d7ed-295">図 14 に示される製品が発生するために、製品名で並べ替えられます、`GetProductsPaged`効率的なカスタム ページング クエリを実行するストアド プロシージャで結果を並べ替えます`ProductName`します。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-295">The products listed in Figure 14 happen to be sorted by product name because the `GetProductsPaged` stored procedure that performs the efficient custom paging query orders the results by `ProductName`.</span></span>

<span data-ttu-id="1d7ed-296">ページをステップ ユーザーを許可するためには、開始行インデックスおよび行の最大数を追跡し、ポストバック間でこれらの値を保存する必要があります。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-296">In order to allow the user to step through the pages, we need to keep track of the start row index and maximum rows and remember these values across postbacks.</span></span> <span data-ttu-id="1d7ed-297">既定のページングの例ではこれらの値を保持するのにクエリ文字列フィールドを使用しましたこのデモでは、s が、ページ ビュー状態でこの情報を保持することができます。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-297">In the default paging example we used querystring fields to persist these values; for this demo, let s persist this information in the page s view state.</span></span> <span data-ttu-id="1d7ed-298">次の 2 つのプロパティを作成します。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-298">Create the following two properties:</span></span>

[!code-csharp[Main](sorting-data-in-a-datalist-or-repeater-control-cs/samples/sample12.cs)]

<span data-ttu-id="1d7ed-299">使用するように選択するとイベント ハンドラーのコードを次に、更新、`StartRowIndex`と`MaximumRows`0 および 5 のハード コーディングされた値ではなくプロパティ。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-299">Next, update the code in the Selecting event handler so that it uses the `StartRowIndex` and `MaximumRows` properties instead of the hard-coded values of 0 and 5:</span></span>

[!code-csharp[Main](sorting-data-in-a-datalist-or-repeater-control-cs/samples/sample13.cs)]

<span data-ttu-id="1d7ed-300">この時点で、ページには、最初の 5 つのレコードだけが表示されます。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-300">At this point our page still shows just the first five records.</span></span> <span data-ttu-id="1d7ed-301">ただし、これらのプロパティの場所でページング インターフェイスを作成する準備が整いました。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-301">However, with these properties in place, we re ready to create our paging interface.</span></span>

## <a name="adding-the-paging-interface"></a><span data-ttu-id="1d7ed-302">ページング インターフェイスを追加します。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-302">Adding the Paging Interface</span></span>

<span data-ttu-id="1d7ed-303">Let 用途に同じ最初、Previous、次に、最後のページングのインターフェイスは、どのようなページのデータを表示するコントロールが表示されているラベル Web を含むの既定のページング例、および合計ページ数の存在で使用されます。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-303">Let s use the same First, Previous, Next, Last paging interface used in the default paging example, including the Label Web control that displays what page of data is being viewed and how many total pages exist.</span></span> <span data-ttu-id="1d7ed-304">次の 4 つのボタンの Web コントロールと Repeater の下のラベルを追加します。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-304">Add the four Button Web controls and Label below the Repeater.</span></span>

[!code-aspx[Main](sorting-data-in-a-datalist-or-repeater-control-cs/samples/sample14.aspx)]

<span data-ttu-id="1d7ed-305">次に、作成`Click`4 つのボタンのイベント ハンドラー。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-305">Next, create `Click` event handlers for the four Buttons.</span></span> <span data-ttu-id="1d7ed-306">これらのボタンがクリックされたときに更新する必要があります、`StartRowIndex`と Repeater にデータを再バインドします。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-306">When one of these Buttons is clicked, we need to update the `StartRowIndex` and rebind the data to the Repeater.</span></span> <span data-ttu-id="1d7ed-307">First、Previous、および [次へ] ボタンのコードが単純で、最後のボタンの操作を行います方針データの最後のページの開始行インデックスでしょうか</span><span class="sxs-lookup"><span data-stu-id="1d7ed-307">The code for the First, Previous, and Next buttons is simple enough, but for the Last button how do we determine the start row index for the last page of data?</span></span> <span data-ttu-id="1d7ed-308">このインデックスと経由の合計レコードの数がページングされているかを把握する必要があります、次へと最終ボタンを有効にするかどうかを判断できるを計算します。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-308">To compute this index as well as being able to determine whether the Next and Last buttons should be enabled we need to know how many records in total are being paged through.</span></span> <span data-ttu-id="1d7ed-309">これを呼び出すことによって確認できます、`ProductsBLL`クラスの`TotalNumberOfProducts()`メソッド。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-309">We can determine this by calling the `ProductsBLL` class s `TotalNumberOfProducts()` method.</span></span> <span data-ttu-id="1d7ed-310">Let s という名前の読み取り専用、ページ レベルのプロパティを作成する`TotalRowCount`の結果を返す、`TotalNumberOfProducts()`メソッド。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-310">Let s create a read-only, page-level property named `TotalRowCount` that returns the results of the `TotalNumberOfProducts()` method:</span></span>

[!code-csharp[Main](sorting-data-in-a-datalist-or-repeater-control-cs/samples/sample15.cs)]

<span data-ttu-id="1d7ed-311">このプロパティを持つ最後のページの開始行インデックスを判断できますようになりました。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-311">With this property we can now determine the last page s start row index.</span></span> <span data-ttu-id="1d7ed-312">具体的には、その結果の整数値の秒の`TotalRowCount`で割った値 1 を引いた`MaximumRows`を掛けた`MaximumRows`。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-312">Specifically, it s the integer result of the `TotalRowCount` minus 1 divided by `MaximumRows`, multiplied by `MaximumRows`.</span></span> <span data-ttu-id="1d7ed-313">私たちが記述できるように、`Click`ページング インターフェイスの 4 つのボタンのイベント ハンドラー。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-313">We can now write the `Click` event handlers for the four paging interface buttons:</span></span>

[!code-csharp[Main](sorting-data-in-a-datalist-or-repeater-control-cs/samples/sample16.cs)]

<span data-ttu-id="1d7ed-314">最後に、最後のページを表示するときに、データと、次へと最終ボタンの最初のページを表示するときにページング インターフェイスで 1 つ目と前のボタンを無効にする必要があります。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-314">Finally, we need to disable the First and Previous buttons in the paging interface when viewing the first page of data and the Next and Last buttons when viewing the last page.</span></span> <span data-ttu-id="1d7ed-315">これを実現するには、ObjectDataSource に次のコードを追加`Selecting`イベント ハンドラー。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-315">To accomplish this, add the following code to the ObjectDataSource s `Selecting` event handler:</span></span>

[!code-csharp[Main](sorting-data-in-a-datalist-or-repeater-control-cs/samples/sample17.cs)]

<span data-ttu-id="1d7ed-316">これらを追加した後`Click`イベント ハンドラーと、コードを有効にまたは現在の開始行インデックスに基づいて、ページング インターフェイス要素を無効にするには、ブラウザーでページをテストします。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-316">After adding these `Click` event handlers and the code to enable or disable the paging interface elements based on the current start row index, test the page in a browser.</span></span> <span data-ttu-id="1d7ed-317">図 15 に示した最初のページを最初にアクセスすると、[戻る] ボタンは無効です。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-317">As Figure 15 illustrates, when first visiting the page the First and Previous buttons will are disabled.</span></span> <span data-ttu-id="1d7ed-318">最後をクリックすると、最後のページを表示中には、[次へ] をクリックすると、データの 2 番目のページが表示されます (図 16、17 を参照してください)。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-318">Clicking Next shows the second page of data, while clicking Last displays the final page (see Figures 16 and 17).</span></span> <span data-ttu-id="1d7ed-319">データの最後のページを表示するときに、次へと最後のボタンが無効です。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-319">When viewing the last page of data both the Next and Last buttons are disabled.</span></span>

<span data-ttu-id="1d7ed-320">[![最初の製品ページを表示するときに、前と最後のボタンが無効にします。](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image42.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image41.png)</span><span class="sxs-lookup"><span data-stu-id="1d7ed-320">[![The Previous and Last Buttons are Disabled When Viewing the First Page of Products](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image42.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image41.png)</span></span>

<span data-ttu-id="1d7ed-321">**図 15**:最初の製品ページを表示するときに、前と最後のボタンが無効に ([フルサイズの画像を表示する をクリックします](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image43.png))。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-321">**Figure 15**: The Previous and Last Buttons are Disabled When Viewing the First Page of Products ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image43.png))</span></span>

<span data-ttu-id="1d7ed-322">[![2 つ目の製品ページが表示されます。](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image45.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image44.png)</span><span class="sxs-lookup"><span data-stu-id="1d7ed-322">[![The Second Page of Products are Displayed](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image45.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image44.png)</span></span>

<span data-ttu-id="1d7ed-323">**図 16**:2 つ目の製品ページが表示されます ([フルサイズの画像を表示する をクリックします](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image46.png))。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-323">**Figure 16**: The Second Page of Products are Displayed ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image46.png))</span></span>

<span data-ttu-id="1d7ed-324">[![クリックすると過去のデータの最後のページを表示します。](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image48.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image47.png)</span><span class="sxs-lookup"><span data-stu-id="1d7ed-324">[![Clicking Last Displays the Final Page of Data](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image48.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image47.png)</span></span>

<span data-ttu-id="1d7ed-325">**図 17**:最後のクリックしてには、データの最終的なページが表示されます ([フルサイズの画像を表示する をクリックします](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image49.png))。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-325">**Figure 17**: Clicking Last Displays the Final Page of Data ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image49.png))</span></span>

## <a name="step-7-including-sorting-support-with-the-custom-paged-repeater"></a><span data-ttu-id="1d7ed-326">手順 7: Repeater をページング サポートをカスタムの並べ替えを含む</span><span class="sxs-lookup"><span data-stu-id="1d7ed-326">Step 7: Including Sorting Support with the Custom Paged Repeater</span></span>

<span data-ttu-id="1d7ed-327">これでカスタム ページングを実装すると、並べ替えを含めるには、準備ができ次第サポートされています。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-327">Now that custom paging has been implemented, we re ready to include sorting support.</span></span> <span data-ttu-id="1d7ed-328">`ProductsBLL`クラス s`GetProductsPagedAndSorted`メソッドには、同じ*startRowIndex*と*maximumRows*入力パラメーターとして`GetProductsPaged`、追加の許可が*sortExpression*入力パラメーター。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-328">The `ProductsBLL` class s `GetProductsPagedAndSorted` method has the same *startRowIndex* and *maximumRows* input parameters as `GetProductsPaged`, but permits an additional *sortExpression* input parameter.</span></span> <span data-ttu-id="1d7ed-329">使用する、`GetProductsPagedAndSorted`メソッドから`SortingWithCustomPaging.aspx`、次の手順を実行する必要があります。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-329">To use the `GetProductsPagedAndSorted` method from `SortingWithCustomPaging.aspx`, we need to perform the following steps:</span></span>

1. <span data-ttu-id="1d7ed-330">ObjectDataSource s 変更`SelectMethod`プロパティから`GetProductsPaged`に`GetProductsPagedAndSorted`します。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-330">Change the ObjectDataSource s `SelectMethod` property from `GetProductsPaged` to `GetProductsPagedAndSorted`.</span></span>
2. <span data-ttu-id="1d7ed-331">追加、 *sortExpression* `Parameter` ObjectDataSource s オブジェクト`SelectParameters`コレクション。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-331">Add a *sortExpression* `Parameter` object to the ObjectDataSource s `SelectParameters` collection.</span></span>
3. <span data-ttu-id="1d7ed-332">プライベートであり、ページ レベルの作成`SortExpression`ページのビュー ステートをポストバック間でその値を保持するプロパティ。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-332">Create a private, page-level `SortExpression` property that persists its value across postbacks through the page s view state.</span></span>
4. <span data-ttu-id="1d7ed-333">ObjectDataSource %s 更新`Selecting`ObjectDataSource s を割り当てるには、イベント ハンドラー *sortExpression*ページ レベルの値をパラメーター`SortExpression`プロパティ。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-333">Update the ObjectDataSource s `Selecting` event handler to assign the ObjectDataSource s *sortExpression* parameter the value of the page-level `SortExpression` property.</span></span>
5. <span data-ttu-id="1d7ed-334">並べ替えのインターフェイスを作成します。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-334">Create the sorting interface.</span></span>

<span data-ttu-id="1d7ed-335">ObjectDataSource s を更新することで開始`SelectMethod`プロパティと追加、 *sortExpression* `Parameter`します。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-335">Start by updating the ObjectDataSource s `SelectMethod` property and adding a *sortExpression* `Parameter`.</span></span> <span data-ttu-id="1d7ed-336">確認、 *sortExpression* `Parameter` s`Type`プロパティに設定されて`String`します。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-336">Make sure that the *sortExpression* `Parameter` s `Type` property is set to `String`.</span></span> <span data-ttu-id="1d7ed-337">これら最初の 2 つのタスクを完了すると、ObjectDataSource s の宣言型マークアップは、次のようになります。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-337">After completing these first two tasks, the ObjectDataSource s declarative markup should look like the following:</span></span>

[!code-aspx[Main](sorting-data-in-a-datalist-or-repeater-control-cs/samples/sample18.aspx)]

<span data-ttu-id="1d7ed-338">次に、ページ レベル必要があります`SortExpression`ビューステートにシリアル化する値を持つプロパティです。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-338">Next, we need a page-level `SortExpression` property whose value is serialized to view state.</span></span> <span data-ttu-id="1d7ed-339">並べ替え式の値が設定されていない場合は、既定値として ProductName を使用します。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-339">If no sort expression value has been set, use ProductName as the default:</span></span>

[!code-csharp[Main](sorting-data-in-a-datalist-or-repeater-control-cs/samples/sample19.cs)]

<span data-ttu-id="1d7ed-340">ObjectDataSource を呼び出す前に、`GetProductsPagedAndSorted`メソッドを設定する必要があります、 *sortExpression* `Parameter`の値に、`SortExpression`プロパティ。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-340">Before the ObjectDataSource invokes the `GetProductsPagedAndSorted` method we need to set the *sortExpression* `Parameter` to the value of the `SortExpression` property.</span></span> <span data-ttu-id="1d7ed-341">`Selecting`イベント ハンドラーでは、次のコード行を追加します。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-341">In the `Selecting` event handler, add the following line of code:</span></span>

[!code-csharp[Main](sorting-data-in-a-datalist-or-repeater-control-cs/samples/sample20.cs)]

<span data-ttu-id="1d7ed-342">残っているは、並べ替えのインターフェイスを実装します。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-342">All that remains is to implement the sorting interface.</span></span> <span data-ttu-id="1d7ed-343">最後の例で行ったよう s 製品名、カテゴリ、または供給業者によって結果の並べ替えにユーザーを許可する 3 つのボタンの Web コントロールを使用して実装されている並べ替えインターフェイスを持っていることができます。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-343">As we did in the last example, let s have the sorting interface implemented using three Button Web controls that allow the user to sort the results by product name, category, or supplier.</span></span>

[!code-aspx[Main](sorting-data-in-a-datalist-or-repeater-control-cs/samples/sample21.aspx)]

<span data-ttu-id="1d7ed-344">作成`Click`これら 3 つのボタン コントロールのイベント ハンドラー。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-344">Create `Click` event handlers for these three Button controls.</span></span> <span data-ttu-id="1d7ed-345">イベント ハンドラーのリセット、`StartRowIndex`を 0 に設定、`SortExpression`適切な値、および Repeater にデータを再バインドします。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-345">In the event handler, reset the `StartRowIndex` to 0, set the `SortExpression` to the appropriate value, and rebind the data to the Repeater:</span></span>

[!code-csharp[Main](sorting-data-in-a-datalist-or-repeater-control-cs/samples/sample22.cs)]

<span data-ttu-id="1d7ed-346">すべてが s で終了です。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-346">That s all there is to it!</span></span> <span data-ttu-id="1d7ed-347">カスタム ページングと並べ替えを実装する手順の数値の中の手順が既定のページングの必要なものによく似ています。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-347">While there were a number of steps to get custom paging and sorting implemented, the steps were very similar to those needed for default paging.</span></span> <span data-ttu-id="1d7ed-348">図 18 では、カテゴリ別に並べ替えてときにデータの最後のページを表示するときに、製品が表示されます。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-348">Figure 18 shows the products when viewing the last page of data when sorted by category.</span></span>

<span data-ttu-id="1d7ed-349">[![カテゴリ別に並べ替え、データの最後のページが表示されます。](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image51.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image50.png)</span><span class="sxs-lookup"><span data-stu-id="1d7ed-349">[![The Last Page of Data, Sorted by Category, is Displayed](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image51.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image50.png)</span></span>

<span data-ttu-id="1d7ed-350">**図 18**:カテゴリ別に並べ替え、データの最後のページが表示されます ([フルサイズの画像を表示する をクリックします](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image52.png))。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-350">**Figure 18**: The Last Page of Data, Sorted by Category, is Displayed ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image52.png))</span></span>

> [!NOTE]
> <span data-ttu-id="1d7ed-351">前の例、並べ替え式として使用された仕入業者によって並べ替えるときにします。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-351">In previous examples, when sorting by the supplier SupplierName was used as the sort expression.</span></span> <span data-ttu-id="1d7ed-352">ただし、カスタムのページングの実装の CompanyName を使用する必要があります。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-352">However, for the custom paging implementation, we need to use CompanyName.</span></span> <span data-ttu-id="1d7ed-353">ため、これは、ストアド プロシージャをカスタム ページングを実装する責任を負います`GetProductsPagedAndSorted`に並べ替え式を渡します、`ROW_NUMBER()`キーワード、`ROW_NUMBER()`キーワードは、別名ではなく、実際の列名が必要です。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-353">This is because the stored procedure responsible for implementing custom paging `GetProductsPagedAndSorted` passes the sort expression into the `ROW_NUMBER()` keyword, The `ROW_NUMBER()` keyword requires the actual column name rather than an alias.</span></span> <span data-ttu-id="1d7ed-354">したがって、使用する必要があります`CompanyName`(内の列の名前、`Suppliers`テーブル) で使用される別名ではなく、`SELECT`クエリ (`SupplierName`) の並べ替え式。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-354">Therefore, we must use `CompanyName` (the name of the column in the `Suppliers` table) rather than the alias used in the `SELECT` query (`SupplierName`) for the sort expression.</span></span>

## <a name="summary"></a><span data-ttu-id="1d7ed-355">まとめ</span><span class="sxs-lookup"><span data-stu-id="1d7ed-355">Summary</span></span>

<span data-ttu-id="1d7ed-356">どちらも、DataList と Repeater は、組み込みの並べ替えのサポートを提供が、少しのコードとカスタムの並べ替えインターフェイスでこのような機能を追加できます。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-356">Neither the DataList nor Repeater offer built-in sorting support, but with a bit of code and a custom sorting interface, such functionality can be added.</span></span> <span data-ttu-id="1d7ed-357">を通じて、並べ替え式を指定できます、並べ替え、ページングを実装する場合、 `DataSourceSelectArguments` ObjectDataSource s にオブジェクトが渡された`Select`メソッド。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-357">When implementing sorting, but not paging, the sort expression can be specified through the `DataSourceSelectArguments` object passed into the ObjectDataSource s `Select` method.</span></span> <span data-ttu-id="1d7ed-358">これは、`DataSourceSelectArguments`オブジェクト`SortExpression`プロパティは、ObjectDataSource s で割り当てられる`Selecting`イベント ハンドラー。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-358">This `DataSourceSelectArguments` object s `SortExpression` property can be assigned in the ObjectDataSource s `Selecting` event handler.</span></span>

<span data-ttu-id="1d7ed-359">DataList または Repeater 既にページング サポートを提供するには、並べ替え機能を追加するには、最も簡単な方法は、並べ替え式を受け取るメソッドを追加するビジネス ロジック レイヤーをカスタマイズしています。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-359">To add sorting capabilities to a DataList or Repeater that already provides paging support, the easiest approach is to customize the Business Logic Layer to include a method that accepts a sort expression.</span></span> <span data-ttu-id="1d7ed-360">この情報渡すことができますで ObjectDataSource s パラメーターを介して`SelectParameters`します。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-360">This information can then be passed in through a parameter in the ObjectDataSource s `SelectParameters`.</span></span>

<span data-ttu-id="1d7ed-361">このチュートリアルでは、DataList と Repeater コントロールによるページングと並べ替え、調査を完了します。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-361">This tutorial completes our examination of paging and sorting with the DataList and Repeater controls.</span></span> <span data-ttu-id="1d7ed-362">次へと最終チュートリアルでは、DataList と Repeater のテンプレートにアイテムごとにいくつか、ユーザーが開始したカスタムの機能を提供するために Button Web コントロールを追加する方法を説明します。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-362">Our next and final tutorial will examine how to add Button Web controls to the DataList and Repeater s templates in order to provide some custom, user-initiated functionality on a per-item basis.</span></span>

<span data-ttu-id="1d7ed-363">満足のプログラミングです。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-363">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="1d7ed-364">執筆者紹介</span><span class="sxs-lookup"><span data-stu-id="1d7ed-364">About the Author</span></span>

<span data-ttu-id="1d7ed-365">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml)、7 つ受け取りますブックおよびの創設者の著者[4GuysFromRolla.com](http://www.4guysfromrolla.com)、Microsoft Web テクノロジと 1998 年から携わっています。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-365">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="1d7ed-366">Scott は、フリーのコンサルタント、トレーナー、およびライターとして動作します。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-366">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="1d7ed-367">最新の著書は[ *Sams 教える自分で ASP.NET 2.0 24 時間以内に*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)します。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-367">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="1d7ed-368">彼に到達できる[mitchell@4GuysFromRolla.comします。](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="1d7ed-368">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="1d7ed-369">彼のブログにあるでまたは[ http://ScottOnWriting.NET](http://ScottOnWriting.NET)します。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-369">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="1d7ed-370">特別なに感謝します。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-370">Special Thanks To</span></span>

<span data-ttu-id="1d7ed-371">このチュートリアル シリーズは、多くの便利なレビュー担当者によってレビューされました。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-371">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="1d7ed-372">このチュートリアルでは、潜在顧客レビュー担当者は、David Suru でした。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-372">Lead reviewer for this tutorial was David Suru.</span></span> <span data-ttu-id="1d7ed-373">今後、MSDN の記事を確認したいですか。</span><span class="sxs-lookup"><span data-stu-id="1d7ed-373">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="1d7ed-374">場合は、筆者に[mitchell@4GuysFromRolla.comします。](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="1d7ed-374">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="1d7ed-375">[前へ](paging-report-data-in-a-datalist-or-repeater-control-cs.md)
> [次へ](paging-report-data-in-a-datalist-or-repeater-control-vb.md)</span><span class="sxs-lookup"><span data-stu-id="1d7ed-375">[Previous](paging-report-data-in-a-datalist-or-repeater-control-cs.md)
[Next](paging-report-data-in-a-datalist-or-repeater-control-vb.md)</span></span>

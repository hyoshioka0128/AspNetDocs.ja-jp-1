---
uid: web-forms/overview/data-access/enhancing-the-gridview/inserting-a-new-record-from-the-gridview-s-footer-cs
title: GridView のフッターから新しいレコードを挿入する (C#) |Microsoft Docs
author: rick-anderson
description: GridView コントロールには、新しいデータレコードを挿入するための組み込みのサポートが用意されていませんが、このチュートリアルでは、GridView を拡張して...
ms.author: riande
ms.date: 03/06/2007
ms.assetid: 49545652-98af-46ba-9dbc-9ab529805d9b
msc.legacyurl: /web-forms/overview/data-access/enhancing-the-gridview/inserting-a-new-record-from-the-gridview-s-footer-cs
msc.type: authoredcontent
ms.openlocfilehash: 6b337fe395a0ed54b03767111e73ea6d6c0ba23a
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 03/06/2020
ms.locfileid: "78477526"
---
# <a name="inserting-a-new-record-from-the-gridviews-footer-c"></a><span data-ttu-id="74c3b-103">GridView のフッターから新しいレコードを挿入する (C#)</span><span class="sxs-lookup"><span data-stu-id="74c3b-103">Inserting a New Record from the GridView's Footer (C#)</span></span>

<span data-ttu-id="74c3b-104">[Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="74c3b-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="74c3b-105">[サンプルアプリのダウンロード](https://download.microsoft.com/download/4/a/7/4a7a3b18-d80e-4014-8e53-a6a2427f0d93/ASPNET_Data_Tutorial_53_CS.exe)または[PDF のダウンロード](inserting-a-new-record-from-the-gridview-s-footer-cs/_static/datatutorial53cs1.pdf)</span><span class="sxs-lookup"><span data-stu-id="74c3b-105">[Download Sample App](https://download.microsoft.com/download/4/a/7/4a7a3b18-d80e-4014-8e53-a6a2427f0d93/ASPNET_Data_Tutorial_53_CS.exe) or [Download PDF](inserting-a-new-record-from-the-gridview-s-footer-cs/_static/datatutorial53cs1.pdf)</span></span>

> <span data-ttu-id="74c3b-106">GridView コントロールは、新しいデータレコードを挿入するための組み込みサポートを提供していませんが、このチュートリアルでは、挿入インターフェイスを含めるように GridView を拡張する方法について説明します。</span><span class="sxs-lookup"><span data-stu-id="74c3b-106">While the GridView control does not provide built-in support for inserting a new record of data, this tutorial shows how to augment the GridView to include an inserting interface.</span></span>

## <a name="introduction"></a><span data-ttu-id="74c3b-107">はじめに</span><span class="sxs-lookup"><span data-stu-id="74c3b-107">Introduction</span></span>

<span data-ttu-id="74c3b-108">[「データの挿入、更新、および削除の概要](../editing-inserting-and-deleting-data/an-overview-of-inserting-updating-and-deleting-data-cs.md)」のチュートリアルで説明したように、GridView、DetailsView、および FormView Web コントロールには、組み込みのデータ変更機能が含まれています。</span><span class="sxs-lookup"><span data-stu-id="74c3b-108">As discussed in the [An Overview of Inserting, Updating, and Deleting Data](../editing-inserting-and-deleting-data/an-overview-of-inserting-updating-and-deleting-data-cs.md) tutorial, the GridView, DetailsView, and FormView Web controls each include built-in data modification capabilities.</span></span> <span data-ttu-id="74c3b-109">宣言型のデータソースコントロールで使用する場合、これら3つの Web コントロールをすばやく簡単に構成して、データを変更したり、コードを1行も記述しなくてもかまいません。</span><span class="sxs-lookup"><span data-stu-id="74c3b-109">When used with declarative data source controls, these three Web controls can be quickly and easily configured to modify data - and in scenarios without needing to write a single line of code.</span></span> <span data-ttu-id="74c3b-110">残念ながら、DetailsView コントロールと FormView コントロールのみが、組み込みの挿入、編集、および削除機能を提供しています。</span><span class="sxs-lookup"><span data-stu-id="74c3b-110">Unfortunately, only the DetailsView and FormView controls provide built-in inserting, editing, and deleting capabilities.</span></span> <span data-ttu-id="74c3b-111">GridView は、編集および削除のサポートのみを提供します。</span><span class="sxs-lookup"><span data-stu-id="74c3b-111">The GridView only offers editing and deleting support.</span></span> <span data-ttu-id="74c3b-112">ただし、1つのカギ線のグリースでは、挿入インターフェイスを含めるように GridView を拡張できます。</span><span class="sxs-lookup"><span data-stu-id="74c3b-112">However, with a little elbow grease, we can augment the GridView to include an inserting interface.</span></span>

<span data-ttu-id="74c3b-113">GridView に挿入機能を追加する際には、新しいレコードを追加する方法を決定し、挿入インターフェイスを作成し、新しいレコードを挿入するコードを記述する必要があります。</span><span class="sxs-lookup"><span data-stu-id="74c3b-113">In adding inserting capabilities to the GridView, we are responsible for deciding on how new records will be added, creating the inserting interface, and writing the code to insert the new record.</span></span> <span data-ttu-id="74c3b-114">このチュートリアルでは、GridView のフッター行に挿入インターフェイスを追加する方法について説明します (図1を参照)。</span><span class="sxs-lookup"><span data-stu-id="74c3b-114">In this tutorial we will look at adding the inserting interface to the GridView s footer row (see Figure 1).</span></span> <span data-ttu-id="74c3b-115">各列のフッターセルには、適切なデータコレクションユーザーインターフェイス要素 (製品名のテキストボックス、業者の DropDownList など) が含まれます。</span><span class="sxs-lookup"><span data-stu-id="74c3b-115">The footer cell for each column includes the appropriate data collection user interface element (a TextBox for the product s name, a DropDownList for the supplier, and so on).</span></span> <span data-ttu-id="74c3b-116">また、[追加] ボタンの列も必要です。クリックすると、フッター行に指定された値を使用して、ポストバックが発生し、`Products` テーブルに新しいレコードが挿入されます。</span><span class="sxs-lookup"><span data-stu-id="74c3b-116">We also need a column for an Add button that, when clicked, will cause a postback and insert a new record into the `Products` table using the values supplied in the footer row.</span></span>

<span data-ttu-id="74c3b-117">[フッター行に ![新しい製品を追加するためのインターフェイスが用意されています。](inserting-a-new-record-from-the-gridview-s-footer-cs/_static/image1.gif)](inserting-a-new-record-from-the-gridview-s-footer-cs/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="74c3b-117">[![The Footer Row Provides an Interface for Adding New Products](inserting-a-new-record-from-the-gridview-s-footer-cs/_static/image1.gif)](inserting-a-new-record-from-the-gridview-s-footer-cs/_static/image1.png)</span></span>

<span data-ttu-id="74c3b-118">**図 1**: フッター行は、新しい製品を追加するためのインターフェイスを提供します ([クリックすると、フルサイズの画像が表示](inserting-a-new-record-from-the-gridview-s-footer-cs/_static/image2.png)されます)</span><span class="sxs-lookup"><span data-stu-id="74c3b-118">**Figure 1**: The Footer Row Provides an Interface for Adding New Products ([Click to view full-size image](inserting-a-new-record-from-the-gridview-s-footer-cs/_static/image2.png))</span></span>

## <a name="step-1-displaying-product-information-in-a-gridview"></a><span data-ttu-id="74c3b-119">手順 1: GridView で製品情報を表示する</span><span class="sxs-lookup"><span data-stu-id="74c3b-119">Step 1: Displaying Product Information in a GridView</span></span>

<span data-ttu-id="74c3b-120">GridView s フッターでの挿入インターフェイスの作成については、まず、データベース内の製品を一覧表示するページへの GridView の追加について説明します。</span><span class="sxs-lookup"><span data-stu-id="74c3b-120">Before we concern ourselves with creating the inserting interface in the GridView s footer, let s first focus on adding a GridView to the page that lists the products in the database.</span></span> <span data-ttu-id="74c3b-121">まず、`EnhancedGridView` フォルダーの [`InsertThroughFooter.aspx`] ページを開き、GridView をツールボックスからデザイナーにドラッグします。 GridView の `ID` プロパティを `Products`に設定します。</span><span class="sxs-lookup"><span data-stu-id="74c3b-121">Start by opening the `InsertThroughFooter.aspx` page in the `EnhancedGridView` folder and drag a GridView from the Toolbox onto the Designer, setting the GridView s `ID` property to `Products`.</span></span> <span data-ttu-id="74c3b-122">次に、GridView s スマートタグを使用して、`ProductsDataSource`という名前の新しい ObjectDataSource にバインドします。</span><span class="sxs-lookup"><span data-stu-id="74c3b-122">Next, use the GridView s smart tag to bind it to a new ObjectDataSource named `ProductsDataSource`.</span></span>

<span data-ttu-id="74c3b-123">[![新しい ObjectDataSource Datasource を作成する](inserting-a-new-record-from-the-gridview-s-footer-cs/_static/image2.gif)](inserting-a-new-record-from-the-gridview-s-footer-cs/_static/image3.png)</span><span class="sxs-lookup"><span data-stu-id="74c3b-123">[![Create a New ObjectDataSource Named ProductsDataSource](inserting-a-new-record-from-the-gridview-s-footer-cs/_static/image2.gif)](inserting-a-new-record-from-the-gridview-s-footer-cs/_static/image3.png)</span></span>

<span data-ttu-id="74c3b-124">**図 2**: `ProductsDataSource` という名前の新しい ObjectDataSource を作成[する (クリックすると、フルサイズの画像が表示](inserting-a-new-record-from-the-gridview-s-footer-cs/_static/image4.png)される)</span><span class="sxs-lookup"><span data-stu-id="74c3b-124">**Figure 2**: Create a New ObjectDataSource Named `ProductsDataSource` ([Click to view full-size image](inserting-a-new-record-from-the-gridview-s-footer-cs/_static/image4.png))</span></span>

<span data-ttu-id="74c3b-125">`ProductsBLL` クラス s `GetProducts()` メソッドを使用して製品情報を取得するように ObjectDataSource を構成します。</span><span class="sxs-lookup"><span data-stu-id="74c3b-125">Configure the ObjectDataSource to use the `ProductsBLL` class s `GetProducts()` method to retrieve product information.</span></span> <span data-ttu-id="74c3b-126">このチュートリアルでは、を使用して挿入機能を追加するだけで、編集や削除について心配することはありません。</span><span class="sxs-lookup"><span data-stu-id="74c3b-126">For this tutorial, let s focus strictly on adding inserting capabilities and not worry about editing and deleting.</span></span> <span data-ttu-id="74c3b-127">そのため、[挿入] タブのドロップダウンリストが `AddProduct()` に設定されていること、および [更新] タブと [削除] タブのドロップダウンリストが [(なし)] に設定されていることを確認してください。</span><span class="sxs-lookup"><span data-stu-id="74c3b-127">Therefore, make sure that the drop-down list in the INSERT tab is set to `AddProduct()` and that the drop-down lists in the UPDATE and DELETE tabs are set to (None) .</span></span>

<span data-ttu-id="74c3b-128">[AddProduct メソッドを ObjectDataSource s Insert () メソッドにマップ ![には](inserting-a-new-record-from-the-gridview-s-footer-cs/_static/image3.gif)](inserting-a-new-record-from-the-gridview-s-footer-cs/_static/image5.png)</span><span class="sxs-lookup"><span data-stu-id="74c3b-128">[![Map the AddProduct Method to the ObjectDataSource s Insert() Method](inserting-a-new-record-from-the-gridview-s-footer-cs/_static/image3.gif)](inserting-a-new-record-from-the-gridview-s-footer-cs/_static/image5.png)</span></span>

<span data-ttu-id="74c3b-129">**図 3**: `AddProduct` メソッドを ObjectDataSource s `Insert()` メソッドにマップする ([クリックしてフルサイズのイメージを表示する](inserting-a-new-record-from-the-gridview-s-footer-cs/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="74c3b-129">**Figure 3**: Map the `AddProduct` Method to the ObjectDataSource s `Insert()` Method ([Click to view full-size image](inserting-a-new-record-from-the-gridview-s-footer-cs/_static/image6.png))</span></span>

<span data-ttu-id="74c3b-130">[[更新] タブと [タブの削除] ドロップダウンリストを [(なし)] に設定 ![](inserting-a-new-record-from-the-gridview-s-footer-cs/_static/image4.gif)](inserting-a-new-record-from-the-gridview-s-footer-cs/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="74c3b-130">[![Set the UPDATE and DELETE Tabs Drop-Down Lists to (None)](inserting-a-new-record-from-the-gridview-s-footer-cs/_static/image4.gif)](inserting-a-new-record-from-the-gridview-s-footer-cs/_static/image7.png)</span></span>

<span data-ttu-id="74c3b-131">**図 4**: [更新] タブと [タブの削除] ドロップダウンリストを [(なし)] に設定する ([クリックしてフルサイズのイメージを表示する](inserting-a-new-record-from-the-gridview-s-footer-cs/_static/image8.png))</span><span class="sxs-lookup"><span data-stu-id="74c3b-131">**Figure 4**: Set the UPDATE and DELETE Tabs Drop-Down Lists to (None) ([Click to view full-size image](inserting-a-new-record-from-the-gridview-s-footer-cs/_static/image8.png))</span></span>

<span data-ttu-id="74c3b-132">ObjectDataSource s のデータソース構成ウィザードを完了すると、対応する各データフィールドの GridView にフィールドが自動的に追加されます。</span><span class="sxs-lookup"><span data-stu-id="74c3b-132">After completing the ObjectDataSource s Configure Data Source wizard, Visual Studio will automatically add fields to the GridView for each of the corresponding data fields.</span></span> <span data-ttu-id="74c3b-133">ここでは、Visual Studio によって追加されたすべてのフィールドをそのまま使用します。</span><span class="sxs-lookup"><span data-stu-id="74c3b-133">For now, leave all of the fields added by Visual Studio.</span></span> <span data-ttu-id="74c3b-134">このチュートリアルの後の方で、新しいレコードを追加するときに値を指定する必要のないフィールドをいくつか削除します。</span><span class="sxs-lookup"><span data-stu-id="74c3b-134">Later in this tutorial we'll come back and remove some of the fields whose values don t need to be specified when adding a new record.</span></span>

<span data-ttu-id="74c3b-135">データベースには80製品が含まれているため、ユーザーは新しいレコードを追加するために、web ページの一番下までスクロールする必要があります。</span><span class="sxs-lookup"><span data-stu-id="74c3b-135">Since there are close to 80 products in the database, a user will have to scroll all the way down to the bottom of the web page in order to add a new record.</span></span> <span data-ttu-id="74c3b-136">そのため、を使用すると、挿入インターフェイスをより見やすく、アクセスしやすくすることができます。</span><span class="sxs-lookup"><span data-stu-id="74c3b-136">Therefore, let s enable paging to make the inserting interface more visible and accessible.</span></span> <span data-ttu-id="74c3b-137">ページングを有効にするには、GridView のスマートタグから [ページングを有効にする] チェックボックスをオンにします。</span><span class="sxs-lookup"><span data-stu-id="74c3b-137">To turn on paging, simply check the Enable Paging checkbox from the GridView s smart tag.</span></span>

<span data-ttu-id="74c3b-138">この時点で、GridView および ObjectDataSource s 宣言マークアップは次のようになります。</span><span class="sxs-lookup"><span data-stu-id="74c3b-138">At this point, the GridView and ObjectDataSource s declarative markup should look similar to the following:</span></span>

[!code-aspx[Main](inserting-a-new-record-from-the-gridview-s-footer-cs/samples/sample1.aspx)]

<span data-ttu-id="74c3b-139">[すべての製品データフィールドがページングされた GridView に表示される ![](inserting-a-new-record-from-the-gridview-s-footer-cs/_static/image5.gif)](inserting-a-new-record-from-the-gridview-s-footer-cs/_static/image9.png)</span><span class="sxs-lookup"><span data-stu-id="74c3b-139">[![All Product Data Fields are Displayed in a Paged GridView](inserting-a-new-record-from-the-gridview-s-footer-cs/_static/image5.gif)](inserting-a-new-record-from-the-gridview-s-footer-cs/_static/image9.png)</span></span>

<span data-ttu-id="74c3b-140">**図 5**: すべての製品データフィールドがページングされた GridView に表示される ([クリックしてフルサイズの画像を表示する](inserting-a-new-record-from-the-gridview-s-footer-cs/_static/image10.png))</span><span class="sxs-lookup"><span data-stu-id="74c3b-140">**Figure 5**: All Product Data Fields are Displayed in a Paged GridView ([Click to view full-size image](inserting-a-new-record-from-the-gridview-s-footer-cs/_static/image10.png))</span></span>

## <a name="step-2-adding-a-footer-row"></a><span data-ttu-id="74c3b-141">手順 2: フッター行の追加</span><span class="sxs-lookup"><span data-stu-id="74c3b-141">Step 2: Adding a Footer Row</span></span>

<span data-ttu-id="74c3b-142">GridView には、ヘッダー行とデータ行と共に、フッター行が含まれています。</span><span class="sxs-lookup"><span data-stu-id="74c3b-142">Along with its header and data rows, the GridView includes a footer row.</span></span> <span data-ttu-id="74c3b-143">ヘッダーとフッターの行は、GridView の[`ShowHeader`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.gridview.showheader.aspx)と[`ShowFooter`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.gridview.showfooter.aspx)プロパティの値に応じて表示されます。</span><span class="sxs-lookup"><span data-stu-id="74c3b-143">The header and footer rows are displayed depending on the values of the GridView s [`ShowHeader`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.gridview.showheader.aspx) and [`ShowFooter`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.gridview.showfooter.aspx) properties.</span></span> <span data-ttu-id="74c3b-144">フッター行を表示するには、単に `ShowFooter` プロパティを `true`に設定します。</span><span class="sxs-lookup"><span data-stu-id="74c3b-144">To show the footer row, simply set the `ShowFooter` property to `true`.</span></span> <span data-ttu-id="74c3b-145">図6に示すように、`ShowFooter` プロパティを `true` に設定すると、グリッドにフッター行が追加されます。</span><span class="sxs-lookup"><span data-stu-id="74c3b-145">As Figure 6 illustrates, setting the `ShowFooter` property to `true` adds a footer row to the grid.</span></span>

<span data-ttu-id="74c3b-146">[フッター行を表示 ![には、ShowFooter を True に設定します。](inserting-a-new-record-from-the-gridview-s-footer-cs/_static/image6.gif)](inserting-a-new-record-from-the-gridview-s-footer-cs/_static/image11.png)</span><span class="sxs-lookup"><span data-stu-id="74c3b-146">[![To Display the Footer Row, Set ShowFooter to True](inserting-a-new-record-from-the-gridview-s-footer-cs/_static/image6.gif)](inserting-a-new-record-from-the-gridview-s-footer-cs/_static/image11.png)</span></span>

<span data-ttu-id="74c3b-147">**図 6**: フッター行を表示するには `ShowFooter` を `True` に設定します ([クリックすると、フルサイズの画像が表示](inserting-a-new-record-from-the-gridview-s-footer-cs/_static/image12.png)されます)</span><span class="sxs-lookup"><span data-stu-id="74c3b-147">**Figure 6**: To Display the Footer Row, Set `ShowFooter` to `True` ([Click to view full-size image](inserting-a-new-record-from-the-gridview-s-footer-cs/_static/image12.png))</span></span>

<span data-ttu-id="74c3b-148">フッター行の背景色が濃い赤になっていることに注意してください。</span><span class="sxs-lookup"><span data-stu-id="74c3b-148">Note that the footer row has a dark red background color.</span></span> <span data-ttu-id="74c3b-149">これは、DataWebControls テーマが作成され、 [ObjectDataSource チュートリアルでデータを表示するとき](../basic-reporting/displaying-data-with-the-objectdatasource-cs.md)にすべてのページに適用されるためです。</span><span class="sxs-lookup"><span data-stu-id="74c3b-149">This is due to the DataWebControls Theme we created and applied to all pages back in the [Displaying Data With the ObjectDataSource](../basic-reporting/displaying-data-with-the-objectdatasource-cs.md) tutorial.</span></span> <span data-ttu-id="74c3b-150">具体的には、`GridView.skin` ファイルによって、`FooterStyle` CSS クラスを使用するように `FooterStyle` プロパティが構成されます。</span><span class="sxs-lookup"><span data-stu-id="74c3b-150">Specifically, the `GridView.skin` file configures the `FooterStyle` property such that is uses the `FooterStyle` CSS class.</span></span> <span data-ttu-id="74c3b-151">`FooterStyle` クラスは、`Styles.css` で次のように定義されています。</span><span class="sxs-lookup"><span data-stu-id="74c3b-151">The `FooterStyle` class is defined in `Styles.css` as follows:</span></span>

[!code-css[Main](inserting-a-new-record-from-the-gridview-s-footer-cs/samples/sample2.css)]

> [!NOTE]
> <span data-ttu-id="74c3b-152">前のチュートリアルでは、GridView のフッター行を使用しました。</span><span class="sxs-lookup"><span data-stu-id="74c3b-152">We ve explored using the GridView s footer row in previous tutorials.</span></span> <span data-ttu-id="74c3b-153">必要に応じて、「 [GridView のフッターチュートリアル」の概要情報を表示](../custom-formatting/displaying-summary-information-in-the-gridview-s-footer-cs.md)して、リフレッシャーを参照してください。</span><span class="sxs-lookup"><span data-stu-id="74c3b-153">If needed, refer back to the [Displaying Summary Information in the GridView's Footer](../custom-formatting/displaying-summary-information-in-the-gridview-s-footer-cs.md) tutorial for a refresher.</span></span>

<span data-ttu-id="74c3b-154">`ShowFooter` プロパティを `true`に設定した後、出力をブラウザーに表示します。</span><span class="sxs-lookup"><span data-stu-id="74c3b-154">After setting the `ShowFooter` property to `true`, take a moment to view the output in a browser.</span></span> <span data-ttu-id="74c3b-155">現在、フッター行にはテキストまたは Web コントロールは含まれていません。</span><span class="sxs-lookup"><span data-stu-id="74c3b-155">Currently the footer row doesn t contain any text or Web controls.</span></span> <span data-ttu-id="74c3b-156">手順3では、適切な挿入インターフェイスが含まれるように、各 GridView フィールドのフッターを変更します。</span><span class="sxs-lookup"><span data-stu-id="74c3b-156">In Step 3 we'll modify the footer for each GridView field so that it includes the appropriate inserting interface.</span></span>

<span data-ttu-id="74c3b-157">[![、空のフッター行がページングインターフェイスコントロールの上に表示されます。](inserting-a-new-record-from-the-gridview-s-footer-cs/_static/image7.gif)](inserting-a-new-record-from-the-gridview-s-footer-cs/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="74c3b-157">[![The Empty Footer Row is Displayed Above the Paging Interface Controls](inserting-a-new-record-from-the-gridview-s-footer-cs/_static/image7.gif)](inserting-a-new-record-from-the-gridview-s-footer-cs/_static/image13.png)</span></span>

<span data-ttu-id="74c3b-158">**図 7**: ページングインターフェイスコントロールの上に空のフッター行が表示される ([クリックすると、フルサイズの画像が表示](inserting-a-new-record-from-the-gridview-s-footer-cs/_static/image14.png)されます)</span><span class="sxs-lookup"><span data-stu-id="74c3b-158">**Figure 7**: The Empty Footer Row is Displayed Above the Paging Interface Controls ([Click to view full-size image](inserting-a-new-record-from-the-gridview-s-footer-cs/_static/image14.png))</span></span>

## <a name="step-3-customizing-the-footer-row"></a><span data-ttu-id="74c3b-159">手順 3: フッター行のカスタマイズ</span><span class="sxs-lookup"><span data-stu-id="74c3b-159">Step 3: Customizing the Footer Row</span></span>

<span data-ttu-id="74c3b-160">[Gridview コントロールチュートリアルの「Using TemplateFields」 (templatefields](../custom-formatting/using-templatefields-in-the-gridview-control-cs.md)または CheckBoxFields ではなく) templatefields を使用して特定の GridView 列の表示を大幅にカスタマイズする方法について説明しました。[データ変更インターフェイスのカスタマイズ](../editing-inserting-and-deleting-data/customizing-the-data-modification-interface-cs.md)については、「templatefields を使用して GridView の編集インターフェイスをカスタマイズする」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="74c3b-160">Back in the [Using TemplateFields in the GridView Control](../custom-formatting/using-templatefields-in-the-gridview-control-cs.md) tutorial we saw how to greatly customize the display of a particular GridView column using TemplateFields (as opposed to BoundFields or CheckBoxFields); in [Customizing the Data Modification Interface](../editing-inserting-and-deleting-data/customizing-the-data-modification-interface-cs.md) we looked at using TemplateFields to customize the editing interface in a GridView.</span></span> <span data-ttu-id="74c3b-161">TemplateField は、特定の種類の行に使用されるマークアップ、Web コントロール、およびデータバインディング構文の組み合わせを定義する多数のテンプレートで構成されていることを思い出してください。</span><span class="sxs-lookup"><span data-stu-id="74c3b-161">Recall that a TemplateField is composed of a number of templates that defines the mix of markup, Web controls, and databinding syntax used for certain types of rows.</span></span> <span data-ttu-id="74c3b-162">たとえば、`ItemTemplate`では、読み取り専用の行に使用するテンプレートを指定し、`EditItemTemplate` は編集可能な行のテンプレートを定義します。</span><span class="sxs-lookup"><span data-stu-id="74c3b-162">The `ItemTemplate`, for example, specifies the template used for read-only rows, while the `EditItemTemplate` defines the template for the editable row.</span></span>

<span data-ttu-id="74c3b-163">TemplateField には、`ItemTemplate` と `EditItemTemplate`と共に、フッター行の内容を指定する `FooterTemplate` も含まれています。</span><span class="sxs-lookup"><span data-stu-id="74c3b-163">Along with the `ItemTemplate` and `EditItemTemplate`, the TemplateField also includes a `FooterTemplate` that specifies the content for the footer row.</span></span> <span data-ttu-id="74c3b-164">そのため、各フィールドに必要な Web コントロールを `FooterTemplate`に追加できます。</span><span class="sxs-lookup"><span data-stu-id="74c3b-164">Therefore, we can add the Web controls needed for each field s inserting interface into the `FooterTemplate`.</span></span> <span data-ttu-id="74c3b-165">開始するには、GridView のすべてのフィールドを TemplateFields に変換します。</span><span class="sxs-lookup"><span data-stu-id="74c3b-165">To start, convert all of the fields in the GridView to TemplateFields.</span></span> <span data-ttu-id="74c3b-166">これを行うには、GridView のスマートタグの [列の編集] リンクをクリックし、左下隅にある各フィールドを選択して、[このフィールドを TemplateField に変換する] リンクをクリックします。</span><span class="sxs-lookup"><span data-stu-id="74c3b-166">This can be done by clicking the Edit Columns link in the GridView s smart tag, selecting each field in the lower left corner, and clicking the Convert this field into a TemplateField link.</span></span>

![各フィールドを TemplateField に変換します。](inserting-a-new-record-from-the-gridview-s-footer-cs/_static/image8.gif)

<span data-ttu-id="74c3b-168">**図 8**: 各フィールドを TemplateField に変換する</span><span class="sxs-lookup"><span data-stu-id="74c3b-168">**Figure 8**: Convert Each Field Into a TemplateField</span></span>

<span data-ttu-id="74c3b-169">[このフィールドを TemplateField に変換] をクリックすると、現在のフィールドの種類が同等の TemplateField に変わります。</span><span class="sxs-lookup"><span data-stu-id="74c3b-169">Clicking the Convert this field into a TemplateField turns the current field type into an equivalent TemplateField.</span></span> <span data-ttu-id="74c3b-170">たとえば、各 BoundField は、対応するデータフィールドを表示するラベルを含む `ItemTemplate` の TemplateField と、データフィールドをテキストボックスに表示する `EditItemTemplate` に置き換えられます。</span><span class="sxs-lookup"><span data-stu-id="74c3b-170">For example, each BoundField is replaced by a TemplateField with an `ItemTemplate` that contains a Label that displays the corresponding data field and an `EditItemTemplate` that displays the data field in a TextBox.</span></span> <span data-ttu-id="74c3b-171">`ProductName` BoundField は、次の TemplateField マークアップに変換されました。</span><span class="sxs-lookup"><span data-stu-id="74c3b-171">The `ProductName` BoundField has been converted into the following TemplateField markup:</span></span>

[!code-aspx[Main](inserting-a-new-record-from-the-gridview-s-footer-cs/samples/sample3.aspx)]

<span data-ttu-id="74c3b-172">同様に、`Discontinued` CheckBoxField は、`ItemTemplate` と `EditItemTemplate` に CheckBox Web コントロールが含まれている TemplateField に変換されています (`ItemTemplate` のチェックボックスが無効になっています)。</span><span class="sxs-lookup"><span data-stu-id="74c3b-172">Likewise, the `Discontinued` CheckBoxField has been converted into a TemplateField whose `ItemTemplate` and `EditItemTemplate` contain a CheckBox Web control (with the `ItemTemplate` s CheckBox disabled).</span></span> <span data-ttu-id="74c3b-173">読み取り専用 `ProductID` BoundField は、`ItemTemplate` と `EditItemTemplate`の両方でラベルコントロールを持つ TemplateField に変換されました。</span><span class="sxs-lookup"><span data-stu-id="74c3b-173">The read-only `ProductID` BoundField has been converted into a TemplateField with a Label control in both the `ItemTemplate` and `EditItemTemplate`.</span></span> <span data-ttu-id="74c3b-174">つまり、既存の GridView フィールドを TemplateField に変換することは、既存のフィールドの機能を失うことなく、よりカスタマイズ可能な TemplateField に簡単に切り替えることができます。</span><span class="sxs-lookup"><span data-stu-id="74c3b-174">In short, converting an existing GridView field into a TemplateField is a quick and easy way to switch to the more customizable TemplateField without losing any of the existing field s functionality.</span></span>

<span data-ttu-id="74c3b-175">この GridView では編集がサポートされていないため、各 TemplateField から `EditItemTemplate` を削除して、`ItemTemplate`だけを残しておきます。</span><span class="sxs-lookup"><span data-stu-id="74c3b-175">Since the GridView we re working with doesn t support editing, feel free to remove the `EditItemTemplate` from each TemplateField, leaving just the `ItemTemplate`.</span></span> <span data-ttu-id="74c3b-176">この操作を行った後、GridView の宣言型マークアップは次のようになります。</span><span class="sxs-lookup"><span data-stu-id="74c3b-176">After doing this, your GridView s declarative markup should look like the following:</span></span>

[!code-aspx[Main](inserting-a-new-record-from-the-gridview-s-footer-cs/samples/sample4.aspx)]

<span data-ttu-id="74c3b-177">各 GridView フィールドが TemplateField に変換されたので、各 `FooterTemplate`フィールドに適切な挿入インターフェイスを入力できます。</span><span class="sxs-lookup"><span data-stu-id="74c3b-177">Now that each GridView field has been converted into a TemplateField, we can enter the appropriate inserting interface into each field s `FooterTemplate`.</span></span> <span data-ttu-id="74c3b-178">一部のフィールドには、挿入インターフェイス (`ProductID`など) がありません。他のユーザーは、新しい製品の情報を収集するために使用される Web コントロールによって異なります。</span><span class="sxs-lookup"><span data-stu-id="74c3b-178">Some of the fields will not have an inserting interface (`ProductID`, for instance); others will vary in the Web controls used to collect the new product s information.</span></span>

<span data-ttu-id="74c3b-179">編集インターフェイスを作成するには、GridView のスマートタグから [テンプレートの編集] リンクを選択します。</span><span class="sxs-lookup"><span data-stu-id="74c3b-179">To create the editing interface, choose the Edit Templates link from the GridView s smart tag.</span></span> <span data-ttu-id="74c3b-180">次に、ドロップダウンリストから適切なフィールド s `FooterTemplate` を選択し、ツールボックスから適切なコントロールをデザイナーにドラッグします。</span><span class="sxs-lookup"><span data-stu-id="74c3b-180">Then, from the drop-down list, select the appropriate field s `FooterTemplate` and drag the appropriate control from the Toolbox onto the Designer.</span></span>

<span data-ttu-id="74c3b-181">[各フィールドのフッターテンプレートに適切な挿入インターフェイスを追加 ![](inserting-a-new-record-from-the-gridview-s-footer-cs/_static/image9.gif)](inserting-a-new-record-from-the-gridview-s-footer-cs/_static/image15.png)</span><span class="sxs-lookup"><span data-stu-id="74c3b-181">[![Add the Appropriate Inserting Interface to Each Field s FooterTemplate](inserting-a-new-record-from-the-gridview-s-footer-cs/_static/image9.gif)](inserting-a-new-record-from-the-gridview-s-footer-cs/_static/image15.png)</span></span>

<span data-ttu-id="74c3b-182">**図 9**: 各フィールド `FooterTemplate` に適切な挿入インターフェイスを追加する ([クリックすると、フルサイズの画像が表示](inserting-a-new-record-from-the-gridview-s-footer-cs/_static/image16.png)されます)</span><span class="sxs-lookup"><span data-stu-id="74c3b-182">**Figure 9**: Add the Appropriate Inserting Interface to Each Field s `FooterTemplate` ([Click to view full-size image](inserting-a-new-record-from-the-gridview-s-footer-cs/_static/image16.png))</span></span>

<span data-ttu-id="74c3b-183">次の箇条書きリストは、追加する挿入インターフェイスを指定して、GridView フィールドを列挙しています。</span><span class="sxs-lookup"><span data-stu-id="74c3b-183">The following bulleted list enumerates the GridView fields, specifying the inserting interface to add:</span></span>

- <span data-ttu-id="74c3b-184">`ProductID` なし。</span><span class="sxs-lookup"><span data-stu-id="74c3b-184">`ProductID` none.</span></span>
- <span data-ttu-id="74c3b-185">テキストボックスを追加 `ProductName`、その `ID` を `NewProductName`に設定します。</span><span class="sxs-lookup"><span data-stu-id="74c3b-185">`ProductName` add a TextBox and set its `ID` to `NewProductName`.</span></span> <span data-ttu-id="74c3b-186">RequiredFieldValidator コントロールも追加して、ユーザーが新しい製品名の値を入力するようにします。</span><span class="sxs-lookup"><span data-stu-id="74c3b-186">Add a RequiredFieldValidator control as well to ensure that the user enters a value for the new product s name.</span></span>
- <span data-ttu-id="74c3b-187">`SupplierID` なし。</span><span class="sxs-lookup"><span data-stu-id="74c3b-187">`SupplierID` none.</span></span>
- <span data-ttu-id="74c3b-188">`CategoryID` なし。</span><span class="sxs-lookup"><span data-stu-id="74c3b-188">`CategoryID` none.</span></span>
- <span data-ttu-id="74c3b-189">テキストボックスを追加 `QuantityPerUnit`、その `ID` を `NewQuantityPerUnit`に設定します。</span><span class="sxs-lookup"><span data-stu-id="74c3b-189">`QuantityPerUnit` add a TextBox, setting its `ID` to `NewQuantityPerUnit`.</span></span>
- <span data-ttu-id="74c3b-190">`UnitPrice` `NewUnitPrice` という名前のテキストボックスと、入力した値が0以上の通貨値であることを確認する CompareValidator を追加します。</span><span class="sxs-lookup"><span data-stu-id="74c3b-190">`UnitPrice` add a TextBox named `NewUnitPrice` and a CompareValidator that ensures the value entered is a currency value greater than or equal to zero.</span></span>
- <span data-ttu-id="74c3b-191">`ID` が `NewUnitsInStock`に設定されているテキストボックスを使用 `UnitsInStock` ます。</span><span class="sxs-lookup"><span data-stu-id="74c3b-191">`UnitsInStock` use a TextBox whose `ID` is set to `NewUnitsInStock`.</span></span> <span data-ttu-id="74c3b-192">入力した値が0以上の整数値であることを保証する CompareValidator を含めます。</span><span class="sxs-lookup"><span data-stu-id="74c3b-192">Include a CompareValidator that ensures that the value entered is an integer value greater than or equal to zero.</span></span>
- <span data-ttu-id="74c3b-193">`ID` が `NewUnitsOnOrder`に設定されているテキストボックスを使用 `UnitsOnOrder` ます。</span><span class="sxs-lookup"><span data-stu-id="74c3b-193">`UnitsOnOrder` use a TextBox whose `ID` is set to `NewUnitsOnOrder`.</span></span> <span data-ttu-id="74c3b-194">入力した値が0以上の整数値であることを保証する CompareValidator を含めます。</span><span class="sxs-lookup"><span data-stu-id="74c3b-194">Include a CompareValidator that ensures that the value entered is an integer value greater than or equal to zero.</span></span>
- <span data-ttu-id="74c3b-195">`ID` が `NewReorderLevel`に設定されているテキストボックスを使用 `ReorderLevel` ます。</span><span class="sxs-lookup"><span data-stu-id="74c3b-195">`ReorderLevel` use a TextBox whose `ID` is set to `NewReorderLevel`.</span></span> <span data-ttu-id="74c3b-196">入力した値が0以上の整数値であることを保証する CompareValidator を含めます。</span><span class="sxs-lookup"><span data-stu-id="74c3b-196">Include a CompareValidator that ensures that the value entered is an integer value greater than or equal to zero.</span></span>
- <span data-ttu-id="74c3b-197">チェックボックスを追加 `Discontinued`、その `ID` を `NewDiscontinued`に設定します。</span><span class="sxs-lookup"><span data-stu-id="74c3b-197">`Discontinued` add a CheckBox, setting its `ID` to `NewDiscontinued`.</span></span>
- <span data-ttu-id="74c3b-198">DropDownList を追加 `CategoryName`、その `ID` を `NewCategoryID`に設定します。</span><span class="sxs-lookup"><span data-stu-id="74c3b-198">`CategoryName` add a DropDownList and set its `ID` to `NewCategoryID`.</span></span> <span data-ttu-id="74c3b-199">これを `CategoriesDataSource` という名前の新しい ObjectDataSource にバインドし、`CategoriesBLL` クラス s `GetCategories()` メソッドを使用するように構成します。</span><span class="sxs-lookup"><span data-stu-id="74c3b-199">Bind it to a new ObjectDataSource named `CategoriesDataSource` and configure it to use the `CategoriesBLL` class s `GetCategories()` method.</span></span> <span data-ttu-id="74c3b-200">`CategoryID` データフィールドを値として使用して、DropDownList `ListItem` s に `CategoryName` データフィールドが表示されるようにします。</span><span class="sxs-lookup"><span data-stu-id="74c3b-200">Have the DropDownList s `ListItem` s display the `CategoryName` data field, using the `CategoryID` data field as their values.</span></span>
- <span data-ttu-id="74c3b-201">DropDownList を追加 `SupplierName`、その `ID` を `NewSupplierID`に設定します。</span><span class="sxs-lookup"><span data-stu-id="74c3b-201">`SupplierName` add a DropDownList and set its `ID` to `NewSupplierID`.</span></span> <span data-ttu-id="74c3b-202">これを `SuppliersDataSource` という名前の新しい ObjectDataSource にバインドし、`SuppliersBLL` クラス s `GetSuppliers()` メソッドを使用するように構成します。</span><span class="sxs-lookup"><span data-stu-id="74c3b-202">Bind it to a new ObjectDataSource named `SuppliersDataSource` and configure it to use the `SuppliersBLL` class s `GetSuppliers()` method.</span></span> <span data-ttu-id="74c3b-203">`SupplierID` データフィールドを値として使用して、DropDownList `ListItem` s に `CompanyName` データフィールドが表示されるようにします。</span><span class="sxs-lookup"><span data-stu-id="74c3b-203">Have the DropDownList s `ListItem` s display the `CompanyName` data field, using the `SupplierID` data field as their values.</span></span>

<span data-ttu-id="74c3b-204">各検証コントロールについて、`ForeColor` プロパティをオフにして、既定の赤の代わりに `FooterStyle` CSS クラス s の前景色が使用されるようにします。</span><span class="sxs-lookup"><span data-stu-id="74c3b-204">For each of the validation controls, clear out the `ForeColor` property so that the `FooterStyle` CSS class s white foreground color will be used in place of the default red.</span></span> <span data-ttu-id="74c3b-205">また、`ErrorMessage` プロパティを使用して詳細な説明を行いますが、`Text` プロパティにはアスタリスクを設定します。</span><span class="sxs-lookup"><span data-stu-id="74c3b-205">Also use the `ErrorMessage` property for a detailed description, but set the `Text` property to an asterisk.</span></span> <span data-ttu-id="74c3b-206">検証コントロールのテキストによって挿入インターフェイスが2行に折り返されないようにするには、検証コントロールを使用する各 `FooterTemplate` のに対して、`FooterStyle` s `Wrap` プロパティを false に設定します。</span><span class="sxs-lookup"><span data-stu-id="74c3b-206">To prevent the validation control s text from causing the inserting interface to wrap to two lines, set the `FooterStyle` s `Wrap` property to false for each of the `FooterTemplate` s that use a validation control.</span></span> <span data-ttu-id="74c3b-207">最後に、GridView の下に ValidationSummary コントロールを追加し、その `ShowMessageBox` プロパティを `true` に設定し、その `ShowSummary` プロパティを `false`に設定します。</span><span class="sxs-lookup"><span data-stu-id="74c3b-207">Finally, add a ValidationSummary control beneath the GridView and set its `ShowMessageBox` property to `true` and its `ShowSummary` property to `false`.</span></span>

<span data-ttu-id="74c3b-208">新しい製品を追加する場合は、`CategoryID` と `SupplierID`を提供する必要があります。</span><span class="sxs-lookup"><span data-stu-id="74c3b-208">When adding a new product, we need to provide the `CategoryID` and `SupplierID`.</span></span> <span data-ttu-id="74c3b-209">この情報は、[`CategoryName`] フィールドと [`SupplierName`] フィールドのフッターセルにある [DropDownLists] によってキャプチャされます。</span><span class="sxs-lookup"><span data-stu-id="74c3b-209">This information is captured through the DropDownLists in the footer cells for the `CategoryName` and `SupplierName` fields.</span></span> <span data-ttu-id="74c3b-210">ここでは、これらのフィールドを `CategoryID` および `SupplierID` TemplateFields ではなく使用することを選択しました。これは、grid のデータ行では、ユーザーが ID 値ではなく、カテゴリ名と仕入先名を表示することに興味を持つ可能性が高いためです。</span><span class="sxs-lookup"><span data-stu-id="74c3b-210">I chose to use these fields as opposed to the `CategoryID` and `SupplierID` TemplateFields because in the grid s data rows the user is likely more interested in seeing the category and supplier names rather than their ID values.</span></span> <span data-ttu-id="74c3b-211">`CategoryID` と `SupplierID` の値は現在、`CategoryName` と `SupplierName` field の挿入インターフェイスでキャプチャされているため、GridView から `CategoryID` および `SupplierID` TemplateFields を削除できます。</span><span class="sxs-lookup"><span data-stu-id="74c3b-211">Since the `CategoryID` and `SupplierID` values are now being captured in the `CategoryName` and `SupplierName` field s inserting interfaces, we can remove the `CategoryID` and `SupplierID` TemplateFields from the GridView.</span></span>

<span data-ttu-id="74c3b-212">同様に、`ProductID` は新しい製品を追加するときには使用されないため、`ProductID` TemplateField も削除できます。</span><span class="sxs-lookup"><span data-stu-id="74c3b-212">Similarly, the `ProductID` is not used when adding a new product, so the `ProductID` TemplateField can be removed as well.</span></span> <span data-ttu-id="74c3b-213">ただし、では、グリッド内の `ProductID` フィールドをそのままにしておきます。</span><span class="sxs-lookup"><span data-stu-id="74c3b-213">However, let s leave the `ProductID` field in the grid.</span></span> <span data-ttu-id="74c3b-214">挿入インターフェイスを構成するテキストボックス、DropDownLists、Checkbox、および validation コントロールに加えて、[追加] ボタンも必要になります。このボタンは、クリックすると、新しい製品をデータベースに追加するロジックを実行します。</span><span class="sxs-lookup"><span data-stu-id="74c3b-214">In addition to the TextBoxes, DropDownLists, CheckBoxes, and validation controls that make up the inserting interface, we'll also need an Add button that, when clicked, performs the logic to add the new product to the database.</span></span> <span data-ttu-id="74c3b-215">手順 4. で、`ProductID` TemplateField s `FooterTemplate`の [挿入] インターフェイスに [追加] ボタンを含めます。</span><span class="sxs-lookup"><span data-stu-id="74c3b-215">In Step 4 we'll include an Add button in the inserting interface in the `ProductID` TemplateField s `FooterTemplate`.</span></span>

<span data-ttu-id="74c3b-216">さまざまな GridView フィールドの外観を向上させることができます。</span><span class="sxs-lookup"><span data-stu-id="74c3b-216">Feel free to improve the appearance of the various GridView fields.</span></span> <span data-ttu-id="74c3b-217">たとえば、`UnitPrice` 値を通貨として書式設定し、`UnitsInStock`、`UnitsOnOrder`、および `ReorderLevel` の各フィールドを右揃えにして、TemplateFields の `HeaderText` 値を更新することができます。</span><span class="sxs-lookup"><span data-stu-id="74c3b-217">For example, you might want to format the `UnitPrice` values as a currency, right-align the `UnitsInStock`, `UnitsOnOrder`, and `ReorderLevel` fields, and update the `HeaderText` values for the TemplateFields.</span></span>

<span data-ttu-id="74c3b-218">`FooterTemplate` s にインターフェイスを挿入し、`SupplierID`、および `CategoryID` TemplateFields を削除した後、TemplateFields を書式設定して配置することでグリッドの外観を改善した後、GridView の宣言型のマークアップは次のようになります。</span><span class="sxs-lookup"><span data-stu-id="74c3b-218">After creating the slew of inserting interfaces in the `FooterTemplate` s, removing the `SupplierID`, and `CategoryID` TemplateFields, and improving the aesthetics of the grid through formatting and aligning the TemplateFields, your GridView s declarative markup should look similar to the following:</span></span>

[!code-aspx[Main](inserting-a-new-record-from-the-gridview-s-footer-cs/samples/sample5.aspx)]

<span data-ttu-id="74c3b-219">ブラウザーで表示すると、GridView のフッター行に、完成した挿入インターフェイスが含まれるようになりました (図10を参照)。</span><span class="sxs-lookup"><span data-stu-id="74c3b-219">When viewed through a browser, the GridView s footer row now includes the completed inserting interface (see Figure 10).</span></span> <span data-ttu-id="74c3b-220">この時点で、挿入インターフェイスには、ユーザーが新しい製品のデータを入力し、データベースに新しいレコードを挿入することを示す手段が含まれていません。</span><span class="sxs-lookup"><span data-stu-id="74c3b-220">At this point, the inserting interface doesn t include a means for the user to indicate that she s entered the data for the new product and wants to insert a new record into the database.</span></span> <span data-ttu-id="74c3b-221">また、フッターに入力したデータが `Products` データベースの新しいレコードに変換される方法についても説明します。</span><span class="sxs-lookup"><span data-stu-id="74c3b-221">Also, we ve yet to address how the data entered into the footer will translate into a new record in the `Products` database.</span></span> <span data-ttu-id="74c3b-222">手順4では、[追加] ボタンを挿入インターフェイスに含める方法と、ポストバック時にコードをクリックしたときにコードを実行する方法について説明します。</span><span class="sxs-lookup"><span data-stu-id="74c3b-222">In Step 4 we'll look at how to include an Add button to the inserting interface and how to execute code on postback when it s clicked.</span></span> <span data-ttu-id="74c3b-223">手順5は、フッターのデータを使用して新しいレコードを挿入する方法を示しています。</span><span class="sxs-lookup"><span data-stu-id="74c3b-223">Step 5 shows how to insert a new record using the data from the footer.</span></span>

<span data-ttu-id="74c3b-224">[GridView フッターに ![新しいレコードを追加するためのインターフェイスが用意されています。](inserting-a-new-record-from-the-gridview-s-footer-cs/_static/image10.gif)](inserting-a-new-record-from-the-gridview-s-footer-cs/_static/image17.png)</span><span class="sxs-lookup"><span data-stu-id="74c3b-224">[![The GridView Footer Provides an Interface for Adding a New Record](inserting-a-new-record-from-the-gridview-s-footer-cs/_static/image10.gif)](inserting-a-new-record-from-the-gridview-s-footer-cs/_static/image17.png)</span></span>

<span data-ttu-id="74c3b-225">**図 10**: GridView フッターは、新しいレコードを追加するためのインターフェイスを提供します ([クリックすると、フルサイズの画像が表示](inserting-a-new-record-from-the-gridview-s-footer-cs/_static/image18.png)されます)</span><span class="sxs-lookup"><span data-stu-id="74c3b-225">**Figure 10**: The GridView Footer Provides an Interface for Adding a New Record ([Click to view full-size image](inserting-a-new-record-from-the-gridview-s-footer-cs/_static/image18.png))</span></span>

## <a name="step-4-including-an-add-button-in-the-inserting-interface"></a><span data-ttu-id="74c3b-226">手順 4: 挿入インターフェイスに [追加] ボタンを含める</span><span class="sxs-lookup"><span data-stu-id="74c3b-226">Step 4: Including an Add Button in the Inserting Interface</span></span>

<span data-ttu-id="74c3b-227">挿入インターフェイスのどこかに [追加] ボタンを含める必要があります。これは、フッター行の挿入インターフェイスには、現在、ユーザーが新しい製品情報の入力を完了したことを示す手段がないためです。</span><span class="sxs-lookup"><span data-stu-id="74c3b-227">We need to include an Add button somewhere in the inserting interface since the footer row s inserting interface currently lacks the means for the user to indicate that they have completed entering the new product s information.</span></span> <span data-ttu-id="74c3b-228">これは既存の `FooterTemplate` のいずれかに配置できます。または、この目的のために新しい列をグリッドに追加することもできます。</span><span class="sxs-lookup"><span data-stu-id="74c3b-228">This could be placed in one of the existing `FooterTemplate` s or we could add a new column to the grid for this purpose.</span></span> <span data-ttu-id="74c3b-229">このチュートリアルでは、`ProductID` TemplateField s `FooterTemplate`に [追加] ボタンを配置します。</span><span class="sxs-lookup"><span data-stu-id="74c3b-229">For this tutorial, let s place the Add button in the `ProductID` TemplateField s `FooterTemplate`.</span></span>

<span data-ttu-id="74c3b-230">デザイナーで、GridView s スマートタグの [テンプレートの編集] リンクをクリックし、ドロップダウンリストから `ProductID` フィールド s `FooterTemplate` を選択します。</span><span class="sxs-lookup"><span data-stu-id="74c3b-230">From the Designer, click on the Edit Templates link in the GridView s smart tag and then choose the `ProductID` field s `FooterTemplate` from the drop-down list.</span></span> <span data-ttu-id="74c3b-231">図11に示すように、テンプレートにボタン Web コントロール (または LinkButton または ImageButton) を追加し、その ID を `AddProduct`、挿入する `CommandName`、`Text` プロパティを追加します。</span><span class="sxs-lookup"><span data-stu-id="74c3b-231">Add a Button Web control (or a LinkButton or ImageButton, if you prefer) to the template, setting its ID to `AddProduct`, its `CommandName` to Insert, and its `Text` property to Add as shown in Figure 11.</span></span>

<span data-ttu-id="74c3b-232">[ProductID TemplateField s フッターテンプレートに [追加] ボタンを配置 ![には](inserting-a-new-record-from-the-gridview-s-footer-cs/_static/image11.gif)](inserting-a-new-record-from-the-gridview-s-footer-cs/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="74c3b-232">[![Place the Add Button in the ProductID TemplateField s FooterTemplate](inserting-a-new-record-from-the-gridview-s-footer-cs/_static/image11.gif)](inserting-a-new-record-from-the-gridview-s-footer-cs/_static/image19.png)</span></span>

<span data-ttu-id="74c3b-233">**図 11**: `ProductID` TemplateField s `FooterTemplate` に [追加] ボタンを配置[する (クリックしてフルサイズの画像を表示する](inserting-a-new-record-from-the-gridview-s-footer-cs/_static/image20.png))</span><span class="sxs-lookup"><span data-stu-id="74c3b-233">**Figure 11**: Place the Add Button in the `ProductID` TemplateField s `FooterTemplate` ([Click to view full-size image](inserting-a-new-record-from-the-gridview-s-footer-cs/_static/image20.png))</span></span>

<span data-ttu-id="74c3b-234">[追加] ボタンをクリックした後、ブラウザーでページをテストします。</span><span class="sxs-lookup"><span data-stu-id="74c3b-234">Once you ve included the Add button, test out the page in a browser.</span></span> <span data-ttu-id="74c3b-235">挿入インターフェイスに無効なデータが含まれている [追加] ボタンをクリックすると、ポストバックは短いサーキットになり、ValidationSummary コントロールは無効なデータを示します (図12を参照)。</span><span class="sxs-lookup"><span data-stu-id="74c3b-235">Note that when clicking the Add button with invalid data in the inserting interface, the postback is short circuited and the ValidationSummary control indicates the invalid data (see Figure 12).</span></span> <span data-ttu-id="74c3b-236">適切なデータを入力したら、[追加] ボタンをクリックするとポストバックが発生します。</span><span class="sxs-lookup"><span data-stu-id="74c3b-236">With appropriate data entered, clicking the Add button causes a postback.</span></span> <span data-ttu-id="74c3b-237">ただし、レコードはデータベースに追加されません。</span><span class="sxs-lookup"><span data-stu-id="74c3b-237">No record is added to the database, however.</span></span> <span data-ttu-id="74c3b-238">実際に挿入を実行するには、少しコードを記述する必要があります。</span><span class="sxs-lookup"><span data-stu-id="74c3b-238">We will need to write a bit of code to actually perform the insert.</span></span>

<span data-ttu-id="74c3b-239">[挿入インターフェイスに無効なデータが含まれている場合は、[Add] ボタン s ポストバック ![Short サーキット](inserting-a-new-record-from-the-gridview-s-footer-cs/_static/image12.gif)](inserting-a-new-record-from-the-gridview-s-footer-cs/_static/image21.png)</span><span class="sxs-lookup"><span data-stu-id="74c3b-239">[![The Add Button s Postback is Short Circuited if There is Invalid Data in the Inserting Interface](inserting-a-new-record-from-the-gridview-s-footer-cs/_static/image12.gif)](inserting-a-new-record-from-the-gridview-s-footer-cs/_static/image21.png)</span></span>

<span data-ttu-id="74c3b-240">**図 12**: 挿入インターフェイスに無効なデータが含まれている場合は、[Add] ボタン s ポストバックが短いサーキット ([クリックすると、フルサイズの画像が表示](inserting-a-new-record-from-the-gridview-s-footer-cs/_static/image22.png)されます)</span><span class="sxs-lookup"><span data-stu-id="74c3b-240">**Figure 12**: The Add Button s Postback is Short Circuited if There is Invalid Data in the Inserting Interface ([Click to view full-size image](inserting-a-new-record-from-the-gridview-s-footer-cs/_static/image22.png))</span></span>

> [!NOTE]
> <span data-ttu-id="74c3b-241">挿入インターフェイスの検証コントロールが検証グループに割り当てられませんでした。</span><span class="sxs-lookup"><span data-stu-id="74c3b-241">The validation controls in the inserting interface were not assigned to a validation group.</span></span> <span data-ttu-id="74c3b-242">これは、挿入インターフェイスがページ上の検証コントロールの唯一のセットである限り、問題なく動作します。</span><span class="sxs-lookup"><span data-stu-id="74c3b-242">This works fine so long as the inserting interface is the only set of validation controls on the page.</span></span> <span data-ttu-id="74c3b-243">ただし、ページに他の検証コントロール (grid s 編集インターフェイスの検証コントロールなど) がある場合、[挿入インターフェイス] プロパティと [ボタンの追加] `ValidationGroup` プロパティの検証コントロールには、これらのコントロールを特定の検証グループに関連付けるために同じ値を割り当てる必要があります。</span><span class="sxs-lookup"><span data-stu-id="74c3b-243">If, however, there are other validation controls on the page (such as validation controls in the grid s editing interface), the validation controls in the inserting interface and Add button s `ValidationGroup` properties should be assigned the same value so as to associate these controls with a particular validation group.</span></span> <span data-ttu-id="74c3b-244">ページ上の検証コントロールとボタンを検証グループにパーティション分割する方法の詳細については[、「解説 The Validation controls in ASP.NET 2.0」](http://aspnet.4guysfromrolla.com/articles/112305-1.aspx)を参照してください。</span><span class="sxs-lookup"><span data-stu-id="74c3b-244">See [Dissecting the Validation Controls in ASP.NET 2.0](http://aspnet.4guysfromrolla.com/articles/112305-1.aspx) for more information on partitioning the validation controls and buttons on a page into validation groups.</span></span>

## <a name="step-5-inserting-a-new-record-into-theproductstable"></a><span data-ttu-id="74c3b-245">手順 5:`Products`テーブルに新しいレコードを挿入する</span><span class="sxs-lookup"><span data-stu-id="74c3b-245">Step 5: Inserting a New Record Into the`Products`Table</span></span>

<span data-ttu-id="74c3b-246">GridView の組み込み編集機能を使用すると、更新プログラムの実行に必要なすべての作業が GridView によって自動的に処理されます。</span><span class="sxs-lookup"><span data-stu-id="74c3b-246">When utilizing the built-in editing features of the GridView, the GridView automatically handles all of the work necessary for performing the update.</span></span> <span data-ttu-id="74c3b-247">特に、[更新] ボタンをクリックすると、編集インターフェイスから入力した値が ObjectDataSource s `UpdateParameters` コレクションのパラメーターにコピーされ、ObjectDataSource s `Update()` メソッドを呼び出すことで更新が開始されます。</span><span class="sxs-lookup"><span data-stu-id="74c3b-247">In particular, when the Update button is clicked it copies the values entered from the editing interface to the parameters in the ObjectDataSource s `UpdateParameters` collection and kicks off the update by invoking the ObjectDataSource s `Update()` method.</span></span> <span data-ttu-id="74c3b-248">GridView は挿入用のこのような組み込み機能を提供しないため、ObjectDataSource s `Insert()` メソッドを呼び出し、挿入インターフェイスから ObjectDataSource s `InsertParameters` コレクションに値をコピーするコードを実装する必要があります。</span><span class="sxs-lookup"><span data-stu-id="74c3b-248">Since the GridView does not provide such built-in functionality for inserting, we must implement code that calls the ObjectDataSource s `Insert()` method and copies the values from the inserting interface to the ObjectDataSource s `InsertParameters` collection.</span></span>

<span data-ttu-id="74c3b-249">この挿入ロジックは、[追加] ボタンをクリックした後に実行する必要があります。</span><span class="sxs-lookup"><span data-stu-id="74c3b-249">This insert logic should be executed after the Add button has been clicked.</span></span> <span data-ttu-id="74c3b-250">Gridview でのボタンの[追加と応答](../custom-button-actions/adding-and-responding-to-buttons-to-a-gridview-cs.md)に関するチュートリアルで説明したように、Gridview のボタン、LinkButton、または ImageButton がクリックされると、gridview s `RowCommand` イベントがポストバック時に発生します。</span><span class="sxs-lookup"><span data-stu-id="74c3b-250">As discussed in the [Adding and Responding to Buttons in a GridView](../custom-button-actions/adding-and-responding-to-buttons-to-a-gridview-cs.md) tutorial, anytime a Button, LinkButton, or ImageButton in a GridView is clicked, the GridView s `RowCommand` event fires on postback.</span></span> <span data-ttu-id="74c3b-251">このイベントは、ボタン、LinkButton、または ImageButton が、フッター行の [追加] ボタンなどの明示的に追加されたか、GridView によって自動的に追加されたか ([並べ替えを有効にする] が選択されている場合は、各列の上部にあるリンクボタンなど) を示します。[ページングを有効にする] が選択されているときのページングインターフェイスのリンクボタン。</span><span class="sxs-lookup"><span data-stu-id="74c3b-251">This event fires whether the Button, LinkButton, or ImageButton was added explicitly such as the Add button in the footer row or if it was automatically added by the GridView (such as the LinkButtons at the top of each column when Enable Sorting is selected, or the LinkButtons in the paging interface when Enable Paging is selected).</span></span>

<span data-ttu-id="74c3b-252">したがって、[追加] ボタンをクリックしたユーザーに応答するには、GridView s `RowCommand` イベントのイベントハンドラーを作成する必要があります。</span><span class="sxs-lookup"><span data-stu-id="74c3b-252">Therefore, to respond to the user clicking the Add button, we need to create an event handler for the GridView s `RowCommand` event.</span></span> <span data-ttu-id="74c3b-253">このイベントは、GridView*の Button、* LinkButton、または ImageButton がクリックされるたびに発生するため、イベントハンドラーに渡された `CommandName` プロパティが [追加] ボタン (Insert) の `CommandName` 値にマップされている場合にのみ、挿入ロジックを続行することが重要です。</span><span class="sxs-lookup"><span data-stu-id="74c3b-253">Since this event fires whenever *any* Button, LinkButton, or ImageButton in the GridView is clicked, it s vital that we only proceed with the inserting logic if the `CommandName` property passed into the event handler maps to the `CommandName` value of the Add button ( Insert ).</span></span> <span data-ttu-id="74c3b-254">さらに、検証コントロールが有効なデータを報告している場合にのみ処理を続行する必要もあります。</span><span class="sxs-lookup"><span data-stu-id="74c3b-254">Moreover, we should also only proceed if the validation controls report valid data.</span></span> <span data-ttu-id="74c3b-255">これに対応するには、次のコードを使用して、`RowCommand` イベントのイベントハンドラーを作成します。</span><span class="sxs-lookup"><span data-stu-id="74c3b-255">To accommodate this, create an event handler for the `RowCommand` event with the following code:</span></span>

[!code-csharp[Main](inserting-a-new-record-from-the-gridview-s-footer-cs/samples/sample6.cs)]

> [!NOTE]
> <span data-ttu-id="74c3b-256">イベントハンドラーによって `Page.IsValid` プロパティがチェックされるのはなぜですか。</span><span class="sxs-lookup"><span data-stu-id="74c3b-256">You may be wondering why the event handler bothers checking the `Page.IsValid` property.</span></span> <span data-ttu-id="74c3b-257">結局のところ、挿入インターフェイスに無効なデータが指定されている場合、ポストバックは抑制されますか。</span><span class="sxs-lookup"><span data-stu-id="74c3b-257">After all, won't the postback be suppressed if invalid data is provided in the inserting interface?</span></span> <span data-ttu-id="74c3b-258">この想定は、ユーザーが JavaScript を無効にしていない場合、またはクライアント側の検証ロジックを回避する手順を実行している場合に適しています。</span><span class="sxs-lookup"><span data-stu-id="74c3b-258">This assumption is correct as long as the user has not disabled JavaScript or has taken steps to circumvent the client-side validation logic.</span></span> <span data-ttu-id="74c3b-259">つまり、クライアント側の検証に厳密に依存しないようにする必要があります。データを操作する前に、サーバー側の有効性チェックを常に実行する必要があります。</span><span class="sxs-lookup"><span data-stu-id="74c3b-259">In short, one should never rely strictly on client-side validation; a server-side check for validity should always be performed before working with the data.</span></span>

<span data-ttu-id="74c3b-260">手順 1. では、`Insert()` メソッドが `ProductsBLL` クラス s `AddProduct` メソッドにマップされるように `ProductsDataSource` ObjectDataSource を作成しました。</span><span class="sxs-lookup"><span data-stu-id="74c3b-260">In Step 1 we created the `ProductsDataSource` ObjectDataSource such that its `Insert()` method is mapped to the `ProductsBLL` class s `AddProduct` method.</span></span> <span data-ttu-id="74c3b-261">新しいレコードを `Products` テーブルに挿入するには、単に ObjectDataSource s `Insert()` メソッドを呼び出します。</span><span class="sxs-lookup"><span data-stu-id="74c3b-261">To insert the new record into the `Products` table, we can simply invoke the ObjectDataSource s `Insert()` method:</span></span>

[!code-csharp[Main](inserting-a-new-record-from-the-gridview-s-footer-cs/samples/sample7.cs)]

<span data-ttu-id="74c3b-262">`Insert()` メソッドが呼び出されたので、次は、挿入インターフェイスから `ProductsBLL` クラス s `AddProduct` メソッドに渡されるパラメーターに値をコピーします。</span><span class="sxs-lookup"><span data-stu-id="74c3b-262">Now that the `Insert()` method has been invoked, all that remains is to copy the values from the inserting interface to the parameters passed to the `ProductsBLL` class s `AddProduct` method.</span></span> <span data-ttu-id="74c3b-263">[挿入、更新、および削除のチュートリアルに関連するイベントの](../editing-inserting-and-deleting-data/examining-the-events-associated-with-inserting-updating-and-deleting-cs.md)確認については、ObjectDataSource s `Inserting` イベントを使用して行うことができます。</span><span class="sxs-lookup"><span data-stu-id="74c3b-263">As we saw back in the [Examining the Events Associated with Inserting, Updating, and Deleting](../editing-inserting-and-deleting-data/examining-the-events-associated-with-inserting-updating-and-deleting-cs.md) tutorial, this can be accomplished through the ObjectDataSource s `Inserting` event.</span></span> <span data-ttu-id="74c3b-264">`Inserting` イベントでは、`Products` GridView s フッター行からコントロールをプログラムによって参照し、その値を `e.InputParameters` コレクションに割り当てる必要があります。</span><span class="sxs-lookup"><span data-stu-id="74c3b-264">In the `Inserting` event we need to programmatically reference the controls from the `Products` GridView s footer row and assign their values to the `e.InputParameters` collection.</span></span> <span data-ttu-id="74c3b-265">ユーザーが `ReorderLevel` テキストボックスを空白のままにするなどの値を省略した場合は、データベースに挿入される値を `NULL`するように指定する必要があります。</span><span class="sxs-lookup"><span data-stu-id="74c3b-265">If the user omits a value such as leaving the `ReorderLevel` TextBox blank we need to specify that the value inserted into the database should be `NULL`.</span></span> <span data-ttu-id="74c3b-266">`AddProducts` メソッドは null 許容型データベースフィールドの null 許容型を受け入れるため、ユーザー入力が省略されている場合は、null 許容型を使用し、その値を `null` に設定するだけです。</span><span class="sxs-lookup"><span data-stu-id="74c3b-266">Since the `AddProducts` method accepts nullable types for the nullable database fields, simply use a nullable type and set its value to `null` in the case where user input is omitted.</span></span>

[!code-csharp[Main](inserting-a-new-record-from-the-gridview-s-footer-cs/samples/sample8.cs)]

<span data-ttu-id="74c3b-267">`Inserting` イベントハンドラーが完了したので、GridView s フッター行を使用して `Products` データベーステーブルに新しいレコードを追加できます。</span><span class="sxs-lookup"><span data-stu-id="74c3b-267">With the `Inserting` event handler completed, new records can be added to the `Products` database table via the GridView s footer row.</span></span> <span data-ttu-id="74c3b-268">新しい製品をいくつか追加してみましょう。</span><span class="sxs-lookup"><span data-stu-id="74c3b-268">Go ahead and try adding several new products.</span></span>

## <a name="enhancing-and-customizing-the-add-operation"></a><span data-ttu-id="74c3b-269">追加操作の拡張とカスタマイズ</span><span class="sxs-lookup"><span data-stu-id="74c3b-269">Enhancing and Customizing the Add Operation</span></span>

<span data-ttu-id="74c3b-270">現時点では、[追加] ボタンをクリックすると、データベーステーブルに新しいレコードが追加されますが、レコードが正常に追加されたことを示す視覚的なフィードバックは提供されません。</span><span class="sxs-lookup"><span data-stu-id="74c3b-270">Currently, clicking the Add button adds a new record to the database table but does not provide any sort of visual feedback that the record has successfully been added.</span></span> <span data-ttu-id="74c3b-271">理想的には、ラベル Web コントロールまたはクライアント側の警告ボックスは、挿入が正常に完了したことをユーザーに通知します。</span><span class="sxs-lookup"><span data-stu-id="74c3b-271">Ideally, a Label Web control or client-side alert box would inform the user that their insert has completed with success.</span></span> <span data-ttu-id="74c3b-272">この作業をリーダーの演習として残しておきます。</span><span class="sxs-lookup"><span data-stu-id="74c3b-272">I leave this as an exercise for the reader.</span></span>

<span data-ttu-id="74c3b-273">このチュートリアルで使用する GridView では、表示されている製品に並べ替え順序は適用されません。また、エンドユーザーはデータを並べ替えることもできません。</span><span class="sxs-lookup"><span data-stu-id="74c3b-273">The GridView used in this tutorial does not apply any sort order to the listed products, nor does it allow the end user to sort the data.</span></span> <span data-ttu-id="74c3b-274">その結果、レコードは、データベース内の主キーフィールドによって並べ替えられます。</span><span class="sxs-lookup"><span data-stu-id="74c3b-274">Consequently, the records are ordered as they are in the database by their primary key field.</span></span> <span data-ttu-id="74c3b-275">新しいレコードには、最後のレコードよりも大きい `ProductID` 値があるため、新しい製品が追加されるたびに、グリッドの最後に追加されます。</span><span class="sxs-lookup"><span data-stu-id="74c3b-275">Since each new record has a `ProductID` value greater than the last one, every time a new product is added it is tacked on to the end of the grid.</span></span> <span data-ttu-id="74c3b-276">そのため、新しいレコードを追加した後に、GridView の最後のページにユーザーを自動的に送信することができます。</span><span class="sxs-lookup"><span data-stu-id="74c3b-276">Therefore, you may want to automatically send the user to the last page of the GridView after adding a new record.</span></span> <span data-ttu-id="74c3b-277">これを行うには、データを GridView にバインドした後、最後のページにユーザーを送信する必要があることを示すために、`RowCommand` イベントハンドラーで `ProductsDataSource.Insert()` の呼び出しの後に次のコード行を追加します。</span><span class="sxs-lookup"><span data-stu-id="74c3b-277">This can be accomplished by adding the following line of code after the call to `ProductsDataSource.Insert()` in the `RowCommand` event handler to indicate that the user needs to be sent to the last page after binding the data to the GridView:</span></span>

[!code-csharp[Main](inserting-a-new-record-from-the-gridview-s-footer-cs/samples/sample9.cs)]

<span data-ttu-id="74c3b-278">`SendUserToLastPage` は、最初は `false`の値が割り当てられるページレベルのブール型変数です。</span><span class="sxs-lookup"><span data-stu-id="74c3b-278">`SendUserToLastPage` is a page-level Boolean variable that is initially assigned a value of `false`.</span></span> <span data-ttu-id="74c3b-279">GridView s `DataBound` イベントハンドラーで `SendUserToLastPage` が false の場合、`PageIndex` プロパティが更新され、最後のページにユーザーが送信されます。</span><span class="sxs-lookup"><span data-stu-id="74c3b-279">In the GridView s `DataBound` event handler, if `SendUserToLastPage` is false, the `PageIndex` property is updated to send the user to the last page.</span></span>

[!code-csharp[Main](inserting-a-new-record-from-the-gridview-s-footer-cs/samples/sample10.cs)]

<span data-ttu-id="74c3b-280">`DataBound` イベントハンドラーで `PageIndex` プロパティが設定されている理由は (`RowCommand` イベントハンドラーではありません)、`RowCommand` イベントハンドラーが起動すると、新しいレコードが `Products` データベーステーブルに追加されていないためです。</span><span class="sxs-lookup"><span data-stu-id="74c3b-280">The reason the `PageIndex` property is set in the `DataBound` event handler (as opposed to the `RowCommand` event handler) is because when the `RowCommand` event handler fires we ve yet to add the new record to the `Products` database table.</span></span> <span data-ttu-id="74c3b-281">したがって、`RowCommand` イベントハンドラーでは、最後のページインデックス (`PageCount - 1`) は、新しい製品が追加さ*れる前*の最後のページインデックスを表します。</span><span class="sxs-lookup"><span data-stu-id="74c3b-281">Therefore, in the `RowCommand` event handler the last page index (`PageCount - 1`) represents the last page index *before* the new product has been added.</span></span> <span data-ttu-id="74c3b-282">追加される製品の大部分については、新しい製品を追加した後の最後のページインデックスは同じです。</span><span class="sxs-lookup"><span data-stu-id="74c3b-282">For the majority of products being added, the last page index is the same after adding the new product.</span></span> <span data-ttu-id="74c3b-283">ただし、追加された製品によって新しいページインデックスが作成された場合、`RowCommand` イベントハンドラーの `PageIndex` を誤って更新すると、新しい最後のページインデックスではなく、最後のページ (新しい製品を追加する前の最後のページインデックス) に移動します。</span><span class="sxs-lookup"><span data-stu-id="74c3b-283">But when the added product results in a new last page index, if we incorrectly update the `PageIndex` in the `RowCommand` event handler then we'll be taken to the second to last page (the last page index prior to adding the new product) as opposed to the new last page index.</span></span> <span data-ttu-id="74c3b-284">新しい製品が追加され、データがグリッドに再バインドされた後に `DataBound` イベントハンドラーが呼び出されるため、`PageIndex` プロパティを設定することによって、正しい最後のページインデックスを取得することがわかっています。</span><span class="sxs-lookup"><span data-stu-id="74c3b-284">Since the `DataBound` event handler fires after the new product has been added and the data rebound to the grid, by setting the `PageIndex` property there we know we re getting the correct last page index.</span></span>

<span data-ttu-id="74c3b-285">最後に、このチュートリアルで使用する GridView は、新しい製品を追加するために収集する必要があるフィールドの数が多いため、非常に広範囲にわたります。</span><span class="sxs-lookup"><span data-stu-id="74c3b-285">Finally, the GridView used in this tutorial is quite wide due to the number of fields that must be collected for adding a new product.</span></span> <span data-ttu-id="74c3b-286">この幅により、DetailsView s の垂直レイアウトが優先される場合があります。</span><span class="sxs-lookup"><span data-stu-id="74c3b-286">Due to this width, a DetailsView s vertical layout might be preferred.</span></span> <span data-ttu-id="74c3b-287">少なくとも入力を収集することで、GridView の全体の幅を減らすことができます。</span><span class="sxs-lookup"><span data-stu-id="74c3b-287">The GridView s overall width could be reduced by collecting fewer inputs.</span></span> <span data-ttu-id="74c3b-288">新しい製品を追加するときに、`UnitsOnOrder`、`UnitsInStock`、および `ReorderLevel` フィールドを収集する必要はないかもしれません。この場合、これらのフィールドは GridView から削除される可能性があります。</span><span class="sxs-lookup"><span data-stu-id="74c3b-288">Perhaps we don t need to collect the `UnitsOnOrder`, `UnitsInStock`, and `ReorderLevel` fields when adding a new product, in which case these fields could be removed from the GridView.</span></span>

<span data-ttu-id="74c3b-289">収集されるデータを調整するには、次の2つの方法のいずれかを使用します。</span><span class="sxs-lookup"><span data-stu-id="74c3b-289">To adjust the data collected, we can use one of two approaches:</span></span>

- <span data-ttu-id="74c3b-290">`UnitsOnOrder`、`UnitsInStock`、および `ReorderLevel` の各フィールドの値を必要とする `AddProduct` メソッドを引き続き使用します。</span><span class="sxs-lookup"><span data-stu-id="74c3b-290">Continue to use the `AddProduct` method that expects values for the `UnitsOnOrder`, `UnitsInStock`, and `ReorderLevel` fields.</span></span> <span data-ttu-id="74c3b-291">`Inserting` イベントハンドラーで、挿入インターフェイスから削除されたこれらの入力に使用する、ハードコーディングされた既定値を指定します。</span><span class="sxs-lookup"><span data-stu-id="74c3b-291">In the `Inserting` event handler, provide hard-coded, default values to use for these inputs that have been removed from the inserting interface.</span></span>
- <span data-ttu-id="74c3b-292">`UnitsOnOrder`、`UnitsInStock`、および `ReorderLevel` の各フィールドの入力を受け付けない、`ProductsBLL` クラスの `AddProduct` メソッドの新しいオーバーロードを作成します。</span><span class="sxs-lookup"><span data-stu-id="74c3b-292">Create a new overload of the `AddProduct` method in the `ProductsBLL` class that does not accept inputs for the `UnitsOnOrder`, `UnitsInStock`, and `ReorderLevel` fields.</span></span> <span data-ttu-id="74c3b-293">次に、[ASP.NET] ページで、この新しいオーバーロードを使用するように ObjectDataSource を構成します。</span><span class="sxs-lookup"><span data-stu-id="74c3b-293">Then, in the ASP.NET page, configure the ObjectDataSource to use this new overload.</span></span>

<span data-ttu-id="74c3b-294">どちらのオプションも同様に機能します。</span><span class="sxs-lookup"><span data-stu-id="74c3b-294">Either option will work equally as well.</span></span> <span data-ttu-id="74c3b-295">これまでのチュートリアルでは、後者のオプションを使用して、`ProductsBLL` クラス s `UpdateProduct` メソッドに対して複数のオーバーロードを作成しました。</span><span class="sxs-lookup"><span data-stu-id="74c3b-295">In past tutorials we used the latter option, creating multiple overloads for the `ProductsBLL` class s `UpdateProduct` method.</span></span>

## <a name="summary"></a><span data-ttu-id="74c3b-296">まとめ</span><span class="sxs-lookup"><span data-stu-id="74c3b-296">Summary</span></span>

<span data-ttu-id="74c3b-297">GridView には、DetailsView と FormView に含まれる組み込みの挿入機能がありませんが、挿入インターフェイスをフッター行に追加することができます。</span><span class="sxs-lookup"><span data-stu-id="74c3b-297">The GridView lacks the built-in inserting capabilities found in the DetailsView and FormView, but with a bit of effort an inserting interface can be added to the footer row.</span></span> <span data-ttu-id="74c3b-298">GridView にフッター行を表示するには、単に `ShowFooter` プロパティを `true`に設定します。</span><span class="sxs-lookup"><span data-stu-id="74c3b-298">To display the footer row in a GridView simply set its `ShowFooter` property to `true`.</span></span> <span data-ttu-id="74c3b-299">フィールドを TemplateField に変換し、挿入インターフェイスを `FooterTemplate`に追加することで、フィールドごとにフッター行の内容をカスタマイズできます。</span><span class="sxs-lookup"><span data-stu-id="74c3b-299">The footer row content can be customized for each field by converting the field to a TemplateField and adding the inserting interface to the `FooterTemplate`.</span></span> <span data-ttu-id="74c3b-300">このチュートリアルで説明したように、`FooterTemplate` には、ボタン、テキストボックス、DropDownLists、チェックボックス、データドリブン Web コントロール (DropDownLists など) を設定するためのデータソースコントロール、および検証コントロールを含めることができます。</span><span class="sxs-lookup"><span data-stu-id="74c3b-300">As we saw in this tutorial, the `FooterTemplate` can contain Buttons, TextBoxes, DropDownLists, CheckBoxes, data source controls for populating data-driven Web controls (such as DropDownLists), and validation controls.</span></span> <span data-ttu-id="74c3b-301">ユーザー入力を収集するためのコントロールと共に、Add Button、LinkButton、または ImageButton が必要です。</span><span class="sxs-lookup"><span data-stu-id="74c3b-301">Along with controls for collecting the user s input, an Add Button, LinkButton, or ImageButton is needed.</span></span>

<span data-ttu-id="74c3b-302">[追加] ボタンがクリックされると、ObjectDataSource s `Insert()` メソッドが呼び出され、挿入ワークフローが開始されます。</span><span class="sxs-lookup"><span data-stu-id="74c3b-302">When the Add button is clicked, the ObjectDataSource s `Insert()` method is invoked to start the inserting workflow.</span></span> <span data-ttu-id="74c3b-303">次に、ObjectDataSource は、構成された挿入メソッド (このチュートリアルでは `ProductsBLL` クラス s `AddProduct` メソッド) を呼び出します。</span><span class="sxs-lookup"><span data-stu-id="74c3b-303">The ObjectDataSource will then call the configured insert method (the `ProductsBLL` class s `AddProduct` method, in this tutorial).</span></span> <span data-ttu-id="74c3b-304">挿入メソッドを呼び出す前に、GridView の `InsertParameters` コレクションに対して、GridView s インターフェイスから値をコピーする必要があります。</span><span class="sxs-lookup"><span data-stu-id="74c3b-304">We must copy the values from the GridView s inserting interface to the ObjectDataSource s `InsertParameters` collection prior to the insert method being invoked.</span></span> <span data-ttu-id="74c3b-305">これは、ObjectDataSource s `Inserting` イベントハンドラーの挿入インターフェイス Web コントロールをプログラムで参照することによって実現できます。</span><span class="sxs-lookup"><span data-stu-id="74c3b-305">This can be accomplished by programmatically referencing the inserting interface Web controls in the ObjectDataSource s `Inserting` event handler.</span></span>

<span data-ttu-id="74c3b-306">このチュートリアルでは、GridView の外観を拡張する方法について説明します。</span><span class="sxs-lookup"><span data-stu-id="74c3b-306">This tutorial completes our look at techniques for enhancing the GridView s appearance.</span></span> <span data-ttu-id="74c3b-307">次の一連のチュートリアルでは、画像、Pdf、Word 文書などのバイナリデータを操作する方法と、データ Web コントロールについて説明します。</span><span class="sxs-lookup"><span data-stu-id="74c3b-307">The next set of tutorials will examine how to work with binary data such as images, PDFs, Word documents, and so on and the data Web controls.</span></span>

<span data-ttu-id="74c3b-308">プログラミングを楽しんでください。</span><span class="sxs-lookup"><span data-stu-id="74c3b-308">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="74c3b-309">著者について</span><span class="sxs-lookup"><span data-stu-id="74c3b-309">About the Author</span></span>

<span data-ttu-id="74c3b-310">1998以来、 [Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml)は 7 asp/創設者 of [4GuysFromRolla.com](http://www.4guysfromrolla.com)の執筆者であり、Microsoft Web テクノロジを使用しています。</span><span class="sxs-lookup"><span data-stu-id="74c3b-310">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="74c3b-311">Scott は、独立したコンサルタント、トレーナー、およびライターとして機能します。</span><span class="sxs-lookup"><span data-stu-id="74c3b-311">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="74c3b-312">彼の最新の書籍は[ *、ASP.NET 2.0 を24時間以内に教え*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)ています。</span><span class="sxs-lookup"><span data-stu-id="74c3b-312">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="74c3b-313">mitchell@4GuysFromRolla.comでアクセスでき[ます。](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="74c3b-313">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="74c3b-314">または彼のブログを参照してください。これは[http://ScottOnWriting.NET](http://ScottOnWriting.NET)にあります。</span><span class="sxs-lookup"><span data-stu-id="74c3b-314">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="74c3b-315">ありがとうございました。</span><span class="sxs-lookup"><span data-stu-id="74c3b-315">Special Thanks To</span></span>

<span data-ttu-id="74c3b-316">このチュートリアルシリーズは、役に立つ多くのレビュー担当者によってレビューされました。</span><span class="sxs-lookup"><span data-stu-id="74c3b-316">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="74c3b-317">このチュートリアルのリードレビュー担当者は、Bernadette Leigh でした。</span><span class="sxs-lookup"><span data-stu-id="74c3b-317">Lead reviewer for this tutorial was Bernadette Leigh.</span></span> <span data-ttu-id="74c3b-318">今後の MSDN 記事を確認することに興味がありますか?</span><span class="sxs-lookup"><span data-stu-id="74c3b-318">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="74c3b-319">その場合は、mitchell@4GuysFromRolla.comの行を削除[します。](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="74c3b-319">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="74c3b-320">[前へ](adding-a-gridview-column-of-checkboxes-cs.md)
> [次へ](adding-a-gridview-column-of-radio-buttons-vb.md)</span><span class="sxs-lookup"><span data-stu-id="74c3b-320">[Previous](adding-a-gridview-column-of-checkboxes-cs.md)
[Next](adding-a-gridview-column-of-radio-buttons-vb.md)</span></span>

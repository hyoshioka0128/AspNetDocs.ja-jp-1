---
uid: web-forms/overview/data-access/editing-inserting-and-deleting-data/limiting-data-modification-functionality-based-on-the-user-cs
title: ユーザー (c#) に基づいてデータ編集機能を制限 |Microsoft Docs
author: rick-anderson
description: ユーザー データを編集できるように web アプリケーションを別のユーザー アカウントは別のデータの編集の権限があります。 このチュートリアルではについて説明しますか t.
ms.author: riande
ms.date: 07/17/2006
ms.assetid: 2b251c82-77cf-4e36-baa9-b648eddaa394
msc.legacyurl: /web-forms/overview/data-access/editing-inserting-and-deleting-data/limiting-data-modification-functionality-based-on-the-user-cs
msc.type: authoredcontent
ms.openlocfilehash: 3ca9630d2c8409c7f7ed66354a8edcbbaffaa65d
ms.sourcegitcommit: 51b01b6ff8edde57d8243e4da28c9f1e7f1962b2
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 05/06/2019
ms.locfileid: "65128648"
---
# <a name="limiting-data-modification-functionality-based-on-the-user-c"></a><span data-ttu-id="f3d86-104">ユーザーに基づいてデータ編集機能を制限する (C#)</span><span class="sxs-lookup"><span data-stu-id="f3d86-104">Limiting Data Modification Functionality Based on the User (C#)</span></span>

<span data-ttu-id="f3d86-105">によって[Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="f3d86-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="f3d86-106">[サンプル アプリをダウンロード](http://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_23_CS.exe)または[PDF のダウンロード](limiting-data-modification-functionality-based-on-the-user-cs/_static/datatutorial23cs1.pdf)</span><span class="sxs-lookup"><span data-stu-id="f3d86-106">[Download Sample App](http://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_23_CS.exe) or [Download PDF](limiting-data-modification-functionality-based-on-the-user-cs/_static/datatutorial23cs1.pdf)</span></span>

> <span data-ttu-id="f3d86-107">ユーザー データを編集できるように web アプリケーションを別のユーザー アカウントは別のデータの編集の権限があります。</span><span class="sxs-lookup"><span data-stu-id="f3d86-107">In a web application that allows users to edit data, different user accounts may have different data-editing privileges.</span></span> <span data-ttu-id="f3d86-108">このチュートリアルでは、訪問したユーザーに基づくデータ変更機能を動的に調整する方法を考察します。</span><span class="sxs-lookup"><span data-stu-id="f3d86-108">In this tutorial we'll examine how to dynamically adjust the data modification capabilities based on the visiting user.</span></span>

## <a name="introduction"></a><span data-ttu-id="f3d86-109">はじめに</span><span class="sxs-lookup"><span data-stu-id="f3d86-109">Introduction</span></span>

<span data-ttu-id="f3d86-110">多数の web アプリケーションでは、ユーザー アカウントをサポートし、さまざまなオプション、レポート、およびログインしているユーザーに基づく機能を提供します。</span><span class="sxs-lookup"><span data-stu-id="f3d86-110">A number of web applications support user accounts and provide different options, reports, and functionality based on the logged in user.</span></span> <span data-ttu-id="f3d86-111">たとえば、このチュートリアルでする可能性がおそらく - 自分の会社名など、仕入先の情報と共に、名と、単位あたりの数量 - 自社製品のサイトと更新プログラムの全般情報にログオンする仕入れ先企業からユーザーを許可します。アドレス、s の連絡先情報、およびなど。</span><span class="sxs-lookup"><span data-stu-id="f3d86-111">For example, with our tutorials we might want to allow users from the supplier companies to log on to the site and update general information about their products - their name and quantity per unit, perhaps - along with supplier information, such as their company name, address, the contact person s information, and so on.</span></span> <span data-ttu-id="f3d86-112">さらに、それらにログオンしてユニットの在庫レベルの順序を変更やなどのように、製品情報を更新できるように、会社からユーザーの一部のユーザー アカウントを含める可能性があります。</span><span class="sxs-lookup"><span data-stu-id="f3d86-112">Furthermore, we might want to include some user accounts for people from our company so that they can log on and update product information like units on stock, reorder level, and so forth.</span></span> <span data-ttu-id="f3d86-113">Web アプリケーションには (ログインしていない人) を参照してください。 匿名ユーザーができるように可能性がありますもが、データの表示だけを制限するとします。</span><span class="sxs-lookup"><span data-stu-id="f3d86-113">Our web application might also allow anonymous users to visit (people who have not logged on), but would limit them to just viewing data.</span></span> <span data-ttu-id="f3d86-114">このようなユーザー アカウント システムの場所は、挿入、編集、および削除、現在ログオンしているユーザーの適切な機能を提供する、ASP.NET ページでデータ Web コントロールします。</span><span class="sxs-lookup"><span data-stu-id="f3d86-114">With such a user account system in place, we would want the data Web controls in our ASP.NET pages to offer the inserting, editing, and deleting capabilities appropriate for the currently logged on user.</span></span>

<span data-ttu-id="f3d86-115">このチュートリアルでは、訪問したユーザーに基づくデータ変更機能を動的に調整する方法を考察します。</span><span class="sxs-lookup"><span data-stu-id="f3d86-115">In this tutorial we'll examine how to dynamically adjust the data modification capabilities based on the visiting user.</span></span> <span data-ttu-id="f3d86-116">具体的には、供給業者によって提供される製品を一覧表示する GridView と共に編集可能な DetailsView で仕入先情報を表示するページを作成します。</span><span class="sxs-lookup"><span data-stu-id="f3d86-116">In particular, we'll create a page that displays the suppliers information in an editable DetailsView along with a GridView that lists the products provided by the supplier.</span></span> <span data-ttu-id="f3d86-117">ページにアクセスするユーザーが会社からの場合は、できる限り:; 業者の情報を表示ユーザーのアドレスを編集します。および業者によって提供される製品の情報を編集します。</span><span class="sxs-lookup"><span data-stu-id="f3d86-117">If the user visiting the page is from our company, they can: view any supplier s information; edit their address; and edit the information for any product provided by the supplier.</span></span> <span data-ttu-id="f3d86-118">のみできる場合、ただし、ユーザーは、特定の企業が、表示および独自のアドレス情報を編集し、提供が中止されたとマークされていない独自の製品のみを編集できます。</span><span class="sxs-lookup"><span data-stu-id="f3d86-118">If, however, the user is from a particular company, they can only view and edit their own address information and can only edit their products that have not been marked as discontinued.</span></span>

<span data-ttu-id="f3d86-119">[![会社からユーザーが、業者の情報を編集できます。](limiting-data-modification-functionality-based-on-the-user-cs/_static/image2.png)](limiting-data-modification-functionality-based-on-the-user-cs/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="f3d86-119">[![A User from Our Company Can Edit Any Supplier s Information](limiting-data-modification-functionality-based-on-the-user-cs/_static/image2.png)](limiting-data-modification-functionality-based-on-the-user-cs/_static/image1.png)</span></span>

<span data-ttu-id="f3d86-120">**図 1**:ユーザーからの会社は編集 Any 業者の情報 ([フルサイズの画像を表示する をクリックします](limiting-data-modification-functionality-based-on-the-user-cs/_static/image3.png))。</span><span class="sxs-lookup"><span data-stu-id="f3d86-120">**Figure 1**: A User from Our Company Can Edit Any Supplier s Information ([Click to view full-size image](limiting-data-modification-functionality-based-on-the-user-cs/_static/image3.png))</span></span>

<span data-ttu-id="f3d86-121">[![ユーザーが特定のサプライヤーが専用のビューと編集の情報](limiting-data-modification-functionality-based-on-the-user-cs/_static/image5.png)](limiting-data-modification-functionality-based-on-the-user-cs/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="f3d86-121">[![A User from a Particular Supplier Can Only View and Edit their Information](limiting-data-modification-functionality-based-on-the-user-cs/_static/image5.png)](limiting-data-modification-functionality-based-on-the-user-cs/_static/image4.png)</span></span>

<span data-ttu-id="f3d86-122">**図 2**:ユーザーが特定サプライヤーできますのみ表示し、情報の編集 ([フルサイズの画像を表示する をクリックします](limiting-data-modification-functionality-based-on-the-user-cs/_static/image6.png))。</span><span class="sxs-lookup"><span data-stu-id="f3d86-122">**Figure 2**: A User from a Particular Supplier Can Only View and Edit their Information ([Click to view full-size image](limiting-data-modification-functionality-based-on-the-user-cs/_static/image6.png))</span></span>

<span data-ttu-id="f3d86-123">Let s を始めましょう。</span><span class="sxs-lookup"><span data-stu-id="f3d86-123">Let s get started!</span></span>

> [!NOTE]
> <span data-ttu-id="f3d86-124">ASP.NET 2.0 メンバーシップ システムを作成、管理、およびユーザー アカウントを検証するための標準化された、拡張性の高いプラットフォームを提供します。</span><span class="sxs-lookup"><span data-stu-id="f3d86-124">ASP.NET 2.0 s membership system provides a standardized, extensible platform for creating, managing, and validating user accounts.</span></span> <span data-ttu-id="f3d86-125">調べる場合は、メンバーシップ システムがこれらのチュートリアルの範囲を超えているため、このチュートリアル代わりに"fakes"メンバーシップまたは、会社からの特定のサプライヤーから供給されるかどうかを選択する匿名の訪問者を許可することで。</span><span class="sxs-lookup"><span data-stu-id="f3d86-125">Since an examination of the membership system is beyond the scope of these tutorials, this tutorial instead "fakes" membership by allowing anonymous visitors to choose whether they are from a particular supplier or from our company.</span></span> <span data-ttu-id="f3d86-126">詳細については、メンバーシップを参照してください、 [ASP.NET 2.0 の検査のメンバーシップ、ロール、およびプロファイル](http://aspnet.4guysfromrolla.com/articles/120705-1.aspx)記事シリーズ。</span><span class="sxs-lookup"><span data-stu-id="f3d86-126">For more on membership, refer to my [Examining ASP.NET 2.0 s Membership, Roles, and Profile](http://aspnet.4guysfromrolla.com/articles/120705-1.aspx) article series.</span></span>

## <a name="step-1-allowing-the-user-to-specify-their-access-rights"></a><span data-ttu-id="f3d86-127">手順 1: ユーザーは、そのアクセス権を指定できるようにします。</span><span class="sxs-lookup"><span data-stu-id="f3d86-127">Step 1: Allowing the User to Specify their Access Rights</span></span>

<span data-ttu-id="f3d86-128">実際の web アプリケーションで協力して、社内用または特定の仕入先と、ユーザーがサイトにログオンすると、この情報が、ASP.NET ページからプログラムでアクセスできるでしょうかどうかをユーザー アカウント情報が含まれます。</span><span class="sxs-lookup"><span data-stu-id="f3d86-128">In a real-world web application, a user s account information would include whether they worked for our company or for a particular supplier, and this information would be programmatically accessible from our ASP.NET pages once the user has logged on to the site.</span></span> <span data-ttu-id="f3d86-129">この情報は、プロファイル システム、またはカスタムの手段を通じてユーザー レベルのアカウント情報として、ASP.NET 2.0 のロール システムを介してキャプチャでした。</span><span class="sxs-lookup"><span data-stu-id="f3d86-129">This information could be captured through ASP.NET 2.0 s roles system, as user-level account information through the profile system, or through some custom means.</span></span>

<span data-ttu-id="f3d86-130">このチュートリアルの目的が、ログオンしたユーザーに基づくデータ変更機能を調整することを示すために、ショーケース ASP.NET 2.0 のメンバーシップ、ロール、およびプロファイル システムするものではありませんので、非常に単純にメカニズムを使用して、特定、機能ページのかどうかを表示および編集の仕入先情報や、または、何ができる元のユーザーを示すことができます、DropDownList にアクセスするユーザーの特定の仕入先の情報を表示および編集します。</span><span class="sxs-lookup"><span data-stu-id="f3d86-130">Since the aim of this tutorial is to demonstrate adjusting the data modification capabilities based on the logged on user, and is not meant to showcase ASP.NET 2.0 s membership, roles, and profile systems, we'll use a very simply mechanism to determine the capabilities for the user visiting the page - a DropDownList from which the user can indicate if they should be able to view and edit any of the suppliers information or, alternatively, what particular supplier s information they can view and edit.</span></span> <span data-ttu-id="f3d86-131">彼女表示し、すべての仕入先情報 (既定値) を編集、ユーザーが示されている場合は、すべての仕入先内でページを仕入先のアドレス情報を編集し、選択した業者によって提供される製品の単位あたりの数量と名前を編集彼女ことができます。</span><span class="sxs-lookup"><span data-stu-id="f3d86-131">If the user indicates that she can view and edit all supplier information (the default), she can page through all suppliers, edit any supplier s address information, and edit the name and quantity per unit for any product provided by the selected supplier.</span></span> <span data-ttu-id="f3d86-132">ユーザーは彼女だけを表示できますを編集し、ただしの特定の仕入先、彼女だけその 1 つの仕入先の詳細および製品を表示でき、のみ更新あたりユニットの情報がこれらの製品の数量と名前を示す場合*いない*廃止されました。</span><span class="sxs-lookup"><span data-stu-id="f3d86-132">If the user indicates that she can only view and edit a particular supplier, however, then she can only view the details and products for that one supplier and can only update the name and quantity per unit information for those products that are *not* discontinued.</span></span>

<span data-ttu-id="f3d86-133">このチュートリアルでは、最初、手順は、この DropDownList を作成し、システムで、サプライヤーと設定を次に、です。</span><span class="sxs-lookup"><span data-stu-id="f3d86-133">Our first step in this tutorial, then, is to create this DropDownList and populate it with the suppliers in the system.</span></span> <span data-ttu-id="f3d86-134">開く、`UserLevelAccess.aspx`ページで、`EditInsertDelete`フォルダー、DropDownList を追加が`ID`プロパティに設定されて`Suppliers`、という名前の新しい ObjectDataSource にこの DropDownList をバインドおよび`AllSuppliersDataSource`します。</span><span class="sxs-lookup"><span data-stu-id="f3d86-134">Open the `UserLevelAccess.aspx` page in the `EditInsertDelete` folder, add a DropDownList whose `ID` property is set to `Suppliers`, and bind this DropDownList to a new ObjectDataSource named `AllSuppliersDataSource`.</span></span>

<span data-ttu-id="f3d86-135">[![AllSuppliersDataSource という名前の新しい ObjectDataSource を作成します。](limiting-data-modification-functionality-based-on-the-user-cs/_static/image8.png)](limiting-data-modification-functionality-based-on-the-user-cs/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="f3d86-135">[![Create a New ObjectDataSource Named AllSuppliersDataSource](limiting-data-modification-functionality-based-on-the-user-cs/_static/image8.png)](limiting-data-modification-functionality-based-on-the-user-cs/_static/image7.png)</span></span>

<span data-ttu-id="f3d86-136">**図 3**:名前付き新しい ObjectDataSource 作成`AllSuppliersDataSource`([フルサイズの画像を表示する をクリックします](limiting-data-modification-functionality-based-on-the-user-cs/_static/image9.png))。</span><span class="sxs-lookup"><span data-stu-id="f3d86-136">**Figure 3**: Create a New ObjectDataSource Named `AllSuppliersDataSource` ([Click to view full-size image](limiting-data-modification-functionality-based-on-the-user-cs/_static/image9.png))</span></span>

<span data-ttu-id="f3d86-137">この DropDownList を all に含めるので、構成を呼び出す ObjectDataSource、`SuppliersBLL`クラスの`GetSuppliers()`メソッド。</span><span class="sxs-lookup"><span data-stu-id="f3d86-137">Since we want this DropDownList to include all suppliers, configure the ObjectDataSource to invoke the `SuppliersBLL` class s `GetSuppliers()` method.</span></span> <span data-ttu-id="f3d86-138">ObjectDataSource s も確認`Update()`をメソッドにマップされて、`SuppliersBLL`クラスの`UpdateSupplierAddress`メソッドでは、この ObjectDataSource としてもによって使用される DetailsView を手順 2. で追加されていきます。</span><span class="sxs-lookup"><span data-stu-id="f3d86-138">Also ensure that the ObjectDataSource s `Update()` method is mapped to the `SuppliersBLL` class s `UpdateSupplierAddress` method, as this ObjectDataSource will also be used by the DetailsView we'll be adding in Step 2.</span></span>

<span data-ttu-id="f3d86-139">ObjectDataSource ウィザードを完了すると、構成することで、手順を完了、 `Suppliers` DropDownList が表示されるよう、`CompanyName`使用してデータ フィールド、`SupplierID`データ フィールドの各値として`ListItem`します。</span><span class="sxs-lookup"><span data-stu-id="f3d86-139">After completing the ObjectDataSource wizard, complete the steps by configuring the `Suppliers` DropDownList such that it shows the `CompanyName` data field and uses the `SupplierID` data field as the value for each `ListItem`.</span></span>

<span data-ttu-id="f3d86-140">[![CompanyName と SupplierID データ フィールドを使用する仕入先の DropDownList を構成します。](limiting-data-modification-functionality-based-on-the-user-cs/_static/image11.png)](limiting-data-modification-functionality-based-on-the-user-cs/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="f3d86-140">[![Configure the Suppliers DropDownList to Use the CompanyName and SupplierID Data Fields](limiting-data-modification-functionality-based-on-the-user-cs/_static/image11.png)](limiting-data-modification-functionality-based-on-the-user-cs/_static/image10.png)</span></span>

<span data-ttu-id="f3d86-141">**図 4**:構成、 `Suppliers` DropDownList を使用して、`CompanyName`と`SupplierID`データ フィールド ([フルサイズの画像を表示する をクリックします](limiting-data-modification-functionality-based-on-the-user-cs/_static/image12.png))。</span><span class="sxs-lookup"><span data-stu-id="f3d86-141">**Figure 4**: Configure the `Suppliers` DropDownList to Use the `CompanyName` and `SupplierID` Data Fields ([Click to view full-size image](limiting-data-modification-functionality-based-on-the-user-cs/_static/image12.png))</span></span>

<span data-ttu-id="f3d86-142">この時点では、DropDownList には、データベースの仕入先の会社名が一覧表示します。</span><span class="sxs-lookup"><span data-stu-id="f3d86-142">At this point, the DropDownList lists the company names of the suppliers in the database.</span></span> <span data-ttu-id="f3d86-143">ただし、必要もありますし、DropDownList に「すべてサプライヤーの表示/編集」オプションを含めます。</span><span class="sxs-lookup"><span data-stu-id="f3d86-143">However, we also need to include a "Show/Edit ALL Suppliers" option to the DropDownList.</span></span> <span data-ttu-id="f3d86-144">これを行うには、設定、 `Suppliers` DropDownList s`AppendDataBoundItems`プロパティを`true`し、追加、`ListItem`が`Text`プロパティが"表示/編集 All"、値が`-1`します。</span><span class="sxs-lookup"><span data-stu-id="f3d86-144">To accomplish this, set the `Suppliers` DropDownList s `AppendDataBoundItems` property to `true` and then add a `ListItem` whose `Text` property is "Show/Edit ALL Suppliers" and whose value is `-1`.</span></span> <span data-ttu-id="f3d86-145">[プロパティ] ウィンドウに移動し、DropDownList s で省略記号をクリックして、宣言型マークアップから直接、またはデザイナーを使用この追加することができます`Items`プロパティ。</span><span class="sxs-lookup"><span data-stu-id="f3d86-145">This can be added directly through the declarative markup or through the Designer by going to the Properties window and clicking on the ellipses in the DropDownList s `Items` property.</span></span>

> [!NOTE]
> <span data-ttu-id="f3d86-146">戻って、 [*マスター/詳細のフィルター処理で、DropDownList* ](../masterdetail/master-detail-filtering-with-a-dropdownlist-cs.md)の詳細については、すべての項目をデータ バインディングの DropDownList に追加するためのチュートリアルです。</span><span class="sxs-lookup"><span data-stu-id="f3d86-146">Refer back to the [*Master/Detail Filtering With a DropDownList*](../masterdetail/master-detail-filtering-with-a-dropdownlist-cs.md) tutorial for a more detailed discussion on adding a Select All item to a databound DropDownList.</span></span>

<span data-ttu-id="f3d86-147">後に、`AppendDataBoundItems`プロパティが設定されていると、`ListItem`よう追加されると、DropDownList s の宣言型マークアップになります。</span><span class="sxs-lookup"><span data-stu-id="f3d86-147">After the `AppendDataBoundItems` property has been set and the `ListItem` added, the DropDownList s declarative markup should look like:</span></span>

[!code-aspx[Main](limiting-data-modification-functionality-based-on-the-user-cs/samples/sample1.aspx)]

<span data-ttu-id="f3d86-148">図 5 は、ブラウザーで表示したときに、現在の進行状況のスクリーン ショットを示します。</span><span class="sxs-lookup"><span data-stu-id="f3d86-148">Figure 5 shows a screen shot of our current progress, when viewed through a browser.</span></span>

<span data-ttu-id="f3d86-149">[![Suppliers DropDownList には、すべての ListItem と各業者の 1 つを表示が含まれます](limiting-data-modification-functionality-based-on-the-user-cs/_static/image14.png)](limiting-data-modification-functionality-based-on-the-user-cs/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="f3d86-149">[![The Suppliers DropDownList Contains a Show ALL ListItem, Plus One for Each Supplier](limiting-data-modification-functionality-based-on-the-user-cs/_static/image14.png)](limiting-data-modification-functionality-based-on-the-user-cs/_static/image13.png)</span></span>

<span data-ttu-id="f3d86-150">**図 5**:`Suppliers` DropDownList がすべて表示が含まれています`ListItem`、および 1 つの各仕入先 ([フルサイズの画像を表示する をクリックします](limiting-data-modification-functionality-based-on-the-user-cs/_static/image15.png))。</span><span class="sxs-lookup"><span data-stu-id="f3d86-150">**Figure 5**: The `Suppliers` DropDownList Contains a Show ALL `ListItem`, Plus One for Each Supplier ([Click to view full-size image](limiting-data-modification-functionality-based-on-the-user-cs/_static/image15.png))</span></span>

<span data-ttu-id="f3d86-151">ユーザーが自分の選択を変更した直後にユーザー インターフェイスを更新するので、設定、 `Suppliers` DropDownList s`AutoPostBack`プロパティを`true`します。</span><span class="sxs-lookup"><span data-stu-id="f3d86-151">Since we want to update the user interface immediately after the user has changed their selection, set the `Suppliers` DropDownList s `AutoPostBack` property to `true`.</span></span> <span data-ttu-id="f3d86-152">手順 2. で DropDownList の選択に基づくサプライヤーの情報を表示する DetailsView コントロールを作成します。</span><span class="sxs-lookup"><span data-stu-id="f3d86-152">In Step 2 we'll create a DetailsView control that will show the information for the supplier(s) based on the DropDownList selection.</span></span> <span data-ttu-id="f3d86-153">次に、手順 3. で作成しますこの DropDownList s のイベント ハンドラー`SelectedIndexChanged`イベント、これで選択した仕入先に基づいて、DetailsView に適切な仕入先の情報をバインドするコードは追加します。</span><span class="sxs-lookup"><span data-stu-id="f3d86-153">Then, in Step 3, we'll create an event handler for this DropDownList s `SelectedIndexChanged` event, in which we'll add code that binds the appropriate supplier information to the DetailsView based upon the selected supplier.</span></span>

## <a name="step-2-adding-a-detailsview-control"></a><span data-ttu-id="f3d86-154">手順 2: DetailsView コントロールを追加します。</span><span class="sxs-lookup"><span data-stu-id="f3d86-154">Step 2: Adding a DetailsView Control</span></span>

<span data-ttu-id="f3d86-155">S、DetailsView を使用して仕入先情報を表示することができます。</span><span class="sxs-lookup"><span data-stu-id="f3d86-155">Let s use a DetailsView to show supplier information.</span></span> <span data-ttu-id="f3d86-156">表示およびすべての仕入先を編集できるユーザー、ユーザーの DetailsView はページングをサポートして、一度に仕入先情報の 1 つのレコードをステップ ユーザーを許可します。</span><span class="sxs-lookup"><span data-stu-id="f3d86-156">For the user who can view and edit all suppliers, the DetailsView will support paging, allowing the user to step through the supplier information one record at a time.</span></span> <span data-ttu-id="f3d86-157">特定業者の場合、ユーザーは、ただし、DetailsView がその仕入先を特定の情報が表示されます、およびページング インターフェイスは含まれません。</span><span class="sxs-lookup"><span data-stu-id="f3d86-157">If the user works for a particular supplier, however, the DetailsView will show only that particular supplier s information and will not include a paging interface.</span></span> <span data-ttu-id="f3d86-158">どちらの場合は、DetailsView を仕入先の住所や市区町村、都道府県 フィールドを編集するユーザーを許可する必要があります。</span><span class="sxs-lookup"><span data-stu-id="f3d86-158">In either case, the DetailsView needs to allow the user to edit the supplier s address, city, and country fields.</span></span>

<span data-ttu-id="f3d86-159">下に、DetailsView を追加、 `Suppliers` DropDownList を設定、`ID`プロパティを`SupplierDetails`にバインドし、 `AllSuppliersDataSource` ObjectDataSource は、前の手順で作成します。</span><span class="sxs-lookup"><span data-stu-id="f3d86-159">Add a DetailsView to the page beneath the `Suppliers` DropDownList, set its `ID` property to `SupplierDetails`, and bind it to the `AllSuppliersDataSource` ObjectDataSource created in the previous step.</span></span> <span data-ttu-id="f3d86-160">次に、DetailsView s のスマート タグからのページングを有効にして、編集を有効にするチェック ボックスを確認します。</span><span class="sxs-lookup"><span data-stu-id="f3d86-160">Next, check the Enable Paging and Enable Editing checkboxes from the DetailsView s smart tag.</span></span>

> [!NOTE]
> <span data-ttu-id="f3d86-161">ないスマート DetailsView s で編集を有効にするオプションが表示される場合は、タグ付けして s ObjectDataSource s をマップしなかったため`Update()`メソッドを`SuppliersBLL`クラスの`UpdateSupplierAddress`メソッド。</span><span class="sxs-lookup"><span data-stu-id="f3d86-161">If you don t see an Enable Editing option in the DetailsView s smart tag it s because you did not map the ObjectDataSource s `Update()` method to the `SuppliersBLL` class s `UpdateSupplierAddress` method.</span></span> <span data-ttu-id="f3d86-162">ご協力をクリックして戻り、この構成を変更、その後、編集を有効にするオプションが DetailsView s のスマート タグに表示されます。</span><span class="sxs-lookup"><span data-stu-id="f3d86-162">Take a moment to go back and make this configuration change, after which the Enable Editing option should appear in the DetailsView s smart tag.</span></span>

<span data-ttu-id="f3d86-163">`SuppliersBLL`クラス s`UpdateSupplierAddress`メソッドは、4 つのパラメーターのみを受け入れる`supplierID`、 `address`、 `city`、および`country`-DetailsView の BoundFields を変更できるように、`CompanyName`と`Phone`BoundFields は読み取り専用です。</span><span class="sxs-lookup"><span data-stu-id="f3d86-163">Since the `SuppliersBLL` class s `UpdateSupplierAddress` method only accepts four parameters - `supplierID`, `address`, `city`, and `country` - modify the DetailsView s BoundFields so that the `CompanyName` and `Phone` BoundFields are read-only.</span></span> <span data-ttu-id="f3d86-164">さらに、削除、 `SupplierID` BoundField 全体。</span><span class="sxs-lookup"><span data-stu-id="f3d86-164">Additionally, remove the `SupplierID` BoundField altogether.</span></span> <span data-ttu-id="f3d86-165">最後に、 `AllSuppliersDataSource` ObjectDataSource が現在その`OldValuesParameterFormatString`プロパティに設定`original_{0}`します。</span><span class="sxs-lookup"><span data-stu-id="f3d86-165">Finally, the `AllSuppliersDataSource` ObjectDataSource currently has its `OldValuesParameterFormatString` property set to `original_{0}`.</span></span> <span data-ttu-id="f3d86-166">、宣言型構文全体からこのプロパティの設定を削除するか、既定の値に設定する少し`{0}`します。</span><span class="sxs-lookup"><span data-stu-id="f3d86-166">Take a moment to remove this property setting from the declarative syntax altogether, or set it to the default value, `{0}`.</span></span>

<span data-ttu-id="f3d86-167">構成した後、 `SupplierDetails` DetailsView と`AllSuppliersDataSource`ObjectDataSource に、次の宣言型マークアップ。</span><span class="sxs-lookup"><span data-stu-id="f3d86-167">After configuring the `SupplierDetails` DetailsView and `AllSuppliersDataSource` ObjectDataSource, we will have the following declarative markup:</span></span>

[!code-aspx[Main](limiting-data-modification-functionality-based-on-the-user-cs/samples/sample2.aspx)]

<span data-ttu-id="f3d86-168">この時点で、DetailsView を介してページングされることができでの選択に関係なく、選択した仕入先のアドレス情報を更新できる、 `Suppliers` DropDownList (図 6 参照)。</span><span class="sxs-lookup"><span data-stu-id="f3d86-168">At this point the DetailsView can be paged through and the selected supplier s address information can be updated, regardless of the selection made in the `Suppliers` DropDownList (see Figure 6).</span></span>

<span data-ttu-id="f3d86-169">[![仕入先情報を表示すること、やそのアドレスを更新](limiting-data-modification-functionality-based-on-the-user-cs/_static/image17.png)](limiting-data-modification-functionality-based-on-the-user-cs/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="f3d86-169">[![Any Suppliers Information Can Be Viewed, and Its Address Updated](limiting-data-modification-functionality-based-on-the-user-cs/_static/image17.png)](limiting-data-modification-functionality-based-on-the-user-cs/_static/image16.png)</span></span>

<span data-ttu-id="f3d86-170">**図 6**:仕入先情報を表示できます、およびそのアドレスを更新 ([フルサイズの画像を表示する をクリックします](limiting-data-modification-functionality-based-on-the-user-cs/_static/image18.png))。</span><span class="sxs-lookup"><span data-stu-id="f3d86-170">**Figure 6**: Any Suppliers Information Can Be Viewed, and Its Address Updated ([Click to view full-size image](limiting-data-modification-functionality-based-on-the-user-cs/_static/image18.png))</span></span>

## <a name="step-3-displaying-only-the-selected-supplier-s-information"></a><span data-ttu-id="f3d86-171">手順 3: 選択したサプライヤーの情報のみを表示します。</span><span class="sxs-lookup"><span data-stu-id="f3d86-171">Step 3: Displaying Only the Selected Supplier s Information</span></span>

<span data-ttu-id="f3d86-172">このページは現在から特定の仕入先が選択されているかどうかに関係なくすべての仕入先の情報を表示、 `Suppliers` DropDownList します。</span><span class="sxs-lookup"><span data-stu-id="f3d86-172">Our page currently displays the information for all suppliers regardless of whether a particular supplier has been selected from the `Suppliers` DropDownList.</span></span> <span data-ttu-id="f3d86-173">選択した仕入先の仕入先の情報だけを表示するためには、このページで、特定の仕入先に関する情報を取得する 1 つに別の ObjectDataSource を追加する必要があります。</span><span class="sxs-lookup"><span data-stu-id="f3d86-173">In order to display just the supplier information for the selected supplier we need to add another ObjectDataSource to our page, one that retrieves information about a particular supplier.</span></span>

<span data-ttu-id="f3d86-174">名前のページに新しい ObjectDataSource を追加`SingleSupplierDataSource`します。</span><span class="sxs-lookup"><span data-stu-id="f3d86-174">Add a new ObjectDataSource to the page, naming it `SingleSupplierDataSource`.</span></span> <span data-ttu-id="f3d86-175">スマート タグ、データ ソースの構成 をクリックしを使用させる、`SuppliersBLL`クラスの`GetSupplierBySupplierID(supplierID)`メソッド。</span><span class="sxs-lookup"><span data-stu-id="f3d86-175">From its smart tag, click the Configure Data Source link and have it use the `SuppliersBLL` class s `GetSupplierBySupplierID(supplierID)` method.</span></span> <span data-ttu-id="f3d86-176">同様、 `AllSuppliersDataSource` 、ObjectDataSource が、 `SingleSupplierDataSource` ObjectDataSource s`Update()`メソッドにマップする、`SuppliersBLL`クラスの`UpdateSupplierAddress`メソッド。</span><span class="sxs-lookup"><span data-stu-id="f3d86-176">As with the `AllSuppliersDataSource` ObjectDataSource, have the `SingleSupplierDataSource` ObjectDataSource s `Update()` method mapped to the `SuppliersBLL` class s `UpdateSupplierAddress` method.</span></span>

<span data-ttu-id="f3d86-177">[![GetSupplierBySupplierID(supplierID) メソッドを使用して SingleSupplierDataSource ObjectDataSource を構成します。](limiting-data-modification-functionality-based-on-the-user-cs/_static/image20.png)](limiting-data-modification-functionality-based-on-the-user-cs/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="f3d86-177">[![Configure the SingleSupplierDataSource ObjectDataSource to Use the GetSupplierBySupplierID(supplierID) Method](limiting-data-modification-functionality-based-on-the-user-cs/_static/image20.png)](limiting-data-modification-functionality-based-on-the-user-cs/_static/image19.png)</span></span>

<span data-ttu-id="f3d86-178">**図 7**:構成、 `SingleSupplierDataSource` ObjectDataSource を使用して、`GetSupplierBySupplierID(supplierID)`メソッド ([フルサイズの画像を表示する をクリックします](limiting-data-modification-functionality-based-on-the-user-cs/_static/image21.png))。</span><span class="sxs-lookup"><span data-stu-id="f3d86-178">**Figure 7**: Configure the `SingleSupplierDataSource` ObjectDataSource to Use the `GetSupplierBySupplierID(supplierID)` Method ([Click to view full-size image](limiting-data-modification-functionality-based-on-the-user-cs/_static/image21.png))</span></span>

<span data-ttu-id="f3d86-179">次に、パラメーターのソースを指定する re 求め、`GetSupplierBySupplierID(supplierID)`メソッドの`supplierID`入力パラメーター。</span><span class="sxs-lookup"><span data-stu-id="f3d86-179">Next, we re prompted to specify the parameter source for the `GetSupplierBySupplierID(supplierID)` method s `supplierID` input parameter.</span></span> <span data-ttu-id="f3d86-180">DropDownList を使用してから選択した供給業者の情報を表示するため、 `Suppliers` DropDownList の`SelectedValue`パラメーターのソースとしてのプロパティ。</span><span class="sxs-lookup"><span data-stu-id="f3d86-180">Since we want to show the information for the supplier selected from the DropDownList, use the `Suppliers` DropDownList s `SelectedValue` property as the parameter source.</span></span>

<span data-ttu-id="f3d86-181">[![Suppliers DropDownList を supplierID パラメーターのソースとして使用します。](limiting-data-modification-functionality-based-on-the-user-cs/_static/image23.png)](limiting-data-modification-functionality-based-on-the-user-cs/_static/image22.png)</span><span class="sxs-lookup"><span data-stu-id="f3d86-181">[![Use the Suppliers DropDownList as the supplierID Parameter Source](limiting-data-modification-functionality-based-on-the-user-cs/_static/image23.png)](limiting-data-modification-functionality-based-on-the-user-cs/_static/image22.png)</span></span>

<span data-ttu-id="f3d86-182">**図 8**:使用して、`Suppliers`として DropDownList、`supplierID`パラメーター ソース ([フルサイズの画像を表示する をクリックします](limiting-data-modification-functionality-based-on-the-user-cs/_static/image24.png))。</span><span class="sxs-lookup"><span data-stu-id="f3d86-182">**Figure 8**: Use the `Suppliers` DropDownList as the `supplierID` Parameter Source ([Click to view full-size image](limiting-data-modification-functionality-based-on-the-user-cs/_static/image24.png))</span></span>

<span data-ttu-id="f3d86-183">DetailsView コントロールに現在常に使用する構成されている追加のこの 2 つ目 ObjectDataSource を使用しても、 `AllSuppliersDataSource` ObjectDataSource します。</span><span class="sxs-lookup"><span data-stu-id="f3d86-183">Even with this second ObjectDataSource added, the DetailsView control is currently configured to always use the `AllSuppliersDataSource` ObjectDataSource.</span></span> <span data-ttu-id="f3d86-184">に応じて DetailsView によって使用されるデータ ソースを調整するためのロジックを追加する必要があります、 `Suppliers` DropDownList の項目を選択します。</span><span class="sxs-lookup"><span data-stu-id="f3d86-184">We need to add logic to adjust the data source used by the DetailsView depending on the `Suppliers` DropDownList item selected.</span></span> <span data-ttu-id="f3d86-185">これを行うには、作成、 `SelectedIndexChanged` Suppliers DropDownList のイベント ハンドラー。</span><span class="sxs-lookup"><span data-stu-id="f3d86-185">To accomplish this, create a `SelectedIndexChanged` event handler for the Suppliers DropDownList.</span></span> <span data-ttu-id="f3d86-186">これは、デザイナーで DropDownList をダブルクリックすると最も簡単に作成できます。</span><span class="sxs-lookup"><span data-stu-id="f3d86-186">This can most easily be created by double-clicking the DropDownList in the Designer.</span></span> <span data-ttu-id="f3d86-187">このイベント ハンドラーは、使用するには、どのようなデータ ソースを決定する必要があり、DetailsView にデータを再バインドする必要があります。</span><span class="sxs-lookup"><span data-stu-id="f3d86-187">This event handler needs to determine what data source to use and must rebind the data to the DetailsView.</span></span> <span data-ttu-id="f3d86-188">これは、次のコードで実現されます。</span><span class="sxs-lookup"><span data-stu-id="f3d86-188">This is accomplished with the following code:</span></span>

[!code-csharp[Main](limiting-data-modification-functionality-based-on-the-user-cs/samples/sample3.cs)]

<span data-ttu-id="f3d86-189">イベント ハンドラーは、"表示/編集 All"オプションを選択したかどうかを決定することで開始します。</span><span class="sxs-lookup"><span data-stu-id="f3d86-189">The event handler begins by determining whether the "Show/Edit ALL Suppliers" option was selected.</span></span> <span data-ttu-id="f3d86-190">設定した場合、 `SupplierDetails` DetailsView s`DataSourceID`に`AllSuppliersDataSource`し、業者のセット内の最初のレコードを設定して、ユーザーを返します、`PageIndex`プロパティを 0 にします。</span><span class="sxs-lookup"><span data-stu-id="f3d86-190">If it was, it sets the `SupplierDetails` DetailsView s `DataSourceID` to `AllSuppliersDataSource` and returns the user to the first record in the set of suppliers by setting the `PageIndex` property to 0.</span></span> <span data-ttu-id="f3d86-191">ただし、ユーザーが、DropDownList、DetailsView s から特定の仕入先を選択した場合、`DataSourceID`に割り当てられている`SingleSuppliersDataSource`します。</span><span class="sxs-lookup"><span data-stu-id="f3d86-191">If, however, the user has selected a particular supplier from the DropDownList, the DetailsView s `DataSourceID` is assigned to `SingleSuppliersDataSource`.</span></span> <span data-ttu-id="f3d86-192">どのようなデータに関係なく、ソースを使用する、`SuppliersDetails`モードは読み取り専用モードに戻すしへの呼び出しによってデータが、DetailsView をバインドし、`SuppliersDetails`コントロールの`DataBind()`メソッド。</span><span class="sxs-lookup"><span data-stu-id="f3d86-192">Regardless of what data source is used, the `SuppliersDetails` mode is reverted back to the read-only mode and the data is rebound to the DetailsView by a call to the `SuppliersDetails` control s `DataBind()` method.</span></span>

<span data-ttu-id="f3d86-193">場所でのこのイベント ハンドラーと DetailsView コントロールでは、仕入先のすべてを参照してページング インターフェイスを使用する場合、"表示/編集 All"オプションを選択した場合を除き、選択したサプライヤーがようになりました示します。</span><span class="sxs-lookup"><span data-stu-id="f3d86-193">With this event handler in place, the DetailsView control now shows the selected supplier, unless the "Show/Edit ALL Suppliers" option was selected, in which case all of the suppliers can be viewed through the paging interface.</span></span> <span data-ttu-id="f3d86-194">図 9 は、"表示/編集 All"オプションを選択します。 ページを示していますユーザーがアクセスし、いずれかの供給を更新できるようにページング インターフェイスが存在することを確認します。</span><span class="sxs-lookup"><span data-stu-id="f3d86-194">Figure 9 shows the page with the "Show/Edit ALL Suppliers" option selected; note that the paging interface is present, allowing the user to visit and update any supplier.</span></span> <span data-ttu-id="f3d86-195">図 10 では、選択した Ma 商店株式会社の供給元に、ページを示します。</span><span class="sxs-lookup"><span data-stu-id="f3d86-195">Figure 10 shows the page with the Ma Maison supplier selected.</span></span> <span data-ttu-id="f3d86-196">のみの Ma 商店株式会社 s の情報は、ここで表示して編集可能です。</span><span class="sxs-lookup"><span data-stu-id="f3d86-196">Only Ma Maison s information is viewable and editable in this case.</span></span>

<span data-ttu-id="f3d86-197">[![表示および編集するには、すべての仕入先情報](limiting-data-modification-functionality-based-on-the-user-cs/_static/image26.png)](limiting-data-modification-functionality-based-on-the-user-cs/_static/image25.png)</span><span class="sxs-lookup"><span data-stu-id="f3d86-197">[![All of the Suppliers Information Can Be Viewed and Edited](limiting-data-modification-functionality-based-on-the-user-cs/_static/image26.png)](limiting-data-modification-functionality-based-on-the-user-cs/_static/image25.png)</span></span>

<span data-ttu-id="f3d86-198">**図 9**:すべての編集と仕入先情報を表示できます ([フルサイズの画像を表示する をクリックします](limiting-data-modification-functionality-based-on-the-user-cs/_static/image27.png))。</span><span class="sxs-lookup"><span data-stu-id="f3d86-198">**Figure 9**: All of the Suppliers Information Can Be Viewed and Edited ([Click to view full-size image](limiting-data-modification-functionality-based-on-the-user-cs/_static/image27.png))</span></span>

<span data-ttu-id="f3d86-199">[![選択したサプライヤーの情報のみを表示および編集できます。](limiting-data-modification-functionality-based-on-the-user-cs/_static/image29.png)](limiting-data-modification-functionality-based-on-the-user-cs/_static/image28.png)</span><span class="sxs-lookup"><span data-stu-id="f3d86-199">[![Only the Selected Supplier s Information Can Be Viewed and Edited](limiting-data-modification-functionality-based-on-the-user-cs/_static/image29.png)](limiting-data-modification-functionality-based-on-the-user-cs/_static/image28.png)</span></span>

<span data-ttu-id="f3d86-200">**図 10**:Viewed および編集された仕入先の選択の情報をできるだけ ([フルサイズの画像を表示する をクリックします](limiting-data-modification-functionality-based-on-the-user-cs/_static/image30.png))。</span><span class="sxs-lookup"><span data-stu-id="f3d86-200">**Figure 10**: Only the Selected Supplier s Information Can Be Viewed and Edited ([Click to view full-size image](limiting-data-modification-functionality-based-on-the-user-cs/_static/image30.png))</span></span>

> [!NOTE]
> <span data-ttu-id="f3d86-201">このチュートリアルでは、DropDownList と DetailsView コントロール s`EnableViewState`に設定する必要があります`true`(既定) ため、DropDownList s`SelectedIndex`と DetailsView の`DataSourceID`のプロパティの変更は、ポストバック間で記憶する必要があります。</span><span class="sxs-lookup"><span data-stu-id="f3d86-201">For this tutorial, both the DropDownList and DetailsView control s `EnableViewState` must be set to `true` (the default) because the DropDownList s `SelectedIndex` and the DetailsView s `DataSourceID` property s changes must be remembered across postbacks.</span></span>

## <a name="step-4-listing-the-suppliers-products-in-an-editable-gridview"></a><span data-ttu-id="f3d86-202">手順 4: 編集可能な GridView で Suppliers 製品を一覧表示します。</span><span class="sxs-lookup"><span data-stu-id="f3d86-202">Step 4: Listing the Suppliers Products in an Editable GridView</span></span>

<span data-ttu-id="f3d86-203">完了の DetailsView を選択した業者によって提供されるこれらの製品を一覧表示する編集可能な GridView を含めるには、次のステップです。</span><span class="sxs-lookup"><span data-stu-id="f3d86-203">With the DetailsView complete, our next step is to include an editable GridView that lists those products provided by the selected supplier.</span></span> <span data-ttu-id="f3d86-204">この GridView でのみ編集を許可する必要があります、`ProductName`と`QuantityPerUnit`フィールド。</span><span class="sxs-lookup"><span data-stu-id="f3d86-204">This GridView should allow edits to only the `ProductName` and `QuantityPerUnit` fields.</span></span> <span data-ttu-id="f3d86-205">さらに、ページにアクセスするユーザーが特定のサプライヤーからの場合は、のみを許可するのにはこれらの製品の更新プログラム*いない*廃止されました。</span><span class="sxs-lookup"><span data-stu-id="f3d86-205">Moreover, if the user visiting the page is from a particular supplier, it should only allow updates to those products that are *not* discontinued.</span></span> <span data-ttu-id="f3d86-206">最初のオーバー ロードを追加する必要がありますこれを実現する、`ProductsBLL`クラス s`UpdateProducts`で受け取るメソッドだけ`ProductID`、 `ProductName`、および`QuantityPerUnit`入力としてのフィールド。</span><span class="sxs-lookup"><span data-stu-id="f3d86-206">To accomplish this we'll need to first add an overload of the `ProductsBLL` class s `UpdateProducts` method that takes in just the `ProductID`, `ProductName`, and `QuantityPerUnit` fields as inputs.</span></span> <span data-ttu-id="f3d86-207">私たち事前は多数のチュートリアルで、このプロセスをステップ実行しましたが、それでは s だけコードを見て、ここでは、そのデータに追加する必要があります`ProductsBLL`:</span><span class="sxs-lookup"><span data-stu-id="f3d86-207">We ve stepped through this process beforehand in numerous tutorials, so let s just look at the code here, which should be added to `ProductsBLL`:</span></span>

[!code-csharp[Main](limiting-data-modification-functionality-based-on-the-user-cs/samples/sample4.cs)]

<span data-ttu-id="f3d86-208">このオーバー ロードに、作成 GridView コントロールとその関連付けられている ObjectDataSource を追加する準備が整いました。</span><span class="sxs-lookup"><span data-stu-id="f3d86-208">With this overload created, we re ready to add the GridView control and its associated ObjectDataSource.</span></span> <span data-ttu-id="f3d86-209">ページへの新しい GridView、設定、`ID`プロパティを`ProductsBySupplier`、という名前の新しい ObjectDataSource を使用するように構成および`ProductsBySupplierDataSource`します。</span><span class="sxs-lookup"><span data-stu-id="f3d86-209">Add a new GridView to the page, set its `ID` property to `ProductsBySupplier`, and configure it to use a new ObjectDataSource named `ProductsBySupplierDataSource`.</span></span> <span data-ttu-id="f3d86-210">この GridView は選択した業者によってこれらの製品を一覧表示するため、使用、`ProductsBLL`クラスの`GetProductsBySupplierID(supplierID)`メソッド。</span><span class="sxs-lookup"><span data-stu-id="f3d86-210">Since we want this GridView to list those products by the selected supplier, use the `ProductsBLL` class s `GetProductsBySupplierID(supplierID)` method.</span></span> <span data-ttu-id="f3d86-211">マップすることも、`Update()`メソッドを新しい`UpdateProduct`オーバー ロードを作成しました。</span><span class="sxs-lookup"><span data-stu-id="f3d86-211">Also map the `Update()` method to the new `UpdateProduct` overload we just created.</span></span>

<span data-ttu-id="f3d86-212">[![先ほど作成した UpdateProduct オーバー ロードを使用する ObjectDataSource を構成します。](limiting-data-modification-functionality-based-on-the-user-cs/_static/image32.png)](limiting-data-modification-functionality-based-on-the-user-cs/_static/image31.png)</span><span class="sxs-lookup"><span data-stu-id="f3d86-212">[![Configure the ObjectDataSource to Use the UpdateProduct Overload Just Created](limiting-data-modification-functionality-based-on-the-user-cs/_static/image32.png)](limiting-data-modification-functionality-based-on-the-user-cs/_static/image31.png)</span></span>

<span data-ttu-id="f3d86-213">**図 11**:構成に使用する ObjectDataSource、`UpdateProduct`先ほど作成したオーバー ロード ([フルサイズの画像を表示する をクリックします](limiting-data-modification-functionality-based-on-the-user-cs/_static/image33.png))。</span><span class="sxs-lookup"><span data-stu-id="f3d86-213">**Figure 11**: Configure the ObjectDataSource to Use the `UpdateProduct` Overload Just Created ([Click to view full-size image](limiting-data-modification-functionality-based-on-the-user-cs/_static/image33.png))</span></span>

<span data-ttu-id="f3d86-214">パラメーターのソースを選択するように求め re、`GetProductsBySupplierID(supplierID)`メソッドの`supplierID`入力パラメーター。</span><span class="sxs-lookup"><span data-stu-id="f3d86-214">We re prompted to select the parameter source for the `GetProductsBySupplierID(supplierID)` method s `supplierID` input parameter.</span></span> <span data-ttu-id="f3d86-215">使用して、DetailsView で選択されている業者の製品を表示するので、 `SuppliersDetails` DetailsView コントロールの`SelectedValue`パラメーターのソースとしてのプロパティ。</span><span class="sxs-lookup"><span data-stu-id="f3d86-215">Since we want to show the products for the supplier selected in the DetailsView, use the `SuppliersDetails` DetailsView control s `SelectedValue` property as the parameter source.</span></span>

<span data-ttu-id="f3d86-216">[![パラメーターのソースとして SuppliersDetails DetailsView の SelectedValue プロパティを使用します。](limiting-data-modification-functionality-based-on-the-user-cs/_static/image35.png)](limiting-data-modification-functionality-based-on-the-user-cs/_static/image34.png)</span><span class="sxs-lookup"><span data-stu-id="f3d86-216">[![Use the SuppliersDetails DetailsView s SelectedValue Property as the Parameter Source](limiting-data-modification-functionality-based-on-the-user-cs/_static/image35.png)](limiting-data-modification-functionality-based-on-the-user-cs/_static/image34.png)</span></span>

<span data-ttu-id="f3d86-217">**図 12**:使用して、 `SuppliersDetails` DetailsView s`SelectedValue`パラメーターのソースとしてのプロパティ ([フルサイズの画像を表示する をクリックします](limiting-data-modification-functionality-based-on-the-user-cs/_static/image36.png))。</span><span class="sxs-lookup"><span data-stu-id="f3d86-217">**Figure 12**: Use the `SuppliersDetails` DetailsView s `SelectedValue` Property as the Parameter Source ([Click to view full-size image](limiting-data-modification-functionality-based-on-the-user-cs/_static/image36.png))</span></span>

<span data-ttu-id="f3d86-218">以外の GridView フィールドのすべてを削除して、GridView に返す`ProductName`、`QuantityPerUnit`と`Discontinued`、マーク、 `Discontinued` CheckBoxField 読み取り専用とします。</span><span class="sxs-lookup"><span data-stu-id="f3d86-218">Returning to the GridView, remove all of the GridView fields except for `ProductName`, `QuantityPerUnit`, and `Discontinued`, marking the `Discontinued` CheckBoxField as read-only.</span></span> <span data-ttu-id="f3d86-219">また、GridView s のスマート タグの編集を有効にするオプションを確認します。</span><span class="sxs-lookup"><span data-stu-id="f3d86-219">Also, check the Enable Editing option from the GridView s smart tag.</span></span> <span data-ttu-id="f3d86-220">これらの変更が完了したら、GridView と ObjectDataSource の宣言型マークアップする必要があります、次のようになります。</span><span class="sxs-lookup"><span data-stu-id="f3d86-220">After these changes have been made, the declarative markup for the GridView and ObjectDataSource should look similar to the following:</span></span>

[!code-aspx[Main](limiting-data-modification-functionality-based-on-the-user-cs/samples/sample5.aspx)]

<span data-ttu-id="f3d86-221">この 1 つの s を以前 ObjectDataSources と同様`OldValuesParameterFormatString`プロパティに設定されて`original_{0}`s の製品名または単位あたりの数量を更新する際に問題が発生します。</span><span class="sxs-lookup"><span data-stu-id="f3d86-221">As with our previous ObjectDataSources, this one s `OldValuesParameterFormatString` property is set to `original_{0}`, which will cause problems when attempting to update a product s name or quantity per unit.</span></span> <span data-ttu-id="f3d86-222">宣言型構文からこのプロパティを完全に削除またはその既定値に設定`{0}`します。</span><span class="sxs-lookup"><span data-stu-id="f3d86-222">Remove this property from the declarative syntax altogether or set it to its default, `{0}`.</span></span>

<span data-ttu-id="f3d86-223">この構成が完了、弊社のページに表示されます、GridView で選択されている業者によって提供される製品 (図 13 を参照してください)。</span><span class="sxs-lookup"><span data-stu-id="f3d86-223">With this configuration complete, our page now lists the products provided by the supplier selected in the GridView (see Figure 13).</span></span> <span data-ttu-id="f3d86-224">現在*任意*s の製品名または単位あたりの数量を更新することができます。</span><span class="sxs-lookup"><span data-stu-id="f3d86-224">Currently *any* product s name or quantity per unit can be updated.</span></span> <span data-ttu-id="f3d86-225">ただし、このような機能が廃止された製品の特定のサプライヤーに関連付けられているユーザーの禁止されているように、ページ ロジックを更新する必要があります。</span><span class="sxs-lookup"><span data-stu-id="f3d86-225">However, we need to update our page logic so that such functionality is prohibited for discontinued products for users associated with a particular supplier.</span></span> <span data-ttu-id="f3d86-226">この最後の部分では、手順 5 に取り組むします。</span><span class="sxs-lookup"><span data-stu-id="f3d86-226">We'll tackle this final piece in Step 5.</span></span>

<span data-ttu-id="f3d86-227">[![選択されている業者によって提供される製品が表示されます。](limiting-data-modification-functionality-based-on-the-user-cs/_static/image38.png)](limiting-data-modification-functionality-based-on-the-user-cs/_static/image37.png)</span><span class="sxs-lookup"><span data-stu-id="f3d86-227">[![The Products Provided by the Selected Supplier are Displayed](limiting-data-modification-functionality-based-on-the-user-cs/_static/image38.png)](limiting-data-modification-functionality-based-on-the-user-cs/_static/image37.png)</span></span>

<span data-ttu-id="f3d86-228">**図 13**:選択されている業者によって提供される製品が表示されます ([フルサイズの画像を表示する をクリックします](limiting-data-modification-functionality-based-on-the-user-cs/_static/image39.png))。</span><span class="sxs-lookup"><span data-stu-id="f3d86-228">**Figure 13**: The Products Provided by the Selected Supplier are Displayed ([Click to view full-size image](limiting-data-modification-functionality-based-on-the-user-cs/_static/image39.png))</span></span>

> [!NOTE]
> <span data-ttu-id="f3d86-229">編集可能なこの GridView を追加すると、 `Suppliers` DropDownList の`SelectedIndexChanged`イベント ハンドラーを更新して、GridView を読み取り専用状態に戻す必要があります。</span><span class="sxs-lookup"><span data-stu-id="f3d86-229">With the addition of this editable GridView the `Suppliers` DropDownList s `SelectedIndexChanged` event handler should be updated to return the GridView to a read-only state.</span></span> <span data-ttu-id="f3d86-230">それ以外の場合、異なる供給業者は製品情報の編集中に選択されている場合、その新しい業者の GridView の対応するインデックスも編集できます。</span><span class="sxs-lookup"><span data-stu-id="f3d86-230">Otherwise, if a different supplier is selected while in the middle of editing product information, the corresponding index in the GridView for the new supplier will also be editable.</span></span> <span data-ttu-id="f3d86-231">これを防ぐためには、GridView s を設定するだけ`EditIndex`プロパティを`-1`で、`SelectedIndexChanged`イベント ハンドラー。</span><span class="sxs-lookup"><span data-stu-id="f3d86-231">To prevent this, simply set the GridView s `EditIndex` property to `-1` in the `SelectedIndexChanged` event handler.</span></span>

<span data-ttu-id="f3d86-232">また、s のビュー ステートが GridView に (既定の動作) が有効になっている必要があることを思い出してください。</span><span class="sxs-lookup"><span data-stu-id="f3d86-232">Also, recall that it is important that the GridView s view state be enabled (the default behavior).</span></span> <span data-ttu-id="f3d86-233">GridView 秒に設定した場合`EnableViewState`プロパティを`false`、同時実行ユーザーが誤って削除または編集を記録するというリスクを実行します。</span><span class="sxs-lookup"><span data-stu-id="f3d86-233">If you set the GridView s `EnableViewState` property to `false`, you run the risk of having concurrent users unintentionally deleting or editing records.</span></span> <span data-ttu-id="f3d86-234">参照してください[警告。同時実行を発行するサポートの編集を ASP.NET 2.0 Gridview と DetailsView/FormViews や削除、およびをビュー ステートが無効になっている](http://scottonwriting.net/sowblog/posts/10054.aspx)詳細についてはします。</span><span class="sxs-lookup"><span data-stu-id="f3d86-234">See [WARNING: Concurrency Issue with ASP.NET 2.0 GridViews/DetailsView/FormViews that Support Editing and/or Deleting and Whose View State is Disabled](http://scottonwriting.net/sowblog/posts/10054.aspx) for more information.</span></span>

## <a name="step-5-disallow-editing-for-discontinued-products-when-showedit-all-suppliers-is-not-selected"></a><span data-ttu-id="f3d86-235">手順 5: 廃止された製品ときに表示/編集すべて仕入先が選択されていない編集を禁止します。</span><span class="sxs-lookup"><span data-stu-id="f3d86-235">Step 5: Disallow Editing for Discontinued Products When Show/Edit ALL Suppliers is Not Selected</span></span>

<span data-ttu-id="f3d86-236">中に、 `ProductsBySupplier` GridView は、完全に機能は、現在アクセスを許可が多すぎるの特定のサプライヤーから供給はこれらのユーザーにします。</span><span class="sxs-lookup"><span data-stu-id="f3d86-236">While the `ProductsBySupplier` GridView is fully functional, it currently grants too much access to those users who are from a particular supplier.</span></span> <span data-ttu-id="f3d86-237">当社のビジネス ルールごと、そのようなユーザーは必要があります提供が中止された製品を更新できません。</span><span class="sxs-lookup"><span data-stu-id="f3d86-237">Per our business rules, such users should not be able to update discontinued products.</span></span> <span data-ttu-id="f3d86-238">を適用するには、非ことができます (を無効にする) の提供が中止された製品、業者からのユーザーが、ページが参照されているときに、GridView の行の編集 ボタン。</span><span class="sxs-lookup"><span data-stu-id="f3d86-238">To enforce this, we can hide (or disable) the Edit button in those GridView rows with discontinued products when the page is being visited by a user from a supplier.</span></span>

<span data-ttu-id="f3d86-239">GridView s のイベント ハンドラーを作成`RowDataBound`イベント。</span><span class="sxs-lookup"><span data-stu-id="f3d86-239">Create an event handler for the GridView s `RowDataBound` event.</span></span> <span data-ttu-id="f3d86-240">このイベント ハンドラーで、ユーザーがこのチュートリアルでは、サプライヤーの DropDownList s をチェックして決定できますが、特定のサプライヤーと関連付けられているかどうかを判断する`SelectedValue`プロパティの場合、s が-1 で、そのユーザーよりもその他のものが特定のサプライヤーに関連付けられました。</span><span class="sxs-lookup"><span data-stu-id="f3d86-240">In this event handler we need to determine whether or not the user is associated with a particular supplier, which, for this tutorial, can be determined by checking the Suppliers DropDownList s `SelectedValue` property - if it s something other than -1, then the user is associated with a particular supplier.</span></span> <span data-ttu-id="f3d86-241">このようなユーザーの場合、製品が提供が中止されたかどうかを判断する必要があります。</span><span class="sxs-lookup"><span data-stu-id="f3d86-241">For such users, we then need to determine whether or not the product is discontinued.</span></span> <span data-ttu-id="f3d86-242">実際への参照を取得できます`ProductRow`インスタンスを使用して GridView の行にバインドされる、`e.Row.DataItem`で説明したように、プロパティ、 [ *GridView のフッターに概要情報を表示する*](../custom-formatting/displaying-summary-information-in-the-gridview-s-footer-cs.md)チュートリアルです。</span><span class="sxs-lookup"><span data-stu-id="f3d86-242">We can grab a reference to the actual `ProductRow` instance bound to the GridView row via the `e.Row.DataItem` property, as discussed in the [*Displaying Summary Information in the GridView s Footer*](../custom-formatting/displaying-summary-information-in-the-gridview-s-footer-cs.md) tutorial.</span></span> <span data-ttu-id="f3d86-243">GridView s、前のチュートリアルで説明した手法を使用して [commandfield] で [編集] ボタンをプログラムによって参照を取得できます、製品が提供が中止された場合[*を追加するクライアント側の確認と削除*](adding-client-side-confirmation-when-deleting-cs.md).</span><span class="sxs-lookup"><span data-stu-id="f3d86-243">If the product is discontinued, we can grab a programmatic reference to the Edit button in the GridView s CommandField using the techniques discussed in the previous tutorial, [*Adding Client-Side Confirmation When Deleting*](adding-client-side-confirmation-when-deleting-cs.md).</span></span> <span data-ttu-id="f3d86-244">行ってから参照し、非表示にまたは、ボタンを無効にできます。</span><span class="sxs-lookup"><span data-stu-id="f3d86-244">Once we have a reference we can then hide or disable the button.</span></span>

[!code-csharp[Main](limiting-data-modification-functionality-based-on-the-user-cs/samples/sample6.cs)]

<span data-ttu-id="f3d86-245">このイベントにハンドラーが配置では、このページにアクセスをユーザーとして特定のサプライヤーからは提供が中止されたこれらの製品は、編集していないときに [編集] ボタンとしては表示されませんこれらの製品。</span><span class="sxs-lookup"><span data-stu-id="f3d86-245">With this event handler in place, when visiting this page as a user from a specific supplier those products that are discontinued are not editable, as the Edit button is hidden for these products.</span></span> <span data-ttu-id="f3d86-246">たとえば、Chef Anton の Gumbo ミックスでは、ニューオーリンズ Cajun Delights 業者の提供が中止された製品です。</span><span class="sxs-lookup"><span data-stu-id="f3d86-246">For example, Chef Anton s Gumbo Mix is a discontinued product for the New Orleans Cajun Delights supplier.</span></span> <span data-ttu-id="f3d86-247">この特定の仕入先のページにアクセスと、見えないようにからこの製品の編集 ボタンが非表示に (図 14 を参照してください)。</span><span class="sxs-lookup"><span data-stu-id="f3d86-247">When visiting the page for this particular supplier, the Edit button for this product is hidden from sight (see Figure 14).</span></span> <span data-ttu-id="f3d86-248">ただし、"表示/編集すべて Suppliers"を使用してアクセスして、[編集] ボタンは使用できます (図 15 参照) です。</span><span class="sxs-lookup"><span data-stu-id="f3d86-248">However, when visiting using the "Show/Edit ALL Suppliers," the Edit button is available (see Figure 15).</span></span>

<span data-ttu-id="f3d86-249">[![供給業者に固有のユーザーの Chef Anton の Gumbo ミックスの編集 ボタンが非表示します。](limiting-data-modification-functionality-based-on-the-user-cs/_static/image41.png)](limiting-data-modification-functionality-based-on-the-user-cs/_static/image40.png)</span><span class="sxs-lookup"><span data-stu-id="f3d86-249">[![For Supplier-Specific Users the Edit Button for Chef Anton s Gumbo Mix is Hidden](limiting-data-modification-functionality-based-on-the-user-cs/_static/image41.png)](limiting-data-modification-functionality-based-on-the-user-cs/_static/image40.png)</span></span>

<span data-ttu-id="f3d86-250">**図 14**:Chef Anton の Gumbo ミックスの編集 ボタンが非表示のサプライヤーに固有のユーザー ([フルサイズの画像を表示する をクリックします](limiting-data-modification-functionality-based-on-the-user-cs/_static/image42.png))。</span><span class="sxs-lookup"><span data-stu-id="f3d86-250">**Figure 14**: For Supplier-Specific Users the Edit Button for Chef Anton s Gumbo Mix is Hidden ([Click to view full-size image](limiting-data-modification-functionality-based-on-the-user-cs/_static/image42.png))</span></span>

<span data-ttu-id="f3d86-251">[![仕入先ユーザーをすべて表示/編集、Chef Anton の Gumbo ミックスの編集 ボタンが表示されます。](limiting-data-modification-functionality-based-on-the-user-cs/_static/image44.png)](limiting-data-modification-functionality-based-on-the-user-cs/_static/image43.png)</span><span class="sxs-lookup"><span data-stu-id="f3d86-251">[![For Show/Edit ALL Suppliers Users, the Edit Button for Chef Anton s Gumbo Mix is Displayed](limiting-data-modification-functionality-based-on-the-user-cs/_static/image44.png)](limiting-data-modification-functionality-based-on-the-user-cs/_static/image43.png)</span></span>

<span data-ttu-id="f3d86-252">**図 15**:仕入先ユーザーをすべて表示/編集、Chef Anton の Gumbo ミックスの編集 ボタンが表示されます ([フルサイズの画像を表示する をクリックします](limiting-data-modification-functionality-based-on-the-user-cs/_static/image45.png))。</span><span class="sxs-lookup"><span data-stu-id="f3d86-252">**Figure 15**: For Show/Edit ALL Suppliers Users, the Edit Button for Chef Anton s Gumbo Mix is Displayed ([Click to view full-size image](limiting-data-modification-functionality-based-on-the-user-cs/_static/image45.png))</span></span>

## <a name="checking-for-access-rights-in-the-business-logic-layer"></a><span data-ttu-id="f3d86-253">ビジネス ロジック層でのアクセス権の確認</span><span class="sxs-lookup"><span data-stu-id="f3d86-253">Checking for Access Rights in the Business Logic Layer</span></span>

<span data-ttu-id="f3d86-254">このチュートリアルは、ASP.NET ではページはどのような情報が表示に関してすべてのロジックを処理し、更新はどのような製品です。</span><span class="sxs-lookup"><span data-stu-id="f3d86-254">In this tutorial the ASP.NET page handles all logic with regards to what information the user can see and what products he can update.</span></span> <span data-ttu-id="f3d86-255">理想的には、このロジックもビジネス ロジック層に存在できます。</span><span class="sxs-lookup"><span data-stu-id="f3d86-255">Ideally, this logic would also be present at the Business Logic Layer.</span></span> <span data-ttu-id="f3d86-256">たとえば、`SuppliersBLL`クラス s `GetSuppliers()` (すべての仕入先を返す) メソッドには、現在ログオンしているユーザーがあることを確認するチェックが含まれます*いない*特定のサプライヤーに関連付けられています。</span><span class="sxs-lookup"><span data-stu-id="f3d86-256">For example, the `SuppliersBLL` class s `GetSuppliers()` method (which returns all suppliers) might include a check to ensure that the currently logged on user is *not* associated with a specific supplier.</span></span> <span data-ttu-id="f3d86-257">同様に、`UpdateSupplierAddress`メソッドは、現在ログオンしているユーザーのいずれか、会社の作業 (および仕入先のすべてのアドレス情報を更新できます) のチェックを含めることができますか、更新されるデータが供給業者に関連付けられています。</span><span class="sxs-lookup"><span data-stu-id="f3d86-257">Likewise, the `UpdateSupplierAddress` method could include a check to ensure that the currently logged on user either worked for our company (and therefore can update all suppliers address information) or is associated with the supplier whose data is being updated.</span></span>

<span data-ttu-id="f3d86-258">BLL レイヤーそのようなチェックをここでは、DropDownList BLL クラスにアクセスできません ページで、チュートリアルでは、ユーザーの権限が決定されるためは含まれませんでした。</span><span class="sxs-lookup"><span data-stu-id="f3d86-258">I did not include such BLL-layer checks here because in our tutorial the user s rights are determined by a DropDownList on the page, which the BLL classes cannot access.</span></span> <span data-ttu-id="f3d86-259">メンバーシップ システム、または (Windows 認証の場合) など、ASP.NET によって提供される出力の既定の認証方式のいずれかを使用して現在ログインしているユーザーのロール情報と情報を BLL は、このようなアクセスをそれによってからアクセスできますプレゼンテーションと BLL レイヤーの両方で可能な権限を確認します。</span><span class="sxs-lookup"><span data-stu-id="f3d86-259">When using the membership system or one of the out-of-the box authentication schemes provided by ASP.NET (such as Windows authentication), the currently logged on user s information and roles information can be accessed from the BLL, thereby making such access rights checks possible at both the presentation and BLL layers.</span></span>

## <a name="summary"></a><span data-ttu-id="f3d86-260">まとめ</span><span class="sxs-lookup"><span data-stu-id="f3d86-260">Summary</span></span>

<span data-ttu-id="f3d86-261">ユーザー アカウントを提供するほとんどのサイトでは、ログインしているユーザーに基づいて、データ変更インターフェイスをカスタマイズする必要があります。</span><span class="sxs-lookup"><span data-stu-id="f3d86-261">Most sites that provide user accounts need to customize the data modification interface based upon the logged in user.</span></span> <span data-ttu-id="f3d86-262">管理ユーザーは、管理者以外のユーザーのみを更新または自分で作成したレコードを削除するのにもありますが、削除、および任意のレコードを編集することがあります。</span><span class="sxs-lookup"><span data-stu-id="f3d86-262">Administrative users may be able to delete and edit any record, whereas non-administrative users may be limited to only updating or deleting records they created themselves.</span></span> <span data-ttu-id="f3d86-263">どのようなシナリオ、データ Web コントロールと ObjectDataSource、し、拒否、ログオン ユーザーに基づく特定の機能を追加するビジネス ロジック層のクラスを拡張することができます。</span><span class="sxs-lookup"><span data-stu-id="f3d86-263">Whatever the scenario may be, the data Web controls, ObjectDataSource, and Business Logic Layer classes can be extended to add or deny certain functionality based on the logged on user.</span></span> <span data-ttu-id="f3d86-264">このチュートリアルでは、ユーザーが特定のサプライヤーに関連付けられていたかどうかや、企業の協力してかどうかに応じて表示して編集可能なデータを制限する方法を説明しました。</span><span class="sxs-lookup"><span data-stu-id="f3d86-264">In this tutorial we saw how to limit the viewable and editable data depending on whether the user was associated with a particular supplier or if they worked for our company.</span></span>

<span data-ttu-id="f3d86-265">このチュートリアルでは、挿入、更新、および GridView、DetailsView、FormView コントロールを使用してデータを削除するマイクロソフトの調査で終了します。</span><span class="sxs-lookup"><span data-stu-id="f3d86-265">This tutorial concludes our examination of inserting, updating, and deleting data using the GridView, DetailsView, and FormView controls.</span></span> <span data-ttu-id="f3d86-266">以降、次のチュートリアルでは、ページングと並べ替えのサポートを追加することに注目有効にします。</span><span class="sxs-lookup"><span data-stu-id="f3d86-266">Starting with the next tutorial, we'll turn our attention to adding paging and sorting support.</span></span>

<span data-ttu-id="f3d86-267">満足のプログラミングです。</span><span class="sxs-lookup"><span data-stu-id="f3d86-267">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="f3d86-268">執筆者紹介</span><span class="sxs-lookup"><span data-stu-id="f3d86-268">About the Author</span></span>

<span data-ttu-id="f3d86-269">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml)、7 つ受け取りますブックおよびの創設者の著者[4GuysFromRolla.com](http://www.4guysfromrolla.com)、Microsoft Web テクノロジと 1998 年から携わっています。</span><span class="sxs-lookup"><span data-stu-id="f3d86-269">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="f3d86-270">Scott は、フリーのコンサルタント、トレーナー、およびライターとして動作します。</span><span class="sxs-lookup"><span data-stu-id="f3d86-270">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="f3d86-271">最新の著書は[ *Sams 教える自分で ASP.NET 2.0 24 時間以内に*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)します。</span><span class="sxs-lookup"><span data-stu-id="f3d86-271">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="f3d86-272">彼に到達できる[mitchell@4GuysFromRolla.comします。](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="f3d86-272">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="f3d86-273">彼のブログにあるでまたは[ http://ScottOnWriting.NET](http://ScottOnWriting.NET)します。</span><span class="sxs-lookup"><span data-stu-id="f3d86-273">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="f3d86-274">[前へ](adding-client-side-confirmation-when-deleting-cs.md)
> [次へ](an-overview-of-inserting-updating-and-deleting-data-vb.md)</span><span class="sxs-lookup"><span data-stu-id="f3d86-274">[Previous](adding-client-side-confirmation-when-deleting-cs.md)
[Next](an-overview-of-inserting-updating-and-deleting-data-vb.md)</span></span>

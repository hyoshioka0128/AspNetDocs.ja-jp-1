---
uid: web-forms/overview/data-access/editing-inserting-and-deleting-data/adding-client-side-confirmation-when-deleting-vb
title: 削除時にクライアント側の確認を追加する (VB) |Microsoft Docs
author: rick-anderson
description: これまでに作成したインターフェイスでは、ユーザーは [編集] ボタンをクリックしたときに [削除] ボタンをクリックしてデータを誤って削除できます。 この t...
ms.author: riande
ms.date: 07/17/2006
ms.assetid: 6331e02e-c465-4cdf-bd3f-f07680c289d6
msc.legacyurl: /web-forms/overview/data-access/editing-inserting-and-deleting-data/adding-client-side-confirmation-when-deleting-vb
msc.type: authoredcontent
ms.openlocfilehash: addb5a1fdc5793309388c5f06b44fb3b145bc102
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 03/06/2020
ms.locfileid: "78494596"
---
# <a name="adding-client-side-confirmation-when-deleting-vb"></a><span data-ttu-id="26074-104">削除時、クライアント側の確認を追加する (VB)</span><span class="sxs-lookup"><span data-stu-id="26074-104">Adding Client-Side Confirmation When Deleting (VB)</span></span>

<span data-ttu-id="26074-105">[Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="26074-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="26074-106">[サンプルアプリのダウンロード](https://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_22_VB.exe)または[PDF のダウンロード](adding-client-side-confirmation-when-deleting-vb/_static/datatutorial22vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="26074-106">[Download Sample App](https://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_22_VB.exe) or [Download PDF](adding-client-side-confirmation-when-deleting-vb/_static/datatutorial22vb1.pdf)</span></span>

> <span data-ttu-id="26074-107">これまでに作成したインターフェイスでは、ユーザーは [編集] ボタンをクリックしたときに [削除] ボタンをクリックしてデータを誤って削除できます。</span><span class="sxs-lookup"><span data-stu-id="26074-107">In the interfaces we've created so far, a user can accidentally delete data by clicking the Delete button when they meant to click the Edit button.</span></span> <span data-ttu-id="26074-108">このチュートリアルでは、[削除] ボタンをクリックしたときに表示されるクライアント側の確認ダイアログボックスを追加します。</span><span class="sxs-lookup"><span data-stu-id="26074-108">In this tutorial we'll add a client-side confirmation dialog box that appears when the Delete button is clicked.</span></span>

## <a name="introduction"></a><span data-ttu-id="26074-109">はじめに</span><span class="sxs-lookup"><span data-stu-id="26074-109">Introduction</span></span>

<span data-ttu-id="26074-110">これまでのいくつかのチュートリアルでは、アプリケーションアーキテクチャ、ObjectDataSource、およびデータ Web コントロールを連携して使用して、挿入、編集、および削除の機能を提供する方法を説明しました。</span><span class="sxs-lookup"><span data-stu-id="26074-110">Over the past several tutorials we ve seen how to use our application architecture, ObjectDataSource, and the data Web controls in concert to provide inserting, editing, and deleting capabilities.</span></span> <span data-ttu-id="26074-111">これまでに調査した削除インターフェイスは、[削除] ボタンで構成されています。このボタンをクリックすると、ポストバックが発生し、ObjectDataSource s `Delete()` メソッドが呼び出されます。</span><span class="sxs-lookup"><span data-stu-id="26074-111">The deleting interfaces we ve examined thus far have been composed of a Delete button that, when clicked, causes a postback and invokes the ObjectDataSource s `Delete()` method.</span></span> <span data-ttu-id="26074-112">`Delete()` メソッドは、ビジネスロジック層から構成されたメソッドを呼び出します。これにより、呼び出しがデータアクセス層に反映され、実際の `DELETE` ステートメントがデータベースに発行されます。</span><span class="sxs-lookup"><span data-stu-id="26074-112">The `Delete()` method then invokes the configured method from the Business Logic Layer, which propagates the call down to the Data Access Layer, issuing the actual `DELETE` statement to the database.</span></span>

<span data-ttu-id="26074-113">このユーザーインターフェイスを使用すると、ユーザーが GridView、DetailsView、または FormView コントロールを使用してレコードを削除できますが、ユーザーが [削除] ボタンをクリックしても、どのような種類の確認も行われません。</span><span class="sxs-lookup"><span data-stu-id="26074-113">While this user interface enables visitors to delete records through the GridView, DetailsView, or FormView controls, it lacks any sort of confirmation when the user clicks the Delete button.</span></span> <span data-ttu-id="26074-114">[編集] をクリックしたときにユーザーが誤って [削除] ボタンをクリックした場合、更新する予定のレコードは削除されます。</span><span class="sxs-lookup"><span data-stu-id="26074-114">If a user accidentally clicks the Delete button when they meant to click Edit, the record they meant to update will instead be deleted.</span></span> <span data-ttu-id="26074-115">この問題を回避するために、このチュートリアルでは、[削除] ボタンをクリックしたときに表示されるクライアント側の確認ダイアログボックスを追加します。</span><span class="sxs-lookup"><span data-stu-id="26074-115">To help prevent this, in this tutorial we'll add a client-side confirmation dialog box that appears when the Delete button is clicked.</span></span>

<span data-ttu-id="26074-116">JavaScript `confirm(string)` 関数は、[OK] と [キャンセル] の2つのボタンを備えたモーダルダイアログボックス内のテキストとして、文字列入力パラメーターを表示します (図1を参照)。</span><span class="sxs-lookup"><span data-stu-id="26074-116">The JavaScript `confirm(string)` function displays its string input parameter as the text inside a modal dialog box that comes equipped with two buttons - OK and Cancel (see Figure 1).</span></span> <span data-ttu-id="26074-117">`confirm(string)` 関数は、どのボタンがクリックされたかに応じてブール値を返します (ユーザーが [OK] をクリックした場合は`true`、[キャンセル] をクリックした場合は `false` ます)。</span><span class="sxs-lookup"><span data-stu-id="26074-117">The `confirm(string)` function returns a Boolean value depending on what button is clicked (`true`, if the user clicks OK, and `false` if they click Cancel).</span></span>

![JavaScript confirm (string) メソッドによって、モーダルのクライアント側のメッセージボックスが表示されます。](adding-client-side-confirmation-when-deleting-vb/_static/image1.png)

<span data-ttu-id="26074-119">**図 1**: JavaScript `confirm(string)` メソッドによってモーダルのクライアント側のメッセージボックスが表示される</span><span class="sxs-lookup"><span data-stu-id="26074-119">**Figure 1**: The JavaScript `confirm(string)` Method Displays a Modal, Client-Side Messagebox</span></span>

<span data-ttu-id="26074-120">フォームの送信時に、クライアント側のイベントハンドラーから `false` の値が返された場合、フォームの送信は取り消されます。</span><span class="sxs-lookup"><span data-stu-id="26074-120">During a form submission, if a value of `false` is returned from a client-side event handler then the form submission is cancelled.</span></span> <span data-ttu-id="26074-121">この機能を使用すると、クライアント側の削除ボタン `onclick` イベントハンドラーが `confirm("Are you sure you want to delete this product?")`の呼び出しの値を返すことができます。</span><span class="sxs-lookup"><span data-stu-id="26074-121">Using this feature, we can have the Delete button s client-side `onclick` event handler return the value of a call to `confirm("Are you sure you want to delete this product?")`.</span></span> <span data-ttu-id="26074-122">ユーザーが [キャンセル] をクリックすると、`confirm(string)` は false を返し、フォーム送信をキャンセルします。</span><span class="sxs-lookup"><span data-stu-id="26074-122">If the user clicks Cancel, `confirm(string)` will return false, thereby causing the form submission to cancel.</span></span> <span data-ttu-id="26074-123">ポストバックがない場合、[削除] ボタンがクリックされた製品は削除されません。</span><span class="sxs-lookup"><span data-stu-id="26074-123">With no postback, the product whose Delete button was clicked won't be deleted.</span></span> <span data-ttu-id="26074-124">ただし、ユーザーが確認ダイアログボックスで [OK] をクリックすると、ポストバックは伴っを続行し、製品は削除されます。</span><span class="sxs-lookup"><span data-stu-id="26074-124">If, however, the user clicks OK in the confirmation dialog box, the postback will continue unabated and the product will be deleted.</span></span> <span data-ttu-id="26074-125">この手法の詳細については、 [「JavaScript s `confirm()` メソッドを使用してフォームの送信を制御する](http://www.webreference.com/programming/javascript/confirm/)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="26074-125">Consult [Using JavaScript s `confirm()` Method to Control Form Submission](http://www.webreference.com/programming/javascript/confirm/) for more information on this technique.</span></span>

<span data-ttu-id="26074-126">CommandField を使用する場合とは異なり、テンプレートを使用すると、必要なクライアント側スクリプトを追加することが若干異なります。</span><span class="sxs-lookup"><span data-stu-id="26074-126">Adding the necessary client-side script differs slightly if using templates than when using a CommandField.</span></span> <span data-ttu-id="26074-127">このチュートリアルでは、FormView と GridView の両方の例を見ていきます。</span><span class="sxs-lookup"><span data-stu-id="26074-127">Therefore, in this tutorial we will look at both a FormView and GridView example.</span></span>

> [!NOTE]
> <span data-ttu-id="26074-128">このチュートリアルで説明するように、クライアント側の確認方法を使用すると、ユーザーが JavaScript をサポートするブラウザーを使用してアクセスし、JavaScript が有効になっていることを前提としています。</span><span class="sxs-lookup"><span data-stu-id="26074-128">Using client-side confirmation techniques, like the ones discussed in this tutorial, assumes that your users are visiting with browsers that support JavaScript and that they have JavaScript enabled.</span></span> <span data-ttu-id="26074-129">これらの前提条件のいずれかが特定のユーザーに対して true でない場合、[削除] ボタンをクリックすると直ちにポストバックが発生します (確認メッセージボックスは表示されません)。</span><span class="sxs-lookup"><span data-stu-id="26074-129">If either of these assumptions are not true for a particular user, clicking the Delete button will immediately cause a postback (not displaying a confirm messagebox).</span></span>

## <a name="step-1-creating-a-formview-that-supports-deletion"></a><span data-ttu-id="26074-130">手順 1: 削除をサポートする FormView の作成</span><span class="sxs-lookup"><span data-stu-id="26074-130">Step 1: Creating a FormView That Supports Deletion</span></span>

<span data-ttu-id="26074-131">まず、FormView を `EditInsertDelete` フォルダー内の `ConfirmationOnDelete.aspx` ページに追加し、`ProductsBLL` クラス s `GetProducts()` メソッドを使用して製品情報を取得する新しい ObjectDataSource にバインドします。</span><span class="sxs-lookup"><span data-stu-id="26074-131">Start by adding a FormView to the `ConfirmationOnDelete.aspx` page in the `EditInsertDelete` folder, binding it to a new ObjectDataSource that pulls back the product information via the `ProductsBLL` class s `GetProducts()` method.</span></span> <span data-ttu-id="26074-132">また、ObjectDataSource を構成して `ProductsBLL` クラス s `DeleteProduct(productID)` メソッドが ObjectDataSource s `Delete()` メソッドにマップされるようにします。[挿入] タブと [更新] タブのドロップダウンリストが [(なし)] に設定されていることを確認します。</span><span class="sxs-lookup"><span data-stu-id="26074-132">Also configure the ObjectDataSource so that the `ProductsBLL` class s `DeleteProduct(productID)` method is mapped to the ObjectDataSource s `Delete()` method; ensure that the INSERT and UPDATE tabs drop-down lists are set to (None).</span></span> <span data-ttu-id="26074-133">最後に、FormView s スマートタグの [ページングを有効にする] チェックボックスをオンにします。</span><span class="sxs-lookup"><span data-stu-id="26074-133">Finally, check the Enable Paging checkbox in the FormView s smart tag.</span></span>

<span data-ttu-id="26074-134">これらの手順の後に、新しい ObjectDataSource s 宣言マークアップは次のようになります。</span><span class="sxs-lookup"><span data-stu-id="26074-134">After these steps, the new ObjectDataSource s declarative markup will look like the following:</span></span>

[!code-aspx[Main](adding-client-side-confirmation-when-deleting-vb/samples/sample1.aspx)]

<span data-ttu-id="26074-135">オプティミスティック同時実行制御を使用しなかった前の例と同様に、ObjectDataSource s `OldValuesParameterFormatString` プロパティを消去してみましょう。</span><span class="sxs-lookup"><span data-stu-id="26074-135">As in our past examples that did not use optimistic concurrency, take a moment to clear out the ObjectDataSource s `OldValuesParameterFormatString` property.</span></span>

<span data-ttu-id="26074-136">削除のみをサポートする ObjectDataSource コントロールにバインドされているため、FormView s `ItemTemplate` は [削除] ボタンのみを提供します。 [新規] ボタンと [更新] ボタンはありません。</span><span class="sxs-lookup"><span data-stu-id="26074-136">Since it has been bound to an ObjectDataSource control that only supports deleting, the FormView s `ItemTemplate` offers only the Delete button, lacking the New and Update buttons.</span></span> <span data-ttu-id="26074-137">ただし、FormView の宣言型マークアップには、不要な `EditItemTemplate` と `InsertItemTemplate`が含まれています。これは削除できます。</span><span class="sxs-lookup"><span data-stu-id="26074-137">The FormView s declarative markup, however, includes a superfluous `EditItemTemplate` and `InsertItemTemplate`, which can be removed.</span></span> <span data-ttu-id="26074-138">製品データフィールドのサブセットのみが表示されるように、`ItemTemplate` をカスタマイズしてみてください。</span><span class="sxs-lookup"><span data-stu-id="26074-138">Take a moment to customize the `ItemTemplate` so that is shows only a subset of the product data fields.</span></span> <span data-ttu-id="26074-139">ここでは、仕入先名とカテゴリ名の上に `<h3>` 見出しの製品名を表示するように構成しました ([削除] ボタンをクリックします)。</span><span class="sxs-lookup"><span data-stu-id="26074-139">I ve configured mine to show the product s name in an `<h3>` heading above its supplier and category names (along with the Delete button).</span></span>

[!code-aspx[Main](adding-client-side-confirmation-when-deleting-vb/samples/sample2.aspx)]

<span data-ttu-id="26074-140">これらの変更により、完全に機能する web ページが用意されています。ユーザーは、[削除] ボタンをクリックするだけで製品を削除することができます。</span><span class="sxs-lookup"><span data-stu-id="26074-140">With these changes, we have a fully functional web page that allows a user to toggle through the products one at a time, with the ability to delete a product by simply clicking the Delete button.</span></span> <span data-ttu-id="26074-141">図2は、ブラウザーを通じて表示されるときの、これまでの進行状況のスクリーンショットを示しています。</span><span class="sxs-lookup"><span data-stu-id="26074-141">Figure 2 shows a screen shot of our progress thus far when viewed through a browser.</span></span>

<span data-ttu-id="26074-142">[FormView に1つの製品に関する情報が表示される ![](adding-client-side-confirmation-when-deleting-vb/_static/image3.png)](adding-client-side-confirmation-when-deleting-vb/_static/image2.png)</span><span class="sxs-lookup"><span data-stu-id="26074-142">[![The FormView Shows Information About a Single Product](adding-client-side-confirmation-when-deleting-vb/_static/image3.png)](adding-client-side-confirmation-when-deleting-vb/_static/image2.png)</span></span>

<span data-ttu-id="26074-143">**図 2**: FormView に1つの製品に関する情報が表示される ([クリックすると、フルサイズの画像が表示](adding-client-side-confirmation-when-deleting-vb/_static/image4.png)されます)</span><span class="sxs-lookup"><span data-stu-id="26074-143">**Figure 2**: The FormView Shows Information About a Single Product ([Click to view full-size image](adding-client-side-confirmation-when-deleting-vb/_static/image4.png))</span></span>

## <a name="step-2-calling-the-confirmstring-function-from-the-delete-buttons-client-side-onclick-event"></a><span data-ttu-id="26074-144">手順 2: [削除] ボタンのクライアント側の onclick イベントから confirm (string) 関数を呼び出す</span><span class="sxs-lookup"><span data-stu-id="26074-144">Step 2: Calling the confirm(string) Function from the Delete Buttons Client-Side onclick Event</span></span>

<span data-ttu-id="26074-145">FormView が作成されたら、最後の手順として、ビジターがクリックしたときに JavaScript `confirm(string)` 関数が呼び出されるように [削除] ボタンを構成します。</span><span class="sxs-lookup"><span data-stu-id="26074-145">With the FormView created, the final step is to configure the Delete button such that when it s clicked by the visitor, the JavaScript `confirm(string)` function is invoked.</span></span> <span data-ttu-id="26074-146">クライアント側のスクリプトをボタン、LinkButton、または ImageButton s クライアント側の `onclick` イベントに追加するには、ASP.NET 2.0 の新しい `OnClientClick property`を使用します。</span><span class="sxs-lookup"><span data-stu-id="26074-146">Adding client-side script to a Button, LinkButton, or ImageButton s client-side `onclick` event can be accomplished through the use of the `OnClientClick property`, which is new to ASP.NET 2.0.</span></span> <span data-ttu-id="26074-147">返される `confirm(string)` 関数の値を取得する必要があるため、このプロパティを次のように設定します。 `return confirm('Are you certain that you want to delete this product?');`</span><span class="sxs-lookup"><span data-stu-id="26074-147">Since we want to have the value of the `confirm(string)` function returned, simply set this property to: `return confirm('Are you certain that you want to delete this product?');`</span></span>

<span data-ttu-id="26074-148">この変更後、Delete LinkButton の宣言構文は次のようになります。</span><span class="sxs-lookup"><span data-stu-id="26074-148">After this change the Delete LinkButton s declarative syntax should look something like:</span></span>

[!code-aspx[Main](adding-client-side-confirmation-when-deleting-vb/samples/sample3.aspx)]

<span data-ttu-id="26074-149">これで完了です。</span><span class="sxs-lookup"><span data-stu-id="26074-149">That s all there is to it!</span></span> <span data-ttu-id="26074-150">図3に、この確認の動作のスクリーンショットを示します。</span><span class="sxs-lookup"><span data-stu-id="26074-150">Figure 3 shows a screen shot of this confirmation in action.</span></span> <span data-ttu-id="26074-151">[削除] ボタンをクリックすると、[確認] ダイアログボックスが表示されます。</span><span class="sxs-lookup"><span data-stu-id="26074-151">Clicking the Delete button brings up the confirm dialog box.</span></span> <span data-ttu-id="26074-152">ユーザーが [キャンセル] をクリックすると、ポストバックはキャンセルされ、製品は削除されません。</span><span class="sxs-lookup"><span data-stu-id="26074-152">If the user clicks Cancel, the postback is cancelled and the product is not deleted.</span></span> <span data-ttu-id="26074-153">ただし、ユーザーが [OK] をクリックする `Delete()` と、ポストバックが続行され、するメソッドが呼び出され、削除されているデータベースレコードでます。</span><span class="sxs-lookup"><span data-stu-id="26074-153">If, however, the user clicks OK, the postback continues and the ObjectDataSource s `Delete()` method is invoked, culminating in the database record being deleted.</span></span>

> [!NOTE]
> <span data-ttu-id="26074-154">`confirm(string)` JavaScript 関数に渡される文字列は、引用符ではなくアポストロフィで区切られます。</span><span class="sxs-lookup"><span data-stu-id="26074-154">The string passed into the `confirm(string)` JavaScript function is delimited with apostrophes (rather than quotation marks).</span></span> <span data-ttu-id="26074-155">JavaScript では、いずれかの文字を使用して文字列を区切ることができます。</span><span class="sxs-lookup"><span data-stu-id="26074-155">In JavaScript, strings can be delimited using either character.</span></span> <span data-ttu-id="26074-156">ここではアポストロフィを使用して、`confirm(string)` に渡される文字列の区切り記号が、`OnClientClick` プロパティ値に使用される区切り記号とあいまいになることがないようにしています。</span><span class="sxs-lookup"><span data-stu-id="26074-156">We use apostrophes here so that the delimiters for the string passed into `confirm(string)` do not introduce an ambiguity with the delimiters used for the `OnClientClick` property value.</span></span>

<span data-ttu-id="26074-157">[![[削除] ボタンをクリックしたときに確認メッセージが表示されるようになりました。](adding-client-side-confirmation-when-deleting-vb/_static/image6.png)](adding-client-side-confirmation-when-deleting-vb/_static/image5.png)</span><span class="sxs-lookup"><span data-stu-id="26074-157">[![A Confirmation is Now Displayed When Clicking the Delete Button](adding-client-side-confirmation-when-deleting-vb/_static/image6.png)](adding-client-side-confirmation-when-deleting-vb/_static/image5.png)</span></span>

<span data-ttu-id="26074-158">**図 3**: [削除] ボタンをクリックしたときに確認が表示される ([クリックすると、フルサイズの画像が表示](adding-client-side-confirmation-when-deleting-vb/_static/image7.png)されます)</span><span class="sxs-lookup"><span data-stu-id="26074-158">**Figure 3**: A Confirmation is Now Displayed When Clicking the Delete Button ([Click to view full-size image](adding-client-side-confirmation-when-deleting-vb/_static/image7.png))</span></span>

## <a name="step-3-configuring-the-onclientclick-property-for-the-delete-button-in-a-commandfield"></a><span data-ttu-id="26074-159">手順 3: CommandField の Delete ボタンの OnClientClick プロパティを構成する</span><span class="sxs-lookup"><span data-stu-id="26074-159">Step 3: Configuring the OnClientClick Property for the Delete Button in a CommandField</span></span>

<span data-ttu-id="26074-160">テンプレート内で直接ボタン、LinkButton、または ImageButton を操作する場合、JavaScript `confirm(string)` 関数の結果を返すように `OnClientClick` プロパティを構成するだけで、確認ダイアログボックスを関連付けることができます。</span><span class="sxs-lookup"><span data-stu-id="26074-160">When working with a Button, LinkButton, or ImageButton directly in a template, a confirmation dialog box can be associated with it by simply configuring its `OnClientClick` property to return the results of the JavaScript `confirm(string)` function.</span></span> <span data-ttu-id="26074-161">ただし、[削除] ボタンのフィールドを GridView または DetailsView に追加する CommandField には、宣言によって設定できる `OnClientClick` のプロパティがありません。</span><span class="sxs-lookup"><span data-stu-id="26074-161">However, the CommandField - which adds a field of Delete buttons to a GridView or DetailsView - does not have an `OnClientClick` property that can be set declaratively.</span></span> <span data-ttu-id="26074-162">代わりに、GridView または DetailsView の適切な `DataBound` イベントハンドラーで [削除] ボタンを参照し、その `OnClientClick` プロパティをそこで設定する必要があります。</span><span class="sxs-lookup"><span data-stu-id="26074-162">Instead, we must programmatically reference the Delete button in the GridView or DetailsView s appropriate `DataBound` event handler, and then set its `OnClientClick` property there.</span></span>

> [!NOTE]
> <span data-ttu-id="26074-163">適切な `DataBound` イベントハンドラーで [削除] ボタン s `OnClientClick` プロパティを設定すると、現在のレコードにバインドされているデータにアクセスできるようになります。</span><span class="sxs-lookup"><span data-stu-id="26074-163">When setting the Delete button s `OnClientClick` property in the appropriate `DataBound` event handler, we have access to the data was bound to the current record.</span></span> <span data-ttu-id="26074-164">つまり、「」のように、特定のレコードに関する詳細情報を含むように、確認メッセージを拡張できます。たとえば、「Chai 製品を削除しますか?」と入力します。</span><span class="sxs-lookup"><span data-stu-id="26074-164">This means we can extend the confirmation message to include details about the particular record, such as, "Are you sure you want to delete the Chai product?"</span></span> <span data-ttu-id="26074-165">このようなカスタマイズは、データバインディング構文を使用するテンプレートでも可能です。</span><span class="sxs-lookup"><span data-stu-id="26074-165">Such customization is also possible in templates using databinding syntax.</span></span>

<span data-ttu-id="26074-166">CommandField の [削除] ボタンの `OnClientClick` プロパティを設定する方法については、「」で GridView をページに追加してみましょう。</span><span class="sxs-lookup"><span data-stu-id="26074-166">To practice setting the `OnClientClick` property for the Delete button(s) in a CommandField, let s add a GridView to the page.</span></span> <span data-ttu-id="26074-167">この GridView が、FormView が使用するのと同じ ObjectDataSource コントロールを使用するように構成します。</span><span class="sxs-lookup"><span data-stu-id="26074-167">Configure this GridView to use the same ObjectDataSource control that the FormView uses.</span></span> <span data-ttu-id="26074-168">また、GridView の BoundFields を、製品名、カテゴリ、および業者のみを含むように制限します。</span><span class="sxs-lookup"><span data-stu-id="26074-168">Also limit the GridView s BoundFields to only include the product s name, category, and supplier.</span></span> <span data-ttu-id="26074-169">最後に、GridView s スマートタグから [削除を有効にする] チェックボックスをオンにします。</span><span class="sxs-lookup"><span data-stu-id="26074-169">Lastly, check the Enable Deleting checkbox from the GridView s smart tag.</span></span> <span data-ttu-id="26074-170">これにより、`ShowDeleteButton` プロパティが `true`に設定された GridView s `Columns` コレクションに CommandField が追加されます。</span><span class="sxs-lookup"><span data-stu-id="26074-170">This will add a CommandField to the GridView s `Columns` collection with its `ShowDeleteButton` property set to `true`.</span></span>

<span data-ttu-id="26074-171">これらの変更を行った後、GridView の宣言型マークアップは次のようになります。</span><span class="sxs-lookup"><span data-stu-id="26074-171">After making these changes, your GridView s declarative markup should look like the following:</span></span>

[!code-aspx[Main](adding-client-side-confirmation-when-deleting-vb/samples/sample4.aspx)]

<span data-ttu-id="26074-172">CommandField には、GridView s `RowDataBound` イベントハンドラーからプログラムからアクセスできる単一の Delete LinkButton インスタンスが含まれています。</span><span class="sxs-lookup"><span data-stu-id="26074-172">The CommandField contains a single Delete LinkButton instance that can be accessed programmatically from the GridView s `RowDataBound` event handler.</span></span> <span data-ttu-id="26074-173">参照された後は、その `OnClientClick` プロパティを適宜設定できます。</span><span class="sxs-lookup"><span data-stu-id="26074-173">Once referenced, we can set its `OnClientClick` property accordingly.</span></span> <span data-ttu-id="26074-174">次のコードを使用して、`RowDataBound` イベントのイベントハンドラーを作成します。</span><span class="sxs-lookup"><span data-stu-id="26074-174">Create an event handler for the `RowDataBound` event using the following code:</span></span>

[!code-vb[Main](adding-client-side-confirmation-when-deleting-vb/samples/sample5.vb)]

<span data-ttu-id="26074-175">このイベントハンドラーは、データ行 ([削除] ボタンを含む) で動作し、[削除] ボタンをプログラムで参照することによって開始します。</span><span class="sxs-lookup"><span data-stu-id="26074-175">This event handler works with data rows (those that will have the Delete button) and begins by programmatically referencing the Delete button.</span></span> <span data-ttu-id="26074-176">一般に、次のパターンを使用します。</span><span class="sxs-lookup"><span data-stu-id="26074-176">In general use the following pattern:</span></span>

[!code-vb[Main](adding-client-side-confirmation-when-deleting-vb/samples/sample6.vb)]

<span data-ttu-id="26074-177">*です (buttontype*は、Commandfield、LinkButton、または ImageButton によって使用されているボタンの種類です。</span><span class="sxs-lookup"><span data-stu-id="26074-177">*ButtonType* is the type of button being used by the CommandField - Button, LinkButton, or ImageButton.</span></span> <span data-ttu-id="26074-178">既定では、CommandField は LinkButtons を使用しますが、これは CommandField s `ButtonType property`でカスタマイズできます。</span><span class="sxs-lookup"><span data-stu-id="26074-178">By default, the CommandField uses LinkButtons, but this can be customized via the CommandField s `ButtonType property`.</span></span> <span data-ttu-id="26074-179">*Commandfieldindex*は、GridView s `Columns` collection 内の commandfield の序数インデックスです。一方、制御*Lindex*は、commandfield s `Controls` コレクション内の Delete ボタンのインデックスです。</span><span class="sxs-lookup"><span data-stu-id="26074-179">The *commandFieldIndex* is the ordinal index of the CommandField within the GridView s `Columns` collection, whereas the *controlIndex* is the index of the Delete button within the CommandField s `Controls` collection.</span></span> <span data-ttu-id="26074-180">制御*Lindex*の値は、commandfield 内の他のボタンに対するボタンの位置によって異なります。</span><span class="sxs-lookup"><span data-stu-id="26074-180">The *controlIndex* value depends on the button s position relative to other buttons in the CommandField.</span></span> <span data-ttu-id="26074-181">たとえば、CommandField に [削除] ボタンが表示されているだけの場合は、インデックス0を使用します。</span><span class="sxs-lookup"><span data-stu-id="26074-181">For example, if the only button displayed in the CommandField is the Delete button, use an index of 0.</span></span> <span data-ttu-id="26074-182">ただし、[削除] ボタンの前に [編集] ボタンがある場合は、インデックス2を使用します。</span><span class="sxs-lookup"><span data-stu-id="26074-182">If, however, there s an Edit button that precedes the Delete button, use an index of 2.</span></span> <span data-ttu-id="26074-183">インデックス2が使用される理由は、Delete ボタンの前に CommandField によって2つのコントロールが追加されるためです。 edit ボタンと LiteralControl は、エディットボタンと Delete ボタンの間にスペースを追加するために使用されます。</span><span class="sxs-lookup"><span data-stu-id="26074-183">The reason an index of 2 is used is because two controls are added by the CommandField before the Delete button: the Edit button and a LiteralControl that s used to add some space between the Edit and Delete buttons.</span></span>

<span data-ttu-id="26074-184">この例では、CommandField に LinkButtons が使用されており、左端のフィールドには*Commandfieldindex*が0になっています。</span><span class="sxs-lookup"><span data-stu-id="26074-184">For our particular example, the CommandField uses LinkButtons and, being the left-most field, has a *commandFieldIndex* of 0.</span></span> <span data-ttu-id="26074-185">CommandField には他のボタンはありませんが、[削除] ボタンがあるため、0の制御*Lindex*を使用します。</span><span class="sxs-lookup"><span data-stu-id="26074-185">Since there are no other buttons but the Delete button in the CommandField, we use a *controlIndex* of 0.</span></span>

<span data-ttu-id="26074-186">CommandField の [削除] ボタンを参照した後、現在の GridView 行にバインドされている製品に関する情報を取得します。</span><span class="sxs-lookup"><span data-stu-id="26074-186">After referencing the Delete button in the CommandField, we next grab information about the product bound to the current GridView row.</span></span> <span data-ttu-id="26074-187">最後に、[削除] ボタン s `OnClientClick` プロパティを適切な JavaScript (製品名を含む) に設定します。</span><span class="sxs-lookup"><span data-stu-id="26074-187">Finally, we set the Delete button s `OnClientClick` property to the appropriate JavaScript, which includes the product s name.</span></span> <span data-ttu-id="26074-188">`confirm(string)` 関数に渡される JavaScript 文字列はアポストロフィで区切られているため、製品名内に出現するアポストロフィをエスケープする必要があります。</span><span class="sxs-lookup"><span data-stu-id="26074-188">Since the JavaScript string passed into the `confirm(string)` function is delimited using apostrophes we must escape any apostrophes that appear within the product s name.</span></span> <span data-ttu-id="26074-189">特に、製品名のアポストロフィは、"`\'`" でエスケープされます。</span><span class="sxs-lookup"><span data-stu-id="26074-189">In particular, any apostrophes in the product s name are escaped with "`\'`".</span></span>

<span data-ttu-id="26074-190">これらの変更が完了したら、GridView の [削除] ボタンをクリックすると、カスタマイズされた確認ダイアログボックスが表示されます (図4を参照)。</span><span class="sxs-lookup"><span data-stu-id="26074-190">With these changes complete, clicking on a Delete button in the GridView displays a customized confirmation dialog box (see Figure 4).</span></span> <span data-ttu-id="26074-191">FormView からの確認メッセージボックスと同様に、ユーザーが [キャンセル] をクリックした場合、ポストバックはキャンセルされるため、削除は行われません。</span><span class="sxs-lookup"><span data-stu-id="26074-191">As with the confirmation messagebox from the FormView, if the user clicks Cancel the postback is cancelled, thereby preventing the deletion from occurring.</span></span>

> [!NOTE]
> <span data-ttu-id="26074-192">この手法を使用すると、DetailsView の CommandField の Delete ボタンにプログラムでアクセスすることもできます。</span><span class="sxs-lookup"><span data-stu-id="26074-192">This technique can also be used to programmatically access the Delete button in the CommandField in a DetailsView.</span></span> <span data-ttu-id="26074-193">ただし、detailsview には、`RowDataBound` イベントがないため、`DataBound` イベントのイベントハンドラーを作成します。</span><span class="sxs-lookup"><span data-stu-id="26074-193">For the DetailsView, however, you d create an event handler for the `DataBound` event, since the DetailsView does not have a `RowDataBound` event.</span></span>

<span data-ttu-id="26074-194">[[GridView s Delete] ボタンをクリック ![と、カスタマイズされた確認ダイアログボックスが表示されます。](adding-client-side-confirmation-when-deleting-vb/_static/image9.png)](adding-client-side-confirmation-when-deleting-vb/_static/image8.png)</span><span class="sxs-lookup"><span data-stu-id="26074-194">[![Clicking the GridView s Delete Button Displays a Customized Confirmation Dialog Box](adding-client-side-confirmation-when-deleting-vb/_static/image9.png)](adding-client-side-confirmation-when-deleting-vb/_static/image8.png)</span></span>

<span data-ttu-id="26074-195">**図 4**: GridView の [削除] ボタンをクリックすると、カスタマイズされた確認ダイアログボックスが表示されます ([クリックすると、フルサイズの画像が表示](adding-client-side-confirmation-when-deleting-vb/_static/image10.png)されます)</span><span class="sxs-lookup"><span data-stu-id="26074-195">**Figure 4**: Clicking the GridView s Delete Button Displays a Customized Confirmation Dialog Box ([Click to view full-size image](adding-client-side-confirmation-when-deleting-vb/_static/image10.png))</span></span>

## <a name="using-templatefields"></a><span data-ttu-id="26074-196">TemplateFields の使用</span><span class="sxs-lookup"><span data-stu-id="26074-196">Using TemplateFields</span></span>

<span data-ttu-id="26074-197">CommandField の欠点の1つは、インデックスを使用してそのボタンにアクセスし、結果のオブジェクトを適切なボタンの種類 (Button、LinkButton、または ImageButton) にキャストする必要があることです。</span><span class="sxs-lookup"><span data-stu-id="26074-197">One of the disadvantages of the CommandField is that its buttons must be accessed through indexing and that the resulting object must be cast to the appropriate button type (Button, LinkButton, or ImageButton).</span></span> <span data-ttu-id="26074-198">"マジックナンバー" とハードコーディングされた型を使用すると、実行時まで検出できない問題が発生します。</span><span class="sxs-lookup"><span data-stu-id="26074-198">Using "magic numbers" and hard-coded types invites problems that cannot be discovered until runtime.</span></span> <span data-ttu-id="26074-199">たとえば、ユーザーまたは別の開発者が、将来のある時点で CommandField に新しいボタンを追加したり、`ButtonType` プロパティを変更したりすると、既存のコードはエラーなしでコンパイルされますが、コードの記述方法や変更内容によっては、ページにアクセスすると例外や予期しない動作が発生する可能性があります。</span><span class="sxs-lookup"><span data-stu-id="26074-199">For example, if you, or another developer, adds new buttons to the CommandField at some point in the future (such as an Edit button) or changes the `ButtonType` property, the existing code will still compile without error, but visiting the page may cause an exception or unexpected behavior, depending on how your code was written and what changes were made.</span></span>

<span data-ttu-id="26074-200">別の方法として、GridView および DetailsView s CommandFields を TemplateFields に変換します。</span><span class="sxs-lookup"><span data-stu-id="26074-200">An alternative approach is to convert the GridView and DetailsView s CommandFields into TemplateFields.</span></span> <span data-ttu-id="26074-201">これにより、CommandField の各ボタンに LinkButton (ボタンまたは ImageButton) を持つ `ItemTemplate` の TemplateField が生成されます。</span><span class="sxs-lookup"><span data-stu-id="26074-201">This will generate a TemplateField with an `ItemTemplate` that has a LinkButton (or Button or ImageButton) for each button in the CommandField.</span></span> <span data-ttu-id="26074-202">これらのボタン `OnClientClick` プロパティは、FormView で見たように宣言によって割り当てることができます。また、次のパターンを使用して、適切な `DataBound` イベントハンドラーでプログラムからアクセスすることもできます。</span><span class="sxs-lookup"><span data-stu-id="26074-202">These buttons `OnClientClick` properties can be assigned declaratively, as we saw with the FormView, or can be programmatically accessed in the appropriate `DataBound` event handler using the following pattern:</span></span>

[!code-vb[Main](adding-client-side-confirmation-when-deleting-vb/samples/sample7.vb)]

<span data-ttu-id="26074-203">ここで、 *controlID*はボタン s `ID` プロパティの値です。</span><span class="sxs-lookup"><span data-stu-id="26074-203">Where *controlID* is the value of the button s `ID` property.</span></span> <span data-ttu-id="26074-204">このパターンでは、キャストにハードコーディングされた型が必要ですが、インデックスを作成する必要がなくなり、実行時エラーが発生することなくレイアウトを変更できます。</span><span class="sxs-lookup"><span data-stu-id="26074-204">While this pattern still requires a hard-coded type for the cast, it removes the need for indexing, allowing for the layout to change without resulting in a runtime error.</span></span>

## <a name="summary"></a><span data-ttu-id="26074-205">まとめ</span><span class="sxs-lookup"><span data-stu-id="26074-205">Summary</span></span>

<span data-ttu-id="26074-206">JavaScript `confirm(string)` 関数は、フォーム送信ワークフローを制御するためによく使用される手法です。</span><span class="sxs-lookup"><span data-stu-id="26074-206">The JavaScript `confirm(string)` function is a commonly used technique for controlling form submission workflow.</span></span> <span data-ttu-id="26074-207">この関数を実行すると、モーダルのクライアント側ダイアログボックスが表示されます。このダイアログボックスには、[OK] と [キャンセル] の2つのボタンが含まれます。</span><span class="sxs-lookup"><span data-stu-id="26074-207">When executed, the function displays a modal, client-side dialog box that includes two buttons, OK and Cancel.</span></span> <span data-ttu-id="26074-208">ユーザーが [OK] をクリックすると、`confirm(string)` 関数は `true`を返します。[キャンセル] をクリックすると `false`が返されます。</span><span class="sxs-lookup"><span data-stu-id="26074-208">If the user clicks OK, the `confirm(string)` function returns `true`; clicking Cancel returns `false`.</span></span> <span data-ttu-id="26074-209">この機能は、ブラウザーの動作と組み合わせて、送信プロセス中にイベントハンドラーが `false`を返した場合に、フォームの送信をキャンセルします。これを使用すると、レコードを削除するときに確認メッセージボックスを表示できます。</span><span class="sxs-lookup"><span data-stu-id="26074-209">This functionality, coupled with a browser s behavior to cancel a form submission if an event handler during the submission process returns `false`, can be used to display a confirmation messagebox when deleting a record.</span></span>

<span data-ttu-id="26074-210">`confirm(string)` 関数は、コントロール s `OnClientClick` プロパティを介して、ボタン Web コントロール s クライアント側 `onclick` イベントハンドラーに関連付けることができます。</span><span class="sxs-lookup"><span data-stu-id="26074-210">The `confirm(string)` function can be associated with a Button Web control s client-side `onclick` event handler through the control s `OnClientClick` property.</span></span> <span data-ttu-id="26074-211">テンプレートで [削除] ボタンを使用する場合 (FormView のテンプレートのいずれか、または DetailsView または GridView の TemplateField)。このプロパティは、このチュートリアルで説明したように、宣言またはプログラムによって設定できます。</span><span class="sxs-lookup"><span data-stu-id="26074-211">When working with a Delete button in a template - either in one of the FormView s templates or in a TemplateField in the DetailsView or GridView - this property can be set either declaratively or programmatically, as we saw in this tutorial.</span></span>

<span data-ttu-id="26074-212">プログラミングを楽しんでください。</span><span class="sxs-lookup"><span data-stu-id="26074-212">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="26074-213">著者について</span><span class="sxs-lookup"><span data-stu-id="26074-213">About the Author</span></span>

<span data-ttu-id="26074-214">1998以来、 [Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml)は 7 asp/創設者 of [4GuysFromRolla.com](http://www.4guysfromrolla.com)の執筆者であり、Microsoft Web テクノロジを使用しています。</span><span class="sxs-lookup"><span data-stu-id="26074-214">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="26074-215">Scott は、独立したコンサルタント、トレーナー、およびライターとして機能します。</span><span class="sxs-lookup"><span data-stu-id="26074-215">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="26074-216">彼の最新の書籍は[ *、ASP.NET 2.0 を24時間以内に教え*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)ています。</span><span class="sxs-lookup"><span data-stu-id="26074-216">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="26074-217">mitchell@4GuysFromRolla.comでアクセスでき[ます。](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="26074-217">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="26074-218">または彼のブログを参照してください。これは[http://ScottOnWriting.NET](http://ScottOnWriting.NET)にあります。</span><span class="sxs-lookup"><span data-stu-id="26074-218">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="26074-219">[前へ](implementing-optimistic-concurrency-vb.md)
> [次へ](limiting-data-modification-functionality-based-on-the-user-vb.md)</span><span class="sxs-lookup"><span data-stu-id="26074-219">[Previous](implementing-optimistic-concurrency-vb.md)
[Next](limiting-data-modification-functionality-based-on-the-user-vb.md)</span></span>

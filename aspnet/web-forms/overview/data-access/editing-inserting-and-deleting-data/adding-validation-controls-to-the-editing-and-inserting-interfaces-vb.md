---
uid: web-forms/overview/data-access/editing-inserting-and-deleting-data/adding-validation-controls-to-the-editing-and-inserting-interfaces-vb
title: 編集および挿入インターフェイスに検証コントロールを追加する (VB) |Microsoft Docs
author: rick-anderson
description: このチュートリアルでは、データ Web コントロールの EditItemTemplate と Insertitemposition に検証コントロールを簡単に追加する方法について説明します。
ms.author: riande
ms.date: 07/17/2006
ms.assetid: e3d7028a-7a22-4a4f-babe-d53afc41c0e2
msc.legacyurl: /web-forms/overview/data-access/editing-inserting-and-deleting-data/adding-validation-controls-to-the-editing-and-inserting-interfaces-vb
msc.type: authoredcontent
ms.openlocfilehash: 5c5ad110ee0836f0a464b02a2b29254e2e06381e
ms.sourcegitcommit: 22fbd8863672c4ad6693b8388ad5c8e753fb41a2
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 11/28/2019
ms.locfileid: "74571348"
---
# <a name="adding-validation-controls-to-the-editing-and-inserting-interfaces-vb"></a><span data-ttu-id="0bcbb-103">編集および挿入インターフェイスに検証コントロールを追加する (VB)</span><span class="sxs-lookup"><span data-stu-id="0bcbb-103">Adding Validation Controls to the Editing and Inserting Interfaces (VB)</span></span>

<span data-ttu-id="0bcbb-104">[Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="0bcbb-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="0bcbb-105">[サンプルアプリのダウンロード](https://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_19_VB.exe)または[PDF のダウンロード](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/datatutorial19vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="0bcbb-105">[Download Sample App](https://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_19_VB.exe) or [Download PDF](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/datatutorial19vb1.pdf)</span></span>

> <span data-ttu-id="0bcbb-106">このチュートリアルでは、データ Web コントロールの EditItemTemplate と Insertitemposition に検証コントロールを追加して、より簡単なユーザーインターフェイスを提供することがいかに簡単かを説明します。</span><span class="sxs-lookup"><span data-stu-id="0bcbb-106">In this tutorial we'll see how easy it is to add validation controls to the EditItemTemplate and InsertItemTemplate of a data Web control, to provide a more foolproof user interface.</span></span>

## <a name="introduction"></a><span data-ttu-id="0bcbb-107">はじめに</span><span class="sxs-lookup"><span data-stu-id="0bcbb-107">Introduction</span></span>

<span data-ttu-id="0bcbb-108">前の3つのチュートリアルで調査した例の GridView および DetailsView コントロールはすべて、BoundFields と CheckBoxFields (GridView または DetailsView をデータソースにバインドするときに Visual Studio によって自動的に追加されたフィールド型) で構成されています。スマートタグを使用して制御します。</span><span class="sxs-lookup"><span data-stu-id="0bcbb-108">The GridView and DetailsView controls in the examples we've explored over the past three tutorials have all been composed of BoundFields and CheckBoxFields (the field types automatically added by Visual Studio when binding a GridView or DetailsView to a data source control through the smart tag).</span></span> <span data-ttu-id="0bcbb-109">GridView または DetailsView で行を編集するときに、読み取り専用ではない連結されたフィールドは、エンドユーザーが既存のデータを変更できるテキストボックスに変換されます。</span><span class="sxs-lookup"><span data-stu-id="0bcbb-109">When editing a row in a GridView or DetailsView, those BoundFields that are not read-only are converted into textboxes, from which the end user can modify the existing data.</span></span> <span data-ttu-id="0bcbb-110">同様に、新しいレコードを DetailsView コントロールに挿入する場合、`InsertVisible` プロパティが `True` (既定値) に設定されている連結フィールドは空のテキストボックスとしてレンダリングされ、ユーザーは新しいレコードのフィールド値を指定できます。</span><span class="sxs-lookup"><span data-stu-id="0bcbb-110">Similarly, when inserting a new record into a DetailsView control, those BoundFields whose `InsertVisible` property is set to `True` (the default) are rendered as empty textboxes, into which the user can provide the new record's field values.</span></span> <span data-ttu-id="0bcbb-111">同様に、標準の読み取り専用インターフェイスで無効になっている CheckBoxFields は、編集および挿入インターフェイスで有効なチェックボックスに変換されます。</span><span class="sxs-lookup"><span data-stu-id="0bcbb-111">Likewise, CheckBoxFields, which are disabled in the standard, read-only interface, are converted into enabled checkboxes in the editing and inserting interfaces.</span></span>

<span data-ttu-id="0bcbb-112">BoundField と CheckBoxField の既定の編集および挿入インターフェイスは役に立ちますが、インターフェイスには何の種類の検証もありません。</span><span class="sxs-lookup"><span data-stu-id="0bcbb-112">While the default editing and inserting interfaces for the BoundField and CheckBoxField can be helpful, the interface lacks any sort of validation.</span></span> <span data-ttu-id="0bcbb-113">ユーザーが `ProductName` フィールドを省略したり、`UnitsInStock` に無効な値 (-50 など) を入力したりしたときに、データ入力の誤りが発生した場合は、アプリケーションアーキテクチャの深さ内から例外が発生します。</span><span class="sxs-lookup"><span data-stu-id="0bcbb-113">If a user makes a data entry mistake - such as omitting the `ProductName` field or entering an invalid value for `UnitsInStock` (such as -50) an exception will be raised from within the depths of the application architecture.</span></span> <span data-ttu-id="0bcbb-114">この例外は、[前のチュートリアル](handling-bll-and-dal-level-exceptions-in-an-asp-net-page-vb.md)で説明したように適切に処理できますが、ユーザーが最初に無効なデータを入力しないようにするための検証コントロールが、編集または挿入ユーザーインターフェイスに含まれていることが理想的です。</span><span class="sxs-lookup"><span data-stu-id="0bcbb-114">While this exception can be gracefully handled as demonstrated in the [previous tutorial](handling-bll-and-dal-level-exceptions-in-an-asp-net-page-vb.md), ideally the editing or inserting user interface would include validation controls to prevent a user from entering such invalid data in the first place.</span></span>

<span data-ttu-id="0bcbb-115">カスタマイズされた編集または挿入インターフェイスを提供するには、BoundField または CheckBoxField を TemplateField に置き換える必要があります。</span><span class="sxs-lookup"><span data-stu-id="0bcbb-115">In order to provide a customized editing or inserting interface, we need to replace the BoundField or CheckBoxField with a TemplateField.</span></span> <span data-ttu-id="0bcbb-116">TemplateFields は、 [GridView コントロールでの TemplateFields の使用](../custom-formatting/using-templatefields-in-the-gridview-control-cs.md)に関するトピックであり、 [DetailsView コントロールのチュートリアルでは templatefields](../custom-formatting/using-templatefields-in-the-detailsview-control-vb.md)を使用して、さまざまな行の状態に対して個別のインターフェイスを定義する複数のテンプレートで構成されています。</span><span class="sxs-lookup"><span data-stu-id="0bcbb-116">TemplateFields, which were the topic of discussion in the [Using TemplateFields in the GridView Control](../custom-formatting/using-templatefields-in-the-gridview-control-cs.md) and [Using TemplateFields in the DetailsView Control](../custom-formatting/using-templatefields-in-the-detailsview-control-vb.md) tutorials, can consist of multiple templates defining separate interfaces for different row states.</span></span> <span data-ttu-id="0bcbb-117">TemplateField の `ItemTemplate` は、DetailsView コントロールまたは GridView コントロールで読み取り専用のフィールドまたは行を表示するときに使用されます。一方、`EditItemTemplate` と `InsertItemTemplate` は、それぞれ編集モードと挿入モードで使用するインターフェイスを示します。</span><span class="sxs-lookup"><span data-stu-id="0bcbb-117">The TemplateField's `ItemTemplate` is used to when rendering read-only fields or rows in the DetailsView or GridView controls, whereas the `EditItemTemplate` and `InsertItemTemplate` indicate the interfaces to use for the editing and inserting modes, respectively.</span></span>

<span data-ttu-id="0bcbb-118">このチュートリアルでは、TemplateField の `EditItemTemplate` に検証コントロールを追加して、より簡単なユーザーインターフェイスを提供する `InsertItemTemplate` 方法について説明します。</span><span class="sxs-lookup"><span data-stu-id="0bcbb-118">In this tutorial we'll see how easy it is to add validation controls to the TemplateField's `EditItemTemplate` and `InsertItemTemplate` to provide a more foolproof user interface.</span></span> <span data-ttu-id="0bcbb-119">具体的には、このチュートリアルでは、「[挿入、更新、削除に関連するイベントの調査](examining-the-events-associated-with-inserting-updating-and-deleting-vb.md)」で作成した例を使用して、適切な検証を含むように編集および挿入インターフェイスを強化します。</span><span class="sxs-lookup"><span data-stu-id="0bcbb-119">Specifically, this tutorial takes the example created in the [Examining the Events Associated with Inserting, Updating, and Deleting](examining-the-events-associated-with-inserting-updating-and-deleting-vb.md) tutorial and augments the editing and inserting interfaces to include appropriate validation.</span></span>

## <a name="step-1-replicating-the-example-fromexamining-the-events-associated-with-inserting-updating-and-deletingexamining-the-events-associated-with-inserting-updating-and-deleting-vbmd"></a><span data-ttu-id="0bcbb-120">手順 1:[挿入、更新、および削除に関連付けられたイベントを調べる](examining-the-events-associated-with-inserting-updating-and-deleting-vb.md)例をレプリケートする</span><span class="sxs-lookup"><span data-stu-id="0bcbb-120">Step 1: Replicating the Example from[Examining the Events Associated with Inserting, Updating, and Deleting](examining-the-events-associated-with-inserting-updating-and-deleting-vb.md)</span></span>

<span data-ttu-id="0bcbb-121">[「挿入、更新、および削除](examining-the-events-associated-with-inserting-updating-and-deleting-vb.md)」チュートリアルに関連するイベントを確認すると、編集可能な GridView で製品の名前と価格を記載したページが作成されました。</span><span class="sxs-lookup"><span data-stu-id="0bcbb-121">In the [Examining the Events Associated with Inserting, Updating, and Deleting](examining-the-events-associated-with-inserting-updating-and-deleting-vb.md) tutorial we created a page that listed the names and prices of the products in an editable GridView.</span></span> <span data-ttu-id="0bcbb-122">また、ページには、`DefaultMode` プロパティが `Insert`に設定されている DetailsView が含まれており、これによって常に挿入モードでレンダリングされます。</span><span class="sxs-lookup"><span data-stu-id="0bcbb-122">Additionally, the page included a DetailsView whose `DefaultMode` property was set to `Insert`, thereby always rendering in insert mode.</span></span> <span data-ttu-id="0bcbb-123">この DetailsView から、ユーザーは新しい製品の名前と価格を入力し、[挿入] をクリックして、システムに追加することができます (図1を参照)。</span><span class="sxs-lookup"><span data-stu-id="0bcbb-123">From this DetailsView, the user could enter the name and price for a new product, click Insert, and have it added to the system (see Figure 1).</span></span>

<span data-ttu-id="0bcbb-124">[前の例を ![すると、新しい製品を追加したり、既存の製品を編集したりすることができます。](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image2.png)](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="0bcbb-124">[![The Previous Example Allows Users to Add New Products and Edit Existing Ones](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image2.png)](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image1.png)</span></span>

<span data-ttu-id="0bcbb-125">**図 1**: 前の例では、ユーザーが新しい製品を追加し、既存の製品を編集できるようにします ([クリックすると、フルサイズの画像が表示](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image3.png)されます)</span><span class="sxs-lookup"><span data-stu-id="0bcbb-125">**Figure 1**: The Previous Example Allows Users to Add New Products and Edit Existing Ones ([Click to view full-size image](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image3.png))</span></span>

<span data-ttu-id="0bcbb-126">このチュートリアルの目的は、検証コントロールを提供するように DetailsView と GridView を拡張することです。</span><span class="sxs-lookup"><span data-stu-id="0bcbb-126">Our goal for this tutorial is to augment the DetailsView and GridView to provide validation controls.</span></span> <span data-ttu-id="0bcbb-127">特に、検証ロジックは次のようになります。</span><span class="sxs-lookup"><span data-stu-id="0bcbb-127">In particular, our validation logic will:</span></span>

- <span data-ttu-id="0bcbb-128">製品の挿入時または編集時に名前を指定する必要があります</span><span class="sxs-lookup"><span data-stu-id="0bcbb-128">Require that the name be provided when inserting or editing a product</span></span>
- <span data-ttu-id="0bcbb-129">レコードを挿入するときに価格を指定する必要があります。レコードを編集する場合でも価格は必要ですが、前のチュートリアルで既に存在している GridView の `RowUpdating` イベントハンドラーでプログラムロジックを使用します。</span><span class="sxs-lookup"><span data-stu-id="0bcbb-129">Require that the price be provided when inserting a record; when editing a record, we will still require a price, but will use the programmatic logic in the GridView's `RowUpdating` event handler already present from the earlier tutorial</span></span>
- <span data-ttu-id="0bcbb-130">価格に入力した値が有効な通貨書式であることを確認します。</span><span class="sxs-lookup"><span data-stu-id="0bcbb-130">Ensure that the value entered for the price is a valid currency format</span></span>

<span data-ttu-id="0bcbb-131">前の例を補強して検証を含める方法については、まず、`DataModificationEvents.aspx` ページからこのチュートリアルのページ (`UIValidation.aspx`) にこの例をレプリケートする必要があります。</span><span class="sxs-lookup"><span data-stu-id="0bcbb-131">Before we can look at augmenting the previous example to include validation, we first need to replicate the example from the `DataModificationEvents.aspx` page to the page for this tutorial, `UIValidation.aspx`.</span></span> <span data-ttu-id="0bcbb-132">これを実現するには、`DataModificationEvents.aspx` ページの宣言型マークアップとソースコードの両方をコピーする必要があります。</span><span class="sxs-lookup"><span data-stu-id="0bcbb-132">To accomplish this we need to copy over both the `DataModificationEvents.aspx` page's declarative markup and its source code.</span></span> <span data-ttu-id="0bcbb-133">次の手順を実行して、最初に宣言マークアップをコピーします。</span><span class="sxs-lookup"><span data-stu-id="0bcbb-133">First copy over the declarative markup by performing the following steps:</span></span>

1. <span data-ttu-id="0bcbb-134">Visual Studio で [`DataModificationEvents.aspx`] ページを開く</span><span class="sxs-lookup"><span data-stu-id="0bcbb-134">Open the `DataModificationEvents.aspx` page in Visual Studio</span></span>
2. <span data-ttu-id="0bcbb-135">ページの宣言型マークアップにアクセスします (ページの下部にある [ソース] ボタンをクリックします)。</span><span class="sxs-lookup"><span data-stu-id="0bcbb-135">Go to the page's declarative markup (click on the Source button at the bottom of the page)</span></span>
3. <span data-ttu-id="0bcbb-136">図2に示すように、`<asp:Content>` タグと `</asp:Content>` タグ (行 3 ~ 44) 内のテキストをコピーします。</span><span class="sxs-lookup"><span data-stu-id="0bcbb-136">Copy the text within the `<asp:Content>` and `</asp:Content>` tags (lines 3 through 44), as shown in Figure 2.</span></span>

<span data-ttu-id="0bcbb-137">[&lt;asp: Content&gt; コントロール内のテキストをコピー ![には](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image5.png)](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="0bcbb-137">[![Copy the Text Within the &lt;asp:Content&gt; Control](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image5.png)](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image4.png)</span></span>

<span data-ttu-id="0bcbb-138">**図 2**: `<asp:Content>` コントロール内のテキストをコピー[する (クリックすると、フルサイズの画像が表示](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image6.png)されます)</span><span class="sxs-lookup"><span data-stu-id="0bcbb-138">**Figure 2**: Copy the Text Within the `<asp:Content>` Control ([Click to view full-size image](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image6.png))</span></span>

1. <span data-ttu-id="0bcbb-139">[`UIValidation.aspx`] ページを開く</span><span class="sxs-lookup"><span data-stu-id="0bcbb-139">Open the `UIValidation.aspx` page</span></span>
2. <span data-ttu-id="0bcbb-140">ページの宣言型マークアップにアクセスする</span><span class="sxs-lookup"><span data-stu-id="0bcbb-140">Go to the page's declarative markup</span></span>
3. <span data-ttu-id="0bcbb-141">`<asp:Content>` コントロール内にテキストを貼り付けます。</span><span class="sxs-lookup"><span data-stu-id="0bcbb-141">Paste the text within the `<asp:Content>` control.</span></span>

<span data-ttu-id="0bcbb-142">ソースコードをコピーするには、[`DataModificationEvents.aspx.vb`] ページを開き、`EditInsertDelete_DataModificationEvents` クラス*内*のテキストだけをコピーします。</span><span class="sxs-lookup"><span data-stu-id="0bcbb-142">To copy over the source code, open the `DataModificationEvents.aspx.vb` page and copy just the text *within* the `EditInsertDelete_DataModificationEvents` class.</span></span> <span data-ttu-id="0bcbb-143">3つのイベントハンドラー (`Page_Load`、`GridView1_RowUpdating`、および `ObjectDataSource1_Inserting`) をコピーしますが、クラス宣言**はコピーしないでください。**</span><span class="sxs-lookup"><span data-stu-id="0bcbb-143">Copy the three event handlers (`Page_Load`, `GridView1_RowUpdating`, and `ObjectDataSource1_Inserting`), but do **not** copy the class declaration.</span></span> <span data-ttu-id="0bcbb-144">コピーしたテキストを `UIValidation.aspx.vb`の `EditInsertDelete_UIValidation` クラス*内*に貼り付けます。</span><span class="sxs-lookup"><span data-stu-id="0bcbb-144">Paste the copied text *within* the `EditInsertDelete_UIValidation` class in `UIValidation.aspx.vb`.</span></span>

<span data-ttu-id="0bcbb-145">コンテンツとコードを `DataModificationEvents.aspx` から `UIValidation.aspx`に移動したら、ブラウザーで進行状況をテストしてみましょう。</span><span class="sxs-lookup"><span data-stu-id="0bcbb-145">After moving over the content and code from `DataModificationEvents.aspx` to `UIValidation.aspx`, take a moment to test out your progress in a browser.</span></span> <span data-ttu-id="0bcbb-146">同じ出力が表示され、これらの2つの各ページで同じ機能が使用されます (「操作中」 `DataModificationEvents.aspx` のスクリーンショットについては、図1を参照してください)。</span><span class="sxs-lookup"><span data-stu-id="0bcbb-146">You should see the same output and experience the same functionality in each of these two pages (refer back to Figure 1 for a screen shot of `DataModificationEvents.aspx` in action).</span></span>

## <a name="step-2-converting-the-boundfields-into-templatefields"></a><span data-ttu-id="0bcbb-147">手順 2: BoundFields を TemplateFields に変換する</span><span class="sxs-lookup"><span data-stu-id="0bcbb-147">Step 2: Converting the BoundFields Into TemplateFields</span></span>

<span data-ttu-id="0bcbb-148">編集および挿入インターフェイスに検証コントロールを追加するには、DetailsView コントロールと GridView コントロールで使用される BoundFields を TemplateFields に変換する必要があります。</span><span class="sxs-lookup"><span data-stu-id="0bcbb-148">To add validation controls to the editing and inserting interfaces, the BoundFields used by the DetailsView and GridView controls need to be converted into TemplateFields.</span></span> <span data-ttu-id="0bcbb-149">これを実現するには、GridView および DetailsView のスマートタグの [列の編集] リンクと [フィールドの編集] リンクをそれぞれクリックします。</span><span class="sxs-lookup"><span data-stu-id="0bcbb-149">To achieve this, click on the Edit Columns and Edit Fields links in the GridView and DetailsView's smart tags, respectively.</span></span> <span data-ttu-id="0bcbb-150">ここで、各 BoundFields を選択し、[このフィールドを TemplateField に変換する] リンクをクリックします。</span><span class="sxs-lookup"><span data-stu-id="0bcbb-150">There, select each of the BoundFields and click the "Convert this field into a TemplateField" link.</span></span>

<span data-ttu-id="0bcbb-151">[各 DetailsView のおよび GridView の BoundFields を TemplateFields に変換 ![](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image8.png)](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="0bcbb-151">[![Convert Each of the DetailsView's and GridView's BoundFields Into TemplateFields](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image8.png)](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image7.png)</span></span>

<span data-ttu-id="0bcbb-152">**図 3**: DetailsView の各フィールドと GridView の Boundfields を templatefields に変換[する (クリックしてフルサイズのイメージを表示する](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="0bcbb-152">**Figure 3**: Convert Each of the DetailsView's and GridView's BoundFields Into TemplateFields ([Click to view full-size image](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image9.png))</span></span>

<span data-ttu-id="0bcbb-153">[フィールド] ダイアログボックスを使用して BoundField を TemplateField に変換すると、BoundField 自体と同じ読み取り専用、編集、および挿入インターフェイスを示す TemplateField が生成されます。</span><span class="sxs-lookup"><span data-stu-id="0bcbb-153">Converting a BoundField into a TemplateField through the Fields dialog box generates a TemplateField that exhibits the same read-only, editing, and inserting interfaces as the BoundField itself.</span></span> <span data-ttu-id="0bcbb-154">次のマークアップは、TemplateField に変換された後の DetailsView の `ProductName` フィールドの宣言構文を示しています。</span><span class="sxs-lookup"><span data-stu-id="0bcbb-154">The following markup shows the declarative syntax for the `ProductName` field in the DetailsView after it has been converted into a TemplateField:</span></span>

[!code-aspx[Main](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/samples/sample1.aspx)]

<span data-ttu-id="0bcbb-155">この TemplateField には、`ItemTemplate`、`EditItemTemplate`、`InsertItemTemplate`という3つのテンプレートが自動的に作成されていることに注意してください。</span><span class="sxs-lookup"><span data-stu-id="0bcbb-155">Note that this TemplateField had three templates automatically created `ItemTemplate`, `EditItemTemplate`, and `InsertItemTemplate`.</span></span> <span data-ttu-id="0bcbb-156">`ItemTemplate` には、ラベル Web コントロールを使用して1つのデータフィールド値 (`ProductName`) が表示されます。一方、`EditItemTemplate` と `InsertItemTemplate` では、双方向のデータバインディングを使用して、データフィールドをテキストボックスの `Text` プロパティに関連付けている TextBox Web コントロールにデータフィールド値が表示されます。</span><span class="sxs-lookup"><span data-stu-id="0bcbb-156">The `ItemTemplate` displays a single data field value (`ProductName`) using a Label Web control, while the `EditItemTemplate` and `InsertItemTemplate` present the data field value in a TextBox Web control that associates the data field with the TextBox's `Text` property using two-way databinding.</span></span> <span data-ttu-id="0bcbb-157">ここでは、挿入のためにこのページの DetailsView のみを使用しているので、2つの TemplateFields から `ItemTemplate` と `EditItemTemplate` を削除できますが、そのままにしても問題はありません。</span><span class="sxs-lookup"><span data-stu-id="0bcbb-157">Since we are only using the DetailsView in this page for inserting, you may remove the `ItemTemplate` and `EditItemTemplate` from the two TemplateFields, although there's no harm in leaving them.</span></span>

<span data-ttu-id="0bcbb-158">GridView では DetailsView の組み込み挿入機能がサポートされていないため、GridView の `ProductName` フィールドを TemplateField に変換すると、`ItemTemplate` と `EditItemTemplate`のみになります。</span><span class="sxs-lookup"><span data-stu-id="0bcbb-158">Since the GridView does not support the built-in inserting features of the DetailsView, converting the GridView's `ProductName` field into a TemplateField results in only an `ItemTemplate` and `EditItemTemplate`:</span></span>

[!code-aspx[Main](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/samples/sample2.aspx)]

<span data-ttu-id="0bcbb-159">[このフィールドを TemplateField に変換する] をクリックすると、Visual Studio によって TemplateField が作成され、そのテンプレートが変換された BoundField のユーザーインターフェイスを模倣します。</span><span class="sxs-lookup"><span data-stu-id="0bcbb-159">By clicking the "Convert this field into a TemplateField," Visual Studio has created a TemplateField whose templates mimic the user interface of the converted BoundField.</span></span> <span data-ttu-id="0bcbb-160">これを確認するには、ブラウザーを使用してこのページにアクセスします。</span><span class="sxs-lookup"><span data-stu-id="0bcbb-160">You can verify this by visiting this page through a browser.</span></span> <span data-ttu-id="0bcbb-161">代わりに、BoundFields が使用されていた場合は、TemplateFields の外観と動作が同じであることがわかります。</span><span class="sxs-lookup"><span data-stu-id="0bcbb-161">You'll find that the appearance and behavior of the TemplateFields is identical to the experience when BoundFields were used instead.</span></span>

> [!NOTE]
> <span data-ttu-id="0bcbb-162">必要に応じて、テンプレートの編集インターフェイスを自由にカスタマイズできます。</span><span class="sxs-lookup"><span data-stu-id="0bcbb-162">Feel free to customize the editing interfaces in the templates as needed.</span></span> <span data-ttu-id="0bcbb-163">たとえば、`UnitPrice` TemplateFields のテキストボックスを、`ProductName` テキストボックスよりも小さなテキストボックスとして表示したい場合があります。</span><span class="sxs-lookup"><span data-stu-id="0bcbb-163">For example, we may want to have the TextBox in the `UnitPrice` TemplateFields rendered as a smaller textbox than the `ProductName` textbox.</span></span> <span data-ttu-id="0bcbb-164">これを実現するには、TextBox の `Columns` プロパティを適切な値に設定するか、`Width` プロパティを使用して絶対幅を指定します。</span><span class="sxs-lookup"><span data-stu-id="0bcbb-164">To accomplish this you can set the TextBox's `Columns` property to an appropriate value or provide an absolute width via the `Width` property.</span></span> <span data-ttu-id="0bcbb-165">次のチュートリアルでは、テキストボックスを代替データ入力 Web コントロールに置き換えることにより、編集インターフェイスを完全にカスタマイズする方法について説明します。</span><span class="sxs-lookup"><span data-stu-id="0bcbb-165">In the next tutorial we'll see how to completely customize the editing interface by replacing the TextBox with an alternate data entry Web control.</span></span>

## <a name="step-3-adding-the-validation-controls-to-the-gridviewsedititemtemplate-s"></a><span data-ttu-id="0bcbb-166">手順 3: GridView の`EditItemTemplate` s に検証コントロールを追加する</span><span class="sxs-lookup"><span data-stu-id="0bcbb-166">Step 3: Adding the Validation Controls to the GridView's`EditItemTemplate` s</span></span>

<span data-ttu-id="0bcbb-167">データ入力フォームを構築するときは、ユーザーが必要なフィールドを入力し、指定されたすべての入力が有効で適切に書式設定された値であることが重要です。</span><span class="sxs-lookup"><span data-stu-id="0bcbb-167">When constructing data entry forms, it is important that users enter any required fields and that all provided inputs are legal, properly-formatted values.</span></span> <span data-ttu-id="0bcbb-168">ユーザーの入力が有効であることを確認するために、ASP.NET には、単一の入力コントロールの値を検証するために使用するように設計された5つの組み込みの検証コントロールが用意されています。</span><span class="sxs-lookup"><span data-stu-id="0bcbb-168">To help ensure that a user's inputs are valid, ASP.NET provides five built-in validation controls that are designed to be used to validate the value of a single input control:</span></span>

- <span data-ttu-id="0bcbb-169">[RequiredFieldValidator](https://msdn.microsoft.com/library/5hbw267h(VS.80).aspx)は、値が指定されていることを確認します。</span><span class="sxs-lookup"><span data-stu-id="0bcbb-169">[RequiredFieldValidator](https://msdn.microsoft.com/library/5hbw267h(VS.80).aspx) ensures that a value has been provided</span></span>
- <span data-ttu-id="0bcbb-170">[CompareValidator](https://msdn.microsoft.com/library/db330ayw(VS.80).aspx)は、別の Web コントロール値または定数値に対して値を検証したり、指定されたデータ型に対して値の形式が有効であることを確認したりします。</span><span class="sxs-lookup"><span data-stu-id="0bcbb-170">[CompareValidator](https://msdn.microsoft.com/library/db330ayw(VS.80).aspx) validates a value against another Web control value or a constant value, or ensures that the value's format is legal for a specified data type</span></span>
- <span data-ttu-id="0bcbb-171">[RangeValidator](https://msdn.microsoft.com/library/f70d09xt.aspx)値が値の範囲内にあることを確認します。</span><span class="sxs-lookup"><span data-stu-id="0bcbb-171">[RangeValidator](https://msdn.microsoft.com/library/f70d09xt.aspx) ensures that a value is within a range of values</span></span>
- <span data-ttu-id="0bcbb-172">[RegularExpressionValidator](https://msdn.microsoft.com/library/eahwtc9e.aspx) [正規表現](http://en.wikipedia.org/wiki/Regular_expression)に対して値を検証します。</span><span class="sxs-lookup"><span data-stu-id="0bcbb-172">[RegularExpressionValidator](https://msdn.microsoft.com/library/eahwtc9e.aspx) validates a value against a [regular expression](http://en.wikipedia.org/wiki/Regular_expression)</span></span>
- <span data-ttu-id="0bcbb-173">[CustomValidator](https://msdn.microsoft.com/library/9eee01cx(VS.80).aspx)カスタムのユーザー定義メソッドに対して値を検証します。</span><span class="sxs-lookup"><span data-stu-id="0bcbb-173">[CustomValidator](https://msdn.microsoft.com/library/9eee01cx(VS.80).aspx) validates a value against a custom, user-defined method</span></span>

<span data-ttu-id="0bcbb-174">これらの5つのコントロールの詳細については、 [ASP.NET のクイックスタートチュートリアル](https://asp.net/QuickStart/aspnet/)の[「検証コントロール」セクション](https://quickstarts.asp.net/quickstartv20/aspnet/doc/ctrlref/validation/default.aspx)を参照してください。</span><span class="sxs-lookup"><span data-stu-id="0bcbb-174">For more information on these five controls, check out the [Validation Controls section](https://quickstarts.asp.net/quickstartv20/aspnet/doc/ctrlref/validation/default.aspx) of the [ASP.NET Quickstart Tutorials](https://asp.net/QuickStart/aspnet/).</span></span>

<span data-ttu-id="0bcbb-175">このチュートリアルでは、DetailsView と GridView の `ProductName` TemplateFields の両方で RequiredFieldValidator と、DetailsView の `UnitPrice` TemplateField の RequiredFieldValidator を使用する必要があります。</span><span class="sxs-lookup"><span data-stu-id="0bcbb-175">For our tutorial we'll need to use a RequiredFieldValidator in both the DetailsView and GridView's `ProductName` TemplateFields and a RequiredFieldValidator in the DetailsView's `UnitPrice` TemplateField.</span></span> <span data-ttu-id="0bcbb-176">さらに、入力した価格の値が0以上で、有効な通貨形式で表示されるように、両方のコントロールの `UnitPrice` TemplateFields に CompareValidator を追加する必要があります。</span><span class="sxs-lookup"><span data-stu-id="0bcbb-176">Furthermore, we'll need to add a CompareValidator to both controls' `UnitPrice` TemplateFields that ensures that the entered price has a value greater than or equal to 0 and is presented in a valid currency format.</span></span>

> [!NOTE]
> <span data-ttu-id="0bcbb-177">ASP.NET 1.x にはこれらの5つの検証コントロールがありましたが、ASP.NET 2.0 には、Internet Explorer 以外のブラウザーでのクライアント側スクリプトの主なサポートと、ページ上の検証コントロールをパーティション分割する機能の2つがあります。検証グループ。</span><span class="sxs-lookup"><span data-stu-id="0bcbb-177">While ASP.NET 1.x had these same five validation controls, ASP.NET 2.0 has added a number of improvements, the main two being client-side script support for browsers other than Internet Explorer and the ability to partition validation controls on a page into validation groups.</span></span> <span data-ttu-id="0bcbb-178">2\.0 の新しい検証コントロール機能の詳細については、「 [ASP.NET 2.0 の検証コントロールの解説」](http://aspnet.4guysfromrolla.com/articles/112305-1.aspx)を参照してください。</span><span class="sxs-lookup"><span data-stu-id="0bcbb-178">For more information on the new validation control features in 2.0, refer to [Dissecting the Validation Controls in ASP.NET 2.0](http://aspnet.4guysfromrolla.com/articles/112305-1.aspx).</span></span>

<span data-ttu-id="0bcbb-179">まず、必要な検証コントロールを GridView の TemplateFields の `EditItemTemplate` に追加します。</span><span class="sxs-lookup"><span data-stu-id="0bcbb-179">Let's start by adding the necessary validation controls to the `EditItemTemplate` s in the GridView's TemplateFields.</span></span> <span data-ttu-id="0bcbb-180">これを実現するには、GridView のスマートタグの [テンプレートの編集] リンクをクリックして、テンプレート編集インターフェイスを表示します。</span><span class="sxs-lookup"><span data-stu-id="0bcbb-180">To accomplish this, click on the Edit Templates link from the GridView's smart tag to bring up the template editing interface.</span></span> <span data-ttu-id="0bcbb-181">ここでは、ドロップダウンリストから編集するテンプレートを選択できます。</span><span class="sxs-lookup"><span data-stu-id="0bcbb-181">From here, you can select which template to edit from the drop-down list.</span></span> <span data-ttu-id="0bcbb-182">編集インターフェイスを拡張する必要があるため、`ProductName` と `UnitPrice`の `EditItemTemplate` に検証コントロールを追加する必要があります。</span><span class="sxs-lookup"><span data-stu-id="0bcbb-182">Since we want to augment the editing interface, we need to add validation controls to the `ProductName` and `UnitPrice`'s `EditItemTemplate` s.</span></span>

<span data-ttu-id="0bcbb-183">[![ProductName と UnitPrice の EditItemTemplates を拡張する必要があります。](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image11.png)](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="0bcbb-183">[![We Need to Extend the ProductName and UnitPrice's EditItemTemplates](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image11.png)](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image10.png)</span></span>

<span data-ttu-id="0bcbb-184">**図 4**: `ProductName` と `UnitPrice`の `EditItemTemplate` を拡張する必要があります ([クリックすると、フルサイズの画像が表示](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image12.png)されます)</span><span class="sxs-lookup"><span data-stu-id="0bcbb-184">**Figure 4**: We Need to Extend the `ProductName` and `UnitPrice`'s `EditItemTemplate` s ([Click to view full-size image](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image12.png))</span></span>

<span data-ttu-id="0bcbb-185">`ProductName` `EditItemTemplate`で、[ツールボックス] から RequiredFieldValidator を追加し、テキストボックスの後に配置します。</span><span class="sxs-lookup"><span data-stu-id="0bcbb-185">In the `ProductName` `EditItemTemplate`, add a RequiredFieldValidator by dragging it from the Toolbox into the template editing interface, placing after the TextBox.</span></span>

<span data-ttu-id="0bcbb-186">[RequiredFieldValidator を ProductName EditItemTemplate に追加 ![には](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image14.png)](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="0bcbb-186">[![Add a RequiredFieldValidator to the ProductName EditItemTemplate](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image14.png)](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image13.png)</span></span>

<span data-ttu-id="0bcbb-187">**図 5**: `ProductName` `EditItemTemplate` に RequiredFieldValidator を追加する ([クリックすると、フルサイズの画像が表示](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image15.png)されます)</span><span class="sxs-lookup"><span data-stu-id="0bcbb-187">**Figure 5**: Add a RequiredFieldValidator to the `ProductName` `EditItemTemplate` ([Click to view full-size image](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image15.png))</span></span>

<span data-ttu-id="0bcbb-188">すべての検証コントロールは、単一の ASP.NET Web コントロールの入力を検証することによって機能します。</span><span class="sxs-lookup"><span data-stu-id="0bcbb-188">All validation controls work by validating the input of a single ASP.NET Web control.</span></span> <span data-ttu-id="0bcbb-189">そのため、追加した RequiredFieldValidator が `EditItemTemplate`のテキストボックスに対して検証する必要があることを示す必要があります。これは、検証コントロールの[ControlToValidate プロパティ](https://msdn.microsoft.com/library/system.web.ui.webcontrols.basevalidator.controltovalidate(VS.80).aspx)を適切な Web コントロールの `ID` に設定することによって実現されます。</span><span class="sxs-lookup"><span data-stu-id="0bcbb-189">Therefore, we need to indicate that the RequiredFieldValidator we just added should validate against the TextBox in the `EditItemTemplate`; this is accomplished by setting the validation control's [ControlToValidate property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.basevalidator.controltovalidate(VS.80).aspx) to the `ID` of the appropriate Web control.</span></span> <span data-ttu-id="0bcbb-190">現在、テキストボックスには、`TextBox1`の nondescript `ID` がありますが、それをより適切なものに変更してみましょう。</span><span class="sxs-lookup"><span data-stu-id="0bcbb-190">The TextBox currently has the rather nondescript `ID` of `TextBox1`, but let's change it to something more appropriate.</span></span> <span data-ttu-id="0bcbb-191">テンプレートのテキストボックスをクリックし、プロパティウィンドウから、`ID` を `TextBox1` から `EditProductName`に変更します。</span><span class="sxs-lookup"><span data-stu-id="0bcbb-191">Click on the TextBox in the template and then, from the Properties window, change the `ID` from `TextBox1` to `EditProductName`.</span></span>

<span data-ttu-id="0bcbb-192">[テキストボックスの ID を EditProductName に変更 ![には](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image17.png)](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="0bcbb-192">[![Change the TextBox's ID to EditProductName](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image17.png)](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image16.png)</span></span>

<span data-ttu-id="0bcbb-193">**図 6**: テキストボックスの `ID` を `EditProductName` に変更する ([クリックすると、フルサイズの画像が表示](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image18.png)されます)</span><span class="sxs-lookup"><span data-stu-id="0bcbb-193">**Figure 6**: Change the TextBox's `ID` to `EditProductName` ([Click to view full-size image](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image18.png))</span></span>

<span data-ttu-id="0bcbb-194">次に、RequiredFieldValidator の `ControlToValidate` プロパティを `EditProductName`に設定します。</span><span class="sxs-lookup"><span data-stu-id="0bcbb-194">Next, set the RequiredFieldValidator's `ControlToValidate` property to `EditProductName`.</span></span> <span data-ttu-id="0bcbb-195">最後に、 [ErrorMessage プロパティ](https://msdn.microsoft.com/library/system.web.ui.webcontrols.basevalidator.errormessage(VS.80).aspx)を "製品の名前を指定する必要があります" と[Text プロパティ](https://msdn.microsoft.com/library/system.web.ui.webcontrols.basevalidator.text(VS.80).aspx)を "\*" に設定します。</span><span class="sxs-lookup"><span data-stu-id="0bcbb-195">Finally, set the [ErrorMessage property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.basevalidator.errormessage(VS.80).aspx) to "You must provide the product's name" and the [Text property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.basevalidator.text(VS.80).aspx) to "\*".</span></span> <span data-ttu-id="0bcbb-196">`Text` プロパティ値 (指定されている場合) は、検証が失敗した場合に検証コントロールによって表示されるテキストです。</span><span class="sxs-lookup"><span data-stu-id="0bcbb-196">The `Text` property value, if provided, is the text that is displayed by the validation control if the validation fails.</span></span> <span data-ttu-id="0bcbb-197">必須である `ErrorMessage` プロパティ値は、ValidationSummary コントロールによって使用されます。`Text` プロパティ値を省略した場合、`ErrorMessage` プロパティ値は、無効な入力に対して検証コントロールによって表示されるテキストでもあります。</span><span class="sxs-lookup"><span data-stu-id="0bcbb-197">The `ErrorMessage` property value, which is required, is used by the ValidationSummary control; if the `Text` property value is omitted, the `ErrorMessage` property value is also the text displayed by the validation control on invalid input.</span></span>

<span data-ttu-id="0bcbb-198">RequiredFieldValidator の3つのプロパティを設定した後、画面は図7のようになります。</span><span class="sxs-lookup"><span data-stu-id="0bcbb-198">After setting these three properties of the RequiredFieldValidator, your screen should look similar to Figure 7.</span></span>

<span data-ttu-id="0bcbb-199">[RequiredFieldValidator の ControlToValidate、ErrorMessage、および Text プロパティを設定 ![には](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image20.png)](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="0bcbb-199">[![Set the RequiredFieldValidator's ControlToValidate, ErrorMessage, and Text Properties](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image20.png)](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image19.png)</span></span>

<span data-ttu-id="0bcbb-200">**図 7**: RequiredFieldValidator の `ControlToValidate`、`ErrorMessage`、および `Text` の各プロパティを設定[する (クリックすると、フルサイズの画像が表示](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image21.png)されます)</span><span class="sxs-lookup"><span data-stu-id="0bcbb-200">**Figure 7**: Set the RequiredFieldValidator's `ControlToValidate`, `ErrorMessage`, and `Text` Properties ([Click to view full-size image](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image21.png))</span></span>

<span data-ttu-id="0bcbb-201">`ProductName` `EditItemTemplate`に追加された RequiredFieldValidator を使用すると、必要な検証が `UnitPrice` `EditItemTemplate`に追加されます。</span><span class="sxs-lookup"><span data-stu-id="0bcbb-201">With the RequiredFieldValidator added to the `ProductName` `EditItemTemplate`, all that remains is to add the necessary validation to the `UnitPrice` `EditItemTemplate`.</span></span> <span data-ttu-id="0bcbb-202">このページでは、`UnitPrice` はレコードを編集するときには省略可能であると判断したため、RequiredFieldValidator を追加する必要はありません。</span><span class="sxs-lookup"><span data-stu-id="0bcbb-202">Since we've decided that, for this page, the `UnitPrice` is optional when editing a record, we don't need to add a RequiredFieldValidator.</span></span> <span data-ttu-id="0bcbb-203">ただし、CompareValidator を追加して、指定されている場合は、`UnitPrice`が通貨として正しく書式設定され、0以上であることを確認する必要があります。</span><span class="sxs-lookup"><span data-stu-id="0bcbb-203">We do, however, need to add a CompareValidator to ensure that the `UnitPrice`, if supplied, is properly formatted as a currency and is greater than or equal to 0.</span></span>

<span data-ttu-id="0bcbb-204">`UnitPrice` `EditItemTemplate`に CompareValidator を追加する前に、まず、TextBox Web コントロールの ID を `TextBox2` から `EditUnitPrice`に変更してみましょう。</span><span class="sxs-lookup"><span data-stu-id="0bcbb-204">Before we add the CompareValidator to the `UnitPrice` `EditItemTemplate`, let's first change the TextBox Web control's ID from `TextBox2` to `EditUnitPrice`.</span></span> <span data-ttu-id="0bcbb-205">この変更を行った後、CompareValidator を追加し、その `ControlToValidate` プロパティを `EditUnitPrice`に設定します。その `ErrorMessage` プロパティを「0以上である必要があり、通貨記号を含めることはできません」と `Text` プロパティを「\*」に設定します。</span><span class="sxs-lookup"><span data-stu-id="0bcbb-205">After making this change, add the CompareValidator, setting its `ControlToValidate` property to `EditUnitPrice`, its `ErrorMessage` property to "The price must be greater than or equal to zero and cannot include the currency symbol", and its `Text` property to "\*".</span></span>

<span data-ttu-id="0bcbb-206">`UnitPrice` 値が0以上である必要があることを示すには、CompareValidator の[Operator プロパティ](https://msdn.microsoft.com/library/system.web.ui.webcontrols.comparevalidator.operator(VS.80).aspx)を `GreaterThanEqual`に、 [valuetocompare プロパティ](https://msdn.microsoft.com/library/system.web.ui.webcontrols.comparevalidator.valuetocompare(VS.80).aspx)を "0" に設定し、その[Type プロパティ](https://msdn.microsoft.com/library/system.web.ui.webcontrols.basecomparevalidator.type.aspx)を `Currency`に設定します。</span><span class="sxs-lookup"><span data-stu-id="0bcbb-206">To indicate that the `UnitPrice` value must be greater than or equal to 0, set the CompareValidator's [Operator property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.comparevalidator.operator(VS.80).aspx) to `GreaterThanEqual`, its [ValueToCompare property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.comparevalidator.valuetocompare(VS.80).aspx) to "0", and its [Type property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.basecomparevalidator.type.aspx) to `Currency`.</span></span> <span data-ttu-id="0bcbb-207">次の宣言構文は、これらの変更が加えられた後の `UnitPrice` TemplateField の `EditItemTemplate` を示しています。</span><span class="sxs-lookup"><span data-stu-id="0bcbb-207">The following declarative syntax shows the `UnitPrice` TemplateField's `EditItemTemplate` after these changes have been made:</span></span>

[!code-aspx[Main](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/samples/sample3.aspx)]

<span data-ttu-id="0bcbb-208">これらの変更を行った後、ブラウザーでページを開きます。</span><span class="sxs-lookup"><span data-stu-id="0bcbb-208">After making these changes, open the page in a browser.</span></span> <span data-ttu-id="0bcbb-209">製品を編集するときに名前を省略したり、無効な価格値を入力しようとしたりすると、テキストボックスの横にアスタリスクが表示されます。</span><span class="sxs-lookup"><span data-stu-id="0bcbb-209">If you attempt to omit the name or enter an invalid price value when editing a product, an asterisk appears next to the textbox.</span></span> <span data-ttu-id="0bcbb-210">図8に示すように、$19.95 などの通貨記号を含む価格値は無効と見なされます。</span><span class="sxs-lookup"><span data-stu-id="0bcbb-210">As Figure 8 shows, a price value that includes the currency symbol such as $19.95 is considered invalid.</span></span> <span data-ttu-id="0bcbb-211">CompareValidator の `Currency` `Type` では、桁区切り記号 (カルチャの設定によってはコンマやピリオドなど) と先頭の正符号または負符号を使用できますが、通貨記号は許可*されません*。</span><span class="sxs-lookup"><span data-stu-id="0bcbb-211">The CompareValidator's `Currency` `Type` allows for digit separators (such as commas or periods, depending on the culture settings) and a leading plus or minus sign, but does *not* permit a currency symbol.</span></span> <span data-ttu-id="0bcbb-212">この動作は、現在、編集インターフェイスが通貨書式を使用して `UnitPrice` を表示するときに、ユーザーによって変更される可能性があります。</span><span class="sxs-lookup"><span data-stu-id="0bcbb-212">This behavior may perplex users as the editing interface currently renders the `UnitPrice` using the currency format.</span></span>

> [!NOTE]
> <span data-ttu-id="0bcbb-213">*挿入、更新、および削除のチュートリアルに関連付けられ*ているイベントで、BoundField の `DataFormatString` プロパティを `{0:c}` に設定して、通貨として書式設定することを思い出してください。</span><span class="sxs-lookup"><span data-stu-id="0bcbb-213">Recall that in the *Events Associated with Inserting, Updating, and Deleting* tutorial we set the BoundField's `DataFormatString` property to `{0:c}` in order to format it as a currency.</span></span> <span data-ttu-id="0bcbb-214">さらに、`ApplyFormatInEditMode` プロパティを true に設定すると、GridView の編集インターフェイスによって `UnitPrice` が通貨として書式設定されます。</span><span class="sxs-lookup"><span data-stu-id="0bcbb-214">Furthermore, we set the `ApplyFormatInEditMode` property to true, causing the GridView's editing interface to format the `UnitPrice` as a currency.</span></span> <span data-ttu-id="0bcbb-215">BoundField を TemplateField に変換すると、Visual Studio はこれらの設定を書き留め、データバインド構文 `<%# Bind("UnitPrice", "{0:c}") %>`を使用して、テキストボックスの `Text` プロパティを通貨として書式設定します。</span><span class="sxs-lookup"><span data-stu-id="0bcbb-215">When converting the BoundField into a TemplateField, Visual Studio noted these settings and formatted the TextBox's `Text` property as a currency using the databinding syntax `<%# Bind("UnitPrice", "{0:c}") %>`.</span></span>

<span data-ttu-id="0bcbb-216">[無効な入力のテキストボックスの横にアスタリスクが表示され ![](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image23.png)](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image22.png)</span><span class="sxs-lookup"><span data-stu-id="0bcbb-216">[![An Asterisk Appears Next to the Textboxes with Invalid Input](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image23.png)](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image22.png)</span></span>

<span data-ttu-id="0bcbb-217">**図 8**: 無効な入力のテキストボックスの横にアスタリスクが表示される ([クリックすると、フルサイズの画像が表示](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image24.png)されます)</span><span class="sxs-lookup"><span data-stu-id="0bcbb-217">**Figure 8**: An Asterisk Appears Next to the Textboxes with Invalid Input ([Click to view full-size image](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image24.png))</span></span>

<span data-ttu-id="0bcbb-218">検証はそのままの状態で機能しますが、ユーザーはレコードを編集するときに通貨記号を手動で削除する必要があります。これは許容できません。</span><span class="sxs-lookup"><span data-stu-id="0bcbb-218">While the validation works as-is, the user has to manually remove the currency symbol when editing a record, which is not acceptable.</span></span> <span data-ttu-id="0bcbb-219">これを解決するには、次の3つのオプションがあります。</span><span class="sxs-lookup"><span data-stu-id="0bcbb-219">To remedy this, we have three options:</span></span>

1. <span data-ttu-id="0bcbb-220">`UnitPrice` の値が通貨として書式設定されないように `EditItemTemplate` を構成します。</span><span class="sxs-lookup"><span data-stu-id="0bcbb-220">Configure the `EditItemTemplate` so that the `UnitPrice` value is not formatted as a currency.</span></span>
2. <span data-ttu-id="0bcbb-221">ユーザーが通貨記号を入力できるようにするには、CompareValidator を削除し、適切に書式設定された通貨値を適切にチェックする RegularExpressionValidator に置き換えます。</span><span class="sxs-lookup"><span data-stu-id="0bcbb-221">Allow the user to enter a currency symbol by removing the CompareValidator and replacing it with a RegularExpressionValidator that properly checks for a properly formatted currency value.</span></span> <span data-ttu-id="0bcbb-222">ここでの問題は、通貨の値を検証する正規表現が、カルチャの設定を組み込む必要がある場合にコードを記述しなければならないということです。</span><span class="sxs-lookup"><span data-stu-id="0bcbb-222">The problem here is that the regular expression to validate a currency value is not pretty and would require writing code if we wanted to incorporate culture settings.</span></span>
3. <span data-ttu-id="0bcbb-223">検証コントロールを完全に削除し、GridView の `RowUpdating` イベントハンドラーでサーバー側の検証ロジックに依存します。</span><span class="sxs-lookup"><span data-stu-id="0bcbb-223">Remove the validation control altogether and rely on server-side validation logic in the GridView's `RowUpdating` event handler.</span></span>

<span data-ttu-id="0bcbb-224">この演習では、オプション #1 に移りましょう。</span><span class="sxs-lookup"><span data-stu-id="0bcbb-224">Let's go with option #1 for this exercise.</span></span> <span data-ttu-id="0bcbb-225">現在、`UnitPrice` は、`EditItemTemplate`: `<%# Bind("UnitPrice", "{0:c}") %>`のテキストボックスのデータバインド式により、通貨として書式設定されます。</span><span class="sxs-lookup"><span data-stu-id="0bcbb-225">Currently the `UnitPrice` is formatted as a currency due to the databinding expression for the TextBox in the `EditItemTemplate`: `<%# Bind("UnitPrice", "{0:c}") %>`.</span></span> <span data-ttu-id="0bcbb-226">Bind ステートメントを `Bind("UnitPrice", "{0:n2}")`に変更します。これにより、結果が2桁の精度で数値として書式設定されます。</span><span class="sxs-lookup"><span data-stu-id="0bcbb-226">Change the Bind statement to `Bind("UnitPrice", "{0:n2}")`, which formats the result as a number with two digits of precision.</span></span> <span data-ttu-id="0bcbb-227">これを行うには、宣言型の構文を使用するか、`UnitPrice` TemplateField の `EditItemTemplate` の [`EditUnitPrice`] ボックスの [連結の編集] リンクをクリックします (図9と10を参照)。</span><span class="sxs-lookup"><span data-stu-id="0bcbb-227">This can be done directly through the declarative syntax or by clicking on the Edit DataBindings link from the `EditUnitPrice` TextBox in the `UnitPrice` TemplateField's `EditItemTemplate` (see Figures 9 and 10).</span></span>

<span data-ttu-id="0bcbb-228">[テキストボックスの [連結の編集] リンクをクリック ![ます。](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image26.png)](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image25.png)</span><span class="sxs-lookup"><span data-stu-id="0bcbb-228">[![Click on the TextBox's Edit DataBindings link](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image26.png)](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image25.png)</span></span>

<span data-ttu-id="0bcbb-229">**図 9**: テキストボックスの [相互接続の編集] リンクをクリック[する (クリックすると、フルサイズの画像が表示](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image27.png)されます)</span><span class="sxs-lookup"><span data-stu-id="0bcbb-229">**Figure 9**: Click on the TextBox's Edit DataBindings link ([Click to view full-size image](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image27.png))</span></span>

<span data-ttu-id="0bcbb-230">[![、バインドステートメントで書式指定子を指定します。](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image29.png)](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image28.png)</span><span class="sxs-lookup"><span data-stu-id="0bcbb-230">[![Specify the Format Specifier in the Bind Statement](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image29.png)](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image28.png)</span></span>

<span data-ttu-id="0bcbb-231">**図 10**: `Bind` ステートメントで書式指定子を指定[する (クリックしてフルサイズのイメージを表示する](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image30.png))</span><span class="sxs-lookup"><span data-stu-id="0bcbb-231">**Figure 10**: Specify the Format Specifier in the `Bind` Statement ([Click to view full-size image](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image30.png))</span></span>

<span data-ttu-id="0bcbb-232">この変更により、編集インターフェイスの書式設定された価格には、桁区切り記号としてコンマが、小数点区切り文字としてピリオドが付きますが、通貨記号はオフのままになります。</span><span class="sxs-lookup"><span data-stu-id="0bcbb-232">With this change, the formatted price in the editing interface includes commas as the group separator and a period as the decimal separator, but leaves off the currency symbol.</span></span>

> [!NOTE]
> <span data-ttu-id="0bcbb-233">`UnitPrice` `EditItemTemplate` には RequiredFieldValidator が含まれていないため、議論にポストバックし、更新ロジックを開始することができます。</span><span class="sxs-lookup"><span data-stu-id="0bcbb-233">The `UnitPrice` `EditItemTemplate` doesn't include a RequiredFieldValidator, allowing the postback to ensue and the updating logic to commence.</span></span> <span data-ttu-id="0bcbb-234">ただし、「*挿入、更新、および削除」チュートリアルに関連付けられているイベントを調べ*てからコピーした `RowUpdating` イベントハンドラーには、`UnitPrice` が確実に提供されるようにプログラムによる確認が含まれています。</span><span class="sxs-lookup"><span data-stu-id="0bcbb-234">However, the `RowUpdating` event handler copied over from the *Examining the Events Associated with Inserting, Updating, and Deleting* tutorial includes a programmatic check that ensures that the `UnitPrice` is provided.</span></span> <span data-ttu-id="0bcbb-235">このロジックを削除するか、そのままにしておくか、`UnitPrice` `EditItemTemplate`に RequiredFieldValidator を追加してください。</span><span class="sxs-lookup"><span data-stu-id="0bcbb-235">Feel free to remove this logic, leave it in as-is, or add a RequiredFieldValidator to the `UnitPrice` `EditItemTemplate`.</span></span>

## <a name="step-4-summarizing-data-entry-problems"></a><span data-ttu-id="0bcbb-236">手順 4: データ入力の問題の概要</span><span class="sxs-lookup"><span data-stu-id="0bcbb-236">Step 4: Summarizing Data Entry Problems</span></span>

<span data-ttu-id="0bcbb-237">5つの検証コントロールに加えて、ASP.NET には[Validationsummary コントロール](https://msdn.microsoft.com/library/f9h59855(VS.80).aspx)が含まれています。このコントロールには、無効なデータを検出した検証コントロールの `ErrorMessage` が表示されます。</span><span class="sxs-lookup"><span data-stu-id="0bcbb-237">In addition to the five validation controls, ASP.NET includes the [ValidationSummary control](https://msdn.microsoft.com/library/f9h59855(VS.80).aspx), which displays the `ErrorMessage` s of those validation controls that detected invalid data.</span></span> <span data-ttu-id="0bcbb-238">この概要データは、web ページ上のテキストとして、またはモーダルのクライアント側のメッセージボックスを使用して表示できます。</span><span class="sxs-lookup"><span data-stu-id="0bcbb-238">This summary data can be displayed as text on the web page or through a modal, client-side messagebox.</span></span> <span data-ttu-id="0bcbb-239">このチュートリアルを強化し、検証の問題を要約するクライアント側のメッセージボックスを追加してみましょう。</span><span class="sxs-lookup"><span data-stu-id="0bcbb-239">Let's enhance this tutorial to include a client-side messagebox summarizing any validation problems.</span></span>

<span data-ttu-id="0bcbb-240">これを実現するには、[ツールボックス] から [ValidationSummary] コントロールをデザイナーにドラッグします。</span><span class="sxs-lookup"><span data-stu-id="0bcbb-240">To accomplish this, drag a ValidationSummary control from the Toolbox onto the Designer.</span></span> <span data-ttu-id="0bcbb-241">検証コントロールの場所は、概要を messagebox としてのみ表示するように構成するため、本当に重要ではありません。</span><span class="sxs-lookup"><span data-stu-id="0bcbb-241">The location of the Validation control doesn't really matter, since we're going to configure it to only display the summary as a messagebox.</span></span> <span data-ttu-id="0bcbb-242">コントロールを追加した後、 [Showsummary プロパティ](https://msdn.microsoft.com/library/system.web.ui.webcontrols.validationsummary.showsummary(VS.80).aspx)を `False` に設定し、 [showsummary プロパティ](https://msdn.microsoft.com/library/system.web.ui.webcontrols.validationsummary.showmessagebox(VS.80).aspx)を `True`に設定します。</span><span class="sxs-lookup"><span data-stu-id="0bcbb-242">After adding the control, set its [ShowSummary property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.validationsummary.showsummary(VS.80).aspx) to `False` and its [ShowMessageBox property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.validationsummary.showmessagebox(VS.80).aspx) to `True`.</span></span> <span data-ttu-id="0bcbb-243">この追加により、すべての検証エラーがクライアント側のメッセージボックスにまとめられます。</span><span class="sxs-lookup"><span data-stu-id="0bcbb-243">With this addition, any validation errors are summarized in a client-side messagebox.</span></span>

<span data-ttu-id="0bcbb-244">[検証エラーがクライアント側のメッセージボックスにまとめられている ![](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image32.png)](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image31.png)</span><span class="sxs-lookup"><span data-stu-id="0bcbb-244">[![The Validation Errors are Summarized in a Client-Side Messagebox](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image32.png)](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image31.png)</span></span>

<span data-ttu-id="0bcbb-245">**図 11**: 検証エラーがクライアント側のメッセージボックスにまとめられている ([クリックしてフルサイズのイメージを表示する](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image33.png))</span><span class="sxs-lookup"><span data-stu-id="0bcbb-245">**Figure 11**: The Validation Errors are Summarized in a Client-Side Messagebox ([Click to view full-size image](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image33.png))</span></span>

## <a name="step-5-adding-the-validation-controls-to-the-detailsviewsinsertitemtemplate"></a><span data-ttu-id="0bcbb-246">手順 5: DetailsView の`InsertItemTemplate` に検証コントロールを追加する</span><span class="sxs-lookup"><span data-stu-id="0bcbb-246">Step 5: Adding the Validation Controls to the DetailsView's`InsertItemTemplate`</span></span>

<span data-ttu-id="0bcbb-247">このチュートリアルでは、検証コントロールを DetailsView の挿入インターフェイスに追加します。</span><span class="sxs-lookup"><span data-stu-id="0bcbb-247">All that remains for this tutorial is to add the validation controls to the DetailsView's inserting interface.</span></span> <span data-ttu-id="0bcbb-248">DetailsView のテンプレートに検証コントロールを追加するプロセスは、手順3で確認したものと同じです。このため、この手順では簡単に説明します。</span><span class="sxs-lookup"><span data-stu-id="0bcbb-248">The process of adding validation controls to the DetailsView's templates is identical to that examined in Step 3; therefore, we'll breeze through the task in this step.</span></span> <span data-ttu-id="0bcbb-249">GridView の `EditItemTemplate` で行ったように、テキストボックスの `ID` の名前を nondescript `TextBox1` から `InsertProductName` に変更し、`TextBox2` することをお勧めします。</span><span class="sxs-lookup"><span data-stu-id="0bcbb-249">As we did with the GridView's `EditItemTemplate` s, I encourage you to rename the `ID` s of the TextBoxes from the nondescript `TextBox1` and `TextBox2` to `InsertProductName` and `InsertUnitPrice`.</span></span>

<span data-ttu-id="0bcbb-250">`ProductName` `InsertItemTemplate`に RequiredFieldValidator を追加します。</span><span class="sxs-lookup"><span data-stu-id="0bcbb-250">Add a RequiredFieldValidator to the `ProductName` `InsertItemTemplate`.</span></span> <span data-ttu-id="0bcbb-251">`ControlToValidate` を、テンプレートのテキストボックスの `ID` に設定し、その `Text` プロパティを "\*" に設定し、その `ErrorMessage` プロパティを「製品の名前を指定する必要があります」に設定します。</span><span class="sxs-lookup"><span data-stu-id="0bcbb-251">Set the `ControlToValidate` to the `ID` of the TextBox in the template, its `Text` property to "\*" and its `ErrorMessage` property to "You must provide the product's name".</span></span>

<span data-ttu-id="0bcbb-252">新しいレコードを追加するときにこのページに `UnitPrice` が必要になるため、`UnitPrice` `InsertItemTemplate`に RequiredFieldValidator を追加し、その `ControlToValidate`、`Text`、および `ErrorMessage` の各プロパティを適切に設定します。</span><span class="sxs-lookup"><span data-stu-id="0bcbb-252">Since the `UnitPrice` is required for this page when adding a new record, add a RequiredFieldValidator to the `UnitPrice` `InsertItemTemplate`, setting its `ControlToValidate`, `Text`, and `ErrorMessage` properties appropriately.</span></span> <span data-ttu-id="0bcbb-253">最後に、CompareValidator を `UnitPrice` `InsertItemTemplate` に追加して、`ControlToValidate`、`Text`、`ErrorMessage`、`Type`、`Operator`、および `ValueToCompare` の各プロパティを構成します。これは、GridView の `UnitPrice`で `EditItemTemplate`の CompareValidator を使用したのと同じです。</span><span class="sxs-lookup"><span data-stu-id="0bcbb-253">Finally, add a CompareValidator to the `UnitPrice` `InsertItemTemplate` as well, configuring its `ControlToValidate`, `Text`, `ErrorMessage`, `Type`, `Operator`, and `ValueToCompare` properties just like we did with the `UnitPrice`'s CompareValidator in the GridView's `EditItemTemplate`.</span></span>

<span data-ttu-id="0bcbb-254">これらの検証コントロールを追加した後、名前が指定されていない場合、またはその価格が負の数値または不適切な形式である場合、システムに新しい製品を追加することはできません。</span><span class="sxs-lookup"><span data-stu-id="0bcbb-254">After adding these validation controls, a new product cannot be added to the system if its name is not supplied or if its price is a negative number or illegally formatted.</span></span>

<span data-ttu-id="0bcbb-255">[![検証ロジックが DetailsView の挿入インターフェイスに追加されました](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image35.png)](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image34.png)</span><span class="sxs-lookup"><span data-stu-id="0bcbb-255">[![Validation Logic has been Added to the DetailsView's Inserting Interface](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image35.png)](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image34.png)</span></span>

<span data-ttu-id="0bcbb-256">**図 12**: DetailsView の挿入インターフェイスに検証ロジックが追加されました ([クリックすると、フルサイズのイメージが表示](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image36.png)されます)</span><span class="sxs-lookup"><span data-stu-id="0bcbb-256">**Figure 12**: Validation Logic has been Added to the DetailsView's Inserting Interface ([Click to view full-size image](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image36.png))</span></span>

## <a name="step-6-partitioning-the-validation-controls-into-validation-groups"></a><span data-ttu-id="0bcbb-257">手順 6: 検証コントロールを検証グループに分割する</span><span class="sxs-lookup"><span data-stu-id="0bcbb-257">Step 6: Partitioning the Validation Controls Into Validation Groups</span></span>

<span data-ttu-id="0bcbb-258">このページは、論理的に異なる2つの検証コントロールセットで構成されています。これは、GridView の編集インターフェイスに対応するものと、DetailsView の挿入インターフェイスに対応するものです。</span><span class="sxs-lookup"><span data-stu-id="0bcbb-258">Our page consists of two logically disparate sets of validation controls: those that correspond to the GridView's editing interface and those that correspond to the DetailsView's inserting interface.</span></span> <span data-ttu-id="0bcbb-259">既定では、ポストバックが発生すると、ページ上の*すべて*の検証コントロールがチェックされます。</span><span class="sxs-lookup"><span data-stu-id="0bcbb-259">By default, when a postback occurs *all* validation controls on the page are checked.</span></span> <span data-ttu-id="0bcbb-260">ただし、レコードを編集するときに、DetailsView の挿入インターフェイスの検証コントロールで検証を行わないようにします。</span><span class="sxs-lookup"><span data-stu-id="0bcbb-260">However, when editing a record we don't want the DetailsView's inserting interface's validation controls to validate.</span></span> <span data-ttu-id="0bcbb-261">図13は、ユーザーが完全に有効な値を持つ製品を編集しているときの現在のジレンマを示しています。 [更新] をクリックすると、挿入インターフェイスの名前と価格値が空白になっているため、検証エラーが発生します。</span><span class="sxs-lookup"><span data-stu-id="0bcbb-261">Figure 13 illustrates our current dilemma when a user is editing a product with perfectly legal values, clicking Update causes a validation error because the name and price values in the inserting interface are blank.</span></span>

<span data-ttu-id="0bcbb-262">[製品を更新 ![と、挿入インターフェイスの検証コントロールが起動されます。](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image38.png)](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image37.png)</span><span class="sxs-lookup"><span data-stu-id="0bcbb-262">[![Updating a Product Causes the Inserting Interface's Validation Controls to Fire](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image38.png)](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image37.png)</span></span>

<span data-ttu-id="0bcbb-263">**図 13**: 製品を更新すると、挿入インターフェイスの検証コントロールが起動します ([クリックすると、フルサイズのイメージが表示](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image39.png)されます)</span><span class="sxs-lookup"><span data-stu-id="0bcbb-263">**Figure 13**: Updating a Product Causes the Inserting Interface's Validation Controls to Fire ([Click to view full-size image](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image39.png))</span></span>

<span data-ttu-id="0bcbb-264">ASP.NET 2.0 の検証コントロールは、`ValidationGroup` プロパティを使用して検証グループにパーティション分割できます。</span><span class="sxs-lookup"><span data-stu-id="0bcbb-264">The validation controls in ASP.NET 2.0 can be partitioned into validation groups through their `ValidationGroup` property.</span></span> <span data-ttu-id="0bcbb-265">グループ内の一連の検証コントロールを関連付けるには、単に `ValidationGroup` プロパティを同じ値に設定します。</span><span class="sxs-lookup"><span data-stu-id="0bcbb-265">To associate a set of validation controls in a group, simply set their `ValidationGroup` property to the same value.</span></span> <span data-ttu-id="0bcbb-266">このチュートリアルでは、GridView の TemplateFields フィールドの検証コントロールの `ValidationGroup` プロパティを `EditValidationControls` に設定し、DetailsView の TemplateFields の `ValidationGroup` プロパティを `InsertValidationControls`に設定します。</span><span class="sxs-lookup"><span data-stu-id="0bcbb-266">For our tutorial, set the `ValidationGroup` properties of the validation controls in the GridView's TemplateFields to `EditValidationControls` and the `ValidationGroup` properties of the DetailsView's TemplateFields to `InsertValidationControls`.</span></span> <span data-ttu-id="0bcbb-267">これらの変更は、宣言マークアップで直接行うことも、デザイナーのテンプレートの編集インターフェイスを使用する場合はプロパティウィンドウを使用して行うこともできます。</span><span class="sxs-lookup"><span data-stu-id="0bcbb-267">These changes can be done directly in the declarative markup or through the Properties window when using the Designer's edit template interface.</span></span>

<span data-ttu-id="0bcbb-268">検証コントロールに加えて、ASP.NET 2.0 のボタンおよびボタン関連のコントロールには `ValidationGroup` プロパティも含まれています。</span><span class="sxs-lookup"><span data-stu-id="0bcbb-268">In addition to the validation controls, the Button and Button-related controls in ASP.NET 2.0 also include a `ValidationGroup` property.</span></span> <span data-ttu-id="0bcbb-269">検証グループの検証コントロールは、同じ `ValidationGroup` プロパティ設定を持つボタンによってポストバックが発生した場合にのみ、有効性がチェックされます。</span><span class="sxs-lookup"><span data-stu-id="0bcbb-269">A validation group's validators are checked for validity only when a postback is induced by a Button that has the same `ValidationGroup` property setting.</span></span> <span data-ttu-id="0bcbb-270">たとえば、DetailsView の Insert ボタンを使用して `InsertValidationControls` 検証グループをトリガーするには、CommandField の `ValidationGroup` プロパティを `InsertValidationControls` に設定する必要があります (図14を参照)。</span><span class="sxs-lookup"><span data-stu-id="0bcbb-270">For example, in order for the DetailsView's Insert button to trigger the `InsertValidationControls` validation group we need to set the CommandField's `ValidationGroup` property to `InsertValidationControls` (see Figure 14).</span></span> <span data-ttu-id="0bcbb-271">さらに、GridView の CommandField's `ValidationGroup` プロパティを `EditValidationControls`に設定します。</span><span class="sxs-lookup"><span data-stu-id="0bcbb-271">Additionally, set the GridView's CommandField's `ValidationGroup` property to `EditValidationControls`.</span></span>

<span data-ttu-id="0bcbb-272">[DetailsView の CommandField's ValidationGroup プロパティを InsertValidationControls に設定 ![](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image41.png)](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image40.png)</span><span class="sxs-lookup"><span data-stu-id="0bcbb-272">[![Set the DetailsView's CommandField's ValidationGroup property to InsertValidationControls](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image41.png)](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image40.png)</span></span>

<span data-ttu-id="0bcbb-273">**図 14**: DetailsView の commandfield's `ValidationGroup` プロパティを `InsertValidationControls` に設定する ([クリックすると、フルサイズの画像が表示](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image42.png)されます)</span><span class="sxs-lookup"><span data-stu-id="0bcbb-273">**Figure 14**: Set the DetailsView's CommandField's `ValidationGroup` property to `InsertValidationControls` ([Click to view full-size image](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image42.png))</span></span>

<span data-ttu-id="0bcbb-274">これらの変更が完了すると、DetailsView および GridView の TemplateFields および CommandFields は次のようになります。</span><span class="sxs-lookup"><span data-stu-id="0bcbb-274">After these changes, the DetailsView and GridView's TemplateFields and CommandFields should look similar to the following:</span></span>

<span data-ttu-id="0bcbb-275">DetailsView の TemplateFields および CommandField</span><span class="sxs-lookup"><span data-stu-id="0bcbb-275">The DetailsView's TemplateFields and CommandField</span></span>

[!code-aspx[Main](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/samples/sample4.aspx)]

<span data-ttu-id="0bcbb-276">GridView の CommandField フィールドと TemplateFields</span><span class="sxs-lookup"><span data-stu-id="0bcbb-276">The GridView's CommandField and TemplateFields</span></span>

[!code-aspx[Main](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/samples/sample5.aspx)]

<span data-ttu-id="0bcbb-277">この時点で、編集固有の検証コントロールは、GridView の [更新] ボタンがクリックされ、DetailsView の [挿入] ボタンがクリックされたときにのみ、挿入固有の検証コントロールが起動し、図13で強調表示されている問題を解決します。</span><span class="sxs-lookup"><span data-stu-id="0bcbb-277">At this point the edit-specific validation controls fire only when the GridView's Update button is clicked and the insert-specific validation controls fire only when the DetailsView's Insert button is clicked, resolving the problem highlighted by Figure 13.</span></span> <span data-ttu-id="0bcbb-278">ただし、この変更により、無効なデータを入力したときに ValidationSummary コントロールが表示されなくなりました。</span><span class="sxs-lookup"><span data-stu-id="0bcbb-278">However, with this change our ValidationSummary control no longer displays when entering invalid data.</span></span> <span data-ttu-id="0bcbb-279">ValidationSummary コントロールには、`ValidationGroup` プロパティも含まれており、検証グループ内の検証コントロールの概要情報のみが表示されます。</span><span class="sxs-lookup"><span data-stu-id="0bcbb-279">The ValidationSummary control also contains a `ValidationGroup` property and only shows summary information for those validation controls in its validation group.</span></span> <span data-ttu-id="0bcbb-280">したがって、このページには、`InsertValidationControls` 検証グループ用と `EditValidationControls`用の2つの検証コントロールが必要です。</span><span class="sxs-lookup"><span data-stu-id="0bcbb-280">Therefore, we need to have two validation controls in this page, one for the `InsertValidationControls` validation group and one for `EditValidationControls`.</span></span>

[!code-aspx[Main](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/samples/sample6.aspx)]

<span data-ttu-id="0bcbb-281">この追加により、チュートリアルは完了です。</span><span class="sxs-lookup"><span data-stu-id="0bcbb-281">With this addition our tutorial is complete!</span></span>

## <a name="summary"></a><span data-ttu-id="0bcbb-282">要約</span><span class="sxs-lookup"><span data-stu-id="0bcbb-282">Summary</span></span>

<span data-ttu-id="0bcbb-283">BoundFields は挿入と編集の両方のインターフェイスを提供できますが、インターフェイスはカスタマイズできません。</span><span class="sxs-lookup"><span data-stu-id="0bcbb-283">While BoundFields can provide both an inserting and editing interface, the interface is not customizable.</span></span> <span data-ttu-id="0bcbb-284">一般的には、ユーザーが必要な入力を正しい形式で入力できるように、編集および挿入インターフェイスに検証コントロールを追加します。</span><span class="sxs-lookup"><span data-stu-id="0bcbb-284">Commonly, we want to add validation controls to the editing and inserting interface to ensure that the user enters required inputs in a legal format.</span></span> <span data-ttu-id="0bcbb-285">これを実現するには、BoundFields を TemplateFields に変換し、適切なテンプレートに検証コントロールを追加する必要があります。</span><span class="sxs-lookup"><span data-stu-id="0bcbb-285">To accomplish this we must convert the BoundFields into TemplateFields and add the validation controls to the appropriate template(s).</span></span> <span data-ttu-id="0bcbb-286">このチュートリアルでは、「*挿入、更新、および削除」チュートリアルに関連付けられているイベントを調べ*、DetailsView の挿入インターフェイスと GridView の編集インターフェイスの両方に検証コントロールを追加して、この例を拡張しています。</span><span class="sxs-lookup"><span data-stu-id="0bcbb-286">In this tutorial we extended the example from the *Examining the Events Associated with Inserting, Updating, and Deleting* tutorial, adding validation controls to both the DetailsView's inserting interface and the GridView's editing interface.</span></span> <span data-ttu-id="0bcbb-287">さらに、ValidationSummary コントロールを使用して概要検証情報を表示する方法と、ページ上の検証コントロールを個別の検証グループに分割する方法についても説明しました。</span><span class="sxs-lookup"><span data-stu-id="0bcbb-287">Moreover, we saw how to display summary validation information using the ValidationSummary control and how to partition the validation controls on the page into distinct validation groups.</span></span>

<span data-ttu-id="0bcbb-288">このチュートリアルで説明したように、TemplateFields を使用すると、編集および挿入インターフェイスを拡張して検証コントロールを含めることができます。</span><span class="sxs-lookup"><span data-stu-id="0bcbb-288">As we saw in this tutorial, TemplateFields allow the editing and inserting interfaces to be augmented to include validation controls.</span></span> <span data-ttu-id="0bcbb-289">TemplateFields を拡張して追加の入力 Web コントロールを含めることもできます。これにより、テキストボックスをより適切な Web コントロールに置き換えることができます。</span><span class="sxs-lookup"><span data-stu-id="0bcbb-289">TemplateFields can also be extended to include additional input Web controls, enabling the TextBox to be replaced by a more suitable Web control.</span></span> <span data-ttu-id="0bcbb-290">次のチュートリアルでは、テキストボックスコントロールをデータバインド DropDownList コントロールに置き換える方法について説明します。これは、外部キー (`CategoryID`、`Products` テーブル内の `SupplierID` など) を編集する場合に最適です。</span><span class="sxs-lookup"><span data-stu-id="0bcbb-290">In our next tutorial we'll see how to replace the TextBox control with a data-bound DropDownList control, which is ideal when editing a foreign key (such as `CategoryID` or `SupplierID` in the `Products` table).</span></span>

<span data-ttu-id="0bcbb-291">プログラミングを楽しんでください。</span><span class="sxs-lookup"><span data-stu-id="0bcbb-291">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="0bcbb-292">作成者について</span><span class="sxs-lookup"><span data-stu-id="0bcbb-292">About the Author</span></span>

<span data-ttu-id="0bcbb-293">1998以来、 [Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml)は 7 asp/創設者 of [4GuysFromRolla.com](http://www.4guysfromrolla.com)の執筆者であり、Microsoft Web テクノロジを使用しています。</span><span class="sxs-lookup"><span data-stu-id="0bcbb-293">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="0bcbb-294">Scott は、独立したコンサルタント、トレーナー、およびライターとして機能します。</span><span class="sxs-lookup"><span data-stu-id="0bcbb-294">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="0bcbb-295">彼の最新の書籍は[ *、ASP.NET 2.0 を24時間以内に教え*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)ています。</span><span class="sxs-lookup"><span data-stu-id="0bcbb-295">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="0bcbb-296">mitchell@4GuysFromRolla.comでアクセスでき[ます。](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="0bcbb-296">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="0bcbb-297">または彼のブログを参照してください。これは[http://ScottOnWriting.NET](http://ScottOnWriting.NET)にあります。</span><span class="sxs-lookup"><span data-stu-id="0bcbb-297">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="0bcbb-298">ありがとうございました。</span><span class="sxs-lookup"><span data-stu-id="0bcbb-298">Special Thanks To</span></span>

<span data-ttu-id="0bcbb-299">このチュートリアルシリーズは、役に立つ多くのレビュー担当者によってレビューされました。</span><span class="sxs-lookup"><span data-stu-id="0bcbb-299">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="0bcbb-300">このチュートリアルのリードレビュー担当者は、Liz Shulok と Zack Jones でした。</span><span class="sxs-lookup"><span data-stu-id="0bcbb-300">Lead reviewers for this tutorial were Liz Shulok and Zack Jones.</span></span> <span data-ttu-id="0bcbb-301">今後の MSDN 記事を確認することに興味がありますか?</span><span class="sxs-lookup"><span data-stu-id="0bcbb-301">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="0bcbb-302">その場合は、mitchell@4GuysFromRolla.comの行を削除[します。](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="0bcbb-302">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="0bcbb-303">[前へ](handling-bll-and-dal-level-exceptions-in-an-asp-net-page-vb.md)
> [次へ](customizing-the-data-modification-interface-vb.md)</span><span class="sxs-lookup"><span data-stu-id="0bcbb-303">[Previous](handling-bll-and-dal-level-exceptions-in-an-asp-net-page-vb.md)
[Next](customizing-the-data-modification-interface-vb.md)</span></span>

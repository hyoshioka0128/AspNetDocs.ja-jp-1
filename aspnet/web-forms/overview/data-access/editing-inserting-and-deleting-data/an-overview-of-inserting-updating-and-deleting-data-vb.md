---
uid: web-forms/overview/data-access/editing-inserting-and-deleting-data/an-overview-of-inserting-updating-and-deleting-data-vb
title: データの挿入、更新、および削除の概要 (VB) |Microsoft Docs
author: rick-anderson
description: このチュートリアルでは、ObjectDataSource の Insert ()、Update ()、Delete () の各メソッドを BLL クラスのメソッドにマップする方法と、その方法について説明します。
ms.author: riande
ms.date: 07/17/2006
ms.assetid: 35b40b8f-2ca8-4ab3-9c19-f361a91a3647
msc.legacyurl: /web-forms/overview/data-access/editing-inserting-and-deleting-data/an-overview-of-inserting-updating-and-deleting-data-vb
msc.type: authoredcontent
ms.openlocfilehash: 79491118ba1cbbc8c1b67ca9646a817d941f17ba
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 03/06/2020
ms.locfileid: "78493840"
---
# <a name="an-overview-of-inserting-updating-and-deleting-data-vb"></a><span data-ttu-id="f18c3-103">データの挿入、更新、および削除の概要 (VB)</span><span class="sxs-lookup"><span data-stu-id="f18c3-103">An Overview of Inserting, Updating, and Deleting Data (VB)</span></span>

<span data-ttu-id="f18c3-104">[Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="f18c3-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="f18c3-105">[サンプルアプリのダウンロード](https://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_16_VB.exe)または[PDF のダウンロード](an-overview-of-inserting-updating-and-deleting-data-vb/_static/datatutorial16vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="f18c3-105">[Download Sample App](https://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_16_VB.exe) or [Download PDF](an-overview-of-inserting-updating-and-deleting-data-vb/_static/datatutorial16vb1.pdf)</span></span>

> <span data-ttu-id="f18c3-106">このチュートリアルでは、ObjectDataSource の Insert ()、Update ()、Delete () の各メソッドを、BLL クラスのメソッドにマップする方法と、GridView、DetailsView、および FormView コントロールを構成してデータ変更機能を提供する方法について説明します。</span><span class="sxs-lookup"><span data-stu-id="f18c3-106">In this tutorial we'll see how to map an ObjectDataSource's Insert(), Update(), and Delete() methods to the methods of BLL classes, as well as how to configure the GridView, DetailsView, and FormView controls to provide data modification capabilities.</span></span>

## <a name="introduction"></a><span data-ttu-id="f18c3-107">はじめに</span><span class="sxs-lookup"><span data-stu-id="f18c3-107">Introduction</span></span>

<span data-ttu-id="f18c3-108">これまでのいくつかのチュートリアルでは、GridView、DetailsView、FormView コントロールを使用して ASP.NET ページにデータを表示する方法を説明しました。</span><span class="sxs-lookup"><span data-stu-id="f18c3-108">Over the past several tutorials we've examined how to display data in an ASP.NET page using the GridView, DetailsView, and FormView controls.</span></span> <span data-ttu-id="f18c3-109">これらのコントロールは、指定されたデータを操作するだけです。</span><span class="sxs-lookup"><span data-stu-id="f18c3-109">These controls simply work with data supplied to them.</span></span> <span data-ttu-id="f18c3-110">一般的に、これらのコントロールは、ObjectDataSource などのデータソースコントロールを使用してデータにアクセスします。</span><span class="sxs-lookup"><span data-stu-id="f18c3-110">Commonly, these controls access data through the use of a data source control, such as the ObjectDataSource.</span></span> <span data-ttu-id="f18c3-111">ObjectDataSource が、ASP.NET ページと基になるデータの間のプロキシとしてどのように機能するかを見てきました。</span><span class="sxs-lookup"><span data-stu-id="f18c3-111">We've seen how the ObjectDataSource acts as a proxy between the ASP.NET page and the underlying data.</span></span> <span data-ttu-id="f18c3-112">GridView でデータを表示する必要がある場合は、ObjectDataSource の `Select()` メソッドを呼び出します。このメソッドは、適切なデータアクセス層 (DAL) TableAdapter のメソッドを呼び出し、さらに Northwind データベースに `SELECT` クエリを送信する、ビジネスロジック層 (BLL) からメソッドを呼び出します。</span><span class="sxs-lookup"><span data-stu-id="f18c3-112">When a GridView needs to display data, it invokes its ObjectDataSource's `Select()` method, which in turn invokes a method from our Business Logic Layer (BLL), which calls a method in the appropriate Data Access Layer's (DAL) TableAdapter, which in turn sends a `SELECT` query to the Northwind database.</span></span>

<span data-ttu-id="f18c3-113">[最初のチュートリアル](../introduction/creating-a-data-access-layer-cs.md)では、DAL で tableadapter を作成したときに、基になるデータベーステーブルのデータの挿入、更新、および削除を行うためのメソッドが Visual Studio によって自動的に追加されたことを思い出してください。</span><span class="sxs-lookup"><span data-stu-id="f18c3-113">Recall that when we created the TableAdapters in the DAL in [our first tutorial](../introduction/creating-a-data-access-layer-cs.md), Visual Studio automatically added methods for inserting, updating, and deleting data from the underlying database table.</span></span> <span data-ttu-id="f18c3-114">さらに、[ビジネスロジック層を作成する際](../introduction/creating-a-business-logic-layer-vb.md)に、これらのデータ変更 DAL メソッドに呼び出される BLL のメソッドを設計しました。</span><span class="sxs-lookup"><span data-stu-id="f18c3-114">Moreover, in [Creating a Business Logic Layer](../introduction/creating-a-business-logic-layer-vb.md) we designed methods in the BLL that called down into these data modification DAL methods.</span></span>

<span data-ttu-id="f18c3-115">`Select()` メソッドに加えて、ObjectDataSource には、`Insert()`、`Update()`、および `Delete()` メソッドもあります。</span><span class="sxs-lookup"><span data-stu-id="f18c3-115">In addition to its `Select()` method, the ObjectDataSource also has `Insert()`, `Update()`, and `Delete()` methods.</span></span> <span data-ttu-id="f18c3-116">`Select()` メソッドと同様に、これら3つのメソッドは、基になるオブジェクトのメソッドにマップできます。</span><span class="sxs-lookup"><span data-stu-id="f18c3-116">Like the `Select()` method, these three methods can be mapped to methods in an underlying object.</span></span> <span data-ttu-id="f18c3-117">データの挿入、更新、または削除を行うように構成した場合、GridView、DetailsView、および FormView コントロールには、基になるデータを変更するためのユーザーインターフェイスが用意されています。</span><span class="sxs-lookup"><span data-stu-id="f18c3-117">When configured to insert, update, or delete data, the GridView, DetailsView, and FormView controls provide a user interface for modifying the underlying data.</span></span> <span data-ttu-id="f18c3-118">このユーザーインターフェイスは、ObjectDataSource の `Insert()`、`Update()`、および `Delete()` メソッドを呼び出します。このメソッドは、基になるオブジェクトの関連付けられたメソッドを呼び出します (図1を参照)。</span><span class="sxs-lookup"><span data-stu-id="f18c3-118">This user interface calls the `Insert()`, `Update()`, and `Delete()` methods of the ObjectDataSource, which then invoke the underlying object's associated methods (see Figure 1).</span></span>

<span data-ttu-id="f18c3-119">[ObjectDataSource の Insert ()、Update ()、Delete () の各メソッドが、BLL にプロキシとして機能する ![](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image2.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="f18c3-119">[![The ObjectDataSource's Insert(), Update(), and Delete() Methods Serve as a Proxy into the BLL](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image2.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image1.png)</span></span>

<span data-ttu-id="f18c3-120">**図 1**: ObjectDataSource の `Insert()`、`Update()`、および `Delete()` メソッドは、BLL にプロキシとして機能します ([クリックすると、フルサイズのイメージが表示](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image3.png)されます)。</span><span class="sxs-lookup"><span data-stu-id="f18c3-120">**Figure 1**: The ObjectDataSource's `Insert()`, `Update()`, and `Delete()` Methods Serve as a Proxy into the BLL ([Click to view full-size image](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image3.png))</span></span>

<span data-ttu-id="f18c3-121">このチュートリアルでは、ObjectDataSource の `Insert()`、`Update()`、および `Delete()` メソッドを BLL のクラスのメソッドにマップする方法と、GridView、DetailsView、および FormView コントロールを構成してデータ変更機能を提供する方法について説明します。</span><span class="sxs-lookup"><span data-stu-id="f18c3-121">In this tutorial we'll see how to map the ObjectDataSource's `Insert()`, `Update()`, and `Delete()` methods to methods of classes in the BLL, as well as how to configure the GridView, DetailsView, and FormView controls to provide data modification capabilities.</span></span>

## <a name="step-1-creating-the-insert-update-and-delete-tutorials-web-pages"></a><span data-ttu-id="f18c3-122">手順 1: 挿入、更新、および削除のチュートリアル Web ページの作成</span><span class="sxs-lookup"><span data-stu-id="f18c3-122">Step 1: Creating the Insert, Update, and Delete Tutorials Web Pages</span></span>

<span data-ttu-id="f18c3-123">データの挿入、更新、削除の方法を確認する前に、まず、このチュートリアルに必要な ASP.NET ページを web サイトプロジェクトに作成し、次のいくつかの作業を行います。</span><span class="sxs-lookup"><span data-stu-id="f18c3-123">Before we start exploring how to insert, update, and delete data, let's first take a moment to create the ASP.NET pages in our website project that we'll need for this tutorial and the next several ones.</span></span> <span data-ttu-id="f18c3-124">まず、`EditInsertDelete`という名前の新しいフォルダーを追加します。</span><span class="sxs-lookup"><span data-stu-id="f18c3-124">Start by adding a new folder named `EditInsertDelete`.</span></span> <span data-ttu-id="f18c3-125">次に、次の ASP.NET ページをそのフォルダーに追加します。各ページは `Site.master` マスターページに関連付けられていることを確認してください。</span><span class="sxs-lookup"><span data-stu-id="f18c3-125">Next, add the following ASP.NET pages to that folder, making sure to associate each page with the `Site.master` master page:</span></span>

- `Default.aspx`
- `Basics.aspx`
- `DataModificationEvents.aspx`
- `ErrorHandling.aspx`
- `UIValidation.aspx`
- `CustomizedUI.aspx`
- `OptimisticConcurrency.aspx`
- `ConfirmationOnDelete.aspx`
- `UserLevelAccess.aspx`

![データ変更関連のチュートリアルの ASP.NET ページを追加する](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image4.png)

<span data-ttu-id="f18c3-127">**図 2**: データ変更に関連するチュートリアルの ASP.NET ページを追加する</span><span class="sxs-lookup"><span data-stu-id="f18c3-127">**Figure 2**: Add the ASP.NET Pages for the Data Modification-Related Tutorials</span></span>

<span data-ttu-id="f18c3-128">他のフォルダーと同様に、`EditInsertDelete` フォルダー内の `Default.aspx` には、そのセクションのチュートリアルが一覧表示されます。</span><span class="sxs-lookup"><span data-stu-id="f18c3-128">Like in the other folders, `Default.aspx` in the `EditInsertDelete` folder will list the tutorials in its section.</span></span> <span data-ttu-id="f18c3-129">`SectionLevelTutorialListing.ascx` ユーザーコントロールがこの機能を提供していることを思い出してください。</span><span class="sxs-lookup"><span data-stu-id="f18c3-129">Recall that the `SectionLevelTutorialListing.ascx` User Control provides this functionality.</span></span> <span data-ttu-id="f18c3-130">そのため、ソリューションエクスプローラーからページのデザインビューにドラッグして、このユーザーコントロールを `Default.aspx` に追加します。</span><span class="sxs-lookup"><span data-stu-id="f18c3-130">Therefore, add this User Control to `Default.aspx` by dragging it from the Solution Explorer onto the page's Design view.</span></span>

<span data-ttu-id="f18c3-131">[SectionLevelTutorialListing ユーザーコントロールを default.aspx に追加 ![には](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image6.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image5.png)</span><span class="sxs-lookup"><span data-stu-id="f18c3-131">[![Add the SectionLevelTutorialListing.ascx User Control to Default.aspx](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image6.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image5.png)</span></span>

<span data-ttu-id="f18c3-132">**図 3**: `Default.aspx` に `SectionLevelTutorialListing.ascx` ユーザーコントロールを追加する ([クリックすると、フルサイズの画像が表示](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image7.png)されます)</span><span class="sxs-lookup"><span data-stu-id="f18c3-132">**Figure 3**: Add the `SectionLevelTutorialListing.ascx` User Control to `Default.aspx` ([Click to view full-size image](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image7.png))</span></span>

<span data-ttu-id="f18c3-133">最後に、`Web.sitemap` ファイルにエントリとしてページを追加します。</span><span class="sxs-lookup"><span data-stu-id="f18c3-133">Lastly, add the pages as entries to the `Web.sitemap` file.</span></span> <span data-ttu-id="f18c3-134">具体的には、カスタマイズされた書式設定 `<siteMapNode>`後に、次のマークアップを追加します。</span><span class="sxs-lookup"><span data-stu-id="f18c3-134">Specifically, add the following markup after the Customized Formatting `<siteMapNode>`:</span></span>

[!code-xml[Main](an-overview-of-inserting-updating-and-deleting-data-vb/samples/sample1.xml)]

<span data-ttu-id="f18c3-135">`Web.sitemap`を更新した後、ブラウザーを使用してチュートリアル web サイトを表示します。</span><span class="sxs-lookup"><span data-stu-id="f18c3-135">After updating `Web.sitemap`, take a moment to view the tutorials website through a browser.</span></span> <span data-ttu-id="f18c3-136">左側のメニューには、チュートリアルの編集、挿入、および削除を行うための項目が含まれています。</span><span class="sxs-lookup"><span data-stu-id="f18c3-136">The menu on the left now includes items for the editing, inserting, and deleting tutorials.</span></span>

![サイトマップに、チュートリアルの編集、挿入、および削除のエントリが含まれるようになりました。](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image8.png)

<span data-ttu-id="f18c3-138">**図 4**: サイトマップに、チュートリアルの編集、挿入、および削除のエントリが含まれるようになりました。</span><span class="sxs-lookup"><span data-stu-id="f18c3-138">**Figure 4**: The Site Map Now Includes Entries for the Editing, Inserting, and Deleting Tutorials</span></span>

## <a name="step-2-adding-and-configuring-the-objectdatasource-control"></a><span data-ttu-id="f18c3-139">手順 2: ObjectDataSource コントロールの追加と構成</span><span class="sxs-lookup"><span data-stu-id="f18c3-139">Step 2: Adding and Configuring the ObjectDataSource Control</span></span>

<span data-ttu-id="f18c3-140">GridView、DetailsView、および FormView はそれぞれデータ変更機能とレイアウトが異なるため、それぞれを個別に調べてみましょう。</span><span class="sxs-lookup"><span data-stu-id="f18c3-140">Since the GridView, DetailsView, and FormView each differ in their data modification capabilities and layout, let's examine each one individually.</span></span> <span data-ttu-id="f18c3-141">ただし、各コントロールで独自の ObjectDataSource を使用するのではなく、3つのコントロールの例すべてで共有できる単一の ObjectDataSource を作成しましょう。</span><span class="sxs-lookup"><span data-stu-id="f18c3-141">Rather than have each control using its own ObjectDataSource, however, let's just create a single ObjectDataSource that all three control examples can share.</span></span>

<span data-ttu-id="f18c3-142">`Basics.aspx` ページを開き、ObjectDataSource をツールボックスからデザイナーにドラッグし、そのスマートタグから [データソースの構成] リンクをクリックします。</span><span class="sxs-lookup"><span data-stu-id="f18c3-142">Open the `Basics.aspx` page, drag an ObjectDataSource from the Toolbox onto the Designer, and click the Configure Data Source link from its smart tag.</span></span> <span data-ttu-id="f18c3-143">`ProductsBLL` は、編集、挿入、および削除メソッドを提供する唯一の BLL クラスであるため、このクラスを使用するように ObjectDataSource を構成します。</span><span class="sxs-lookup"><span data-stu-id="f18c3-143">Since the `ProductsBLL` is the only BLL class that provides editing, inserting, and deleting methods, configure the ObjectDataSource to use this class.</span></span>

<span data-ttu-id="f18c3-144">[製品の Bll クラスを使用するように ObjectDataSource を構成 ![には](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image10.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image9.png)</span><span class="sxs-lookup"><span data-stu-id="f18c3-144">[![Configure the ObjectDataSource to Use the ProductsBLL Class](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image10.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image9.png)</span></span>

<span data-ttu-id="f18c3-145">**図 5**: `ProductsBLL` クラスを使用するように ObjectDataSource を構成する ([クリックしてフルサイズのイメージを表示する](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image11.png))</span><span class="sxs-lookup"><span data-stu-id="f18c3-145">**Figure 5**: Configure the ObjectDataSource to Use the `ProductsBLL` Class ([Click to view full-size image](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image11.png))</span></span>

<span data-ttu-id="f18c3-146">次の画面では、適切なタブを選択し、ドロップダウンリストからメソッドを選択することにより、`ProductsBLL` クラスのメソッドを ObjectDataSource の `Select()`、`Insert()`、`Update()`、および `Delete()` にどのようにマップするかを指定できます。</span><span class="sxs-lookup"><span data-stu-id="f18c3-146">In the next screen we can specify what methods of the `ProductsBLL` class are mapped to the ObjectDataSource's `Select()`, `Insert()`, `Update()`, and `Delete()` by selecting the appropriate tab and choosing the method from the drop-down list.</span></span> <span data-ttu-id="f18c3-147">図6は今ではよく見られるはずですが、ObjectDataSource の `Select()` メソッドを `ProductsBLL` クラスの `GetProducts()` メソッドにマップします。</span><span class="sxs-lookup"><span data-stu-id="f18c3-147">Figure 6, which should look familiar by now, maps the ObjectDataSource's `Select()` method to the `ProductsBLL` class's `GetProducts()` method.</span></span> <span data-ttu-id="f18c3-148">`Insert()`、`Update()`、および `Delete()` の各メソッドを構成するには、上部にある一覧から適切なタブを選択します。</span><span class="sxs-lookup"><span data-stu-id="f18c3-148">The `Insert()`, `Update()`, and `Delete()` methods can be configured by selecting the appropriate tab from the list along the top.</span></span>

<span data-ttu-id="f18c3-149">[ObjectDataSource がすべての製品を返す ![](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image13.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image12.png)</span><span class="sxs-lookup"><span data-stu-id="f18c3-149">[![Have the ObjectDataSource Return All of the Products](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image13.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image12.png)</span></span>

<span data-ttu-id="f18c3-150">**図 6**: ObjectDataSource によってすべての製品が返されるよう[にする (クリックすると、フルサイズの画像が表示](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image14.png)されます)</span><span class="sxs-lookup"><span data-stu-id="f18c3-150">**Figure 6**: Have the ObjectDataSource Return All of the Products ([Click to view full-size image](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image14.png))</span></span>

<span data-ttu-id="f18c3-151">図7、8、および9は、ObjectDataSource の [更新] タブ、[挿入] タブ、および [削除] タブを示しています。</span><span class="sxs-lookup"><span data-stu-id="f18c3-151">Figures 7, 8, and 9 show the ObjectDataSource's UPDATE, INSERT, and DELETE tabs.</span></span> <span data-ttu-id="f18c3-152">これらのタブを構成して、`Insert()`、`Update()`、および `Delete()` メソッドが、それぞれ `ProductsBLL` クラスの `UpdateProduct`、`AddProduct`、および `DeleteProduct` メソッドを呼び出すようにします。</span><span class="sxs-lookup"><span data-stu-id="f18c3-152">Configure these tabs so that the `Insert()`, `Update()`, and `Delete()` methods invoke the `ProductsBLL` class's `UpdateProduct`, `AddProduct`, and `DeleteProduct` methods, respectively.</span></span>

<span data-ttu-id="f18c3-153">[ObjectDataSource の Update () メソッドを ProductBLL クラスの UpdateProduct メソッドにマップ ![](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image16.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image15.png)</span><span class="sxs-lookup"><span data-stu-id="f18c3-153">[![Map the ObjectDataSource's Update() Method to the ProductBLL Class's UpdateProduct Method](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image16.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image15.png)</span></span>

<span data-ttu-id="f18c3-154">**図 7**: ObjectDataSource の `Update()` メソッドを `ProductBLL` クラスの `UpdateProduct` メソッドにマップする ([クリックしてフルサイズのイメージを表示する](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image17.png))</span><span class="sxs-lookup"><span data-stu-id="f18c3-154">**Figure 7**: Map the ObjectDataSource's `Update()` Method to the `ProductBLL` Class's `UpdateProduct` Method ([Click to view full-size image](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image17.png))</span></span>

<span data-ttu-id="f18c3-155">[ObjectDataSource の Insert () メソッドを ProductBLL クラスの AddProduct メソッドにマップ ![](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image19.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image18.png)</span><span class="sxs-lookup"><span data-stu-id="f18c3-155">[![Map the ObjectDataSource's Insert() Method to the ProductBLL Class's AddProduct Method](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image19.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image18.png)</span></span>

<span data-ttu-id="f18c3-156">**図 8**: ObjectDataSource の `Insert()` メソッドを `ProductBLL` クラスの Add `Product` メソッドにマップする ([クリックしてフルサイズのイメージを表示する](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image20.png))</span><span class="sxs-lookup"><span data-stu-id="f18c3-156">**Figure 8**: Map the ObjectDataSource's `Insert()` Method to the `ProductBLL` Class's Add `Product` Method ([Click to view full-size image](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image20.png))</span></span>

<span data-ttu-id="f18c3-157">[ObjectDataSource の Delete () メソッドを ProductBLL クラスの DeleteProduct メソッドにマップ ![](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image22.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image21.png)</span><span class="sxs-lookup"><span data-stu-id="f18c3-157">[![Map the ObjectDataSource's Delete() Method to the ProductBLL Class's DeleteProduct Method](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image22.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image21.png)</span></span>

<span data-ttu-id="f18c3-158">**図 9**: ObjectDataSource の `Delete()` メソッドを `ProductBLL` クラスの `DeleteProduct` メソッドにマップする ([クリックしてフルサイズのイメージを表示する](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image23.png))</span><span class="sxs-lookup"><span data-stu-id="f18c3-158">**Figure 9**: Map the ObjectDataSource's `Delete()` Method to the `ProductBLL` Class's `DeleteProduct` Method ([Click to view full-size image](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image23.png))</span></span>

<span data-ttu-id="f18c3-159">[更新]、[挿入]、[削除] の各タブのドロップダウンリストには、これらのメソッドが既に選択されています。</span><span class="sxs-lookup"><span data-stu-id="f18c3-159">You may have noticed that the drop-down lists in the UPDATE, INSERT, and DELETE tabs already had these methods selected.</span></span> <span data-ttu-id="f18c3-160">これは、`ProductsBLL`のメソッドを装飾する `DataObjectMethodAttribute` を使用したことによるものです。</span><span class="sxs-lookup"><span data-stu-id="f18c3-160">This is thanks to our use of the `DataObjectMethodAttribute` that decorates the methods of `ProductsBLL`.</span></span> <span data-ttu-id="f18c3-161">たとえば、DeleteProduct メソッドには次のシグネチャがあります。</span><span class="sxs-lookup"><span data-stu-id="f18c3-161">For example, the DeleteProduct method has the following signature:</span></span>

[!code-vb[Main](an-overview-of-inserting-updating-and-deleting-data-vb/samples/sample2.vb)]

<span data-ttu-id="f18c3-162">`DataObjectMethodAttribute` 属性は、選択、挿入、更新、または削除の各メソッドの目的を示し、既定値であるかどうかを示します。</span><span class="sxs-lookup"><span data-stu-id="f18c3-162">The `DataObjectMethodAttribute` attribute indicates the purpose of each method whether it is for selecting, inserting, updating, or deleting and whether or not it's the default value.</span></span> <span data-ttu-id="f18c3-163">BLL クラスの作成時にこれらの属性を省略した場合は、[更新]、[挿入]、[削除] の各タブからメソッドを手動で選択する必要があります。</span><span class="sxs-lookup"><span data-stu-id="f18c3-163">If you omitted these attributes when creating your BLL classes, you'll need to manually select the methods from the UPDATE, INSERT, and DELETE tabs.</span></span>

<span data-ttu-id="f18c3-164">適切な `ProductsBLL` メソッドが ObjectDataSource の `Insert()`、`Update()`、および `Delete()` の各メソッドにマップされていることを確認したら、[完了] をクリックしてウィザードを完了します。</span><span class="sxs-lookup"><span data-stu-id="f18c3-164">After ensuring that the appropriate `ProductsBLL` methods are mapped to the ObjectDataSource's `Insert()`, `Update()`, and `Delete()` methods, click Finish to complete the wizard.</span></span>

## <a name="examining-the-objectdatasources-markup"></a><span data-ttu-id="f18c3-165">ObjectDataSource のマークアップを調べる</span><span class="sxs-lookup"><span data-stu-id="f18c3-165">Examining the ObjectDataSource's Markup</span></span>

<span data-ttu-id="f18c3-166">ウィザードを使用して ObjectDataSource を構成した後、ソースビューにアクセスして、生成された宣言マークアップを確認します。</span><span class="sxs-lookup"><span data-stu-id="f18c3-166">After configuring the ObjectDataSource through its wizard, go to the Source view to examine the generated declarative markup.</span></span> <span data-ttu-id="f18c3-167">`<asp:ObjectDataSource>` タグは、基になるオブジェクトと呼び出すメソッドを指定します。</span><span class="sxs-lookup"><span data-stu-id="f18c3-167">The `<asp:ObjectDataSource>` tag specifies the underlying object and the methods to invoke.</span></span> <span data-ttu-id="f18c3-168">さらに、`ProductsBLL` クラスの `AddProduct`、`UpdateProduct`、および `DeleteProduct` メソッドの入力パラメーターにマップされる `DeleteParameters`、`UpdateParameters`、および `InsertParameters` があります。</span><span class="sxs-lookup"><span data-stu-id="f18c3-168">Additionally, there are `DeleteParameters`, `UpdateParameters`, and `InsertParameters` that map to the input parameters for the `ProductsBLL` class's `AddProduct`, `UpdateProduct`, and `DeleteProduct` methods:</span></span>

[!code-aspx[Main](an-overview-of-inserting-updating-and-deleting-data-vb/samples/sample3.aspx)]

<span data-ttu-id="f18c3-169">ObjectDataSource には、関連付けられているメソッドの各入力パラメーターのパラメーターが含まれています。これは、ObjectDataSource が、入力パラメーター (`GetProductsByCategoryID(categoryID)`など) を必要とする select メソッドを呼び出すように構成されている場合に、`SelectParameter` のリストと同様に存在します。</span><span class="sxs-lookup"><span data-stu-id="f18c3-169">The ObjectDataSource includes a parameter for each of the input parameters for its associated methods, just like a list of `SelectParameter` s is present when the ObjectDataSource is configured to call a select method that expects an input parameter (such as `GetProductsByCategoryID(categoryID)`).</span></span> <span data-ttu-id="f18c3-170">後で説明するように、これらの `DeleteParameters`、`UpdateParameters`、および `InsertParameters` の値は、ObjectDataSource の `Insert()`、`Update()`、または `Delete()` メソッドを呼び出す前に、GridView、DetailsView、および FormView によって自動的に設定されます。</span><span class="sxs-lookup"><span data-stu-id="f18c3-170">As we'll see shortly, values for these `DeleteParameters`, `UpdateParameters`, and `InsertParameters` are set automatically by the GridView, DetailsView, and FormView prior to invoking the ObjectDataSource's `Insert()`, `Update()`, or `Delete()` method.</span></span> <span data-ttu-id="f18c3-171">これらの値は、後のチュートリアルで説明するように、必要に応じてプログラムで設定することもできます。</span><span class="sxs-lookup"><span data-stu-id="f18c3-171">These values can also be set programmatically as needed, as we'll discuss in a future tutorial.</span></span>

<span data-ttu-id="f18c3-172">ウィザードを使用して ObjectDataSource に構成する副作用の1つは、Visual Studio が[Oldvaluesparameterformatstring プロパティ](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.oldvaluesparameterformatstring(VS.80).aspx)を `original_{0}`に設定することです。</span><span class="sxs-lookup"><span data-stu-id="f18c3-172">One side effect of using the wizard to configure to ObjectDataSource is that Visual Studio sets the [OldValuesParameterFormatString property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.oldvaluesparameterformatstring(VS.80).aspx) to `original_{0}`.</span></span> <span data-ttu-id="f18c3-173">このプロパティ値は、編集中のデータの元の値を含めるために使用され、次の2つのシナリオで役立ちます。</span><span class="sxs-lookup"><span data-stu-id="f18c3-173">This property value is used to include the original values of the data being edited and is useful in two scenarios:</span></span>

- <span data-ttu-id="f18c3-174">レコードを編集するときに、ユーザーは主キーの値を変更できます。</span><span class="sxs-lookup"><span data-stu-id="f18c3-174">If, when editing a record, users are able to change the primary key value.</span></span> <span data-ttu-id="f18c3-175">この場合、元の主キー値を持つレコードが見つかり、それに応じて値が更新されるように、新しい主キー値と元の主キー値の両方を指定する必要があります。</span><span class="sxs-lookup"><span data-stu-id="f18c3-175">In this case, both the new primary key value and the original primary key value must be provided so that the record with the original primary key value can be found and have its value updated accordingly.</span></span>
- <span data-ttu-id="f18c3-176">オプティミスティック同時実行制御を使用する場合。</span><span class="sxs-lookup"><span data-stu-id="f18c3-176">When using optimistic concurrency.</span></span> <span data-ttu-id="f18c3-177">オプティミスティック同時実行制御は、2人のユーザーが互いの変更を上書きしないようにするための手法であり、今後のチュートリアルのトピックです。</span><span class="sxs-lookup"><span data-stu-id="f18c3-177">Optimistic concurrency is a technique to ensure that two simultaneous users don't overwrite one another's changes, and is the topic for a future tutorial.</span></span>

<span data-ttu-id="f18c3-178">`OldValuesParameterFormatString` プロパティは、元の値の基になるオブジェクトの update メソッドと delete メソッドの入力パラメーターの名前を示します。</span><span class="sxs-lookup"><span data-stu-id="f18c3-178">The `OldValuesParameterFormatString` property indicates the name of the input parameters in the underlying object's update and delete methods for the original values.</span></span> <span data-ttu-id="f18c3-179">オプティミスティック同時実行制御の詳細については、このプロパティとその目的について詳しく説明します。</span><span class="sxs-lookup"><span data-stu-id="f18c3-179">We'll discuss this property and its purpose in greater detail when we explore optimistic concurrency.</span></span> <span data-ttu-id="f18c3-180">ただし、BLL のメソッドは元の値を予期していないため、このプロパティを削除することが重要です。</span><span class="sxs-lookup"><span data-stu-id="f18c3-180">I bring it up now, however, because our BLL's methods do not expect the original values and therefore it's important that we remove this property.</span></span> <span data-ttu-id="f18c3-181">`OldValuesParameterFormatString` プロパティを既定値 (`{0}`) 以外に設定したままにすると、ObjectDataSource は、指定された `UpdateParameters` または `DeleteParameters` と元の値のパラメーターの両方を渡そうとするため、ObjectDataSource の `Update()` または `Delete()` メソッドを呼び出そうとするとエラーが発生します。</span><span class="sxs-lookup"><span data-stu-id="f18c3-181">Leaving the `OldValuesParameterFormatString` property set to anything other than the default (`{0}`) will cause an error when a data Web control attempts to invoke the ObjectDataSource's `Update()` or `Delete()` methods because the ObjectDataSource will attempt to pass in both the `UpdateParameters` or `DeleteParameters` specified as well as original value parameters.</span></span>

<span data-ttu-id="f18c3-182">この時点ではそれほど明確でない場合は、今後のチュートリアルでこのプロパティとユーティリティを確認します。</span><span class="sxs-lookup"><span data-stu-id="f18c3-182">If this isn't terribly clear at this juncture, don't worry, we'll examine this property and its utility in a future tutorial.</span></span> <span data-ttu-id="f18c3-183">ここでは、このプロパティの宣言を宣言構文から完全に削除するか、値を既定値 ({0}) に設定するだけであることを確認してください。</span><span class="sxs-lookup"><span data-stu-id="f18c3-183">For now, just be certain to either remove this property declaration entirely from the declarative syntax or set the value to the default value ({0}).</span></span>

> [!NOTE]
> <span data-ttu-id="f18c3-184">デザインビューのプロパティウィンドウから `OldValuesParameterFormatString` プロパティ値をクリアするだけの場合、プロパティは宣言構文に存在しますが、空の文字列に設定されます。</span><span class="sxs-lookup"><span data-stu-id="f18c3-184">If you simply clear out the `OldValuesParameterFormatString` property value from the Properties window in the Design view, the property will still exist in the declarative syntax, but be set to an empty string.</span></span> <span data-ttu-id="f18c3-185">残念ながら、これまでに説明したのと同じ問題が発生します。</span><span class="sxs-lookup"><span data-stu-id="f18c3-185">This, unfortunately, will still result in the same problem discussed above.</span></span> <span data-ttu-id="f18c3-186">したがって、宣言構文からプロパティを完全に削除するか、プロパティウィンドウから、値を既定の `{0}`に設定します。</span><span class="sxs-lookup"><span data-stu-id="f18c3-186">Therefore, either remove the property altogether from the declarative syntax or, from the Properties window, set the value to the default, `{0}`.</span></span>

## <a name="step-3-adding-a-data-web-control-and-configuring-it-for-data-modification"></a><span data-ttu-id="f18c3-187">手順 3: データ Web コントロールを追加し、データ変更用に構成する</span><span class="sxs-lookup"><span data-stu-id="f18c3-187">Step 3: Adding a Data Web Control and Configuring It for Data Modification</span></span>

<span data-ttu-id="f18c3-188">ObjectDataSource がページに追加され、構成されたら、データを表示するためのページにデータ Web コントロールを追加し、エンドユーザーがデータを変更するための手段を提供できるようになります。</span><span class="sxs-lookup"><span data-stu-id="f18c3-188">Once the ObjectDataSource has been added to the page and configured, we're ready to add data Web controls to the page to both display the data and provide a means for the end user to modify it.</span></span> <span data-ttu-id="f18c3-189">これらのデータ Web コントロールはデータ変更機能と構成が異なるため、GridView、DetailsView、FormView を個別に見ていきます。</span><span class="sxs-lookup"><span data-stu-id="f18c3-189">We'll look at the GridView, DetailsView, and FormView separately, as these data Web controls differ in their data modification capabilities and configuration.</span></span>

<span data-ttu-id="f18c3-190">この記事の残りの部分で説明するように、GridView、DetailsView、および FormView コントロールを使用した基本的な編集、挿入、および削除のサポートの追加は、いくつかのチェックボックスをオンにするだけで簡単に行うことができます。</span><span class="sxs-lookup"><span data-stu-id="f18c3-190">As we'll see in the remainder of this article, adding very basic editing, inserting, and deleting support through the GridView, DetailsView, and FormView controls is really as simple as checking a couple of checkboxes.</span></span> <span data-ttu-id="f18c3-191">実際の世界には、ポイントアンドクリックだけでなく、このような機能を提供するという、多くの微妙な要素とエッジケースがあります。</span><span class="sxs-lookup"><span data-stu-id="f18c3-191">There are many subtleties and edge cases in the real-world that make providing such functionality more involved than just point and click.</span></span> <span data-ttu-id="f18c3-192">ただし、このチュートリアルでは、単純データ変更機能の提供にのみ焦点を当てています。</span><span class="sxs-lookup"><span data-stu-id="f18c3-192">This tutorial, however, focuses solely on proving simplistic data modification capabilities.</span></span> <span data-ttu-id="f18c3-193">今後のチュートリアルでは、現実世界の設定で発生する可能性がある問題を調査します。</span><span class="sxs-lookup"><span data-stu-id="f18c3-193">Future tutorials will examine concerns that will undoubtedly arise in a real-world setting.</span></span>

## <a name="deleting-data-from-the-gridview"></a><span data-ttu-id="f18c3-194">GridView からのデータの削除</span><span class="sxs-lookup"><span data-stu-id="f18c3-194">Deleting Data from the GridView</span></span>

<span data-ttu-id="f18c3-195">まず、GridView をツールボックスからデザイナーにドラッグします。</span><span class="sxs-lookup"><span data-stu-id="f18c3-195">Start by dragging a GridView from the Toolbox onto the Designer.</span></span> <span data-ttu-id="f18c3-196">次に、gridview のスマートタグのドロップダウンリストから ObjectDataSource を選択して、その ObjectDataSource を GridView にバインドします。</span><span class="sxs-lookup"><span data-stu-id="f18c3-196">Next, bind the ObjectDataSource to the GridView by selecting it from the drop-down list in the GridView's smart tag.</span></span> <span data-ttu-id="f18c3-197">この時点で、GridView の宣言型マークアップは次のようになります。</span><span class="sxs-lookup"><span data-stu-id="f18c3-197">At this point the GridView's declarative markup will be:</span></span>

[!code-aspx[Main](an-overview-of-inserting-updating-and-deleting-data-vb/samples/sample4.aspx)]

<span data-ttu-id="f18c3-198">そのスマートタグを通じて、GridView を ObjectDataSource にバインドすると、次の2つの利点があります。</span><span class="sxs-lookup"><span data-stu-id="f18c3-198">Binding the GridView to the ObjectDataSource through its smart tag has two benefits:</span></span>

- <span data-ttu-id="f18c3-199">BoundFields と CheckBoxFields は、ObjectDataSource によって返される各フィールドに対して自動的に作成されます。</span><span class="sxs-lookup"><span data-stu-id="f18c3-199">BoundFields and CheckBoxFields are automatically created for each of the fields returned by the ObjectDataSource.</span></span> <span data-ttu-id="f18c3-200">さらに、BoundField プロパティと CheckBoxField プロパティは、基になるフィールドのメタデータに基づいて設定されます。</span><span class="sxs-lookup"><span data-stu-id="f18c3-200">Moreover, the BoundField and CheckBoxField's properties are set based on the underlying field's metadata.</span></span> <span data-ttu-id="f18c3-201">たとえば、`ProductID`、`CategoryName`、および `SupplierName` フィールドは `ProductsDataTable` で読み取り専用としてマークされているので、編集時に更新できないようにします。</span><span class="sxs-lookup"><span data-stu-id="f18c3-201">For example, the `ProductID`, `CategoryName`, and `SupplierName` fields are marked as read-only in the `ProductsDataTable` and therefore shouldn't be updatable when editing.</span></span> <span data-ttu-id="f18c3-202">これに対応するために、これらの BoundFields の[ReadOnly プロパティ](https://msdn.microsoft.com/library/system.web.ui.webcontrols.boundfield.readonly(VS.80).aspx)は `True`に設定されます。</span><span class="sxs-lookup"><span data-stu-id="f18c3-202">To accommodate this, these BoundFields' [ReadOnly properties](https://msdn.microsoft.com/library/system.web.ui.webcontrols.boundfield.readonly(VS.80).aspx) are set to `True`.</span></span>
- <span data-ttu-id="f18c3-203">[いる datakeynames プロパティ](https://msdn.microsoft.com/library/system.web.ui.webcontrols.gridview.datakeynames(VS.80).aspx)は、基になるオブジェクトの主キーフィールドに割り当てられます。</span><span class="sxs-lookup"><span data-stu-id="f18c3-203">The [DataKeyNames property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.gridview.datakeynames(VS.80).aspx) is assigned to the primary key field(s) of the underlying object.</span></span> <span data-ttu-id="f18c3-204">これは、データを編集または削除するために GridView を使用する場合に不可欠です。このプロパティは、一意に各レコードを識別するフィールド (またはフィールドのセット) を示します。</span><span class="sxs-lookup"><span data-stu-id="f18c3-204">This is essential when using the GridView for editing or deleting data, as this property indicates the field (or set of fields) that unique identifies each record.</span></span> <span data-ttu-id="f18c3-205">`DataKeyNames` プロパティの詳細については、「詳細情報ビューを使用し[た選択可能なマスター GridView を使用したマスター/詳細](../masterdetail/master-detail-using-a-selectable-master-gridview-with-a-details-detailview-cs.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="f18c3-205">For more information on the `DataKeyNames` property, refer back to the [Master/Detail Using a Selectable Master GridView with a Details DetailView](../masterdetail/master-detail-using-a-selectable-master-gridview-with-a-details-detailview-cs.md) tutorial.</span></span>

<span data-ttu-id="f18c3-206">GridView はプロパティウィンドウまたは宣言型の構文を通じて ObjectDataSource にバインドできますが、そのためには、適切な BoundField および `DataKeyNames` マークアップを手動で追加する必要があります。</span><span class="sxs-lookup"><span data-stu-id="f18c3-206">While the GridView can be bound to the ObjectDataSource through the Properties window or declarative syntax, doing so requires you to manually add the appropriate BoundField and `DataKeyNames` markup.</span></span>

<span data-ttu-id="f18c3-207">GridView コントロールには、行レベルの編集と削除のサポートが組み込まれています。</span><span class="sxs-lookup"><span data-stu-id="f18c3-207">The GridView control provides built-in support for row-level editing and deleting.</span></span> <span data-ttu-id="f18c3-208">構成の削除をサポートするために GridView 列の削除ボタンを追加します。</span><span class="sxs-lookup"><span data-stu-id="f18c3-208">Configuring a GridView to support deleting adds a column of Delete buttons.</span></span> <span data-ttu-id="f18c3-209">エンドユーザーは、特定の行の削除ボタンをクリックすると、ポストバックに陥ります、GridView は、次の手順を実行します。</span><span class="sxs-lookup"><span data-stu-id="f18c3-209">When the end user clicks the Delete button for a particular row, a postback ensues and the GridView performs the following steps:</span></span>

1. <span data-ttu-id="f18c3-210">ObjectDataSource の `DeleteParameters` 値が割り当てられています</span><span class="sxs-lookup"><span data-stu-id="f18c3-210">The ObjectDataSource's `DeleteParameters` value(s) are assigned</span></span>
2. <span data-ttu-id="f18c3-211">ObjectDataSource の `Delete()` メソッドが呼び出され、指定されたレコードが削除されます。</span><span class="sxs-lookup"><span data-stu-id="f18c3-211">The ObjectDataSource's `Delete()` method is invoked, deleting the specified record</span></span>
3. <span data-ttu-id="f18c3-212">GridView は、`Select()` メソッドを呼び出すことによって、それ自体を ObjectDataSource に再バインドします。</span><span class="sxs-lookup"><span data-stu-id="f18c3-212">The GridView rebinds itself to the ObjectDataSource by invoking its `Select()` method</span></span>

<span data-ttu-id="f18c3-213">`DeleteParameters` に割り当てられた値は、[削除] ボタンがクリックされた行の `DataKeyNames` フィールドの値です。</span><span class="sxs-lookup"><span data-stu-id="f18c3-213">The values assigned to the `DeleteParameters` are the values of the `DataKeyNames` field(s) for the row whose Delete button was clicked.</span></span> <span data-ttu-id="f18c3-214">そのため、GridView の `DataKeyNames` プロパティを正しく設定することが重要です。</span><span class="sxs-lookup"><span data-stu-id="f18c3-214">Therefore it's vital that a GridView's `DataKeyNames` property be correctly set.</span></span> <span data-ttu-id="f18c3-215">この値が指定されていない場合は、手順 1. で `DeleteParameters` に `Nothing` の値が割り当てられます。これにより、手順 2. で削除されたレコードが生成されることはありません。</span><span class="sxs-lookup"><span data-stu-id="f18c3-215">If it's missing, the `DeleteParameters` will be assigned a value of `Nothing` in Step 1, which in turn will not result in any deleted records in Step 2.</span></span>

> [!NOTE]
> <span data-ttu-id="f18c3-216">`DataKeys` コレクションは GridView s コントロール状態に格納されます。つまり、GridView のビューステートが無効になっている場合でも、ポストバック全体で `DataKeys` 値が記憶されます。</span><span class="sxs-lookup"><span data-stu-id="f18c3-216">The `DataKeys` collection is stored in the GridView s control state, meaning that the `DataKeys` values will be remembered across postback even if the GridView s view state has been disabled.</span></span> <span data-ttu-id="f18c3-217">ただし、編集または削除 (既定の動作) をサポートする GridViews では、ビューステートが有効なままであることが非常に重要です。</span><span class="sxs-lookup"><span data-stu-id="f18c3-217">However, it is very important that view state remains enabled for GridViews that support editing or deleting (the default behavior).</span></span> <span data-ttu-id="f18c3-218">GridView の `EnableViewState` プロパティを `false`に設定した場合、編集と削除の動作は1人のユーザーに対して正常に機能しますが、同時実行ユーザーがデータを削除している場合は、これらの同時実行ユーザーが意図していないレコードを誤って削除または編集する可能性があります。</span><span class="sxs-lookup"><span data-stu-id="f18c3-218">If you set the GridView s `EnableViewState` property to `false`, the editing and deleting behavior will work fine for a single user, but if there are concurrent users deleting data, there exists the possibility that these concurrent users may accidentally delete or edit records that they didn't intend.</span></span> <span data-ttu-id="f18c3-219">詳細については、「マイブログの記事、[警告: 編集や削除をサポートし、ビューステートが無効になっている ASP.NET 2.0 GridViews/DetailsView/formviews での同時実行の問題](http://scottonwriting.net/sowblog/posts/10054.aspx)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="f18c3-219">See my blog entry, [WARNING: Concurrency Issue with ASP.NET 2.0 GridViews/DetailsView/FormViews that Support Editing and/or Deleting and Whose View State is Disabled](http://scottonwriting.net/sowblog/posts/10054.aspx), for more information.</span></span>

<span data-ttu-id="f18c3-220">この警告は、[表示] ビューおよび [フォーム] ビューにも当てはまります。</span><span class="sxs-lookup"><span data-stu-id="f18c3-220">This same warning also applies to DetailsViews and FormViews.</span></span>

<span data-ttu-id="f18c3-221">GridView に削除機能を追加するには、単にそのスマートタグにアクセスし、[削除を有効にする] チェックボックスをオンにします。</span><span class="sxs-lookup"><span data-stu-id="f18c3-221">To add deleting capabilities to a GridView, simply go to its smart tag and check the Enable Deleting checkbox.</span></span>

![有効にするチェック ボックスを削除するを確認してください。](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image24.png)

<span data-ttu-id="f18c3-223">**図 10**: [削除を有効にする] チェックボックスをオンにする</span><span class="sxs-lookup"><span data-stu-id="f18c3-223">**Figure 10**: Check the Enable Deleting Checkbox</span></span>

<span data-ttu-id="f18c3-224">スマートタグから [削除を有効にする] チェックボックスをオンにすると、GridView に CommandField が追加されます。</span><span class="sxs-lookup"><span data-stu-id="f18c3-224">Checking the Enable Deleting checkbox from the smart tag adds a CommandField to the GridView.</span></span> <span data-ttu-id="f18c3-225">CommandField は、GridView の列に、レコードの選択、レコードの編集、レコードの削除という1つ以上のタスクを実行するためのボタンを表示します。</span><span class="sxs-lookup"><span data-stu-id="f18c3-225">The CommandField renders a column in the GridView with buttons for performing one or more of the following tasks: selecting a record, editing a record, and deleting a record.</span></span> <span data-ttu-id="f18c3-226">前に、[詳細詳細ビューのチュートリアルで選択可能なマスター GridView を使用して、マスター/詳細](../masterdetail/master-detail-using-a-selectable-master-gridview-with-a-details-detailview-cs.md)でレコードを選択する操作の commandfield を確認しました。</span><span class="sxs-lookup"><span data-stu-id="f18c3-226">We previously saw the CommandField in action with selecting records in the [Master/Detail Using a Selectable Master GridView with a Details DetailView](../masterdetail/master-detail-using-a-selectable-master-gridview-with-a-details-detailview-cs.md) tutorial.</span></span>

<span data-ttu-id="f18c3-227">CommandField には、CommandField に表示される一連のボタンを示す `ShowXButton` のプロパティが多数含まれています。</span><span class="sxs-lookup"><span data-stu-id="f18c3-227">The CommandField contains a number of `ShowXButton` properties that indicate what series of buttons are displayed in the CommandField.</span></span> <span data-ttu-id="f18c3-228">[削除を有効にする] チェックボックスをオンにすると、`ShowDeleteButton` プロパティが `True` である CommandField が GridView の Columns コレクションに追加されます。</span><span class="sxs-lookup"><span data-stu-id="f18c3-228">By checking the Enable Deleting checkbox a CommandField whose `ShowDeleteButton` property is `True` has been added to the GridView's Columns collection.</span></span>

[!code-aspx[Main](an-overview-of-inserting-updating-and-deleting-data-vb/samples/sample5.aspx)]

<span data-ttu-id="f18c3-229">信じられないかもしれませんが、GridView に削除サポートを追加しています。</span><span class="sxs-lookup"><span data-stu-id="f18c3-229">At this point, believe it or not, we're done with adding deleting support to the GridView!</span></span> <span data-ttu-id="f18c3-230">図 11 に示すようとブラウザーの削除ボタンの列からこのページにアクセスが存在します。</span><span class="sxs-lookup"><span data-stu-id="f18c3-230">As Figure 11 shows, when visiting this page through a browser a column of Delete buttons is present.</span></span>

<span data-ttu-id="f18c3-231">[CommandField ![Delete ボタンの列が追加されます。](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image26.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image25.png)</span><span class="sxs-lookup"><span data-stu-id="f18c3-231">[![The CommandField Adds a Column of Delete Buttons](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image26.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image25.png)</span></span>

<span data-ttu-id="f18c3-232">**図 11**: Commandfield に Delete ボタンの列が追加される ([クリックすると、フルサイズの画像が表示](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image27.png)されます)</span><span class="sxs-lookup"><span data-stu-id="f18c3-232">**Figure 11**: The CommandField Adds a Column of Delete Buttons ([Click to view full-size image](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image27.png))</span></span>

<span data-ttu-id="f18c3-233">このチュートリアルを独自に作成したことがある場合は、このページをテストするときに、[削除] ボタンをクリックすると例外が発生します。</span><span class="sxs-lookup"><span data-stu-id="f18c3-233">If you've been building this tutorial from the ground up on your own, when testing this page clicking the Delete button will raise an exception.</span></span> <span data-ttu-id="f18c3-234">これらの例外が発生した理由とその修正方法については、「」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="f18c3-234">Continue reading to learn as to why these exceptions were raised and how to fix them.</span></span>

> [!NOTE]
> <span data-ttu-id="f18c3-235">このチュートリアルに付属しているダウンロードを使用している場合は、これらの問題は既に記載されています。</span><span class="sxs-lookup"><span data-stu-id="f18c3-235">If you're following along using the download accompanying this tutorial, these problems have already been accounted for.</span></span> <span data-ttu-id="f18c3-236">ただし、以下に示す詳細を読んで、発生する可能性のある問題と適切な回避策を特定することをお勧めします。</span><span class="sxs-lookup"><span data-stu-id="f18c3-236">However, I encourage you to read through the details listed below to help identify problems that may arise and suitable workarounds.</span></span>

<span data-ttu-id="f18c3-237">製品を削除しようとしたときに、メッセージが "Objectdatasource ' ObjectDataSource1 ' に類似しているという例外が発生した場合は、*パラメーター: productid、original\_productid*、" objectdatasource から `OldValuesParameterFormatString` プロパティを削除し忘れた可能性があります。</span><span class="sxs-lookup"><span data-stu-id="f18c3-237">If, when attempting to delete a product, you get an exception whose message is similar to "*ObjectDataSource 'ObjectDataSource1' could not find a non-generic method 'DeleteProduct' that has parameters: productID, original\_ProductID*," you likely forgot to remove the `OldValuesParameterFormatString` property from the ObjectDataSource.</span></span> <span data-ttu-id="f18c3-238">`OldValuesParameterFormatString` プロパティが指定されている場合、ObjectDataSource は、`productID` と `original_ProductID` 入力パラメーターの両方を `DeleteProduct` メソッドに渡すことを試みます。</span><span class="sxs-lookup"><span data-stu-id="f18c3-238">With the `OldValuesParameterFormatString` property specified, the ObjectDataSource attempts to pass in both `productID` and `original_ProductID` input parameters to the `DeleteProduct` method.</span></span> <span data-ttu-id="f18c3-239">ただし `DeleteProduct`では、1つの入力パラメーターのみを受け入れるため、例外が発生します。</span><span class="sxs-lookup"><span data-stu-id="f18c3-239">`DeleteProduct`, however, only accepts a single input parameter, hence the exception.</span></span> <span data-ttu-id="f18c3-240">`OldValuesParameterFormatString` プロパティを削除する (またはそれを `{0}`に設定する) 場合、ObjectDataSource は元の入力パラメーターを渡さないように指示します。</span><span class="sxs-lookup"><span data-stu-id="f18c3-240">Removing the `OldValuesParameterFormatString` property (or setting it to `{0}`) instructs the ObjectDataSource to not attempt to pass in the original input parameter.</span></span>

<span data-ttu-id="f18c3-241">[OldValuesParameterFormatString プロパティがクリアされていることを ![](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image29.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image28.png)</span><span class="sxs-lookup"><span data-stu-id="f18c3-241">[![Ensure That the OldValuesParameterFormatString Property Has Been Cleared Out](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image29.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image28.png)</span></span>

<span data-ttu-id="f18c3-242">**図 12**: `OldValuesParameterFormatString` プロパティがクリアされていることを確認[する (クリックすると、フルサイズの画像が表示](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image30.png)されます)</span><span class="sxs-lookup"><span data-stu-id="f18c3-242">**Figure 12**: Ensure That the `OldValuesParameterFormatString` Property Has Been Cleared Out ([Click to view full-size image](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image30.png))</span></span>

<span data-ttu-id="f18c3-243">`OldValuesParameterFormatString` プロパティを削除した場合でも、次のようなメッセージで製品を削除しようとすると例外が発生します。 "*delete ステートメントは、参照制約 ' FK\_Order\_Details\_Products ' と競合*しています。Northwind データベースには、`Order Details` と `Products` テーブル間の外部キー制約が含まれています。つまり、`Order Details` テーブルに1つ以上のレコードがある場合、製品をシステムから削除することはできません。</span><span class="sxs-lookup"><span data-stu-id="f18c3-243">Even if you had removed the `OldValuesParameterFormatString` property, you still will get an exception when trying to delete a product with the message: "*The DELETE statement conflicted with the REFERENCE constraint 'FK\_Order\_Details\_Products'*." The Northwind database contains a foreign key constraint between the `Order Details` and `Products` table, meaning that a product cannot be deleted from the system if there are one or more records for it in the `Order Details` table.</span></span> <span data-ttu-id="f18c3-244">Northwind データベースのすべての製品には `Order Details`に少なくとも1つのレコードがあるため、製品に関連付けられている注文明細レコードを最初に削除するまで、製品を削除することはできません。</span><span class="sxs-lookup"><span data-stu-id="f18c3-244">Since every product in the Northwind database has at least one record in `Order Details`, we cannot delete any products until we first delete the product's associated order details records.</span></span>

<span data-ttu-id="f18c3-245">[外部キー制約を ![と、製品の削除が禁止されます。](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image32.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image31.png)</span><span class="sxs-lookup"><span data-stu-id="f18c3-245">[![A Foreign Key Constraint Prohibits the Deletion of Products](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image32.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image31.png)</span></span>

<span data-ttu-id="f18c3-246">**図 13**: 外部キー制約によって製品の削除が禁止される ([クリックすると、フルサイズの画像が表示](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image33.png)されます)</span><span class="sxs-lookup"><span data-stu-id="f18c3-246">**Figure 13**: A Foreign Key Constraint Prohibits the Deletion of Products ([Click to view full-size image](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image33.png))</span></span>

<span data-ttu-id="f18c3-247">このチュートリアルでは、`Order Details` テーブルからすべてのレコードを削除してみましょう。</span><span class="sxs-lookup"><span data-stu-id="f18c3-247">For our tutorial, let's just delete all of the records from the `Order Details` table.</span></span> <span data-ttu-id="f18c3-248">実際のアプリケーションでは、次のいずれかを行う必要があります。</span><span class="sxs-lookup"><span data-stu-id="f18c3-248">In a real-world application we'd need to either:</span></span>

- <span data-ttu-id="f18c3-249">注文の詳細情報を管理する別の画面を用意する</span><span class="sxs-lookup"><span data-stu-id="f18c3-249">Have another screen to manage order details information</span></span>
- <span data-ttu-id="f18c3-250">指定された製品の注文の詳細を削除するロジックを含めるように `DeleteProduct` メソッドを強化します。</span><span class="sxs-lookup"><span data-stu-id="f18c3-250">Augment the `DeleteProduct` method to include logic to delete the specified product's order details</span></span>
- <span data-ttu-id="f18c3-251">指定された製品の注文の詳細の削除を含むように、TableAdapter によって使用される SQL クエリを変更します。</span><span class="sxs-lookup"><span data-stu-id="f18c3-251">Modify the SQL query used by the TableAdapter to include deletion of the specified product's order details</span></span>

<span data-ttu-id="f18c3-252">`Order Details` テーブルからすべてのレコードを削除して、foreign key 制約を回避してみましょう。</span><span class="sxs-lookup"><span data-stu-id="f18c3-252">Let's just delete all of the records from the `Order Details` table to circumvent the foreign key constraint.</span></span> <span data-ttu-id="f18c3-253">Visual Studio のサーバーエクスプローラーにアクセスし、[`NORTHWND.MDF`] ノードを右クリックして、[新しいクエリ] を選択します。</span><span class="sxs-lookup"><span data-stu-id="f18c3-253">Go to the Server Explorer in Visual Studio, right-click on the `NORTHWND.MDF` node, and choose New Query.</span></span> <span data-ttu-id="f18c3-254">次に、クエリウィンドウで、次の SQL ステートメントを実行します。 `DELETE FROM [Order Details]`</span><span class="sxs-lookup"><span data-stu-id="f18c3-254">Then, in the query window, run the following SQL statement: `DELETE FROM [Order Details]`</span></span>

<span data-ttu-id="f18c3-255">[Order Details テーブルからすべてのレコードを削除 ![には](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image35.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image34.png)</span><span class="sxs-lookup"><span data-stu-id="f18c3-255">[![Delete All Records from the Order Details Table](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image35.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image34.png)</span></span>

<span data-ttu-id="f18c3-256">**図 14**: `Order Details` テーブルからすべてのレコードを削除[する (クリックすると、フルサイズの画像が表示](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image36.png)されます)</span><span class="sxs-lookup"><span data-stu-id="f18c3-256">**Figure 14**: Delete All Records from the `Order Details` Table ([Click to view full-size image](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image36.png))</span></span>

<span data-ttu-id="f18c3-257">`Order Details` テーブルをクリアした後、[削除] ボタンをクリックすると、エラーが発生することなく製品が削除されます。</span><span class="sxs-lookup"><span data-stu-id="f18c3-257">After clearing out the `Order Details` table clicking on the Delete button will delete the product without error.</span></span> <span data-ttu-id="f18c3-258">[削除] ボタンをクリックしても製品が削除されない場合は、GridView の `DataKeyNames` プロパティが主キーフィールド (`ProductID`) に設定されていることを確認します。</span><span class="sxs-lookup"><span data-stu-id="f18c3-258">If clicking on the Delete button does not delete the product, check to ensure that the GridView's `DataKeyNames` property is set to the primary key field (`ProductID`).</span></span>

> [!NOTE]
> <span data-ttu-id="f18c3-259">[削除] ボタンをクリックすると、ポストバック ensues とレコードが削除されます。</span><span class="sxs-lookup"><span data-stu-id="f18c3-259">When clicking on the Delete button a postback ensues and the record is deleted.</span></span> <span data-ttu-id="f18c3-260">間違った行の [削除] ボタンを誤ってクリックすることは簡単であるため、これは危険になる可能性があります。</span><span class="sxs-lookup"><span data-stu-id="f18c3-260">This can be dangerous since it is easy to accidentally click on the wrong row's Delete button.</span></span> <span data-ttu-id="f18c3-261">今後のチュートリアルでは、レコードの削除時にクライアント側の確認を追加する方法について説明します。</span><span class="sxs-lookup"><span data-stu-id="f18c3-261">In a future tutorial we'll see how to add a client-side confirmation when deleting a record.</span></span>

## <a name="editing-data-with-the-gridview"></a><span data-ttu-id="f18c3-262">GridView を使用したデータの編集</span><span class="sxs-lookup"><span data-stu-id="f18c3-262">Editing Data with the GridView</span></span>

<span data-ttu-id="f18c3-263">GridView コントロールでは、削除と共に、組み込みの行レベルの編集もサポートされています。</span><span class="sxs-lookup"><span data-stu-id="f18c3-263">Along with deleting, the GridView control also provides built-in row-level editing support.</span></span> <span data-ttu-id="f18c3-264">編集をサポートするように GridView を構成すると、編集ボタンの列が追加されます。</span><span class="sxs-lookup"><span data-stu-id="f18c3-264">Configuring a GridView to support editing adds a column of Edit buttons.</span></span> <span data-ttu-id="f18c3-265">エンドユーザーの観点からは、行の [編集] ボタンをクリックすると、その行が編集可能になり、既存の値を含むテキストボックスにセルを変換し、[編集] ボタンを [更新] ボタンと [キャンセル] ボタンに置き換えます。</span><span class="sxs-lookup"><span data-stu-id="f18c3-265">From the end user's perspective, clicking a row's Edit button causes that row to become editable, turning the cells into textboxes containing the existing values and replacing the Edit button with Update and Cancel buttons.</span></span> <span data-ttu-id="f18c3-266">必要な変更を行った後、エンドユーザーは [更新] ボタンをクリックして変更をコミットするか、[キャンセル] ボタンをクリックして変更を破棄することができます。</span><span class="sxs-lookup"><span data-stu-id="f18c3-266">After making their desired changes, the end user can click the Update button to commit the changes or the Cancel button to discard them.</span></span> <span data-ttu-id="f18c3-267">どちらの場合も、[更新] または [キャンセル] をクリックすると、GridView は編集前の状態に戻ります。</span><span class="sxs-lookup"><span data-stu-id="f18c3-267">In either case, after clicking Update or Cancel the GridView returns to its pre-editing state.</span></span>

<span data-ttu-id="f18c3-268">ページ開発者としての観点から、エンドユーザーが特定の行の [編集] ボタンをクリックすると、ポストバック ensues と GridView によって次の手順が実行されます。</span><span class="sxs-lookup"><span data-stu-id="f18c3-268">From our perspective as the page developer, when the end user clicks the Edit button for a particular row, a postback ensues and the GridView performs the following steps:</span></span>

1. <span data-ttu-id="f18c3-269">GridView の `EditItemIndex` プロパティは、編集ボタンがクリックされた行のインデックスに割り当てられます。</span><span class="sxs-lookup"><span data-stu-id="f18c3-269">The GridView's `EditItemIndex` property is assigned to the index of the row whose Edit button was clicked</span></span>
2. <span data-ttu-id="f18c3-270">GridView は、`Select()` メソッドを呼び出すことによって、それ自体を ObjectDataSource に再バインドします。</span><span class="sxs-lookup"><span data-stu-id="f18c3-270">The GridView rebinds itself to the ObjectDataSource by invoking its `Select()` method</span></span>
3. <span data-ttu-id="f18c3-271">`EditItemIndex` に一致する行インデックスは、"編集モード" で表示されます。</span><span class="sxs-lookup"><span data-stu-id="f18c3-271">The row index that matches the `EditItemIndex` is rendered in "edit mode."</span></span> <span data-ttu-id="f18c3-272">このモードでは、[編集] ボタンは、[更新] ボタンと [キャンセル] ボタン、および `ReadOnly` プロパティが False (既定値) になっている連結フィールドに置き換えられ、`Text` のプロパティがデータフィールドの値に割り当てられます。</span><span class="sxs-lookup"><span data-stu-id="f18c3-272">In this mode, the Edit button is replaced by Update and Cancel buttons and BoundFields whose `ReadOnly` properties are False (the default) are rendered as TextBox Web controls whose `Text` properties are assigned to the data fields' values.</span></span>

<span data-ttu-id="f18c3-273">この時点で、マークアップがブラウザーに返され、エンドユーザーは行のデータに変更を加えることができます。</span><span class="sxs-lookup"><span data-stu-id="f18c3-273">At this point the markup is returned to the browser, allowing the end user to make any changes to the row's data.</span></span> <span data-ttu-id="f18c3-274">ユーザーが [更新] ボタンをクリックすると、ポストバックが発生し、GridView は次の手順を実行します。</span><span class="sxs-lookup"><span data-stu-id="f18c3-274">When the user clicks the Update button, a postback occurs and the GridView performs the following steps:</span></span>

1. <span data-ttu-id="f18c3-275">ObjectDataSource の `UpdateParameters` 値には、エンドユーザーが GridView の編集インターフェイスに入力した値が割り当てられます。</span><span class="sxs-lookup"><span data-stu-id="f18c3-275">The ObjectDataSource's `UpdateParameters` value(s) are assigned the values entered by the end user into the GridView's editing interface</span></span>
2. <span data-ttu-id="f18c3-276">ObjectDataSource の `Update()` メソッドが呼び出され、指定されたレコードを更新しています</span><span class="sxs-lookup"><span data-stu-id="f18c3-276">The ObjectDataSource's `Update()` method is invoked, updating the specified record</span></span>
3. <span data-ttu-id="f18c3-277">GridView は、`Select()` メソッドを呼び出すことによって、それ自体を ObjectDataSource に再バインドします。</span><span class="sxs-lookup"><span data-stu-id="f18c3-277">The GridView rebinds itself to the ObjectDataSource by invoking its `Select()` method</span></span>

<span data-ttu-id="f18c3-278">手順 1. で `UpdateParameters` に割り当てられた主キー値は、`DataKeyNames` プロパティで指定された値から取得されますが、非主キー値は、編集された行のテキストボックス Web コントロールのテキストから取得されます。</span><span class="sxs-lookup"><span data-stu-id="f18c3-278">The primary key values assigned to the `UpdateParameters` in Step 1 come from the values specified in the `DataKeyNames` property, whereas the non-primary key values come from the text in the TextBox Web controls for the edited row.</span></span> <span data-ttu-id="f18c3-279">削除と同様に、GridView の `DataKeyNames` プロパティを正しく設定することが重要です。</span><span class="sxs-lookup"><span data-stu-id="f18c3-279">As with deleting, it is vital that a GridView's `DataKeyNames` property be correctly set.</span></span> <span data-ttu-id="f18c3-280">この値が指定されていない場合は、手順 1. で `UpdateParameters` 主キーの値に `Nothing` という値が割り当てられます。これにより、手順 2. で更新されたレコードは生成されません。</span><span class="sxs-lookup"><span data-stu-id="f18c3-280">If it's missing, the `UpdateParameters` primary key value will be assigned a value of `Nothing` in Step 1, which in turn will not result in any updated records in Step 2.</span></span>

<span data-ttu-id="f18c3-281">編集機能は、GridView のスマートタグの [編集を有効にする] チェックボックスをオンにするだけでアクティブにすることができます。</span><span class="sxs-lookup"><span data-stu-id="f18c3-281">Editing functionality can be activated by simply checking the Enable Editing checkbox in the GridView's smart tag.</span></span>

![[編集を有効にする] チェックボックスをオンにします。](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image37.png)

<span data-ttu-id="f18c3-283">**図 15**: [編集を有効にする] チェックボックスをオンにする</span><span class="sxs-lookup"><span data-stu-id="f18c3-283">**Figure 15**: Check the Enable Editing Checkbox</span></span>

<span data-ttu-id="f18c3-284">[編集を有効にする] チェックボックスをオンにすると、必要に応じて CommandField が追加され、その `ShowEditButton` プロパティが `True`に設定されます。</span><span class="sxs-lookup"><span data-stu-id="f18c3-284">Checking the Enable Editing checkbox will add a CommandField (if needed) and set its `ShowEditButton` property to `True`.</span></span> <span data-ttu-id="f18c3-285">前に説明したように、commandfield には、CommandField に表示される一連のボタンを示す `ShowXButton` のプロパティが多数含まれています。</span><span class="sxs-lookup"><span data-stu-id="f18c3-285">As we saw earlier, the CommandField contains a number of `ShowXButton` properties that indicate what series of buttons are displayed in the CommandField.</span></span> <span data-ttu-id="f18c3-286">[編集を有効にする] チェックボックスをオンにすると、既存の CommandField に `ShowEditButton` プロパティが追加されます。</span><span class="sxs-lookup"><span data-stu-id="f18c3-286">Checking the Enable Editing checkbox adds the `ShowEditButton` property to the existing CommandField:</span></span>

[!code-aspx[Main](an-overview-of-inserting-updating-and-deleting-data-vb/samples/sample6.aspx)]

<span data-ttu-id="f18c3-287">基本的な編集サポートを追加するだけです。</span><span class="sxs-lookup"><span data-stu-id="f18c3-287">That's all there is to adding rudimentary editing support.</span></span> <span data-ttu-id="f18c3-288">Figure16 が示すように、編集インターフェイスは、`ReadOnly` プロパティが `False` (既定) に設定されている各 BoundField をテキストボックスとしてレンダリングします。</span><span class="sxs-lookup"><span data-stu-id="f18c3-288">As Figure16 shows, the editing interface is rather crude each BoundField whose `ReadOnly` property is set to `False` (the default) is rendered as a TextBox.</span></span> <span data-ttu-id="f18c3-289">これには、他のテーブルに対するキーである `CategoryID` や `SupplierID`などのフィールドが含まれます。</span><span class="sxs-lookup"><span data-stu-id="f18c3-289">This includes fields like `CategoryID` and `SupplierID`, which are keys to other tables.</span></span>

<span data-ttu-id="f18c3-290">[[Chai s Edit] ボタンをクリック ![と、その行が編集モードで表示されます。](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image39.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image38.png)</span><span class="sxs-lookup"><span data-stu-id="f18c3-290">[![Clicking Chai s Edit Button Displays the Row in Edit Mode](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image39.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image38.png)</span></span>

<span data-ttu-id="f18c3-291">**図 16**: [Chai s] 編集ボタンをクリックすると、編集モードで行が表示されます ([クリックすると、フルサイズの画像が表示](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image40.png)されます)</span><span class="sxs-lookup"><span data-stu-id="f18c3-291">**Figure 16**: Clicking Chai s Edit Button Displays the Row in Edit Mode ([Click to view full-size image](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image40.png))</span></span>

<span data-ttu-id="f18c3-292">外部キーの値を直接編集するようにユーザーに依頼するだけでなく、編集インターフェイスのインターフェイスには次のような意味がありません。</span><span class="sxs-lookup"><span data-stu-id="f18c3-292">In addition to asking users to edit foreign key values directly, the editing interface's interface is lacking in the following ways:</span></span>

- <span data-ttu-id="f18c3-293">データベースに存在しない `CategoryID` または `SupplierID` をユーザーが入力すると、`UPDATE` は foreign key 制約に違反し、例外が発生します。</span><span class="sxs-lookup"><span data-stu-id="f18c3-293">If the user enters a `CategoryID` or `SupplierID` that does not exist in the database, the `UPDATE` will violate a foreign key constraint, causing an exception to be raised.</span></span>
- <span data-ttu-id="f18c3-294">編集インターフェイスには検証が含まれていません。</span><span class="sxs-lookup"><span data-stu-id="f18c3-294">The editing interface doesn't include any validation.</span></span> <span data-ttu-id="f18c3-295">必要な値 (`ProductName`など) が指定されていない場合、または数値が求められる文字列値を入力する場合 ("多すぎる場合" など)。</span><span class="sxs-lookup"><span data-stu-id="f18c3-295">If you don't provide a required value (such as `ProductName`), or enter a string value where a numeric value is expected (such as entering "Too much!"</span></span> <span data-ttu-id="f18c3-296">[`UnitPrice`] ボックスに、例外がスローされます。</span><span class="sxs-lookup"><span data-stu-id="f18c3-296">into the `UnitPrice` textbox), an exception will be thrown.</span></span> <span data-ttu-id="f18c3-297">今後のチュートリアルでは、編集中のユーザーインターフェイスに検証コントロールを追加する方法を確認します。</span><span class="sxs-lookup"><span data-stu-id="f18c3-297">A future tutorial will examine how to add validation controls to the editing user interface.</span></span>
- <span data-ttu-id="f18c3-298">現時点では、読み取り専用ではない*すべて*の製品フィールドを GridView に含める必要があります。</span><span class="sxs-lookup"><span data-stu-id="f18c3-298">Currently, *all* product fields that are not read-only must be included in the GridView.</span></span> <span data-ttu-id="f18c3-299">GridView からフィールドを削除すると `UnitPrice`、データを更新するときに、GridView によって `UnitPrice` `UpdateParameters` 値が設定されません。これにより、データベースレコードの `UnitPrice` が `NULL` 値に変更されます。</span><span class="sxs-lookup"><span data-stu-id="f18c3-299">If we were to remove a field from the GridView, say `UnitPrice`, when updating the data the GridView would not set the `UnitPrice` `UpdateParameters` value, which would change the database record's `UnitPrice` to a `NULL` value.</span></span> <span data-ttu-id="f18c3-300">同様に、`ProductName`などの必須フィールドが GridView から削除された場合、更新は失敗し、前述の "*Column ' ProductName ' では null が許可されません*" という例外が表示されます。</span><span class="sxs-lookup"><span data-stu-id="f18c3-300">Similarly, if a required field, such as `ProductName`, is removed from the GridView, the update will fail with the same "*Column 'ProductName' does not allow nulls*" exception mentioned above.</span></span>
- <span data-ttu-id="f18c3-301">編集インターフェイスの書式設定は、必要に応じて大きくなります。</span><span class="sxs-lookup"><span data-stu-id="f18c3-301">The editing interface formatting leaves a lot to be desired.</span></span> <span data-ttu-id="f18c3-302">`UnitPrice` は、4つの小数点を使用して表示されます。</span><span class="sxs-lookup"><span data-stu-id="f18c3-302">The `UnitPrice` is shown with four decimal points.</span></span> <span data-ttu-id="f18c3-303">`CategoryID` と `SupplierID` の値には、システム内のカテゴリとサプライヤーを一覧表示する DropDownLists があることが理想的です。</span><span class="sxs-lookup"><span data-stu-id="f18c3-303">Ideally the `CategoryID` and `SupplierID` values would contain DropDownLists that list the categories and suppliers in the system.</span></span>

<span data-ttu-id="f18c3-304">ここでは、このような欠点がありますが、今後のチュートリアルで対処する予定です。</span><span class="sxs-lookup"><span data-stu-id="f18c3-304">These are all shortcomings that we'll have to live with for now, but will be addressed in future tutorials.</span></span>

## <a name="inserting-editing-and-deleting-data-with-the-detailsview"></a><span data-ttu-id="f18c3-305">DetailsView を使用したデータの挿入、編集、および削除</span><span class="sxs-lookup"><span data-stu-id="f18c3-305">Inserting, Editing, and Deleting Data with the DetailsView</span></span>

<span data-ttu-id="f18c3-306">前のチュートリアルで見たように、DetailsView コントロールでは一度に1つのレコードが表示され、GridView と同様に、現在表示されているレコードを編集および削除できます。</span><span class="sxs-lookup"><span data-stu-id="f18c3-306">As we've seen in earlier tutorials, the DetailsView control displays one record at a time and, like the GridView, allows for editing and deleting of the currently displayed record.</span></span> <span data-ttu-id="f18c3-307">DetailsView の項目の編集と削除に関するエンドユーザーの経験と、ASP.NET 側からのワークフローの両方が、GridView の項目と同じです。</span><span class="sxs-lookup"><span data-stu-id="f18c3-307">Both the end user's experience with editing and deleting items from a DetailsView and the workflow from the ASP.NET side is identical to that of the GridView.</span></span> <span data-ttu-id="f18c3-308">DetailsView と GridView の違いは、組み込みの挿入サポートも用意されていることです。</span><span class="sxs-lookup"><span data-stu-id="f18c3-308">Where the DetailsView differs from the GridView is that it also provides built-in inserting support.</span></span>

<span data-ttu-id="f18c3-309">GridView のデータ変更機能をデモンストレーションするには、まず、既存の GridView の上にある `Basics.aspx` ページに DetailsView を追加し、DetailsView のスマートタグを使用して既存の ObjectDataSource にバインドします。</span><span class="sxs-lookup"><span data-stu-id="f18c3-309">To demonstrate the data modification capabilities of the GridView, start by adding a DetailsView to the `Basics.aspx` page above the existing GridView and bind it to the existing ObjectDataSource through the DetailsView's smart tag.</span></span> <span data-ttu-id="f18c3-310">次に、DetailsView の `Height` と `Width` プロパティを消去し、スマートタグの [ページングを有効にする] オプションをオンにします。</span><span class="sxs-lookup"><span data-stu-id="f18c3-310">Next, clear out the DetailsView's `Height` and `Width` properties, and check the Enable Paging option from the smart tag.</span></span> <span data-ttu-id="f18c3-311">編集、挿入、および削除のサポートを有効にするには、[編集を有効にする]、[挿入を有効にする]、および [スマートタグの削除] チェックボックスをオンにするだけです。</span><span class="sxs-lookup"><span data-stu-id="f18c3-311">To enable editing, inserting, and deleting support, simply check the Enable Editing, Enable Inserting, and Enable Deleting checkboxes in the smart tag.</span></span>

![編集、挿入、および削除をサポートするように DetailsView を構成する](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image41.png)

<span data-ttu-id="f18c3-313">**図 17**: 編集、挿入、および削除をサポートするように DetailsView を構成する</span><span class="sxs-lookup"><span data-stu-id="f18c3-313">**Figure 17**: Configure the DetailsView to Support Editing, Inserting, and Deleting</span></span>

<span data-ttu-id="f18c3-314">GridView と同様に、編集、挿入、または削除のサポートを追加すると、次の宣言構文に示すように CommandField が DetailsView に追加されます。</span><span class="sxs-lookup"><span data-stu-id="f18c3-314">As with the GridView, adding editing, inserting, or deleting support adds a CommandField to the DetailsView, as the following declarative syntax shows:</span></span>

[!code-aspx[Main](an-overview-of-inserting-updating-and-deleting-data-vb/samples/sample7.aspx)]

<span data-ttu-id="f18c3-315">DetailsView の場合は、既定で Columns コレクションの最後に CommandField が表示されることに注意してください。</span><span class="sxs-lookup"><span data-stu-id="f18c3-315">Note that for the DetailsView the CommandField appears at the end of the Columns collection by default.</span></span> <span data-ttu-id="f18c3-316">DetailsView のフィールドは行として表示されるため、CommandField は、DetailsView の下部にある [挿入]、[編集]、および [削除] の各ボタンがある行として表示されます。</span><span class="sxs-lookup"><span data-stu-id="f18c3-316">Since the DetailsView's fields are rendered as rows, the CommandField appears as a row with Insert, Edit, and Delete buttons at the bottom of the DetailsView.</span></span>

<span data-ttu-id="f18c3-317">[編集、挿入、および削除をサポートするように DetailsView を構成 ![には](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image43.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image42.png)</span><span class="sxs-lookup"><span data-stu-id="f18c3-317">[![Configure the DetailsView to Support Editing, Inserting, and Deleting](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image43.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image42.png)</span></span>

<span data-ttu-id="f18c3-318">**図 18**: DetailsView を構成して編集、挿入、および削除をサポートする ([クリックしてフルサイズのイメージを表示する](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image44.png))</span><span class="sxs-lookup"><span data-stu-id="f18c3-318">**Figure 18**: Configure the DetailsView to Support Editing, Inserting, and Deleting ([Click to view full-size image](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image44.png))</span></span>

<span data-ttu-id="f18c3-319">[削除] ボタンをクリックすると、GridView: ポストバックと同じイベントのシーケンスが開始されます。その後に、`DataKeyNames` 値に基づいて ObjectDataSource の `DeleteParameters` を設定する DetailsView が続きます。とは、ObjectDataSource の `Delete()` メソッドを呼び出すことによって完了します。これにより、実際には、データベースから製品が削除されます。</span><span class="sxs-lookup"><span data-stu-id="f18c3-319">Clicking on the Delete button starts the same sequence of events as with the GridView: a postback; followed by the DetailsView populating its ObjectDataSource's `DeleteParameters` based on the `DataKeyNames` values; and completed with a call its ObjectDataSource's `Delete()` method, which actually removes the product from the database.</span></span> <span data-ttu-id="f18c3-320">DetailsView での編集は、GridView の場合と同じ方法でも機能します。</span><span class="sxs-lookup"><span data-stu-id="f18c3-320">Editing in the DetailsView also works in a fashion identical to that of the GridView.</span></span>

<span data-ttu-id="f18c3-321">挿入の場合、エンドユーザーには新しいボタンが表示され、クリックすると、"挿入モード" で DetailsView がレンダリングされます。</span><span class="sxs-lookup"><span data-stu-id="f18c3-321">For inserting, the end user is presented with a New button that, when clicked, renders the DetailsView in "insert mode."</span></span> <span data-ttu-id="f18c3-322">"挿入モード" では、新しいボタンは [挿入] ボタンと [キャンセル] ボタンに置き換えられ、`InsertVisible` プロパティが `True` (既定) に設定されている連結フィールドのみが表示されます。</span><span class="sxs-lookup"><span data-stu-id="f18c3-322">With "insert mode" the New button is replaced by Insert and Cancel buttons and only those BoundFields whose `InsertVisible` property is set to `True` (the default) are displayed.</span></span> <span data-ttu-id="f18c3-323">`ProductID`などの自動インクリメントフィールドとして識別されたこれらのデータフィールドの[Insertvisible プロパティ](https://msdn.microsoft.com/library/system.web.ui.webcontrols.datacontrolfield.insertvisible(VS.80).aspx)は、スマートタグを介してデータソースに DetailsView をバインドするときに `False` に設定されます。</span><span class="sxs-lookup"><span data-stu-id="f18c3-323">Those data fields identified as auto-increment fields, such as `ProductID`, have their [InsertVisible property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.datacontrolfield.insertvisible(VS.80).aspx) set to `False` when binding the DetailsView to the data source through the smart tag.</span></span>

<span data-ttu-id="f18c3-324">スマートタグを使用してデータソースを DetailsView にバインドすると、Visual Studio は、自動インクリメントフィールドに対してのみ、`InsertVisible` プロパティを `False` に設定します。</span><span class="sxs-lookup"><span data-stu-id="f18c3-324">When binding a data source to a DetailsView through the smart tag, Visual Studio sets the `InsertVisible` property to `False` only for auto-increment fields.</span></span> <span data-ttu-id="f18c3-325">`CategoryName` や `SupplierName`などの読み取り専用フィールドは、`InsertVisible` プロパティが明示的に `False`に設定されていない限り、"挿入モード" ユーザーインターフェイスに表示されます。</span><span class="sxs-lookup"><span data-stu-id="f18c3-325">Read-only fields, like `CategoryName` and `SupplierName`, will be displayed in the "insert mode" user interface unless their `InsertVisible` property is explicitly set to `False`.</span></span> <span data-ttu-id="f18c3-326">この2つのフィールドの `InsertVisible` プロパティを `False`に設定します。そのためには、DetailsView の宣言構文を使用するか、スマートタグ内の [フィールドの編集] リンクを使用します。</span><span class="sxs-lookup"><span data-stu-id="f18c3-326">Take a moment to set these two fields' `InsertVisible` properties to `False`, either through the DetailsView's declarative syntax or through the Edit Fields link in the smart tag.</span></span> <span data-ttu-id="f18c3-327">図19は、[フィールドの編集] リンクをクリックして `False` する `InsertVisible` のプロパティを設定する方法を示しています。</span><span class="sxs-lookup"><span data-stu-id="f18c3-327">Figure 19 shows setting the `InsertVisible` properties to `False` by clicking on the Edit Fields link.</span></span>

<span data-ttu-id="f18c3-328">[Northwind Traders ![では、Acme 紅茶を提供](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image46.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image45.png)</span><span class="sxs-lookup"><span data-stu-id="f18c3-328">[![Northwind Traders Now Offers Acme Tea](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image46.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image45.png)</span></span>

<span data-ttu-id="f18c3-329">**図 19**: Northwind Traders が Acme 茶を提供するようになりました ([クリックしてフルサイズの画像を表示する](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image47.png))</span><span class="sxs-lookup"><span data-stu-id="f18c3-329">**Figure 19**: Northwind Traders Now Offers Acme Tea ([Click to view full-size image](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image47.png))</span></span>

<span data-ttu-id="f18c3-330">`InsertVisible` のプロパティを設定した後、ブラウザーで `Basics.aspx` ページを表示し、[新規] ボタンをクリックします。</span><span class="sxs-lookup"><span data-stu-id="f18c3-330">After setting the `InsertVisible` properties, view the `Basics.aspx` page in a browser and click the New button.</span></span> <span data-ttu-id="f18c3-331">図20に、新しい飲み物 (Acme 茶) を製品ラインに追加する場合の DetailsView を示します。</span><span class="sxs-lookup"><span data-stu-id="f18c3-331">Figure 20 shows the DetailsView when adding a new beverage, Acme Tea, to our product line.</span></span>

<span data-ttu-id="f18c3-332">[Northwind Traders ![では、Acme 紅茶を提供](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image49.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image48.png)</span><span class="sxs-lookup"><span data-stu-id="f18c3-332">[![Northwind Traders Now Offers Acme Tea](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image49.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image48.png)</span></span>

<span data-ttu-id="f18c3-333">**図 20**: Northwind Traders が Acme 茶を提供するようになりました ([クリックしてフルサイズの画像を表示する](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image50.png))</span><span class="sxs-lookup"><span data-stu-id="f18c3-333">**Figure 20**: Northwind Traders Now Offers Acme Tea ([Click to view full-size image](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image50.png))</span></span>

<span data-ttu-id="f18c3-334">Acme 紅茶の詳細を入力し、[挿入] ボタンをクリックすると、ポストバック ensues と新しいレコードが `Products` データベーステーブルに追加されます。</span><span class="sxs-lookup"><span data-stu-id="f18c3-334">After entering the details for Acme Tea and clicking the Insert button, a postback ensues and the new record is added to the `Products` database table.</span></span> <span data-ttu-id="f18c3-335">この DetailsView はデータベーステーブル内に存在する順に製品を一覧表示しているため、新しい製品を表示するには、最後の製品にページを表示する必要があります。</span><span class="sxs-lookup"><span data-stu-id="f18c3-335">Since this DetailsView lists the products in order with which they exist in the database table, we must page to the last product in order to see the new product.</span></span>

<span data-ttu-id="f18c3-336">[Acme 茶の ![の詳細](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image52.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image51.png)</span><span class="sxs-lookup"><span data-stu-id="f18c3-336">[![Details for Acme Tea](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image52.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image51.png)</span></span>

<span data-ttu-id="f18c3-337">**図 21**: Acme 紅茶の詳細 ([クリックすると、フルサイズの画像が表示](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image53.png)される)</span><span class="sxs-lookup"><span data-stu-id="f18c3-337">**Figure 21**: Details for Acme Tea ([Click to view full-size image](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image53.png))</span></span>

> [!NOTE]
> <span data-ttu-id="f18c3-338">DetailsView の[Currentmode プロパティ](https://msdn.microsoft.com/library/system.web.ui.webcontrols.detailsview.currentmode(VS.80).aspx)は、表示されているインターフェイスを示します。 `Edit`、`Insert`、`ReadOnly`のいずれかの値を指定できます。</span><span class="sxs-lookup"><span data-stu-id="f18c3-338">The DetailsView's [CurrentMode property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.detailsview.currentmode(VS.80).aspx) indicates the interface being displayed and can be one of the following values: `Edit`, `Insert`, or `ReadOnly`.</span></span> <span data-ttu-id="f18c3-339">[Defaultmode プロパティ](https://msdn.microsoft.com/library/system.web.ui.webcontrols.detailsview.defaultmode(VS.80).aspx)は、編集または挿入が完了した後に detailsview が返すモードを示します。これは、編集モードまたは挿入モードで永続的に使用される detailsview を表示する場合に便利です。</span><span class="sxs-lookup"><span data-stu-id="f18c3-339">The [DefaultMode property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.detailsview.defaultmode(VS.80).aspx) indicates the mode the DetailsView returns to after an edit or insert has been completed and is useful for displaying a DetailsView that is permanently in edit or insert mode.</span></span>

<span data-ttu-id="f18c3-340">ポイントとクリックによる DetailsView の挿入および編集機能は、GridView と同じ制限を受けません。ユーザーは、テキストボックスを使用して、既存の `CategoryID` と `SupplierID` 値を入力する必要があります。インターフェイスに検証ロジックがありません。`NULL` 値が許可されていないか、データベースレベルで既定値が指定されていないすべての product フィールドは、挿入インターフェイスに含める必要があります。</span><span class="sxs-lookup"><span data-stu-id="f18c3-340">The point and click inserting and editing capabilities of the DetailsView suffer from the same limitations as the GridView: the user must enter existing `CategoryID` and `SupplierID` values through a textbox; the interface lacks any validation logic; all product fields that do not allow `NULL` values or don't have a default value specified at the database level must be included in the inserting interface, and so on.</span></span>

<span data-ttu-id="f18c3-341">今後の記事で GridView の編集インターフェイスを拡張および強化するために検討する手法は、DetailsView コントロールの編集および挿入インターフェイスにも適用できます。</span><span class="sxs-lookup"><span data-stu-id="f18c3-341">The techniques we will examine for extending and enhancing the GridView's editing interface in future articles can be applied to the DetailsView control's editing and inserting interfaces as well.</span></span>

## <a name="using-the-formview-for-a-more-flexible-data-modification-user-interface"></a><span data-ttu-id="f18c3-342">より柔軟なデータ変更ユーザーインターフェイスに FormView を使用する</span><span class="sxs-lookup"><span data-stu-id="f18c3-342">Using the FormView for a More Flexible Data Modification User Interface</span></span>

<span data-ttu-id="f18c3-343">FormView には、データの挿入、編集、および削除のための組み込みサポートが用意されていますが、フィールドではなくテンプレートが使用されているので、データを提供するために GridView および DetailsView コントロールによって使用される BoundFields や CommandField を追加する場所はありません。変更インターフェイス。</span><span class="sxs-lookup"><span data-stu-id="f18c3-343">The FormView offers built-in support for inserting, editing, and deleting data, but because it uses templates instead of fields there's no place to add the BoundFields or the CommandField used by the GridView and DetailsView controls to provide the data modification interface.</span></span> <span data-ttu-id="f18c3-344">代わりに、このインターフェイスでは、新しい項目を追加するとき、または既存の項目を編集するときにユーザー入力を収集するための Web コントロールを、適切なテンプレートに手動で追加する必要があります。</span><span class="sxs-lookup"><span data-stu-id="f18c3-344">Instead, this interface the Web controls for collecting user input when adding a new item or editing an existing one along with the New, Edit, Delete, Insert, Update, and Cancel buttons must be added manually to the appropriate templates.</span></span> <span data-ttu-id="f18c3-345">幸い、Visual Studio では、スマートタグのドロップダウンリストを使用してデータソースに FormView をバインドするときに、必要なインターフェイスが自動的に作成されます。</span><span class="sxs-lookup"><span data-stu-id="f18c3-345">Fortunately, Visual Studio will automatically create the needed interface when binding the FormView to a data source through the drop-down list in its smart tag.</span></span>

<span data-ttu-id="f18c3-346">これらの手法を説明するために、まず、FormView を `Basics.aspx` ページに追加し、FormView のスマートタグから、既に作成されている ObjectDataSource にバインドします。</span><span class="sxs-lookup"><span data-stu-id="f18c3-346">To illustrate these techniques, start by adding a FormView to the `Basics.aspx` page and, from the FormView's smart tag, bind it to the ObjectDataSource already created.</span></span> <span data-ttu-id="f18c3-347">これにより、[新規]、[編集]、[削除]、[挿入]、[更新]、および [キャンセル] の各ボタンのユーザーの入力およびボタン Web コントロールを収集するための、TextBox Web コントロールを含む FormView の `EditItemTemplate`、`InsertItemTemplate`、および `ItemTemplate` が生成されます。</span><span class="sxs-lookup"><span data-stu-id="f18c3-347">This will generate an `EditItemTemplate`, `InsertItemTemplate`, and `ItemTemplate` for the FormView with TextBox Web controls for collecting the user's input and Button Web controls for the New, Edit, Delete, Insert, Update, and Cancel buttons.</span></span> <span data-ttu-id="f18c3-348">さらに、FormView の `DataKeyNames` プロパティは、ObjectDataSource によって返されるオブジェクトの主キーフィールド (`ProductID`) に設定されます。</span><span class="sxs-lookup"><span data-stu-id="f18c3-348">Additionally, the FormView's `DataKeyNames` property is set to the primary key field (`ProductID`) of the object returned by the ObjectDataSource.</span></span> <span data-ttu-id="f18c3-349">最後に、FormView のスマートタグの [ページングを有効にする] オプションをオンにします。</span><span class="sxs-lookup"><span data-stu-id="f18c3-349">Lastly, check the Enable Paging option in the FormView's smart tag.</span></span>

<span data-ttu-id="f18c3-350">FormView が ObjectDataSource にバインドされた後の FormView の `ItemTemplate` の宣言型マークアップを次に示します。</span><span class="sxs-lookup"><span data-stu-id="f18c3-350">The following shows the declarative markup for the FormView's `ItemTemplate` after the FormView has been bound to the ObjectDataSource.</span></span> <span data-ttu-id="f18c3-351">既定では、各ブール値の product フィールドは、ラベル Web コントロールの `Text` プロパティにバインドされていますが、各ブール値フィールド (`Discontinued`) は、無効になっている CheckBox Web コントロールの `Checked` プロパティにバインドされています。</span><span class="sxs-lookup"><span data-stu-id="f18c3-351">By default, each non-Boolean value product field is bound to the `Text` property of a Label Web control while each Boolean value field (`Discontinued`) is bound to the `Checked` property of a disabled CheckBox Web control.</span></span> <span data-ttu-id="f18c3-352">[新規]、[編集]、および [削除] の各ボタンをクリックしたときに特定の FormView 動作をトリガーするには、`CommandName` 値をそれぞれ `New`、`Edit`、および `Delete`に設定する必要があります。</span><span class="sxs-lookup"><span data-stu-id="f18c3-352">In order for the New, Edit, and Delete buttons to trigger certain FormView behavior when clicked, it is imperative that their `CommandName` values be set to `New`, `Edit`, and `Delete`, respectively.</span></span>

[!code-aspx[Main](an-overview-of-inserting-updating-and-deleting-data-vb/samples/sample8.aspx)]

<span data-ttu-id="f18c3-353">図22は、ブラウザーで表示したときに FormView の `ItemTemplate` を示しています。</span><span class="sxs-lookup"><span data-stu-id="f18c3-353">Figure 22 shows the FormView's `ItemTemplate` when viewed through a browser.</span></span> <span data-ttu-id="f18c3-354">各製品フィールドは、下部にある [新規]、[編集]、および [削除] の各ボタンと共に表示されます。</span><span class="sxs-lookup"><span data-stu-id="f18c3-354">Each product field is listed with the New, Edit, and Delete buttons at the bottom.</span></span>

<span data-ttu-id="f18c3-355">[既定 FormView ItemTemplate の ![[新規]、[編集]、および [削除] の各ボタンと共に各製品フィールドを一覧表示する](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image55.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image54.png)</span><span class="sxs-lookup"><span data-stu-id="f18c3-355">[![The Defaut FormView ItemTemplate Lists Each Product Field Along with New, Edit, and Delete Buttons](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image55.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image54.png)</span></span>

<span data-ttu-id="f18c3-356">**図 22**: 既定 FormView `ItemTemplate` では、各 Product フィールドと、New、Edit、および Delete の各ボタンが一覧表示されます ([クリックすると、フルサイズの画像が表示](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image56.png)されます)</span><span class="sxs-lookup"><span data-stu-id="f18c3-356">**Figure 22**: The Defaut FormView `ItemTemplate` Lists Each Product Field Along with New, Edit, and Delete Buttons ([Click to view full-size image](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image56.png))</span></span>

<span data-ttu-id="f18c3-357">GridView および DetailsView と同様に、[削除] ボタンをクリックするか、`CommandName` プロパティが [削除] に設定されているボタン、LinkButton、または ImageButton をクリックすると、ポストバックが発生し、FormView の `DataKeyNames` 値に基づいて ObjectDataSource の `DeleteParameters` が設定され、ObjectDataSource の `Delete()` メソッドが呼び出されます。</span><span class="sxs-lookup"><span data-stu-id="f18c3-357">Like with the GridView and DetailsView, clicking the Delete button or any Button, LinkButton, or ImageButton whose `CommandName` property is set to Delete causes a postback, populates the ObjectDataSource's `DeleteParameters` based on the FormView's `DataKeyNames` value, and invokes the ObjectDataSource's `Delete()` method.</span></span>

<span data-ttu-id="f18c3-358">[編集] ボタンをクリックすると、ポストバック ensues が表示され、データが `EditItemTemplate`に再バインドされます。これは編集インターフェイスを表示する役割を担います。</span><span class="sxs-lookup"><span data-stu-id="f18c3-358">When the Edit button is clicked a postback ensues and the data is rebound to the `EditItemTemplate`, which is responsible for rendering the editing interface.</span></span> <span data-ttu-id="f18c3-359">このインターフェイスには、[更新] ボタンと [キャンセル] ボタンと共に、データを編集するための Web コントロールが含まれています。</span><span class="sxs-lookup"><span data-stu-id="f18c3-359">This interface includes the Web controls for editing data along with the Update and Cancel buttons.</span></span> <span data-ttu-id="f18c3-360">Visual Studio によって生成される既定の `EditItemTemplate` には、自動インクリメントフィールド (`ProductID`) のラベル、非ブール値フィールドごとのテキストボックス、および各ブール値フィールドのチェックボックスが含まれています。</span><span class="sxs-lookup"><span data-stu-id="f18c3-360">The default `EditItemTemplate` generated by Visual Studio contains a Label for any auto-increment fields (`ProductID`), a TextBox for each non-Boolean value field, and a CheckBox for each Boolean value field.</span></span> <span data-ttu-id="f18c3-361">この動作は、GridView および DetailsView コントロールで自動生成された BoundFields によく似ています。</span><span class="sxs-lookup"><span data-stu-id="f18c3-361">This behavior is very similar to the auto-generated BoundFields in the GridView and DetailsView controls.</span></span>

> [!NOTE]
> <span data-ttu-id="f18c3-362">FormView の `EditItemTemplate` の自動生成に関する小さな問題の1つは、`CategoryName` や `SupplierName`など、読み取り専用のフィールドに対してテキストボックス Web コントロールをレンダリングすることです。</span><span class="sxs-lookup"><span data-stu-id="f18c3-362">One small issue with the FormView's auto-generation of the `EditItemTemplate` is that it renders TextBox Web controls for those fields that are read-only, such as `CategoryName` and `SupplierName`.</span></span> <span data-ttu-id="f18c3-363">これについては、後で説明します。</span><span class="sxs-lookup"><span data-stu-id="f18c3-363">We'll see how to account for this shortly.</span></span>

<span data-ttu-id="f18c3-364">`EditItemTemplate` のテキストボックスコントロールには、*双方向*のデータバインディングを使用して、対応するデータフィールドの値にバインドされた `Text` プロパティがあります。</span><span class="sxs-lookup"><span data-stu-id="f18c3-364">The TextBox controls in the `EditItemTemplate` have their `Text` property bound to the value of their corresponding data field using *two-way databinding*.</span></span> <span data-ttu-id="f18c3-365">`<%# Bind("dataField") %>`によって示される双方向のデータバインディングでは、データをテンプレートにバインドするときと、レコードを挿入または編集するために ObjectDataSource のパラメーターを設定するときの両方で、データバインドが実行されます。</span><span class="sxs-lookup"><span data-stu-id="f18c3-365">Two-way databinding, denoted by `<%# Bind("dataField") %>`, performs databinding both when binding data to the template and when populating the ObjectDataSource's parameters for inserting or editing records.</span></span> <span data-ttu-id="f18c3-366">つまり、ユーザーが `ItemTemplate`の [編集] ボタンをクリックすると、`Bind()` メソッドは、指定されたデータフィールドの値を返します。</span><span class="sxs-lookup"><span data-stu-id="f18c3-366">That is, when the user clicks the Edit button from the `ItemTemplate`, the `Bind()` method returns the specified data field value.</span></span> <span data-ttu-id="f18c3-367">ユーザーが変更を行って [更新] をクリックすると、`Bind()` を使用して指定されたデータフィールドに対応するポストバックされた値が ObjectDataSource の `UpdateParameters`に適用されます。</span><span class="sxs-lookup"><span data-stu-id="f18c3-367">After the user makes their changes and clicks Update, the values posted back that correspond to the data fields specified using `Bind()` are applied to the ObjectDataSource's `UpdateParameters`.</span></span> <span data-ttu-id="f18c3-368">または、`<%# Eval("dataField") %>`で示される一方向のデータバインディングでは、データをテンプレートにバインドするときにデータフィールドの値のみを取得し、ポストバック時にデータソースのパラメーターにユーザーが入力した値を返し*ません*。</span><span class="sxs-lookup"><span data-stu-id="f18c3-368">Alternatively, one-way databinding, denoted by `<%# Eval("dataField") %>`, only retrieves the data field values when binding data to the template and does *not* return the user-entered values to the data source's parameters on postback.</span></span>

<span data-ttu-id="f18c3-369">次の宣言型マークアップは、FormView の `EditItemTemplate`を示しています。</span><span class="sxs-lookup"><span data-stu-id="f18c3-369">The following declarative markup shows the FormView's `EditItemTemplate`.</span></span> <span data-ttu-id="f18c3-370">ここでは、`Bind()` メソッドが databinding 構文で使用されています。また、[更新] ボタンと [キャンセル] ボタンの Web コントロールの `CommandName` プロパティは、それに応じて設定されています。</span><span class="sxs-lookup"><span data-stu-id="f18c3-370">Note that the `Bind()` method is used in the databinding syntax here and that the Update and Cancel Button Web controls have their `CommandName` properties set accordingly.</span></span>

[!code-aspx[Main](an-overview-of-inserting-updating-and-deleting-data-vb/samples/sample9.aspx)]

<span data-ttu-id="f18c3-371">この時点で、`EditItemTemplate`を使用しようとすると、例外がスローされます。</span><span class="sxs-lookup"><span data-stu-id="f18c3-371">Our `EditItemTemplate`, at this point, will cause an exception to be thrown if we attempt to use it.</span></span> <span data-ttu-id="f18c3-372">問題は、`CategoryName` フィールドと `SupplierName` フィールドが、`EditItemTemplate`で TextBox Web コントロールとしてレンダリングされることです。</span><span class="sxs-lookup"><span data-stu-id="f18c3-372">The problem is that the `CategoryName` and `SupplierName` fields are rendered as TextBox Web controls in the `EditItemTemplate`.</span></span> <span data-ttu-id="f18c3-373">これらのテキストボックスをラベルに変更するか、完全に削除する必要があります。</span><span class="sxs-lookup"><span data-stu-id="f18c3-373">We either need to change these TextBoxes to Labels or remove them altogether.</span></span> <span data-ttu-id="f18c3-374">単純に単に `EditItemTemplate`から削除してみましょう。</span><span class="sxs-lookup"><span data-stu-id="f18c3-374">Let's simply delete them entirely from the `EditItemTemplate`.</span></span>

<span data-ttu-id="f18c3-375">図23では、[編集] ボタンをクリックすると、ブラウザーに FormView が表示されます。</span><span class="sxs-lookup"><span data-stu-id="f18c3-375">Figure 23 shows the FormView in a browser after the Edit button has been clicked for Chai.</span></span> <span data-ttu-id="f18c3-376">`ItemTemplate` に表示されている `SupplierName` フィールドと `CategoryName` フィールドは、`EditItemTemplate`から削除したばかりのものではなくなっています。</span><span class="sxs-lookup"><span data-stu-id="f18c3-376">Note that the `SupplierName` and `CategoryName` fields shown in the `ItemTemplate` are no longer present, as we just removed them from the `EditItemTemplate`.</span></span> <span data-ttu-id="f18c3-377">[更新] ボタンがクリックされると、FormView は GridView および DetailsView コントロールと同じ一連の手順を実行します。</span><span class="sxs-lookup"><span data-stu-id="f18c3-377">When the Update button is clicked the FormView proceeds through the same sequence of steps as the GridView and DetailsView controls.</span></span>

<span data-ttu-id="f18c3-378">[![既定では、EditItemTemplate は、各編集可能な Product フィールドをテキストボックスまたはチェックボックスとして表示します。](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image58.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image57.png)</span><span class="sxs-lookup"><span data-stu-id="f18c3-378">[![By Default the EditItemTemplate Shows Each Editable Product Field as a TextBox or CheckBox](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image58.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image57.png)</span></span>

<span data-ttu-id="f18c3-379">**図 23**: 既定では、`EditItemTemplate` は、編集可能な各製品フィールドをテキストボックスまたはチェックボックスとして表示します ([クリックすると、フルサイズの画像が表示](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image59.png)されます)</span><span class="sxs-lookup"><span data-stu-id="f18c3-379">**Figure 23**: By Default the `EditItemTemplate` Shows Each Editable Product Field as a TextBox or CheckBox ([Click to view full-size image](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image59.png))</span></span>

<span data-ttu-id="f18c3-380">[挿入] ボタンをクリックすると、FormView の `ItemTemplate` ポストバック ensues になります。</span><span class="sxs-lookup"><span data-stu-id="f18c3-380">When the Insert button is clicked the FormView's `ItemTemplate` a postback ensues.</span></span> <span data-ttu-id="f18c3-381">ただし、新しいレコードが追加されているため、FormView にデータがバインドされていません。</span><span class="sxs-lookup"><span data-stu-id="f18c3-381">However, no data is bound to the FormView because a new record is being added.</span></span> <span data-ttu-id="f18c3-382">`InsertItemTemplate` インターフェイスには、[挿入] ボタンと [キャンセル] ボタンと共に新しいレコードを追加するための Web コントロールが含まれています。</span><span class="sxs-lookup"><span data-stu-id="f18c3-382">The `InsertItemTemplate` interface includes the Web controls for adding a new record along with the Insert and Cancel buttons.</span></span> <span data-ttu-id="f18c3-383">Visual Studio によって生成される既定の `InsertItemTemplate` には、ブール値以外の各フィールドのテキストボックスと、自動生成された `EditItemTemplate`のインターフェイスと同様に、各ブール値フィールドのチェックボックスが含まれています。</span><span class="sxs-lookup"><span data-stu-id="f18c3-383">The default `InsertItemTemplate` generated by Visual Studio contains a TextBox for each non-Boolean value field and a CheckBox for each Boolean value field, similar to the auto-generated `EditItemTemplate`'s interface.</span></span> <span data-ttu-id="f18c3-384">TextBox コントロールの `Text` プロパティは、双方向のデータバインディングを使用して、対応するデータフィールドの値にバインドされます。</span><span class="sxs-lookup"><span data-stu-id="f18c3-384">The TextBox controls have their `Text` property bound to the value of their corresponding data field using two-way databinding.</span></span>

<span data-ttu-id="f18c3-385">次の宣言型マークアップは、FormView の `InsertItemTemplate`を示しています。</span><span class="sxs-lookup"><span data-stu-id="f18c3-385">The following declarative markup shows the FormView's `InsertItemTemplate`.</span></span> <span data-ttu-id="f18c3-386">ここでは、`Bind()` メソッドが databinding 構文で使用されています。また、[挿入] ボタンと [キャンセル] ボタンの Web コントロールには、それに応じて `CommandName` プロパティが設定されています。</span><span class="sxs-lookup"><span data-stu-id="f18c3-386">Note that the `Bind()` method is used in the databinding syntax here and that the Insert and Cancel Button Web controls have their `CommandName` properties set accordingly.</span></span>

[!code-aspx[Main](an-overview-of-inserting-updating-and-deleting-data-vb/samples/sample10.aspx)]

<span data-ttu-id="f18c3-387">`InsertItemTemplate`の FormView の自動生成にははらみがあります。</span><span class="sxs-lookup"><span data-stu-id="f18c3-387">There's a subtlety with the FormView's auto-generation of the `InsertItemTemplate`.</span></span> <span data-ttu-id="f18c3-388">具体的には、テキストボックス Web コントロールは、`CategoryName` や `SupplierName`など、読み取り専用のフィールドに対しても作成されます。</span><span class="sxs-lookup"><span data-stu-id="f18c3-388">Specifically, the TextBox Web controls are created even for those fields that are read-only, such as `CategoryName` and `SupplierName`.</span></span> <span data-ttu-id="f18c3-389">`EditItemTemplate`と同様に、これらのテキストボックスを `InsertItemTemplate`から削除する必要があります。</span><span class="sxs-lookup"><span data-stu-id="f18c3-389">Like with the `EditItemTemplate`, we need to remove these TextBoxes from the `InsertItemTemplate`.</span></span>

<span data-ttu-id="f18c3-390">図24は、新しい製品である Acme コーヒーを追加するときの、ブラウザーの FormView を示しています。</span><span class="sxs-lookup"><span data-stu-id="f18c3-390">Figure 24 shows the FormView in a browser when adding a new product, Acme Coffee.</span></span> <span data-ttu-id="f18c3-391">`ItemTemplate` に表示されている `SupplierName` フィールドと `CategoryName` フィールドは、削除したばかりで存在しないことに注意してください。</span><span class="sxs-lookup"><span data-stu-id="f18c3-391">Note that the `SupplierName` and `CategoryName` fields shown in the `ItemTemplate` are no longer present, as we just removed them.</span></span> <span data-ttu-id="f18c3-392">[挿入] ボタンがクリックされると、FormView は、DetailsView コントロールと同じ一連の手順を実行し、`Products` テーブルに新しいレコードを追加します。</span><span class="sxs-lookup"><span data-stu-id="f18c3-392">When the Insert button is clicked the FormView proceeds through the same sequence of steps as the DetailsView control, adding a new record to the `Products` table.</span></span> <span data-ttu-id="f18c3-393">図25は、挿入された後の FormView での Acme コーヒー製品の詳細を示しています。</span><span class="sxs-lookup"><span data-stu-id="f18c3-393">Figure 25 shows Acme Coffee product's details in the FormView after it has been inserted.</span></span>

<span data-ttu-id="f18c3-394">[Insertitemposition が FormView の挿入インターフェイスを決定する ![](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image61.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image60.png)</span><span class="sxs-lookup"><span data-stu-id="f18c3-394">[![The InsertItemTemplate Dictates the FormView's Inserting Interface](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image61.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image60.png)</span></span>

<span data-ttu-id="f18c3-395">**図 24**: `InsertItemTemplate` は、FormView の挿入インターフェイスを決定します ([クリックすると、フルサイズの画像が表示](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image62.png)されます)</span><span class="sxs-lookup"><span data-stu-id="f18c3-395">**Figure 24**: The `InsertItemTemplate` Dictates the FormView's Inserting Interface ([Click to view full-size image](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image62.png))</span></span>

<span data-ttu-id="f18c3-396">[新しい製品の詳細 ![Acme コーヒーが FormView に表示されます。](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image64.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image63.png)</span><span class="sxs-lookup"><span data-stu-id="f18c3-396">[![The Details for New Product, Acme Coffee, are Displayed in the FormView](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image64.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image63.png)</span></span>

<span data-ttu-id="f18c3-397">**図 25**: 新しい製品である Acme コーヒーの詳細が FormView に表示される ([クリックしてフルサイズの画像を表示する](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image65.png))</span><span class="sxs-lookup"><span data-stu-id="f18c3-397">**Figure 25**: The Details for New Product, Acme Coffee, are Displayed in the FormView ([Click to view full-size image](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image65.png))</span></span>

<span data-ttu-id="f18c3-398">この FormView では、読み取り専用、編集、および挿入の各インターフェイスを3つの個別のテンプレートに分割することで、これらのインターフェイスを DetailsView および GridView より細かく制御できます。</span><span class="sxs-lookup"><span data-stu-id="f18c3-398">By separating out the read-only, editing, and inserting interfaces into three separate templates, the FormView allows for a finer degree of control over these interfaces than the DetailsView and GridView.</span></span>

> [!NOTE]
> <span data-ttu-id="f18c3-399">DetailsView と同様に、FormView の `CurrentMode` プロパティは、表示されているインターフェイスを示し、その `DefaultMode` プロパティは、編集または挿入の完了後に FormView が返すモードを示します。</span><span class="sxs-lookup"><span data-stu-id="f18c3-399">Like the DetailsView, the FormView's `CurrentMode` property indicates the interface being displayed and its `DefaultMode` property indicates the mode the FormView returns to after an edit or insert has been completed.</span></span>

## <a name="summary"></a><span data-ttu-id="f18c3-400">まとめ</span><span class="sxs-lookup"><span data-stu-id="f18c3-400">Summary</span></span>

<span data-ttu-id="f18c3-401">このチュートリアルでは、GridView、DetailsView、および FormView を使用したデータの挿入、編集、および削除の基本について説明します。</span><span class="sxs-lookup"><span data-stu-id="f18c3-401">In this tutorial we examined the basics of inserting, editing, and deleting data using the GridView, DetailsView, and FormView.</span></span> <span data-ttu-id="f18c3-402">これら3つのコントロールは、データ Web コントロールと ObjectDataSource によって ASP.NET ページに1行のコードを記述しなくても使用できる、いくつかの組み込みデータ変更機能を提供します。</span><span class="sxs-lookup"><span data-stu-id="f18c3-402">All three of these controls provide some level of built-in data modification capabilities that can be utilized without writing a single line of code in the ASP.NET page thanks to the data Web controls and the ObjectDataSource.</span></span> <span data-ttu-id="f18c3-403">ただし、単純なポイントとクリックの手法では、非常に低速で単純なデータ変更のユーザーインターフェイスが表示されます。</span><span class="sxs-lookup"><span data-stu-id="f18c3-403">However, the simple point and click techniques render a fairly frail and naïve data modification user interface.</span></span> <span data-ttu-id="f18c3-404">検証を提供したり、プログラムの値を挿入したり、例外を適切に処理したり、ユーザーインターフェイスをカスタマイズしたりするには、次のいくつかのチュートリアルで説明する手法を活用する必要があります。</span><span class="sxs-lookup"><span data-stu-id="f18c3-404">To provide validation, inject programmatic values, gracefully handle exceptions, customize the user interface, and so on, we'll need to rely on a bevy of techniques that will be discussed over the next several tutorials.</span></span>

<span data-ttu-id="f18c3-405">プログラミングを楽しんでください。</span><span class="sxs-lookup"><span data-stu-id="f18c3-405">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="f18c3-406">著者について</span><span class="sxs-lookup"><span data-stu-id="f18c3-406">About the Author</span></span>

<span data-ttu-id="f18c3-407">1998以来、 [Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml)は 7 asp/創設者 of [4GuysFromRolla.com](http://www.4guysfromrolla.com)の執筆者であり、Microsoft Web テクノロジを使用しています。</span><span class="sxs-lookup"><span data-stu-id="f18c3-407">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="f18c3-408">Scott は、独立したコンサルタント、トレーナー、およびライターとして機能します。</span><span class="sxs-lookup"><span data-stu-id="f18c3-408">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="f18c3-409">彼の最新の書籍は[ *、ASP.NET 2.0 を24時間以内に教え*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)ています。</span><span class="sxs-lookup"><span data-stu-id="f18c3-409">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="f18c3-410">mitchell@4GuysFromRolla.comでアクセスでき[ます。](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="f18c3-410">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="f18c3-411">または彼のブログを参照してください。これは[http://ScottOnWriting.NET](http://ScottOnWriting.NET)にあります。</span><span class="sxs-lookup"><span data-stu-id="f18c3-411">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="f18c3-412">[前へ](limiting-data-modification-functionality-based-on-the-user-cs.md)
> [次へ](examining-the-events-associated-with-inserting-updating-and-deleting-vb.md)</span><span class="sxs-lookup"><span data-stu-id="f18c3-412">[Previous](limiting-data-modification-functionality-based-on-the-user-cs.md)
[Next](examining-the-events-associated-with-inserting-updating-and-deleting-vb.md)</span></span>

---
uid: web-forms/overview/data-access/custom-button-actions-with-the-datalist-and-repeater/custom-buttons-in-the-datalist-and-repeater-cs
title: DataList と Repeater のカスタムボタン (C#) |Microsoft Docs
author: rick-anderson
description: このチュートリアルでは、Repeater を使用してシステムのカテゴリを一覧表示し、各カテゴリに associ を表示するボタンを提供するインターフェイスを作成します。
ms.author: riande
ms.date: 11/13/2006
ms.assetid: 1f42e332-78dc-438b-9e35-0c97aa0ad929
msc.legacyurl: /web-forms/overview/data-access/custom-button-actions-with-the-datalist-and-repeater/custom-buttons-in-the-datalist-and-repeater-cs
msc.type: authoredcontent
ms.openlocfilehash: e8cb1054068327c25e057b6df1cc7506feec8d37
ms.sourcegitcommit: 22fbd8863672c4ad6693b8388ad5c8e753fb41a2
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 11/28/2019
ms.locfileid: "74601778"
---
# <a name="custom-buttons-in-the-datalist-and-repeater-c"></a><span data-ttu-id="0ed3a-103">DataList と Repeater のカスタム ボタン (C#)</span><span class="sxs-lookup"><span data-stu-id="0ed3a-103">Custom Buttons in the DataList and Repeater (C#)</span></span>

<span data-ttu-id="0ed3a-104">[Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="0ed3a-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="0ed3a-105">[サンプルアプリのダウンロード](https://download.microsoft.com/download/4/a/7/4a7a3b18-d80e-4014-8e53-a6a2427f0d93/ASPNET_Data_Tutorial_46_CS.exe)または[PDF のダウンロード](custom-buttons-in-the-datalist-and-repeater-cs/_static/datatutorial46cs1.pdf)</span><span class="sxs-lookup"><span data-stu-id="0ed3a-105">[Download Sample App](https://download.microsoft.com/download/4/a/7/4a7a3b18-d80e-4014-8e53-a6a2427f0d93/ASPNET_Data_Tutorial_46_CS.exe) or [Download PDF](custom-buttons-in-the-datalist-and-repeater-cs/_static/datatutorial46cs1.pdf)</span></span>

> <span data-ttu-id="0ed3a-106">このチュートリアルでは、Repeater を使用してシステム内のカテゴリの一覧を表示するインターフェイスを作成します。各カテゴリには、BulletedList コントロールを使用して、関連付けられている製品を示すボタンが用意されています。</span><span class="sxs-lookup"><span data-stu-id="0ed3a-106">In this tutorial we'll build an interface that uses a Repeater to list the categories in the system, with each category providing a button to show its associated products using a BulletedList control.</span></span>

## <a name="introduction"></a><span data-ttu-id="0ed3a-107">はじめに</span><span class="sxs-lookup"><span data-stu-id="0ed3a-107">Introduction</span></span>

<span data-ttu-id="0ed3a-108">これまでの17個 DataList および Repeater チュートリアルでは、読み取り専用の例を作成し、例を編集および削除しました。</span><span class="sxs-lookup"><span data-stu-id="0ed3a-108">Throughout the past seventeen DataList and Repeater tutorials, we ve created both read-only examples and editing and deleting examples.</span></span> <span data-ttu-id="0ed3a-109">DataList 内の編集および削除機能を容易にするために、`ItemTemplate` DataList にボタンを追加しました。これにより、クリックするとポストバックが発生し、ボタン s `CommandName` プロパティに対応する DataList イベントが発生します。</span><span class="sxs-lookup"><span data-stu-id="0ed3a-109">To facilitate editing and deleting capabilities within a DataList, we added buttons to the DataList s `ItemTemplate` that, when clicked, caused a postback and raised a DataList event corresponding to the button s `CommandName` property.</span></span> <span data-ttu-id="0ed3a-110">たとえば、`CommandName` プロパティ値が Edit の `ItemTemplate` にボタンを追加すると、その `EditCommand` DataList がポストバック時に起動します。1つは `CommandName` 削除を使用して、`DeleteCommand`を発生させます。</span><span class="sxs-lookup"><span data-stu-id="0ed3a-110">For example, adding a button to the `ItemTemplate` with a `CommandName` property value of Edit causes the DataList s `EditCommand` to fire on postback; one with the `CommandName` Delete raises the `DeleteCommand`.</span></span>

<span data-ttu-id="0ed3a-111">DataList コントロールと Repeater コントロールには、[編集] ボタンと [削除] ボタンに加えて、ボタン、リンクボタン、または ImageButtons を含めることもできます。このボタンは、クリックすると、カスタムのサーバー側ロジックを実行します。</span><span class="sxs-lookup"><span data-stu-id="0ed3a-111">In addition to Edit and Delete buttons, the DataList and Repeater controls can also include Buttons, LinkButtons, or ImageButtons that, when clicked, perform some custom server-side logic.</span></span> <span data-ttu-id="0ed3a-112">このチュートリアルでは、リピータを使用してシステム内のカテゴリを一覧表示するインターフェイスを作成します。</span><span class="sxs-lookup"><span data-stu-id="0ed3a-112">In this tutorial we'll build an interface that uses a Repeater to list the categories in the system.</span></span> <span data-ttu-id="0ed3a-113">各カテゴリについて、リピータには、BulletedList コントロールを使用してカテゴリに関連付けられた製品を表示するボタンが含まれています (図1を参照)。</span><span class="sxs-lookup"><span data-stu-id="0ed3a-113">For each category, the Repeater will include a button to show the category s associated products using a BulletedList control (see Figure 1).</span></span>

<span data-ttu-id="0ed3a-114">[[製品の表示] リンクをクリック ![と、カテゴリの製品が箇条書きで表示されます。](custom-buttons-in-the-datalist-and-repeater-cs/_static/image2.png)](custom-buttons-in-the-datalist-and-repeater-cs/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="0ed3a-114">[![Clicking the Show Products Link Displays the Category s Products in a Bulleted List](custom-buttons-in-the-datalist-and-repeater-cs/_static/image2.png)](custom-buttons-in-the-datalist-and-repeater-cs/_static/image1.png)</span></span>

<span data-ttu-id="0ed3a-115">**図 1**: [製品の表示] リンクをクリックすると、箇条書きの一覧にカテゴリの製品が表示されます ([クリックすると、フルサイズの画像が表示](custom-buttons-in-the-datalist-and-repeater-cs/_static/image3.png)されます)</span><span class="sxs-lookup"><span data-stu-id="0ed3a-115">**Figure 1**: Clicking the Show Products Link Displays the Category s Products in a Bulleted List ([Click to view full-size image](custom-buttons-in-the-datalist-and-repeater-cs/_static/image3.png))</span></span>

## <a name="step-1-adding-the-custom-button-tutorial-web-pages"></a><span data-ttu-id="0ed3a-116">手順 1: カスタムボタンチュートリアル Web ページの追加</span><span class="sxs-lookup"><span data-stu-id="0ed3a-116">Step 1: Adding the Custom Button Tutorial Web Pages</span></span>

<span data-ttu-id="0ed3a-117">カスタムボタンを追加する方法を確認する前に、まず、このチュートリアルで必要となる web サイトプロジェクトの ASP.NET ページを作成してみましょう。</span><span class="sxs-lookup"><span data-stu-id="0ed3a-117">Before we look at how to add a custom button, let s first take a moment to create the ASP.NET pages in our website project that we'll need for this tutorial.</span></span> <span data-ttu-id="0ed3a-118">まず、`CustomButtonsDataListRepeater`という名前の新しいフォルダーを追加します。</span><span class="sxs-lookup"><span data-stu-id="0ed3a-118">Start by adding a new folder named `CustomButtonsDataListRepeater`.</span></span> <span data-ttu-id="0ed3a-119">次に、次の2つの ASP.NET ページをそのフォルダーに追加します。各ページは `Site.master` マスターページに関連付けられていることを確認してください。</span><span class="sxs-lookup"><span data-stu-id="0ed3a-119">Next, add the following two ASP.NET pages to that folder, making sure to associate each page with the `Site.master` master page:</span></span>

- `Default.aspx`
- `CustomButtons.aspx`

![カスタムボタンに関連するチュートリアルの ASP.NET ページを追加する](custom-buttons-in-the-datalist-and-repeater-cs/_static/image4.png)

<span data-ttu-id="0ed3a-121">**図 2**: カスタムボタンに関連するチュートリアルの ASP.NET ページを追加する</span><span class="sxs-lookup"><span data-stu-id="0ed3a-121">**Figure 2**: Add the ASP.NET Pages for the Custom Buttons-Related Tutorials</span></span>

<span data-ttu-id="0ed3a-122">他のフォルダーと同様に、`CustomButtonsDataListRepeater` フォルダー内の `Default.aspx` には、そのセクションのチュートリアルが一覧表示されます。</span><span class="sxs-lookup"><span data-stu-id="0ed3a-122">Like in the other folders, `Default.aspx` in the `CustomButtonsDataListRepeater` folder will list the tutorials in its section.</span></span> <span data-ttu-id="0ed3a-123">`SectionLevelTutorialListing.ascx` ユーザーコントロールがこの機能を提供していることを思い出してください。</span><span class="sxs-lookup"><span data-stu-id="0ed3a-123">Recall that the `SectionLevelTutorialListing.ascx` User Control provides this functionality.</span></span> <span data-ttu-id="0ed3a-124">このユーザーコントロールをソリューションエクスプローラーからページデザインビューにドラッグして、`Default.aspx` に追加します。</span><span class="sxs-lookup"><span data-stu-id="0ed3a-124">Add this User Control to `Default.aspx` by dragging it from the Solution Explorer onto the page s Design view.</span></span>

<span data-ttu-id="0ed3a-125">[SectionLevelTutorialListing ユーザーコントロールを default.aspx に追加 ![には](custom-buttons-in-the-datalist-and-repeater-cs/_static/image6.png)](custom-buttons-in-the-datalist-and-repeater-cs/_static/image5.png)</span><span class="sxs-lookup"><span data-stu-id="0ed3a-125">[![Add the SectionLevelTutorialListing.ascx User Control to Default.aspx](custom-buttons-in-the-datalist-and-repeater-cs/_static/image6.png)](custom-buttons-in-the-datalist-and-repeater-cs/_static/image5.png)</span></span>

<span data-ttu-id="0ed3a-126">**図 3**: `Default.aspx` に `SectionLevelTutorialListing.ascx` ユーザーコントロールを追加する ([クリックすると、フルサイズの画像が表示](custom-buttons-in-the-datalist-and-repeater-cs/_static/image7.png)されます)</span><span class="sxs-lookup"><span data-stu-id="0ed3a-126">**Figure 3**: Add the `SectionLevelTutorialListing.ascx` User Control to `Default.aspx` ([Click to view full-size image](custom-buttons-in-the-datalist-and-repeater-cs/_static/image7.png))</span></span>

<span data-ttu-id="0ed3a-127">最後に、`Web.sitemap` ファイルにエントリとしてページを追加します。</span><span class="sxs-lookup"><span data-stu-id="0ed3a-127">Lastly, add the pages as entries to the `Web.sitemap` file.</span></span> <span data-ttu-id="0ed3a-128">具体的には、ページングの後に次のマークアップを追加し、DataList および Repeater `<siteMapNode>`を使用して並べ替えます。</span><span class="sxs-lookup"><span data-stu-id="0ed3a-128">Specifically, add the following markup after the Paging and Sorting with the DataList and Repeater `<siteMapNode>`:</span></span>

[!code-xml[Main](custom-buttons-in-the-datalist-and-repeater-cs/samples/sample1.xml)]

<span data-ttu-id="0ed3a-129">`Web.sitemap`を更新した後、ブラウザーを使用してチュートリアル web サイトを表示します。</span><span class="sxs-lookup"><span data-stu-id="0ed3a-129">After updating `Web.sitemap`, take a moment to view the tutorials website through a browser.</span></span> <span data-ttu-id="0ed3a-130">左側のメニューには、チュートリアルの編集、挿入、および削除を行うための項目が含まれています。</span><span class="sxs-lookup"><span data-stu-id="0ed3a-130">The menu on the left now includes items for the editing, inserting, and deleting tutorials.</span></span>

![サイトマップにカスタムボタンチュートリアルのエントリが含まれるようになりました。](custom-buttons-in-the-datalist-and-repeater-cs/_static/image8.png)

<span data-ttu-id="0ed3a-132">**図 4**: サイトマップにカスタムボタンチュートリアルのエントリが含まれるようになりました。</span><span class="sxs-lookup"><span data-stu-id="0ed3a-132">**Figure 4**: The Site Map Now Includes the Entry for the Custom Buttons Tutorial</span></span>

## <a name="step-2-adding-the-list-of-categories"></a><span data-ttu-id="0ed3a-133">手順 2: カテゴリの一覧の追加</span><span class="sxs-lookup"><span data-stu-id="0ed3a-133">Step 2: Adding the List of Categories</span></span>

<span data-ttu-id="0ed3a-134">このチュートリアルでは、すべてのカテゴリを一覧表示する Repeater を作成する必要があります。これは、クリックすると、関連付けられているカテゴリの製品が箇条書きリストに表示されます。</span><span class="sxs-lookup"><span data-stu-id="0ed3a-134">For this tutorial we need to create a Repeater that lists all categories along with a Show Products LinkButton that, when clicked, displays the associated category s products in a bulleted list.</span></span> <span data-ttu-id="0ed3a-135">まず、システム内のカテゴリを一覧表示する単純なリピータを作成します。</span><span class="sxs-lookup"><span data-stu-id="0ed3a-135">Let s first create a simple Repeater that lists the categories in the system.</span></span> <span data-ttu-id="0ed3a-136">まず、`CustomButtonsDataListRepeater` フォルダーの [`CustomButtons.aspx`] ページを開きます。</span><span class="sxs-lookup"><span data-stu-id="0ed3a-136">Start by opening the `CustomButtons.aspx` page in the `CustomButtonsDataListRepeater` folder.</span></span> <span data-ttu-id="0ed3a-137">Repeater をツールボックスからデザイナーにドラッグし、その `ID` プロパティを `Categories`に設定します。</span><span class="sxs-lookup"><span data-stu-id="0ed3a-137">Drag a Repeater from the Toolbox onto the Designer and set its `ID` property to `Categories`.</span></span> <span data-ttu-id="0ed3a-138">次に、Repeater s スマートタグから新しいデータソースコントロールを作成します。</span><span class="sxs-lookup"><span data-stu-id="0ed3a-138">Next, create a new data source control from the Repeater s smart tag.</span></span> <span data-ttu-id="0ed3a-139">具体的には、`CategoriesBLL` クラス s `GetCategories()` メソッドからデータを選択する `CategoriesDataSource` という名前の新しい ObjectDataSource コントロールを作成します。</span><span class="sxs-lookup"><span data-stu-id="0ed3a-139">Specifically, create a new ObjectDataSource control named `CategoriesDataSource` that selects its data from the `CategoriesBLL` class s `GetCategories()` method.</span></span>

<span data-ttu-id="0ed3a-140">[GetCategories () メソッドを使用するように ObjectDataSource を構成 ![](custom-buttons-in-the-datalist-and-repeater-cs/_static/image10.png)](custom-buttons-in-the-datalist-and-repeater-cs/_static/image9.png)</span><span class="sxs-lookup"><span data-stu-id="0ed3a-140">[![Configure the ObjectDataSource to Use the CategoriesBLL Class s GetCategories() Method](custom-buttons-in-the-datalist-and-repeater-cs/_static/image10.png)](custom-buttons-in-the-datalist-and-repeater-cs/_static/image9.png)</span></span>

<span data-ttu-id="0ed3a-141">**図 5**: `CategoriesBLL` クラス s `GetCategories()` メソッドを使用するように ObjectDataSource を構成する ([クリックしてフルサイズのイメージを表示する](custom-buttons-in-the-datalist-and-repeater-cs/_static/image11.png))</span><span class="sxs-lookup"><span data-stu-id="0ed3a-141">**Figure 5**: Configure the ObjectDataSource to Use the `CategoriesBLL` Class s `GetCategories()` Method ([Click to view full-size image](custom-buttons-in-the-datalist-and-repeater-cs/_static/image11.png))</span></span>

<span data-ttu-id="0ed3a-142">Visual Studio によってデータソースに基づいて既定の `ItemTemplate` が作成される DataList コントロールとは異なり、Repeater s テンプレートは手動で定義する必要があります。</span><span class="sxs-lookup"><span data-stu-id="0ed3a-142">Unlike the DataList control, for which Visual Studio creates a default `ItemTemplate` based on the data source, the Repeater s templates must be manually defined.</span></span> <span data-ttu-id="0ed3a-143">さらに、リピータテンプレートは宣言によって作成および編集する必要があります (つまり、Repeater s スマートタグに [テンプレートの編集] オプションがありません)。</span><span class="sxs-lookup"><span data-stu-id="0ed3a-143">Furthermore, the Repeater s templates must be created and edited declaratively (that is, there s no Edit Templates option in the Repeater s smart tag).</span></span>

<span data-ttu-id="0ed3a-144">左下隅にある [ソース] タブをクリックし、`<h3>` 要素のカテゴリ名とその説明を段落タグに表示する `ItemTemplate` を追加します。各カテゴリ間の水平方向のルール (`<hr />`) を表示する `SeparatorTemplate` を含めます。</span><span class="sxs-lookup"><span data-stu-id="0ed3a-144">Click on the Source tab in the bottom left corner and add an `ItemTemplate` that displays the category s name in an `<h3>` element and its description in a paragraph tag; include a `SeparatorTemplate` that displays a horizontal rule (`<hr />`) between each category.</span></span> <span data-ttu-id="0ed3a-145">また、`Text` プロパティが [製品] に設定された LinkButton を追加します。</span><span class="sxs-lookup"><span data-stu-id="0ed3a-145">Also add a LinkButton with its `Text` property set to Show Products.</span></span> <span data-ttu-id="0ed3a-146">これらの手順を完了すると、ページ s の宣言型マークアップは次のようになります。</span><span class="sxs-lookup"><span data-stu-id="0ed3a-146">After completing these steps, your page s declarative markup should look like the following:</span></span>

[!code-aspx[Main](custom-buttons-in-the-datalist-and-repeater-cs/samples/sample2.aspx)]

<span data-ttu-id="0ed3a-147">図6は、ブラウザーを使用して表示するときのページを示しています。</span><span class="sxs-lookup"><span data-stu-id="0ed3a-147">Figure 6 shows the page when viewed through a browser.</span></span> <span data-ttu-id="0ed3a-148">各カテゴリの名前と説明が表示されます。</span><span class="sxs-lookup"><span data-stu-id="0ed3a-148">Each category name and description is listed.</span></span> <span data-ttu-id="0ed3a-149">[製品の表示] ボタンをクリックすると、ポストバックが発生しますが、まだ何も実行されていません。</span><span class="sxs-lookup"><span data-stu-id="0ed3a-149">The Show Products button, when clicked, causes a postback but does not yet perform any action.</span></span>

<span data-ttu-id="0ed3a-150">[各カテゴリの名前と説明が表示され、[製品の表示] LinkButton と共に表示さ ![ます。](custom-buttons-in-the-datalist-and-repeater-cs/_static/image13.png)](custom-buttons-in-the-datalist-and-repeater-cs/_static/image12.png)</span><span class="sxs-lookup"><span data-stu-id="0ed3a-150">[![Each Category s Name and Description is Displayed, Along with a Show Products LinkButton](custom-buttons-in-the-datalist-and-repeater-cs/_static/image13.png)](custom-buttons-in-the-datalist-and-repeater-cs/_static/image12.png)</span></span>

<span data-ttu-id="0ed3a-151">**図 6**: 各カテゴリの名前と説明が表示され、製品の表示 LinkButton ([クリックすると、フルサイズの画像が表示](custom-buttons-in-the-datalist-and-repeater-cs/_static/image14.png)されます)</span><span class="sxs-lookup"><span data-stu-id="0ed3a-151">**Figure 6**: Each Category s Name and Description is Displayed, Along with a Show Products LinkButton ([Click to view full-size image](custom-buttons-in-the-datalist-and-repeater-cs/_static/image14.png))</span></span>

## <a name="step-3-executing-server-side-logic-when-the-show-products-linkbutton-is-clicked"></a><span data-ttu-id="0ed3a-152">手順 3: [製品の表示] LinkButton がクリックされたときのサーバー側ロジックの実行</span><span class="sxs-lookup"><span data-stu-id="0ed3a-152">Step 3: Executing Server-Side Logic When the Show Products LinkButton is Clicked</span></span>

<span data-ttu-id="0ed3a-153">DataList または Repeater 内のテンプレート内のボタン、LinkButton、または ImageButton がクリックされると、ポストバックが発生し、DataList または Repeater s `ItemCommand` イベントが発生します。</span><span class="sxs-lookup"><span data-stu-id="0ed3a-153">Anytime a Button, LinkButton, or ImageButton within a template in a DataList or Repeater is clicked, a postback occurs and the DataList or Repeater s `ItemCommand` event fires.</span></span> <span data-ttu-id="0ed3a-154">`ItemCommand` イベントに加えて、DataList コントロールは、ボタン s `CommandName` プロパティが予約済みの文字列 (Delete、Edit、Cancel、Update、または Select) のいずれかに設定されている場合に、より具体的な別のイベントを発生させることもありますが、`ItemCommand` イベントは*常に*発生します。</span><span class="sxs-lookup"><span data-stu-id="0ed3a-154">In addition to the `ItemCommand` event, the DataList control may also raise another, more specific event if the button s `CommandName` property is set to one of the reserved strings ( Delete, Edit, Cancel, Update, or Select ), but the `ItemCommand` event is *always* fired.</span></span>

<span data-ttu-id="0ed3a-155">DataList または Repeater 内のボタンがクリックされたときに、クリックされたボタン ([編集] ボタンと [削除] ボタンの両方など) と、場合によっては (たとえば、[編集] ボタンと [削除] ボタンの両方のボタン) を渡す必要があります。ボタンがクリックされた項目の主キー値。</span><span class="sxs-lookup"><span data-stu-id="0ed3a-155">When a button is clicked within a DataList or Repeater, oftentimes we need to pass along which button was clicked (in the case that there may be multiple buttons within the control, such as both an Edit and Delete button) and perhaps some additional information (such as the primary key value of the item whose button was clicked).</span></span> <span data-ttu-id="0ed3a-156">ボタン、LinkButton、および ImageButton は、値が `ItemCommand` イベントハンドラーに渡される2つのプロパティを提供します。</span><span class="sxs-lookup"><span data-stu-id="0ed3a-156">The Button, LinkButton, and ImageButton provide two properties whose values are passed to the `ItemCommand` event handler:</span></span>

- <span data-ttu-id="0ed3a-157">テンプレートの各ボタンを識別するために通常使用される文字列を `CommandName` します。</span><span class="sxs-lookup"><span data-stu-id="0ed3a-157">`CommandName` a string typically used to identify each button in the template</span></span>
- <span data-ttu-id="0ed3a-158">主キーの値など、一部のデータフィールドの値を保持するために一般的に使用される `CommandArgument`</span><span class="sxs-lookup"><span data-stu-id="0ed3a-158">`CommandArgument` commonly used to hold the value of some data field, such as the primary key value</span></span>

<span data-ttu-id="0ed3a-159">この例では、LinkButton の `CommandName` プロパティを ShowProducts に設定し、現在のレコード s 主キーの `CategoryID` 値を、データバインド構文 `CategoryArgument='<%# Eval("CategoryID") %>'`を使用して `CommandArgument` プロパティにバインドします。</span><span class="sxs-lookup"><span data-stu-id="0ed3a-159">For this example, set the LinkButton s `CommandName` property to ShowProducts and bind the current record s primary key value `CategoryID` to the `CommandArgument` property using the databinding syntax `CategoryArgument='<%# Eval("CategoryID") %>'`.</span></span> <span data-ttu-id="0ed3a-160">これら2つのプロパティを指定すると、LinkButton の宣言構文は次のようになります。</span><span class="sxs-lookup"><span data-stu-id="0ed3a-160">After specifying these two properties, the LinkButton s declarative syntax should look like the following:</span></span>

[!code-aspx[Main](custom-buttons-in-the-datalist-and-repeater-cs/samples/sample3.aspx)]

<span data-ttu-id="0ed3a-161">このボタンをクリックすると、ポストバックが発生し、DataList または Repeater s `ItemCommand` イベントが発生します。</span><span class="sxs-lookup"><span data-stu-id="0ed3a-161">When the button is clicked, a postback occurs and the DataList or Repeater s `ItemCommand` event fires.</span></span> <span data-ttu-id="0ed3a-162">イベントハンドラーには、ボタン s `CommandName` と `CommandArgument` 値が渡されます。</span><span class="sxs-lookup"><span data-stu-id="0ed3a-162">The event handler is passed the button s `CommandName` and `CommandArgument` values.</span></span>

<span data-ttu-id="0ed3a-163">Repeater s `ItemCommand` イベントのイベントハンドラーを作成し、イベントハンドラーに渡される2番目のパラメーター (名前は `e`) に注意してください。</span><span class="sxs-lookup"><span data-stu-id="0ed3a-163">Create an event handler for the Repeater s `ItemCommand` event and note the second parameter passed into the event handler (named `e`).</span></span> <span data-ttu-id="0ed3a-164">この2番目のパラメーターは[`RepeaterCommandEventArgs`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.repeatercommandeventargs.aspx)型で、次の4つのプロパティがあります。</span><span class="sxs-lookup"><span data-stu-id="0ed3a-164">This second parameter is of type [`RepeaterCommandEventArgs`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.repeatercommandeventargs.aspx) and has the following four properties:</span></span>

- <span data-ttu-id="0ed3a-165">クリックされたボタンの `CommandArgument` プロパティの値を `CommandArgument` します。</span><span class="sxs-lookup"><span data-stu-id="0ed3a-165">`CommandArgument` the value of the clicked button s `CommandArgument` property</span></span>
- <span data-ttu-id="0ed3a-166">ボタン s `CommandName` プロパティの値を `CommandName` します。</span><span class="sxs-lookup"><span data-stu-id="0ed3a-166">`CommandName` the value of the button s `CommandName` property</span></span>
- <span data-ttu-id="0ed3a-167">クリックされたボタンコントロールへの参照を `CommandSource` します</span><span class="sxs-lookup"><span data-stu-id="0ed3a-167">`CommandSource` a reference to the button control that was clicked</span></span>
- <span data-ttu-id="0ed3a-168">クリックされたボタンを含む[`RepeaterItem`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.repeateritem.aspx)への参照を `Item` します。リピータにバインドされている各レコードは、`RepeaterItem` として示されます。</span><span class="sxs-lookup"><span data-stu-id="0ed3a-168">`Item` a reference to the [`RepeaterItem`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.repeateritem.aspx) that contains the button that was clicked; each record bound to the Repeater is manifested as a `RepeaterItem`</span></span>

<span data-ttu-id="0ed3a-169">選択したカテゴリの `CategoryID` は `CommandArgument` プロパティを介して渡されるため、`ItemCommand` イベントハンドラーで選択したカテゴリに関連付けられている製品のセットを取得できます。</span><span class="sxs-lookup"><span data-stu-id="0ed3a-169">Since the selected category s `CategoryID` is passed in via the `CommandArgument` property, we can get the set of products associated with the selected category in the `ItemCommand` event handler.</span></span> <span data-ttu-id="0ed3a-170">これらの製品は、`ItemTemplate` (まだ追加していない) の BulletedList コントロールにバインドできます。</span><span class="sxs-lookup"><span data-stu-id="0ed3a-170">These products can then be bound to a BulletedList control in the `ItemTemplate` (which we ve yet to add).</span></span> <span data-ttu-id="0ed3a-171">それでも、BulletedList を追加し、それを `ItemCommand` イベントハンドラーで参照し、選択したカテゴリの一連の製品にバインドします。これについては、手順 4. で説明します。</span><span class="sxs-lookup"><span data-stu-id="0ed3a-171">All that remains, then, is to add the BulletedList, reference it in the `ItemCommand` event handler, and bind to it the set of products for the selected category, which we'll tackle in Step 4.</span></span>

> [!NOTE]
> <span data-ttu-id="0ed3a-172">DataList s `ItemCommand` イベントハンドラーには、 [`DataListCommandEventArgs`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.datalistcommandeventargs.aspx)型のオブジェクトが渡されます。このオブジェクトには、`RepeaterCommandEventArgs` クラスと同じ4つのプロパティが用意されています。</span><span class="sxs-lookup"><span data-stu-id="0ed3a-172">The DataList s `ItemCommand` event handler is passed an object of type [`DataListCommandEventArgs`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.datalistcommandeventargs.aspx), which offers the same four properties as the `RepeaterCommandEventArgs` class.</span></span>

## <a name="step-4-displaying-the-selected-category-s-products-in-a-bulleted-list"></a><span data-ttu-id="0ed3a-173">手順 4: 選択したカテゴリの製品を箇条書きリストに表示する</span><span class="sxs-lookup"><span data-stu-id="0ed3a-173">Step 4: Displaying the Selected Category s Products in a Bulleted List</span></span>

<span data-ttu-id="0ed3a-174">選択したカテゴリの製品は、任意の数のコントロールを使用して `ItemTemplate` リピータ内に表示できます。</span><span class="sxs-lookup"><span data-stu-id="0ed3a-174">The selected category s products can be displayed within the Repeater s `ItemTemplate` using any number of controls.</span></span> <span data-ttu-id="0ed3a-175">入れ子になった別のリピータ、DataList、DropDownList、GridView などを追加できます。</span><span class="sxs-lookup"><span data-stu-id="0ed3a-175">We could add another nested Repeater, a DataList, a DropDownList, a GridView, and so on.</span></span> <span data-ttu-id="0ed3a-176">製品を箇条書きとして表示するため、BulletedList コントロールを使用します。</span><span class="sxs-lookup"><span data-stu-id="0ed3a-176">Since we want to display the products as a bulleted list, though, we'll use the BulletedList control.</span></span> <span data-ttu-id="0ed3a-177">`CustomButtons.aspx` ページ s 宣言マークアップに戻り、[製品の表示] LinkButton の後に BulletedList コントロールを `ItemTemplate` に追加します。</span><span class="sxs-lookup"><span data-stu-id="0ed3a-177">Returning to the `CustomButtons.aspx` page s declarative markup, add a BulletedList control to the `ItemTemplate` after the Show Products LinkButton.</span></span> <span data-ttu-id="0ed3a-178">BulletedLists s `ID` を `ProductsInCategory`に設定します。</span><span class="sxs-lookup"><span data-stu-id="0ed3a-178">Set the BulletedLists s `ID` to `ProductsInCategory`.</span></span> <span data-ttu-id="0ed3a-179">BulletedList プロパティ `DataTextField` によって指定されたデータフィールドの値がに表示されます。このコントロールには製品情報がバインドされているため、`DataTextField` プロパティを `ProductName`に設定します。</span><span class="sxs-lookup"><span data-stu-id="0ed3a-179">The BulletedList displays the value of the data field specified via the `DataTextField` property; since this control will have product information bound to it, set the `DataTextField` property to `ProductName`.</span></span>

[!code-aspx[Main](custom-buttons-in-the-datalist-and-repeater-cs/samples/sample4.aspx)]

<span data-ttu-id="0ed3a-180">`ItemCommand` イベントハンドラーで、`e.Item.FindControl("ProductsInCategory")` を使用してこのコントロールを参照し、選択したカテゴリに関連付けられている製品のセットにバインドします。</span><span class="sxs-lookup"><span data-stu-id="0ed3a-180">In the `ItemCommand` event handler, reference this control using `e.Item.FindControl("ProductsInCategory")` and bind it to the set of products associated with the selected category.</span></span>

[!code-csharp[Main](custom-buttons-in-the-datalist-and-repeater-cs/samples/sample5.cs)]

<span data-ttu-id="0ed3a-181">`ItemCommand` イベントハンドラーで何らかのアクションを実行する前に、まず受信 `CommandName`の値を確認することをお勧めします。</span><span class="sxs-lookup"><span data-stu-id="0ed3a-181">Before performing any action in the `ItemCommand` event handler, it s prudent to first check the value of the incoming `CommandName`.</span></span> <span data-ttu-id="0ed3a-182">`ItemCommand` イベントハンドラーは、ボタンがクリックされ*たときに発生するため*、テンプレートに複数のボタンがある場合は、`CommandName` の値を使用して、実行するアクションを識別します。</span><span class="sxs-lookup"><span data-stu-id="0ed3a-182">Since the `ItemCommand` event handler fires when *any* button is clicked, if there are multiple buttons in the template use the `CommandName` value to discern what action to take.</span></span> <span data-ttu-id="0ed3a-183">ここで `CommandName` をチェックするのは議論ですが、ボタンは1つだけなので、この方法をお勧めします。</span><span class="sxs-lookup"><span data-stu-id="0ed3a-183">Checking the `CommandName` here is moot, since we only have a single button, but it is a good habit to form.</span></span> <span data-ttu-id="0ed3a-184">次に、選択したカテゴリの `CategoryID` が `CommandArgument` プロパティから取得されます。</span><span class="sxs-lookup"><span data-stu-id="0ed3a-184">Next, the `CategoryID` of the selected category is retrieved from the `CommandArgument` property.</span></span> <span data-ttu-id="0ed3a-185">次に、テンプレート内の BulletedList コントロールが参照され、`ProductsBLL` クラス s `GetProductsByCategoryID(categoryID)` メソッドの結果にバインドされます。</span><span class="sxs-lookup"><span data-stu-id="0ed3a-185">The BulletedList control in the template is then referenced and bound to the results of the `ProductsBLL` class s `GetProductsByCategoryID(categoryID)` method.</span></span>

<span data-ttu-id="0ed3a-186">Datalist の[データの編集と削除の概要](../editing-and-deleting-data-through-the-datalist/an-overview-of-editing-and-deleting-data-in-the-datalist-cs.md)など、datalist 内のボタンを使用した前のチュートリアルでは、`DataKeys` コレクションを介して特定の項目の主キーの値を決定しました。</span><span class="sxs-lookup"><span data-stu-id="0ed3a-186">In previous tutorials that used the buttons within a DataList, such as [An Overview of Editing and Deleting Data in the DataList](../editing-and-deleting-data-through-the-datalist/an-overview-of-editing-and-deleting-data-in-the-datalist-cs.md), we determined the primary key value of a given item via the `DataKeys` collection.</span></span> <span data-ttu-id="0ed3a-187">この方法は DataList ではうまく機能しますが、リピータには `DataKeys` のプロパティがありません。</span><span class="sxs-lookup"><span data-stu-id="0ed3a-187">While this approach works well with the DataList, the Repeater does not have a `DataKeys` property.</span></span> <span data-ttu-id="0ed3a-188">代わりに、主キーの値を提供する別の方法を使用する必要があります。たとえば、ボタン s `CommandArgument` プロパティを介して、またはテンプレート内の隠しラベル Web コントロールに主キーの値を割り当て、`e.Item.FindControl("LabelID")`を使用して `ItemCommand` イベントハンドラーでその値を読み取ることができます。</span><span class="sxs-lookup"><span data-stu-id="0ed3a-188">Instead, we must use an alternative approach for supplying the primary key value, such as through the button s `CommandArgument` property or by assigning the primary key value to a hidden Label Web control within the template and reading its value back in the `ItemCommand` event handler using `e.Item.FindControl("LabelID")`.</span></span>

<span data-ttu-id="0ed3a-189">`ItemCommand` イベントハンドラーを完了したら、ブラウザーでこのページをテストしてみてください。</span><span class="sxs-lookup"><span data-stu-id="0ed3a-189">After completing the `ItemCommand` event handler, take a moment to test out this page in a browser.</span></span> <span data-ttu-id="0ed3a-190">図7に示すように、[製品の表示] リンクをクリックするとポストバックが発生し、選択したカテゴリの製品が BulletedList に表示されます。</span><span class="sxs-lookup"><span data-stu-id="0ed3a-190">As Figure 7 shows, clicking the Show Products link causes a postback and displays the products for the selected category in a BulletedList.</span></span> <span data-ttu-id="0ed3a-191">さらに、他のカテゴリの [製品の表示] リンクがクリックされた場合でも、この製品情報は残されていることに注意してください。</span><span class="sxs-lookup"><span data-stu-id="0ed3a-191">Furthermore, note that this product information remains, even if other categories Show Products links are clicked.</span></span>

> [!NOTE]
> <span data-ttu-id="0ed3a-192">このレポートの動作を変更する場合は、一度に1つのカテゴリの製品のみが一覧表示されるようにするには、BulletedList コントロール s `EnableViewState` プロパティを `False`に設定します。</span><span class="sxs-lookup"><span data-stu-id="0ed3a-192">If you want to modify the behavior of this report, such that the only one category s products are listed at a time, simply set the BulletedList control s `EnableViewState` property to `False`.</span></span>

<span data-ttu-id="0ed3a-193">[BulletedList を使用して、選択したカテゴリの製品を表示する ![](custom-buttons-in-the-datalist-and-repeater-cs/_static/image16.png)](custom-buttons-in-the-datalist-and-repeater-cs/_static/image15.png)</span><span class="sxs-lookup"><span data-stu-id="0ed3a-193">[![A BulletedList is used to Display the Products of the Selected Category](custom-buttons-in-the-datalist-and-repeater-cs/_static/image16.png)](custom-buttons-in-the-datalist-and-repeater-cs/_static/image15.png)</span></span>

<span data-ttu-id="0ed3a-194">**図 7**: BulletedList を使用して、選択したカテゴリの製品を表示する ([クリックすると、フルサイズの画像が表示](custom-buttons-in-the-datalist-and-repeater-cs/_static/image17.png)されます)</span><span class="sxs-lookup"><span data-stu-id="0ed3a-194">**Figure 7**: A BulletedList is used to Display the Products of the Selected Category ([Click to view full-size image](custom-buttons-in-the-datalist-and-repeater-cs/_static/image17.png))</span></span>

## <a name="summary"></a><span data-ttu-id="0ed3a-195">要約</span><span class="sxs-lookup"><span data-stu-id="0ed3a-195">Summary</span></span>

<span data-ttu-id="0ed3a-196">DataList コントロールと Repeater コントロールには、テンプレート内に任意の数のボタン、リンクボタン、または ImageButtons を含めることができます。</span><span class="sxs-lookup"><span data-stu-id="0ed3a-196">The DataList and Repeater controls can include any number of Buttons, LinkButtons, or ImageButtons within their templates.</span></span> <span data-ttu-id="0ed3a-197">このようなボタンをクリックすると、ポストバックが発生し、`ItemCommand` イベントが発生します。</span><span class="sxs-lookup"><span data-stu-id="0ed3a-197">Such buttons, when clicked, cause a postback and raise the `ItemCommand` event.</span></span> <span data-ttu-id="0ed3a-198">カスタムサーバー側の操作をクリックされたボタンと関連付けるには、`ItemCommand` イベントのイベントハンドラーを作成します。</span><span class="sxs-lookup"><span data-stu-id="0ed3a-198">To associate custom server-side action with a button being clicked, create an event handler for the `ItemCommand` event.</span></span> <span data-ttu-id="0ed3a-199">このイベントハンドラーでは、最初に受信 `CommandName` 値をチェックして、クリックされたボタンを判別します。</span><span class="sxs-lookup"><span data-stu-id="0ed3a-199">In this event handler first check the incoming `CommandName` value to determine which button was clicked.</span></span> <span data-ttu-id="0ed3a-200">必要に応じて、ボタン s `CommandArgument` プロパティを使用して追加情報を指定することもできます。</span><span class="sxs-lookup"><span data-stu-id="0ed3a-200">Additional information can optionally be supplied through the button s `CommandArgument` property.</span></span>

<span data-ttu-id="0ed3a-201">プログラミングを楽しんでください。</span><span class="sxs-lookup"><span data-stu-id="0ed3a-201">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="0ed3a-202">作成者について</span><span class="sxs-lookup"><span data-stu-id="0ed3a-202">About the Author</span></span>

<span data-ttu-id="0ed3a-203">1998以来、 [Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml)は 7 asp/創設者 of [4GuysFromRolla.com](http://www.4guysfromrolla.com)の執筆者であり、Microsoft Web テクノロジを使用しています。</span><span class="sxs-lookup"><span data-stu-id="0ed3a-203">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="0ed3a-204">Scott は、独立したコンサルタント、トレーナー、およびライターとして機能します。</span><span class="sxs-lookup"><span data-stu-id="0ed3a-204">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="0ed3a-205">彼の最新の書籍は[ *、ASP.NET 2.0 を24時間以内に教え*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)ています。</span><span class="sxs-lookup"><span data-stu-id="0ed3a-205">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="0ed3a-206">mitchell@4GuysFromRolla.comでアクセスでき[ます。](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="0ed3a-206">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="0ed3a-207">または彼のブログを参照してください。これは[http://ScottOnWriting.NET](http://ScottOnWriting.NET)にあります。</span><span class="sxs-lookup"><span data-stu-id="0ed3a-207">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="0ed3a-208">ありがとうございました。</span><span class="sxs-lookup"><span data-stu-id="0ed3a-208">Special Thanks To</span></span>

<span data-ttu-id="0ed3a-209">このチュートリアルシリーズは、役に立つ多くのレビュー担当者によってレビューされました。</span><span class="sxs-lookup"><span data-stu-id="0ed3a-209">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="0ed3a-210">このチュートリアルのリードレビューアーは、Patterson がになりました。</span><span class="sxs-lookup"><span data-stu-id="0ed3a-210">Lead reviewer for this tutorial was Dennis Patterson.</span></span> <span data-ttu-id="0ed3a-211">今後の MSDN 記事を確認することに興味がありますか?</span><span class="sxs-lookup"><span data-stu-id="0ed3a-211">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="0ed3a-212">その場合は、mitchell@4GuysFromRolla.comの行を削除[します。](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="0ed3a-212">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> [<span data-ttu-id="0ed3a-213">次へ</span><span class="sxs-lookup"><span data-stu-id="0ed3a-213">Next</span></span>](custom-buttons-in-the-datalist-and-repeater-vb.md)

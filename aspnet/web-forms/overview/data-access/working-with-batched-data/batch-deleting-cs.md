---
uid: web-forms/overview/data-access/working-with-batched-data/batch-deleting-cs
title: Batch の削除C#() |Microsoft Docs
author: rick-anderson
description: 1回の操作で複数のデータベースレコードを削除する方法について説明します。 ユーザーインターフェイスレイヤーでは、以前の tut で作成された拡張 GridView に基づいて構築されます。
ms.author: riande
ms.date: 06/26/2007
ms.assetid: ac6916d0-a5ab-4218-9760-7ba9e72d258c
msc.legacyurl: /web-forms/overview/data-access/working-with-batched-data/batch-deleting-cs
msc.type: authoredcontent
ms.openlocfilehash: ed832c38b4972f440ab64c141e29c85f0a9df920
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 03/06/2020
ms.locfileid: "78476608"
---
# <a name="batch-deleting-c"></a><span data-ttu-id="9dd3e-104">一括削除 (C#)</span><span class="sxs-lookup"><span data-stu-id="9dd3e-104">Batch Deleting (C#)</span></span>

<span data-ttu-id="9dd3e-105">[Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="9dd3e-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="9dd3e-106">[コードのダウンロード](https://download.microsoft.com/download/3/9/f/39f92b37-e92e-4ab3-909e-b4ef23d01aa3/ASPNET_Data_Tutorial_65_CS.zip)または[PDF のダウンロード](batch-deleting-cs/_static/datatutorial65cs1.pdf)</span><span class="sxs-lookup"><span data-stu-id="9dd3e-106">[Download Code](https://download.microsoft.com/download/3/9/f/39f92b37-e92e-4ab3-909e-b4ef23d01aa3/ASPNET_Data_Tutorial_65_CS.zip) or [Download PDF](batch-deleting-cs/_static/datatutorial65cs1.pdf)</span></span>

> <span data-ttu-id="9dd3e-107">1回の操作で複数のデータベースレコードを削除する方法について説明します。</span><span class="sxs-lookup"><span data-stu-id="9dd3e-107">Learn how to delete multiple database records in a single operation.</span></span> <span data-ttu-id="9dd3e-108">ユーザーインターフェイスレイヤーでは、前のチュートリアルで作成した拡張された GridView に基づいて構築されます。</span><span class="sxs-lookup"><span data-stu-id="9dd3e-108">In the User Interface Layer we build upon an enhanced GridView created in an earlier tutorial.</span></span> <span data-ttu-id="9dd3e-109">データアクセス層では、複数の削除操作をトランザクション内にラップして、すべての削除が成功するか、すべての削除がロールバックされるようにします。</span><span class="sxs-lookup"><span data-stu-id="9dd3e-109">In the Data Access Layer we wrap the multiple Delete operations within a transaction to ensure that all deletions succeed or all deletions are rolled back.</span></span>

## <a name="introduction"></a><span data-ttu-id="9dd3e-110">はじめに</span><span class="sxs-lookup"><span data-stu-id="9dd3e-110">Introduction</span></span>

<span data-ttu-id="9dd3e-111">[前のチュートリアル](batch-updating-cs.md)では、完全に編集可能な GridView を使用してバッチ編集インターフェイスを作成する方法を説明しています。</span><span class="sxs-lookup"><span data-stu-id="9dd3e-111">The [preceding tutorial](batch-updating-cs.md) explored how to create a batch editing interface using a fully-editable GridView.</span></span> <span data-ttu-id="9dd3e-112">ユーザーが頻繁に多くのレコードを編集している場合、バッチ編集インターフェイスでは、ポストバックとキーボードからマウスへのコンテキストの切り替えがはるかに少なくなるため、エンドユーザーの効率が向上します。</span><span class="sxs-lookup"><span data-stu-id="9dd3e-112">In situations where users are commonly editing many records at once, a batch editing interface will require far fewer postbacks and keyboard-to-mouse context switches, thereby improving the end user s efficiency.</span></span> <span data-ttu-id="9dd3e-113">この手法は、ユーザーが1つの移動で多数のレコードを削除することがよくあるページでも同様に役立ちます。</span><span class="sxs-lookup"><span data-stu-id="9dd3e-113">This technique is similarly useful for pages where it is common for users to delete many records in one go.</span></span>

<span data-ttu-id="9dd3e-114">オンライン電子メールクライアントを使用したユーザーは、既に、最も一般的なバッチ削除インターフェイスの1つに慣れています。対応するグリッドの各行にチェックボックスがあり、対応する [すべてのチェックされた項目を削除] ボタンが表示されます (図1を参照)。</span><span class="sxs-lookup"><span data-stu-id="9dd3e-114">Anyone who has used an online email client is already familiar with one of the most common batch deleting interfaces: a checkbox in each row in a grid with a corresponding Delete All Checked Items button (see Figure 1).</span></span> <span data-ttu-id="9dd3e-115">このチュートリアルでは、前のチュートリアルでは、web ベースのインターフェイスと、一連のレコードを1つのアトミック操作として削除するメソッドの両方を作成するためのすべての作業が既に完了しているため、これは少しです。</span><span class="sxs-lookup"><span data-stu-id="9dd3e-115">This tutorial is rather short because we ve already done all of the hard work in previous tutorials in creating both the web-based interface and a method to delete a series of records as a single atomic operation.</span></span> <span data-ttu-id="9dd3e-116">[チェックボックスの Gridview 列の追加](../enhancing-the-gridview/adding-a-gridview-column-of-checkboxes-cs.md)に関するチュートリアルでは、チェックボックスの列を含む gridview を作成し、[トランザクション内でのデータベース変更のラッピング](wrapping-database-modifications-within-a-transaction-cs.md)に関するチュートリアルでは、トランザクションを使用して `ProductID` 値の `List<T>` を削除するためのメソッドを BLL に作成しました。</span><span class="sxs-lookup"><span data-stu-id="9dd3e-116">In the [Adding a GridView Column of Checkboxes](../enhancing-the-gridview/adding-a-gridview-column-of-checkboxes-cs.md) tutorial we created a GridView with a column of checkboxes and in the [Wrapping Database Modifications within a Transaction](wrapping-database-modifications-within-a-transaction-cs.md) tutorial we created a method in the BLL that would use a transaction to delete a `List<T>` of `ProductID` values.</span></span> <span data-ttu-id="9dd3e-117">このチュートリアルでは、前のエクスペリエンスを基にして、作業中のバッチの削除の例を作成します。</span><span class="sxs-lookup"><span data-stu-id="9dd3e-117">In this tutorial, we will build upon and merge our previous experiences to create a working batch deleting example.</span></span>

<span data-ttu-id="9dd3e-118">[各行にチェックボックスが含まれて ![](batch-deleting-cs/_static/image1.gif)](batch-deleting-cs/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="9dd3e-118">[![Each Row Includes a Checkbox](batch-deleting-cs/_static/image1.gif)](batch-deleting-cs/_static/image1.png)</span></span>

<span data-ttu-id="9dd3e-119">**図 1**: 各行にチェックボックスが含まれている ([クリックすると、フルサイズの画像が表示](batch-deleting-cs/_static/image2.png)されます)</span><span class="sxs-lookup"><span data-stu-id="9dd3e-119">**Figure 1**: Each Row Includes a Checkbox ([Click to view full-size image](batch-deleting-cs/_static/image2.png))</span></span>

## <a name="step-1-creating-the-batch-deleting-interface"></a><span data-ttu-id="9dd3e-120">手順 1: Batch 削除インターフェイスを作成する</span><span class="sxs-lookup"><span data-stu-id="9dd3e-120">Step 1: Creating the Batch Deleting Interface</span></span>

<span data-ttu-id="9dd3e-121">[Checkbox チュートリアルの「GridView 列の追加](../enhancing-the-gridview/adding-a-gridview-column-of-checkboxes-cs.md)」のチュートリアルでは、batch の削除インターフェイスを既に作成しているため、最初から作成するのではなく、単に `BatchDelete.aspx` にコピーできます。</span><span class="sxs-lookup"><span data-stu-id="9dd3e-121">Since we already created the batch deleting interface in the [Adding a GridView Column of Checkboxes](../enhancing-the-gridview/adding-a-gridview-column-of-checkboxes-cs.md) tutorial, we can simply copy it to `BatchDelete.aspx` rather than creating it from scratch.</span></span> <span data-ttu-id="9dd3e-122">まず、`BatchData` フォルダーの `BatchDelete.aspx` ページと `EnhancedGridView` フォルダーの `CheckBoxField.aspx` ページを開きます。</span><span class="sxs-lookup"><span data-stu-id="9dd3e-122">Start by opening the `BatchDelete.aspx` page in the `BatchData` folder and the `CheckBoxField.aspx` page in the `EnhancedGridView` folder.</span></span> <span data-ttu-id="9dd3e-123">[`CheckBoxField.aspx`] ページで、[ソース] ビューにアクセスし、図2に示すように、`<asp:Content>` タグの間にマークアップをコピーします。</span><span class="sxs-lookup"><span data-stu-id="9dd3e-123">From the `CheckBoxField.aspx` page, go to the Source view and copy the markup between the `<asp:Content>` tags as shown in Figure 2.</span></span>

<span data-ttu-id="9dd3e-124">[CheckBoxField の宣言型マークアップをクリップボードにコピー ![には](batch-deleting-cs/_static/image2.gif)](batch-deleting-cs/_static/image3.png)</span><span class="sxs-lookup"><span data-stu-id="9dd3e-124">[![Copy the Declarative Markup of CheckBoxField.aspx to the Clipboard](batch-deleting-cs/_static/image2.gif)](batch-deleting-cs/_static/image3.png)</span></span>

<span data-ttu-id="9dd3e-125">**図 2**: `CheckBoxField.aspx` の宣言型マークアップをクリップボードにコピーする ([クリックすると、フルサイズのイメージが表示](batch-deleting-cs/_static/image4.png)されます)</span><span class="sxs-lookup"><span data-stu-id="9dd3e-125">**Figure 2**: Copy the Declarative Markup of `CheckBoxField.aspx` to the Clipboard ([Click to view full-size image](batch-deleting-cs/_static/image4.png))</span></span>

<span data-ttu-id="9dd3e-126">次に、`BatchDelete.aspx` のソースビューにアクセスし、`<asp:Content>` タグ内にクリップボードの内容を貼り付けます。</span><span class="sxs-lookup"><span data-stu-id="9dd3e-126">Next, go to the Source view in `BatchDelete.aspx` and paste the contents of the clipboard within the `<asp:Content>` tags.</span></span> <span data-ttu-id="9dd3e-127">また、`CheckBoxField.aspx.cs` の分離コードクラス内のコードをコピーして、`BatchDelete.aspx.cs` の分離コードクラス (`DeleteSelectedProducts` ボタン s `Click` イベントハンドラー、`ToggleCheckState` メソッド、および `Click` ボタンと `CheckAll` ボタンのイベントハンドラー) の内部に貼り付けることもできます。`UncheckAll`</span><span class="sxs-lookup"><span data-stu-id="9dd3e-127">Also copy and paste the code from within the code-behind class in `CheckBoxField.aspx.cs` to within the code-behind class in `BatchDelete.aspx.cs` (the `DeleteSelectedProducts` Button s `Click` event handler, the `ToggleCheckState` method, and the `Click` event handlers for the `CheckAll` and `UncheckAll` Buttons).</span></span> <span data-ttu-id="9dd3e-128">このコンテンツをコピーした後、`BatchDelete.aspx` ページの分離コードクラスに次のコードが含まれている必要があります。</span><span class="sxs-lookup"><span data-stu-id="9dd3e-128">After copying over this content, the `BatchDelete.aspx` page s code-behind class should contain the following code:</span></span>

[!code-csharp[Main](batch-deleting-cs/samples/sample1.cs)]

<span data-ttu-id="9dd3e-129">宣言型マークアップとソースコードをコピーした後、ブラウザーで表示することで `BatchDelete.aspx` をテストしてみましょう。</span><span class="sxs-lookup"><span data-stu-id="9dd3e-129">After copying over the declarative markup and source code, take a moment to test `BatchDelete.aspx` by viewing it through a browser.</span></span> <span data-ttu-id="9dd3e-130">GridView に最初の10個の製品が一覧表示され、各行に製品の名前、カテゴリ、価格がチェックボックスと共に表示されます。</span><span class="sxs-lookup"><span data-stu-id="9dd3e-130">You should see a GridView listing the first ten products in a GridView with each row listing the product s name, category, and price along with a checkbox.</span></span> <span data-ttu-id="9dd3e-131">[すべてを確認]、[すべてオフ]、[選択した製品を削除] の3つのボタンがあります。</span><span class="sxs-lookup"><span data-stu-id="9dd3e-131">There should be three buttons: Check All, Uncheck All, and Delete Selected Products.</span></span> <span data-ttu-id="9dd3e-132">[すべてを確認] ボタンをクリックすると、すべてのチェックボックスがオンになり、すべてのチェックボックスがオフになります。</span><span class="sxs-lookup"><span data-stu-id="9dd3e-132">Clicking the Check All button selects all checkboxes, while Uncheck All clears all checkboxes.</span></span> <span data-ttu-id="9dd3e-133">[選択した製品を削除] をクリックすると、選択した製品の `ProductID` 値を示すメッセージが表示されますが、実際には製品は削除されません。</span><span class="sxs-lookup"><span data-stu-id="9dd3e-133">Clicking Delete Selected Products displays a message that lists the `ProductID` values of the selected products, but does not actually delete the products.</span></span>

<span data-ttu-id="9dd3e-134">[CheckBoxField からのインターフェイスが BatchDeleting に移動されました。 ![](batch-deleting-cs/_static/image3.gif)](batch-deleting-cs/_static/image5.png)</span><span class="sxs-lookup"><span data-stu-id="9dd3e-134">[![The Interface from CheckBoxField.aspx has been Moved to BatchDeleting.aspx](batch-deleting-cs/_static/image3.gif)](batch-deleting-cs/_static/image5.png)</span></span>

<span data-ttu-id="9dd3e-135">**図 3**: `CheckBoxField.aspx` からのインターフェイスが `BatchDeleting.aspx` に移動されました ([クリックしてフルサイズのイメージを表示](batch-deleting-cs/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="9dd3e-135">**Figure 3**: The Interface from `CheckBoxField.aspx` has been Moved to `BatchDeleting.aspx` ([Click to view full-size image](batch-deleting-cs/_static/image6.png))</span></span>

## <a name="step-2-deleting-the-checked-products-using-transactions"></a><span data-ttu-id="9dd3e-136">手順 2: トランザクションを使用してチェックされた製品を削除する</span><span class="sxs-lookup"><span data-stu-id="9dd3e-136">Step 2: Deleting the Checked Products Using Transactions</span></span>

<span data-ttu-id="9dd3e-137">バッチ削除インターフェイスが `BatchDeleting.aspx`に正常にコピーされたので、[選択した製品の削除] ボタンが `ProductsBLL` クラスの `DeleteProductsWithTransaction` メソッドを使用してチェックされた製品を削除するようにコードを更新します。</span><span class="sxs-lookup"><span data-stu-id="9dd3e-137">With the batch deleting interface successfully copied over to `BatchDeleting.aspx`, all that remains is to update the code so that the Delete Selected Products button deletes the checked products using the `DeleteProductsWithTransaction` method in the `ProductsBLL` class.</span></span> <span data-ttu-id="9dd3e-138">このメソッドは、「[トランザクション内のデータベースの変更のラップ](wrapping-database-modifications-within-a-transaction-cs.md)」チュートリアルで追加され、`ProductID` 値の `List<T>` を入力として受け取り、対応する各 `ProductID` をトランザクションのスコープ内で削除します。</span><span class="sxs-lookup"><span data-stu-id="9dd3e-138">This method, added in the [Wrapping Database Modifications within a Transaction](wrapping-database-modifications-within-a-transaction-cs.md) tutorial, accepts as its input a `List<T>` of `ProductID` values and deletes each corresponding `ProductID` within the scope of a transaction.</span></span>

<span data-ttu-id="9dd3e-139">`DeleteSelectedProducts` Button s `Click` イベントハンドラーは、現在、次の `foreach` ループを使用して、各 GridView 行を反復処理します。</span><span class="sxs-lookup"><span data-stu-id="9dd3e-139">The `DeleteSelectedProducts` Button s `Click` event handler currently uses the following `foreach` loop to iterate through each GridView row:</span></span>

[!code-csharp[Main](batch-deleting-cs/samples/sample2.cs)]

<span data-ttu-id="9dd3e-140">各行に対して、`ProductSelector` CheckBox Web コントロールはプログラムによって参照されます。</span><span class="sxs-lookup"><span data-stu-id="9dd3e-140">For each row, the `ProductSelector` CheckBox Web control is programmatically referenced.</span></span> <span data-ttu-id="9dd3e-141">このチェックボックスをオンにすると、行の `ProductID` が `DataKeys` コレクションから取得され、`DeleteResults` ラベル s `Text` プロパティが更新されて、行が削除対象として選択されたことを示すメッセージが表示されます。</span><span class="sxs-lookup"><span data-stu-id="9dd3e-141">If it is checked, the row s `ProductID` is retrieved from the `DataKeys` collection and the `DeleteResults` Label s `Text` property is updated to include a message indicating that the row was selected for deletion.</span></span>

<span data-ttu-id="9dd3e-142">上記のコードでは、`ProductsBLL` クラス s への呼び出しとして、実際にはレコードが削除されません `Delete` メソッドはコメントアウトされています。この削除ロジックが適用された場合、コードはアトミック操作内ではなく、製品を削除します。</span><span class="sxs-lookup"><span data-stu-id="9dd3e-142">The above code does not actually delete any records as the call to the `ProductsBLL` class s `Delete` method is commented out. Were this delete logic to be applied, the code would delete the products but not within an atomic operation.</span></span> <span data-ttu-id="9dd3e-143">つまり、シーケンス内の最初のいくつかの削除が成功したが、後で失敗した場合 (外部キー制約違反など)、例外がスローされますが、既に削除されている製品は削除されたままになります。</span><span class="sxs-lookup"><span data-stu-id="9dd3e-143">That is, if the first few deletes in the sequence succeeded, but a later one failed (perhaps due to a foreign key constraint violation), an exception would be thrown but those products already deleted would remain deleted.</span></span>

<span data-ttu-id="9dd3e-144">原子性を確保するために、代わりに `ProductsBLL` クラス s `DeleteProductsWithTransaction` メソッドを使用する必要があります。</span><span class="sxs-lookup"><span data-stu-id="9dd3e-144">In order to assure atomicity, we need to instead use the `ProductsBLL` class s `DeleteProductsWithTransaction` method.</span></span> <span data-ttu-id="9dd3e-145">このメソッドは `ProductID` 値のリストを受け入れるため、まずグリッドからこのリストをコンパイルし、それをパラメーターとして渡す必要があります。</span><span class="sxs-lookup"><span data-stu-id="9dd3e-145">Because this method accepts a list of `ProductID` values, we need to first compile this list from the grid and then pass it as a parameter.</span></span> <span data-ttu-id="9dd3e-146">まず、`int`型の `List<T>` のインスタンスを作成します。</span><span class="sxs-lookup"><span data-stu-id="9dd3e-146">We first create an instance of a `List<T>` of type `int`.</span></span> <span data-ttu-id="9dd3e-147">`foreach` ループ内で、選択した製品 `ProductID` 値をこの `List<T>`に追加する必要があります。</span><span class="sxs-lookup"><span data-stu-id="9dd3e-147">Within the `foreach` loop we need to add the selected products `ProductID` values to this `List<T>`.</span></span> <span data-ttu-id="9dd3e-148">ループの後、この `List<T>` は `ProductsBLL` クラス s `DeleteProductsWithTransaction` メソッドに渡す必要があります。</span><span class="sxs-lookup"><span data-stu-id="9dd3e-148">After the loop this `List<T>` must be passed to the `ProductsBLL` class s `DeleteProductsWithTransaction` method.</span></span> <span data-ttu-id="9dd3e-149">次のコードを使用して、`DeleteSelectedProducts` Button s `Click` イベントハンドラーを更新します。</span><span class="sxs-lookup"><span data-stu-id="9dd3e-149">Update the `DeleteSelectedProducts` Button s `Click` event handler with the following code:</span></span>

[!code-csharp[Main](batch-deleting-cs/samples/sample3.cs)]

<span data-ttu-id="9dd3e-150">更新されたコードは、型 `int` (`productIDsToDelete`) の `List<T>` を作成し、削除する `ProductID` 値を設定します。</span><span class="sxs-lookup"><span data-stu-id="9dd3e-150">The updated code creates a `List<T>` of type `int` (`productIDsToDelete`) and populates it with the `ProductID` values to delete.</span></span> <span data-ttu-id="9dd3e-151">`foreach` ループの後、少なくとも1つの製品が選択されている場合は、`ProductsBLL` クラス s `DeleteProductsWithTransaction` メソッドが呼び出され、このリストが渡されます。</span><span class="sxs-lookup"><span data-stu-id="9dd3e-151">After the `foreach` loop, if there is at least one product selected, the `ProductsBLL` class s `DeleteProductsWithTransaction` method is called and passed this list.</span></span> <span data-ttu-id="9dd3e-152">`DeleteResults` ラベルも表示され、データが GridView に再バインドされます (新しく削除されたレコードがグリッド内の行として表示されなくなります)。</span><span class="sxs-lookup"><span data-stu-id="9dd3e-152">The `DeleteResults` Label is also displayed and the data rebound to the GridView (so that the newly-deleted records no longer appear as rows in the grid).</span></span>

<span data-ttu-id="9dd3e-153">図4に、削除対象として複数の行が選択された後の GridView を示します。</span><span class="sxs-lookup"><span data-stu-id="9dd3e-153">Figure 4 shows the GridView after a number of rows have been selected for deletion.</span></span> <span data-ttu-id="9dd3e-154">図5に、[選択した製品の削除] ボタンがクリックされた直後の画面を示します。</span><span class="sxs-lookup"><span data-stu-id="9dd3e-154">Figure 5 shows the screen immediately after the Delete Selected Products button has been clicked.</span></span> <span data-ttu-id="9dd3e-155">図5では、削除されたレコードの `ProductID` 値が GridView の下のラベルに表示され、これらの行は GridView に存在しなくなっていることに注意してください。</span><span class="sxs-lookup"><span data-stu-id="9dd3e-155">Note that in Figure 5 the `ProductID` values of the deleted records are displayed in the Label beneath the GridView and those rows are no longer in the GridView.</span></span>

<span data-ttu-id="9dd3e-156">[選択した製品が削除され ![](batch-deleting-cs/_static/image4.gif)](batch-deleting-cs/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="9dd3e-156">[![The Selected Products Will Be Deleted](batch-deleting-cs/_static/image4.gif)](batch-deleting-cs/_static/image7.png)</span></span>

<span data-ttu-id="9dd3e-157">**図 4**: 選択した製品が削除されます ([クリックすると、フルサイズの画像が表示](batch-deleting-cs/_static/image8.png)されます)</span><span class="sxs-lookup"><span data-stu-id="9dd3e-157">**Figure 4**: The Selected Products Will Be Deleted ([Click to view full-size image](batch-deleting-cs/_static/image8.png))</span></span>

<span data-ttu-id="9dd3e-158">[削除された製品の ProductID 値が GridView の下に一覧表示され ![](batch-deleting-cs/_static/image5.gif)](batch-deleting-cs/_static/image9.png)</span><span class="sxs-lookup"><span data-stu-id="9dd3e-158">[![The Deleted Products ProductID Values are Listed Beneath the GridView](batch-deleting-cs/_static/image5.gif)](batch-deleting-cs/_static/image9.png)</span></span>

<span data-ttu-id="9dd3e-159">**図 5**: 削除された製品 `ProductID` 値は GridView の下に一覧表示されます ([クリックすると、フルサイズの画像が表示](batch-deleting-cs/_static/image10.png)されます)</span><span class="sxs-lookup"><span data-stu-id="9dd3e-159">**Figure 5**: The Deleted Products `ProductID` Values are Listed Beneath the GridView ([Click to view full-size image](batch-deleting-cs/_static/image10.png))</span></span>

> [!NOTE]
> <span data-ttu-id="9dd3e-160">`DeleteProductsWithTransaction` メソッドの原子性をテストするには、`Order Details` テーブルに製品のエントリを手動で追加し、その製品を削除します (他のユーザーと一緒に)。</span><span class="sxs-lookup"><span data-stu-id="9dd3e-160">To test the `DeleteProductsWithTransaction` method s atomicity, manually add an entry for a product in the `Order Details` table and then attempt to delete that product (along with others).</span></span> <span data-ttu-id="9dd3e-161">関連付けられた注文で製品を削除しようとすると、外部キー制約違反が発生しますが、選択した他の製品の削除がロールバックされる方法に注意してください。</span><span class="sxs-lookup"><span data-stu-id="9dd3e-161">You will receive a foreign key constraint violation when attempting to delete the product with an associated order, but note how the other selected products deletions are rolled back.</span></span>

## <a name="summary"></a><span data-ttu-id="9dd3e-162">まとめ</span><span class="sxs-lookup"><span data-stu-id="9dd3e-162">Summary</span></span>

<span data-ttu-id="9dd3e-163">バッチを削除するためのインターフェイスを作成するには、チェックボックスの列を含む GridView を追加します。ボタン Web コントロールは、クリックすると、選択したすべての行を1つのアトミック操作として削除します。</span><span class="sxs-lookup"><span data-stu-id="9dd3e-163">Creating a batch deleting interface involves adding a GridView with a column of checkboxes and a Button Web control that, when clicked, will delete all of the selected rows as a single atomic operation.</span></span> <span data-ttu-id="9dd3e-164">このチュートリアルでは、前の2つのチュートリアルで説明したように、このようなインターフェイスを構築し、[チェックボックスの GridView 列を追加](../enhancing-the-gridview/adding-a-gridview-column-of-checkboxes-cs.md)して、[データベースの変更をトランザクション内にラップ](wrapping-database-modifications-within-a-transaction-cs.md)します。</span><span class="sxs-lookup"><span data-stu-id="9dd3e-164">In this tutorial we built such an interface by piecing together work done in two previous tutorials, [Adding a GridView Column of Checkboxes](../enhancing-the-gridview/adding-a-gridview-column-of-checkboxes-cs.md) and [Wrapping Database Modifications within a Transaction](wrapping-database-modifications-within-a-transaction-cs.md).</span></span> <span data-ttu-id="9dd3e-165">最初のチュートリアルでは、チェックボックスの列を含む GridView を作成しました。後者では、`ProductID` 値の `List<T>` が渡されたときに、そのすべてをトランザクションのスコープ内で削除したメソッドを BLL に実装しました。</span><span class="sxs-lookup"><span data-stu-id="9dd3e-165">In the first tutorial we created a GridView with a column of checkboxes and in the latter we implemented a method in the BLL that, when passed a `List<T>` of `ProductID` values, deleted them all within the scope of a transaction.</span></span>

<span data-ttu-id="9dd3e-166">次のチュートリアルでは、バッチ挿入を実行するためのインターフェイスを作成します。</span><span class="sxs-lookup"><span data-stu-id="9dd3e-166">In the next tutorial we'll create an interface for performing batch inserts.</span></span>

<span data-ttu-id="9dd3e-167">プログラミングを楽しんでください。</span><span class="sxs-lookup"><span data-stu-id="9dd3e-167">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="9dd3e-168">著者について</span><span class="sxs-lookup"><span data-stu-id="9dd3e-168">About the Author</span></span>

<span data-ttu-id="9dd3e-169">1998以来、 [Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml)は 7 asp/創設者 of [4GuysFromRolla.com](http://www.4guysfromrolla.com)の執筆者であり、Microsoft Web テクノロジを使用しています。</span><span class="sxs-lookup"><span data-stu-id="9dd3e-169">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="9dd3e-170">Scott は、独立したコンサルタント、トレーナー、およびライターとして機能します。</span><span class="sxs-lookup"><span data-stu-id="9dd3e-170">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="9dd3e-171">彼の最新の書籍は[ *、ASP.NET 2.0 を24時間以内に教え*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)ています。</span><span class="sxs-lookup"><span data-stu-id="9dd3e-171">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="9dd3e-172">mitchell@4GuysFromRolla.comでアクセスでき[ます。](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="9dd3e-172">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="9dd3e-173">または彼のブログを参照してください。これは[http://ScottOnWriting.NET](http://ScottOnWriting.NET)にあります。</span><span class="sxs-lookup"><span data-stu-id="9dd3e-173">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="9dd3e-174">ありがとうございました。</span><span class="sxs-lookup"><span data-stu-id="9dd3e-174">Special Thanks To</span></span>

<span data-ttu-id="9dd3e-175">このチュートリアルシリーズは、役に立つ多くのレビュー担当者によってレビューされました。</span><span class="sxs-lookup"><span data-stu-id="9dd3e-175">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="9dd3e-176">このチュートリアルのリードレビュー担当者は、Hilton Giesenow and Teresa Murphy でした。</span><span class="sxs-lookup"><span data-stu-id="9dd3e-176">Lead reviewers for this tutorial were Hilton Giesenow and Teresa Murphy.</span></span> <span data-ttu-id="9dd3e-177">今後の MSDN 記事を確認することに興味がありますか?</span><span class="sxs-lookup"><span data-stu-id="9dd3e-177">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="9dd3e-178">その場合は、mitchell@4GuysFromRolla.comの行を削除[します。](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="9dd3e-178">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="9dd3e-179">[前へ](batch-updating-cs.md)
> [次へ](batch-inserting-cs.md)</span><span class="sxs-lookup"><span data-stu-id="9dd3e-179">[Previous](batch-updating-cs.md)
[Next](batch-inserting-cs.md)</span></span>

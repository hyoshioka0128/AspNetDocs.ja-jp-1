---
uid: web-forms/overview/data-access/basic-reporting/programmatically-setting-the-objectdatasource-s-parameter-values-vb
title: ObjectDataSource のパラメーター値をプログラムで設定する (VB) |Microsoft Docs
author: rick-anderson
description: このチュートリアルでは、単一の入力パラメーターを受け取り、データを返す、DAL と BLL にメソッドを追加する方法について説明します。 この例では、次のパラメーターを設定します...
ms.author: riande
ms.date: 03/31/2010
ms.assetid: 0ecb03b6-52a0-4731-8c7a-436391d36838
msc.legacyurl: /web-forms/overview/data-access/basic-reporting/programmatically-setting-the-objectdatasource-s-parameter-values-vb
msc.type: authoredcontent
ms.openlocfilehash: f1dd50f46528e8dd51f85e503604d3f0dbc21ad2
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 03/06/2020
ms.locfileid: "78465916"
---
# <a name="programmatically-setting-the-objectdatasources-parameter-values-vb"></a><span data-ttu-id="a5fc9-104">ObjectDataSource のパラメーター値をプログラムで設定する (VB)</span><span class="sxs-lookup"><span data-stu-id="a5fc9-104">Programmatically Setting the ObjectDataSource's Parameter Values (VB)</span></span>

<span data-ttu-id="a5fc9-105">[Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="a5fc9-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="a5fc9-106">[サンプルアプリのダウンロード](https://download.microsoft.com/download/5/d/7/5d7571fc-d0b7-4798-ad4a-c976c02363ce/ASPNET_Data_Tutorial_6_VB.exe)または[PDF のダウンロード](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/datatutorial06vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="a5fc9-106">[Download Sample App](https://download.microsoft.com/download/5/d/7/5d7571fc-d0b7-4798-ad4a-c976c02363ce/ASPNET_Data_Tutorial_6_VB.exe) or [Download PDF](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/datatutorial06vb1.pdf)</span></span>

> <span data-ttu-id="a5fc9-107">このチュートリアルでは、単一の入力パラメーターを受け取り、データを返す、DAL と BLL にメソッドを追加する方法について説明します。</span><span class="sxs-lookup"><span data-stu-id="a5fc9-107">In this tutorial we'll look at adding a method to our DAL and BLL that accepts a single input parameter and returns data.</span></span> <span data-ttu-id="a5fc9-108">この例では、このパラメーターをプログラムによって設定します。</span><span class="sxs-lookup"><span data-stu-id="a5fc9-108">The example will set this parameter programmatically.</span></span>

## <a name="introduction"></a><span data-ttu-id="a5fc9-109">はじめに</span><span class="sxs-lookup"><span data-stu-id="a5fc9-109">Introduction</span></span>

<span data-ttu-id="a5fc9-110">[前のチュートリアル](declarative-parameters-vb.md)で見たように、パラメーター値を ObjectDataSource のメソッドに宣言的に渡すためのオプションがいくつか用意されています。</span><span class="sxs-lookup"><span data-stu-id="a5fc9-110">As we saw in the [previous tutorial](declarative-parameters-vb.md), a number of options are available for declaratively passing parameter values to the ObjectDataSource's methods.</span></span> <span data-ttu-id="a5fc9-111">パラメーター値がハードコーディングされている場合、ページ上の Web コントロールから取得された場合、またはデータソース `Parameter` オブジェクトによって読み取り可能な他の任意のソースにある場合は、コード行を記述せずにその値を入力パラメーターにバインドできます。</span><span class="sxs-lookup"><span data-stu-id="a5fc9-111">If the parameter value is hard-coded, comes from a Web control on the page, or is in any other source that is readable by a data source `Parameter` object, for example, that value can be bound to the input parameter without writing a line of code.</span></span>

<span data-ttu-id="a5fc9-112">ただし、組み込みのデータソース `Parameter` オブジェクトのいずれかによってまだ使用されていないソースからパラメーター値が取得される場合もあります。</span><span class="sxs-lookup"><span data-stu-id="a5fc9-112">There may be times, however, when the parameter value comes from some source not already accounted for by one of the built-in data source `Parameter` objects.</span></span> <span data-ttu-id="a5fc9-113">サイトでユーザーアカウントがサポートされている場合は、現在ログインしているビジターのユーザー ID に基づいてパラメーターを設定することができます。</span><span class="sxs-lookup"><span data-stu-id="a5fc9-113">If our site supported user accounts we might want to set the parameter based on the currently logged in visitor's User ID.</span></span> <span data-ttu-id="a5fc9-114">また、場合によっては、ObjectDataSource の基になるオブジェクトのメソッドに送信する前に、パラメーター値をカスタマイズする必要があります。</span><span class="sxs-lookup"><span data-stu-id="a5fc9-114">Or we may need to customize the parameter value before sending it along to the ObjectDataSource's underlying object's method.</span></span>

<span data-ttu-id="a5fc9-115">ObjectDataSource の `Select` メソッドが呼び出されるたびに、ObjectDataSource は最初に選択した[イベント](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.selecting%28VS.80%29.aspx)を発生させます。</span><span class="sxs-lookup"><span data-stu-id="a5fc9-115">Whenever the ObjectDataSource's `Select` method is invoked the ObjectDataSource first raises its [Selecting event](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.selecting%28VS.80%29.aspx).</span></span> <span data-ttu-id="a5fc9-116">次に、ObjectDataSource の基になるオブジェクトのメソッドが呼び出されます。</span><span class="sxs-lookup"><span data-stu-id="a5fc9-116">The ObjectDataSource's underlying object's method is then invoked.</span></span> <span data-ttu-id="a5fc9-117">この処理が完了すると、ObjectDataSource の[選択されたイベント](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.selected%28VS.80%29.aspx)が発生します (図1はこの一連のイベントを示しています)。</span><span class="sxs-lookup"><span data-stu-id="a5fc9-117">Once that completes the ObjectDataSource's [Selected event](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.selected%28VS.80%29.aspx) fires (Figure 1 illustrates this sequence of events).</span></span> <span data-ttu-id="a5fc9-118">ObjectDataSource の基になるオブジェクトのメソッドに渡されたパラメーター値は、`Selecting` イベントのイベントハンドラーで設定またはカスタマイズできます。</span><span class="sxs-lookup"><span data-stu-id="a5fc9-118">The parameter values passed into the ObjectDataSource's underlying object's method can be set or customized in an event handler for the `Selecting` event.</span></span>

<span data-ttu-id="a5fc9-119">[ObjectDataSource の選択した ![、基になるオブジェクトのメソッドが呼び出される前と後にイベントを選択します。](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image2.png)](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="a5fc9-119">[![The ObjectDataSource's Selected and Selecting Events Fire Before and After Its Underlying Object's Method is Invoked](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image2.png)](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image1.png)</span></span>

<span data-ttu-id="a5fc9-120">**図 1**: 基になるオブジェクトのメソッドが呼び出される前と後に、ObjectDataSource の `Selected` イベントと `Selecting` イベントが起動される ([クリックすると、フルサイズの画像が表示](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image3.png)されます)</span><span class="sxs-lookup"><span data-stu-id="a5fc9-120">**Figure 1**: The ObjectDataSource's `Selected` and `Selecting` Events Fire Before and After Its Underlying Object's Method is Invoked ([Click to view full-size image](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image3.png))</span></span>

<span data-ttu-id="a5fc9-121">このチュートリアルでは、`Integer` 型の1つの入力パラメーター `Month`を受け取り、指定された `Month`で採用記念日がある従業員を含む `EmployeesDataTable` オブジェクトを返す、DAL および BLL にメソッドを追加する方法について説明します。</span><span class="sxs-lookup"><span data-stu-id="a5fc9-121">In this tutorial we'll look at adding a method to our DAL and BLL that accepts a single input parameter `Month`, of type `Integer` and returns an `EmployeesDataTable` object populated with those employees that have their hiring anniversary in the specified `Month`.</span></span> <span data-ttu-id="a5fc9-122">この例では、現在の月に基づいて、このパラメーターをプログラムによって設定し、「今月の従業員記念日」の一覧を示します。</span><span class="sxs-lookup"><span data-stu-id="a5fc9-122">Our example will set this parameter programmatically based on the current month, showing a list of "Employee Anniversaries This Month."</span></span>

<span data-ttu-id="a5fc9-123">作業開始</span><span class="sxs-lookup"><span data-stu-id="a5fc9-123">Let's get started!</span></span>

## <a name="step-1-adding-a-method-toemployeestableadapter"></a><span data-ttu-id="a5fc9-124">手順 1:`EmployeesTableAdapter` にメソッドを追加する</span><span class="sxs-lookup"><span data-stu-id="a5fc9-124">Step 1: Adding a Method to`EmployeesTableAdapter`</span></span>

<span data-ttu-id="a5fc9-125">最初の例では、指定された月に `HireDate` が発生した従業員を取得するための手段を追加する必要があります。</span><span class="sxs-lookup"><span data-stu-id="a5fc9-125">For our first example we need to add a means to retrieve those employees whose `HireDate` occurred in a specified month.</span></span> <span data-ttu-id="a5fc9-126">アーキテクチャに従ってこの機能を提供するには、まず、適切な SQL ステートメントに対応する `EmployeesTableAdapter` のメソッドを作成する必要があります。</span><span class="sxs-lookup"><span data-stu-id="a5fc9-126">To provide this functionality in accordance with our architecture we need to first create a method in `EmployeesTableAdapter` that maps to the proper SQL statement.</span></span> <span data-ttu-id="a5fc9-127">これを実現するには、まず、Northwind 型のデータセットを開きます。</span><span class="sxs-lookup"><span data-stu-id="a5fc9-127">To accomplish this, start by opening the Northwind Typed DataSet.</span></span> <span data-ttu-id="a5fc9-128">`EmployeesTableAdapter` ラベルを右クリックし、[クエリの追加] を選択します。</span><span class="sxs-lookup"><span data-stu-id="a5fc9-128">Right-click on the `EmployeesTableAdapter` label and choose Add Query.</span></span>

<span data-ttu-id="a5fc9-129">[EmployeesTableAdapter に新しいクエリを追加 ![には](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image5.png)](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="a5fc9-129">[![Add a New Query to the EmployeesTableAdapter](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image5.png)](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image4.png)</span></span>

<span data-ttu-id="a5fc9-130">**図 2**: `EmployeesTableAdapter` に新しいクエリを追加する ([クリックすると、フルサイズの画像が表示](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image6.png)されます)</span><span class="sxs-lookup"><span data-stu-id="a5fc9-130">**Figure 2**: Add a New Query to the `EmployeesTableAdapter` ([Click to view full-size image](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image6.png))</span></span>

<span data-ttu-id="a5fc9-131">行を返す SQL ステートメントを追加することを選択します。</span><span class="sxs-lookup"><span data-stu-id="a5fc9-131">Choose to add a SQL statement that returns rows.</span></span> <span data-ttu-id="a5fc9-132">[`SELECT` ステートメントの指定] 画面が表示されたら、`EmployeesTableAdapter` の既定の `SELECT` ステートメントが既に読み込まれています。</span><span class="sxs-lookup"><span data-stu-id="a5fc9-132">When you reach the Specify a `SELECT` Statement screen the default `SELECT` statement for the `EmployeesTableAdapter` will already be loaded.</span></span> <span data-ttu-id="a5fc9-133">単に `WHERE` 句: `WHERE DATEPART(m, HireDate) = @Month`にを追加します。</span><span class="sxs-lookup"><span data-stu-id="a5fc9-133">Simply add in the `WHERE` clause: `WHERE DATEPART(m, HireDate) = @Month`.</span></span> <span data-ttu-id="a5fc9-134">[DATEPART](https://msdn.microsoft.com/library/ms174420.aspx)は、`datetime` 型の特定の日付部分を返す t-sql 関数です。この例では、`DATEPART` を使用して、`HireDate` 列の月を返しています。</span><span class="sxs-lookup"><span data-stu-id="a5fc9-134">[DATEPART](https://msdn.microsoft.com/library/ms174420.aspx) is a T-SQL function that returns a particular date portion of a `datetime` type; in this case we're using `DATEPART` to return the month of the `HireDate` column.</span></span>

<span data-ttu-id="a5fc9-135">[![は、HireDate 列が @HiredBeforeDate パラメーター以下の行のみを返します。](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image8.png)](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="a5fc9-135">[![Return Only Those Rows Where the HireDate Column is Less Than or Equal to the @HiredBeforeDate Parameter](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image8.png)](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image7.png)</span></span>

<span data-ttu-id="a5fc9-136">**図 3**: `HireDate` 列が `@HiredBeforeDate` パラメーター以下の行のみを返す ([クリックすると、フルサイズの画像が表示](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image9.png)されます)</span><span class="sxs-lookup"><span data-stu-id="a5fc9-136">**Figure 3**: Return Only Those Rows Where the `HireDate` Column is Less Than or Equal to the `@HiredBeforeDate` Parameter ([Click to view full-size image](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image9.png))</span></span>

<span data-ttu-id="a5fc9-137">最後に、`FillBy` および `GetDataBy` メソッド名を `FillByHiredDateMonth` と `GetEmployeesByHiredDateMonth`にそれぞれ変更します。</span><span class="sxs-lookup"><span data-stu-id="a5fc9-137">Finally, change the `FillBy` and `GetDataBy` method names to `FillByHiredDateMonth` and `GetEmployeesByHiredDateMonth`, respectively.</span></span>

<span data-ttu-id="a5fc9-138">[FillBy と Get![y よりも適切なメソッド名を選択します](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image11.png)](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="a5fc9-138">[![Choose More Appropriate Method Names Than FillBy and GetDataBy](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image11.png)](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image10.png)</span></span>

<span data-ttu-id="a5fc9-139">**図 4**: `FillBy` と `GetDataBy` よりも適切なメソッド名を選択[する (クリックしてフルサイズのイメージを表示する](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="a5fc9-139">**Figure 4**: Choose More Appropriate Method Names Than `FillBy` and `GetDataBy` ([Click to view full-size image](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image12.png))</span></span>

<span data-ttu-id="a5fc9-140">[完了] をクリックしてウィザードを完了し、データセットのデザイン画面に戻ります。</span><span class="sxs-lookup"><span data-stu-id="a5fc9-140">Click Finish to complete the wizard and return to the DataSet's design surface.</span></span> <span data-ttu-id="a5fc9-141">`EmployeesTableAdapter` には、指定された月に入社した従業員にアクセスするための新しい一連のメソッドが含まれるようになりました。</span><span class="sxs-lookup"><span data-stu-id="a5fc9-141">The `EmployeesTableAdapter` should now include a new set of methods for accessing employees hired in a specified month.</span></span>

<span data-ttu-id="a5fc9-142">[新しいメソッド ![データセットのデザインサーフェイスに表示されます。](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image14.png)](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="a5fc9-142">[![The New Methods Appear in the DataSet's Design Surface](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image14.png)](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image13.png)</span></span>

<span data-ttu-id="a5fc9-143">**図 5**: 新しいメソッドがデータセットのデザインサーフェイスに表示される ([クリックしてフルサイズのイメージを表示する](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="a5fc9-143">**Figure 5**: The New Methods Appear in the DataSet's Design Surface ([Click to view full-size image](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image15.png))</span></span>

## <a name="step-2-adding-thegetemployeesbyhireddatemonthmonthmethod-to-the-business-logic-layer"></a><span data-ttu-id="a5fc9-144">手順 2: ビジネスロジック層への`GetEmployeesByHiredDateMonth(month)`メソッドの追加</span><span class="sxs-lookup"><span data-stu-id="a5fc9-144">Step 2: Adding the`GetEmployeesByHiredDateMonth(month)`Method to the Business Logic Layer</span></span>

<span data-ttu-id="a5fc9-145">アプリケーションアーキテクチャでは、ビジネスロジックとデータアクセスロジックに個別のレイヤーを使用しているため、指定された日付より前に入社した従業員を取得するために、DAL を呼び出すメソッドを BLL に追加する必要があります。</span><span class="sxs-lookup"><span data-stu-id="a5fc9-145">Since our application architecture uses a separate layer for the business logic and data access logic, we need to add a method to our BLL that calls down to the DAL to retrieve employees hired before a specified date.</span></span> <span data-ttu-id="a5fc9-146">`EmployeesBLL.vb` ファイルを開き、次のメソッドを追加します。</span><span class="sxs-lookup"><span data-stu-id="a5fc9-146">Open the `EmployeesBLL.vb` file and add the following method:</span></span>

[!code-vb[Main](programmatically-setting-the-objectdatasource-s-parameter-values-vb/samples/sample1.vb)]

<span data-ttu-id="a5fc9-147">このクラスの他のメソッドと同様に、`GetEmployeesByHiredDateMonth(month)` は単に DAL を呼び出し、結果を返します。</span><span class="sxs-lookup"><span data-stu-id="a5fc9-147">As with our other methods in this class, `GetEmployeesByHiredDateMonth(month)` simply calls down into the DAL and returns the results.</span></span>

## <a name="step-3-displaying-employees-whose-hiring-anniversary-is-this-month"></a><span data-ttu-id="a5fc9-148">手順 3: 雇用記念日が今月である従業員を表示する</span><span class="sxs-lookup"><span data-stu-id="a5fc9-148">Step 3: Displaying Employees Whose Hiring Anniversary Is This Month</span></span>

<span data-ttu-id="a5fc9-149">この例の最後の手順では、雇用記念日が今月である従業員を表示します。</span><span class="sxs-lookup"><span data-stu-id="a5fc9-149">Our final step for this example is to display those employees whose hiring anniversary is this month.</span></span> <span data-ttu-id="a5fc9-150">まず、GridView を `BasicReporting` フォルダーの `ProgrammaticParams.aspx` ページに追加し、新しい ObjectDataSource をそのデータソースとして追加します。</span><span class="sxs-lookup"><span data-stu-id="a5fc9-150">Start by adding a GridView to the `ProgrammaticParams.aspx` page in the `BasicReporting` folder and add a new ObjectDataSource as its data source.</span></span> <span data-ttu-id="a5fc9-151">`SelectMethod` が `GetEmployeesByHiredDateMonth(month)`に設定された `EmployeesBLL` クラスを使用するように ObjectDataSource を構成します。</span><span class="sxs-lookup"><span data-stu-id="a5fc9-151">Configure the ObjectDataSource to use the `EmployeesBLL` class with the `SelectMethod` set to `GetEmployeesByHiredDateMonth(month)`.</span></span>

<span data-ttu-id="a5fc9-152">[EmployeesBLL クラスを使用 ![には](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image17.png)](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="a5fc9-152">[![Use the EmployeesBLL Class](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image17.png)](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image16.png)</span></span>

<span data-ttu-id="a5fc9-153">**図 6**: `EmployeesBLL` クラスを使用[する (クリックすると、フルサイズの画像が表示](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image18.png)されます)</span><span class="sxs-lookup"><span data-stu-id="a5fc9-153">**Figure 6**: Use the `EmployeesBLL` Class ([Click to view full-size image](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image18.png))</span></span>

<span data-ttu-id="a5fc9-154">[GetEmployeesByHiredDateMonth (month) メソッドから Select を ![](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image20.png)](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="a5fc9-154">[![Select From the GetEmployeesByHiredDateMonth(month) method](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image20.png)](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image19.png)</span></span>

<span data-ttu-id="a5fc9-155">**図 7**: `GetEmployeesByHiredDateMonth(month)` メソッドから選択する ([クリックすると、フルサイズの画像が表示](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image21.png)されます)</span><span class="sxs-lookup"><span data-stu-id="a5fc9-155">**Figure 7**: Select From the `GetEmployeesByHiredDateMonth(month)` method ([Click to view full-size image](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image21.png))</span></span>

<span data-ttu-id="a5fc9-156">最後の画面では、`month` パラメーター値のソースを指定するように求められます。</span><span class="sxs-lookup"><span data-stu-id="a5fc9-156">The final screen asks us to provide the `month` parameter value's source.</span></span> <span data-ttu-id="a5fc9-157">この値はプログラムによって設定されるため、[パラメーターソース] を既定の [なし] に設定したままにして、[完了] をクリックします。</span><span class="sxs-lookup"><span data-stu-id="a5fc9-157">Since we'll set this value programmatically, leave the Parameter source set to the default None option and click Finish.</span></span>

<span data-ttu-id="a5fc9-158">[パラメーターソースを None に設定したままにする ![](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image23.png)](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image22.png)</span><span class="sxs-lookup"><span data-stu-id="a5fc9-158">[![Leave the Parameter Source Set to None](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image23.png)](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image22.png)</span></span>

<span data-ttu-id="a5fc9-159">**図 8**: パラメーターソースを None に設定したままにする ([クリックすると、フルサイズのイメージが表示](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image24.png)されます)</span><span class="sxs-lookup"><span data-stu-id="a5fc9-159">**Figure 8**: Leave the Parameter Source Set to None ([Click to view full-size image](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image24.png))</span></span>

<span data-ttu-id="a5fc9-160">これにより、値が指定されていない ObjectDataSource の `SelectParameters` コレクションに `Parameter` オブジェクトが作成されます。</span><span class="sxs-lookup"><span data-stu-id="a5fc9-160">This will create a `Parameter` object in the ObjectDataSource's `SelectParameters` collection that does not have a value specified.</span></span>

[!code-aspx[Main](programmatically-setting-the-objectdatasource-s-parameter-values-vb/samples/sample2.aspx)]

<span data-ttu-id="a5fc9-161">この値をプログラムで設定するには、ObjectDataSource の `Selecting` イベントのイベントハンドラーを作成する必要があります。</span><span class="sxs-lookup"><span data-stu-id="a5fc9-161">To set this value programmatically, we need to create an event handler for the ObjectDataSource's `Selecting` event.</span></span> <span data-ttu-id="a5fc9-162">これを行うには、デザインビューにアクセスし、ObjectDataSource をダブルクリックします。</span><span class="sxs-lookup"><span data-stu-id="a5fc9-162">To accomplish this, go to the Design view and double-click the ObjectDataSource.</span></span> <span data-ttu-id="a5fc9-163">または、ObjectDataSource を選択し、プロパティウィンドウにアクセスして、[稲妻] アイコンをクリックします。</span><span class="sxs-lookup"><span data-stu-id="a5fc9-163">Alternatively, select the ObjectDataSource, go to the Properties window, and click the lightning bolt icon.</span></span> <span data-ttu-id="a5fc9-164">次に、`Selecting` イベントの横にあるテキストボックスをダブルクリックするか、使用するイベントハンドラーの名前を入力します。</span><span class="sxs-lookup"><span data-stu-id="a5fc9-164">Next, either double-click in the textbox next to the `Selecting` event or type in the name of the event handler you want to use.</span></span> <span data-ttu-id="a5fc9-165">3番目のオプションとして、イベントハンドラーを作成するには、ページの分離コードクラスの上部にある2つのドロップダウンリストから ObjectDataSource とその `Selecting` イベントを選択します。</span><span class="sxs-lookup"><span data-stu-id="a5fc9-165">As a third option, you can create the event handler by selecting the ObjectDataSource and its `Selecting` event from the two drop-down lists at the top of the page's code-behind class.</span></span>

![[プロパティ] ウィンドウの [稲妻] アイコンをクリックして、Web コントロールのイベントの一覧を表示します。](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image25.png)

<span data-ttu-id="a5fc9-167">**図 9**: [プロパティ] ウィンドウの稲妻アイコンをクリックして、Web コントロールのイベントを一覧表示する</span><span class="sxs-lookup"><span data-stu-id="a5fc9-167">**Figure 9**: Click on the Lightning Bolt Icon in the Properties Window to List a Web Control's Events</span></span>

<span data-ttu-id="a5fc9-168">3つの方法はすべて、ObjectDataSource の `Selecting` イベントの新しいイベントハンドラーをページの分離コードクラスに追加します。</span><span class="sxs-lookup"><span data-stu-id="a5fc9-168">All three approaches add a new event handler for the ObjectDataSource's `Selecting` event to the page's code-behind class.</span></span> <span data-ttu-id="a5fc9-169">このイベントハンドラーでは、`e.InputParameters(parameterName)`を使用してパラメーター値の読み取りと書き込みを行うことができます。ここで *`parameterName`* は `<asp:Parameter>` タグの `Name` 属性の値です (`InputParameters` コレクションには、`e.InputParameters(index)`のように、インデックスを作成することもできます)。</span><span class="sxs-lookup"><span data-stu-id="a5fc9-169">In this event handler we can read and write to the parameter values using `e.InputParameters(parameterName)`, where *`parameterName`* is the value of the `Name` attribute in the `<asp:Parameter>` tag (the `InputParameters` collection can also be indexed ordinally, as in `e.InputParameters(index)`).</span></span> <span data-ttu-id="a5fc9-170">`month` パラメーターを現在の月に設定するには、`Selecting` イベントハンドラーに次のを追加します。</span><span class="sxs-lookup"><span data-stu-id="a5fc9-170">To set the `month` parameter to the current month, add the following to the `Selecting` event handler:</span></span>

[!code-vb[Main](programmatically-setting-the-objectdatasource-s-parameter-values-vb/samples/sample3.vb)]

<span data-ttu-id="a5fc9-171">ブラウザーを使用してこのページにアクセスすると、1人の従業員のみが入社したことがわかります。この月に入社した従業員は、1994年以降、Callahan 年3月になりました。</span><span class="sxs-lookup"><span data-stu-id="a5fc9-171">When visiting this page through a browser we can see that only one employee was hired this month (March) Laura Callahan, who's been with the company since 1994.</span></span>

<span data-ttu-id="a5fc9-172">[今月の記念日が表示されている従業員を ![します](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image27.png)](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image26.png)</span><span class="sxs-lookup"><span data-stu-id="a5fc9-172">[![Those Employees Whose Anniversaries This Month Are Shown](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image27.png)](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image26.png)</span></span>

<span data-ttu-id="a5fc9-173">**図 10**: 今月の記念日が表示されている従業員 ([フルサイズの画像を表示するにはクリックし](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image28.png)ます)</span><span class="sxs-lookup"><span data-stu-id="a5fc9-173">**Figure 10**: Those Employees Whose Anniversaries This Month Are Shown ([Click to view full-size image](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image28.png))</span></span>

## <a name="summary"></a><span data-ttu-id="a5fc9-174">まとめ</span><span class="sxs-lookup"><span data-stu-id="a5fc9-174">Summary</span></span>

<span data-ttu-id="a5fc9-175">ObjectDataSource のパラメーターの値は通常、コード行を必要とせずに宣言して設定できますが、パラメーター値はプログラムで簡単に設定できます。</span><span class="sxs-lookup"><span data-stu-id="a5fc9-175">While the ObjectDataSource's parameters' values can typically be set declaratively, without requiring a line of code, it's easy to set the parameter values programmatically.</span></span> <span data-ttu-id="a5fc9-176">必要なのは、ObjectDataSource の `Selecting` イベントのイベントハンドラーを作成することだけです。これは、基になるオブジェクトのメソッドが呼び出される前に発生し、`InputParameters` コレクションを介して1つ以上のパラメーターの値を手動で設定します。</span><span class="sxs-lookup"><span data-stu-id="a5fc9-176">All we need to do is create an event handler for the ObjectDataSource's `Selecting` event, which fires before the underlying object's method is invoked, and manually set the values for one or more parameters via the `InputParameters` collection.</span></span>

<span data-ttu-id="a5fc9-177">このチュートリアルでは、基本的なレポートのセクションについて説明します。</span><span class="sxs-lookup"><span data-stu-id="a5fc9-177">This tutorial concludes the Basic Reporting section.</span></span> <span data-ttu-id="a5fc9-178">[次のチュートリアル](../masterdetail/master-detail-filtering-with-a-dropdownlist-vb.md)では、「フィルター処理とマスター/詳細シナリオ」セクションを開始します。このセクションでは、ビジターがデータをフィルター処理し、マスターレポートから詳細レポートにドリルダウンできるようにする方法について説明します。</span><span class="sxs-lookup"><span data-stu-id="a5fc9-178">The [next tutorial](../masterdetail/master-detail-filtering-with-a-dropdownlist-vb.md) kicks off the Filtering and Master-Details Scenarios section, in which we'll look at techniques for allowing the visitor to filter data and drill down from a master report into a details report.</span></span>

<span data-ttu-id="a5fc9-179">プログラミングを楽しんでください。</span><span class="sxs-lookup"><span data-stu-id="a5fc9-179">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="a5fc9-180">著者について</span><span class="sxs-lookup"><span data-stu-id="a5fc9-180">About the Author</span></span>

<span data-ttu-id="a5fc9-181">1998以来、 [Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml)は 7 asp/創設者 of [4GuysFromRolla.com](http://www.4guysfromrolla.com)の執筆者であり、Microsoft Web テクノロジを使用しています。</span><span class="sxs-lookup"><span data-stu-id="a5fc9-181">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="a5fc9-182">Scott は、独立したコンサルタント、トレーナー、およびライターとして機能します。</span><span class="sxs-lookup"><span data-stu-id="a5fc9-182">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="a5fc9-183">彼の最新の書籍は[ *、ASP.NET 2.0 を24時間以内に教え*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)ています。</span><span class="sxs-lookup"><span data-stu-id="a5fc9-183">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="a5fc9-184">mitchell@4GuysFromRolla.comでアクセスでき[ます。](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="a5fc9-184">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="a5fc9-185">または彼のブログを参照してください。これは[http://ScottOnWriting.NET](http://ScottOnWriting.NET)にあります。</span><span class="sxs-lookup"><span data-stu-id="a5fc9-185">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="a5fc9-186">ありがとうございました。</span><span class="sxs-lookup"><span data-stu-id="a5fc9-186">Special Thanks To</span></span>

<span data-ttu-id="a5fc9-187">このチュートリアルシリーズは、役に立つ多くのレビュー担当者によってレビューされました。</span><span class="sxs-lookup"><span data-stu-id="a5fc9-187">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="a5fc9-188">このチュートリアルのリードレビュー担当者は、Hilton Giesenow でした。</span><span class="sxs-lookup"><span data-stu-id="a5fc9-188">Lead reviewer for this tutorial was Hilton Giesenow.</span></span> <span data-ttu-id="a5fc9-189">今後の MSDN 記事を確認することに興味がありますか?</span><span class="sxs-lookup"><span data-stu-id="a5fc9-189">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="a5fc9-190">その場合は、mitchell@4GuysFromRolla.comの行を削除[します。](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="a5fc9-190">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="a5fc9-191">[[戻る]](declarative-parameters-vb.md)</span><span class="sxs-lookup"><span data-stu-id="a5fc9-191">[Previous](declarative-parameters-vb.md)</span></span>

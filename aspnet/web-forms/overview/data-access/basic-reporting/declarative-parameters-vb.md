---
uid: web-forms/overview/data-access/basic-reporting/declarative-parameters-vb
title: 宣言型パラメーター (VB) |Microsoft Docs
author: rick-anderson
description: このチュートリアルでは、ハードコーディングされた値に設定されたパラメーターを使用して、DetailsView コントロールに表示するデータを選択する方法について説明します。
ms.author: riande
ms.date: 03/31/2010
ms.assetid: dc1234a3-114f-4c9a-8d25-50ca03cc8e8e
msc.legacyurl: /web-forms/overview/data-access/basic-reporting/declarative-parameters-vb
msc.type: authoredcontent
ms.openlocfilehash: cdc42752fc78d18366af037a81fe4ebe5a1646ef
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 03/06/2020
ms.locfileid: "78483130"
---
# <a name="declarative-parameters-vb"></a><span data-ttu-id="ac41e-103">宣言パラメーター (VB)</span><span class="sxs-lookup"><span data-stu-id="ac41e-103">Declarative Parameters (VB)</span></span>

<span data-ttu-id="ac41e-104">[Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="ac41e-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="ac41e-105">[サンプルアプリのダウンロード](https://download.microsoft.com/download/5/d/7/5d7571fc-d0b7-4798-ad4a-c976c02363ce/ASPNET_Data_Tutorial_5_VB.exe)または[PDF のダウンロード](declarative-parameters-vb/_static/datatutorial05vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="ac41e-105">[Download Sample App](https://download.microsoft.com/download/5/d/7/5d7571fc-d0b7-4798-ad4a-c976c02363ce/ASPNET_Data_Tutorial_5_VB.exe) or [Download PDF](declarative-parameters-vb/_static/datatutorial05vb1.pdf)</span></span>

> <span data-ttu-id="ac41e-106">このチュートリアルでは、ハードコーディングされた値に設定されたパラメーターを使用して、DetailsView コントロールに表示するデータを選択する方法について説明します。</span><span class="sxs-lookup"><span data-stu-id="ac41e-106">In this tutorial we'll illustrate how to use a parameter set to a hard-coded value to select the data to display in a DetailsView control.</span></span>

## <a name="introduction"></a><span data-ttu-id="ac41e-107">はじめに</span><span class="sxs-lookup"><span data-stu-id="ac41e-107">Introduction</span></span>

<span data-ttu-id="ac41e-108">最後の[チュートリアル](displaying-data-with-the-objectdatasource-vb.md)では、`ProductsBLL` クラスから `GetProducts()` メソッドを呼び出した ObjectDataSource コントロールにバインドされた GridView、DetailsView、FormView コントロールを使用してデータを表示する方法について見てきました。</span><span class="sxs-lookup"><span data-stu-id="ac41e-108">In the [last tutorial](displaying-data-with-the-objectdatasource-vb.md) we looked at displaying data with the GridView, DetailsView, and FormView controls bound to an ObjectDataSource control that invoked the `GetProducts()` method from the `ProductsBLL` class.</span></span> <span data-ttu-id="ac41e-109">`GetProducts()` メソッドは、Northwind データベースの `Products` テーブルのすべてのレコードを格納する、厳密に型指定された DataTable を返します。</span><span class="sxs-lookup"><span data-stu-id="ac41e-109">The `GetProducts()` method returns a strongly-typed DataTable populated with all of the records from the Northwind database's `Products` table.</span></span> <span data-ttu-id="ac41e-110">`ProductsBLL` クラスには、`GetProductByProductID(productID)`、`GetProductsByCategoryID(categoryID)`、および `GetProductsBySupplierID(supplierID)`製品のサブセットのみを返すための追加メソッドが含まれています。</span><span class="sxs-lookup"><span data-stu-id="ac41e-110">The `ProductsBLL` class contains additional methods for returning just subsets of the products - `GetProductByProductID(productID)`, `GetProductsByCategoryID(categoryID)`, and `GetProductsBySupplierID(supplierID)`.</span></span> <span data-ttu-id="ac41e-111">これら3つのメソッドは、返された製品情報をフィルター処理する方法を示す入力パラメーターを想定しています。</span><span class="sxs-lookup"><span data-stu-id="ac41e-111">These three methods expect an input parameter indicating how to filter the returned product information.</span></span>

<span data-ttu-id="ac41e-112">ObjectDataSource は、入力パラメーターを必要とするメソッドを呼び出すために使用できますが、そのためには、これらのパラメーターの値の取得元となる場所を指定する必要があります。</span><span class="sxs-lookup"><span data-stu-id="ac41e-112">The ObjectDataSource can be used to invoke methods that expect input parameters, but in order to do so we must specify where the values for these parameters come from.</span></span> <span data-ttu-id="ac41e-113">パラメーター値は、ハードコーディングすることも、クエリ文字列値、セッション変数、ページ上の Web コントロールのプロパティ値など、さまざまな動的ソースから取得することもできます。</span><span class="sxs-lookup"><span data-stu-id="ac41e-113">The parameter values can be hard-coded or can come from a variety of dynamic sources, including: querystring values, Session variables, the property value of a Web control on the page, or others.</span></span>

<span data-ttu-id="ac41e-114">このチュートリアルでは、まず、パラメーターをハードコーディングされた値に設定する方法を説明します。</span><span class="sxs-lookup"><span data-stu-id="ac41e-114">For this tutorial let's start by illustrating how to use a parameter set to a hard-coded value.</span></span> <span data-ttu-id="ac41e-115">具体的には、特定の製品に関する情報を表示する DetailsView をページに追加する方法について説明します。これには、`ProductID` が5の、Chef Anton の Gumbo Mix が含まれます。</span><span class="sxs-lookup"><span data-stu-id="ac41e-115">Specifically, we'll look at adding a DetailsView to the page that displays information about a specific product, namely Chef Anton's Gumbo Mix, which has a `ProductID` of 5.</span></span> <span data-ttu-id="ac41e-116">次に、Web コントロールに基づいてパラメーター値を設定する方法について説明します。</span><span class="sxs-lookup"><span data-stu-id="ac41e-116">Next, we'll see how to set the parameter value based on a Web control.</span></span> <span data-ttu-id="ac41e-117">具体的には、テキストボックスを使用してユーザーが国に入力できるようにします。その後、ボタンをクリックすると、その国に存在する業者の一覧が表示されます。</span><span class="sxs-lookup"><span data-stu-id="ac41e-117">In particular, we'll use a TextBox to let the user type in a country, after which they can click a Button to see the list of suppliers that reside in that country.</span></span>

## <a name="using-a-hard-coded-parameter-value"></a><span data-ttu-id="ac41e-118">ハードコーディングされたパラメーター値の使用</span><span class="sxs-lookup"><span data-stu-id="ac41e-118">Using a Hard-Coded Parameter Value</span></span>

<span data-ttu-id="ac41e-119">最初の例では、まず、`BasicReporting` フォルダーの `DeclarativeParams.aspx` ページに DetailsView コントロールを追加します。</span><span class="sxs-lookup"><span data-stu-id="ac41e-119">For the first example, start by adding a DetailsView control to the `DeclarativeParams.aspx` page in the `BasicReporting` folder.</span></span> <span data-ttu-id="ac41e-120">DetailsView のスマートタグから、ドロップダウンリストから [新しいデータソースの&gt; を &lt;] を選択し、ObjectDataSource を追加することを選択します。</span><span class="sxs-lookup"><span data-stu-id="ac41e-120">From the DetailsView's smart tag, select &lt;New data source&gt; from the drop-down list and choose to add an ObjectDataSource.</span></span>

<span data-ttu-id="ac41e-121">[![ObjectDataSource をページに追加する](declarative-parameters-vb/_static/image2.png)](declarative-parameters-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="ac41e-121">[![Add an ObjectDataSource to the Page](declarative-parameters-vb/_static/image2.png)](declarative-parameters-vb/_static/image1.png)</span></span>

<span data-ttu-id="ac41e-122">**図 1**: ObjectDataSource をページに追加する ([クリックすると、フルサイズの画像が表示](declarative-parameters-vb/_static/image3.png)されます)</span><span class="sxs-lookup"><span data-stu-id="ac41e-122">**Figure 1**: Add an ObjectDataSource to the Page ([Click to view full-size image](declarative-parameters-vb/_static/image3.png))</span></span>

<span data-ttu-id="ac41e-123">これにより、ObjectDataSource コントロールの [データソースの選択] ウィザードが自動的に開始されます。</span><span class="sxs-lookup"><span data-stu-id="ac41e-123">This will automatically start the ObjectDataSource control's Choose Data Source wizard.</span></span> <span data-ttu-id="ac41e-124">ウィザードの最初の画面で `ProductsBLL` クラスを選択します。</span><span class="sxs-lookup"><span data-stu-id="ac41e-124">Select the `ProductsBLL` class from the first screen of the wizard.</span></span>

<span data-ttu-id="ac41e-125">[製品の Bll クラスを選択 ![には](declarative-parameters-vb/_static/image5.png)](declarative-parameters-vb/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="ac41e-125">[![Select the ProductsBLL Class](declarative-parameters-vb/_static/image5.png)](declarative-parameters-vb/_static/image4.png)</span></span>

<span data-ttu-id="ac41e-126">**図 2**: `ProductsBLL` クラスを選択[する (クリックすると、フルサイズの画像が表示](declarative-parameters-vb/_static/image6.png)されます)</span><span class="sxs-lookup"><span data-stu-id="ac41e-126">**Figure 2**: Select the `ProductsBLL` Class ([Click to view full-size image](declarative-parameters-vb/_static/image6.png))</span></span>

<span data-ttu-id="ac41e-127">特定の製品に関する情報を表示する必要があるため、`GetProductByProductID(productID)` メソッドを使用します。</span><span class="sxs-lookup"><span data-stu-id="ac41e-127">Since we want to display information about a particular product we want to use the `GetProductByProductID(productID)` method.</span></span>

<span data-ttu-id="ac41e-128">[GetProductByProductID (productID) メソッドを選択 ![には](declarative-parameters-vb/_static/image8.png)](declarative-parameters-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="ac41e-128">[![Choose the GetProductByProductID(productID) method](declarative-parameters-vb/_static/image8.png)](declarative-parameters-vb/_static/image7.png)</span></span>

<span data-ttu-id="ac41e-129">**図 3**: `GetProductByProductID(productID)` メソッドを選択[する (クリックしてフルサイズの画像を表示する](declarative-parameters-vb/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="ac41e-129">**Figure 3**: Choose the `GetProductByProductID(productID)` method ([Click to view full-size image](declarative-parameters-vb/_static/image9.png))</span></span>

<span data-ttu-id="ac41e-130">選択したメソッドにはパラメーターが含まれているため、ウィザードの画面がもう1つ表示されます。この画面では、パラメーターに使用する値を定義するよう求められています。</span><span class="sxs-lookup"><span data-stu-id="ac41e-130">Since the method we selected includes a parameter, there's one more screen for the wizard, where we're asked to define the value to be used for the parameter.</span></span> <span data-ttu-id="ac41e-131">左側の一覧には、選択したメソッドのすべてのパラメーターが表示されます。</span><span class="sxs-lookup"><span data-stu-id="ac41e-131">The list on the left shows all of the parameters for the selected method.</span></span> <span data-ttu-id="ac41e-132">`GetProductByProductID(productID)` には、`productID`が1つだけあります。</span><span class="sxs-lookup"><span data-stu-id="ac41e-132">For `GetProductByProductID(productID)` there's only one `productID`.</span></span> <span data-ttu-id="ac41e-133">右側で、選択したパラメーターの値を指定できます。</span><span class="sxs-lookup"><span data-stu-id="ac41e-133">On the right we can specify the value for the selected parameter.</span></span> <span data-ttu-id="ac41e-134">[パラメーターのソース] ボックスの一覧には、パラメーター値に使用できるさまざまなソースが列挙されています。</span><span class="sxs-lookup"><span data-stu-id="ac41e-134">The parameter source drop-down list enumerates the various possible sources for the parameter value.</span></span> <span data-ttu-id="ac41e-135">`productID` パラメーターにはハードコーディングされた値5を指定するので、パラメーター source は None のままにし、DefaultValue テキストボックスに「5」と入力します。</span><span class="sxs-lookup"><span data-stu-id="ac41e-135">Since we want to specify a hard-coded value of 5 for the `productID` parameter, leave the Parameter source as None and enter 5 into the DefaultValue textbox.</span></span>

<span data-ttu-id="ac41e-136">[ハードコードされたパラメーター値5が productID パラメーターに使用される ![](declarative-parameters-vb/_static/image11.png)](declarative-parameters-vb/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="ac41e-136">[![A Hard-Coded Parameter Value of 5 Will Be Used for the productID Parameter](declarative-parameters-vb/_static/image11.png)](declarative-parameters-vb/_static/image10.png)</span></span>

<span data-ttu-id="ac41e-137">**図 4**: ハードコーディングされたパラメーター値5が `productID` パラメーターに使用されます ([クリックすると、フルサイズのイメージが表示](declarative-parameters-vb/_static/image12.png)されます)</span><span class="sxs-lookup"><span data-stu-id="ac41e-137">**Figure 4**: A Hard-Coded Parameter Value of 5 Will Be Used for the `productID` Parameter ([Click to view full-size image](declarative-parameters-vb/_static/image12.png))</span></span>

<span data-ttu-id="ac41e-138">データソースの構成ウィザードを完了すると、ObjectDataSource コントロールの宣言型マークアップには、`SelectMethod` プロパティで定義されたメソッドに必要な各入力パラメーターの `SelectParameters` コレクション内の `Parameter` オブジェクトが含まれます。</span><span class="sxs-lookup"><span data-stu-id="ac41e-138">After completing the Configure Data Source wizard, the ObjectDataSource control's declarative markup includes a `Parameter` object in the `SelectParameters` collection for each of the input parameters expected by the method defined in the `SelectMethod` property.</span></span> <span data-ttu-id="ac41e-139">この例で使用しているメソッドでは、1つの入力パラメーターだけが想定されているため、ここにはエントリが1つだけあります。 `parameterID`ます。</span><span class="sxs-lookup"><span data-stu-id="ac41e-139">Since the method we're using in this example expects just a single input parameter, `parameterID`, there's only one entry here.</span></span> <span data-ttu-id="ac41e-140">`SelectParameters` コレクションには、`System.Web.UI.WebControls` 名前空間の `Parameter` クラスから派生した任意のクラスを含めることができます。</span><span class="sxs-lookup"><span data-stu-id="ac41e-140">The `SelectParameters` collection can contain any class that derives from the `Parameter` class in the `System.Web.UI.WebControls` namespace.</span></span> <span data-ttu-id="ac41e-141">ハードコーディングされたパラメーター値の場合は、基本 `Parameter` クラスが使用されますが、その他のパラメーターソースオプションでは、派生 `Parameter` クラスが使用されます。必要に応じて、独自の[カスタムパラメーター型](http://www.leftslipper.com/ShowFaq.aspx?FaqId=11)を作成することもできます。</span><span class="sxs-lookup"><span data-stu-id="ac41e-141">For hard-coded parameter values the base `Parameter` class is used, but for the other parameter source options a derived `Parameter` class is used; you can also create your own [custom parameter types](http://www.leftslipper.com/ShowFaq.aspx?FaqId=11), if needed.</span></span>

[!code-aspx[Main](declarative-parameters-vb/samples/sample1.aspx)]

> [!NOTE]
> <span data-ttu-id="ac41e-142">自分のコンピューターに従っている場合、この時点で表示される宣言型マークアップには、`InsertMethod`、`UpdateMethod`、および `DeleteMethod` プロパティの値と `DeleteParameters`が含まれている可能性があります。</span><span class="sxs-lookup"><span data-stu-id="ac41e-142">If you're following along on your own computer the declarative markup you see at this point may include values for the `InsertMethod`, `UpdateMethod`, and `DeleteMethod` properties, as well as `DeleteParameters`.</span></span> <span data-ttu-id="ac41e-143">ObjectDataSource の [データソースの選択] ウィザードでは、挿入、更新、および削除に使用するメソッドが `ProductBLL` から自動的に指定されます。これらのメソッドを明示的にクリアしない限り、上記のマークアップに含まれます。</span><span class="sxs-lookup"><span data-stu-id="ac41e-143">The ObjectDataSource's Choose Data Source wizard automatically specifies the methods from the `ProductBLL` to use for inserting, updating, and deleting, so unless you explicitly cleared those out, they'll be included in the markup above.</span></span>

<span data-ttu-id="ac41e-144">このページにアクセスすると、データ Web コントロールは ObjectDataSource の `Select` メソッドを呼び出します。このメソッドは、`productID` 入力パラメーターに対してハードコーディングされた値5を使用して、`ProductsBLL` クラスの `GetProductByProductID(productID)` メソッドを呼び出します。</span><span class="sxs-lookup"><span data-stu-id="ac41e-144">When visiting this page, the data Web control will invoke the ObjectDataSource's `Select` method, which will call the `ProductsBLL` class's `GetProductByProductID(productID)` method using the hard-coded value of 5 for the `productID` input parameter.</span></span> <span data-ttu-id="ac41e-145">メソッドは、Chef Anton の Gumbo ミックス (製品の `ProductID` 5) に関する情報を含む単一行を含む、厳密に型指定された `ProductDataTable` オブジェクトを返します。</span><span class="sxs-lookup"><span data-stu-id="ac41e-145">The method will return a strongly-typed `ProductDataTable` object that contains a single row with information about Chef Anton's Gumbo Mix (the product with `ProductID` 5).</span></span>

<span data-ttu-id="ac41e-146">[Chef Anton の Gumbo ミックスに関する ![情報が表示されます](declarative-parameters-vb/_static/image14.png)](declarative-parameters-vb/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="ac41e-146">[![Information About Chef Anton's Gumbo Mix are Displayed](declarative-parameters-vb/_static/image14.png)](declarative-parameters-vb/_static/image13.png)</span></span>

<span data-ttu-id="ac41e-147">**図 5**: Chef Anton の Gumbo ミックスに関する情報の表示 ([クリックすると、フルサイズの画像が表示](declarative-parameters-vb/_static/image15.png)されます)</span><span class="sxs-lookup"><span data-stu-id="ac41e-147">**Figure 5**: Information About Chef Anton's Gumbo Mix are Displayed ([Click to view full-size image](declarative-parameters-vb/_static/image15.png))</span></span>

## <a name="setting-the-parameter-value-to-the-property-value-of-a-web-control"></a><span data-ttu-id="ac41e-148">パラメーター値を Web コントロールのプロパティ値に設定する</span><span class="sxs-lookup"><span data-stu-id="ac41e-148">Setting the Parameter Value to the Property Value of a Web Control</span></span>

<span data-ttu-id="ac41e-149">ObjectDataSource のパラメーター値は、ページの Web コントロールの値に基づいて設定することもできます。</span><span class="sxs-lookup"><span data-stu-id="ac41e-149">The ObjectDataSource's parameter values can also be set based on the value of a Web control on the page.</span></span> <span data-ttu-id="ac41e-150">これを説明するために、ユーザーによって指定された国に配置されているすべての仕入先を一覧表示する GridView を使用します。</span><span class="sxs-lookup"><span data-stu-id="ac41e-150">To illustrate this, let's have a GridView that lists all of the suppliers that are located in a country specified by the user.</span></span> <span data-ttu-id="ac41e-151">この作業を行うには、ユーザーが国名を入力できるページにテキストボックスを追加します。</span><span class="sxs-lookup"><span data-stu-id="ac41e-151">To accomplish this start by adding a TextBox to the page into which the user can enter a country name.</span></span> <span data-ttu-id="ac41e-152">このテキストボックスコントロールの `ID` プロパティを `CountryName`に設定します。</span><span class="sxs-lookup"><span data-stu-id="ac41e-152">Set this TextBox control's `ID` property to `CountryName`.</span></span> <span data-ttu-id="ac41e-153">また、ボタン Web コントロールも追加します。</span><span class="sxs-lookup"><span data-stu-id="ac41e-153">Also add a Button Web control.</span></span>

<span data-ttu-id="ac41e-154">[ID CountryName のページにテキストボックスを追加 ![には](declarative-parameters-vb/_static/image17.png)](declarative-parameters-vb/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="ac41e-154">[![Add a TextBox to the Page with ID CountryName](declarative-parameters-vb/_static/image17.png)](declarative-parameters-vb/_static/image16.png)</span></span>

<span data-ttu-id="ac41e-155">**図 6**: `ID` `CountryName` を含むテキストボックスをページに追加する ([クリックすると、フルサイズの画像が表示](declarative-parameters-vb/_static/image18.png)されます)</span><span class="sxs-lookup"><span data-stu-id="ac41e-155">**Figure 6**: Add a TextBox to the Page with `ID` `CountryName` ([Click to view full-size image](declarative-parameters-vb/_static/image18.png))</span></span>

<span data-ttu-id="ac41e-156">次に、GridView をページに追加し、スマートタグから新しい ObjectDataSource を追加することを選択します。</span><span class="sxs-lookup"><span data-stu-id="ac41e-156">Next, add a GridView to the page and, from the smart tag, choose to add a new ObjectDataSource.</span></span> <span data-ttu-id="ac41e-157">仕入先情報を表示するため、ウィザードの最初の画面から `SuppliersBLL` クラスを選択します。</span><span class="sxs-lookup"><span data-stu-id="ac41e-157">Since we want to display supplier information select the `SuppliersBLL` class from the wizard's first screen.</span></span> <span data-ttu-id="ac41e-158">2番目の画面で、`GetSuppliersByCountry(country)` メソッドを選択します。</span><span class="sxs-lookup"><span data-stu-id="ac41e-158">From the second screen, pick the `GetSuppliersByCountry(country)` method.</span></span>

<span data-ttu-id="ac41e-159">[GetSuppliersByCountry (country) メソッドを選択 ![には](declarative-parameters-vb/_static/image20.png)](declarative-parameters-vb/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="ac41e-159">[![Choose the GetSuppliersByCountry(country) Method](declarative-parameters-vb/_static/image20.png)](declarative-parameters-vb/_static/image19.png)</span></span>

<span data-ttu-id="ac41e-160">**図 7**: `GetSuppliersByCountry(country)` メソッドを選択[する (クリックしてフルサイズのイメージを表示する](declarative-parameters-vb/_static/image21.png))</span><span class="sxs-lookup"><span data-stu-id="ac41e-160">**Figure 7**: Choose the `GetSuppliersByCountry(country)` Method ([Click to view full-size image](declarative-parameters-vb/_static/image21.png))</span></span>

<span data-ttu-id="ac41e-161">`GetSuppliersByCountry(country)` メソッドに入力パラメーターがあるため、ウィザードには、パラメーター値を選択するための最後の画面がもう一度表示されます。</span><span class="sxs-lookup"><span data-stu-id="ac41e-161">Since the `GetSuppliersByCountry(country)` method has an input parameter, the wizard once again includes a final screen for choosing the parameter value.</span></span> <span data-ttu-id="ac41e-162">ここでは、パラメーターソースを [制御] に設定します。</span><span class="sxs-lookup"><span data-stu-id="ac41e-162">This time, set the Parameter source to Control.</span></span> <span data-ttu-id="ac41e-163">これにより、[ControlID] ドロップダウンリストに、ページ上のコントロールの名前が設定されます。一覧から `CountryName` コントロールを選択します。</span><span class="sxs-lookup"><span data-stu-id="ac41e-163">This will populate the ControlID drop-down list with the names of the controls on the page; select the `CountryName` control from the list.</span></span> <span data-ttu-id="ac41e-164">ページが最初に表示されたときに `CountryName` テキストボックスは空白になるため、結果は返されず、何も表示されません。</span><span class="sxs-lookup"><span data-stu-id="ac41e-164">When the page is first visited the `CountryName` TextBox will be blank, so no results are returned and nothing is displayed.</span></span> <span data-ttu-id="ac41e-165">既定でいくつかの結果を表示するには、DefaultValue テキストボックスを適宜設定します。</span><span class="sxs-lookup"><span data-stu-id="ac41e-165">If you want to display some results by default, set the DefaultValue textbox accordingly.</span></span>

<span data-ttu-id="ac41e-166">[CountryName コントロール値にパラメーター値を設定 ![には](declarative-parameters-vb/_static/image23.png)](declarative-parameters-vb/_static/image22.png)</span><span class="sxs-lookup"><span data-stu-id="ac41e-166">[![Set the Parameter Value to the CountryName Control Value](declarative-parameters-vb/_static/image23.png)](declarative-parameters-vb/_static/image22.png)</span></span>

<span data-ttu-id="ac41e-167">**図 8**: パラメーター値を `CountryName` コントロールの値に設定する ([クリックしてフルサイズのイメージを表示する](declarative-parameters-vb/_static/image24.png))</span><span class="sxs-lookup"><span data-stu-id="ac41e-167">**Figure 8**: Set the Parameter Value to the `CountryName` Control Value ([Click to view full-size image](declarative-parameters-vb/_static/image24.png))</span></span>

<span data-ttu-id="ac41e-168">ObjectDataSource の宣言型マークアップは、最初の例とは少し異なり、標準の `Parameter` オブジェクトの代わりに[Controlparameter](https://msdn.microsoft.com/library/system.web.ui.webcontrols.controlparameter.aspx)を使用します。</span><span class="sxs-lookup"><span data-stu-id="ac41e-168">The ObjectDataSource's declarative markup differs slightly from our first example, using a [ControlParameter](https://msdn.microsoft.com/library/system.web.ui.webcontrols.controlparameter.aspx) instead of the standard `Parameter` object.</span></span> <span data-ttu-id="ac41e-169">`ControlParameter` には、Web コントロールの `ID` と、パラメーターに使用するプロパティ値 (`PropertyName`) を指定するための追加のプロパティがあります。</span><span class="sxs-lookup"><span data-stu-id="ac41e-169">A `ControlParameter` has additional properties to specify the `ID` of the Web control and the property value to use for the parameter (`PropertyName`).</span></span> <span data-ttu-id="ac41e-170">データソースの構成ウィザードでは、テキストボックスの場合、パラメーター値に `Text` プロパティを使用することができます。</span><span class="sxs-lookup"><span data-stu-id="ac41e-170">The Configure Data Source wizard was smart enough to determine that, for a TextBox, we'll likely want to use the `Text` property for the parameter value.</span></span> <span data-ttu-id="ac41e-171">ただし、Web コントロールから別のプロパティ値を使用する場合は、ここで `PropertyName` 値を変更するか、ウィザードの [詳細プロパティの表示] リンクをクリックします。</span><span class="sxs-lookup"><span data-stu-id="ac41e-171">If, however, you want to use a different property value from the Web control you can change the `PropertyName` value here or by clicking the "Show advanced properties" link in the wizard.</span></span>

[!code-aspx[Main](declarative-parameters-vb/samples/sample2.aspx)]

<span data-ttu-id="ac41e-172">ページに初めてアクセスしたときに、`CountryName` テキストボックスが空になります。</span><span class="sxs-lookup"><span data-stu-id="ac41e-172">When visiting the page for the first time the `CountryName` TextBox is empty.</span></span> <span data-ttu-id="ac41e-173">ObjectDataSource の `Select` メソッドは GridView によってまだ呼び出されていますが、`GetSuppliersByCountry(country)` メソッドに `Nothing` の値が渡されます。</span><span class="sxs-lookup"><span data-stu-id="ac41e-173">The ObjectDataSource's `Select` method is still invoked by the GridView, but a value of `Nothing` is passed into the `GetSuppliersByCountry(country)` method.</span></span> <span data-ttu-id="ac41e-174">TableAdapter は、`Nothing` をデータベース `NULL` 値 (`DBNull.Value`) に変換しますが、`GetSuppliersByCountry(country)` メソッドによって使用されるクエリは、`NULL` パラメーターに `@CategoryID` 値が指定されている場合に値を返さないように記述されています。</span><span class="sxs-lookup"><span data-stu-id="ac41e-174">The TableAdapter converts the `Nothing` into a database `NULL` value (`DBNull.Value`), but the query used by the `GetSuppliersByCountry(country)` method is written such that it doesn't return any values when a `NULL` value is specified for the `@CategoryID` parameter.</span></span> <span data-ttu-id="ac41e-175">つまり、仕入先は返されません。</span><span class="sxs-lookup"><span data-stu-id="ac41e-175">In short, no suppliers are returned.</span></span>

<span data-ttu-id="ac41e-176">ただし、ビジターが1つの国に入力し、[サプライヤーの表示] ボタンをクリックするとポストバックが発生すると、ObjectDataSource の `Select` メソッドが再クエリされ、`country` パラメーターとして TextBox コントロールの `Text` 値が渡されます。</span><span class="sxs-lookup"><span data-stu-id="ac41e-176">Once the visitor enters in a country, however, and clicks the Show Suppliers button to cause a postback, the ObjectDataSource's `Select` method is requeried, passing in the TextBox control's `Text` value as the `country` parameter.</span></span>

<span data-ttu-id="ac41e-177">[カナダからの仕入先の ![が表示されます。](declarative-parameters-vb/_static/image26.png)](declarative-parameters-vb/_static/image25.png)</span><span class="sxs-lookup"><span data-stu-id="ac41e-177">[![Those Suppliers from Canada are Shown](declarative-parameters-vb/_static/image26.png)](declarative-parameters-vb/_static/image25.png)</span></span>

<span data-ttu-id="ac41e-178">**図 9**: カナダの仕入先が表示されます ([クリックすると、フルサイズの画像が表示](declarative-parameters-vb/_static/image27.png)されます)</span><span class="sxs-lookup"><span data-stu-id="ac41e-178">**Figure 9**: Those Suppliers from Canada are Shown ([Click to view full-size image](declarative-parameters-vb/_static/image27.png))</span></span>

## <a name="showing-all-suppliers-by-default"></a><span data-ttu-id="ac41e-179">既定ですべての仕入先を表示する</span><span class="sxs-lookup"><span data-stu-id="ac41e-179">Showing All Suppliers By Default</span></span>

<span data-ttu-id="ac41e-180">最初にページを表示したときにサプライヤーが表示されないようにするには、最初に*すべて*のサプライヤーを表示し、ユーザーがテキストボックスに国名を入力してリストを省いできるようにします。</span><span class="sxs-lookup"><span data-stu-id="ac41e-180">Rather than show none of the suppliers when first viewing the page we may want to show *all* suppliers at first, allowing the user to pare down the list by entering a country name in the TextBox.</span></span> <span data-ttu-id="ac41e-181">テキストボックスが空の場合、`SuppliersBLL` クラスの `GetSuppliersByCountry(country)` メソッドは *`country`* 入力パラメーターの `Nothing` に渡されます。</span><span class="sxs-lookup"><span data-stu-id="ac41e-181">When the TextBox is empty, the `SuppliersBLL` class's `GetSuppliersByCountry(country)` method is passed in `Nothing` for its *`country`* input parameter.</span></span> <span data-ttu-id="ac41e-182">この `Nothing` 値は、次のクエリの `@Country` パラメーターのデータベース `NULL` 値に変換される DAL の `GetSupplierByCountry(country)` メソッドに渡されます。</span><span class="sxs-lookup"><span data-stu-id="ac41e-182">This `Nothing` value is then passed down into the DAL's `GetSupplierByCountry(country)` method, where it's translated to a database `NULL` value for the `@Country` parameter in the following query:</span></span>

[!code-sql[Main](declarative-parameters-vb/samples/sample3.sql)]

<span data-ttu-id="ac41e-183">式 `Country = NULL` は、`Country` 列に `NULL` 値があるレコードに対しても常に False を返します。したがって、レコードは返されません。</span><span class="sxs-lookup"><span data-stu-id="ac41e-183">The expression `Country = NULL` always returns False, even for records whose `Country` column has a `NULL` value; therefore, no records are returned.</span></span>

<span data-ttu-id="ac41e-184">Country テキストボックスが空のときに*すべて*の業者を返すには、BLL の `GetSuppliersByCountry(country)` メソッドを拡張して、country パラメーターが `Nothing` ときに `GetSuppliers()` メソッドを呼び出し、それ以外の場合は DAL の `GetSuppliersByCountry(country)` メソッドを呼び出すことができます。</span><span class="sxs-lookup"><span data-stu-id="ac41e-184">To return *all* suppliers when the country TextBox is empty, we can augment the `GetSuppliersByCountry(country)` method in the BLL to invoke the `GetSuppliers()` method when its country parameter is `Nothing` and to call the DAL's `GetSuppliersByCountry(country)` method otherwise.</span></span> <span data-ttu-id="ac41e-185">これにより、国が指定されていない場合はすべての業者が返され、country パラメーターが含まれている場合は、サプライヤーの適切なサブセットが返されます。</span><span class="sxs-lookup"><span data-stu-id="ac41e-185">This will have the effect of returning all suppliers when no country is specified and the appropriate subset of suppliers when the country parameter is included.</span></span>

<span data-ttu-id="ac41e-186">`SuppliersBLL` クラスの `GetSuppliersByCountry(country)` メソッドを次のように変更します。</span><span class="sxs-lookup"><span data-stu-id="ac41e-186">Change the `GetSuppliersByCountry(country)` method in the `SuppliersBLL` class to the following:</span></span>

[!code-vb[Main](declarative-parameters-vb/samples/sample4.vb)]

<span data-ttu-id="ac41e-187">この変更により、[`DeclarativeParams.aspx`] ページには、最初にアクセスしたとき (または `CountryName` テキストボックスが空のとき) にすべての仕入先が表示されます。</span><span class="sxs-lookup"><span data-stu-id="ac41e-187">With this change the `DeclarativeParams.aspx` page shows all of the suppliers when first visited (or whenever the `CountryName` TextBox is empty).</span></span>

<span data-ttu-id="ac41e-188">[すべての仕入先が既定で表示されるようになりました ![](declarative-parameters-vb/_static/image29.png)](declarative-parameters-vb/_static/image28.png)</span><span class="sxs-lookup"><span data-stu-id="ac41e-188">[![All Suppliers are Now Shown by Default](declarative-parameters-vb/_static/image29.png)](declarative-parameters-vb/_static/image28.png)</span></span>

<span data-ttu-id="ac41e-189">**図 10**: すべての仕入先が既定で表示される ([クリックしてフルサイズの画像を表示する](declarative-parameters-vb/_static/image30.png))</span><span class="sxs-lookup"><span data-stu-id="ac41e-189">**Figure 10**: All Suppliers are Now Shown by Default ([Click to view full-size image](declarative-parameters-vb/_static/image30.png))</span></span>

## <a name="summary"></a><span data-ttu-id="ac41e-190">まとめ</span><span class="sxs-lookup"><span data-stu-id="ac41e-190">Summary</span></span>

<span data-ttu-id="ac41e-191">入力パラメーターでメソッドを使用するには、ObjectDataSource の `SelectParameters` コレクションのパラメーターの値を指定する必要があります。</span><span class="sxs-lookup"><span data-stu-id="ac41e-191">In order to use methods with input parameters, we need to specify the values for the parameters in the ObjectDataSource's `SelectParameters` collection.</span></span> <span data-ttu-id="ac41e-192">パラメーターの種類によって、さまざまなソースからパラメーター値を取得できます。</span><span class="sxs-lookup"><span data-stu-id="ac41e-192">Different types of parameters allow for the parameter value to be obtained from different sources.</span></span> <span data-ttu-id="ac41e-193">既定のパラメーターの型はハードコーディングされた値を使用しますが、単純に (コード行を含めずに) パラメーター値をクエリ文字列、セッション変数、cookie から取得することも、ページ上の Web コントロールからユーザーが入力した値から取得することもできます。</span><span class="sxs-lookup"><span data-stu-id="ac41e-193">The default parameter type uses a hard-coded value, but just as easily (and without a line of code) parameter values can be obtained from the querystring, Session variables, cookies, and even user-entered values from Web controls on the page.</span></span>

<span data-ttu-id="ac41e-194">このチュートリアルで見た例では、宣言型パラメーター値の使用方法を説明しました。</span><span class="sxs-lookup"><span data-stu-id="ac41e-194">The examples we looked at in this tutorial illustrated how to use declarative parameter values.</span></span> <span data-ttu-id="ac41e-195">ただし、現在の日付と時刻など、利用できないパラメーターソースを使用する必要がある場合や、サイトでメンバーシップを使用している場合は、ビジターのユーザー ID を使用することがあります。</span><span class="sxs-lookup"><span data-stu-id="ac41e-195">However, there may be times when we need to use a parameter source that's not available, such as the current date and time, or, if our site was using Membership, the User ID of the visitor.</span></span> <span data-ttu-id="ac41e-196">このようなシナリオでは、ObjectDataSource の前にプログラムによってパラメーター値を設定して、基になるオブジェクトのメソッドを呼び出すことができます。</span><span class="sxs-lookup"><span data-stu-id="ac41e-196">For such scenarios we can set the parameter values programmatically prior to the ObjectDataSource invoking its underlying object's method.</span></span> <span data-ttu-id="ac41e-197">これを実現する方法については、[次のチュートリアル](programmatically-setting-the-objectdatasource-s-parameter-values-vb.md)で説明します。</span><span class="sxs-lookup"><span data-stu-id="ac41e-197">We'll see how to accomplish this in the [next tutorial](programmatically-setting-the-objectdatasource-s-parameter-values-vb.md).</span></span>

<span data-ttu-id="ac41e-198">プログラミングを楽しんでください。</span><span class="sxs-lookup"><span data-stu-id="ac41e-198">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="ac41e-199">著者について</span><span class="sxs-lookup"><span data-stu-id="ac41e-199">About the Author</span></span>

<span data-ttu-id="ac41e-200">1998以来、 [Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml)は 7 asp/創設者 of [4GuysFromRolla.com](http://www.4guysfromrolla.com)の執筆者であり、Microsoft Web テクノロジを使用しています。</span><span class="sxs-lookup"><span data-stu-id="ac41e-200">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="ac41e-201">Scott は、独立したコンサルタント、トレーナー、およびライターとして機能します。</span><span class="sxs-lookup"><span data-stu-id="ac41e-201">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="ac41e-202">彼の最新の書籍は[ *、ASP.NET 2.0 を24時間以内に教え*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)ています。</span><span class="sxs-lookup"><span data-stu-id="ac41e-202">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="ac41e-203">mitchell@4GuysFromRolla.comでアクセスでき[ます。](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="ac41e-203">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="ac41e-204">または彼のブログを参照してください。これは[http://ScottOnWriting.NET](http://ScottOnWriting.NET)にあります。</span><span class="sxs-lookup"><span data-stu-id="ac41e-204">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="ac41e-205">ありがとうございました。</span><span class="sxs-lookup"><span data-stu-id="ac41e-205">Special Thanks To</span></span>

<span data-ttu-id="ac41e-206">このチュートリアルシリーズは、役に立つ多くのレビュー担当者によってレビューされました。</span><span class="sxs-lookup"><span data-stu-id="ac41e-206">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="ac41e-207">このチュートリアルのリードレビュー担当者は、Hilton Giesenow でした。</span><span class="sxs-lookup"><span data-stu-id="ac41e-207">Lead reviewer for this tutorial was Hilton Giesenow.</span></span> <span data-ttu-id="ac41e-208">今後の MSDN 記事を確認することに興味がありますか?</span><span class="sxs-lookup"><span data-stu-id="ac41e-208">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="ac41e-209">その場合は、mitchell@4GuysFromRolla.comの行を削除[します。](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="ac41e-209">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="ac41e-210">[前へ](displaying-data-with-the-objectdatasource-vb.md)
> [次へ](programmatically-setting-the-objectdatasource-s-parameter-values-vb.md)</span><span class="sxs-lookup"><span data-stu-id="ac41e-210">[Previous](displaying-data-with-the-objectdatasource-vb.md)
[Next](programmatically-setting-the-objectdatasource-s-parameter-values-vb.md)</span></span>

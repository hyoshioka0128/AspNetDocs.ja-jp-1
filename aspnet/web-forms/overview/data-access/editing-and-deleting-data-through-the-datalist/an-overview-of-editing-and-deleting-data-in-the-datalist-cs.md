---
uid: web-forms/overview/data-access/editing-and-deleting-data-through-the-datalist/an-overview-of-editing-and-deleting-data-in-the-datalist-cs
title: (C#)、DataList でデータ編集と削除の概要 |Microsoft Docs
author: rick-anderson
description: DataList は、組み込みの編集と削除機能がない、中にこのチュートリアルでは方法について説明します、DataList の編集および削除の o をサポートするを作成する.
ms.author: riande
ms.date: 10/30/2006
ms.assetid: c3b0c86e-fe98-41ee-b26f-ca38cddaa75e
msc.legacyurl: /web-forms/overview/data-access/editing-and-deleting-data-through-the-datalist/an-overview-of-editing-and-deleting-data-in-the-datalist-cs
msc.type: authoredcontent
ms.openlocfilehash: a1ea830bc2fe5a88bc80416375e7bfd7959b667e
ms.sourcegitcommit: 51b01b6ff8edde57d8243e4da28c9f1e7f1962b2
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 05/06/2019
ms.locfileid: "65108374"
---
# <a name="an-overview-of-editing-and-deleting-data-in-the-datalist-c"></a><span data-ttu-id="8646b-103">(C#)、DataList でデータ編集と削除の概要</span><span class="sxs-lookup"><span data-stu-id="8646b-103">An Overview of Editing and Deleting Data in the DataList (C#)</span></span>

<span data-ttu-id="8646b-104">によって[Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="8646b-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="8646b-105">[サンプル アプリをダウンロード](http://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_36_CS.exe)または[PDF のダウンロード](an-overview-of-editing-and-deleting-data-in-the-datalist-cs/_static/datatutorial36cs1.pdf)</span><span class="sxs-lookup"><span data-stu-id="8646b-105">[Download Sample App](http://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_36_CS.exe) or [Download PDF](an-overview-of-editing-and-deleting-data-in-the-datalist-cs/_static/datatutorial36cs1.pdf)</span></span>

> <span data-ttu-id="8646b-106">DataList は、組み込みの編集と削除機能がない、中にこのチュートリアルでは方法について説明します編集およびその基になるデータの削除をサポートする DataList を作成します。</span><span class="sxs-lookup"><span data-stu-id="8646b-106">While the DataList lacks built-in editing and deleting capabilities, in this tutorial we'll see how to create a DataList that supports editing and deleting of its underlying data.</span></span>

## <a name="introduction"></a><span data-ttu-id="8646b-107">はじめに</span><span class="sxs-lookup"><span data-stu-id="8646b-107">Introduction</span></span>

<span data-ttu-id="8646b-108">[挿入の概要、更新、およびデータの削除](../editing-inserting-and-deleting-data/an-overview-of-inserting-updating-and-deleting-data-cs.md)チュートリアルの挿入、更新、およびアプリケーション アーキテクチャ、ObjectDataSource、および GridView、DetailsView と FormView を使用してデータを削除する方法を説明しましたコントロール。</span><span class="sxs-lookup"><span data-stu-id="8646b-108">In the [An Overview of Inserting, Updating, and Deleting Data](../editing-inserting-and-deleting-data/an-overview-of-inserting-updating-and-deleting-data-cs.md) tutorial we looked at how to insert, update, and delete data using the application architecture, an ObjectDataSource, and the GridView, DetailsView, and FormView controls.</span></span> <span data-ttu-id="8646b-109">ObjectDataSource とこれらの 3 つのデータ Web コントロールでは、単純なデータ変更インターフェイスを実装する、スナップイン、関係だけで、スマート タグからチェック ボックスをオンに時間を刻みします。</span><span class="sxs-lookup"><span data-stu-id="8646b-109">With the ObjectDataSource and these three data Web controls, implementing simple data modification interfaces was a snap and involved merely ticking a checkbox from a smart tag.</span></span> <span data-ttu-id="8646b-110">コードを記述する必要はありません。</span><span class="sxs-lookup"><span data-stu-id="8646b-110">No code needed to be written.</span></span>

<span data-ttu-id="8646b-111">残念ながら、DataList では、組み込みの編集および削除の GridView コントロールに固有の機能が不足しています。</span><span class="sxs-lookup"><span data-stu-id="8646b-111">Unfortunately, the DataList lacks the built-in editing and deleting capabilities inherent in the GridView control.</span></span> <span data-ttu-id="8646b-112">不足しているこの機能は、DataList は、宣言型のデータ ソース コントロールとコードのないデータの変更ページは使用できなかったときに、ASP.NET の以前のバージョンからの relic をファクトの一部が原因です。</span><span class="sxs-lookup"><span data-stu-id="8646b-112">This missing functionality is due in part to the fact that the DataList is a relic from the previous version of ASP.NET, when declarative data source controls and code-free data modification pages were unavailable.</span></span> <span data-ttu-id="8646b-113">DataList ASP.NET 2.0 では提供されませんすぐ同じデータ変更機能として、GridView、中にこのような機能を含める ASP.NET 1.x の手法を使用できます。</span><span class="sxs-lookup"><span data-stu-id="8646b-113">While the DataList in ASP.NET 2.0 does not offer the same out of the box data modification capabilities as the GridView, we can use ASP.NET 1.x techniques to include such functionality.</span></span> <span data-ttu-id="8646b-114">このアプローチのコードが必要ですが、このチュートリアルでは表示されるよう、DataList いくつかのイベントおよびプロパティでこのプロセスを支援する場所です。</span><span class="sxs-lookup"><span data-stu-id="8646b-114">This approach requires a bit of code but, as we'll see in this tutorial, the DataList has some events and properties in place to aid in this process.</span></span>

<span data-ttu-id="8646b-115">このチュートリアルでは、編集、およびその基になるデータの削除をサポートする DataList を作成する方法がわかります。</span><span class="sxs-lookup"><span data-stu-id="8646b-115">In this tutorial we'll see how to create a DataList that supports editing and deleting of its underlying data.</span></span> <span data-ttu-id="8646b-116">今後のチュートリアルより高度な編集しシナリオを削除する、入力フィールドの検証を含む、データ アクセスまたはビジネス ロジック層、およびなどから発生した例外を適切に処理を説明します。</span><span class="sxs-lookup"><span data-stu-id="8646b-116">Future tutorials will examine more advanced editing and deleting scenarios, including input field validation, gracefully handling exceptions raised from the Data Access or Business Logic Layers, and so on.</span></span>

> [!NOTE]
> <span data-ttu-id="8646b-117">など、DataList、Repeater コントロールには、帯の挿入、更新、または削除する機能が不足しています。</span><span class="sxs-lookup"><span data-stu-id="8646b-117">Like the DataList, the Repeater control lacks the out of the box functionality for inserting, updating, or deleting.</span></span> <span data-ttu-id="8646b-118">このような機能を追加することができます、DataList には、プロパティおよび Repeater に見つかりませんでしたを簡単にこのような機能を追加するイベントが含まれます。</span><span class="sxs-lookup"><span data-stu-id="8646b-118">While such functionality can be added, the DataList includes properties and events not found in the Repeater that simplify adding such capabilities.</span></span> <span data-ttu-id="8646b-119">そのため、このチュートリアルと将来的に編集および削除が確認されるは、DataList に厳密に集中します。</span><span class="sxs-lookup"><span data-stu-id="8646b-119">Therefore, this tutorial and future ones that look at editing and deleting will focus strictly on the DataList.</span></span>

## <a name="step-1-creating-the-editing-and-deleting-tutorials-web-pages"></a><span data-ttu-id="8646b-120">手順 1: 編集および削除のチュートリアルの Web ページを作成します。</span><span class="sxs-lookup"><span data-stu-id="8646b-120">Step 1: Creating the Editing and Deleting Tutorials Web Pages</span></span>

<span data-ttu-id="8646b-121">更新および DataList からデータを削除する方法の調査を始める前に、このチュートリアルの次のいくつかの必要がありますが、web サイト プロジェクトで ASP.NET ページを作成する最初に少し s を使用できます。</span><span class="sxs-lookup"><span data-stu-id="8646b-121">Before we start exploring how to update and delete data from a DataList, let s first take a moment to create the ASP.NET pages in our website project that we'll need for this tutorial and the next several ones.</span></span> <span data-ttu-id="8646b-122">という名前の新しいフォルダーを追加することで開始`EditDeleteDataList`します。</span><span class="sxs-lookup"><span data-stu-id="8646b-122">Start by adding a new folder named `EditDeleteDataList`.</span></span> <span data-ttu-id="8646b-123">次に、次の ASP.NET ページを使用する各ページに関連付けることを確認、そのフォルダーに追加、`Site.master`マスター ページ。</span><span class="sxs-lookup"><span data-stu-id="8646b-123">Next, add the following ASP.NET pages to that folder, making sure to associate each page with the `Site.master` master page:</span></span>

- `Default.aspx`
- `Basics.aspx`
- `BatchUpdate.aspx`
- `ErrorHandling.aspx`
- `UIValidation.aspx`
- `CustomizedUI.aspx`
- `OptimisticConcurrency.aspx`
- `ConfirmationOnDelete.aspx`
- `UserLevelAccess.aspx`

![チュートリアルについては、ASP.NET ページに追加します。](an-overview-of-editing-and-deleting-data-in-the-datalist-cs/_static/image1.png)

<span data-ttu-id="8646b-125">**図 1**:チュートリアルについては、ASP.NET ページに追加します。</span><span class="sxs-lookup"><span data-stu-id="8646b-125">**Figure 1**: Add the ASP.NET Pages for the Tutorials</span></span>

<span data-ttu-id="8646b-126">などの他のフォルダーで`Default.aspx`で、`EditDeleteDataList`フォルダーは、そのセクションでは、チュートリアルを一覧表示されます。</span><span class="sxs-lookup"><span data-stu-id="8646b-126">Like in the other folders, `Default.aspx` in the `EditDeleteDataList` folder lists the tutorials in its section.</span></span> <span data-ttu-id="8646b-127">いることを思い出してください、`SectionLevelTutorialListing.ascx`ユーザー コントロールは、この機能を提供します。</span><span class="sxs-lookup"><span data-stu-id="8646b-127">Recall that the `SectionLevelTutorialListing.ascx` User Control provides this functionality.</span></span> <span data-ttu-id="8646b-128">そのため、このユーザー コントロールを追加`Default.aspx`をページのデザイン ビューに ソリューション エクスプ ローラーからドラッグしています。</span><span class="sxs-lookup"><span data-stu-id="8646b-128">Therefore, add this User Control to `Default.aspx` by dragging it from the Solution Explorer onto the page s Design view.</span></span>

<span data-ttu-id="8646b-129">[![Default.aspx に SectionLevelTutorialListing.ascx ユーザー コントロールを追加します。](an-overview-of-editing-and-deleting-data-in-the-datalist-cs/_static/image3.png)](an-overview-of-editing-and-deleting-data-in-the-datalist-cs/_static/image2.png)</span><span class="sxs-lookup"><span data-stu-id="8646b-129">[![Add the SectionLevelTutorialListing.ascx User Control to Default.aspx](an-overview-of-editing-and-deleting-data-in-the-datalist-cs/_static/image3.png)](an-overview-of-editing-and-deleting-data-in-the-datalist-cs/_static/image2.png)</span></span>

<span data-ttu-id="8646b-130">**図 2**:追加、`SectionLevelTutorialListing.ascx`ユーザー コントロールを`Default.aspx`([フルサイズの画像を表示する をクリックします](an-overview-of-editing-and-deleting-data-in-the-datalist-cs/_static/image4.png))。</span><span class="sxs-lookup"><span data-stu-id="8646b-130">**Figure 2**: Add the `SectionLevelTutorialListing.ascx` User Control to `Default.aspx` ([Click to view full-size image](an-overview-of-editing-and-deleting-data-in-the-datalist-cs/_static/image4.png))</span></span>

<span data-ttu-id="8646b-131">最後に、ページに追加するエントリとして、`Web.sitemap`ファイル。</span><span class="sxs-lookup"><span data-stu-id="8646b-131">Lastly, add the pages as entries to the `Web.sitemap` file.</span></span> <span data-ttu-id="8646b-132">具体的には、DataList と Repeater によるマスター/詳細レポートの後に、次のマークアップを追加`<siteMapNode>`:</span><span class="sxs-lookup"><span data-stu-id="8646b-132">Specifically, add the following markup after the Master/Detail Reports with the DataList and Repeater `<siteMapNode>`:</span></span>

[!code-xml[Main](an-overview-of-editing-and-deleting-data-in-the-datalist-cs/samples/sample1.xml)]

<span data-ttu-id="8646b-133">更新した後`Web.sitemap`、時間、ブラウザーを使ってチュートリアル web サイトを表示するのにはかかりません。</span><span class="sxs-lookup"><span data-stu-id="8646b-133">After updating `Web.sitemap`, take a moment to view the tutorials website through a browser.</span></span> <span data-ttu-id="8646b-134">左側のメニューで、DataList の編集および削除のチュートリアルの項目できるようになりました。</span><span class="sxs-lookup"><span data-stu-id="8646b-134">The menu on the left now includes items for the DataList editing and deleting tutorials.</span></span>

![サイト マップ DataList の編集および削除のチュートリアルのエントリになりました](an-overview-of-editing-and-deleting-data-in-the-datalist-cs/_static/image5.png)

<span data-ttu-id="8646b-136">**図 3**:サイト マップ DataList の編集および削除のチュートリアルのエントリになりました</span><span class="sxs-lookup"><span data-stu-id="8646b-136">**Figure 3**: The Site Map Now Includes Entries for the DataList Editing and Deleting Tutorials</span></span>

## <a name="step-2-examining-techniques-for-updating-and-deleting-data"></a><span data-ttu-id="8646b-137">手順 2: データ更新および削除の手法を調べる</span><span class="sxs-lookup"><span data-stu-id="8646b-137">Step 2: Examining Techniques for Updating and Deleting Data</span></span>

<span data-ttu-id="8646b-138">GridView でのデータ編集と削除は、GridView と ObjectDataSource が連携しての作業に実際には、下にあるため、非常に簡単です。</span><span class="sxs-lookup"><span data-stu-id="8646b-138">Editing and deleting data with the GridView is so easy because, underneath the covers, the GridView and ObjectDataSource work in concert.</span></span> <span data-ttu-id="8646b-139">説明したように、 [、イベントに関連付けられている挿入、更新、および削除の確認](../editing-inserting-and-deleting-data/examining-the-events-associated-with-inserting-updating-and-deleting-cs.md)チュートリアルでは、行の更新 ボタンがクリックされたときに、GridView を自動的に割り当てます、への双方向データバインドを使用するフィールド`UpdateParameters` 、ObjectDataSource のコレクションと ObjectDataSource s が呼び出され、`Update()`メソッド。</span><span class="sxs-lookup"><span data-stu-id="8646b-139">As discussed in the [Examining the Events Associated with Inserting, Updating, and Deleting](../editing-inserting-and-deleting-data/examining-the-events-associated-with-inserting-updating-and-deleting-cs.md) tutorial, when a row s Update button is clicked, the GridView automatically assigns its fields that used two-way databinding to the `UpdateParameters` collection of its ObjectDataSource and then invokes that ObjectDataSource s `Update()` method.</span></span>

<span data-ttu-id="8646b-140">残念ながら、DataList では、この組み込み機能のいずれか用意されていません。</span><span class="sxs-lookup"><span data-stu-id="8646b-140">Sadly, the DataList does not provide any of this built-in functionality.</span></span> <span data-ttu-id="8646b-141">ObjectDataSource のパラメーターに、ユーザーの値が割り当てられていることを確認する必要がありますはその`Update()`メソッドが呼び出されます。</span><span class="sxs-lookup"><span data-stu-id="8646b-141">It is our responsibility to ensure that the user s values are assigned to the ObjectDataSource s parameters and that its `Update()` method is called.</span></span> <span data-ttu-id="8646b-142">この努力ご支援、するためには、DataList は、次のプロパティとイベントを提供します。</span><span class="sxs-lookup"><span data-stu-id="8646b-142">To aid us in this endeavor, the DataList provides the following properties and events:</span></span>

- <span data-ttu-id="8646b-143">**[ `DataKeyField`プロパティ](https://msdn.microsoft.com/library/system.web.ui.webcontrols.basedatalist.datakeyfield.aspx)** 更新や削除、DataList 内の各項目を一意に識別できる必要があります。</span><span class="sxs-lookup"><span data-stu-id="8646b-143">**The [`DataKeyField` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.basedatalist.datakeyfield.aspx)** when updating or deleting, we need to be able to uniquely identify each item in the DataList.</span></span> <span data-ttu-id="8646b-144">このプロパティは、表示されるデータの主キー フィールドを設定します。</span><span class="sxs-lookup"><span data-stu-id="8646b-144">Set this property to the primary key field of the displayed data.</span></span> <span data-ttu-id="8646b-145">そうは、DataList s [ `DataKeys`コレクション](https://msdn.microsoft.com/library/system.web.ui.webcontrols.basedatalist.datakeys.aspx)、指定した`DataKeyField`各 DataList 項目の値。</span><span class="sxs-lookup"><span data-stu-id="8646b-145">Doing so will populate the DataList s [`DataKeys` collection](https://msdn.microsoft.com/library/system.web.ui.webcontrols.basedatalist.datakeys.aspx) with the specified `DataKeyField` value for each DataList item.</span></span>
- <span data-ttu-id="8646b-146">**[ `EditCommand`イベント](https://msdn.microsoft.com/library/system.web.ui.webcontrols.datalist.editcommand.aspx)** ボタン、LinkButton、ImageButton またはときに発生が`CommandName`プロパティが編集がクリックされました。</span><span class="sxs-lookup"><span data-stu-id="8646b-146">**The [`EditCommand` event](https://msdn.microsoft.com/library/system.web.ui.webcontrols.datalist.editcommand.aspx)** fires when a Button, LinkButton, or ImageButton whose `CommandName` property is set to Edit is clicked.</span></span>
- <span data-ttu-id="8646b-147">**[ `CancelCommand`イベント](https://msdn.microsoft.com/library/system.web.ui.webcontrols.datalist.cancelcommand.aspx)** ボタン、LinkButton、ImageButton またはときに発生が`CommandName`プロパティが [キャンセル] をクリックします。</span><span class="sxs-lookup"><span data-stu-id="8646b-147">**The [`CancelCommand` event](https://msdn.microsoft.com/library/system.web.ui.webcontrols.datalist.cancelcommand.aspx)** fires when a Button, LinkButton, or ImageButton whose `CommandName` property is set to Cancel is clicked.</span></span>
- <span data-ttu-id="8646b-148">**[ `UpdateCommand`イベント](https://msdn.microsoft.com/library/system.web.ui.webcontrols.datalist.updatecommand.aspx)** ボタン、LinkButton、ImageButton またはときに発生が`CommandName`プロパティが更新プログラムをクリックします。</span><span class="sxs-lookup"><span data-stu-id="8646b-148">**The [`UpdateCommand` event](https://msdn.microsoft.com/library/system.web.ui.webcontrols.datalist.updatecommand.aspx)** fires when a Button, LinkButton, or ImageButton whose `CommandName` property is set to Update is clicked.</span></span>
- <span data-ttu-id="8646b-149">**[ `DeleteCommand`イベント](https://msdn.microsoft.com/library/system.web.ui.webcontrols.datalist.deletecommand.aspx)** ボタン、LinkButton、ImageButton またはときに発生が`CommandName`プロパティに設定されて削除をクリックします。</span><span class="sxs-lookup"><span data-stu-id="8646b-149">**The [`DeleteCommand` event](https://msdn.microsoft.com/library/system.web.ui.webcontrols.datalist.deletecommand.aspx)** fires when a Button, LinkButton, or ImageButton whose `CommandName` property is set to Delete is clicked.</span></span>

<span data-ttu-id="8646b-150">更新および DataList からデータを削除に使用できます 4 つのアプローチはこれらのプロパティとイベントを使用して、あります。</span><span class="sxs-lookup"><span data-stu-id="8646b-150">Using these properties and events, there are four approaches we can use to update and delete data from the DataList:</span></span>

1. <span data-ttu-id="8646b-151">**ASP.NET 1.x の手法を使用して**DataList は、ASP.NET 2.0 と ObjectDataSources の前に存在し、プログラムによる方法ですべてのデータ更新および削除することができます。</span><span class="sxs-lookup"><span data-stu-id="8646b-151">**Using ASP.NET 1.x Techniques** the DataList existed prior to ASP.NET 2.0 and ObjectDataSources and was able to update and delete data entirely through programmatic means.</span></span> <span data-ttu-id="8646b-152">この方法は、ObjectDataSource をまったく ditches され、両方を表示するデータの取得中にビジネス ロジック層から直接、DataList にデータをバインドしますが必要ですし、更新、またはレコードを削除するときにします。</span><span class="sxs-lookup"><span data-stu-id="8646b-152">This technique ditches the ObjectDataSource altogether and requires that we bind the data to the DataList directly from the Business Logic Layer, both in retrieving the data to display and when updating or deleting a record.</span></span>
2. <span data-ttu-id="8646b-153">**ページ上の 1 つの ObjectDataSource コントロールを選択すると、更新、および削除するを使用して**DataList は、GridView s 本質的な編集と削除機能がない、中にある s t できる理由なしに追加自分たちでします。</span><span class="sxs-lookup"><span data-stu-id="8646b-153">**Using a Single ObjectDataSource Control on the Page for Selecting, Updating, and Deleting** while the DataList lacks the GridView s inherent editing and deleting capabilities, there s no reason we can t add them in ourselves.</span></span> <span data-ttu-id="8646b-154">この方法で使用します、ObjectDataSource と同じように、GridView の例でが DataList s のイベント ハンドラーを作成する必要があります`UpdateCommand`イベント、ObjectDataSource のパラメーターと呼び出しを設定します、`Update()`メソッド。</span><span class="sxs-lookup"><span data-stu-id="8646b-154">With this approach, we use an ObjectDataSource just like in the GridView examples, but must create an event handler for the DataList s `UpdateCommand` event where we set the ObjectDataSource s parameters and call its `Update()` method.</span></span>
3. <span data-ttu-id="8646b-155">**ObjectDataSource コントロールを使用して、選択するが、更新および削除する直接に対して、BLL**オプション 2 を使用する場合にコードを少し記述する必要があります、`UpdateCommand`などのパラメーター値の割り当てイベント。</span><span class="sxs-lookup"><span data-stu-id="8646b-155">**Using an ObjectDataSource Control for Selecting, but Updating and Deleting Directly Against the BLL** when using option 2, we need to write a bit of code in the `UpdateCommand` event, assigning parameter values and so on.</span></span> <span data-ttu-id="8646b-156">代わりを選択すると、ObjectDataSource を使用していますが、BLL (など、1 をオプションと共に使用) に対して直接更新および削除の呼び出しを行います。</span><span class="sxs-lookup"><span data-stu-id="8646b-156">Instead, we can stick with using the ObjectDataSource for selecting, but make the updating and deleting calls directly against the BLL (like with option 1).</span></span> <span data-ttu-id="8646b-157">個人的な意見で BLL と直接連動してデータの更新 ObjectDataSource s を割り当てるよりも読みやすいコードに潜在顧客`UpdateParameters`呼び出しとその`Update()`メソッド。</span><span class="sxs-lookup"><span data-stu-id="8646b-157">In my opinion, updating data by interfacing directly with the BLL leads to more readable code than assigning the ObjectDataSource s `UpdateParameters` and calling its `Update()` method.</span></span>
4. <span data-ttu-id="8646b-158">**宣言型の複数の ObjectDataSources 手段を使用して**すべて前の 3 つのアプローチのコードを必要とします。</span><span class="sxs-lookup"><span data-stu-id="8646b-158">**Using Declarative Means through Multiple ObjectDataSources** the previous three approaches all require a bit of code.</span></span> <span data-ttu-id="8646b-159">D ではなく引き続き使用する限りはるか宣言の構文として、最後のオプションでは、ページ上の複数の ObjectDataSources を含めるは。</span><span class="sxs-lookup"><span data-stu-id="8646b-159">If you d rather keep using as much declarative syntax as possible, a final option is to include multiple ObjectDataSources on the page.</span></span> <span data-ttu-id="8646b-160">最初の ObjectDataSource では、BLL からデータを取得し、DataList にバインドされます。</span><span class="sxs-lookup"><span data-stu-id="8646b-160">The first ObjectDataSource retrieves the data from the BLL and binds it to the DataList.</span></span> <span data-ttu-id="8646b-161">別の ObjectDataSource を追加するが DataList s 内に直接追加更新、`EditItemTemplate`します。</span><span class="sxs-lookup"><span data-stu-id="8646b-161">For updating, another ObjectDataSource is added, but added directly within the DataList s `EditItemTemplate`.</span></span> <span data-ttu-id="8646b-162">サポートの削除は、まだ別の ObjectDataSource が必要で、`ItemTemplate`します。</span><span class="sxs-lookup"><span data-stu-id="8646b-162">To include deleting support, yet another ObjectDataSource would be needed in the `ItemTemplate`.</span></span> <span data-ttu-id="8646b-163">この方法により、これらの埋め込まれた ObjectDataSource の使用`ControlParameters`宣言によって、ObjectDataSource のパラメーターをユーザー入力コントロールにバインドする (s DataList でプログラムで指定する必要はなく`UpdateCommand`イベント ハンドラー)。</span><span class="sxs-lookup"><span data-stu-id="8646b-163">With this approach, these embedded ObjectDataSource s use `ControlParameters` to declaratively bind the ObjectDataSource s parameters to the user input controls (rather than having to specify them programmatically in the DataList s `UpdateCommand` event handler).</span></span> <span data-ttu-id="8646b-164">この方法は、少量のコードを埋め込み、ObjectDataSource s を呼び出す必要がありますも必要があります。`Update()`または`Delete()`、他の 3 つのアプローチより小さいコマンドははるかにが必要です。</span><span class="sxs-lookup"><span data-stu-id="8646b-164">This approach still requires a bit of code we need to call the embedded ObjectDataSource s `Update()` or `Delete()` command but requires far less than with the other three approaches.</span></span> <span data-ttu-id="8646b-165">ここでの弱点は、こと複数 ObjectDataSources は乱雑にし、ページ全体の読みやすさからそれてです。</span><span class="sxs-lookup"><span data-stu-id="8646b-165">The downside here is that the multiple ObjectDataSources do clutter up the page, detracting from the overall readability.</span></span>

<span data-ttu-id="8646b-166">強制しかこれらの方法のいずれかを使用する場合、このパターンに対応に設計された、DataList、最大限の柔軟性を提供するためオプション 1 d は選択します。</span><span class="sxs-lookup"><span data-stu-id="8646b-166">If forced to only ever use one of these approaches, I d choose option 1 because it provides the most flexibility and because the DataList was originally designed to accommodate this pattern.</span></span> <span data-ttu-id="8646b-167">DataList は、ASP.NET 2.0 のデータ ソース コントロールを使用する拡張された、すべての機能拡張ポイントや公式の ASP.NET 2.0 データ Web コントロール (GridView、DetailsView、およびフォーム ビュー) の機能にはありません。</span><span class="sxs-lookup"><span data-stu-id="8646b-167">While the DataList was extended to work with the ASP.NET 2.0 data source controls, it does not have all of the extensibility points or features of the official ASP.NET 2.0 data Web controls (the GridView, DetailsView, and FormView).</span></span> <span data-ttu-id="8646b-168">オプション 2 ~ 4 が merit、なしです。</span><span class="sxs-lookup"><span data-stu-id="8646b-168">Options 2 through 4 are not without merit, though.</span></span>

<span data-ttu-id="8646b-169">これと、将来の編集とチュートリアルを削除するが使用 ObjectDataSource データを取得するを表示し、データ (オプション 3) 更新および削除する BLL に呼び出しを転送します。</span><span class="sxs-lookup"><span data-stu-id="8646b-169">This and the future editing and deleting tutorials will use an ObjectDataSource for retrieving the data to display and direct calls to the BLL to update and delete data (option 3).</span></span>

## <a name="step-3-adding-the-datalist-and-configuring-its-objectdatasource"></a><span data-ttu-id="8646b-170">手順 3: DataList を追加して、ObjectDataSource を構成します。</span><span class="sxs-lookup"><span data-stu-id="8646b-170">Step 3: Adding the DataList and Configuring its ObjectDataSource</span></span>

<span data-ttu-id="8646b-171">このチュートリアルでは、製品情報一覧が表示され、各製品の機能を提供、ユーザー名と価格を編集し、製品をすべて削除する DataList を作成します。</span><span class="sxs-lookup"><span data-stu-id="8646b-171">In this tutorial we will create a DataList that lists product information and, for each product, provides the user the ability to edit the name and price and to delete the product altogether.</span></span> <span data-ttu-id="8646b-172">具体的には、ObjectDataSource を使用して表示するレコードを取得、更新を実行がおよび BLL と直接連動して削除操作がいます。</span><span class="sxs-lookup"><span data-stu-id="8646b-172">In particular, we will retrieve the records to display using an ObjectDataSource, but perform the update and delete actions by interfacing directly with the BLL.</span></span> <span data-ttu-id="8646b-173">DataList の編集と削除の機能を実装する心配し、前に読み取り専用のインターフェイスで、製品を表示するページをまず取得 s を使用できます。</span><span class="sxs-lookup"><span data-stu-id="8646b-173">Before we worry about implementing the editing and deleting capabilities to the DataList, let s first get the page to display the products in a read-only interface.</span></span> <span data-ttu-id="8646b-174">経過 ve は次の手順を調べる前のチュートリアルでは、次に、これを簡単にします。</span><span class="sxs-lookup"><span data-stu-id="8646b-174">Since we ve examined these steps in previous tutorials, I'll proceed through them quickly.</span></span>

<span data-ttu-id="8646b-175">開いて開始、`Basics.aspx`ページで、`EditDeleteDataList`フォルダーと、デザイン ビューでは、DataList をページに追加します。</span><span class="sxs-lookup"><span data-stu-id="8646b-175">Start by opening the `Basics.aspx` page in the `EditDeleteDataList` folder and, from the Design view, add a DataList to the page.</span></span> <span data-ttu-id="8646b-176">次に、DataList s のスマート タグから新しい ObjectDataSource を作成します。</span><span class="sxs-lookup"><span data-stu-id="8646b-176">Next, from the DataList s smart tag, create a new ObjectDataSource.</span></span> <span data-ttu-id="8646b-177">製品データを使用して、構成を使用するよう、`ProductsBLL`クラス。</span><span class="sxs-lookup"><span data-stu-id="8646b-177">Since we are working with product data, configure it to use the `ProductsBLL` class.</span></span> <span data-ttu-id="8646b-178">取得する*すべて*、製品の選択、`GetProducts()`メソッドで、[選択] タブ。</span><span class="sxs-lookup"><span data-stu-id="8646b-178">To retrieve *all* products, choose the `GetProducts()` method in the SELECT tab.</span></span>

<span data-ttu-id="8646b-179">[![ProductsBLL クラスを使用する ObjectDataSource を構成します。](an-overview-of-editing-and-deleting-data-in-the-datalist-cs/_static/image7.png)](an-overview-of-editing-and-deleting-data-in-the-datalist-cs/_static/image6.png)</span><span class="sxs-lookup"><span data-stu-id="8646b-179">[![Configure the ObjectDataSource to Use the ProductsBLL Class](an-overview-of-editing-and-deleting-data-in-the-datalist-cs/_static/image7.png)](an-overview-of-editing-and-deleting-data-in-the-datalist-cs/_static/image6.png)</span></span>

<span data-ttu-id="8646b-180">**図 4**:構成に使用する ObjectDataSource、`ProductsBLL`クラス ([フルサイズの画像を表示する をクリックします](an-overview-of-editing-and-deleting-data-in-the-datalist-cs/_static/image8.png))。</span><span class="sxs-lookup"><span data-stu-id="8646b-180">**Figure 4**: Configure the ObjectDataSource to Use the `ProductsBLL` Class ([Click to view full-size image](an-overview-of-editing-and-deleting-data-in-the-datalist-cs/_static/image8.png))</span></span>

<span data-ttu-id="8646b-181">[![GetProducts() メソッドを使用して、製品情報を返す](an-overview-of-editing-and-deleting-data-in-the-datalist-cs/_static/image10.png)](an-overview-of-editing-and-deleting-data-in-the-datalist-cs/_static/image9.png)</span><span class="sxs-lookup"><span data-stu-id="8646b-181">[![Return the Product Information Using the GetProducts() Method](an-overview-of-editing-and-deleting-data-in-the-datalist-cs/_static/image10.png)](an-overview-of-editing-and-deleting-data-in-the-datalist-cs/_static/image9.png)</span></span>

<span data-ttu-id="8646b-182">**図 5**:使用して、製品情報を返す、`GetProducts()`メソッド ([フルサイズの画像を表示する をクリックします](an-overview-of-editing-and-deleting-data-in-the-datalist-cs/_static/image11.png))。</span><span class="sxs-lookup"><span data-stu-id="8646b-182">**Figure 5**: Return the Product Information Using the `GetProducts()` Method ([Click to view full-size image](an-overview-of-editing-and-deleting-data-in-the-datalist-cs/_static/image11.png))</span></span>

<span data-ttu-id="8646b-183">など、GridView、DataList はいない新しいデータを挿入するために設計されていますこのため、挿入 タブで、ドロップダウン リストからオプション (なし)。(なし) の UPDATE および DELETE の各タブのため、更新および削除は、BLL を介してプログラムで実行されます。</span><span class="sxs-lookup"><span data-stu-id="8646b-183">The DataList, like the GridView, is not designed for inserting new data; therefore, select the (None) option from the drop-down list in the INSERT tab. Also choose (None) for the UPDATE and DELETE tabs since the updates and deletes will be performed programmatically through the BLL.</span></span>

<span data-ttu-id="8646b-184">[![ObjectDataSource の挿入でドロップダウン リストを一覧表示、更新、およびタブの削除 (None) に設定されていることを確認します。](an-overview-of-editing-and-deleting-data-in-the-datalist-cs/_static/image13.png)](an-overview-of-editing-and-deleting-data-in-the-datalist-cs/_static/image12.png)</span><span class="sxs-lookup"><span data-stu-id="8646b-184">[![Confirm that the Drop-Down Lists in the ObjectDataSource s INSERT, UPDATE, and DELETE Tabs are Set to (None)](an-overview-of-editing-and-deleting-data-in-the-datalist-cs/_static/image13.png)](an-overview-of-editing-and-deleting-data-in-the-datalist-cs/_static/image12.png)</span></span>

<span data-ttu-id="8646b-185">**図 6**:ObjectDataSource の INSERT、UPDATE、および削除のタブで、ドロップダウン リストは、(なし) に設定されていることを確認します ([フルサイズの画像を表示する をクリックします](an-overview-of-editing-and-deleting-data-in-the-datalist-cs/_static/image14.png))。</span><span class="sxs-lookup"><span data-stu-id="8646b-185">**Figure 6**: Confirm that the Drop-Down Lists in the ObjectDataSource s INSERT, UPDATE, and DELETE Tabs are Set to (None) ([Click to view full-size image](an-overview-of-editing-and-deleting-data-in-the-datalist-cs/_static/image14.png))</span></span>

<span data-ttu-id="8646b-186">ObjectDataSource を構成した後、デザイナーに戻る、[完了] をクリックします。</span><span class="sxs-lookup"><span data-stu-id="8646b-186">After configuring the ObjectDataSource, click Finish, returning to the Designer.</span></span> <span data-ttu-id="8646b-187">ObjectDataSource 構成、Visual Studio を自動的に完了したときに、過去の例で確認したところを作成するよう、 `ItemTemplate` DropDownList の各データ フィールドを表示します。</span><span class="sxs-lookup"><span data-stu-id="8646b-187">As we ve seen in past examples, when completing the ObjectDataSource configuration, Visual Studio automatically creates an `ItemTemplate` for the DropDownList, displaying each of the data fields.</span></span> <span data-ttu-id="8646b-188">これを置き換える`ItemTemplate`製品の名前と価格を表示するものにします。</span><span class="sxs-lookup"><span data-stu-id="8646b-188">Replace this `ItemTemplate` with one that displays only the product s name and price.</span></span> <span data-ttu-id="8646b-189">また、設定、`RepeatColumns`プロパティを 2。</span><span class="sxs-lookup"><span data-stu-id="8646b-189">Also, set the `RepeatColumns` property to 2.</span></span>

> [!NOTE]
> <span data-ttu-id="8646b-190">説明したように、*概要の挿入、更新、およびデータの削除*チュートリアルでは、ObjectDataSource、アーキテクチャでは、削除する必要がありますを使用してデータを変更するときに、 `OldValuesParameterFormatString` ObjectDataSource %s からのプロパティ宣言型マークアップ (またはその既定値にリセットする`{0}`)。</span><span class="sxs-lookup"><span data-stu-id="8646b-190">As discussed in the *Overview of Inserting, Updating, and Deleting Data* tutorial, when modifying data using the ObjectDataSource our architecture requires that we remove the `OldValuesParameterFormatString` property from the ObjectDataSource s declarative markup (or reset it to its default value, `{0}`).</span></span> <span data-ttu-id="8646b-191">このチュートリアルでただし、使用している、ObjectDataSource のみデータを取得します。</span><span class="sxs-lookup"><span data-stu-id="8646b-191">In this tutorial, however, we are using the ObjectDataSource only for retrieving data.</span></span> <span data-ttu-id="8646b-192">そのため、私たち ObjectDataSource s を変更する必要はありません`OldValuesParameterFormatString`プロパティの値 (ですが、これを行うには t が低下する)。</span><span class="sxs-lookup"><span data-stu-id="8646b-192">Therefore, we do not need to modify the ObjectDataSource s `OldValuesParameterFormatString` property value (although it doesn t hurt to do so).</span></span>

<span data-ttu-id="8646b-193">DataList の既定値に置き換えた後`ItemTemplate`をカスタマイズしたものでは、ページの宣言型マークアップは、次のようになります。</span><span class="sxs-lookup"><span data-stu-id="8646b-193">After replacing the default DataList `ItemTemplate` with a customized one, the declarative markup on your page should look similar to the following:</span></span>

[!code-aspx[Main](an-overview-of-editing-and-deleting-data-in-the-datalist-cs/samples/sample2.aspx)]

<span data-ttu-id="8646b-194">ブラウザーから進行状況を表示する時間がかかります。</span><span class="sxs-lookup"><span data-stu-id="8646b-194">Take a moment to view our progress through a browser.</span></span> <span data-ttu-id="8646b-195">図 7 に示すよう、DataList では、2 つの列の各製品の製品名および単価が表示されます。</span><span class="sxs-lookup"><span data-stu-id="8646b-195">As Figure 7 shows, the DataList displays the product name and unit price for each product in two columns.</span></span>

<span data-ttu-id="8646b-196">[![2 つの列 DataList で製品名と価格の表示します。](an-overview-of-editing-and-deleting-data-in-the-datalist-cs/_static/image16.png)](an-overview-of-editing-and-deleting-data-in-the-datalist-cs/_static/image15.png)</span><span class="sxs-lookup"><span data-stu-id="8646b-196">[![The Products Names and Prices are Displayed in a Two-Column DataList](an-overview-of-editing-and-deleting-data-in-the-datalist-cs/_static/image16.png)](an-overview-of-editing-and-deleting-data-in-the-datalist-cs/_static/image15.png)</span></span>

<span data-ttu-id="8646b-197">**図 7**:製品の名前と価格は、2 つの列 DataList に表示されます ([フルサイズの画像を表示する をクリックします](an-overview-of-editing-and-deleting-data-in-the-datalist-cs/_static/image17.png))。</span><span class="sxs-lookup"><span data-stu-id="8646b-197">**Figure 7**: The Products Names and Prices are Displayed in a Two-Column DataList ([Click to view full-size image](an-overview-of-editing-and-deleting-data-in-the-datalist-cs/_static/image17.png))</span></span>

> [!NOTE]
> <span data-ttu-id="8646b-198">DataList は、多数の更新および削除のプロセスに必要なプロパティと、これらの値は、ビュー ステートに格納されます。</span><span class="sxs-lookup"><span data-stu-id="8646b-198">The DataList has a number of properties that are required for the updating and deleting process, and these values are stored in view state.</span></span> <span data-ttu-id="8646b-199">そのため、編集またはデータの削除をサポート DataList を構築することが DataList s のビューステートが有効にすることが重要です。</span><span class="sxs-lookup"><span data-stu-id="8646b-199">Therefore, when building a DataList that supports editing or deleting data, it is essential that the DataList s view state be enabled.</span></span>  
>   
> <span data-ttu-id="8646b-200">鋭い読者なら、可能性があることが編集可能な Gridview、DetailsViews、および FormViews を作成するときに、ビュー ステートを無効にすることを思い出してください。</span><span class="sxs-lookup"><span data-stu-id="8646b-200">The astute reader may recall that we were able to disable view state when creating editable GridViews, DetailsViews, and FormViews.</span></span> <span data-ttu-id="8646b-201">ASP.NET 2.0 Web コントロールを含めることができますので、これは*状態コントロール*、ビュー ステートがみなし essential のようなポストバック間で永続化状態。</span><span class="sxs-lookup"><span data-stu-id="8646b-201">This is because ASP.NET 2.0 Web controls can include *control state*, which is state persisted across postbacks like view state, but deemed essential.</span></span>

<span data-ttu-id="8646b-202">無効にするだけで、GridView での状態は、単純な状態情報が省略されますが (を編集および削除するために必要な状態を含む) コントロールの状態を維持します。</span><span class="sxs-lookup"><span data-stu-id="8646b-202">Disabling view state in the GridView merely omits trivial state information, but maintains the control state (which includes the state necessary for editing and deleting).</span></span> <span data-ttu-id="8646b-203">ASP.NET 1.x タイム フレームで作成されている、DataList コントロールの状態は使用されませんし、したがって、ビュー ステートを有効になっている必要があります。</span><span class="sxs-lookup"><span data-stu-id="8646b-203">The DataList, having been created in the ASP.NET 1.x timeframe, does not utilize control state and therefore must have view state enabled.</span></span> <span data-ttu-id="8646b-204">参照してください[コントロールの状態とします。ビュー ステート](https://msdn.microsoft.com/library/1whwt1k7.aspx)コントロールの状態とビュー ステートとは異なる方法の詳細については、目的の。</span><span class="sxs-lookup"><span data-stu-id="8646b-204">See [Control State vs. View State](https://msdn.microsoft.com/library/1whwt1k7.aspx) for more information on the purpose of control state and how it differs from view state.</span></span>

## <a name="step-4-adding-an-editing-user-interface"></a><span data-ttu-id="8646b-205">手順 4: 編集のユーザー インターフェイスの追加</span><span class="sxs-lookup"><span data-stu-id="8646b-205">Step 4: Adding an Editing User Interface</span></span>

<span data-ttu-id="8646b-206">GridView コントロールは、フィールド (BoundFields、CheckBoxFields、TemplateFields、およびなど) のコレクションで構成されます。</span><span class="sxs-lookup"><span data-stu-id="8646b-206">The GridView control is composed of a collection of fields (BoundFields, CheckBoxFields, TemplateFields, and so on).</span></span> <span data-ttu-id="8646b-207">これらのフィールドには、そのモードによって、出力されるマークアップを調整できます。</span><span class="sxs-lookup"><span data-stu-id="8646b-207">These fields can adjust their rendered markup depending on their mode.</span></span> <span data-ttu-id="8646b-208">たとえば、読み取り専用モードで、BoundField、データ フィールドの値テキストとして表示します。編集モードでレンダリング TextBox Web いるコントロール`Text`プロパティには、データ フィールドの値が割り当てられます。</span><span class="sxs-lookup"><span data-stu-id="8646b-208">For example, when in read-only mode, a BoundField displays its data field value as text; when in edit mode, it renders a TextBox Web control whose `Text` property is assigned the data field value.</span></span>

<span data-ttu-id="8646b-209">DataList では、その一方で、テンプレートを使用してそのアイテムをレンダリングします。</span><span class="sxs-lookup"><span data-stu-id="8646b-209">The DataList, on the other hand, renders its items using templates.</span></span> <span data-ttu-id="8646b-210">読み取り専用の項目を表示するを使用して、`ItemTemplate`を使用して編集モードでのアイテムが表示される一方、`EditItemTemplate`します。</span><span class="sxs-lookup"><span data-stu-id="8646b-210">Read-only items are rendered using the `ItemTemplate` whereas items in edit mode are rendered via the `EditItemTemplate`.</span></span> <span data-ttu-id="8646b-211">この時点で、DataList はのみが、`ItemTemplate`します。</span><span class="sxs-lookup"><span data-stu-id="8646b-211">At this point, our DataList has only an `ItemTemplate`.</span></span> <span data-ttu-id="8646b-212">項目レベルの編集機能を追加する必要がありますをサポートするために、`EditItemTemplate`編集可能な項目に対して表示されるマークアップを格納しています。</span><span class="sxs-lookup"><span data-stu-id="8646b-212">To support item-level editing functionality we need to add an `EditItemTemplate` that contains the markup to be displayed for the editable item.</span></span> <span data-ttu-id="8646b-213">このチュートリアルでは、s の製品名および単価を編集するためのテキスト ボックスに Web コントロール使用します。</span><span class="sxs-lookup"><span data-stu-id="8646b-213">For this tutorial, we'll use TextBox Web controls for editing the product s name and unit price.</span></span>

<span data-ttu-id="8646b-214">`EditItemTemplate` (DataList s のスマート タグからのテンプレートの編集 オプションを選択) を宣言的またはデザイナーのいずれかに作成できます。</span><span class="sxs-lookup"><span data-stu-id="8646b-214">The `EditItemTemplate` can be created either declaratively or through the Designer (by selecting the Edit Templates option from the DataList s smart tag).</span></span> <span data-ttu-id="8646b-215">テンプレートの編集オプションを使用して、まず、スマート タグのテンプレートの編集リンクをクリックし、、`EditItemTemplate`ドロップダウン リストから項目。</span><span class="sxs-lookup"><span data-stu-id="8646b-215">To use the Edit Templates option, first click the Edit Templates link in the smart tag and then select the `EditItemTemplate` item from the drop-down list.</span></span>

<span data-ttu-id="8646b-216">[![DataList s の後で作業することを選択します。](an-overview-of-editing-and-deleting-data-in-the-datalist-cs/_static/image19.png)](an-overview-of-editing-and-deleting-data-in-the-datalist-cs/_static/image18.png)</span><span class="sxs-lookup"><span data-stu-id="8646b-216">[![Opt to Work with the DataList s EditItemTemplate](an-overview-of-editing-and-deleting-data-in-the-datalist-cs/_static/image19.png)](an-overview-of-editing-and-deleting-data-in-the-datalist-cs/_static/image18.png)</span></span>

<span data-ttu-id="8646b-217">**図 8**:DataList s で作業することを選択`EditItemTemplate`([フルサイズの画像を表示する をクリックします](an-overview-of-editing-and-deleting-data-in-the-datalist-cs/_static/image20.png))。</span><span class="sxs-lookup"><span data-stu-id="8646b-217">**Figure 8**: Opt to Work with the DataList s `EditItemTemplate` ([Click to view full-size image](an-overview-of-editing-and-deleting-data-in-the-datalist-cs/_static/image20.png))</span></span>

<span data-ttu-id="8646b-218">次に、製品名を入力: と価格: ツールボックスから 2 つのテキスト ボックス コントロールをドラッグし、`EditItemTemplate`デザイナー上のインターフェイス。</span><span class="sxs-lookup"><span data-stu-id="8646b-218">Next, type in Product name: and Price: and then drag two TextBox controls from the Toolbox into the `EditItemTemplate` interface on the Designer.</span></span> <span data-ttu-id="8646b-219">テキスト ボックスの設定`ID`プロパティ`ProductName`と`UnitPrice`します。</span><span class="sxs-lookup"><span data-stu-id="8646b-219">Set the TextBoxes `ID` properties to `ProductName` and `UnitPrice`.</span></span>

<span data-ttu-id="8646b-220">[![製品の名前と価格のテキスト ボックスを追加します。](an-overview-of-editing-and-deleting-data-in-the-datalist-cs/_static/image22.png)](an-overview-of-editing-and-deleting-data-in-the-datalist-cs/_static/image21.png)</span><span class="sxs-lookup"><span data-stu-id="8646b-220">[![Add a TextBox for the Product s Name and Price](an-overview-of-editing-and-deleting-data-in-the-datalist-cs/_static/image22.png)](an-overview-of-editing-and-deleting-data-in-the-datalist-cs/_static/image21.png)</span></span>

<span data-ttu-id="8646b-221">**図 9**:価格、製品名のテキスト ボックスを追加 ([フルサイズの画像を表示する をクリックします](an-overview-of-editing-and-deleting-data-in-the-datalist-cs/_static/image23.png))。</span><span class="sxs-lookup"><span data-stu-id="8646b-221">**Figure 9**: Add a TextBox for the Product s Name and Price ([Click to view full-size image](an-overview-of-editing-and-deleting-data-in-the-datalist-cs/_static/image23.png))</span></span>

<span data-ttu-id="8646b-222">対応する製品のデータ フィールド値をバインドする必要があります、 `Text` 2 つのテキスト ボックスのプロパティ。</span><span class="sxs-lookup"><span data-stu-id="8646b-222">We need to bind the corresponding product data field values to the `Text` properties of the two TextBoxes.</span></span> <span data-ttu-id="8646b-223">テキスト ボックスのスマート タグから DataBindings の編集リンクをクリックし、適切なデータ フィールドを関連付ける、`Text`プロパティ、図 10 に示すようにします。</span><span class="sxs-lookup"><span data-stu-id="8646b-223">From the TextBoxes smart tags, click on the Edit DataBindings link and then associate the appropriate data field with the `Text` property, as shown in Figure 10.</span></span>

> [!NOTE]
> <span data-ttu-id="8646b-224">バインドするときに、`UnitPrice`データ フィールドをテキスト ボックスの価格`Text`フィールドに、可能性があります形式にすると、通貨値 (`{0:C}`)、通常の数値 (`{0:N}`)、または書式設定されていないままにします。</span><span class="sxs-lookup"><span data-stu-id="8646b-224">When binding the `UnitPrice` data field to the price TextBox s `Text` field, you may format it as a currency value (`{0:C}`), a general number (`{0:N}`), or leave it unformatted.</span></span>

![ProductName と UnitPrice データ フィールドをテキスト ボックスのテキストのプロパティにバインドします。](an-overview-of-editing-and-deleting-data-in-the-datalist-cs/_static/image24.png)

<span data-ttu-id="8646b-226">**図 10**:バインド、`ProductName`と`UnitPrice`データ フィールドを`Text`テキスト ボックスのプロパティ</span><span class="sxs-lookup"><span data-stu-id="8646b-226">**Figure 10**: Bind the `ProductName` and `UnitPrice` Data Fields to the `Text` Properties of the TextBoxes</span></span>

<span data-ttu-id="8646b-227">図 10 DataBindings の編集 ダイアログ ボックスでは方法に注意してください。*いない*双方向データ バインドのチェック ボックスで、GridView、DetailsView、TemplateField または FormView のテンプレートを編集するときに存在するが含まれます。</span><span class="sxs-lookup"><span data-stu-id="8646b-227">Notice how the Edit DataBindings dialog box in Figure 10 does *not* include the Two-way databinding checkbox that is present when editing a TemplateField in the GridView or DetailsView, or a template in the FormView.</span></span> <span data-ttu-id="8646b-228">双方向データ バインド機能に対応する ObjectDataSource 秒に自動的に割り当てられる入力 Web コントロールに入力された値が許可されている`InsertParameters`または`UpdateParameters`挿入またはデータを更新するとき。</span><span class="sxs-lookup"><span data-stu-id="8646b-228">The two-way databinding feature allowed the value entered into the input Web control to be automatically assigned to the corresponding ObjectDataSource s `InsertParameters` or `UpdateParameters` when inserting or updating data.</span></span> <span data-ttu-id="8646b-229">DataList が双方向データ バインドをサポートしていませんおわかりに後で、このチュートリアルではユーザーが変更され、データを更新する準備が彼女の後に、プログラムによってこれらのテキスト ボックスにアクセスする必要があります`Text`プロパティとその値を渡す、。適切な`UpdateProduct`メソッドで、`ProductsBLL`クラス。</span><span class="sxs-lookup"><span data-stu-id="8646b-229">The DataList does not support two-way databinding as we'll see later on in this tutorial, after the user makes her changes and is ready to update the data, we will need to programmatically access these TextBoxes `Text` properties and pass in their values to the appropriate `UpdateProduct` method in the `ProductsBLL` class.</span></span>

<span data-ttu-id="8646b-230">最後に、更新プログラムを追加する必要がありますとキャンセル ボタンに、`EditItemTemplate`します。</span><span class="sxs-lookup"><span data-stu-id="8646b-230">Finally, we need to add Update and Cancel buttons to the `EditItemTemplate`.</span></span> <span data-ttu-id="8646b-231">説明したように、[マスター/マスター レコードの箇条書きリストを使用すると詳細 DataList について詳しく説明](../filtering-scenarios-with-the-datalist-and-repeater/master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs.md)チュートリアルでは、ボタン、LinkButton や ImageButton が`CommandName`プロパティが設定されて、DataList、Repeater 内でのクリックして、Repeater、DataList または s`ItemCommand`イベントが発生します。</span><span class="sxs-lookup"><span data-stu-id="8646b-231">As we saw in the [Master/Detail Using a Bulleted List of Master Records with a Details DataList](../filtering-scenarios-with-the-datalist-and-repeater/master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs.md) tutorial, when a Button, LinkButton, or ImageButton whose `CommandName` property is set is clicked from within a Repeater or DataList, the Repeater or DataList s `ItemCommand` event is raised.</span></span> <span data-ttu-id="8646b-232">DataList の場合、`CommandName`プロパティは、特定の値に設定されても追加イベントを発生させる可能性があります。</span><span class="sxs-lookup"><span data-stu-id="8646b-232">For the DataList, if the `CommandName` property is set to a certain value, an additional event may be raised as well.</span></span> <span data-ttu-id="8646b-233">特殊な`CommandName`他のユーザーの間でのプロパティの値が含まれます。</span><span class="sxs-lookup"><span data-stu-id="8646b-233">The special `CommandName` property values include, among others:</span></span>

- <span data-ttu-id="8646b-234">キャンセルが発生、`CancelCommand`イベント</span><span class="sxs-lookup"><span data-stu-id="8646b-234">Cancel raises the `CancelCommand` event</span></span>
- <span data-ttu-id="8646b-235">編集が発生、`EditCommand`イベント</span><span class="sxs-lookup"><span data-stu-id="8646b-235">Edit raises the `EditCommand` event</span></span>
- <span data-ttu-id="8646b-236">更新が発生、`UpdateCommand`イベント</span><span class="sxs-lookup"><span data-stu-id="8646b-236">Update raises the `UpdateCommand` event</span></span>

<span data-ttu-id="8646b-237">これらのイベントが発生したことに注意してください*に加えて*、`ItemCommand`イベント。</span><span class="sxs-lookup"><span data-stu-id="8646b-237">Keep in mind that these events are raised *in addition to* the `ItemCommand` event.</span></span>

<span data-ttu-id="8646b-238">追加、 `EditItemTemplate` 2 つのボタンの Web コントロール、1 つ持つ`CommandName`Update と他の設定を [キャンセル] に設定されています。</span><span class="sxs-lookup"><span data-stu-id="8646b-238">Add to the `EditItemTemplate` two Button Web controls, one whose `CommandName` is set to Update and the other s set to Cancel.</span></span> <span data-ttu-id="8646b-239">これら 2 つのボタンの Web コントロールを追加した後、デザイナーに、次のようになります。</span><span class="sxs-lookup"><span data-stu-id="8646b-239">After adding these two Button Web controls the Designer should look similar to the following:</span></span>

<span data-ttu-id="8646b-240">[![更新プログラムを追加し、キャンセル、後にボタン](an-overview-of-editing-and-deleting-data-in-the-datalist-cs/_static/image26.png)](an-overview-of-editing-and-deleting-data-in-the-datalist-cs/_static/image25.png)</span><span class="sxs-lookup"><span data-stu-id="8646b-240">[![Add Update and Cancel Buttons to the EditItemTemplate](an-overview-of-editing-and-deleting-data-in-the-datalist-cs/_static/image26.png)](an-overview-of-editing-and-deleting-data-in-the-datalist-cs/_static/image25.png)</span></span>

<span data-ttu-id="8646b-241">**図 11**:更新とキャンセル ボタンを追加、 `EditItemTemplate` ([フルサイズの画像を表示する をクリックします](an-overview-of-editing-and-deleting-data-in-the-datalist-cs/_static/image27.png))。</span><span class="sxs-lookup"><span data-stu-id="8646b-241">**Figure 11**: Add Update and Cancel Buttons to the `EditItemTemplate` ([Click to view full-size image](an-overview-of-editing-and-deleting-data-in-the-datalist-cs/_static/image27.png))</span></span>

<span data-ttu-id="8646b-242">`EditItemTemplate`完了、DataList s 宣言型マークアップのようになります次。</span><span class="sxs-lookup"><span data-stu-id="8646b-242">With the `EditItemTemplate` complete your DataList s declarative markup should look similar to the following:</span></span>

[!code-aspx[Main](an-overview-of-editing-and-deleting-data-in-the-datalist-cs/samples/sample3.aspx)]

## <a name="step-5-adding-the-plumbing-to-enter-edit-mode"></a><span data-ttu-id="8646b-243">手順 5: 編集モードに切り替わるプラミングを追加します。</span><span class="sxs-lookup"><span data-stu-id="8646b-243">Step 5: Adding the Plumbing to Enter Edit Mode</span></span>

<span data-ttu-id="8646b-244">この時点で、編集インターフェイスを使用して定義されているが、DataList その`EditItemTemplate`。 ただし、そこ s 現在する方法がない、ページにアクセスしたユーザーの製品の情報を編集したことを示します。</span><span class="sxs-lookup"><span data-stu-id="8646b-244">At this point our DataList has an editing interface defined via its `EditItemTemplate`; however, there s currently no way for a user visiting our page to indicate that he wants to edit a product s information.</span></span> <span data-ttu-id="8646b-245">[編集] ボタンをクリックすると、レンダリング、DataList 項目の編集モードで各製品に追加する必要があります。</span><span class="sxs-lookup"><span data-stu-id="8646b-245">We need to add an Edit button to each product that, when clicked, renders that DataList item in edit mode.</span></span> <span data-ttu-id="8646b-246">Edit ボタンを追加して、開始、 `ItemTemplate`、デザイナーを通じて、または宣言します。</span><span class="sxs-lookup"><span data-stu-id="8646b-246">Start by adding an Edit button to the `ItemTemplate`, either through the Designer or declaratively.</span></span> <span data-ttu-id="8646b-247">S [編集] ボタンを設定することを`CommandName`プロパティを編集します。</span><span class="sxs-lookup"><span data-stu-id="8646b-247">Be certain to set the Edit button s `CommandName` property to Edit .</span></span>

<span data-ttu-id="8646b-248">この編集 ボタンを追加した後、ブラウザーでページを表示するみましょう。</span><span class="sxs-lookup"><span data-stu-id="8646b-248">After you have added this Edit button, take a moment to view the page through a browser.</span></span> <span data-ttu-id="8646b-249">これにより、各製品の一覧は、[編集] ボタンを含める必要があります。</span><span class="sxs-lookup"><span data-stu-id="8646b-249">With this addition, each product listing should include an Edit button.</span></span>

<span data-ttu-id="8646b-250">[![更新プログラムを追加し、キャンセル、後にボタン](an-overview-of-editing-and-deleting-data-in-the-datalist-cs/_static/image29.png)](an-overview-of-editing-and-deleting-data-in-the-datalist-cs/_static/image28.png)</span><span class="sxs-lookup"><span data-stu-id="8646b-250">[![Add Update and Cancel Buttons to the EditItemTemplate](an-overview-of-editing-and-deleting-data-in-the-datalist-cs/_static/image29.png)](an-overview-of-editing-and-deleting-data-in-the-datalist-cs/_static/image28.png)</span></span>

<span data-ttu-id="8646b-251">**図 12**:更新とキャンセル ボタンを追加、 `EditItemTemplate` ([フルサイズの画像を表示する をクリックします](an-overview-of-editing-and-deleting-data-in-the-datalist-cs/_static/image30.png))。</span><span class="sxs-lookup"><span data-stu-id="8646b-251">**Figure 12**: Add Update and Cancel Buttons to the `EditItemTemplate` ([Click to view full-size image](an-overview-of-editing-and-deleting-data-in-the-datalist-cs/_static/image30.png))</span></span>

<span data-ttu-id="8646b-252">ボタンをクリックすると、ポストバックを発生させるは*いない*製品のリストを編集モードにします。</span><span class="sxs-lookup"><span data-stu-id="8646b-252">Clicking the button causes a postback, but does *not* bring the product listing into edit mode.</span></span> <span data-ttu-id="8646b-253">製品を編集可能にするには、する必要があります。</span><span class="sxs-lookup"><span data-stu-id="8646b-253">To make the product editable, we need to:</span></span>

1. <span data-ttu-id="8646b-254">DataList s 設定[`EditItemIndex`プロパティ](https://msdn.microsoft.com/library/system.web.ui.webcontrols.datalist.edititemindex.aspx)のインデックスに、`DataListItem`ある編集ボタンがクリックされただけです。</span><span class="sxs-lookup"><span data-stu-id="8646b-254">Set the DataList s [`EditItemIndex` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.datalist.edititemindex.aspx) to the index of the `DataListItem` whose Edit button was just clicked.</span></span>
2. <span data-ttu-id="8646b-255">DataList のデータを再バインドします。</span><span class="sxs-lookup"><span data-stu-id="8646b-255">Rebind the data to the DataList.</span></span> <span data-ttu-id="8646b-256">DataList は再表示されたときに、`DataListItem`が`ItemIndex`DataList s に対応`EditItemIndex`はレンダリングを使用してその`EditItemTemplate`。</span><span class="sxs-lookup"><span data-stu-id="8646b-256">When the DataList is re-rendered, the `DataListItem` whose `ItemIndex` corresponds with the DataList s `EditItemIndex` will render using its `EditItemTemplate`.</span></span>

<span data-ttu-id="8646b-257">DataList s 以降`EditCommand`イベント編集ボタンがクリックされたときに発生、作成、`EditCommand`イベント ハンドラーを次のコード。</span><span class="sxs-lookup"><span data-stu-id="8646b-257">Since the DataList s `EditCommand` event is fired when the Edit button is clicked, create an `EditCommand` event handler with the following code:</span></span>

[!code-csharp[Main](an-overview-of-editing-and-deleting-data-in-the-datalist-cs/samples/sample4.cs)]

<span data-ttu-id="8646b-258">`EditCommand`イベント ハンドラーが型のオブジェクトに渡される`DataListCommandEventArgs`への参照を含む、2 番目の入力パラメーターとして、`DataListItem`ある編集ボタンがクリックされた (`e.Item`)。</span><span class="sxs-lookup"><span data-stu-id="8646b-258">The `EditCommand` event handler is passed in an object of type `DataListCommandEventArgs` as its second input parameter, which includes a reference to the `DataListItem` whose Edit button was clicked (`e.Item`).</span></span> <span data-ttu-id="8646b-259">イベント ハンドラーは、DataList s をまず設定`EditItemIndex`を`ItemIndex`は編集可能なの`DataListItem`DataList s を呼び出すことによって、DataList にデータを再バインドと`DataBind()`メソッド。</span><span class="sxs-lookup"><span data-stu-id="8646b-259">The event handler first sets the DataList s `EditItemIndex` to the `ItemIndex` of the editable `DataListItem` and then rebinds the data to the DataList by calling the DataList s `DataBind()` method.</span></span>

<span data-ttu-id="8646b-260">このイベント ハンドラーを追加した後、ブラウザーでページを再検討します。</span><span class="sxs-lookup"><span data-stu-id="8646b-260">After adding this event handler, revisit the page in a browser.</span></span> <span data-ttu-id="8646b-261">[編集] ボタンをクリックすると、今すぐでは、製品のクリックされた編集可能な (図 13 参照)。</span><span class="sxs-lookup"><span data-stu-id="8646b-261">Clicking the Edit button now makes the clicked product editable (see Figure 13).</span></span>

<span data-ttu-id="8646b-262">[![編集ボタンが編集可能な製品をクリックします。](an-overview-of-editing-and-deleting-data-in-the-datalist-cs/_static/image32.png)](an-overview-of-editing-and-deleting-data-in-the-datalist-cs/_static/image31.png)</span><span class="sxs-lookup"><span data-stu-id="8646b-262">[![Clicking the Edit Button Makes the Product Editable](an-overview-of-editing-and-deleting-data-in-the-datalist-cs/_static/image32.png)](an-overview-of-editing-and-deleting-data-in-the-datalist-cs/_static/image31.png)</span></span>

<span data-ttu-id="8646b-263">**図 13**:製品編集可能で、[編集] をクリックすると、([フルサイズの画像を表示する をクリックします](an-overview-of-editing-and-deleting-data-in-the-datalist-cs/_static/image33.png))。</span><span class="sxs-lookup"><span data-stu-id="8646b-263">**Figure 13**: Clicking the Edit Button Makes the Product Editable ([Click to view full-size image](an-overview-of-editing-and-deleting-data-in-the-datalist-cs/_static/image33.png))</span></span>

## <a name="step-6-saving-the-user-s-changes"></a><span data-ttu-id="8646b-264">手順 6: ユーザーの変更を保存</span><span class="sxs-lookup"><span data-stu-id="8646b-264">Step 6: Saving the User s Changes</span></span>

<span data-ttu-id="8646b-265">編集した製品の更新プログラムまたは [キャンセル] ボタンをクリックするとは何も行いません。 この時点でDataList s のイベント ハンドラーを作成する必要があります。 この機能を追加する`UpdateCommand`と`CancelCommand`イベント。</span><span class="sxs-lookup"><span data-stu-id="8646b-265">Clicking the edited product s Update or Cancel buttons does nothing at this point; to add this functionality we need to create event handlers for the DataList s `UpdateCommand` and `CancelCommand` events.</span></span> <span data-ttu-id="8646b-266">まず、作成、`CancelCommand`イベント ハンドラーは、編集した製品の [キャンセル] ボタンをクリックし、編集済みの状態、DataList を返す際に携わることと、実行されます。</span><span class="sxs-lookup"><span data-stu-id="8646b-266">Start by creating the `CancelCommand` event handler, which will execute when the edited product s Cancel button is clicked and it tasked with returning the DataList to its pre-editing state.</span></span>

<span data-ttu-id="8646b-267">DataList のすべての読み取り専用モードでは、その項目を表示するには、する必要があります。</span><span class="sxs-lookup"><span data-stu-id="8646b-267">To have the DataList render all of its items in the read-only mode, we need to:</span></span>

1. <span data-ttu-id="8646b-268">DataList s 設定[`EditItemIndex`プロパティ](https://msdn.microsoft.com/library/system.web.ui.webcontrols.datalist.edititemindex.aspx)の存在しないインデックスに`DataListItem`インデックス。</span><span class="sxs-lookup"><span data-stu-id="8646b-268">Set the DataList s [`EditItemIndex` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.datalist.edititemindex.aspx) to the index of a non-existent `DataListItem` index.</span></span> <span data-ttu-id="8646b-269">`-1` 安全な選択肢のためは、`DataListItem`開始インデックス`0`します。</span><span class="sxs-lookup"><span data-stu-id="8646b-269">`-1` is a safe choice, since the `DataListItem` indexes start at `0`.</span></span>
2. <span data-ttu-id="8646b-270">DataList のデータを再バインドします。</span><span class="sxs-lookup"><span data-stu-id="8646b-270">Rebind the data to the DataList.</span></span> <span data-ttu-id="8646b-271">No 以降`DataListItem` `ItemIndex` DataList s に対応して es `EditItemIndex`、全体の DataList は読み取り専用モードで表示されます。</span><span class="sxs-lookup"><span data-stu-id="8646b-271">Since no `DataListItem` `ItemIndex` es correspond to the DataList s `EditItemIndex`, the entire DataList will be rendered in a read-only mode.</span></span>

<span data-ttu-id="8646b-272">次のイベント ハンドラーのコードでは、次の手順を実行できます。</span><span class="sxs-lookup"><span data-stu-id="8646b-272">These steps can be accomplished with the following event handler code:</span></span>

[!code-csharp[Main](an-overview-of-editing-and-deleting-data-in-the-datalist-cs/samples/sample5.cs)]

<span data-ttu-id="8646b-273">これにより、編集済みの状態に キャンセル ボタン戻ります DataList をクリックします。</span><span class="sxs-lookup"><span data-stu-id="8646b-273">With this addition, clicking the Cancel button returns the DataList to its pre-editing state.</span></span>

<span data-ttu-id="8646b-274">最後のイベント ハンドラーが完了する必要がありますが、`UpdateCommand`イベント ハンドラー。</span><span class="sxs-lookup"><span data-stu-id="8646b-274">The last event handler we need to complete is the `UpdateCommand` event handler.</span></span> <span data-ttu-id="8646b-275">このイベント ハンドラーは、する必要があります。</span><span class="sxs-lookup"><span data-stu-id="8646b-275">This event handler needs to:</span></span>

1. <span data-ttu-id="8646b-276">製品のユーザーが入力した名前、価格とともに s 編集済みの製品をプログラムでアクセス`ProductID`します。</span><span class="sxs-lookup"><span data-stu-id="8646b-276">Programmatically access the user-entered product name and price as well as the edited product s `ProductID`.</span></span>
2. <span data-ttu-id="8646b-277">適切なを呼び出して、更新プロセスを開始`UpdateProduct`でオーバー ロード、`ProductsBLL`クラス。</span><span class="sxs-lookup"><span data-stu-id="8646b-277">Initiate the update process by calling the appropriate `UpdateProduct` overload in the `ProductsBLL` class.</span></span>
3. <span data-ttu-id="8646b-278">DataList s 設定[`EditItemIndex`プロパティ](https://msdn.microsoft.com/library/system.web.ui.webcontrols.datalist.edititemindex.aspx)の存在しないインデックスに`DataListItem`インデックス。</span><span class="sxs-lookup"><span data-stu-id="8646b-278">Set the DataList s [`EditItemIndex` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.datalist.edititemindex.aspx) to the index of a non-existent `DataListItem` index.</span></span> <span data-ttu-id="8646b-279">`-1` 安全な選択肢のためは、`DataListItem`開始インデックス`0`します。</span><span class="sxs-lookup"><span data-stu-id="8646b-279">`-1` is a safe choice, since the `DataListItem` indexes start at `0`.</span></span>
4. <span data-ttu-id="8646b-280">DataList のデータを再バインドします。</span><span class="sxs-lookup"><span data-stu-id="8646b-280">Rebind the data to the DataList.</span></span> <span data-ttu-id="8646b-281">No 以降`DataListItem` `ItemIndex` DataList s に対応して es `EditItemIndex`、全体の DataList は読み取り専用モードで表示されます。</span><span class="sxs-lookup"><span data-stu-id="8646b-281">Since no `DataListItem` `ItemIndex` es correspond to the DataList s `EditItemIndex`, the entire DataList will be rendered in a read-only mode.</span></span>

<span data-ttu-id="8646b-282">手順 1. および 2. は、ユーザーの変更を保存するため、します。手順 3 と 4 は、変更が保存されているしで実行した手順と同じです編集済みの状態、DataList を返す、`CancelCommand`イベント ハンドラー。</span><span class="sxs-lookup"><span data-stu-id="8646b-282">Steps 1 and 2 are responsible for saving the user s changes; steps 3 and 4 return the DataList to its pre-editing state after the changes have been saved and are identical to the steps performed in the `CancelCommand` event handler.</span></span>

<span data-ttu-id="8646b-283">更新された製品名と価格を取得する必要がありますを使用する、 `FindControl` TextBox Web コントロールの内のプログラムで参照するメソッド、`EditItemTemplate`します。</span><span class="sxs-lookup"><span data-stu-id="8646b-283">To get the updated product name and price, we need to use the `FindControl` method to programmatically reference the TextBox Web controls within the `EditItemTemplate`.</span></span> <span data-ttu-id="8646b-284">編集した製品 s を取得する必要もあります`ProductID`値。</span><span class="sxs-lookup"><span data-stu-id="8646b-284">We also need to get the edited product s `ProductID` value.</span></span> <span data-ttu-id="8646b-285">Visual Studio に DataList s が割り当てられている場合、最初に、ObjectDataSource を DataList にバインドしました`DataKeyField`プロパティは、主キーの値をデータ ソースから (`ProductID`)。</span><span class="sxs-lookup"><span data-stu-id="8646b-285">When we initially bound the ObjectDataSource to the DataList, Visual Studio assigned the DataList s `DataKeyField` property to the primary key value from the data source (`ProductID`).</span></span> <span data-ttu-id="8646b-286">DataList s から、この値を取得しできます`DataKeys`コレクション。</span><span class="sxs-lookup"><span data-stu-id="8646b-286">This value can then be retrieved from the DataList s `DataKeys` collection.</span></span> <span data-ttu-id="8646b-287">いることを確認する少し、`DataKeyField`プロパティに設定されて実際`ProductID`します。</span><span class="sxs-lookup"><span data-stu-id="8646b-287">Take a moment to ensure that the `DataKeyField` property is indeed set to `ProductID`.</span></span>

<span data-ttu-id="8646b-288">次のコードは、4 つの手順を実装します。</span><span class="sxs-lookup"><span data-stu-id="8646b-288">The following code implements the four steps:</span></span>

[!code-csharp[Main](an-overview-of-editing-and-deleting-data-in-the-datalist-cs/samples/sample6.cs)]

<span data-ttu-id="8646b-289">イベント ハンドラーを編集した製品 s で読み取ることによって開始`ProductID`から、`DataKeys`コレクション。</span><span class="sxs-lookup"><span data-stu-id="8646b-289">The event handler starts by reading in the edited product s `ProductID` from the `DataKeys` collection.</span></span> <span data-ttu-id="8646b-290">次に、2 つのテキスト ボックス、`EditItemTemplate`参照されると、その`Text`ローカル変数に格納されているプロパティ`productNameValue`と`unitPriceValue`。</span><span class="sxs-lookup"><span data-stu-id="8646b-290">Next, the two TextBoxes in the `EditItemTemplate` are referenced and their `Text` properties stored in local variables, `productNameValue` and `unitPriceValue`.</span></span> <span data-ttu-id="8646b-291">使用して、`Decimal.Parse()`メソッドから値を読み取る、`UnitPrice`いる場合、値を入力するためのテキスト ボックスに通貨記号、それが正常に変換できる、`Decimal`値。</span><span class="sxs-lookup"><span data-stu-id="8646b-291">We use the `Decimal.Parse()` method to read the value from the `UnitPrice` TextBox so that if the value entered has a currency symbol, it can still be correctly converted into a `Decimal` value.</span></span>

> [!NOTE]
> <span data-ttu-id="8646b-292">値、`ProductName`と`UnitPrice`テキスト ボックスのテキストのプロパティが指定された値がある場合に、テキスト ボックスが productNameValue と unitPriceValue 変数に割り当てられるのみです。</span><span class="sxs-lookup"><span data-stu-id="8646b-292">The values from the `ProductName` and `UnitPrice` TextBoxes are only assigned to the productNameValue and unitPriceValue variables if the TextBoxes Text properties have a value specified.</span></span> <span data-ttu-id="8646b-293">それ以外の場合、値の`Nothing`、変数の使用のデータベースでデータを更新の影響は`NULL`値。</span><span class="sxs-lookup"><span data-stu-id="8646b-293">Otherwise, a value of `Nothing` is used for the variables, which has the effect of updating the data with a database `NULL` value.</span></span> <span data-ttu-id="8646b-294">コードが変換を処理するは、空のデータベースへの文字列`NULL`値で、GridView、DetailsView、FormView コントロールで編集インターフェイスの既定の動作です。</span><span class="sxs-lookup"><span data-stu-id="8646b-294">That is, our code treats converts empty strings to database `NULL` values, which is the default behavior of the editing interface in the GridView, DetailsView, and FormView controls.</span></span>

<span data-ttu-id="8646b-295">値を読み取った後、`ProductsBLL`クラス s`UpdateProduct`メソッドが呼び出されると、製品の名前を渡して、価格設定、および`ProductID`。</span><span class="sxs-lookup"><span data-stu-id="8646b-295">After reading the values, the `ProductsBLL` class s `UpdateProduct` method is called, passing in the product s name, price, and `ProductID`.</span></span> <span data-ttu-id="8646b-296">イベント ハンドラーのように正確な同じロジックを使用して編集済みの状態、DataList を返すことによって完了、`CancelCommand`イベント ハンドラー。</span><span class="sxs-lookup"><span data-stu-id="8646b-296">The event handler completes by returning the DataList to its pre-editing state using the exact same logic as in the `CancelCommand` event handler.</span></span>

<span data-ttu-id="8646b-297">`EditCommand`、 `CancelCommand`、および`UpdateCommand`イベント ハンドラーの完了、訪問者には、製品の価格と名前を編集できます。</span><span class="sxs-lookup"><span data-stu-id="8646b-297">With the `EditCommand`, `CancelCommand`, and `UpdateCommand` event handlers complete, a visitor can edit the name and price of a product.</span></span> <span data-ttu-id="8646b-298">図 14-16 は、アクションのこの編集ワークフローを表示します。</span><span class="sxs-lookup"><span data-stu-id="8646b-298">Figures 14-16 show this editing workflow in action.</span></span>

<span data-ttu-id="8646b-299">[![ページにアクセスして、すべての製品は読み取り専用モードで](an-overview-of-editing-and-deleting-data-in-the-datalist-cs/_static/image35.png)](an-overview-of-editing-and-deleting-data-in-the-datalist-cs/_static/image34.png)</span><span class="sxs-lookup"><span data-stu-id="8646b-299">[![When First Visiting the Page, All Products are in Read-Only Mode](an-overview-of-editing-and-deleting-data-in-the-datalist-cs/_static/image35.png)](an-overview-of-editing-and-deleting-data-in-the-datalist-cs/_static/image34.png)</span></span>

<span data-ttu-id="8646b-300">**図 14**:すべての製品が読み取り専用モードでは、ページを最初にアクセスして、ときに ([フルサイズの画像を表示する をクリックします](an-overview-of-editing-and-deleting-data-in-the-datalist-cs/_static/image36.png))。</span><span class="sxs-lookup"><span data-stu-id="8646b-300">**Figure 14**: When First Visiting the Page, All Products are in Read-Only Mode ([Click to view full-size image](an-overview-of-editing-and-deleting-data-in-the-datalist-cs/_static/image36.png))</span></span>

<span data-ttu-id="8646b-301">[![製品名の価格を更新するには、[編集] ボタンをクリックします。](an-overview-of-editing-and-deleting-data-in-the-datalist-cs/_static/image38.png)](an-overview-of-editing-and-deleting-data-in-the-datalist-cs/_static/image37.png)</span><span class="sxs-lookup"><span data-stu-id="8646b-301">[![To Update a Product s Name or Price, Click the Edit Button](an-overview-of-editing-and-deleting-data-in-the-datalist-cs/_static/image38.png)](an-overview-of-editing-and-deleting-data-in-the-datalist-cs/_static/image37.png)</span></span>

<span data-ttu-id="8646b-302">**図 15**:製品名または価格を更新するには、[編集] ボタンをクリックします ([フルサイズの画像を表示する をクリックします。](an-overview-of-editing-and-deleting-data-in-the-datalist-cs/_static/image39.png))。</span><span class="sxs-lookup"><span data-stu-id="8646b-302">**Figure 15**: To Update a Product s Name or Price, Click the Edit Button ([Click to view full-size image](an-overview-of-editing-and-deleting-data-in-the-datalist-cs/_static/image39.png))</span></span>

<span data-ttu-id="8646b-303">[![値を変更した後、読み取り専用モードに戻るに更新 をクリックして](an-overview-of-editing-and-deleting-data-in-the-datalist-cs/_static/image41.png)](an-overview-of-editing-and-deleting-data-in-the-datalist-cs/_static/image40.png)</span><span class="sxs-lookup"><span data-stu-id="8646b-303">[![After Changing the Value, Click Update to Return to the Read-Only Mode](an-overview-of-editing-and-deleting-data-in-the-datalist-cs/_static/image41.png)](an-overview-of-editing-and-deleting-data-in-the-datalist-cs/_static/image40.png)</span></span>

<span data-ttu-id="8646b-304">**図 16**:読み取り専用モードに戻るの更新プログラムをクリックして、値を変更した後 ([フルサイズの画像を表示する をクリックします](an-overview-of-editing-and-deleting-data-in-the-datalist-cs/_static/image42.png))。</span><span class="sxs-lookup"><span data-stu-id="8646b-304">**Figure 16**: After Changing the Value, Click Update to Return to the Read-Only Mode ([Click to view full-size image](an-overview-of-editing-and-deleting-data-in-the-datalist-cs/_static/image42.png))</span></span>

## <a name="step-7-adding-delete-capabilities"></a><span data-ttu-id="8646b-305">手順 7: 削除の機能を追加します。</span><span class="sxs-lookup"><span data-stu-id="8646b-305">Step 7: Adding Delete Capabilities</span></span>

<span data-ttu-id="8646b-306">DataList に削除の機能を追加するための手順では、編集機能を追加するためのものに似ています。</span><span class="sxs-lookup"><span data-stu-id="8646b-306">The steps for adding delete capabilities to a DataList are similar to those for adding editing capabilities.</span></span> <span data-ttu-id="8646b-307">つまり、削除ボタンを追加する必要があります、`ItemTemplate`クリックされたとき。</span><span class="sxs-lookup"><span data-stu-id="8646b-307">In short, we need to add a Delete button to the `ItemTemplate` that, when clicked:</span></span>

1. <span data-ttu-id="8646b-308">読み取り、対応する製品 s`ProductID`を使用して、`DataKeys`コレクション。</span><span class="sxs-lookup"><span data-stu-id="8646b-308">Reads in the corresponding product s `ProductID` via the `DataKeys` collection.</span></span>
2. <span data-ttu-id="8646b-309">呼び出して、削除を実行します。、`ProductsBLL`クラス s`DeleteProduct`メソッド。</span><span class="sxs-lookup"><span data-stu-id="8646b-309">Performs the delete by calling the `ProductsBLL` class s `DeleteProduct` method.</span></span>
3. <span data-ttu-id="8646b-310">DataList のデータを再バインドします。</span><span class="sxs-lookup"><span data-stu-id="8646b-310">Rebinds the data to the DataList.</span></span>

<span data-ttu-id="8646b-311">S に削除 ボタンを追加することで開始できるように、`ItemTemplate`します。</span><span class="sxs-lookup"><span data-stu-id="8646b-311">Let s start by adding a Delete button to the `ItemTemplate`.</span></span>

<span data-ttu-id="8646b-312">クリックすると、ボタンが`CommandName`編集、更新、またはキャンセル DataList s を発生させます`ItemCommand`イベントと共に追加のイベント (編集を使用する場合など、`EditCommand`もイベントが発生します)。</span><span class="sxs-lookup"><span data-stu-id="8646b-312">When clicked, a Button whose `CommandName` is Edit, Update, or Cancel raises the DataList s `ItemCommand` event along with an additional event (for example, when using Edit the `EditCommand` event is raised as well).</span></span> <span data-ttu-id="8646b-313">同様に、ボタン、linkbutton コントロール、または、DataList で ImageButton が`CommandName`原因を削除するプロパティを設定、`DeleteCommand`イベントを発生させる (と共に`ItemCommand`)。</span><span class="sxs-lookup"><span data-stu-id="8646b-313">Similarly, any Button, LinkButton, or ImageButton in the DataList whose `CommandName` property is set to Delete causes the `DeleteCommand` event to fire (along with `ItemCommand`).</span></span>

<span data-ttu-id="8646b-314">[編集] ボタンの横にある [削除] ボタンを追加、`ItemTemplate`設定、その`CommandName`プロパティを削除します。</span><span class="sxs-lookup"><span data-stu-id="8646b-314">Add a Delete button next to the Edit button in the `ItemTemplate`, setting its `CommandName` property to Delete.</span></span> <span data-ttu-id="8646b-315">このボタンを追加した後、DataList s が制御`ItemTemplate`宣言構文のようにする必要があります。</span><span class="sxs-lookup"><span data-stu-id="8646b-315">After adding this Button control your DataList s `ItemTemplate` declarative syntax should look like:</span></span>

[!code-aspx[Main](an-overview-of-editing-and-deleting-data-in-the-datalist-cs/samples/sample7.aspx)]

<span data-ttu-id="8646b-316">DataList s のイベント ハンドラーを次に、作成`DeleteCommand`イベントは、次のコードを使用します。</span><span class="sxs-lookup"><span data-stu-id="8646b-316">Next, create an event handler for the DataList s `DeleteCommand` event, using the following code:</span></span>

[!code-csharp[Main](an-overview-of-editing-and-deleting-data-in-the-datalist-cs/samples/sample8.cs)]

<span data-ttu-id="8646b-317">削除 ボタンをクリックするとポストバックが発生して、DataList s が発生した`DeleteCommand`イベント。</span><span class="sxs-lookup"><span data-stu-id="8646b-317">Clicking the Delete button causes a postback and fires the DataList s `DeleteCommand` event.</span></span> <span data-ttu-id="8646b-318">イベント ハンドラー、クリックされた製品 s で`ProductID`から値をアクセス、`DataKeys`コレクション。</span><span class="sxs-lookup"><span data-stu-id="8646b-318">In the event handler, the clicked product s `ProductID` value is accessed from the `DataKeys` collection.</span></span> <span data-ttu-id="8646b-319">呼び出すことにより、製品を削除する次に、`ProductsBLL`クラスの`DeleteProduct`メソッド。</span><span class="sxs-lookup"><span data-stu-id="8646b-319">Next, the product is deleted by calling the `ProductsBLL` class s `DeleteProduct` method.</span></span>

<span data-ttu-id="8646b-320">この製品を削除した後、DataList にデータをバインドし直すことが重要 (`DataList1.DataBind()`)、それ以外の場合、DataList は引き続き表示だけ削除された製品。</span><span class="sxs-lookup"><span data-stu-id="8646b-320">After deleting the product, it s important that we rebind the data to the DataList (`DataList1.DataBind()`), otherwise the DataList will continue to show the product that was just deleted.</span></span>

## <a name="summary"></a><span data-ttu-id="8646b-321">まとめ</span><span class="sxs-lookup"><span data-stu-id="8646b-321">Summary</span></span>

<span data-ttu-id="8646b-322">DataList は、ポイントがないし、編集および GridView によってサポートの削除 をクリックして、コードの短いビットを使用して拡張することをこれらの機能を含めます。</span><span class="sxs-lookup"><span data-stu-id="8646b-322">While the DataList lacks the point and click editing and deleting support enjoyed by the GridView, with a short bit of code it can be enhanced to include these features.</span></span> <span data-ttu-id="8646b-323">このチュートリアルでは、2 つの列を削除できませんでした、名前と価格を編集することが製品の一覧を作成する方法を説明しました。</span><span class="sxs-lookup"><span data-stu-id="8646b-323">In this tutorial we saw how to create a two-column listing of products that could be deleted and whose name and price could be edited.</span></span> <span data-ttu-id="8646b-324">適切な Web コントロールなどの問題は、編集および削除のサポートを追加、`ItemTemplate`と`EditItemTemplate`、対応するイベント ハンドラーの作成、読み取りユーザーが入力したとプライマリ キーの値、およびビジネスとやり取りロジック レイヤー。</span><span class="sxs-lookup"><span data-stu-id="8646b-324">Adding editing and deleting support is a matter of including the appropriate Web controls in the `ItemTemplate` and `EditItemTemplate`, creating the corresponding event handlers, reading the user-entered and primary key values, and interfacing with the Business Logic Layer.</span></span>

<span data-ttu-id="8646b-325">基本的な編集と削除、DataList に機能を追加したときより高度な機能が不足しています。</span><span class="sxs-lookup"><span data-stu-id="8646b-325">While we have added basic editing and deleting capabilities to the DataList, it lacks more advanced features.</span></span> <span data-ttu-id="8646b-326">などない入力フィールドの検証 - ユーザーが多すぎますの価格を入力した場合安価ですが、例外がスローされます`Decimal.Parse`すぎますを変換する際に高価な`Decimal`します。</span><span class="sxs-lookup"><span data-stu-id="8646b-326">For example, there is no input field validation - if a user enters a price of Too expensive, an exception will be thrown by `Decimal.Parse` when attempting to convert Too expensive into a `Decimal`.</span></span> <span data-ttu-id="8646b-327">同様に、ビジネス ロジックでデータまたはデータ アクセス層を更新中に問題がある場合、ユーザーは、標準エラー画面に表示されます。</span><span class="sxs-lookup"><span data-stu-id="8646b-327">Similarly, if there is a problem in updating the data at the Business Logic or Data Access Layers the user will be presented with the standard error screen.</span></span> <span data-ttu-id="8646b-328">任意並べ替えの削除 ボタンを確認するには、誤って削除した製品がすべてすぎる可能性があります。</span><span class="sxs-lookup"><span data-stu-id="8646b-328">Without any sort of confirmation on the Delete button, accidentally deleting a product is all too likely.</span></span>

<span data-ttu-id="8646b-329">今後のチュートリアルの編集のユーザーを向上させる方法を見ていきますが発生します。</span><span class="sxs-lookup"><span data-stu-id="8646b-329">In future tutorials we'll see how to improve the editing user experience.</span></span>

<span data-ttu-id="8646b-330">満足のプログラミングです。</span><span class="sxs-lookup"><span data-stu-id="8646b-330">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="8646b-331">執筆者紹介</span><span class="sxs-lookup"><span data-stu-id="8646b-331">About the Author</span></span>

<span data-ttu-id="8646b-332">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml)、7 つ受け取りますブックおよびの創設者の著者[4GuysFromRolla.com](http://www.4guysfromrolla.com)、Microsoft Web テクノロジと 1998 年から携わっています。</span><span class="sxs-lookup"><span data-stu-id="8646b-332">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="8646b-333">Scott は、フリーのコンサルタント、トレーナー、およびライターとして動作します。</span><span class="sxs-lookup"><span data-stu-id="8646b-333">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="8646b-334">最新の著書は[ *Sams 教える自分で ASP.NET 2.0 24 時間以内に*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)します。</span><span class="sxs-lookup"><span data-stu-id="8646b-334">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="8646b-335">彼に到達できる[mitchell@4GuysFromRolla.comします。](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="8646b-335">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="8646b-336">彼のブログにあるでまたは[ http://ScottOnWriting.NET](http://ScottOnWriting.NET)します。</span><span class="sxs-lookup"><span data-stu-id="8646b-336">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="8646b-337">特別なに感謝します。</span><span class="sxs-lookup"><span data-stu-id="8646b-337">Special Thanks To</span></span>

<span data-ttu-id="8646b-338">このチュートリアル シリーズは、多くの便利なレビュー担当者によってレビューされました。</span><span class="sxs-lookup"><span data-stu-id="8646b-338">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="8646b-339">このチュートリアルでは、潜在顧客レビュー担当者は、Zack Jones、Ken Pespisa、および Randy Schmidt でした。</span><span class="sxs-lookup"><span data-stu-id="8646b-339">Lead reviewers for this tutorial were Zack Jones, Ken Pespisa, and Randy Schmidt.</span></span> <span data-ttu-id="8646b-340">今後、MSDN の記事を確認したいですか。</span><span class="sxs-lookup"><span data-stu-id="8646b-340">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="8646b-341">場合は、筆者に[mitchell@4GuysFromRolla.comします。](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="8646b-341">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> [<span data-ttu-id="8646b-342">次へ</span><span class="sxs-lookup"><span data-stu-id="8646b-342">Next</span></span>](performing-batch-updates-cs.md)

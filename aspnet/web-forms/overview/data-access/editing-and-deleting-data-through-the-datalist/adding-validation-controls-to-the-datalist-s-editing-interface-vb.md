---
uid: web-forms/overview/data-access/editing-and-deleting-data-through-the-datalist/adding-validation-controls-to-the-datalist-s-editing-interface-vb
title: DataList の編集インターフェイスに検証コントロールを追加する (VB) |Microsoft Docs
author: rick-anderson
description: このチュートリアルでは、ユーザーがより安全に編集できるように、DataList の EditItemTemplate に検証コントロールを追加することがいかに簡単かを説明します。
ms.author: riande
ms.date: 10/30/2006
ms.assetid: 6b073fc6-524d-453d-be7c-0c30986de391
msc.legacyurl: /web-forms/overview/data-access/editing-and-deleting-data-through-the-datalist/adding-validation-controls-to-the-datalist-s-editing-interface-vb
msc.type: authoredcontent
ms.openlocfilehash: f952a7bb95e956a2ad935f8bdef5c3efa7437ecb
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 03/06/2020
ms.locfileid: "78480886"
---
# <a name="adding-validation-controls-to-the-datalists-editing-interface-vb"></a><span data-ttu-id="79775-103">DataList の編集インターフェイスに検証コントロールを追加する (VB)</span><span class="sxs-lookup"><span data-stu-id="79775-103">Adding Validation Controls to the DataList's Editing Interface (VB)</span></span>

<span data-ttu-id="79775-104">[Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="79775-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="79775-105">[サンプルアプリのダウンロード](https://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_39_VB.exe)または[PDF のダウンロード](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/datatutorial39vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="79775-105">[Download Sample App](https://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_39_VB.exe) or [Download PDF](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/datatutorial39vb1.pdf)</span></span>

> <span data-ttu-id="79775-106">このチュートリアルでは、簡単に編集できるユーザーインターフェイスを提供するために、DataList の EditItemTemplate に検証コントロールを追加することがいかに簡単かを説明します。</span><span class="sxs-lookup"><span data-stu-id="79775-106">In this tutorial we'll see how easy it is to add validation controls to the DataList's EditItemTemplate in order to provide a more foolproof editing user interface.</span></span>

## <a name="introduction"></a><span data-ttu-id="79775-107">はじめに</span><span class="sxs-lookup"><span data-stu-id="79775-107">Introduction</span></span>

<span data-ttu-id="79775-108">これまでの DataList 編集チュートリアルでは、製品名や負の価格などの無効なユーザー入力によって例外が発生した場合でも、DataLists 編集インターフェイスにプロアクティブなユーザー入力の検証が含まれていません。</span><span class="sxs-lookup"><span data-stu-id="79775-108">In the DataList editing tutorials thus far, the DataLists editing interfaces have not included any proactive user input validation even though invalid user input such as a missing product name or negative price results in an exception.</span></span> <span data-ttu-id="79775-109">前の[チュートリアル](handling-bll-and-dal-level-exceptions-vb.md)では、発生した例外に関する情報をキャッチして適切に表示するために、DataList s `UpdateCommand` イベントハンドラーに例外処理コードを追加する方法を説明しました。</span><span class="sxs-lookup"><span data-stu-id="79775-109">In the [preceding tutorial](handling-bll-and-dal-level-exceptions-vb.md) we examined how to add exception handling code to the DataList s `UpdateCommand` event handler in order to catch and gracefully display information about any exceptions that were raised.</span></span> <span data-ttu-id="79775-110">ただし、編集インターフェイスには、ユーザーがこのような無効なデータを最初に入力できないようにするための検証コントロールが含まれていることが理想的です。</span><span class="sxs-lookup"><span data-stu-id="79775-110">Ideally, however, the editing interface would include validation controls to prevent a user from entering such invalid data in the first place.</span></span>

<span data-ttu-id="79775-111">このチュートリアルでは、簡単に編集できるユーザーインターフェイスを提供するために、DataList s `EditItemTemplate` に検証コントロールを追加することがいかに簡単かを説明します。</span><span class="sxs-lookup"><span data-stu-id="79775-111">In this tutorial we'll see how easy it is to add validation controls to the DataList s `EditItemTemplate` in order to provide a more foolproof editing user interface.</span></span> <span data-ttu-id="79775-112">具体的には、このチュートリアルでは、前のチュートリアルで作成した例を使用して、適切な検証を含むように編集インターフェイスを強化します。</span><span class="sxs-lookup"><span data-stu-id="79775-112">Specifically, this tutorial takes the example created in the preceding tutorial and augments the editing interface to include appropriate validation.</span></span>

## <a name="step-1-replicating-the-example-fromhandling-bll--and-dal-level-exceptions"></a><span data-ttu-id="79775-113">手順 1:[BLL および DAL レベルの例外の処理](handling-bll-and-dal-level-exceptions-vb.md)から例をレプリケートする</span><span class="sxs-lookup"><span data-stu-id="79775-113">Step 1: Replicating the Example from[Handling BLL- and DAL-Level Exceptions](handling-bll-and-dal-level-exceptions-vb.md)</span></span>

<span data-ttu-id="79775-114">「 [BLL および DAL レベルの例外の処理](handling-bll-and-dal-level-exceptions-vb.md)」チュートリアルでは、2列の編集可能な DataList で製品の名前と価格を記載したページを作成しました。</span><span class="sxs-lookup"><span data-stu-id="79775-114">In the [Handling BLL- and DAL-Level Exceptions](handling-bll-and-dal-level-exceptions-vb.md) tutorial we created a page that listed the names and prices of the products in a two-column, editable DataList.</span></span> <span data-ttu-id="79775-115">このチュートリアルの目的は、DataList s 編集インターフェイスを拡張して検証コントロールを含めることです。</span><span class="sxs-lookup"><span data-stu-id="79775-115">Our goal for this tutorial is to augment the DataList s editing interface to include validation controls.</span></span> <span data-ttu-id="79775-116">特に、検証ロジックは次のようになります。</span><span class="sxs-lookup"><span data-stu-id="79775-116">In particular, our validation logic will:</span></span>

- <span data-ttu-id="79775-117">製品名を指定する必要があります</span><span class="sxs-lookup"><span data-stu-id="79775-117">Require that the product s name be provided</span></span>
- <span data-ttu-id="79775-118">価格に入力した値が有効な通貨書式であることを確認します。</span><span class="sxs-lookup"><span data-stu-id="79775-118">Ensure that the value entered for the price is a valid currency format</span></span>
- <span data-ttu-id="79775-119">負の `UnitPrice` 値が無効であるため、価格に入力した値が0以上であることを確認します。</span><span class="sxs-lookup"><span data-stu-id="79775-119">Ensure that the value entered for the price is greater than or equal to zero, since a negative `UnitPrice` value is illegal</span></span>

<span data-ttu-id="79775-120">前の例を補強して検証を含める方法を確認する前に、まず、`EditDeleteDataList` フォルダーの [`ErrorHandling.aspx`] ページから、このチュートリアルの `UIValidation.aspx`のページに例をレプリケートする必要があります。</span><span class="sxs-lookup"><span data-stu-id="79775-120">Before we can look at augmenting the previous example to include validation, we first need to replicate the example from the `ErrorHandling.aspx` page in the `EditDeleteDataList` folder to the page for this tutorial, `UIValidation.aspx`.</span></span> <span data-ttu-id="79775-121">これを実現するには、`ErrorHandling.aspx` ページの宣言型マークアップとソースコードの両方をコピーする必要があります。</span><span class="sxs-lookup"><span data-stu-id="79775-121">To achieve this we need to copy over both the `ErrorHandling.aspx` page s declarative markup and its source code.</span></span> <span data-ttu-id="79775-122">次の手順を実行して、最初に宣言マークアップをコピーします。</span><span class="sxs-lookup"><span data-stu-id="79775-122">First copy over the declarative markup by performing the following steps:</span></span>

1. <span data-ttu-id="79775-123">Visual Studio で [`ErrorHandling.aspx`] ページを開く</span><span class="sxs-lookup"><span data-stu-id="79775-123">Open the `ErrorHandling.aspx` page in Visual Studio</span></span>
2. <span data-ttu-id="79775-124">ページの宣言マークアップにアクセスします (ページの下部にある [ソース] ボタンをクリックします)。</span><span class="sxs-lookup"><span data-stu-id="79775-124">Go to the page s declarative markup (click on the Source button at the bottom of the page)</span></span>
3. <span data-ttu-id="79775-125">図1に示すように、`<asp:Content>` タグと `</asp:Content>` タグ (行 3 ~ 32) 内のテキストをコピーします。</span><span class="sxs-lookup"><span data-stu-id="79775-125">Copy the text within the `<asp:Content>` and `</asp:Content>` tags (lines 3 through 32), as shown in Figure 1.</span></span>

<span data-ttu-id="79775-126">[&lt;asp: Content&gt; コントロール内のテキストをコピー ![には](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image2.png)](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="79775-126">[![Copy the Text Within the &lt;asp:Content&gt; Control](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image2.png)](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image1.png)</span></span>

<span data-ttu-id="79775-127">**図 2**: `<asp:Content>` コントロール内のテキストをコピー[する (クリックすると、フルサイズの画像が表示](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image3.png)されます)</span><span class="sxs-lookup"><span data-stu-id="79775-127">**Figure 2**: Copy the Text Within the `<asp:Content>` Control ([Click to view full-size image](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image3.png))</span></span>

1. <span data-ttu-id="79775-128">[`UIValidation.aspx`] ページを開く</span><span class="sxs-lookup"><span data-stu-id="79775-128">Open the `UIValidation.aspx` page</span></span>
2. <span data-ttu-id="79775-129">ページの宣言型マークアップにアクセスする</span><span class="sxs-lookup"><span data-stu-id="79775-129">Go to the page s declarative markup</span></span>
3. <span data-ttu-id="79775-130">`<asp:Content>` コントロール内にテキストを貼り付けます。</span><span class="sxs-lookup"><span data-stu-id="79775-130">Paste the text within the `<asp:Content>` control.</span></span>

<span data-ttu-id="79775-131">ソースコードをコピーするには、[`ErrorHandling.aspx.vb`] ページを開き、`EditDeleteDataList_ErrorHandling` クラス*内*のテキストだけをコピーします。</span><span class="sxs-lookup"><span data-stu-id="79775-131">To copy over the source code, open the `ErrorHandling.aspx.vb` page and copy just the text *within* the `EditDeleteDataList_ErrorHandling` class.</span></span> <span data-ttu-id="79775-132">3つのイベントハンドラー (`Products_EditCommand`、`Products_CancelCommand`、`Products_UpdateCommand`) を `DisplayExceptionDetails` メソッドと共にコピーします。ただし、クラス宣言または `using` ステートメント**はコピーしないでください。**</span><span class="sxs-lookup"><span data-stu-id="79775-132">Copy the three event handlers (`Products_EditCommand`, `Products_CancelCommand`, and `Products_UpdateCommand`) along with the `DisplayExceptionDetails` method, but do **not** copy the class declaration or `using` statements.</span></span> <span data-ttu-id="79775-133">コピーしたテキストを `UIValidation.aspx.vb`の `EditDeleteDataList_UIValidation` クラス*内*に貼り付けます。</span><span class="sxs-lookup"><span data-stu-id="79775-133">Paste the copied text *within* the `EditDeleteDataList_UIValidation` class in `UIValidation.aspx.vb`.</span></span>

<span data-ttu-id="79775-134">コンテンツとコードを `ErrorHandling.aspx` から `UIValidation.aspx`に移動したら、ブラウザーでページをテストしてみましょう。</span><span class="sxs-lookup"><span data-stu-id="79775-134">After moving over the content and code from `ErrorHandling.aspx` to `UIValidation.aspx`, take a moment to test out the pages in a browser.</span></span> <span data-ttu-id="79775-135">同じ出力が表示され、これらの2つのページで同じ機能が使用されます (図2を参照)。</span><span class="sxs-lookup"><span data-stu-id="79775-135">You should see the same output and experience the same functionality in each of these two pages (see Figure 2).</span></span>

<span data-ttu-id="79775-136">[UIValidation .aspx ページを ![と、ErrorHandling の機能が模倣されます。](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image5.png)](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="79775-136">[![The UIValidation.aspx Page Mimics the Functionality in ErrorHandling.aspx](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image5.png)](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image4.png)</span></span>

<span data-ttu-id="79775-137">**図 2**: [`UIValidation.aspx`] ページでは `ErrorHandling.aspx` の機能を模倣しています ([クリックすると、フルサイズの画像が表示](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image6.png)されます)。</span><span class="sxs-lookup"><span data-stu-id="79775-137">**Figure 2**: The `UIValidation.aspx` Page Mimics the Functionality in `ErrorHandling.aspx` ([Click to view full-size image](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image6.png))</span></span>

## <a name="step-2-adding-the-validation-controls-to-the-datalist-s-edititemtemplate"></a><span data-ttu-id="79775-138">手順 2: DataList s EditItemTemplate に検証コントロールを追加する</span><span class="sxs-lookup"><span data-stu-id="79775-138">Step 2: Adding the Validation Controls to the DataList s EditItemTemplate</span></span>

<span data-ttu-id="79775-139">データ入力フォームを構築するときは、ユーザーが必要なフィールドを入力し、指定されたすべての入力が有効で適切に書式設定された値であることが重要です。</span><span class="sxs-lookup"><span data-stu-id="79775-139">When constructing data entry forms, it is important that users enter any required fields and that all their provided inputs are legal, properly-formatted values.</span></span> <span data-ttu-id="79775-140">ユーザーの入力が有効であることを確認するために、ASP.NET には、単一の入力 Web コントロールの値を検証するように設計された5つの組み込みの検証コントロールが用意されています。</span><span class="sxs-lookup"><span data-stu-id="79775-140">To help ensure that a user s inputs are valid, ASP.NET provides five built-in validation controls that are designed to validate the value of a single input Web control:</span></span>

- <span data-ttu-id="79775-141">[RequiredFieldValidator](https://msdn.microsoft.com/library/5hbw267h(VS.80).aspx)は、値が指定されていることを確認します。</span><span class="sxs-lookup"><span data-stu-id="79775-141">[RequiredFieldValidator](https://msdn.microsoft.com/library/5hbw267h(VS.80).aspx) ensures that a value has been provided</span></span>
- <span data-ttu-id="79775-142">[CompareValidator](https://msdn.microsoft.com/library/db330ayw(VS.80).aspx)は、別の Web コントロール値または定数値に対して値を検証したり、指定されたデータ型に対して値の形式が有効であることを確認したりします。</span><span class="sxs-lookup"><span data-stu-id="79775-142">[CompareValidator](https://msdn.microsoft.com/library/db330ayw(VS.80).aspx) validates a value against another Web control value or a constant value, or ensures that the value s format is legal for a specified data type</span></span>
- <span data-ttu-id="79775-143">[RangeValidator](https://msdn.microsoft.com/library/f70d09xt.aspx)値が値の範囲内にあることを確認します。</span><span class="sxs-lookup"><span data-stu-id="79775-143">[RangeValidator](https://msdn.microsoft.com/library/f70d09xt.aspx) ensures that a value is within a range of values</span></span>
- <span data-ttu-id="79775-144">[RegularExpressionValidator](https://msdn.microsoft.com/library/eahwtc9e.aspx) [正規表現](http://en.wikipedia.org/wiki/Regular_expression)に対して値を検証します。</span><span class="sxs-lookup"><span data-stu-id="79775-144">[RegularExpressionValidator](https://msdn.microsoft.com/library/eahwtc9e.aspx) validates a value against a [regular expression](http://en.wikipedia.org/wiki/Regular_expression)</span></span>
- <span data-ttu-id="79775-145">[CustomValidator](https://msdn.microsoft.com/library/9eee01cx(VS.80).aspx)カスタムのユーザー定義メソッドに対して値を検証します。</span><span class="sxs-lookup"><span data-stu-id="79775-145">[CustomValidator](https://msdn.microsoft.com/library/9eee01cx(VS.80).aspx) validates a value against a custom, user-defined method</span></span>

<span data-ttu-id="79775-146">これらの5つのコントロールの詳細については、「[インターフェイスの編集と挿入](../editing-inserting-and-deleting-data/adding-validation-controls-to-the-editing-and-inserting-interfaces-vb.md)」チュートリアルの「検証コントロールの追加」を参照してください。または、 [ASP.NET のクイックスタートチュートリアル](https://quickstarts.asp.net)の[「検証コントロール」セクション](https://quickstarts.asp.net/QuickStartv20/aspnet/doc/ctrlref/validation/default.aspx)をご覧ください。</span><span class="sxs-lookup"><span data-stu-id="79775-146">For more information on these five controls refer back to the [Adding Validation Controls to the Editing and Inserting Interfaces](../editing-inserting-and-deleting-data/adding-validation-controls-to-the-editing-and-inserting-interfaces-vb.md) tutorial or check out the [Validation Controls section](https://quickstarts.asp.net/QuickStartv20/aspnet/doc/ctrlref/validation/default.aspx) of the [ASP.NET Quickstart Tutorials](https://quickstarts.asp.net).</span></span>

<span data-ttu-id="79775-147">このチュートリアルでは、RequiredFieldValidator を使用して製品名の値が指定されていることを確認し、入力した価格の値が0以上で、有効な通貨の形式で表示されるように CompareValidator を使用する必要があります。</span><span class="sxs-lookup"><span data-stu-id="79775-147">For our tutorial we'll need to use a RequiredFieldValidator to ensure that a value for the product name has been supplied and a CompareValidator to ensure that the entered price has a value greater than or equal to 0 and is presented in a valid currency format.</span></span>

> [!NOTE]
> <span data-ttu-id="79775-148">ASP.NET 1.x には、これらと同じ5つの検証コントロールがありましたが、ASP.NET 2.0 にはいくつかの改善点が追加されており、Internet Explorer だけでなく、ページ上の検証コントロールをパーティション分割する機能も用意されています。検証グループ。</span><span class="sxs-lookup"><span data-stu-id="79775-148">While ASP.NET 1.x had these same five validation controls, ASP.NET 2.0 has added a number of improvements, the main two being client-side script support for browsers in addition to Internet Explorer and the ability to partition validation controls on a page into validation groups.</span></span> <span data-ttu-id="79775-149">2\.0 の新しい検証コントロール機能の詳細については、「 [ASP.NET 2.0 の検証コントロールの解説」](http://aspnet.4guysfromrolla.com/articles/112305-1.aspx)を参照してください。</span><span class="sxs-lookup"><span data-stu-id="79775-149">For more information on the new validation control features in 2.0, refer to [Dissecting the Validation Controls in ASP.NET 2.0](http://aspnet.4guysfromrolla.com/articles/112305-1.aspx).</span></span>

<span data-ttu-id="79775-150">まず、必要な検証コントロールを DataList s `EditItemTemplate`に追加します。</span><span class="sxs-lookup"><span data-stu-id="79775-150">Let s start by adding the necessary validation controls to the DataList s `EditItemTemplate`.</span></span> <span data-ttu-id="79775-151">このタスクを実行するには、デザイナーを使用して、DataList s スマートタグの [テンプレートの編集] リンクをクリックするか、宣言型の構文を使用します。</span><span class="sxs-lookup"><span data-stu-id="79775-151">This task can be performed through the Designer by clicking on the Edit Templates link from the DataList s smart tag, or through the declarative syntax.</span></span> <span data-ttu-id="79775-152">ここでは、デザインビューの [テンプレートの編集] オプションを使用してプロセスをステップ実行します。</span><span class="sxs-lookup"><span data-stu-id="79775-152">Let s step through the process using the Edit Templates option from the Design view.</span></span> <span data-ttu-id="79775-153">DataList s `EditItemTemplate`の編集を選択したら、[ツールボックス] から [RequiredFieldValidator] を追加し、[`ProductName`] ボックスの後に配置します。</span><span class="sxs-lookup"><span data-stu-id="79775-153">After choosing to edit the DataList s `EditItemTemplate`, add a RequiredFieldValidator by dragging it from the Toolbox into the template editing interface, placing it after the `ProductName` TextBox.</span></span>

<span data-ttu-id="79775-154">[RequiredFieldValidator を ProductName テキストボックスの後の EditItemTemplate に追加 ![には](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image8.png)](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="79775-154">[![Add a RequiredFieldValidator to the EditItemTemplate After the ProductName TextBox](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image8.png)](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image7.png)</span></span>

<span data-ttu-id="79775-155">**図 3**: `ProductName` テキストボックス `EditItemTemplate After` に RequiredFieldValidator を追加する ([クリックすると、フルサイズの画像が表示](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image9.png)されます)</span><span class="sxs-lookup"><span data-stu-id="79775-155">**Figure 3**: Add a RequiredFieldValidator to the `EditItemTemplate After` the `ProductName` TextBox ([Click to view full-size image](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image9.png))</span></span>

<span data-ttu-id="79775-156">すべての検証コントロールは、単一の ASP.NET Web コントロールの入力を検証することによって機能します。</span><span class="sxs-lookup"><span data-stu-id="79775-156">All validation controls work by validating the input of a single ASP.NET Web control.</span></span> <span data-ttu-id="79775-157">そのため、追加した RequiredFieldValidator が `ProductName` TextBox に対して検証する必要があることを示す必要があります。これを行うには、[検証コントロール s [`ControlToValidate`] プロパティ](https://msdn.microsoft.com/library/system.web.ui.webcontrols.basevalidator.controltovalidate(VS.80).aspx)を適切な Web コントロール (このインスタンスでは`ProductName`) の `ID` に設定します。</span><span class="sxs-lookup"><span data-stu-id="79775-157">Therefore, we need to indicate that the RequiredFieldValidator we just added should validate against the `ProductName` TextBox; this is done by setting the validation control s [`ControlToValidate` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.basevalidator.controltovalidate(VS.80).aspx) to the `ID` of the appropriate Web control (`ProductName`, in this instance).</span></span> <span data-ttu-id="79775-158">次に、 [`ErrorMessage` プロパティ](https://msdn.microsoft.com/library/system.web.ui.webcontrols.basevalidator.errormessage(VS.80).aspx)をに設定して、製品名と[`Text` プロパティ](https://msdn.microsoft.com/library/system.web.ui.webcontrols.basevalidator.text(VS.80).aspx)を \*に指定する必要があります。</span><span class="sxs-lookup"><span data-stu-id="79775-158">Next, set the [`ErrorMessage` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.basevalidator.errormessage(VS.80).aspx) to You must provide the product s name and the [`Text` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.basevalidator.text(VS.80).aspx) to \*.</span></span> <span data-ttu-id="79775-159">`Text` プロパティ値 (指定されている場合) は、検証が失敗した場合に検証コントロールによって表示されるテキストです。</span><span class="sxs-lookup"><span data-stu-id="79775-159">The `Text` property value, if provided, is the text that is displayed by the validation control if the validation fails.</span></span> <span data-ttu-id="79775-160">必須である `ErrorMessage` プロパティ値は、ValidationSummary コントロールによって使用されます。`Text` プロパティ値を省略した場合、無効な入力に対して検証コントロールによって `ErrorMessage` プロパティ値が表示されます。</span><span class="sxs-lookup"><span data-stu-id="79775-160">The `ErrorMessage` property value, which is required, is used by the ValidationSummary control; if the `Text` property value is omitted, the `ErrorMessage` property value is displayed by the validation control on invalid input.</span></span>

<span data-ttu-id="79775-161">RequiredFieldValidator の3つのプロパティを設定した後、画面は図4のようになります。</span><span class="sxs-lookup"><span data-stu-id="79775-161">After setting these three properties of the RequiredFieldValidator, your screen should look similar to Figure 4.</span></span>

<span data-ttu-id="79775-162">[RequiredFieldValidator s ControlToValidate、ErrorMessage、および Text プロパティを設定 ![には](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image11.png)](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="79775-162">[![Set the RequiredFieldValidator s ControlToValidate, ErrorMessage, and Text Properties](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image11.png)](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image10.png)</span></span>

<span data-ttu-id="79775-163">**図 4**: RequiredFieldValidator s `ControlToValidate`、`ErrorMessage`、および `Text` の各プロパティを設定[する (クリックすると、フルサイズの画像が表示](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image12.png)されます)</span><span class="sxs-lookup"><span data-stu-id="79775-163">**Figure 4**: Set the RequiredFieldValidator s `ControlToValidate`, `ErrorMessage`, and `Text` Properties ([Click to view full-size image](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image12.png))</span></span>

<span data-ttu-id="79775-164">`EditItemTemplate`に追加された RequiredFieldValidator を使用して、製品の [価格] ボックスに必要な検証を追加します。</span><span class="sxs-lookup"><span data-stu-id="79775-164">With the RequiredFieldValidator added to the `EditItemTemplate`, all that remains is to add the necessary validation for the product s price TextBox.</span></span> <span data-ttu-id="79775-165">`UnitPrice` はレコードを編集するときには省略可能であるため、RequiredFieldValidator を追加する必要はありません。</span><span class="sxs-lookup"><span data-stu-id="79775-165">Since the `UnitPrice` is optional when editing a record, we don t need to add a RequiredFieldValidator.</span></span> <span data-ttu-id="79775-166">ただし、CompareValidator を追加して、指定されている場合は、`UnitPrice`が通貨として正しく書式設定され、0以上であることを確認する必要があります。</span><span class="sxs-lookup"><span data-stu-id="79775-166">We do, however, need to add a CompareValidator to ensure that the `UnitPrice`, if supplied, is properly formatted as a currency and is greater than or equal to 0.</span></span>

<span data-ttu-id="79775-167">`EditItemTemplate` に CompareValidator を追加し、その `ControlToValidate` プロパティを `UnitPrice`に設定します。その `ErrorMessage` プロパティには、0以上の値を指定する必要があります。また、通貨記号を含めることはできず、`Text` にはその \*プロパティを指定する必要があります。</span><span class="sxs-lookup"><span data-stu-id="79775-167">Add the CompareValidator into the `EditItemTemplate` and set its `ControlToValidate` property to `UnitPrice`, its `ErrorMessage` property to The price must be greater than or equal to zero and cannot include the currency symbol, and its `Text` property to \*.</span></span> <span data-ttu-id="79775-168">`UnitPrice` 値が0以上である必要があることを示すには、CompareValidator s [`Operator` プロパティ](https://msdn.microsoft.com/library/system.web.ui.webcontrols.comparevalidator.operator(VS.80).aspx)を `GreaterThanEqual`に、その[`ValueToCompare` プロパティ](https://msdn.microsoft.com/library/system.web.ui.webcontrols.comparevalidator.valuetocompare(VS.80).aspx)を0に設定し、その[`Type` プロパティ](https://msdn.microsoft.com/library/system.web.ui.webcontrols.basecomparevalidator.type.aspx)を `Currency`に設定します。</span><span class="sxs-lookup"><span data-stu-id="79775-168">To indicate that the `UnitPrice` value must be greater than or equal to 0, set the CompareValidator s [`Operator` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.comparevalidator.operator(VS.80).aspx) to `GreaterThanEqual`, its [`ValueToCompare` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.comparevalidator.valuetocompare(VS.80).aspx) to 0, and its [`Type` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.basecomparevalidator.type.aspx) to `Currency`.</span></span>

<span data-ttu-id="79775-169">これら2つの検証コントロールを追加した後、DataList s `EditItemTemplate` s 宣言構文は次のようになります。</span><span class="sxs-lookup"><span data-stu-id="79775-169">After adding these two validation controls, the DataList s `EditItemTemplate` s declarative syntax should look similar to the following:</span></span>

[!code-aspx[Main](adding-validation-controls-to-the-datalist-s-editing-interface-vb/samples/sample1.aspx)]

<span data-ttu-id="79775-170">これらの変更を行った後、ブラウザーでページを開きます。</span><span class="sxs-lookup"><span data-stu-id="79775-170">After making these changes, open the page in a browser.</span></span> <span data-ttu-id="79775-171">製品を編集するときに名前を省略したり、無効な価格値を入力しようとしたりすると、テキストボックスの横にアスタリスクが表示されます。</span><span class="sxs-lookup"><span data-stu-id="79775-171">If you attempt to omit the name or enter an invalid price value when editing a product, an asterisk appears next to the textbox.</span></span> <span data-ttu-id="79775-172">図5に示すように、$19.95 などの通貨記号を含む価格値は無効と見なされます。</span><span class="sxs-lookup"><span data-stu-id="79775-172">As Figure 5 shows, a price value that includes the currency symbol such as $19.95 is considered invalid.</span></span> <span data-ttu-id="79775-173">CompareValidator s `Currency` `Type` では、桁区切り記号 (カルチャの設定によってはコンマやピリオドなど) と先頭の正符号または負符号を使用できますが、通貨記号は許可*されません*。</span><span class="sxs-lookup"><span data-stu-id="79775-173">The CompareValidator s `Currency` `Type` allows for digit separators (such as commas or periods, depending on the culture settings) and a leading plus or minus sign, but does *not* permit a currency symbol.</span></span> <span data-ttu-id="79775-174">この動作は、現在、編集インターフェイスが通貨書式を使用して `UnitPrice` を表示するときに、ユーザーによって変更される可能性があります。</span><span class="sxs-lookup"><span data-stu-id="79775-174">This behavior may perplex users as the editing interface currently renders the `UnitPrice` using the currency format.</span></span>

<span data-ttu-id="79775-175">[無効な入力のテキストボックスの横にアスタリスクが表示され ![](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image14.png)](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="79775-175">[![An Asterisk Appears Next to the Textboxes with Invalid Input](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image14.png)](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image13.png)</span></span>

<span data-ttu-id="79775-176">**図 5**: 無効な入力のテキストボックスの横にアスタリスクが表示される ([クリックすると、フルサイズの画像が表示](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image15.png)されます)</span><span class="sxs-lookup"><span data-stu-id="79775-176">**Figure 5**: An Asterisk Appears Next to the Textboxes with Invalid Input ([Click to view full-size image](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image15.png))</span></span>

<span data-ttu-id="79775-177">検証はそのままの状態で機能しますが、ユーザーはレコードを編集するときに通貨記号を手動で削除する必要があります。これは許容できません。</span><span class="sxs-lookup"><span data-stu-id="79775-177">While the validation works as-is, the user has to manually remove the currency symbol when editing a record, which is not acceptable.</span></span> <span data-ttu-id="79775-178">さらに、編集インターフェイスに無効な入力がある場合、[Update] ボタンと [Cancel] ボタンをクリックしても、ポストバックが呼び出されます。</span><span class="sxs-lookup"><span data-stu-id="79775-178">Moreover, if there are invalid inputs in the editing interface neither the Update nor Cancel buttons, when clicked, will invoke a postback.</span></span> <span data-ttu-id="79775-179">[キャンセル] ボタンは、ユーザーの入力が有効であるかどうかに関係なく、DataList を編集前の状態に戻すのが理想的です。</span><span class="sxs-lookup"><span data-stu-id="79775-179">Ideally, the Cancel button would return the DataList to its pre-editing state regardless of the validity of the user s inputs.</span></span> <span data-ttu-id="79775-180">また、DataList s `UpdateCommand` イベントハンドラーで製品情報を更新する前に、ページのデータが有効であることを確認する必要があります。これは、ブラウザーが JavaScript をサポートしていないか、サポートが無効になっているユーザーが、検証コントロールのクライアント側ロジックをバイパスできるためです。</span><span class="sxs-lookup"><span data-stu-id="79775-180">Also, we need to ensure that the page s data is valid before updating the product information in the DataList s `UpdateCommand` event handler, as the validation controls client-side logic can be bypassed by users whose browsers either don t support JavaScript or have its support disabled.</span></span>

## <a name="removing-the-currency-symbol-from-the-edititemtemplate-s-unitprice-textbox"></a><span data-ttu-id="79775-181">EditItemTemplate s UnitPrice テキストボックスから通貨記号を削除する</span><span class="sxs-lookup"><span data-stu-id="79775-181">Removing the Currency Symbol from the EditItemTemplate s UnitPrice TextBox</span></span>

<span data-ttu-id="79775-182">CompareValidator s `Currency``Type`を使用する場合、検証対象の入力に通貨記号を含めることはできません。</span><span class="sxs-lookup"><span data-stu-id="79775-182">When using the CompareValidator s `Currency``Type`, the input being validated must not include any currency symbols.</span></span> <span data-ttu-id="79775-183">このようなシンボルが存在する場合、CompareValidator は入力を無効としてマークします。</span><span class="sxs-lookup"><span data-stu-id="79775-183">The presence of such symbols causes the CompareValidator to mark the input as invalid.</span></span> <span data-ttu-id="79775-184">ただし、現在の編集インターフェイスには、`UnitPrice` テキストボックスに通貨記号が含まれています。つまり、ユーザーは、変更を保存する前に通貨記号を明示的に削除する必要があります。</span><span class="sxs-lookup"><span data-stu-id="79775-184">However, our editing interface currently includes a currency symbol in the `UnitPrice` TextBox, meaning the user must explicitly remove the currency symbol before saving their changes.</span></span> <span data-ttu-id="79775-185">これを解決するには、次の3つのオプションがあります。</span><span class="sxs-lookup"><span data-stu-id="79775-185">To remedy this we have three options:</span></span>

1. <span data-ttu-id="79775-186">`UnitPrice` テキストボックスの値が通貨として書式設定されないように `EditItemTemplate` を構成します。</span><span class="sxs-lookup"><span data-stu-id="79775-186">Configure the `EditItemTemplate` so that the `UnitPrice` TextBox value is not formatted as a currency.</span></span>
2. <span data-ttu-id="79775-187">ユーザーが通貨記号を入力できるようにするには、CompareValidator を削除し、適切に書式設定された通貨値を確認する RegularExpressionValidator に置き換えます。</span><span class="sxs-lookup"><span data-stu-id="79775-187">Allow the user to enter a currency symbol by removing the CompareValidator and replacing it with a RegularExpressionValidator that checks for a properly formatted currency value.</span></span> <span data-ttu-id="79775-188">ここでの課題は、通貨の値を検証する正規表現が CompareValidator ほど単純ではなく、カルチャの設定を組み込む必要がある場合にコードを記述する必要があることです。</span><span class="sxs-lookup"><span data-stu-id="79775-188">The challenge here is that the regular expression to validate a currency value is not as straightforward as the CompareValidator and would require writing code if we wanted to incorporate culture settings.</span></span>
3. <span data-ttu-id="79775-189">検証コントロールを完全に削除し、GridView s `RowUpdating` イベントハンドラーでカスタムのサーバー側検証ロジックに依存します。</span><span class="sxs-lookup"><span data-stu-id="79775-189">Remove the validation control altogether and rely on custom server-side validation logic in the GridView s `RowUpdating` event handler.</span></span>

<span data-ttu-id="79775-190">このチュートリアルでは、オプション1を使ってみましょう。</span><span class="sxs-lookup"><span data-stu-id="79775-190">Let s go with option 1 for this tutorial.</span></span> <span data-ttu-id="79775-191">現在、`UnitPrice` は、`EditItemTemplate`: `<%# Eval("UnitPrice", "{0:c}") %>`のテキストボックスのデータバインド式により、通貨値として書式設定されます。</span><span class="sxs-lookup"><span data-stu-id="79775-191">Currently the `UnitPrice` is formatted as a currency value due to the databinding expression for the TextBox in the `EditItemTemplate`: `<%# Eval("UnitPrice", "{0:c}") %>`.</span></span> <span data-ttu-id="79775-192">`Eval` ステートメントを `Eval("UnitPrice", "{0:n2}")`に変更します。これにより、結果が2桁の精度で数値として書式設定されます。</span><span class="sxs-lookup"><span data-stu-id="79775-192">Change the `Eval` statement to `Eval("UnitPrice", "{0:n2}")`, which formats the result as a number with two digits of precision.</span></span> <span data-ttu-id="79775-193">これを行うには、宣言型の構文を使用するか、DataList s `EditItemTemplate`の [`UnitPrice`] ボックスの [連結の編集] リンクをクリックします。</span><span class="sxs-lookup"><span data-stu-id="79775-193">This can be done directly through the declarative syntax or by clicking on the Edit DataBindings link from the `UnitPrice` TextBox in the DataList s `EditItemTemplate`.</span></span>

<span data-ttu-id="79775-194">この変更により、編集インターフェイスの書式設定された価格には、桁区切り記号としてコンマが、小数点区切り文字としてピリオドが付きますが、通貨記号はオフのままになります。</span><span class="sxs-lookup"><span data-stu-id="79775-194">With this change, the formatted price in the editing interface includes commas as the group separator and a period as the decimal separator, but leaves off the currency symbol.</span></span>

> [!NOTE]
> <span data-ttu-id="79775-195">編集可能なインターフェイスから通貨書式を削除する場合は、テキストボックスの外側に通貨記号をテキストとして配置すると便利です。</span><span class="sxs-lookup"><span data-stu-id="79775-195">When removing the currency format from the editable interface, I find it helpful to put the currency symbol as text outside the TextBox.</span></span> <span data-ttu-id="79775-196">これは、ユーザーが通貨記号を指定する必要がないことを示すヒントとして機能します。</span><span class="sxs-lookup"><span data-stu-id="79775-196">This serves as a hint to the user that they do not need to provide the currency symbol.</span></span>

## <a name="fixing-the-cancel-button"></a><span data-ttu-id="79775-197">[キャンセル] ボタンの修正</span><span class="sxs-lookup"><span data-stu-id="79775-197">Fixing the Cancel Button</span></span>

<span data-ttu-id="79775-198">既定では、検証 Web コントロールは、クライアント側で検証を実行する JavaScript を生成します。</span><span class="sxs-lookup"><span data-stu-id="79775-198">By default, the validation Web controls emit JavaScript to perform validation on the client-side.</span></span> <span data-ttu-id="79775-199">ボタン、LinkButton、または ImageButton がクリックされると、ポストバックが発生する前に、ページの検証コントロールがクライアント側でチェックされます。</span><span class="sxs-lookup"><span data-stu-id="79775-199">When a Button, LinkButton, or ImageButton is clicked, the validation controls on the page are checked on the client-side before the postback occurs.</span></span> <span data-ttu-id="79775-200">無効なデータがある場合、ポストバックはキャンセルされます。</span><span class="sxs-lookup"><span data-stu-id="79775-200">If there is any invalid data, the postback is cancelled.</span></span> <span data-ttu-id="79775-201">ただし、特定のボタンについては、データの有効性が問題でになることがあります。このような場合、データが無効であるためにポストバックがキャンセルされることは厄介です。</span><span class="sxs-lookup"><span data-stu-id="79775-201">For certain Buttons, though, the validity of the data might be immaterial; in such a case, having the postback cancelled due to invalid data is a nuisance.</span></span>

<span data-ttu-id="79775-202">このような場合は、[キャンセル] ボタンが使用されます。</span><span class="sxs-lookup"><span data-stu-id="79775-202">The Cancel button is such an example.</span></span> <span data-ttu-id="79775-203">たとえば、製品名を省略した場合など、ユーザーが無効なデータを入力した後、製品を保存しないことを決定し、[キャンセル] ボタンをクリックしたとします。</span><span class="sxs-lookup"><span data-stu-id="79775-203">Imagine that a user enters invalid data, such as omitting the product s name, and then decides she doesn t want to save the product after all and hits the Cancel button.</span></span> <span data-ttu-id="79775-204">現在、[キャンセル] ボタンをクリックすると、ページの検証コントロールがトリガーされ、製品名がないことを報告し、ポストバックを防止できます。</span><span class="sxs-lookup"><span data-stu-id="79775-204">Currently, the Cancel button triggers the validation controls on the page, which report that the product name is missing and prevent the postback.</span></span> <span data-ttu-id="79775-205">編集プロセスをキャンセルするには、ユーザーが `ProductName` テキストボックスにテキストを入力する必要があります。</span><span class="sxs-lookup"><span data-stu-id="79775-205">Our user has to type some text into the `ProductName` TextBox just to cancel out of the editing process.</span></span>

<span data-ttu-id="79775-206">幸いにも、ボタン、LinkButton、および ImageButton には、ボタンをクリックして検証ロジックを開始するかどうかを示す[`CausesValidation` プロパティ](https://msdn.microsoft.com/library/system.web.ui.webcontrols.button.causesvalidation.aspx)があります (既定では `True`)。</span><span class="sxs-lookup"><span data-stu-id="79775-206">Fortunately, the Button, LinkButton, and ImageButton have a [`CausesValidation` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.button.causesvalidation.aspx) that can indicate whether or not clicking the Button should initiate the validation logic (defaults to `True`).</span></span> <span data-ttu-id="79775-207">Cancel ボタン s `CausesValidation` プロパティを `False`に設定します。</span><span class="sxs-lookup"><span data-stu-id="79775-207">Set the Cancel Button s `CausesValidation` property to `False`.</span></span>

## <a name="ensuring-the-inputs-are-valid-in-the-updatecommand-event-handler"></a><span data-ttu-id="79775-208">UpdateCommand イベントハンドラーで入力が有効であることを確認する</span><span class="sxs-lookup"><span data-stu-id="79775-208">Ensuring the Inputs are Valid in the UpdateCommand Event Handler</span></span>

<span data-ttu-id="79775-209">検証コントロールによって出力されるクライアント側スクリプトにより、ユーザーが無効な入力を入力した場合、検証コントロールは、`CausesValidation` プロパティが `True` (既定値) になっているボタン、LinkButton、または ImageButton コントロールによって開始されたポストバックをキャンセルします。</span><span class="sxs-lookup"><span data-stu-id="79775-209">Due to the client-side script emitted by the validation controls, if a user enters invalid input the validation controls cancel any postbacks initiated by Button, LinkButton, or ImageButton controls whose `CausesValidation` properties are `True` (the default).</span></span> <span data-ttu-id="79775-210">ただし、ユーザーが時代遅れブラウザーを使用してアクセスしている場合、または JavaScript のサポートが無効になっている場合は、クライアント側の検証チェックは実行されません。</span><span class="sxs-lookup"><span data-stu-id="79775-210">However, if a user is visiting with an antiquated browser or one whose JavaScript support has been disabled, the client-side validation checks will not execute.</span></span>

<span data-ttu-id="79775-211">すべての ASP.NET 検証コントロールは、ポストバックの直後に検証ロジックを繰り返し、 [`Page.IsValid` プロパティ](https://msdn.microsoft.com/library/system.web.ui.page.isvalid.aspx)を使用してページの入力の全体的な有効性を報告します。</span><span class="sxs-lookup"><span data-stu-id="79775-211">All of the ASP.NET validation controls repeat their validation logic immediately upon postback and report the overall validity of the page s inputs via the [`Page.IsValid` property](https://msdn.microsoft.com/library/system.web.ui.page.isvalid.aspx).</span></span> <span data-ttu-id="79775-212">ただし、`Page.IsValid`の値に基づいて、ページフローが中断または停止されることはありません。</span><span class="sxs-lookup"><span data-stu-id="79775-212">However, the page flow is not interrupted or stopped in any way based on the value of `Page.IsValid`.</span></span> <span data-ttu-id="79775-213">開発者は、有効な入力データを想定したコードに進む前に、`Page.IsValid` プロパティの値が `True` であることを確認する必要があります。</span><span class="sxs-lookup"><span data-stu-id="79775-213">As developers, it is our responsibility to ensure that the `Page.IsValid` property has a value of `True` before proceeding with code that assumes valid input data.</span></span>

<span data-ttu-id="79775-214">ユーザーが JavaScript を無効にしている場合は、ページにアクセスして、製品を編集し、価格の値を大きくしてから、[更新] ボタンをクリックすると、クライアント側の検証がバイパスされ、ポストバックが議論されます。</span><span class="sxs-lookup"><span data-stu-id="79775-214">If a user has JavaScript disabled, visits our page, edits a product, enters a price value of Too expensive, and clicks the Update button, the client-side validation will be bypassed and a postback will ensue.</span></span> <span data-ttu-id="79775-215">ポストバック時に、ASP.NET ページ s `UpdateCommand` イベントハンドラーが実行され、`Decimal`に対して負荷が高すぎると、例外が発生します。</span><span class="sxs-lookup"><span data-stu-id="79775-215">On postback, the ASP.NET page s `UpdateCommand` event handler executes and an exception is raised when attempting to parse Too expensive to a `Decimal`.</span></span> <span data-ttu-id="79775-216">例外処理があるため、このような例外は適切に処理されますが、最初の場所で無効なデータが処理されるのを防ぐことができるのは、`Page.IsValid` の値が `True`の場合に `UpdateCommand` イベントハンドラーを続行することだけです。</span><span class="sxs-lookup"><span data-stu-id="79775-216">Since we have exception handling, such an exception will be handled gracefully, but we could prevent the invalid data from slipping through in the first place by only proceeding with the `UpdateCommand` event handler if `Page.IsValid` has a value of `True`.</span></span>

<span data-ttu-id="79775-217">`UpdateCommand` イベントハンドラーの先頭に、`Try` ブロックの直前に次のコードを追加します。</span><span class="sxs-lookup"><span data-stu-id="79775-217">Add the following code to the start of the `UpdateCommand` event handler, immediately before the `Try` block:</span></span>

[!code-vb[Main](adding-validation-controls-to-the-datalist-s-editing-interface-vb/samples/sample2.vb)]

<span data-ttu-id="79775-218">この追加により、送信されたデータが有効である場合にのみ、製品が更新されるようになります。</span><span class="sxs-lookup"><span data-stu-id="79775-218">With this addition, the product will attempt to be updated only if the submitted data is valid.</span></span> <span data-ttu-id="79775-219">ほとんどのユーザーは、検証コントロールのクライアント側スクリプトによって無効なデータをポストバックすることはできませんが、ブラウザーが JavaScript をサポートしていないユーザーまたは JavaScript のサポートが無効になっているユーザーは、クライアント側のチェックをバイパスして、無効なデータを送信できます。</span><span class="sxs-lookup"><span data-stu-id="79775-219">Most users won't be able to postback invalid data due to the validation controls client-side scripts, but users whose browsers don t support JavaScript or that have JavaScript support disabled, can bypass the client-side checks and submit invalid data.</span></span>

> [!NOTE]
> <span data-ttu-id="79775-220">ずる賢い reader は、GridView を使用してデータを更新するときに、ページの分離コードクラスの `Page.IsValid` プロパティを明示的に確認する必要がないことを思い出しています。</span><span class="sxs-lookup"><span data-stu-id="79775-220">The astute reader will recall that when updating data with the GridView, we didn't need to explicitly check the `Page.IsValid` property in our page s code-behind class.</span></span> <span data-ttu-id="79775-221">これは、GridView が `Page.IsValid` プロパティを調べ、`True`の値を返す場合にのみ更新のみを処理するためです。</span><span class="sxs-lookup"><span data-stu-id="79775-221">This is because the GridView consults the `Page.IsValid` property for us and only proceeds with the update only if it returns a value of `True`.</span></span>

## <a name="step-3-summarizing-data-entry-problems"></a><span data-ttu-id="79775-222">手順 3: データ入力の問題の概要</span><span class="sxs-lookup"><span data-stu-id="79775-222">Step 3: Summarizing Data Entry Problems</span></span>

<span data-ttu-id="79775-223">5つの検証コントロールに加えて、ASP.NET には[Validationsummary コントロール](https://msdn.microsoft.com/library/f9h59855(VS.80).aspx)が含まれています。このコントロールには、無効なデータを検出した検証コントロールの `ErrorMessage` が表示されます。</span><span class="sxs-lookup"><span data-stu-id="79775-223">In addition to the five validation controls, ASP.NET includes the [ValidationSummary control](https://msdn.microsoft.com/library/f9h59855(VS.80).aspx), which displays the `ErrorMessage` s of those validation controls that detected invalid data.</span></span> <span data-ttu-id="79775-224">この概要データは、web ページ上のテキストとして、またはモーダルのクライアント側のメッセージボックスを使用して表示できます。</span><span class="sxs-lookup"><span data-stu-id="79775-224">This summary data can be displayed as text on the web page or through a modal, client-side messagebox.</span></span> <span data-ttu-id="79775-225">このチュートリアルを強化し、検証の問題を要約したクライアント側のメッセージボックスを含めるようにしてみましょう。</span><span class="sxs-lookup"><span data-stu-id="79775-225">Let s enhance this tutorial to include a client-side messagebox summarizing any validation problems.</span></span>

<span data-ttu-id="79775-226">これを実現するには、[ツールボックス] から [ValidationSummary] コントロールをデザイナーにドラッグします。</span><span class="sxs-lookup"><span data-stu-id="79775-226">To accomplish this, drag a ValidationSummary control from the Toolbox onto the Designer.</span></span> <span data-ttu-id="79775-227">ValidationSummary コントロールの場所は、メッセージボックスとして概要のみを表示するように構成するため、実際には問題になりません。</span><span class="sxs-lookup"><span data-stu-id="79775-227">The location of the ValidationSummary control doesn t really matter, since we re going to configure it to only display the summary as a messagebox.</span></span> <span data-ttu-id="79775-228">コントロールを追加した後、その[`ShowSummary` プロパティ](https://msdn.microsoft.com/library/system.web.ui.webcontrols.validationsummary.showsummary(VS.80).aspx)を `False` に設定し、その[`ShowMessageBox` プロパティ](https://msdn.microsoft.com/library/system.web.ui.webcontrols.validationsummary.showmessagebox(VS.80).aspx)を `True`に設定します。</span><span class="sxs-lookup"><span data-stu-id="79775-228">After adding the control, set its [`ShowSummary` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.validationsummary.showsummary(VS.80).aspx) to `False` and its [`ShowMessageBox` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.validationsummary.showmessagebox(VS.80).aspx) to `True`.</span></span> <span data-ttu-id="79775-229">この追加により、クライアント側のメッセージボックスに検証エラーが集約されます (図6を参照)。</span><span class="sxs-lookup"><span data-stu-id="79775-229">With this addition, any validation errors are summarized in a client-side messagebox (see Figure 6).</span></span>

<span data-ttu-id="79775-230">[検証エラーがクライアント側のメッセージボックスにまとめられている ![](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image17.png)](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="79775-230">[![The Validation Errors are Summarized in a Client-Side Messagebox](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image17.png)](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image16.png)</span></span>

<span data-ttu-id="79775-231">**図 6**: 検証エラーがクライアント側のメッセージボックスにまとめられている ([クリックしてフルサイズのイメージを表示する](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="79775-231">**Figure 6**: The Validation Errors are Summarized in a Client-Side Messagebox ([Click to view full-size image](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image18.png))</span></span>

## <a name="summary"></a><span data-ttu-id="79775-232">まとめ</span><span class="sxs-lookup"><span data-stu-id="79775-232">Summary</span></span>

<span data-ttu-id="79775-233">このチュートリアルでは、検証コントロールを使用して、ユーザーの入力が有効であることを事前に確認してから、更新ワークフローでの使用を試行する方法について説明しました。</span><span class="sxs-lookup"><span data-stu-id="79775-233">In this tutorial we saw how to reduce the likelihood of exceptions by using validation controls to proactively ensure that our users inputs are valid before attempting to use them in the updating workflow.</span></span> <span data-ttu-id="79775-234">ASP.NET には、特定の Web コントロールの入力を検査し、入力の有効性を報告するように設計された5つの検証 Web コントロールが用意されています。</span><span class="sxs-lookup"><span data-stu-id="79775-234">ASP.NET provides five validation Web controls that are designed to inspect a particular Web control s input and report back on the input s validity.</span></span> <span data-ttu-id="79775-235">このチュートリアルでは、RequiredFieldValidator と CompareValidator の2つのコントロールを使用して、製品名が指定されていること、および価格の値が0以上の通貨形式であることを確認しました。</span><span class="sxs-lookup"><span data-stu-id="79775-235">In this tutorial we used two of those five controls the RequiredFieldValidator and the CompareValidator to ensure that the product s name was supplied and that the price had a currency format with a value greater than or equal to zero.</span></span>

<span data-ttu-id="79775-236">DataList の編集インターフェイスに検証コントロールを追加するのは、ツールボックスから `EditItemTemplate` にドラッグし、いくつかのプロパティを設定するだけです。</span><span class="sxs-lookup"><span data-stu-id="79775-236">Adding validation controls to the DataList s editing interface is as simple as dragging them onto the `EditItemTemplate` from the Toolbox and setting a handful of properties.</span></span> <span data-ttu-id="79775-237">既定では、検証コントロールはクライアント側の検証スクリプトを自動的に生成します。また、ポストバック時にサーバー側の検証も行い、累積結果を `Page.IsValid` プロパティに格納します。</span><span class="sxs-lookup"><span data-stu-id="79775-237">By default, the validation controls automatically emit client-side validation script; they also provide server-side validation on postback, storing the cumulative result in the `Page.IsValid` property.</span></span> <span data-ttu-id="79775-238">ボタン、LinkButton、または ImageButton がクリックされたときにクライアント側の検証をバイパスするには、[`CausesValidation`] プロパティを `False`に設定します。</span><span class="sxs-lookup"><span data-stu-id="79775-238">To bypass the client-side validation when a Button, LinkButton, or ImageButton is clicked, set the button s `CausesValidation` property to `False`.</span></span> <span data-ttu-id="79775-239">また、ポストバック時に送信されたデータを使用してタスクを実行する前に、`Page.IsValid` プロパティが `True`を返していることを確認してください。</span><span class="sxs-lookup"><span data-stu-id="79775-239">Also, before performing any tasks with the data submitted on postback, ensure that the `Page.IsValid` property returns `True`.</span></span>

<span data-ttu-id="79775-240">これまでに説明したすべての DataList 編集チュートリアルでは、製品名のテキストボックスと価格について、非常に単純な編集インターフェイスが用意されています。</span><span class="sxs-lookup"><span data-stu-id="79775-240">All of the DataList editing tutorials we ve examined so far have had very simple editing interfaces a TextBox for the product s name and another for the price.</span></span> <span data-ttu-id="79775-241">ただし、編集インターフェイスには、DropDownLists、カレンダー、Radiobutton、Checkbox など、さまざまな Web コントロールを混在させることができます。</span><span class="sxs-lookup"><span data-stu-id="79775-241">The editing interface, however, can contain a mix of different Web controls, such as DropDownLists, Calendars, RadioButtons, CheckBoxes, and so on.</span></span> <span data-ttu-id="79775-242">次のチュートリアルでは、さまざまな Web コントロールを使用するインターフェイスの構築について説明します。</span><span class="sxs-lookup"><span data-stu-id="79775-242">In our next tutorial we'll look at building an interface that uses a variety of Web controls.</span></span>

<span data-ttu-id="79775-243">プログラミングを楽しんでください。</span><span class="sxs-lookup"><span data-stu-id="79775-243">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="79775-244">著者について</span><span class="sxs-lookup"><span data-stu-id="79775-244">About the Author</span></span>

<span data-ttu-id="79775-245">1998以来、 [Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml)は 7 asp/創設者 of [4GuysFromRolla.com](http://www.4guysfromrolla.com)の執筆者であり、Microsoft Web テクノロジを使用しています。</span><span class="sxs-lookup"><span data-stu-id="79775-245">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="79775-246">Scott は、独立したコンサルタント、トレーナー、およびライターとして機能します。</span><span class="sxs-lookup"><span data-stu-id="79775-246">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="79775-247">彼の最新の書籍は[ *、ASP.NET 2.0 を24時間以内に教え*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)ています。</span><span class="sxs-lookup"><span data-stu-id="79775-247">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="79775-248">mitchell@4GuysFromRolla.comでアクセスでき[ます。](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="79775-248">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="79775-249">または彼のブログを参照してください。これは[http://ScottOnWriting.NET](http://ScottOnWriting.NET)にあります。</span><span class="sxs-lookup"><span data-stu-id="79775-249">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="79775-250">ありがとうございました。</span><span class="sxs-lookup"><span data-stu-id="79775-250">Special Thanks To</span></span>

<span data-ttu-id="79775-251">このチュートリアルシリーズは、役に立つ多くのレビュー担当者によってレビューされました。</span><span class="sxs-lookup"><span data-stu-id="79775-251">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="79775-252">このチュートリアルのリードレビュー担当者は、Patterson が、Ken PLiz Isa、および Shulok でした。</span><span class="sxs-lookup"><span data-stu-id="79775-252">Lead reviewers for this tutorial were Dennis Patterson, Ken Pespisa, and Liz Shulok.</span></span> <span data-ttu-id="79775-253">今後の MSDN 記事を確認することに興味がありますか?</span><span class="sxs-lookup"><span data-stu-id="79775-253">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="79775-254">その場合は、mitchell@4GuysFromRolla.comの行を削除[します。](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="79775-254">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="79775-255">[前へ](handling-bll-and-dal-level-exceptions-vb.md)
> [次へ](customizing-the-datalist-s-editing-interface-vb.md)</span><span class="sxs-lookup"><span data-stu-id="79775-255">[Previous](handling-bll-and-dal-level-exceptions-vb.md)
[Next](customizing-the-datalist-s-editing-interface-vb.md)</span></span>

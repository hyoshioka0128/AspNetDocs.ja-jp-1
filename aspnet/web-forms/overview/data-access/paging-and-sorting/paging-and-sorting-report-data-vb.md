---
uid: web-forms/overview/data-access/paging-and-sorting/paging-and-sorting-report-data-vb
title: レポートデータのページングと並べ替え (VB) |Microsoft Docs
author: rick-anderson
description: ページングと並べ替えは、オンラインアプリケーションにデータを表示するときの2つの非常に一般的な機能です。 このチュートリアルでは、並べ替えの追加と...
ms.author: riande
ms.date: 08/15/2006
ms.assetid: b895e37e-0e69-45cc-a7e4-17ddd2e1b38d
msc.legacyurl: /web-forms/overview/data-access/paging-and-sorting/paging-and-sorting-report-data-vb
msc.type: authoredcontent
ms.openlocfilehash: 6785b5cd2d4d3a2c2e7f2c2fea93f5cd5e2fdf24
ms.sourcegitcommit: 22fbd8863672c4ad6693b8388ad5c8e753fb41a2
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 11/28/2019
ms.locfileid: "74619083"
---
# <a name="paging-and-sorting-report-data-vb"></a><span data-ttu-id="27520-104">レポート データのページングと並べ替え (VB)</span><span class="sxs-lookup"><span data-stu-id="27520-104">Paging and Sorting Report Data (VB)</span></span>

<span data-ttu-id="27520-105">[Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="27520-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="27520-106">[サンプルアプリのダウンロード](https://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_24_VB.exe)または[PDF のダウンロード](paging-and-sorting-report-data-vb/_static/datatutorial24vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="27520-106">[Download Sample App](https://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_24_VB.exe) or [Download PDF](paging-and-sorting-report-data-vb/_static/datatutorial24vb1.pdf)</span></span>

> <span data-ttu-id="27520-107">ページングと並べ替えは、オンラインアプリケーションにデータを表示するときの2つの非常に一般的な機能です。</span><span class="sxs-lookup"><span data-stu-id="27520-107">Paging and sorting are two very common features when displaying data in an online application.</span></span> <span data-ttu-id="27520-108">このチュートリアルでは、レポートに並べ替えとページングを追加する方法について最初に説明します。これは今後のチュートリアルで作成します。</span><span class="sxs-lookup"><span data-stu-id="27520-108">In this tutorial we'll take a first look at adding sorting and paging to our reports, which we will then build upon in future tutorials.</span></span>

## <a name="introduction"></a><span data-ttu-id="27520-109">はじめに</span><span class="sxs-lookup"><span data-stu-id="27520-109">Introduction</span></span>

<span data-ttu-id="27520-110">ページングと並べ替えは、オンラインアプリケーションにデータを表示するときの2つの非常に一般的な機能です。</span><span class="sxs-lookup"><span data-stu-id="27520-110">Paging and sorting are two very common features when displaying data in an online application.</span></span> <span data-ttu-id="27520-111">たとえば、オンライン書店で ASP.NET books を検索する場合、このような書籍は多数存在する可能性がありますが、検索結果を一覧表示するレポートでは、1ページあたり10件の一致のみが一覧表示されます。</span><span class="sxs-lookup"><span data-stu-id="27520-111">For example, when searching for ASP.NET books at an online bookstore, there may be hundreds of such books, but the report listing the search results lists only ten matches per page.</span></span> <span data-ttu-id="27520-112">さらに、結果はタイトル、価格、ページ数、作成者名などで並べ替えることができます。</span><span class="sxs-lookup"><span data-stu-id="27520-112">Moreover, the results can be sorted by title, price, page count, author name, and so on.</span></span> <span data-ttu-id="27520-113">過去23のチュートリアルでは、データの追加、編集、削除を行うことができるインターフェイスを含むさまざまなレポートを作成する方法を確認しましたが、データの並べ替え方法については説明しませんでした。また、DetailsView と FormView を使用したページングの例のみを説明しました。制限.</span><span class="sxs-lookup"><span data-stu-id="27520-113">While the past 23 tutorials have examined how to build a variety of reports, including interfaces that permit adding, editing, and deleting data, we ve not looked at how to sort data and the only paging examples we ve seen have been with the DetailsView and FormView controls.</span></span>

<span data-ttu-id="27520-114">このチュートリアルでは、レポートに並べ替えとページングを追加する方法について説明します。これは、いくつかのチェックボックスをオンにするだけで実現できます。</span><span class="sxs-lookup"><span data-stu-id="27520-114">In this tutorial we'll see how to add sorting and paging to our reports, which can be accomplished by simply checking a few checkboxes.</span></span> <span data-ttu-id="27520-115">残念ながら、この単純な実装には欠点があるため、並べ替えインターフェイスは必要になることがあり、ページングルーチンは大きな結果セットを効率的にページングするようには設計されていません。</span><span class="sxs-lookup"><span data-stu-id="27520-115">Unfortunately, this simplistic implementation has its drawbacks the sorting interface leaves a bit to be desired and the paging routines are not designed for efficiently paging through large result sets.</span></span> <span data-ttu-id="27520-116">今後のチュートリアルでは、すぐに使えるページングと並べ替えソリューションの制限を克服する方法について説明します。</span><span class="sxs-lookup"><span data-stu-id="27520-116">Future tutorials will explore how to overcome the limitations of the out-of-the-box paging and sorting solutions.</span></span>

## <a name="step-1-adding-the-paging-and-sorting-tutorial-web-pages"></a><span data-ttu-id="27520-117">手順 1: ページングと並べ替えのチュートリアル Web ページの追加</span><span class="sxs-lookup"><span data-stu-id="27520-117">Step 1: Adding the Paging and Sorting Tutorial Web Pages</span></span>

<span data-ttu-id="27520-118">このチュートリアルを開始する前に、このチュートリアルに必要な ASP.NET ページを追加し、次の3つについて説明します。</span><span class="sxs-lookup"><span data-stu-id="27520-118">Before we start this tutorial, let s first take a moment to add the ASP.NET pages we'll need for this tutorial and the next three.</span></span> <span data-ttu-id="27520-119">まず、`PagingAndSorting`という名前のプロジェクトに新しいフォルダーを作成します。</span><span class="sxs-lookup"><span data-stu-id="27520-119">Start by creating a new folder in the project named `PagingAndSorting`.</span></span> <span data-ttu-id="27520-120">次に、次の5つの ASP.NET ページをこのフォルダーに追加します。マスターページ `Site.master`を使用するようにすべてのページを構成します。</span><span class="sxs-lookup"><span data-stu-id="27520-120">Next, add the following five ASP.NET pages to this folder, having all of them configured to use the master page `Site.master`:</span></span>

- `Default.aspx`
- `SimplePagingSorting.aspx`
- `EfficientPaging.aspx`
- `SortParameter.aspx`
- `CustomSortingUI.aspx`

![PagingAndSorting フォルダーを作成し、チュートリアル ASP.NET ページを追加します。](paging-and-sorting-report-data-vb/_static/image1.png)

<span data-ttu-id="27520-122">**図 1**: PagingAndSorting フォルダーを作成し、チュートリアル ASP.NET ページを追加する</span><span class="sxs-lookup"><span data-stu-id="27520-122">**Figure 1**: Create a PagingAndSorting Folder and Add the Tutorial ASP.NET Pages</span></span>

<span data-ttu-id="27520-123">次に、[`Default.aspx`] ページを開き、`SectionLevelTutorialListing.ascx` ユーザーコントロールを `UserControls` フォルダーからデザイン画面にドラッグします。</span><span class="sxs-lookup"><span data-stu-id="27520-123">Next, open the `Default.aspx` page and drag the `SectionLevelTutorialListing.ascx` User Control from the `UserControls` folder onto the Design surface.</span></span> <span data-ttu-id="27520-124">このユーザーコントロールは、[マスターページとサイトナビゲーション](../introduction/master-pages-and-site-navigation-vb.md)チュートリアルで作成したもので、サイトマップを列挙し、現在のセクションに記載されているチュートリアルを箇条書きの一覧に表示します。</span><span class="sxs-lookup"><span data-stu-id="27520-124">This User Control, which we created in the [Master Pages and Site Navigation](../introduction/master-pages-and-site-navigation-vb.md) tutorial, enumerates the site map and displays those tutorials in the current section in a bulleted list.</span></span>

![Default.aspx に SectionLevelTutorialListing ユーザーコントロールを追加します。](paging-and-sorting-report-data-vb/_static/image2.png)

<span data-ttu-id="27520-126">**図 2**: Default.aspx に SectionLevelTutorialListing ユーザーコントロールを追加する</span><span class="sxs-lookup"><span data-stu-id="27520-126">**Figure 2**: Add the SectionLevelTutorialListing.ascx User Control to Default.aspx</span></span>

<span data-ttu-id="27520-127">箇条書きの一覧に、作成するページングと並べ替えのチュートリアルが表示されるようにするには、サイトマップに追加する必要があります。</span><span class="sxs-lookup"><span data-stu-id="27520-127">In order to have the bulleted list display the paging and sorting tutorials we'll be creating, we need to add them to the site map.</span></span> <span data-ttu-id="27520-128">`Web.sitemap` ファイルを開き、サイトマップノードマークアップの編集、挿入、および削除の後に、次のマークアップを追加します。</span><span class="sxs-lookup"><span data-stu-id="27520-128">Open the `Web.sitemap` file and add the following markup after the Editing, Inserting, and Deleting site map node markup:</span></span>

[!code-xml[Main](paging-and-sorting-report-data-vb/samples/sample1.xml)]

![新しい ASP.NET ページを含めるようにサイトマップを更新する](paging-and-sorting-report-data-vb/_static/image3.png)

<span data-ttu-id="27520-130">**図 3**: 新しい ASP.NET ページを含めるようにサイトマップを更新する</span><span class="sxs-lookup"><span data-stu-id="27520-130">**Figure 3**: Update the Site Map to Include the New ASP.NET Pages</span></span>

## <a name="step-2-displaying-product-information-in-a-gridview"></a><span data-ttu-id="27520-131">手順 2: GridView で製品情報を表示する</span><span class="sxs-lookup"><span data-stu-id="27520-131">Step 2: Displaying Product Information in a GridView</span></span>

<span data-ttu-id="27520-132">ページングと並べ替えの機能を実際に実装する前に、まずは、製品情報を一覧表示する、並べ替え不可能な標準の非ページ GridView を作成してみましょう。</span><span class="sxs-lookup"><span data-stu-id="27520-132">Before we actually implement paging and sorting capabilities, let s first create a standard non-sortable, non-pageable GridView that lists the product information.</span></span> <span data-ttu-id="27520-133">このチュートリアルシリーズの前に何度も実行していたので、これらの手順は理解しておく必要があります。</span><span class="sxs-lookup"><span data-stu-id="27520-133">This is a task we ve done many times before throughout this tutorial series so these steps should be familiar.</span></span> <span data-ttu-id="27520-134">まず、[`SimplePagingSorting.aspx`] ページを開き、[ツールボックス] から GridView コントロールをデザイナーにドラッグして、`ID` プロパティを `Products`に設定します。</span><span class="sxs-lookup"><span data-stu-id="27520-134">Start by opening the `SimplePagingSorting.aspx` page and drag a GridView control from the Toolbox onto the Designer, setting its `ID` property to `Products`.</span></span> <span data-ttu-id="27520-135">次に、製品の `GetProducts()` メソッドを使用してすべての製品情報を返す新しい ObjectDataSource を作成します。</span><span class="sxs-lookup"><span data-stu-id="27520-135">Next, create a new ObjectDataSource that uses the ProductsBLL class s `GetProducts()` method to return all of the product information.</span></span>

![GetProducts () メソッドを使用して、すべての製品に関する情報を取得します。](paging-and-sorting-report-data-vb/_static/image4.png)

<span data-ttu-id="27520-137">**図 4**: getproducts () メソッドを使用してすべての製品に関する情報を取得する</span><span class="sxs-lookup"><span data-stu-id="27520-137">**Figure 4**: Retrieve Information About All of the Products Using the GetProducts() Method</span></span>

<span data-ttu-id="27520-138">このレポートは読み取り専用のレポートであるため、ObjectDataSource s `Insert()`、`Update()`、または `Delete()` メソッドを対応する `ProductsBLL` メソッドにマップする必要はありません。そのため、[更新]、[挿入]、[削除] の各タブのドロップダウンリストから [(なし)] を選択します。</span><span class="sxs-lookup"><span data-stu-id="27520-138">Since this report is a read-only report, there s no need to map the ObjectDataSource s `Insert()`, `Update()`, or `Delete()` methods to corresponding `ProductsBLL` methods; therefore, choose (None) from the drop-down list for the UPDATE, INSERT, and DELETE tabs.</span></span>

![[更新]、[挿入]、[削除] の各タブのドロップダウンリストで [(なし)] オプションを選択します。](paging-and-sorting-report-data-vb/_static/image5.png)

<span data-ttu-id="27520-140">**図 5**: [更新]、[挿入]、[削除] の各タブのドロップダウンリストで [(なし)] オプションを選択する</span><span class="sxs-lookup"><span data-stu-id="27520-140">**Figure 5**: Choose the (None) Option in the Drop-Down List in the UPDATE, INSERT, and DELETE Tabs</span></span>

<span data-ttu-id="27520-141">次に、を使用して、製品名、仕入先、カテゴリ、価格、および廃止された状態のみが表示されるように、GridView のフィールドをカスタマイズします。</span><span class="sxs-lookup"><span data-stu-id="27520-141">Next, let s customize the GridView s fields so that only the products names, suppliers, categories, prices, and discontinued statuses are displayed.</span></span> <span data-ttu-id="27520-142">さらに、`HeaderText` のプロパティを調整したり、価格を通貨として書式設定するなど、フィールドレベルの書式設定を自由に変更することもできます。</span><span class="sxs-lookup"><span data-stu-id="27520-142">Furthermore, feel free to make any field-level formatting changes, such as adjusting the `HeaderText` properties or formatting the price as a currency.</span></span> <span data-ttu-id="27520-143">これらの変更が完了すると、GridView の宣言型マークアップは次のようになります。</span><span class="sxs-lookup"><span data-stu-id="27520-143">After these changes, your GridView s declarative markup should look similar to the following:</span></span>

[!code-aspx[Main](paging-and-sorting-report-data-vb/samples/sample2.aspx)]

<span data-ttu-id="27520-144">図6は、ブラウザーを通じて表示されたときの進行状況を示しています。</span><span class="sxs-lookup"><span data-stu-id="27520-144">Figure 6 shows our progress thus far when viewed through a browser.</span></span> <span data-ttu-id="27520-145">このページには、すべての製品が1つの画面に表示され、各製品の名前、カテゴリ、仕入先、価格、および廃止された状態が表示されていることに注意してください。</span><span class="sxs-lookup"><span data-stu-id="27520-145">Note that the page lists all of the products in one screen, showing each product s name, category, supplier, price, and discontinued status.</span></span>

<span data-ttu-id="27520-146">[各製品 ![一覧表示されます。](paging-and-sorting-report-data-vb/_static/image7.png)](paging-and-sorting-report-data-vb/_static/image6.png)</span><span class="sxs-lookup"><span data-stu-id="27520-146">[![Each of the Products are Listed](paging-and-sorting-report-data-vb/_static/image7.png)](paging-and-sorting-report-data-vb/_static/image6.png)</span></span>

<span data-ttu-id="27520-147">**図 6**: 各製品が一覧表示されます ([クリックすると、フルサイズの画像が表示](paging-and-sorting-report-data-vb/_static/image8.png)されます)</span><span class="sxs-lookup"><span data-stu-id="27520-147">**Figure 6**: Each of the Products are Listed ([Click to view full-size image](paging-and-sorting-report-data-vb/_static/image8.png))</span></span>

## <a name="step-3-adding-paging-support"></a><span data-ttu-id="27520-148">手順 3: ページングサポートを追加する</span><span class="sxs-lookup"><span data-stu-id="27520-148">Step 3: Adding Paging Support</span></span>

<span data-ttu-id="27520-149">*すべて*の製品を1つの画面に一覧表示すると、ユーザーがデータをつい man するための情報が過負荷になる可能性があります。</span><span class="sxs-lookup"><span data-stu-id="27520-149">Listing *all* of the products on one screen can lead to information overload for the user perusing the data.</span></span> <span data-ttu-id="27520-150">結果をさらに管理しやすくするために、データを小さなページに分割し、ユーザーが一度に1ページずつデータをステップ実行できるようにします。</span><span class="sxs-lookup"><span data-stu-id="27520-150">To help make the results more manageable, we can break up the data into smaller pages of data and allow the user to step through the data one page at a time.</span></span> <span data-ttu-id="27520-151">これを行うには、GridView s スマートタグから [ページングを有効にする] チェックボックスをオンにします (これにより、GridView s [`AllowPaging` プロパティ](https://msdn.microsoft.com/library/system.web.ui.webcontrols.gridview.allowpaging.aspx)が `true`に設定されます)。</span><span class="sxs-lookup"><span data-stu-id="27520-151">To accomplish this simply check the Enable Paging checkbox from the GridView s smart tag (this sets the GridView s [`AllowPaging` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.gridview.allowpaging.aspx) to `true`).</span></span>

<span data-ttu-id="27520-152">[[ページングを有効にする] チェックボックスをオンにして、ページングサポートを追加 ![](paging-and-sorting-report-data-vb/_static/image10.png)](paging-and-sorting-report-data-vb/_static/image9.png)</span><span class="sxs-lookup"><span data-stu-id="27520-152">[![Check the Enable Paging Checkbox to Add Paging Support](paging-and-sorting-report-data-vb/_static/image10.png)](paging-and-sorting-report-data-vb/_static/image9.png)</span></span>

<span data-ttu-id="27520-153">**図 7**: [ページングを有効にする] チェックボックスをオンにしてページングサポートを追加する ([クリックすると、フルサイズの画像が表示](paging-and-sorting-report-data-vb/_static/image11.png)されます)</span><span class="sxs-lookup"><span data-stu-id="27520-153">**Figure 7**: Check the Enable Paging Checkbox to Add Paging Support ([Click to view full-size image](paging-and-sorting-report-data-vb/_static/image11.png))</span></span>

<span data-ttu-id="27520-154">ページングを有効にすると、ページごとに表示されるレコードの数が制限され、*ページングインターフェイス*が GridView に追加されます。</span><span class="sxs-lookup"><span data-stu-id="27520-154">Enabling paging limits the number of records shown per page and adds a *paging interface* to the GridView.</span></span> <span data-ttu-id="27520-155">図7に示す既定のページングインターフェイスは一連のページ番号であり、ユーザーはデータの1ページから別のページにすばやく移動できます。</span><span class="sxs-lookup"><span data-stu-id="27520-155">The default paging interface, shown in Figure 7, is a series of page numbers, allowing the user to quickly navigate from one page of data to another.</span></span> <span data-ttu-id="27520-156">このページングインターフェイスは、前のチュートリアルでは、DetailsView コントロールと FormView コントロールにページングサポートを追加するときに見たように、見慣れているはずです。</span><span class="sxs-lookup"><span data-stu-id="27520-156">This paging interface should look familiar, as we ve seen it when adding paging support to the DetailsView and FormView controls in past tutorials.</span></span>

<span data-ttu-id="27520-157">DetailsView コントロールと FormView コントロールは、どちらもページごとに1つのレコードのみを表示します。</span><span class="sxs-lookup"><span data-stu-id="27520-157">Both the DetailsView and FormView controls only show a single record per page.</span></span> <span data-ttu-id="27520-158">ただし、GridView は、 [`PageSize` プロパティ](https://msdn.microsoft.com/library/system.web.ui.webcontrols.gridview.pagesize.aspx)を調べて、1ページあたりに表示するレコード数を決定します (このプロパティの既定値は 10)。</span><span class="sxs-lookup"><span data-stu-id="27520-158">The GridView, however, consults its [`PageSize` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.gridview.pagesize.aspx) to determine how many records to show per page (this property defaults to a value of 10).</span></span>

<span data-ttu-id="27520-159">この GridView、DetailsView、FormView s ページングインターフェイスは、次のプロパティを使用してカスタマイズできます。</span><span class="sxs-lookup"><span data-stu-id="27520-159">This GridView, DetailsView, and FormView s paging interface can be customized using the following properties:</span></span>

- <span data-ttu-id="27520-160">`PagerStyle` ページングインターフェイスのスタイル情報を示します。`BackColor`、`ForeColor`、`CssClass`、`HorizontalAlign`などの設定を指定できます。</span><span class="sxs-lookup"><span data-stu-id="27520-160">`PagerStyle` indicates the style information for the paging interface; can specify settings like `BackColor`, `ForeColor`, `CssClass`, `HorizontalAlign`, and so on.</span></span>
- <span data-ttu-id="27520-161">`PagerSettings` には、ページングインターフェイスの機能をカスタマイズできる傾斜 y プロパティが含まれています。ページングインターフェイスに表示される数値ページ番号の最大数 (既定値は 10) を `PageButtonCount` します。[`Mode` プロパティ](https://msdn.microsoft.com/library/system.web.ui.webcontrols.pagersettings.mode.aspx)は、ページングインターフェイスの動作を指定し、次のように設定できます。</span><span class="sxs-lookup"><span data-stu-id="27520-161">`PagerSettings` contains a bevy of properties that can customize the functionality of the paging interface; `PageButtonCount` indicates the maximum number of numeric page numbers displayed in the paging interface (the default is 10); the [`Mode` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.pagersettings.mode.aspx) indicates how the paging interface operates and can be set to:</span></span> 

    - <span data-ttu-id="27520-162">`NextPrevious` [次へ] ボタンと [前へ] ボタンが表示され、ユーザーは一度に1ページずつ移動または移動できます。</span><span class="sxs-lookup"><span data-stu-id="27520-162">`NextPrevious` shows a Next and Previous buttons, allowing the user to step forwards or backwards one page at a time</span></span>
    - <span data-ttu-id="27520-163">`NextPreviousFirstLast` [次へ] ボタンと [戻る] ボタンに加えて、最初と最後のボタンも含まれています。これにより、ユーザーはデータの最初または最後のページにすばやく移動できます。</span><span class="sxs-lookup"><span data-stu-id="27520-163">`NextPreviousFirstLast` in addition to Next and Previous buttons, First and Last buttons are also included, allowing the user to quickly move to the first or last page of data</span></span>
    - <span data-ttu-id="27520-164">`Numeric` には一連のページ番号が表示され、ユーザーはすぐに任意のページに移動できます。</span><span class="sxs-lookup"><span data-stu-id="27520-164">`Numeric` shows a series of page numbers, allowing the user to immediately jump to any page</span></span>
    - <span data-ttu-id="27520-165">ページ番号に加えて `NumericFirstLast` には、最初と最後のボタンが含まれており、ユーザーはすぐにデータの最初または最後のページに移動できます。最初/最後のボタンは、すべての数値のページ番号が一致しない場合にのみ表示されます。</span><span class="sxs-lookup"><span data-stu-id="27520-165">`NumericFirstLast` in addition to the page numbers, includes First and Last buttons, allowing the user to quickly move to the first or last page of data; the First/Last buttons are only shown if all of the numeric page numbers cannot fit</span></span>

<span data-ttu-id="27520-166">さらに、GridView、DetailsView、および FormView には、`PageIndex` プロパティと `PageCount` プロパティが用意されています。これらのプロパティは、表示されている現在のページと、データページの合計数を示します。</span><span class="sxs-lookup"><span data-stu-id="27520-166">Moreover, the GridView, DetailsView, and FormView all offer the `PageIndex` and `PageCount` properties, which indicate the current page being viewed and the total number of pages of data, respectively.</span></span> <span data-ttu-id="27520-167">`PageIndex` プロパティのインデックスは0から始まります。これは、データの最初のページを表示するときに `PageIndex` が0になることを意味します。</span><span class="sxs-lookup"><span data-stu-id="27520-167">The `PageIndex` property is indexed starting at 0, meaning that when viewing the first page of data `PageIndex` will equal 0.</span></span> <span data-ttu-id="27520-168">一方、`PageCount`は1からカウントを開始します。つまり、`PageIndex` は0から `PageCount - 1`までの値に制限されます。</span><span class="sxs-lookup"><span data-stu-id="27520-168">`PageCount`, on the other hand, starts counting at 1, meaning that `PageIndex` is limited to the values between 0 and `PageCount - 1`.</span></span>

<span data-ttu-id="27520-169">GridView のページングインターフェイスの既定の外観を改善するために、しばらく時間がかかります。</span><span class="sxs-lookup"><span data-stu-id="27520-169">Let s take a moment to improve the default appearance of our GridView s paging interface.</span></span> <span data-ttu-id="27520-170">具体的には、のページングインターフェイスを明るい灰色の背景で右に並べます。</span><span class="sxs-lookup"><span data-stu-id="27520-170">Specifically, let s have the paging interface right-aligned with a light gray background.</span></span> <span data-ttu-id="27520-171">GridView の `PagerStyle` プロパティを使用してこれらのプロパティを直接設定するのではなく、`PagerRowStyle` という名前の `Styles.css` に CSS クラスを作成し、このテーマを使用して `PagerStyle` s `CssClass` プロパティを割り当てます。</span><span class="sxs-lookup"><span data-stu-id="27520-171">Rather than setting these properties directly through the GridView s `PagerStyle` property, let s create a CSS class in `Styles.css` named `PagerRowStyle` and then assign the `PagerStyle` s `CssClass` property through our Theme.</span></span> <span data-ttu-id="27520-172">まず `Styles.css` を開き、次の CSS クラス定義を追加します。</span><span class="sxs-lookup"><span data-stu-id="27520-172">Start by opening `Styles.css` and adding the following CSS class definition:</span></span>

[!code-css[Main](paging-and-sorting-report-data-vb/samples/sample3.css)]

<span data-ttu-id="27520-173">次に、`App_Themes` フォルダー内の `DataWebControls` フォルダーにある `GridView.skin` ファイルを開きます。</span><span class="sxs-lookup"><span data-stu-id="27520-173">Next, open the `GridView.skin` file in the `DataWebControls` folder within the `App_Themes` folder.</span></span> <span data-ttu-id="27520-174">*マスターページとサイトナビゲーション*のチュートリアルで説明したように、スキンファイルを使用して、Web コントロールの既定のプロパティ値を指定できます。</span><span class="sxs-lookup"><span data-stu-id="27520-174">As we discussed in the *Master Pages and Site Navigation* tutorial, Skin files can be used to specify the default property values for a Web control.</span></span> <span data-ttu-id="27520-175">したがって、では、既存の設定が拡張され、`PagerStyle` s `CssClass` プロパティの設定が `PagerRowStyle`に追加されます。</span><span class="sxs-lookup"><span data-stu-id="27520-175">Therefore, augment the existing settings to include setting the `PagerStyle` s `CssClass` property to `PagerRowStyle`.</span></span> <span data-ttu-id="27520-176">また、ページングインターフェイスを構成して、`NumericFirstLast` ページングインターフェイスを使用して最大5つの数値ページボタンを表示するようにします。</span><span class="sxs-lookup"><span data-stu-id="27520-176">Also, let s configure the paging interface to show at most five numeric page buttons using the `NumericFirstLast` paging interface.</span></span>

[!code-aspx[Main](paging-and-sorting-report-data-vb/samples/sample4.aspx)]

## <a name="the-paging-user-experience"></a><span data-ttu-id="27520-177">ユーザーエクスペリエンスのページング</span><span class="sxs-lookup"><span data-stu-id="27520-177">The Paging User Experience</span></span>

<span data-ttu-id="27520-178">図8は、GridView の [ページングを有効にする] チェックボックスがオンになった後にブラウザーでアクセスしたときの web ページを示しています。また、`PagerStyle` と `PagerSettings` の構成が `GridView.skin` ファイルによって行われています。</span><span class="sxs-lookup"><span data-stu-id="27520-178">Figure 8 shows the web page when visited through a browser after the GridView s Enable Paging checkbox has been checked and the `PagerStyle` and `PagerSettings` configurations have been made through the `GridView.skin` file.</span></span> <span data-ttu-id="27520-179">表示されるのは10個のレコードのみであり、ページングインターフェイスは、データの最初のページを表示していることを示します。</span><span class="sxs-lookup"><span data-stu-id="27520-179">Note how only ten records are shown, and the paging interface indicates that we are viewing the first page of data.</span></span>

<span data-ttu-id="27520-180">[ページングが有効になっている ![は、レコードのサブセットのみが一度に表示されます。](paging-and-sorting-report-data-vb/_static/image13.png)](paging-and-sorting-report-data-vb/_static/image12.png)</span><span class="sxs-lookup"><span data-stu-id="27520-180">[![With Paging Enabled, Only a Subset of the Records are Displayed at a Time](paging-and-sorting-report-data-vb/_static/image13.png)](paging-and-sorting-report-data-vb/_static/image12.png)</span></span>

<span data-ttu-id="27520-181">**図 8**: ページングが有効になっている場合は、レコードのサブセットのみが一度に表示されます ([クリックすると、フルサイズの画像が表示](paging-and-sorting-report-data-vb/_static/image14.png)されます)</span><span class="sxs-lookup"><span data-stu-id="27520-181">**Figure 8**: With Paging Enabled, Only a Subset of the Records are Displayed at a Time ([Click to view full-size image](paging-and-sorting-report-data-vb/_static/image14.png))</span></span>

<span data-ttu-id="27520-182">ページングインターフェイス内のいずれかのページ番号をクリックすると、ポストバック ensues とページが再読み込みされ、要求されたページ s レコードが表示されます。</span><span class="sxs-lookup"><span data-stu-id="27520-182">When the user clicks on one of the page numbers in the paging interface, a postback ensues and the page reloads showing that requested page s records.</span></span> <span data-ttu-id="27520-183">図9は、データの最終ページを表示した後の結果を示しています。</span><span class="sxs-lookup"><span data-stu-id="27520-183">Figure 9 shows the results after opting to view the final page of data.</span></span> <span data-ttu-id="27520-184">最後のページには1つのレコードしかないことに注意してください。これは、合計で81のレコードが存在するためです。その結果、ページごとに10個のレコードが含まれ、1つのページには単一行のレコードが含まれます。</span><span class="sxs-lookup"><span data-stu-id="27520-184">Notice that the final page only has one record; this is because there are 81 records in total, resulting in eight pages of 10 records per page plus one page with a lone record.</span></span>

<span data-ttu-id="27520-185">[ページ番号をクリック ![と、ポストバックが発生し、レコードの適切なサブセットが表示されます。](paging-and-sorting-report-data-vb/_static/image16.png)](paging-and-sorting-report-data-vb/_static/image15.png)</span><span class="sxs-lookup"><span data-stu-id="27520-185">[![Clicking On a Page Number Causes a Postback and Shows the Appropriate Subset of Records](paging-and-sorting-report-data-vb/_static/image16.png)](paging-and-sorting-report-data-vb/_static/image15.png)</span></span>

<span data-ttu-id="27520-186">**図 9**: ページ番号をクリックするとポストバックが発生し、レコードの適切なサブセットが表示されます ([クリックすると、フルサイズの画像が表示](paging-and-sorting-report-data-vb/_static/image17.png)されます)</span><span class="sxs-lookup"><span data-stu-id="27520-186">**Figure 9**: Clicking On a Page Number Causes a Postback and Shows the Appropriate Subset of Records ([Click to view full-size image](paging-and-sorting-report-data-vb/_static/image17.png))</span></span>

## <a name="paging-s-server-side-workflow"></a><span data-ttu-id="27520-187">サーバー側のワークフローのページング</span><span class="sxs-lookup"><span data-stu-id="27520-187">Paging s Server-Side Workflow</span></span>

<span data-ttu-id="27520-188">エンドユーザーがページングインターフェイスのボタンをクリックすると、ポストバック ensues と次のサーバー側ワークフローが開始されます。</span><span class="sxs-lookup"><span data-stu-id="27520-188">When the end user clicks on a button in the paging interface, a postback ensues and the following server-side workflow begins:</span></span>

1. <span data-ttu-id="27520-189">GridView s (または DetailsView または FormView) `PageIndexChanging` イベントが発生します</span><span class="sxs-lookup"><span data-stu-id="27520-189">The GridView s (or DetailsView or FormView) `PageIndexChanging` event fires</span></span>
2. <span data-ttu-id="27520-190">ObjectDataSource は、BLL からの*すべて*のデータを再要求します。gridview の `PageIndex` と `PageSize` プロパティ値を使用して、GridView に表示する必要のある BLL から返されるレコードを決定します。</span><span class="sxs-lookup"><span data-stu-id="27520-190">The ObjectDataSource re-requests *all* of the data from the BLL; the GridView s `PageIndex` and `PageSize` property values are used to determine what records returned from the BLL need to be displayed in the GridView</span></span>
3. <span data-ttu-id="27520-191">GridView s `PageIndexChanged` イベントが発生します</span><span class="sxs-lookup"><span data-stu-id="27520-191">The GridView s `PageIndexChanged` event fires</span></span>

<span data-ttu-id="27520-192">手順 2. で、ObjectDataSource はデータソースからのすべてのデータを再要求します。</span><span class="sxs-lookup"><span data-stu-id="27520-192">In Step 2, the ObjectDataSource re-requests all of the data from its data source.</span></span> <span data-ttu-id="27520-193">この形式のページングは、一般に*既定のページング*と呼ばれます。これは、`AllowPaging` プロパティを `true`に設定するときに既定で使用されるページング動作です。</span><span class="sxs-lookup"><span data-stu-id="27520-193">This style of paging is commonly referred to as *default paging*, as it s the paging behavior used by default when setting the `AllowPaging` property to `true`.</span></span> <span data-ttu-id="27520-194">既定のページングを使用すると、データ Web コントロールネイティブは、データの各ページのすべてのレコードを取得します。ただし、実際には、ブラウザーに送信された HTML にレコードのサブセットのみがレンダリングされます。</span><span class="sxs-lookup"><span data-stu-id="27520-194">With default paging the data Web control naively retrieves all records for each page of data, even though only a subset of records are actually rendered into the HTML that s sent to the browser.</span></span> <span data-ttu-id="27520-195">データベースデータが BLL または ObjectDataSource によってキャッシュされていない限り、既定のページングは、十分に大きな結果セットまたは多数の同時実行ユーザーを持つ web アプリケーションに対して動作不能ます。</span><span class="sxs-lookup"><span data-stu-id="27520-195">Unless the database data is cached by the BLL or ObjectDataSource, default paging is unworkable for sufficiently large result sets or for web applications with many concurrent users.</span></span>

<span data-ttu-id="27520-196">次のチュートリアルでは、*カスタムページング*を実装する方法について説明します。</span><span class="sxs-lookup"><span data-stu-id="27520-196">In the next tutorial we'll examine how to implement *custom paging*.</span></span> <span data-ttu-id="27520-197">カスタムページングを使用すると、要求されたデータページに必要なレコードの正確なセットだけを取得するように ObjectDataSource に指示できます。</span><span class="sxs-lookup"><span data-stu-id="27520-197">With custom paging you can specifically instruct the ObjectDataSource to only retrieve the precise set of records needed for the requested page of data.</span></span> <span data-ttu-id="27520-198">ご想像のとおり、カスタムページングを使用すると、大きな結果セットを使用したページングの効率が大幅に向上します。</span><span class="sxs-lookup"><span data-stu-id="27520-198">As you can imagine, custom paging greatly improves the efficiency of paging through large result sets.</span></span>

> [!NOTE]
> <span data-ttu-id="27520-199">既定のページングは、大量の結果セットをページングする場合や、多数の同時ユーザーがいるサイトの場合には適していませんが、カスタムページングではより多くの変更と実装が必要であり、チェックボックスをチェックするだけではありません (既定では)。ページング)。</span><span class="sxs-lookup"><span data-stu-id="27520-199">While default paging is not suitable when paging through sufficiently large result sets or for sites with many simultaneous users, realize that custom paging requires more changes and effort to implement and is not as simple as checking a checkbox (as is default paging).</span></span> <span data-ttu-id="27520-200">そのため、小規模、低トラフィックの web サイト、または比較的小さな結果セットをページングする場合に、既定のページングが最適な選択肢となる可能性があります。これは、より簡単かつ迅速に実装できるためです。</span><span class="sxs-lookup"><span data-stu-id="27520-200">Therefore, default paging may be the ideal choice for small, low-traffic websites or when paging through relatively small result sets, as it s much easier and quicker to implement.</span></span>

<span data-ttu-id="27520-201">たとえば、データベースで100を超える製品を使用しないことがわかっている場合は、カスタムページングによって利用できるパフォーマンスの低下は、実装に必要な労力によって相殺される可能性があります。</span><span class="sxs-lookup"><span data-stu-id="27520-201">For example, if we know that we'll never have more than 100 products in our database, the minimal performance gain enjoyed by custom paging is likely offset by the effort required to implement it.</span></span> <span data-ttu-id="27520-202">しかし、1日に数千から数十の製品がある場合、カスタムページングを実装しても、アプリケーションのスケーラビリティが大幅に阻害*され*ます。</span><span class="sxs-lookup"><span data-stu-id="27520-202">If, however, we may one day have thousands or tens of thousands of products, *not* implementing custom paging would greatly hamper the scalability of our application.</span></span>

## <a name="step-4-customizing-the-paging-experience"></a><span data-ttu-id="27520-203">手順 4: ページングエクスペリエンスのカスタマイズ</span><span class="sxs-lookup"><span data-stu-id="27520-203">Step 4: Customizing the Paging Experience</span></span>

<span data-ttu-id="27520-204">データ Web コントロールには、ユーザーのページングエクスペリエンスを向上させるために使用できる多数のプロパティが用意されています。</span><span class="sxs-lookup"><span data-stu-id="27520-204">The data Web controls provide a number of properties that can be used to enhance the user s paging experience.</span></span> <span data-ttu-id="27520-205">たとえば、`PageCount` プロパティは、表示されているページの合計数を示します。一方、`PageIndex` プロパティは、現在アクセスしているページを示します。また、ユーザーを特定のページにすばやく移動するように設定できます。</span><span class="sxs-lookup"><span data-stu-id="27520-205">The `PageCount` property, for example, indicates how many total pages there are, while the `PageIndex` property indicates the current page being visited and can be set to quickly move a user to a specific page.</span></span> <span data-ttu-id="27520-206">これらのプロパティを使用してユーザーのページングエクスペリエンスを向上させる方法を説明するために、では、現在アクセスしているページをユーザーに通知するラベル Web コントロールをページに追加します。また、DropDownList コントロールを使用して、特定のページにすばやく移動できるようにします.</span><span class="sxs-lookup"><span data-stu-id="27520-206">To illustrate how to use these properties to improve upon the user s paging experience, let s add a Label Web control to our page that informs the user what page they re currently visiting, along with a DropDownList control that allows them to quickly jump to any given page.</span></span>

<span data-ttu-id="27520-207">まず、ラベル Web コントロールをページに追加し、その `ID` プロパティを `PagingInformation`に設定して、その `Text` プロパティをクリアします。</span><span class="sxs-lookup"><span data-stu-id="27520-207">First, add a Label Web control to your page, set its `ID` property to `PagingInformation`, and clear out its `Text` property.</span></span> <span data-ttu-id="27520-208">次に、GridView s `DataBound` イベントのイベントハンドラーを作成し、次のコードを追加します。</span><span class="sxs-lookup"><span data-stu-id="27520-208">Next, create an event handler for the GridView s `DataBound` event and add the following code:</span></span>

[!code-vb[Main](paging-and-sorting-report-data-vb/samples/sample5.vb)]

<span data-ttu-id="27520-209">このイベントハンドラーは、`PagingInformation` Label s `Text` プロパティを、現在 `Products.PageIndex + 1` アクセスしているページをユーザーに通知するメッセージに割り当てます。これにより、`Products.PageIndex` は0からインデックスが作成される `Products.PageCount` ので、`PageIndex` プロパティに1が追加されます。</span><span class="sxs-lookup"><span data-stu-id="27520-209">This event handler assigns the `PagingInformation` Label s `Text` property to a message informing the user the page they are currently visiting `Products.PageIndex + 1` out of how many total pages `Products.PageCount` (we add 1 to the `Products.PageIndex` property because `PageIndex` is indexed starting at 0).</span></span> <span data-ttu-id="27520-210">`PageIndexChanged` イベントハンドラーではなく、`DataBound` イベントハンドラーで [この `Text` ラベルを割り当てる] プロパティを選択しました。これは、データが GridView にバインドされるたびに `DataBound` イベントが発生するのに対して、`PageIndexChanged` イベントハンドラーはページインデックスが変更された場合にのみ発生するためです。</span><span class="sxs-lookup"><span data-stu-id="27520-210">I chose the assign this Label s `Text` property in the `DataBound` event handler as opposed to the `PageIndexChanged` event handler because the `DataBound` event fires every time data is bound to the GridView whereas the `PageIndexChanged` event handler only fires when the page index is changed.</span></span> <span data-ttu-id="27520-211">最初のページに移動したときに GridView が最初のページでデータバインドされた場合、`PageIndexChanging` イベントは発生しません (`DataBound` イベントによって発生します)。</span><span class="sxs-lookup"><span data-stu-id="27520-211">When the GridView is initially data bound on the first page visit, the `PageIndexChanging` event doesn t fire (whereas the `DataBound` event does).</span></span>

<span data-ttu-id="27520-212">この追加により、ユーザーがアクセスしているページと、そのデータの合計ページ数を示すメッセージが表示されるようになりました。</span><span class="sxs-lookup"><span data-stu-id="27520-212">With this addition, the user is now shown a message indicating what page they are visiting and how many total pages of data there are.</span></span>

<span data-ttu-id="27520-213">[現在のページ番号と合計ページ数を ![](paging-and-sorting-report-data-vb/_static/image19.png)](paging-and-sorting-report-data-vb/_static/image18.png)</span><span class="sxs-lookup"><span data-stu-id="27520-213">[![The Current Page Number and Total Number of Pages are Displayed](paging-and-sorting-report-data-vb/_static/image19.png)](paging-and-sorting-report-data-vb/_static/image18.png)</span></span>

<span data-ttu-id="27520-214">**図 10**: 現在のページ数とページ数の合計が表示される ([クリックすると、フルサイズの画像が表示](paging-and-sorting-report-data-vb/_static/image20.png)されます)</span><span class="sxs-lookup"><span data-stu-id="27520-214">**Figure 10**: The Current Page Number and Total Number of Pages are Displayed ([Click to view full-size image](paging-and-sorting-report-data-vb/_static/image20.png))</span></span>

<span data-ttu-id="27520-215">ラベルコントロールに加えて、現在表示されているページを使用して GridView 内のページ番号を一覧表示する DropDownList コントロールも追加します。</span><span class="sxs-lookup"><span data-stu-id="27520-215">In addition to the Label control, let s also add a DropDownList control that lists the page numbers in the GridView with the currently viewed page selected.</span></span> <span data-ttu-id="27520-216">ここでの考え方は、ユーザーが DropDownList から新しいページインデックスを選択するだけで、現在のページから別のページにすばやく移動できることです。</span><span class="sxs-lookup"><span data-stu-id="27520-216">The idea here is that the user can quickly jump from the current page to another by simply selecting the new page index from the DropDownList.</span></span> <span data-ttu-id="27520-217">まず、DropDownList をデザイナーに追加し、その `ID` プロパティを `PageList` に設定して、そのスマートタグから [AutoPostBack を有効にする] オプションをオンにします。</span><span class="sxs-lookup"><span data-stu-id="27520-217">Start by adding a DropDownList to the Designer, setting its `ID` property to `PageList` and checking the Enable AutoPostBack option from its smart tag.</span></span>

<span data-ttu-id="27520-218">次に、`DataBound` イベントハンドラーに戻り、次のコードを追加します。</span><span class="sxs-lookup"><span data-stu-id="27520-218">Next, return to the `DataBound` event handler and add the following code:</span></span>

[!code-vb[Main](paging-and-sorting-report-data-vb/samples/sample6.vb)]

<span data-ttu-id="27520-219">このコードでは、まず `PageList` DropDownList の項目をクリアします。</span><span class="sxs-lookup"><span data-stu-id="27520-219">This code begins by clearing out the items in the `PageList` DropDownList.</span></span> <span data-ttu-id="27520-220">このような場合、ページ数が変更されることはありませんが、他のユーザーが同時にシステムを使用して、`Products` テーブルのレコードを追加または削除する可能性があります。</span><span class="sxs-lookup"><span data-stu-id="27520-220">This may seem superfluous, since one wouldn't expect the number of pages to change, but other users may be using the system simultaneously, adding or removing records from the `Products` table.</span></span> <span data-ttu-id="27520-221">このような挿入や削除によって、データのページ数が変更される可能性があります。</span><span class="sxs-lookup"><span data-stu-id="27520-221">Such insertions or deletions could alter the number of pages of data.</span></span>

<span data-ttu-id="27520-222">次に、ページ番号を再度作成し、現在の GridView にマップされているものを既定で選択 `PageIndex` する必要があります。</span><span class="sxs-lookup"><span data-stu-id="27520-222">Next, we need to create the page numbers again and have the one that maps to the current GridView `PageIndex` selected by default.</span></span> <span data-ttu-id="27520-223">これを行うには、0から `PageCount - 1`へのループを行い、各反復に新しい `ListItem` を追加し、現在の反復インデックスが GridView s `PageIndex` プロパティに等しい場合はその `Selected` プロパティを true に設定します。</span><span class="sxs-lookup"><span data-stu-id="27520-223">We accomplish this with a loop from 0 to `PageCount - 1`, adding a new `ListItem` in each iteration and setting its `Selected` property to true if the current iteration index equals the GridView s `PageIndex` property.</span></span>

<span data-ttu-id="27520-224">最後に、DropDownList `SelectedIndexChanged` イベントのイベントハンドラーを作成する必要があります。これは、ユーザーが一覧から別の項目を選択するたびに起動されます。</span><span class="sxs-lookup"><span data-stu-id="27520-224">Finally, we need to create an event handler for the DropDownList s `SelectedIndexChanged` event, which fires each time the user pick a different item from the list.</span></span> <span data-ttu-id="27520-225">このイベントハンドラーを作成するには、デザイナーで DropDownList をダブルクリックし、次のコードを追加します。</span><span class="sxs-lookup"><span data-stu-id="27520-225">To create this event handler, simply double-click the DropDownList in the Designer, then add the following code:</span></span>

[!code-vb[Main](paging-and-sorting-report-data-vb/samples/sample7.vb)]

<span data-ttu-id="27520-226">図11に示すように、GridView の `PageIndex` プロパティを変更するだけで、データが GridView に再バインドされます。</span><span class="sxs-lookup"><span data-stu-id="27520-226">As Figure 11 shows, merely changing the GridView s `PageIndex` property causes the data to be rebound to the GridView.</span></span> <span data-ttu-id="27520-227">GridView s `DataBound` イベントハンドラーで、適切な DropDownList `ListItem` が選択されています。</span><span class="sxs-lookup"><span data-stu-id="27520-227">In the GridView s `DataBound` event handler, the appropriate DropDownList `ListItem` is selected.</span></span>

<span data-ttu-id="27520-228">[[ページ 6] ドロップダウンリスト項目を選択すると、ユーザーは6ページ目に自動的に移動 ![](paging-and-sorting-report-data-vb/_static/image22.png)](paging-and-sorting-report-data-vb/_static/image21.png)</span><span class="sxs-lookup"><span data-stu-id="27520-228">[![The User is Automatically Taken to the Sixth Page When Selecting the Page 6 Drop-Down List Item](paging-and-sorting-report-data-vb/_static/image22.png)](paging-and-sorting-report-data-vb/_static/image21.png)</span></span>

<span data-ttu-id="27520-229">**図 11**: ページ6のドロップダウンリスト項目を選択したときに、ユーザーが6番目のページに自動的に移動する ([クリックしてフルサイズの画像を表示する](paging-and-sorting-report-data-vb/_static/image23.png))</span><span class="sxs-lookup"><span data-stu-id="27520-229">**Figure 11**: The User is Automatically Taken to the Sixth Page When Selecting the Page 6 Drop-Down List Item ([Click to view full-size image](paging-and-sorting-report-data-vb/_static/image23.png))</span></span>

## <a name="step-5-adding-bi-directional-sorting-support"></a><span data-ttu-id="27520-230">手順 5: 双方向の並べ替えサポートを追加する</span><span class="sxs-lookup"><span data-stu-id="27520-230">Step 5: Adding Bi-Directional Sorting Support</span></span>

<span data-ttu-id="27520-231">双方向の並べ替えサポートの追加は、ページングサポートを追加するだけで簡単に行うことができます。 GridView s スマートタグ (GridView s [`AllowSorting` プロパティ](https://msdn.microsoft.com/library/system.web.ui.webcontrols.gridview.allowsorting.aspx)を `true`に設定する) の [並べ替えを有効にする] オプションをオンにします。</span><span class="sxs-lookup"><span data-stu-id="27520-231">Adding bi-directional sorting support is as simple as adding paging support simply check the Enable Sorting option from the GridView s smart tag (which sets the GridView s [`AllowSorting` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.gridview.allowsorting.aspx) to `true`).</span></span> <span data-ttu-id="27520-232">これにより、GridView のフィールドの各ヘッダーがリンクボタンとして表示され、クリックするとポストバックが発生し、クリックされた列によって並べ替えられたデータが昇順で返されます。</span><span class="sxs-lookup"><span data-stu-id="27520-232">This renders each of the headers of the GridView s fields as LinkButtons that, when clicked, cause a postback and return the data sorted by the clicked column in ascending order.</span></span> <span data-ttu-id="27520-233">同じヘッダー LinkButton をクリックすると、データが降順に並べ替えられます。</span><span class="sxs-lookup"><span data-stu-id="27520-233">Clicking the same header LinkButton again re-sorts the data in descending order.</span></span>

> [!NOTE]
> <span data-ttu-id="27520-234">型指定されたデータセットではなくカスタムデータアクセス層を使用している場合は、GridView s スマートタグに [並べ替えを有効にする] オプションがない可能性があります。</span><span class="sxs-lookup"><span data-stu-id="27520-234">If you are using a custom Data Access Layer rather than a Typed DataSet, you may not have an Enable Sorting option in the GridView s smart tag.</span></span> <span data-ttu-id="27520-235">並べ替えをネイティブにサポートするデータソースにバインドされている GridViews でのみ、このチェックボックスを使用できます。</span><span class="sxs-lookup"><span data-stu-id="27520-235">Only GridViews bound to data sources that natively support sorting have this checkbox available.</span></span> <span data-ttu-id="27520-236">ADO.NET DataTable には、指定された条件を使用して DataTable s Datarow を並べ替える `Sort` メソッドが用意されているため、型指定されたデータセットは、すぐに使用できる並べ替えをサポートします。</span><span class="sxs-lookup"><span data-stu-id="27520-236">The Typed DataSet provides out-of-the-box sorting support since the ADO.NET DataTable provides a `Sort` method that, when invoked, sorts the DataTable s DataRows using the criteria specified.</span></span>

<span data-ttu-id="27520-237">DAL が並べ替えをネイティブにサポートするオブジェクトを返さない場合は、ObjectDataSource を構成して、並べ替え情報をビジネスロジックレイヤーに渡す必要があります。これにより、データを並べ替えるか、DAL によってデータを並べ替えることができます。</span><span class="sxs-lookup"><span data-stu-id="27520-237">If your DAL does not return objects that natively support sorting you will need to configure the ObjectDataSource to pass sorting information to the Business Logic Layer, which can either sort the data or have the data sorted by the DAL.</span></span> <span data-ttu-id="27520-238">今後のチュートリアルでは、ビジネスロジックとデータアクセス層でデータを並べ替える方法について説明します。</span><span class="sxs-lookup"><span data-stu-id="27520-238">We'll explore how to sort data at the Business Logic and Data Access Layers in a future tutorial.</span></span>

<span data-ttu-id="27520-239">[LinkButtons 並べ替え] ボタンは HTML ハイパーリンクとして表示されます。現在の色 (未処理リンクの場合は青、アクセスしたリンクの場合はダーク赤色) が、ヘッダー行の背景色と競合します。</span><span class="sxs-lookup"><span data-stu-id="27520-239">The sorting LinkButtons are rendered as HTML hyperlinks, whose current colors (blue for an unvisited link and a dark red for a visited link) clash with the background color of the header row.</span></span> <span data-ttu-id="27520-240">代わりに、アクセスされたかどうかに関係なく、すべてのヘッダー行のリンクが白で表示されます。</span><span class="sxs-lookup"><span data-stu-id="27520-240">Instead, let s have all header row links displayed in white, regardless of whether they ve been visited or not.</span></span> <span data-ttu-id="27520-241">これを行うには、次のを `Styles.css` クラスに追加します。</span><span class="sxs-lookup"><span data-stu-id="27520-241">This can be accomplished by adding the following to the `Styles.css` class:</span></span>

[!code-css[Main](paging-and-sorting-report-data-vb/samples/sample8.css)]

<span data-ttu-id="27520-242">この構文は、HeaderStyle クラスを使用する要素内にこれらのハイパーリンクを表示するときに、ホワイトテキストを使用することを示します。</span><span class="sxs-lookup"><span data-stu-id="27520-242">This syntax indicates to use white text when displaying those hyperlinks within an element that uses the HeaderStyle class.</span></span>

<span data-ttu-id="27520-243">この CSS を追加した後、ブラウザーを使用してページにアクセスすると、画面は図12のようになります。</span><span class="sxs-lookup"><span data-stu-id="27520-243">After this CSS addition, when visiting the page through a browser your screen should look similar to Figure 12.</span></span> <span data-ttu-id="27520-244">特に、図12は、Price field s ヘッダーリンクがクリックされた後の結果を示しています。</span><span class="sxs-lookup"><span data-stu-id="27520-244">In particular, Figure 12 shows the results after the Price field s header link has been clicked.</span></span>

<span data-ttu-id="27520-245">[結果が UnitPrice で昇順に並べ替えられた ![](paging-and-sorting-report-data-vb/_static/image25.png)](paging-and-sorting-report-data-vb/_static/image24.png)</span><span class="sxs-lookup"><span data-stu-id="27520-245">[![The Results Have Been Sorted by the UnitPrice in Ascending Order](paging-and-sorting-report-data-vb/_static/image25.png)](paging-and-sorting-report-data-vb/_static/image24.png)</span></span>

<span data-ttu-id="27520-246">**図 12**: 結果が UnitPrice の昇順で並べ替えられている ([クリックすると、フルサイズの画像が表示](paging-and-sorting-report-data-vb/_static/image26.png)されます)</span><span class="sxs-lookup"><span data-stu-id="27520-246">**Figure 12**: The Results Have Been Sorted by the UnitPrice in Ascending Order ([Click to view full-size image](paging-and-sorting-report-data-vb/_static/image26.png))</span></span>

## <a name="examining-the-sorting-workflow"></a><span data-ttu-id="27520-247">並べ替えワークフローを調べています</span><span class="sxs-lookup"><span data-stu-id="27520-247">Examining the Sorting Workflow</span></span>

<span data-ttu-id="27520-248">すべての GridView フィールド BoundField、CheckBoxField、TemplateField などには、そのフィールドの [並べ替えヘッダー] リンクがクリックされたときにデータを並べ替えるために使用する式を示す `SortExpression` のプロパティがあります。</span><span class="sxs-lookup"><span data-stu-id="27520-248">All GridView fields the BoundField, CheckBoxField, TemplateField, and so on have a `SortExpression` property that indicates the expression that should be used to sort the data when that field s sorting header link is clicked.</span></span> <span data-ttu-id="27520-249">GridView には、`SortExpression` プロパティもあります。</span><span class="sxs-lookup"><span data-stu-id="27520-249">The GridView also has a `SortExpression` property.</span></span> <span data-ttu-id="27520-250">並べ替えヘッダー LinkButton がクリックされると、GridView によってそのフィールドの `SortExpression` 値が `SortExpression` プロパティに割り当てられます。</span><span class="sxs-lookup"><span data-stu-id="27520-250">When a sorting header LinkButton is clicked, the GridView assigns that field s `SortExpression` value to its `SortExpression` property.</span></span> <span data-ttu-id="27520-251">次に、データは ObjectDataSource から再取得され、GridView s `SortExpression` プロパティに従って並べ替えられます。</span><span class="sxs-lookup"><span data-stu-id="27520-251">Next, the data is re-retrieved from the ObjectDataSource and sorted according to the GridView s `SortExpression` property.</span></span> <span data-ttu-id="27520-252">次の一覧では、エンドユーザーが GridView でデータを並べ替えるときに発生する一連の手順について詳しく説明します。</span><span class="sxs-lookup"><span data-stu-id="27520-252">The following list details the sequence of steps that transpires when an end user sorts the data in a GridView:</span></span>

1. <span data-ttu-id="27520-253">GridView の[並べ替えイベント](https://msdn.microsoft.com/library/system.web.ui.webcontrols.gridview.sorting(VS.80).aspx)が発生しました</span><span class="sxs-lookup"><span data-stu-id="27520-253">The GridView s [Sorting event](https://msdn.microsoft.com/library/system.web.ui.webcontrols.gridview.sorting(VS.80).aspx) fires</span></span>
2. <span data-ttu-id="27520-254">GridView s [`SortExpression` プロパティ](https://msdn.microsoft.com/library/system.web.ui.webcontrols.gridview.sortexpression.aspx)は、並べ替えヘッダー LinkButton がクリックされたフィールドの `SortExpression` に設定されます。</span><span class="sxs-lookup"><span data-stu-id="27520-254">The GridView s [`SortExpression` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.gridview.sortexpression.aspx) is set to the `SortExpression` of the field whose sorting header LinkButton was clicked</span></span>
3. <span data-ttu-id="27520-255">ObjectDataSource は、BLL からすべてのデータを再取得した後、GridView s を使用してデータを並べ替え `SortExpression`</span><span class="sxs-lookup"><span data-stu-id="27520-255">The ObjectDataSource re-retrieves all of the data from the BLL and then sorts the data using the GridView s `SortExpression`</span></span>
4. <span data-ttu-id="27520-256">GridView s `PageIndex` プロパティは0にリセットされます。つまり、ユーザーがデータの最初のページに戻るとき (ページングのサポートが実装されていることを前提としています)、</span><span class="sxs-lookup"><span data-stu-id="27520-256">The GridView s `PageIndex` property is reset to 0, meaning that when sorting the user is returned to the first page of data (assuming paging support has been implemented)</span></span>
5. <span data-ttu-id="27520-257">GridView s [`Sorted` イベント](https://msdn.microsoft.com/library/system.web.ui.webcontrols.gridview.sorted(VS.80).aspx)が発生します</span><span class="sxs-lookup"><span data-stu-id="27520-257">The GridView s [`Sorted` event](https://msdn.microsoft.com/library/system.web.ui.webcontrols.gridview.sorted(VS.80).aspx) fires</span></span>

<span data-ttu-id="27520-258">既定のページングの場合と同様に、既定の並べ替えオプションでは、BLL から*すべて*のレコードが再取得されます。</span><span class="sxs-lookup"><span data-stu-id="27520-258">Like with default paging, the default sorting option re-retrieves *all* of the records from the BLL.</span></span> <span data-ttu-id="27520-259">ページングを行わずに並べ替えを使用する場合、または既定のページングでの並べ替えを使用する場合、このパフォーマンスの低下を回避する方法はありません (データベースデータをキャッシュすることもありません)。</span><span class="sxs-lookup"><span data-stu-id="27520-259">When using sorting without paging or when using sorting with default paging, there s no way to circumvent this performance hit (short of caching the database data).</span></span> <span data-ttu-id="27520-260">ただし、今後のチュートリアルで説明しているように、カスタムページングを使用するときにデータを効率的に並べ替えることができます。</span><span class="sxs-lookup"><span data-stu-id="27520-260">However, as we'll see in a future tutorial, it s possible to efficiently sort data when using custom paging.</span></span>

<span data-ttu-id="27520-261">GridView のスマートタグのドロップダウンリストを使用して ObjectDataSource を GridView にバインドすると、各 GridView フィールドには、`ProductsRow` クラスのデータフィールドの名前に割り当てられた `SortExpression` プロパティが自動的に設定されます。</span><span class="sxs-lookup"><span data-stu-id="27520-261">When binding an ObjectDataSource to the GridView through the drop-down list in the GridView s smart tag, each GridView field automatically has its `SortExpression` property assigned to the name of the data field in the `ProductsRow` class.</span></span> <span data-ttu-id="27520-262">たとえば、次の宣言型マークアップに示すように、`ProductName` BoundField s `SortExpression` は `ProductName`に設定されます。</span><span class="sxs-lookup"><span data-stu-id="27520-262">For example, the `ProductName` BoundField s `SortExpression` is set to `ProductName`, as shown in the following declarative markup:</span></span>

[!code-aspx[Main](paging-and-sorting-report-data-vb/samples/sample9.aspx)]

<span data-ttu-id="27520-263">フィールドを構成して、その `SortExpression` プロパティをクリアする (空の文字列に割り当てる) ことによって、並べ替えられないようにすることができます。</span><span class="sxs-lookup"><span data-stu-id="27520-263">A field can be configured so that it s not sortable by clearing out its `SortExpression` property (assigning it to an empty string).</span></span> <span data-ttu-id="27520-264">これを説明するために、お客様が製品を価格で並べ替えないようにしたいと考えています。</span><span class="sxs-lookup"><span data-stu-id="27520-264">To illustrate this, imagine that we didn't want to let our customers sort our products by price.</span></span> <span data-ttu-id="27520-265">`UnitPrice` BoundField s `SortExpression` プロパティは、宣言型マークアップから、または [フィールド] ダイアログボックス (GridView s スマートタグの [列の編集] リンクをクリックするとアクセスできます) から削除できます。</span><span class="sxs-lookup"><span data-stu-id="27520-265">The `UnitPrice` BoundField s `SortExpression` property can be removed either from the declarative markup or through the Fields dialog box (which is accessible by clicking on the Edit Columns link in the GridView s smart tag).</span></span>

![結果は、UnitPrice の昇順で並べ替えられています。](paging-and-sorting-report-data-vb/_static/image27.png)

<span data-ttu-id="27520-267">**図 13**: 結果が UnitPrice の昇順で並べ替えられている</span><span class="sxs-lookup"><span data-stu-id="27520-267">**Figure 13**: The Results Have Been Sorted by the UnitPrice in Ascending Order</span></span>

<span data-ttu-id="27520-268">`SortExpression` プロパティが `UnitPrice` BoundField に対して削除されると、ヘッダーはリンクとしてではなくテキストとして表示されるため、ユーザーはデータを価格で並べ替えることができません。</span><span class="sxs-lookup"><span data-stu-id="27520-268">Once the `SortExpression` property has been removed for the `UnitPrice` BoundField, the header is rendered as text rather than as a link, thereby preventing users from sorting the data by price.</span></span>

<span data-ttu-id="27520-269">[SortExpression プロパティを削除することにより、ユーザーは商品を価格で並べ替えることができなくなります。 ![](paging-and-sorting-report-data-vb/_static/image29.png)](paging-and-sorting-report-data-vb/_static/image28.png)</span><span class="sxs-lookup"><span data-stu-id="27520-269">[![By Removing the SortExpression Property, Users Can No Longer Sort the Products By Price](paging-and-sorting-report-data-vb/_static/image29.png)](paging-and-sorting-report-data-vb/_static/image28.png)</span></span>

<span data-ttu-id="27520-270">**図 14**: SortExpression プロパティを削除すると、ユーザーは製品を価格で並べ替えることができなくなります ([クリックすると、フルサイズの画像が表示](paging-and-sorting-report-data-vb/_static/image30.png)されます)</span><span class="sxs-lookup"><span data-stu-id="27520-270">**Figure 14**: By Removing the SortExpression Property, Users Can No Longer Sort the Products By Price ([Click to view full-size image](paging-and-sorting-report-data-vb/_static/image30.png))</span></span>

## <a name="programmatically-sorting-the-gridview"></a><span data-ttu-id="27520-271">プログラムによる GridView の並べ替え</span><span class="sxs-lookup"><span data-stu-id="27520-271">Programmatically Sorting the GridView</span></span>

<span data-ttu-id="27520-272">Gridview s [`Sort` メソッド](https://msdn.microsoft.com/library/system.web.ui.webcontrols.gridview.sort.aspx)を使用して、gridview の内容をプログラムによって並べ替えることもできます。</span><span class="sxs-lookup"><span data-stu-id="27520-272">You can also sort the contents of the GridView programmatically by using the GridView s [`Sort` method](https://msdn.microsoft.com/library/system.web.ui.webcontrols.gridview.sort.aspx).</span></span> <span data-ttu-id="27520-273">`SortExpression` 値を渡すだけで、 [`SortDirection`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.sortdirection.aspx) (`Ascending` または `Descending`) と共に並べ替えられ、GridView のデータが再並べ替えされます。</span><span class="sxs-lookup"><span data-stu-id="27520-273">Simply pass in the `SortExpression` value to sort by along with the [`SortDirection`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.sortdirection.aspx) (`Ascending` or `Descending`), and the GridView s data will be re-sorted.</span></span>

<span data-ttu-id="27520-274">`UnitPrice` による並べ替えを無効にした理由は、お客様が最低価格の製品のみを購入するという懸念があることを想像してください。</span><span class="sxs-lookup"><span data-stu-id="27520-274">Imagine that the reason we turned off sorting by the `UnitPrice` was because we were worried that our customers would simply buy only the lowest-priced products.</span></span> <span data-ttu-id="27520-275">しかし、コストの高い製品を購入できるようにすることをお勧めします。そのため、製品を価格で並べ替えることができますが、最もコストの高い価格のみを使用できます。</span><span class="sxs-lookup"><span data-stu-id="27520-275">However, we want to encourage them to buy the most expensive products, so we d like them to be able to sort the products by price, but only from the most expensive price to the least.</span></span>

<span data-ttu-id="27520-276">これを実現するには、ボタン Web コントロールをページに追加し、その `ID` プロパティを `SortPriceDescending`に設定し、その `Text` プロパティを Price で並べ替えます。</span><span class="sxs-lookup"><span data-stu-id="27520-276">To accomplish this add a Button Web control to the page, set its `ID` property to `SortPriceDescending`, and its `Text` property to Sort by Price.</span></span> <span data-ttu-id="27520-277">次に、デザイナーのボタンコントロールをダブルクリックして、ボタン s `Click` イベントのイベントハンドラーを作成します。</span><span class="sxs-lookup"><span data-stu-id="27520-277">Next, create an event handler for the Button s `Click` event by double-clicking the Button control in the Designer.</span></span> <span data-ttu-id="27520-278">このイベントハンドラーに次のコードを追加します。</span><span class="sxs-lookup"><span data-stu-id="27520-278">Add the following code to this event handler:</span></span>

[!code-vb[Main](paging-and-sorting-report-data-vb/samples/sample10.vb)]

<span data-ttu-id="27520-279">このボタンをクリックすると、製品が価格で並べ替えられた最初のページにユーザーが返されます。料金は最も高く、コストが最も低くなります (図15を参照)。</span><span class="sxs-lookup"><span data-stu-id="27520-279">Clicking this Button returns the user to the first page with the products sorted by price, from most expensive to least expensive (see Figure 15).</span></span>

<span data-ttu-id="27520-280">[このボタンをクリック ![と、最もコストの高い製品から順に製品が順序付けされます。](paging-and-sorting-report-data-vb/_static/image32.png)](paging-and-sorting-report-data-vb/_static/image31.png)</span><span class="sxs-lookup"><span data-stu-id="27520-280">[![Clicking the Button Orders the Products From the Most Expensive to the Least](paging-and-sorting-report-data-vb/_static/image32.png)](paging-and-sorting-report-data-vb/_static/image31.png)</span></span>

<span data-ttu-id="27520-281">**図 15**: ボタンをクリックすると、最もコストの高い製品から最もコストが高くなります ([クリックすると、フルサイズの画像が表示](paging-and-sorting-report-data-vb/_static/image33.png)されます)</span><span class="sxs-lookup"><span data-stu-id="27520-281">**Figure 15**: Clicking the Button Orders the Products From the Most Expensive to the Least ([Click to view full-size image](paging-and-sorting-report-data-vb/_static/image33.png))</span></span>

## <a name="summary"></a><span data-ttu-id="27520-282">要約</span><span class="sxs-lookup"><span data-stu-id="27520-282">Summary</span></span>

<span data-ttu-id="27520-283">このチュートリアルでは、既定のページングと並べ替えの機能を実装する方法について説明しました。どちらもチェックボックスをオンにするのと同じくらい簡単でした。</span><span class="sxs-lookup"><span data-stu-id="27520-283">In this tutorial we saw how to implement default paging and sorting capabilities, both of which were as easy as checking a checkbox!</span></span> <span data-ttu-id="27520-284">ユーザーがデータを並べ替えたり、ページを上したりすると、同様のワークフローは次のようになります。</span><span class="sxs-lookup"><span data-stu-id="27520-284">When a user sorts or pages through data, a similar workflow unfolds:</span></span>

1. <span data-ttu-id="27520-285">ポストバック ensues</span><span class="sxs-lookup"><span data-stu-id="27520-285">A postback ensues</span></span>
2. <span data-ttu-id="27520-286">データ Web コントロール s レベルのイベントが発生します (`PageIndexChanging` または `Sorting`)</span><span class="sxs-lookup"><span data-stu-id="27520-286">The data Web control s pre-level event fires (`PageIndexChanging` or `Sorting`)</span></span>
3. <span data-ttu-id="27520-287">すべてのデータが ObjectDataSource によって再取得されます。</span><span class="sxs-lookup"><span data-stu-id="27520-287">All of the data is re-retrieved by the ObjectDataSource</span></span>
4. <span data-ttu-id="27520-288">データ Web コントロール s レベルのイベントが発生しました (`PageIndexChanged` または `Sorted`)</span><span class="sxs-lookup"><span data-stu-id="27520-288">The data Web control s post-level event fires (`PageIndexChanged` or `Sorted`)</span></span>

<span data-ttu-id="27520-289">基本的なページングと並べ替えを実装するのは簡単ですが、より効率的なカスタムページングを利用したり、ページングまたは並べ替えインターフェイスをさらに強化したりするには、より多くの労力を用いる必要があります。</span><span class="sxs-lookup"><span data-stu-id="27520-289">While implementing basic paging and sorting is a breeze, more effort must be exerted to utilize the more efficient custom paging or to further enhance the paging or sorting interface.</span></span> <span data-ttu-id="27520-290">今後のチュートリアルでは、これらのトピックについて説明します。</span><span class="sxs-lookup"><span data-stu-id="27520-290">Future tutorials will explore these topics.</span></span>

<span data-ttu-id="27520-291">プログラミングを楽しんでください。</span><span class="sxs-lookup"><span data-stu-id="27520-291">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="27520-292">作成者について</span><span class="sxs-lookup"><span data-stu-id="27520-292">About the Author</span></span>

<span data-ttu-id="27520-293">1998以来、 [Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml)は 7 asp/創設者 of [4GuysFromRolla.com](http://www.4guysfromrolla.com)の執筆者であり、Microsoft Web テクノロジを使用しています。</span><span class="sxs-lookup"><span data-stu-id="27520-293">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="27520-294">Scott は、独立したコンサルタント、トレーナー、およびライターとして機能します。</span><span class="sxs-lookup"><span data-stu-id="27520-294">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="27520-295">彼の最新の書籍は[ *、ASP.NET 2.0 を24時間以内に教え*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)ています。</span><span class="sxs-lookup"><span data-stu-id="27520-295">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="27520-296">mitchell@4GuysFromRolla.comでアクセスでき[ます。](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="27520-296">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="27520-297">または彼のブログを参照してください。これは[http://ScottOnWriting.NET](http://ScottOnWriting.NET)にあります。</span><span class="sxs-lookup"><span data-stu-id="27520-297">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="27520-298">[前へ](creating-a-customized-sorting-user-interface-cs.md)
> [次へ](efficiently-paging-through-large-amounts-of-data-vb.md)</span><span class="sxs-lookup"><span data-stu-id="27520-298">[Previous](creating-a-customized-sorting-user-interface-cs.md)
[Next](efficiently-paging-through-large-amounts-of-data-vb.md)</span></span>

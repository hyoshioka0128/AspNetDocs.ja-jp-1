---
uid: web-forms/overview/data-access/displaying-data-with-the-datalist-and-repeater/formatting-the-datalist-and-repeater-based-upon-data-cs
title: データに基づいて DataList と Repeater を書式C#設定する () |Microsoft Docs
author: rick-anderson
description: このチュートリアルでは、次のように書式設定関数を使用して、DataList コントロールと Repeater コントロールの外観を書式設定する方法の例について説明します。
ms.author: riande
ms.date: 09/13/2006
ms.assetid: 83e3d759-82b8-41e6-8d62-f0f4b3edec41
msc.legacyurl: /web-forms/overview/data-access/displaying-data-with-the-datalist-and-repeater/formatting-the-datalist-and-repeater-based-upon-data-cs
msc.type: authoredcontent
ms.openlocfilehash: 68de3450ed97fc7bd0efb27e089d9db8e3e85fb0
ms.sourcegitcommit: 22fbd8863672c4ad6693b8388ad5c8e753fb41a2
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 11/28/2019
ms.locfileid: "74633232"
---
# <a name="formatting-the-datalist-and-repeater-based-upon-data-c"></a><span data-ttu-id="ec6fa-103">データに基づいて DataList と Repeater を書式設定する (C#)</span><span class="sxs-lookup"><span data-stu-id="ec6fa-103">Formatting the DataList and Repeater Based Upon Data (C#)</span></span>

<span data-ttu-id="ec6fa-104">[Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="ec6fa-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="ec6fa-105">[サンプルアプリのダウンロード](https://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_30_CS.exe)または[PDF のダウンロード](formatting-the-datalist-and-repeater-based-upon-data-cs/_static/datatutorial30cs1.pdf)</span><span class="sxs-lookup"><span data-stu-id="ec6fa-105">[Download Sample App](https://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_30_CS.exe) or [Download PDF](formatting-the-datalist-and-repeater-based-upon-data-cs/_static/datatutorial30cs1.pdf)</span></span>

> <span data-ttu-id="ec6fa-106">このチュートリアルでは、テンプレート内で書式設定関数を使用するか、データバインドイベントを処理することによって、DataList コントロールと Repeater コントロールの外観を書式設定する方法の例について説明します。</span><span class="sxs-lookup"><span data-stu-id="ec6fa-106">In this tutorial we'll step through examples of how we format the appearance of the DataList and Repeater controls, either by using formatting functions within templates or by handling the DataBound event.</span></span>

## <a name="introduction"></a><span data-ttu-id="ec6fa-107">はじめに</span><span class="sxs-lookup"><span data-stu-id="ec6fa-107">Introduction</span></span>

<span data-ttu-id="ec6fa-108">前のチュートリアルで見たように、DataList には、外観に影響を与えるさまざまなスタイル関連のプロパティが用意されています。</span><span class="sxs-lookup"><span data-stu-id="ec6fa-108">As we saw in the preceding tutorial, the DataList offers a number of style-related properties that affect its appearance.</span></span> <span data-ttu-id="ec6fa-109">特に、既定の CSS クラスを DataList s `HeaderStyle`、`ItemStyle`、`AlternatingItemStyle`、および `SelectedItemStyle` プロパティに割り当てる方法について説明しました。</span><span class="sxs-lookup"><span data-stu-id="ec6fa-109">In particular, we saw how to assign default CSS classes to the DataList s `HeaderStyle`, `ItemStyle`, `AlternatingItemStyle`, and `SelectedItemStyle` properties.</span></span> <span data-ttu-id="ec6fa-110">これらの4つのプロパティに加えて、DataList には、`Font`、`ForeColor`、`BackColor`、`BorderWidth`など、いくつかのスタイル関連プロパティがいくつか含まれています。</span><span class="sxs-lookup"><span data-stu-id="ec6fa-110">In addition to these four properties, the DataList includes a number of other style-related properties, such as `Font`, `ForeColor`, `BackColor`, and `BorderWidth`, to name a few.</span></span> <span data-ttu-id="ec6fa-111">Repeater コントロールにスタイル関連のプロパティが含まれていません。</span><span class="sxs-lookup"><span data-stu-id="ec6fa-111">The Repeater control does not contain any style-related properties.</span></span> <span data-ttu-id="ec6fa-112">このようなスタイル設定は、Repeater s テンプレートのマークアップ内で直接行う必要があります。</span><span class="sxs-lookup"><span data-stu-id="ec6fa-112">Any such style settings must be made directly within the markup in the Repeater s templates.</span></span>

<span data-ttu-id="ec6fa-113">しかし、多くの場合、データを書式設定する方法は、データ自体によって異なります。</span><span class="sxs-lookup"><span data-stu-id="ec6fa-113">Often, though, how data should be formatted depends on the data itself.</span></span> <span data-ttu-id="ec6fa-114">たとえば、製品を一覧表示する場合は、製品情報を薄い灰色のフォントの色で表示することができます。または、`UnitsInStock` 値がゼロの場合に強調表示することもできます。</span><span class="sxs-lookup"><span data-stu-id="ec6fa-114">For example, when listing products we might want to display the product information in a light gray font color if it is discontinued, or we may want to highlight the `UnitsInStock` value if it is zero.</span></span> <span data-ttu-id="ec6fa-115">前のチュートリアルで見たように、GridView、DetailsView、および FormView には、データに基づいて外観を書式設定するための2つの方法が用意されています。</span><span class="sxs-lookup"><span data-stu-id="ec6fa-115">As we saw in previous tutorials, the GridView, DetailsView, and FormView offer two distinct ways to format their appearance based on their data:</span></span>

- <span data-ttu-id="ec6fa-116">**`DataBound` イベントは**、適切な `DataBound` イベントのイベントハンドラーを作成します。これは、データが各項目にバインドされた後に発生します (GridView の場合は `RowDataBound` イベント、DataList と Repeater の場合は `ItemDataBound` イベント)。</span><span class="sxs-lookup"><span data-stu-id="ec6fa-116">**The `DataBound` event** create an event handler for the appropriate `DataBound` event, which fires after the data has been bound to each item (for the GridView it was the `RowDataBound` event; for the DataList and Repeater it is the `ItemDataBound` event).</span></span> <span data-ttu-id="ec6fa-117">このイベントハンドラーでは、バインドされたデータのみを調べて、書式設定の決定を行うことができます。</span><span class="sxs-lookup"><span data-stu-id="ec6fa-117">In that event handler, the data just bound can be examined and formatting decisions made.</span></span> <span data-ttu-id="ec6fa-118">この手法は、「[データに基づくカスタム書式](../custom-formatting/custom-formatting-based-upon-data-cs.md)設定」チュートリアルで確認しています。</span><span class="sxs-lookup"><span data-stu-id="ec6fa-118">We examined this technique in the [Custom Formatting Based Upon Data](../custom-formatting/custom-formatting-based-upon-data-cs.md) tutorial.</span></span>
- <span data-ttu-id="ec6fa-119">**テンプレートの関数の書式設定**DetailsView コントロールまたは GridView コントロールで templatefields を使用する場合、または FormView コントロールでテンプレートを使用する場合、書式設定関数を ASP.NET ページの分離コードクラス、ビジネスロジック層、または web アプリケーションからアクセスできるその他のクラスライブラリに追加できます。</span><span class="sxs-lookup"><span data-stu-id="ec6fa-119">**Formatting Functions in Templates** when using TemplateFields in the DetailsView or GridView controls, or a template in the FormView control, we can add a formatting function to the ASP.NET page s code-behind class, the Business Logic Layer, or any other class library that is accessible from the web application.</span></span> <span data-ttu-id="ec6fa-120">この書式設定関数は任意の数の入力パラメーターを受け取ることができますが、テンプレートに表示する HTML を返す必要があります。</span><span class="sxs-lookup"><span data-stu-id="ec6fa-120">This formatting function can accept an arbitrary number of input parameters, but must return the HTML to render in the template.</span></span> <span data-ttu-id="ec6fa-121">書式設定関数は、 [GridView コントロールチュートリアルの「Templatetemplatefields](../custom-formatting/using-templatefields-in-the-gridview-control-cs.md) 」で最初に検証されました。</span><span class="sxs-lookup"><span data-stu-id="ec6fa-121">Formatting functions were first examined in the [Using TemplateFields in the GridView Control](../custom-formatting/using-templatefields-in-the-gridview-control-cs.md) tutorial.</span></span>

<span data-ttu-id="ec6fa-122">これらの両方の書式設定手法は、DataList コントロールと Repeater コントロールで使用できます。</span><span class="sxs-lookup"><span data-stu-id="ec6fa-122">Both of these formatting techniques are available with the DataList and Repeater controls.</span></span> <span data-ttu-id="ec6fa-123">このチュートリアルでは、両方のコントロールに対して両方の手法を使用する例について説明します。</span><span class="sxs-lookup"><span data-stu-id="ec6fa-123">In this tutorial we'll step through examples using both techniques for both controls.</span></span>

## <a name="using-theitemdataboundevent-handler"></a><span data-ttu-id="ec6fa-124">`ItemDataBound`イベントハンドラーの使用</span><span class="sxs-lookup"><span data-stu-id="ec6fa-124">Using the`ItemDataBound`Event Handler</span></span>

<span data-ttu-id="ec6fa-125">データソースコントロールから、またはプログラムによってコントロール s `DataSource` プロパティにデータを割り当て、その `DataBind()` メソッドを呼び出すことによって、データが DataList にバインドされている場合、DataList s `DataBinding` イベントが発生し、データソースが列挙され、各データレコードが DataList にバインドされます。</span><span class="sxs-lookup"><span data-stu-id="ec6fa-125">When data is bound to a DataList, either from a data source control or through programmatically assigning data to the control s `DataSource` property and calling its `DataBind()` method, the DataList s `DataBinding` event fires, the data source enumerated, and each data record is bound to the DataList.</span></span> <span data-ttu-id="ec6fa-126">DataList は、データソース内の各レコードについて、現在のレコードにバインドされる[`DataListItem`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.datalistitem.aspx)オブジェクトを作成します。</span><span class="sxs-lookup"><span data-stu-id="ec6fa-126">For each record in the data source, the DataList creates a [`DataListItem`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.datalistitem.aspx) object that is then bound to the current record.</span></span> <span data-ttu-id="ec6fa-127">この処理中、DataList は次の2つのイベントを発生させます。</span><span class="sxs-lookup"><span data-stu-id="ec6fa-127">During this process, the DataList raises two events:</span></span>

- <span data-ttu-id="ec6fa-128">`DataListItem` が作成された後に起動 **`ItemCreated`**</span><span class="sxs-lookup"><span data-stu-id="ec6fa-128">**`ItemCreated`** fires after the `DataListItem` has been created</span></span>
- <span data-ttu-id="ec6fa-129">**`ItemDataBound`** は、現在のレコードが `DataListItem` にバインドされた後に発生します</span><span class="sxs-lookup"><span data-stu-id="ec6fa-129">**`ItemDataBound`** fires after the current record has been bound to the `DataListItem`</span></span>

<span data-ttu-id="ec6fa-130">次の手順では、DataList コントロールのデータバインディングプロセスの概要を示します。</span><span class="sxs-lookup"><span data-stu-id="ec6fa-130">The following steps outline the data binding process for the DataList control.</span></span>

1. <span data-ttu-id="ec6fa-131">DataList s [`DataBinding` イベント](https://msdn.microsoft.com/library/system.web.ui.control.databinding.aspx)が発生します。</span><span class="sxs-lookup"><span data-stu-id="ec6fa-131">The DataList s [`DataBinding` event](https://msdn.microsoft.com/library/system.web.ui.control.databinding.aspx) fires</span></span>
2. <span data-ttu-id="ec6fa-132">データは DataList にバインドされます。</span><span class="sxs-lookup"><span data-stu-id="ec6fa-132">The data is bound to the DataList</span></span>  
  
   <span data-ttu-id="ec6fa-133">データソース内の各レコードについて</span><span class="sxs-lookup"><span data-stu-id="ec6fa-133">For each record in the data source</span></span> 

    1. <span data-ttu-id="ec6fa-134">`DataListItem` オブジェクトを作成する</span><span class="sxs-lookup"><span data-stu-id="ec6fa-134">Create a `DataListItem` object</span></span>
    2. <span data-ttu-id="ec6fa-135">[`ItemCreated` イベント](https://msdn.microsoft.com/library/system.web.ui.webcontrols.datalist.itemcreated.aspx)を起動します</span><span class="sxs-lookup"><span data-stu-id="ec6fa-135">Fire the [`ItemCreated` event](https://msdn.microsoft.com/library/system.web.ui.webcontrols.datalist.itemcreated.aspx)</span></span>
    3. <span data-ttu-id="ec6fa-136">レコードを `DataListItem` にバインドする</span><span class="sxs-lookup"><span data-stu-id="ec6fa-136">Bind the record to the `DataListItem`</span></span>
    4. <span data-ttu-id="ec6fa-137">[`ItemDataBound` イベント](https://msdn.microsoft.com/library/system.web.ui.webcontrols.datalist.itemdatabound.aspx)を起動します</span><span class="sxs-lookup"><span data-stu-id="ec6fa-137">Fire the [`ItemDataBound` event](https://msdn.microsoft.com/library/system.web.ui.webcontrols.datalist.itemdatabound.aspx)</span></span>
    5. <span data-ttu-id="ec6fa-138">`Items` コレクションに `DataListItem` を追加します。</span><span class="sxs-lookup"><span data-stu-id="ec6fa-138">Add the `DataListItem` to the `Items` collection</span></span>

<span data-ttu-id="ec6fa-139">Repeater コントロールにデータをバインドする場合、同じ一連の手順を実行します。</span><span class="sxs-lookup"><span data-stu-id="ec6fa-139">When binding data to the Repeater control, it progresses through the exact same sequence of steps.</span></span> <span data-ttu-id="ec6fa-140">唯一の違いは、`DataListItem` インスタンスが作成されるのではなく、リピータが[`RepeaterItem`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.repeateritem(VS.80).aspx)s を使用することです。</span><span class="sxs-lookup"><span data-stu-id="ec6fa-140">The only difference is that instead of `DataListItem` instances being created, the Repeater uses [`RepeaterItem`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.repeateritem(VS.80).aspx)s.</span></span>

> [!NOTE]
> <span data-ttu-id="ec6fa-141">ずる賢い reader は、DataList と Repeater がデータにバインドされている場合と、GridView がデータにバインドされている場合に発生する一連の手順がわずかに異常であると認識している可能性があります。</span><span class="sxs-lookup"><span data-stu-id="ec6fa-141">The astute reader may have noticed a slight anomaly between the sequence of steps that transpire when the DataList and Repeater are bound to data versus when the GridView is bound to data.</span></span> <span data-ttu-id="ec6fa-142">データバインディングプロセスの末尾で、GridView によって `DataBound` イベントが発生します。ただし、このようなイベントは、DataList と Repeater の両方のコントロールにはありません。</span><span class="sxs-lookup"><span data-stu-id="ec6fa-142">At the tail end of the data binding process, the GridView raises the `DataBound` event; however, neither the DataList nor Repeater control have such an event.</span></span> <span data-ttu-id="ec6fa-143">これは、以前レベルのイベントハンドラーパターンが共通になる前に、DataList コントロールと Repeater コントロールが ASP.NET 1.x タイムフレームで作成されたためです。</span><span class="sxs-lookup"><span data-stu-id="ec6fa-143">This is because the DataList and Repeater controls were created back in the ASP.NET 1.x timeframe, before the pre- and post-level event handler pattern had become common.</span></span>

<span data-ttu-id="ec6fa-144">GridView の場合と同様に、データに基づいて書式を設定するためのオプションの1つとして、`ItemDataBound` イベントのイベントハンドラーを作成する方法があります。</span><span class="sxs-lookup"><span data-stu-id="ec6fa-144">Like with the GridView, one option for formatting based on the data is to create an event handler for the `ItemDataBound` event.</span></span> <span data-ttu-id="ec6fa-145">このイベントハンドラーは、`DataListItem` または `RepeaterItem` にバインドされたばかりのデータを検査し、必要に応じてコントロールの書式設定に影響を与えます。</span><span class="sxs-lookup"><span data-stu-id="ec6fa-145">This event handler would inspect the data that had just been bound to the `DataListItem` or `RepeaterItem` and affect the formatting of the control as needed.</span></span>

<span data-ttu-id="ec6fa-146">DataList コントロールでは、標準の `Font`、`ForeColor`、`BackColor`、`CssClass`などを含む `DataListItem` s スタイル関連のプロパティを使用して、項目全体の書式設定の変更を実装できます。</span><span class="sxs-lookup"><span data-stu-id="ec6fa-146">For the DataList control, formatting changes for the entire item can be implemented using the `DataListItem` s style-related properties, which include the standard `Font`, `ForeColor`, `BackColor`, `CssClass`, and so on.</span></span> <span data-ttu-id="ec6fa-147">DataList s テンプレート内の特定の Web コントロールの書式設定に影響を与えるには、プログラムを使用して、Web コントロールのスタイルにアクセスして変更する必要があります。</span><span class="sxs-lookup"><span data-stu-id="ec6fa-147">To affect the formatting of particular Web controls within the DataList s template, we need to programmatically access and modify the style of those Web controls.</span></span> <span data-ttu-id="ec6fa-148">データのチュートリアルに*基づくカスタム書式*設定でこれを実現する方法について説明しました。</span><span class="sxs-lookup"><span data-stu-id="ec6fa-148">We saw how to accomplish this back in the *Custom Formatting Based Upon Data* tutorial.</span></span> <span data-ttu-id="ec6fa-149">Repeater コントロールと同様に、`RepeaterItem` クラスにはスタイル関連のプロパティがありません。したがって、`ItemDataBound` イベントハンドラーの `RepeaterItem` に加えられたスタイル関連のすべての変更は、プログラムによってテンプレート内の Web コントロールにアクセスして更新する必要があります。</span><span class="sxs-lookup"><span data-stu-id="ec6fa-149">Like the Repeater control, the `RepeaterItem` class has no style-related properties; therefore, all style-related changes made to a `RepeaterItem` in the `ItemDataBound` event handler must be done by programmatically accessing and updating Web controls within the template.</span></span>

<span data-ttu-id="ec6fa-150">DataList と Repeater の `ItemDataBound` の書式設定手法は事実上同じであるため、この例では DataList の使用に焦点を当てます。</span><span class="sxs-lookup"><span data-stu-id="ec6fa-150">Since the `ItemDataBound` formatting technique for the DataList and Repeater are virtually identical, our example will focus on using the DataList.</span></span>

## <a name="step-1-displaying-product-information-in-the-datalist"></a><span data-ttu-id="ec6fa-151">手順 1: DataList で製品情報を表示する</span><span class="sxs-lookup"><span data-stu-id="ec6fa-151">Step 1: Displaying Product Information in the DataList</span></span>

<span data-ttu-id="ec6fa-152">書式設定について心配する前に、まず、DataList を使用して製品情報を表示するページを作成してみましょう。</span><span class="sxs-lookup"><span data-stu-id="ec6fa-152">Before we worry about the formatting, let s first create a page that uses a DataList to display product information.</span></span> <span data-ttu-id="ec6fa-153">前の[チュートリアル](displaying-data-with-the-datalist-and-repeater-controls-cs.md)では、各製品の名前、カテゴリ、仕入先、数量/ユニット、価格を表示 `ItemTemplate` を持つ DataList を作成しました。</span><span class="sxs-lookup"><span data-stu-id="ec6fa-153">In the [previous tutorial](displaying-data-with-the-datalist-and-repeater-controls-cs.md) we created a DataList whose `ItemTemplate` displayed each product s name, category, supplier, quantity per unit, and price.</span></span> <span data-ttu-id="ec6fa-154">このチュートリアルでは、この機能を繰り返してみましょう。</span><span class="sxs-lookup"><span data-stu-id="ec6fa-154">Let s repeat this functionality here in this tutorial.</span></span> <span data-ttu-id="ec6fa-155">これを実現するには、DataList とその ObjectDataSource をゼロから再作成するか、前のチュートリアルで作成したページ (`Basics.aspx`) からこれらのコントロールをコピーして、このチュートリアルのページ (`Formatting.aspx`) に貼り付けます。</span><span class="sxs-lookup"><span data-stu-id="ec6fa-155">To accomplish this, you can either recreate the DataList and its ObjectDataSource from scratch, or you can copy over those controls from the page created in the previous tutorial (`Basics.aspx`) and paste them into the page for this tutorial (`Formatting.aspx`).</span></span>

<span data-ttu-id="ec6fa-156">DataList および ObjectDataSource 機能を `Basics.aspx` から `Formatting.aspx`にレプリケートしたら、DataList s `ID` プロパティを `DataList1` からよりわかりやすい `ItemDataBoundFormattingExample`に変更します。</span><span class="sxs-lookup"><span data-stu-id="ec6fa-156">Once you have replicated the DataList and ObjectDataSource functionality from `Basics.aspx` into `Formatting.aspx`, take a moment to change the DataList s `ID` property from `DataList1` to a more descriptive `ItemDataBoundFormattingExample`.</span></span> <span data-ttu-id="ec6fa-157">次に、ブラウザーで DataList を表示します。</span><span class="sxs-lookup"><span data-stu-id="ec6fa-157">Next, view the DataList in a browser.</span></span> <span data-ttu-id="ec6fa-158">図1に示すように、各製品の書式設定の違いは、背景色が交互に表示されることだけです。</span><span class="sxs-lookup"><span data-stu-id="ec6fa-158">As Figure 1 shows, the only formatting difference between each product is that the background color alternates.</span></span>

<span data-ttu-id="ec6fa-159">[DataList コントロールに製品が一覧表示され ![](formatting-the-datalist-and-repeater-based-upon-data-cs/_static/image2.png)](formatting-the-datalist-and-repeater-based-upon-data-cs/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="ec6fa-159">[![The Products are Listed in the DataList Control](formatting-the-datalist-and-repeater-based-upon-data-cs/_static/image2.png)](formatting-the-datalist-and-repeater-based-upon-data-cs/_static/image1.png)</span></span>

<span data-ttu-id="ec6fa-160">**図 1**: 製品が DataList コントロールに一覧表示される ([クリックしてフルサイズの画像を表示する](formatting-the-datalist-and-repeater-based-upon-data-cs/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="ec6fa-160">**Figure 1**: The Products are Listed in the DataList Control ([Click to view full-size image](formatting-the-datalist-and-repeater-based-upon-data-cs/_static/image3.png))</span></span>

<span data-ttu-id="ec6fa-161">このチュートリアルでは、$20.00 より小さい価格の製品については、名前と単価の両方が黄色で強調表示されるように DataList を設定します。</span><span class="sxs-lookup"><span data-stu-id="ec6fa-161">For this tutorial, let s format the DataList such that any products with a price less than $20.00 will have both its name and unit price highlighted yellow.</span></span>

## <a name="step-2-programmatically-determining-the-value-of-the-data-in-the-itemdatabound-event-handler"></a><span data-ttu-id="ec6fa-162">手順 2: プログラムによる ItemDataBound バインドイベントハンドラーのデータの値の決定</span><span class="sxs-lookup"><span data-stu-id="ec6fa-162">Step 2: Programmatically Determining the Value of the Data in the ItemDataBound Event Handler</span></span>

<span data-ttu-id="ec6fa-163">$20.00 未満の価格の製品でのみカスタム書式が適用されるため、各製品の価格を決定できる必要があります。</span><span class="sxs-lookup"><span data-stu-id="ec6fa-163">Since only those products with a price under $20.00 will have the custom formatting applied, we must be able to determine each product s price.</span></span> <span data-ttu-id="ec6fa-164">Datalist にデータをバインドすると、DataList はデータソース内のレコードを列挙し、各レコードについて `DataListItem` インスタンスを作成して、データソースレコードを `DataListItem`にバインドします。</span><span class="sxs-lookup"><span data-stu-id="ec6fa-164">When binding data to a DataList, the DataList enumerates the records in its data source and, for each record, creates a `DataListItem` instance, binding the data source record to the `DataListItem`.</span></span> <span data-ttu-id="ec6fa-165">特定のレコード s データが現在の `DataListItem` オブジェクトにバインドされると、DataList s `ItemDataBound` イベントが発生します。</span><span class="sxs-lookup"><span data-stu-id="ec6fa-165">After the particular record s data has been bound to the current `DataListItem` object, the DataList s `ItemDataBound` event is fired.</span></span> <span data-ttu-id="ec6fa-166">このイベントのイベントハンドラーを作成して、現在の `DataListItem` のデータ値を検査し、それらの値に基づいて書式設定の変更を行うことができます。</span><span class="sxs-lookup"><span data-stu-id="ec6fa-166">We can create an event handler for this event to inspect the data values for the current `DataListItem` and, based upon those values, make any formatting changes necessary.</span></span>

<span data-ttu-id="ec6fa-167">DataList の `ItemDataBound` イベントを作成し、次のコードを追加します。</span><span class="sxs-lookup"><span data-stu-id="ec6fa-167">Create an `ItemDataBound` event for the DataList and add the following code:</span></span>

[!code-csharp[Main](formatting-the-datalist-and-repeater-based-upon-data-cs/samples/sample1.cs)]

<span data-ttu-id="ec6fa-168">DataList s `ItemDataBound` イベントハンドラーの背後にある概念とセマンティクスは、「*データに基づくカスタム書式*設定」チュートリアルの GridView s `RowDataBound` イベントハンドラーで使用されているものと同じですが、構文は若干異なります。</span><span class="sxs-lookup"><span data-stu-id="ec6fa-168">While the concept and semantics behind the DataList s `ItemDataBound` event handler are the same as those used by the GridView s `RowDataBound` event handler in the *Custom Formatting Based Upon Data* tutorial, the syntax differs slightly.</span></span> <span data-ttu-id="ec6fa-169">`ItemDataBound` イベントが発生すると、データにバインドされた `DataListItem` は、`e.Row`(GridView s `RowDataBound` イベントハンドラーと同様に) `e.Item` 経由で対応するイベントハンドラーに渡されます。</span><span class="sxs-lookup"><span data-stu-id="ec6fa-169">When the `ItemDataBound` event fires, the `DataListItem` just bound to data is passed into corresponding event handler via `e.Item` (instead of `e.Row`, as with the GridView s `RowDataBound` event handler).</span></span> <span data-ttu-id="ec6fa-170">Datalist s `ItemDataBound` イベントハンドラーは、ヘッダー行、フッター行、および区切り行を含む、DataList に追加され*た各行に対して*発生します。</span><span class="sxs-lookup"><span data-stu-id="ec6fa-170">The DataList s `ItemDataBound` event handler fires for *each* row added to the DataList, including header rows, footer rows, and separator rows.</span></span> <span data-ttu-id="ec6fa-171">ただし、製品情報はデータ行にのみバインドされます。</span><span class="sxs-lookup"><span data-stu-id="ec6fa-171">However, the product information is only bound to the data rows.</span></span> <span data-ttu-id="ec6fa-172">そのため、`ItemDataBound` イベントを使用して DataList にバインドされたデータを検査する場合は、まずデータ項目を操作していることを確認する必要があります。</span><span class="sxs-lookup"><span data-stu-id="ec6fa-172">Therefore, when using the `ItemDataBound` event to inspect the data bound to the DataList, we need to first ensure that we re working with a data item.</span></span> <span data-ttu-id="ec6fa-173">これは、[次の 8](https://msdn.microsoft.com/library/system.web.ui.webcontrols.listitemtype.aspx)つの値のいずれかを持つ `DataListItem` s [`ItemType` プロパティ](https://msdn.microsoft.com/library/system.web.ui.webcontrols.datalistitem.itemtype.aspx)を確認することで実現できます。</span><span class="sxs-lookup"><span data-stu-id="ec6fa-173">This can be accomplished by checking the `DataListItem` s [`ItemType` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.datalistitem.itemtype.aspx), which can have one of [the following eight values](https://msdn.microsoft.com/library/system.web.ui.webcontrols.listitemtype.aspx):</span></span>

- `AlternatingItem`
- `EditItem`
- `Footer`
- `Header`
- `Item`
- `Pager`
- `SelectedItem`
- `Separator`

<span data-ttu-id="ec6fa-174">`Item` と `AlternatingItem``DataListItem` s の両方が、DataList s データ項目を行います。</span><span class="sxs-lookup"><span data-stu-id="ec6fa-174">Both `Item` and `AlternatingItem``DataListItem` s makeup the DataList s data items.</span></span> <span data-ttu-id="ec6fa-175">`Item` または `AlternatingItem`を操作していると仮定すると、現在の `DataListItem`にバインドされている実際の `ProductsRow` インスタンスにアクセスします。</span><span class="sxs-lookup"><span data-stu-id="ec6fa-175">Assuming we re working with an `Item` or `AlternatingItem`, we access the actual `ProductsRow` instance that was bound to the current `DataListItem`.</span></span> <span data-ttu-id="ec6fa-176">`DataListItem` s [`DataItem` プロパティ](https://msdn.microsoft.com/system.web.ui.webcontrols.datalistitem.dataitem.aspx)には、`DataRowView` オブジェクトへの参照が含まれています。このオブジェクトの `Row` プロパティは、実際の `ProductsRow` オブジェクトへの参照を提供します。</span><span class="sxs-lookup"><span data-stu-id="ec6fa-176">The `DataListItem` s [`DataItem` property](https://msdn.microsoft.com/system.web.ui.webcontrols.datalistitem.dataitem.aspx) contains a reference to the `DataRowView` object, whose `Row` property provides a reference to the actual `ProductsRow` object.</span></span>

<span data-ttu-id="ec6fa-177">次に、`ProductsRow` instance s `UnitPrice` プロパティを確認します。</span><span class="sxs-lookup"><span data-stu-id="ec6fa-177">Next, we check the `ProductsRow` instance s `UnitPrice` property.</span></span> <span data-ttu-id="ec6fa-178">Products テーブルの `UnitPrice` フィールドでは `NULL` 値が許可されているため、`UnitPrice` プロパティにアクセスする前に、まず、`IsUnitPriceNull()` メソッドを使用して `NULL` 値があるかどうかを確認する必要があります。</span><span class="sxs-lookup"><span data-stu-id="ec6fa-178">Since the Products table s `UnitPrice` field allows `NULL` values, before attempting to access the `UnitPrice` property we should first check to see if it has a `NULL` value using the `IsUnitPriceNull()` method.</span></span> <span data-ttu-id="ec6fa-179">`UnitPrice` 値が `NULL`ていない場合は、が $20.00 未満かどうかを確認します。</span><span class="sxs-lookup"><span data-stu-id="ec6fa-179">If the `UnitPrice` value is not `NULL`, we then check to see if it s less than $20.00.</span></span> <span data-ttu-id="ec6fa-180">実際に $20.00 未満の場合は、カスタム書式設定を適用する必要があります。</span><span class="sxs-lookup"><span data-stu-id="ec6fa-180">If it is indeed under $20.00, we then need to apply the custom formatting.</span></span>

## <a name="step-3-highlighting-the-product-s-name-and-price"></a><span data-ttu-id="ec6fa-181">手順 3: 製品名と価格を強調表示する</span><span class="sxs-lookup"><span data-stu-id="ec6fa-181">Step 3: Highlighting the Product s Name and Price</span></span>

<span data-ttu-id="ec6fa-182">製品の価格が $20.00 未満であることを確認したら、その名前と価格を強調表示します。</span><span class="sxs-lookup"><span data-stu-id="ec6fa-182">Once we know that a product s price is less than $20.00, all that remains is to highlight its name and price.</span></span> <span data-ttu-id="ec6fa-183">これを実現するには、最初に製品の名前と価格を表示する `ItemTemplate` のラベルコントロールをプログラムで参照する必要があります。</span><span class="sxs-lookup"><span data-stu-id="ec6fa-183">To accomplish this, we must first programmatically reference the Label controls in the `ItemTemplate` that display the product s name and price.</span></span> <span data-ttu-id="ec6fa-184">次に、黄色の背景を表示する必要があります。</span><span class="sxs-lookup"><span data-stu-id="ec6fa-184">Next, we need to have them display a yellow background.</span></span> <span data-ttu-id="ec6fa-185">この書式設定情報は、ラベル `BackColor` プロパティ (`LabelID.BackColor = Color.Yellow`) を直接変更することで適用できます。ただし、すべての表示に関連する問題は、カスケードスタイルシートを通じて表現するのが理想的です。</span><span class="sxs-lookup"><span data-stu-id="ec6fa-185">This formatting information can be applied by directly modifying the Labels `BackColor` properties (`LabelID.BackColor = Color.Yellow`); ideally, though, all display-related matters should be expressed through cascading stylesheets.</span></span> <span data-ttu-id="ec6fa-186">実際には、`Styles.css` - `AffordablePriceEmphasis`で定義されている、必要な書式設定を提供するスタイルシートが既に用意されています。このスタイルは、「*データに基づくカスタム書式*設定」のチュートリアルで作成し、説明しました。</span><span class="sxs-lookup"><span data-stu-id="ec6fa-186">In fact, we already have a stylesheet that provides the desired formatting defined in `Styles.css` - `AffordablePriceEmphasis`, which was created and discussed in the *Custom Formatting Based Upon Data* tutorial.</span></span>

<span data-ttu-id="ec6fa-187">書式設定を適用するには、次のコードに示すように、2つのラベル Web コントロール `CssClass` プロパティを `AffordablePriceEmphasis`に設定するだけです。</span><span class="sxs-lookup"><span data-stu-id="ec6fa-187">To apply the formatting, simply set the two Label Web controls `CssClass` properties to `AffordablePriceEmphasis`, as shown in the following code:</span></span>

[!code-csharp[Main](formatting-the-datalist-and-repeater-based-upon-data-cs/samples/sample2.cs)]

<span data-ttu-id="ec6fa-188">`ItemDataBound` イベントハンドラーが完了したら、ブラウザーで `Formatting.aspx` のページに戻ります。</span><span class="sxs-lookup"><span data-stu-id="ec6fa-188">With the `ItemDataBound` event handler completed, revisit the `Formatting.aspx` page in a browser.</span></span> <span data-ttu-id="ec6fa-189">図2に示すように、$20.00 の価格の製品には、名前と価格の両方が強調表示されています。</span><span class="sxs-lookup"><span data-stu-id="ec6fa-189">As Figure 2 illustrates, those products with a price under $20.00 have both their name and price highlighted.</span></span>

<span data-ttu-id="ec6fa-190">[$20.00 未満の製品が強調表示されている ![](formatting-the-datalist-and-repeater-based-upon-data-cs/_static/image5.png)](formatting-the-datalist-and-repeater-based-upon-data-cs/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="ec6fa-190">[![Those Products Less than $20.00 are Highlighted](formatting-the-datalist-and-repeater-based-upon-data-cs/_static/image5.png)](formatting-the-datalist-and-repeater-based-upon-data-cs/_static/image4.png)</span></span>

<span data-ttu-id="ec6fa-191">**図 2**: $20.00 未満の製品が強調表示されている ([クリックすると、フルサイズの画像が表示](formatting-the-datalist-and-repeater-based-upon-data-cs/_static/image6.png)されます)</span><span class="sxs-lookup"><span data-stu-id="ec6fa-191">**Figure 2**: Those Products Less than $20.00 are Highlighted ([Click to view full-size image](formatting-the-datalist-and-repeater-based-upon-data-cs/_static/image6.png))</span></span>

> [!NOTE]
> <span data-ttu-id="ec6fa-192">DataList は HTML `<table>`として表示されるため、その `DataListItem` インスタンスには、特定のスタイルを項目全体に適用するように設定できるスタイル関連のプロパティがあります。</span><span class="sxs-lookup"><span data-stu-id="ec6fa-192">Since the DataList is rendered as an HTML `<table>`, its `DataListItem` instances have style-related properties that can be set to apply a specific style to the entire item.</span></span> <span data-ttu-id="ec6fa-193">たとえば、価格が $20.00 未満の場合に、項目*全体*を黄色で強調表示するには、ラベルを参照したコードを置き換えて、その `CssClass` プロパティを次のコード行に設定し `e.Item.CssClass = "AffordablePriceEmphasis"` ます (図3を参照)。</span><span class="sxs-lookup"><span data-stu-id="ec6fa-193">For example, if we wanted to highlight the *entire* item yellow when its price was less than $20.00, we could have replaced the code that referenced the Labels and set their `CssClass` properties with the following line of code: `e.Item.CssClass = "AffordablePriceEmphasis"` (see Figure 3).</span></span>

<span data-ttu-id="ec6fa-194">Repeater コントロールを構成する `RepeaterItem` s は、このようなスタイルレベルのプロパティを提供しません。</span><span class="sxs-lookup"><span data-stu-id="ec6fa-194">The `RepeaterItem` s that make up the Repeater control, however, don t offer such style-level properties.</span></span> <span data-ttu-id="ec6fa-195">したがって、カスタム書式設定をリピータに適用するには、図2のように、Repeater テンプレート内の Web コントロールにスタイルプロパティを適用する必要があります。</span><span class="sxs-lookup"><span data-stu-id="ec6fa-195">Therefore, applying custom formatting to the Repeater requires the application of style properties to the Web controls within the Repeater s templates, just like we did in Figure 2.</span></span>

<span data-ttu-id="ec6fa-196">[$20.00 未満の製品の製品項目全体が強調表示さ ![](formatting-the-datalist-and-repeater-based-upon-data-cs/_static/image8.png)](formatting-the-datalist-and-repeater-based-upon-data-cs/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="ec6fa-196">[![The Entire Product Item is Highlighted for Products Under $20.00](formatting-the-datalist-and-repeater-based-upon-data-cs/_static/image8.png)](formatting-the-datalist-and-repeater-based-upon-data-cs/_static/image7.png)</span></span>

<span data-ttu-id="ec6fa-197">**図 3**: $20.00 未満の製品の製品項目全体が強調表示されている ([クリックすると、フルサイズの画像が表示](formatting-the-datalist-and-repeater-based-upon-data-cs/_static/image9.png)されます)</span><span class="sxs-lookup"><span data-stu-id="ec6fa-197">**Figure 3**: The Entire Product Item is Highlighted for Products Under $20.00 ([Click to view full-size image](formatting-the-datalist-and-repeater-based-upon-data-cs/_static/image9.png))</span></span>

## <a name="using-formatting-functions-from-within-the-template"></a><span data-ttu-id="ec6fa-198">テンプレート内からの書式設定関数の使用</span><span class="sxs-lookup"><span data-stu-id="ec6fa-198">Using Formatting Functions from Within the Template</span></span>

<span data-ttu-id="ec6fa-199">*「Gridview コントロールでの TemplateFields の使用*」チュートリアルでは、gridview TemplateField 内で書式設定関数を使用して、gridview の行にバインドされたデータに基づいてカスタム書式を適用する方法を説明しました。</span><span class="sxs-lookup"><span data-stu-id="ec6fa-199">In the *Using TemplateFields in the GridView Control* tutorial we saw how to use a formatting function within a GridView TemplateField to apply custom formatting based upon the data bound to the GridView s rows.</span></span> <span data-ttu-id="ec6fa-200">書式設定関数は、テンプレートから呼び出すことができ、その代わりに生成される HTML を返すメソッドです。</span><span class="sxs-lookup"><span data-stu-id="ec6fa-200">A formatting function is a method that can be invoked from a template and returns the HTML to be emitted in its place.</span></span> <span data-ttu-id="ec6fa-201">書式設定関数は、ASP.NET ページの分離コードクラス内に存在することも、`App_Code` フォルダー内のクラスファイルまたは別のクラスライブラリプロジェクトに格納することもできます。</span><span class="sxs-lookup"><span data-stu-id="ec6fa-201">Formatting functions can reside in the ASP.NET page s code-behind class or can be centralized into class files in the `App_Code` folder or in a separate Class Library project.</span></span> <span data-ttu-id="ec6fa-202">ASP.NET page s 分離コードクラスから書式設定関数を移動することは、複数の ASP.NET ページまたは他の ASP.NET web アプリケーションで同じ書式指定関数を使用する予定がある場合に最適です。</span><span class="sxs-lookup"><span data-stu-id="ec6fa-202">Moving the formatting function out of the ASP.NET page s code-behind class is ideal if you plan on using the same formatting function in multiple ASP.NET pages or in other ASP.NET web applications.</span></span>

<span data-ttu-id="ec6fa-203">書式設定関数を示すために、の製品情報には、製品名の横にある [廃止] というテキストが含まれています。</span><span class="sxs-lookup"><span data-stu-id="ec6fa-203">To demonstrate formatting functions, let s have the product information include the text [DISCONTINUED] next to the product s name if it s discontinued.</span></span> <span data-ttu-id="ec6fa-204">また、が $20.00 未満の場合、価格は黄色で強調表示されます (`ItemDataBound` イベントハンドラーの例で行ったように)。価格が $20.00 以上の場合は、に実際の価格は表示されませんが、その代わりに、というテキストを入力してください。</span><span class="sxs-lookup"><span data-stu-id="ec6fa-204">Also, let s have the price highlighted yellow if it s less than $20.00 (as we did in the `ItemDataBound` event handler example); if the price is $20.00 or higher, let s not display the actual price, but instead the text, Please call for a price quote.</span></span> <span data-ttu-id="ec6fa-205">図4は、これらの書式ルールが適用された製品一覧のスクリーンショットを示しています。</span><span class="sxs-lookup"><span data-stu-id="ec6fa-205">Figure 4 shows a screen shot of the products listing with these formatting rules applied.</span></span>

<span data-ttu-id="ec6fa-206">[高額な製品の場合、価格はテキストで置き換えられます。価格の見積もりについては、をお問い合わせください ![](formatting-the-datalist-and-repeater-based-upon-data-cs/_static/image11.png)](formatting-the-datalist-and-repeater-based-upon-data-cs/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="ec6fa-206">[![For Expensive Products, the Price is Replaced with the Text, Please call for a price quote](formatting-the-datalist-and-repeater-based-upon-data-cs/_static/image11.png)](formatting-the-datalist-and-repeater-based-upon-data-cs/_static/image10.png)</span></span>

<span data-ttu-id="ec6fa-207">**図 4**: 高価な製品の場合、価格はテキストで置き換えられます。価格見積もりについては、をお問い合わせください ([クリックすると、フルサイズの画像が表示](formatting-the-datalist-and-repeater-based-upon-data-cs/_static/image12.png)されます)</span><span class="sxs-lookup"><span data-stu-id="ec6fa-207">**Figure 4**: For Expensive Products, the Price is Replaced with the Text, Please call for a price quote ([Click to view full-size image](formatting-the-datalist-and-repeater-based-upon-data-cs/_static/image12.png))</span></span>

## <a name="step-1-create-the-formatting-functions"></a><span data-ttu-id="ec6fa-208">手順 1: 書式設定関数を作成する</span><span class="sxs-lookup"><span data-stu-id="ec6fa-208">Step 1: Create the Formatting Functions</span></span>

<span data-ttu-id="ec6fa-209">この例では、2つの書式関数が必要です。1つは製品名とテキスト [廃止] を表示し、必要に応じて、強調表示された価格を $20.00 未満の場合は、テキストの場合はを、それ以外の場合はを呼び出します。</span><span class="sxs-lookup"><span data-stu-id="ec6fa-209">For this example we need two formatting functions, one that displays the product name along with the text [DISCONTINUED], if needed, and another that displays either a highlighted price if it s less than $20.00, or the text, Please call for a price quote otherwise.</span></span> <span data-ttu-id="ec6fa-210">では、ASP.NET ページの分離コードクラスでこれらの関数を作成し、`DisplayProductNameAndDiscontinuedStatus` して `DisplayPrice`という名前を指定します。</span><span class="sxs-lookup"><span data-stu-id="ec6fa-210">Let s create these functions in the ASP.NET page s code-behind class and name them `DisplayProductNameAndDiscontinuedStatus` and `DisplayPrice`.</span></span> <span data-ttu-id="ec6fa-211">どちらの方法でも、HTML を文字列として表示する必要があります。また、ASP.NET ページ s 宣言構文部分から呼び出すには、両方のメソッドが `Protected` (または `Public`) とマークされている必要があります。</span><span class="sxs-lookup"><span data-stu-id="ec6fa-211">Both methods need to return the HTML to render as a string and both need to be marked `Protected` (or `Public`) in order to be invoked from the ASP.NET page s declarative syntax portion.</span></span> <span data-ttu-id="ec6fa-212">これらの2つのメソッドのコードは次のとおりです。</span><span class="sxs-lookup"><span data-stu-id="ec6fa-212">The code for these two methods follows:</span></span>

[!code-csharp[Main](formatting-the-datalist-and-repeater-based-upon-data-cs/samples/sample3.cs)]

<span data-ttu-id="ec6fa-213">`DisplayProductNameAndDiscontinuedStatus` メソッドは、`productName` の値と `discontinued` のデータフィールドをスカラー値として受け入れます。一方、`DisplayPrice` メソッドは `ProductsRow` のスカラー値ではなく `unitPrice` インスタンスを受け入れます。</span><span class="sxs-lookup"><span data-stu-id="ec6fa-213">Note that the `DisplayProductNameAndDiscontinuedStatus` method accepts the values of the `productName` and `discontinued` data fields as scalar values, whereas the `DisplayPrice` method accepts a `ProductsRow` instance (rather than a `unitPrice` scalar value).</span></span> <span data-ttu-id="ec6fa-214">どちらの方法も使用できます。ただし、書式設定関数が、データベース `NULL` 値 (`ProductName` `UnitPrice`など) を含むことができるスカラー値を使用している場合、`Discontinued` または `NULL` 値を許可していない場合は、これらのスカラー入力を処理する際に特別な注意を払う必要があります。</span><span class="sxs-lookup"><span data-stu-id="ec6fa-214">Either approach will work; however, if the formatting function is working with scalar values that can contain database `NULL` values (such as `UnitPrice`; neither `ProductName` nor `Discontinued` allow `NULL` values), special care must be taken in handling these scalar inputs.</span></span>

<span data-ttu-id="ec6fa-215">具体的には、入力パラメーターは `Object` 型である必要があります。これは、受信値が、予期されるデータ型ではなく `DBNull` インスタンスである可能性があるためです。</span><span class="sxs-lookup"><span data-stu-id="ec6fa-215">In particular, the input parameter must be of type `Object` since the incoming value might be a `DBNull` instance instead of the expected data type.</span></span> <span data-ttu-id="ec6fa-216">さらに、受信した値がデータベース `NULL` 値であるかどうかを確認するためのチェックを行う必要があります。</span><span class="sxs-lookup"><span data-stu-id="ec6fa-216">Additionally, a check must be made to determine whether or not the incoming value is a database `NULL` value.</span></span> <span data-ttu-id="ec6fa-217">つまり、`DisplayPrice` 方法では、スカラー値として価格を受け入れる必要がある場合、次のコードを使用する必要があります。</span><span class="sxs-lookup"><span data-stu-id="ec6fa-217">That is, if we wanted the `DisplayPrice` method to accept the price as a scalar value, we d have to use the following code:</span></span>

[!code-csharp[Main](formatting-the-datalist-and-repeater-based-upon-data-cs/samples/sample4.cs)]

<span data-ttu-id="ec6fa-218">`unitPrice` 入力パラメーターの型が `Object` であり、`unitPrice` が `DBNull` かどうかを確認するために条件付きステートメントが変更されていることに注意してください。</span><span class="sxs-lookup"><span data-stu-id="ec6fa-218">Note that the `unitPrice` input parameter is of type `Object` and that the conditional statement has been modified to ascertain if `unitPrice` is `DBNull` or not.</span></span> <span data-ttu-id="ec6fa-219">さらに、`unitPrice` 入力パラメーターは `Object`として渡されるため、10進値にキャストする必要があります。</span><span class="sxs-lookup"><span data-stu-id="ec6fa-219">Furthermore, since the `unitPrice` input parameter is passed in as an `Object`, it must be cast to a decimal value.</span></span>

## <a name="step-2-calling-the-formatting-function-from-the-datalist-s-itemtemplate"></a><span data-ttu-id="ec6fa-220">手順 2: DataList s ItemTemplate からの書式設定関数の呼び出し</span><span class="sxs-lookup"><span data-stu-id="ec6fa-220">Step 2: Calling the Formatting Function from the DataList s ItemTemplate</span></span>

<span data-ttu-id="ec6fa-221">ASP.NET ページの分離コードクラスに追加された書式関数を使用すると、これらの書式設定関数を DataList s `ItemTemplate`から呼び出すだけで済みます。</span><span class="sxs-lookup"><span data-stu-id="ec6fa-221">With the formatting functions added to our ASP.NET page s code-behind class, all that remains is to invoke these formatting functions from the DataList s `ItemTemplate`.</span></span> <span data-ttu-id="ec6fa-222">テンプレートから書式設定関数を呼び出すには、関数呼び出しを databinding 構文内に配置します。</span><span class="sxs-lookup"><span data-stu-id="ec6fa-222">To call a formatting function from a template, place the function call within the databinding syntax:</span></span>

[!code-aspx[Main](formatting-the-datalist-and-repeater-based-upon-data-cs/samples/sample5.aspx)]

<span data-ttu-id="ec6fa-223">DataList s `ItemTemplate` `ProductNameLabel` Label Web コントロールは、`Text` プロパティに `<%# Eval("ProductName") %>`の結果を割り当てることによって、製品名を現在表示しています。</span><span class="sxs-lookup"><span data-stu-id="ec6fa-223">In the DataList s `ItemTemplate` the `ProductNameLabel` Label Web control currently displays the product s name by assigning its `Text` property the result of `<%# Eval("ProductName") %>`.</span></span> <span data-ttu-id="ec6fa-224">名前とテキスト [廃止] を表示するには、必要に応じて、代わりに `Text` プロパティを `DisplayProductNameAndDiscontinuedStatus` メソッドの値に割り当てるように宣言構文を更新します。</span><span class="sxs-lookup"><span data-stu-id="ec6fa-224">In order to have it display the name plus the text [DISCONTINUED], if needed, update the declarative syntax so that it instead assigns the `Text` property the value of the `DisplayProductNameAndDiscontinuedStatus` method.</span></span> <span data-ttu-id="ec6fa-225">その場合は、`Eval("columnName")` 構文を使用して、製品名と廃止された値を渡す必要があります。</span><span class="sxs-lookup"><span data-stu-id="ec6fa-225">When doing so, we must pass in the product s name and discontinued values using the `Eval("columnName")` syntax.</span></span> <span data-ttu-id="ec6fa-226">`Eval` は `Object`型の値を返しますが、`DisplayProductNameAndDiscontinuedStatus` メソッドには `String` および `Boolean`型の入力パラメーターが必要です。したがって、`Eval` メソッドによって返される値は、次のように、予期される入力パラメーターの型にキャストする必要があります。</span><span class="sxs-lookup"><span data-stu-id="ec6fa-226">`Eval` returns a value of type `Object`, but the `DisplayProductNameAndDiscontinuedStatus` method expects input parameters of type `String` and `Boolean`; therefore, we must cast the values returned by the `Eval` method to the expected input parameter types, like so:</span></span>

[!code-aspx[Main](formatting-the-datalist-and-repeater-based-upon-data-cs/samples/sample6.aspx)]

<span data-ttu-id="ec6fa-227">価格を表示するには、単に `UnitPriceLabel` Label s `Text` プロパティを `DisplayPrice` メソッドによって返される値に設定します。これは、製品の名前と [廃止] のテキストを表示する場合と同様です。</span><span class="sxs-lookup"><span data-stu-id="ec6fa-227">To display the price, we can simply set the `UnitPriceLabel` Label s `Text` property to the value returned by the `DisplayPrice` method, just like we did for displaying the product s name and [DISCONTINUED] text.</span></span> <span data-ttu-id="ec6fa-228">ただし、`UnitPrice` をスカラー入力パラメーターとして渡すのではなく、`ProductsRow` インスタンス全体を渡します。</span><span class="sxs-lookup"><span data-stu-id="ec6fa-228">However, instead of passing in the `UnitPrice` as a scalar input parameter, we instead pass in the entire `ProductsRow` instance:</span></span>

[!code-aspx[Main](formatting-the-datalist-and-repeater-based-upon-data-cs/samples/sample7.aspx)]

<span data-ttu-id="ec6fa-229">書式設定関数の呼び出しを実行し、ブラウザーで進行状況を表示します。</span><span class="sxs-lookup"><span data-stu-id="ec6fa-229">With the calls to the formatting functions in place, take a moment to view our progress in a browser.</span></span> <span data-ttu-id="ec6fa-230">画面は図5のようになります。これには、「廃止された」というテキストを含む廃止された製品が含まれています。また、これらの製品の料金は $20.00 を超えています。価格については、「」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="ec6fa-230">Your screen should look similar to Figure 5, with the discontinued products including the text [DISCONTINUED] and those products costing more than $20.00 having their price replaced with the text Please call for a price quote .</span></span>

<span data-ttu-id="ec6fa-231">[高額な製品の場合、価格はテキストで置き換えられます。価格の見積もりについては、をお問い合わせください ![](formatting-the-datalist-and-repeater-based-upon-data-cs/_static/image14.png)](formatting-the-datalist-and-repeater-based-upon-data-cs/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="ec6fa-231">[![For Expensive Products, the Price is Replaced with the Text, Please call for a price quote](formatting-the-datalist-and-repeater-based-upon-data-cs/_static/image14.png)](formatting-the-datalist-and-repeater-based-upon-data-cs/_static/image13.png)</span></span>

<span data-ttu-id="ec6fa-232">**図 5**: 高価な製品の場合、価格はテキストで置き換えられます。価格見積もりについては、をお問い合わせください ([クリックすると、フルサイズの画像が表示](formatting-the-datalist-and-repeater-based-upon-data-cs/_static/image15.png)されます)</span><span class="sxs-lookup"><span data-stu-id="ec6fa-232">**Figure 5**: For Expensive Products, the Price is Replaced with the Text, Please call for a price quote ([Click to view full-size image](formatting-the-datalist-and-repeater-based-upon-data-cs/_static/image15.png))</span></span>

## <a name="summary"></a><span data-ttu-id="ec6fa-233">要約</span><span class="sxs-lookup"><span data-stu-id="ec6fa-233">Summary</span></span>

<span data-ttu-id="ec6fa-234">データに基づいて DataList または Repeater コントロールの内容を書式設定するには、次の2つの方法を使用します。</span><span class="sxs-lookup"><span data-stu-id="ec6fa-234">Formatting the contents of a DataList or Repeater control based upon the data can be accomplished using two techniques.</span></span> <span data-ttu-id="ec6fa-235">最初の方法では、`ItemDataBound` イベントのイベントハンドラーを作成します。これは、データソース内の各レコードが新しい `DataListItem` または `RepeaterItem`にバインドされるときに発生します。</span><span class="sxs-lookup"><span data-stu-id="ec6fa-235">The first technique is to create an event handler for the `ItemDataBound` event, which fires as each record in the data source is bound to a new `DataListItem` or `RepeaterItem`.</span></span> <span data-ttu-id="ec6fa-236">`ItemDataBound` イベントハンドラーでは、現在の項目のデータを確認してから、書式設定をテンプレートの内容に適用したり、`DataListItem` の場合は項目全体に適用したりすることができます。</span><span class="sxs-lookup"><span data-stu-id="ec6fa-236">In the `ItemDataBound` event handler, the current item s data can be examined and then formatting can be applied to the contents of the template or, for `DataListItem` s, to the entire item itself.</span></span>

<span data-ttu-id="ec6fa-237">または、書式設定関数を使用してカスタム書式設定を実現できます。</span><span class="sxs-lookup"><span data-stu-id="ec6fa-237">Alternatively, custom formatting can be realized through formatting functions.</span></span> <span data-ttu-id="ec6fa-238">書式設定関数は、その代わりに生成する HTML を返す DataList または Repeater s テンプレートから呼び出すことができるメソッドです。</span><span class="sxs-lookup"><span data-stu-id="ec6fa-238">A formatting function is a method that can be invoked from the DataList or Repeater s templates that returns the HTML to emit in its place.</span></span> <span data-ttu-id="ec6fa-239">多くの場合、書式設定関数によって返される HTML は、現在の項目にバインドされている値によって決定されます。</span><span class="sxs-lookup"><span data-stu-id="ec6fa-239">Often, the HTML returned by a formatting function is determined by the values being bound to the current item.</span></span> <span data-ttu-id="ec6fa-240">これらの値は、スカラー値として、または項目にバインドされるオブジェクト全体 (`ProductsRow` インスタンスなど) に渡すことによって、書式指定関数に渡すことができます。</span><span class="sxs-lookup"><span data-stu-id="ec6fa-240">These values can be passed into the formatting function, either as scalar values or by passing in the entire object being bound to the item (such as the `ProductsRow` instance).</span></span>

<span data-ttu-id="ec6fa-241">プログラミングを楽しんでください。</span><span class="sxs-lookup"><span data-stu-id="ec6fa-241">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="ec6fa-242">作成者について</span><span class="sxs-lookup"><span data-stu-id="ec6fa-242">About the Author</span></span>

<span data-ttu-id="ec6fa-243">1998以来、 [Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml)は 7 asp/創設者 of [4GuysFromRolla.com](http://www.4guysfromrolla.com)の執筆者であり、Microsoft Web テクノロジを使用しています。</span><span class="sxs-lookup"><span data-stu-id="ec6fa-243">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="ec6fa-244">Scott は、独立したコンサルタント、トレーナー、およびライターとして機能します。</span><span class="sxs-lookup"><span data-stu-id="ec6fa-244">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="ec6fa-245">彼の最新の書籍は[ *、ASP.NET 2.0 を24時間以内に教え*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)ています。</span><span class="sxs-lookup"><span data-stu-id="ec6fa-245">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="ec6fa-246">mitchell@4GuysFromRolla.comでアクセスでき[ます。](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="ec6fa-246">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="ec6fa-247">または彼のブログを参照してください。これは[http://ScottOnWriting.NET](http://ScottOnWriting.NET)にあります。</span><span class="sxs-lookup"><span data-stu-id="ec6fa-247">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="ec6fa-248">ありがとうございました。</span><span class="sxs-lookup"><span data-stu-id="ec6fa-248">Special Thanks To</span></span>

<span data-ttu-id="ec6fa-249">このチュートリアルシリーズは、役に立つ多くのレビュー担当者によってレビューされました。</span><span class="sxs-lookup"><span data-stu-id="ec6fa-249">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="ec6fa-250">このチュートリアルのリードレビュー担当者は、Yaakov Ellis、Randy/Liz Shulok でした。</span><span class="sxs-lookup"><span data-stu-id="ec6fa-250">Lead reviewers for this tutorial were Yaakov Ellis, Randy Schmidt, and Liz Shulok.</span></span> <span data-ttu-id="ec6fa-251">今後の MSDN 記事を確認することに興味がありますか?</span><span class="sxs-lookup"><span data-stu-id="ec6fa-251">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="ec6fa-252">その場合は、mitchell@4GuysFromRolla.comの行を削除[します。](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="ec6fa-252">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="ec6fa-253">[前へ](displaying-data-with-the-datalist-and-repeater-controls-cs.md)
> [次へ](showing-multiple-records-per-row-with-the-datalist-control-cs.md)</span><span class="sxs-lookup"><span data-stu-id="ec6fa-253">[Previous](displaying-data-with-the-datalist-and-repeater-controls-cs.md)
[Next](showing-multiple-records-per-row-with-the-datalist-control-cs.md)</span></span>

---
uid: web-forms/overview/moving-to-aspnet-20/profiles-themes-and-web-parts
title: プロファイル、テーマ、および Web パーツ |Microsoft Docs
author: microsoft
description: ASP.NET 2.0 では、構成とインストルメンテーションに大きな変更が加えられています。 新しい ASP.NET configuration API を使用して、構成の変更を pr...
ms.author: riande
ms.date: 02/20/2005
ms.assetid: 92df4051-77c6-492c-bd34-23d24189cea4
msc.legacyurl: /web-forms/overview/moving-to-aspnet-20/profiles-themes-and-web-parts
msc.type: authoredcontent
ms.openlocfilehash: cf5c45781be6d003d28c6aa27efa08032579a6dd
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 03/06/2020
ms.locfileid: "78474640"
---
# <a name="profiles-themes-and-web-parts"></a><span data-ttu-id="8f418-104">プロファイル、テーマ、Web パーツ</span><span class="sxs-lookup"><span data-stu-id="8f418-104">Profiles, Themes, and Web Parts</span></span>

<span data-ttu-id="8f418-105">[Microsoft](https://github.com/microsoft)</span><span class="sxs-lookup"><span data-stu-id="8f418-105">by [Microsoft](https://github.com/microsoft)</span></span>

> <span data-ttu-id="8f418-106">ASP.NET 2.0 では、構成とインストルメンテーションに大きな変更が加えられています。</span><span class="sxs-lookup"><span data-stu-id="8f418-106">There are major changes in configuration and instrumentation in ASP.NET 2.0.</span></span> <span data-ttu-id="8f418-107">新しい ASP.NET configuration API では、構成の変更をプログラムで行うことができます。</span><span class="sxs-lookup"><span data-stu-id="8f418-107">The new ASP.NET configuration API allows for configuration changes to be made programmatically.</span></span> <span data-ttu-id="8f418-108">さらに、新しい構成設定の多くは、新しい構成とインストルメンテーションを可能にします。</span><span class="sxs-lookup"><span data-stu-id="8f418-108">In addition, many new configuration settings exist allow for new configurations and instrumentation.</span></span>

<span data-ttu-id="8f418-109">ASP.NET 2.0 は、パーソナライズされた Web サイトの領域の大幅な改善を表します。</span><span class="sxs-lookup"><span data-stu-id="8f418-109">ASP.NET 2.0 represents a substantial improvement in the area of personalized Web sites.</span></span> <span data-ttu-id="8f418-110">既に説明したメンバーシップ機能に加えて、ASP.NET のプロファイル、テーマ、および Web パーツは、Web サイトの個人用設定を大幅に強化します。</span><span class="sxs-lookup"><span data-stu-id="8f418-110">In addition to the membership features we've already covered, ASP.NET profiles, themes, and Web parts significantly enhance personalization in Web sites.</span></span>

## <a name="aspnet-profiles"></a><span data-ttu-id="8f418-111">ASP.NET プロファイル</span><span class="sxs-lookup"><span data-stu-id="8f418-111">ASP.NET Profiles</span></span>

<span data-ttu-id="8f418-112">ASP.NET プロファイルは、セッションに似ています。</span><span class="sxs-lookup"><span data-stu-id="8f418-112">ASP.NET profiles are similar to sessions.</span></span> <span data-ttu-id="8f418-113">違いは、プロファイルが永続的であるのに対し、ブラウザーを閉じたときにセッションが失われることです。</span><span class="sxs-lookup"><span data-stu-id="8f418-113">The difference is that a profile is persistent whereas a session is lost when the browser is closed.</span></span> <span data-ttu-id="8f418-114">セッションとプロファイルの大きな違いは、プロファイルが厳密に型指定されているため、開発プロセス中に IntelliSense が提供されることです。</span><span class="sxs-lookup"><span data-stu-id="8f418-114">Another big difference between sessions and profiles is that profiles are strongly typed, therefore providing you with IntelliSense during the development process.</span></span>

<span data-ttu-id="8f418-115">プロファイルは、コンピューターの構成ファイルまたはアプリケーションの web.config ファイルのいずれかで定義されます。</span><span class="sxs-lookup"><span data-stu-id="8f418-115">A profile is defined in either the machines configuration file or the web.config file for the application.</span></span> <span data-ttu-id="8f418-116">(サブフォルダーの web.config ファイルでプロファイルを定義することはできません)。次のコードは、Web サイトの訪問者の氏名を格納するためのプロファイルを定義します。</span><span class="sxs-lookup"><span data-stu-id="8f418-116">(You cannot define a profile in a sub-folders web.config file.) The code below defines a profile to store the Web site visitors first and last name.</span></span>

[!code-xml[Main](profiles-themes-and-web-parts/samples/sample1.xml)]

<span data-ttu-id="8f418-117">プロファイルプロパティの既定のデータ型は System.string です。</span><span class="sxs-lookup"><span data-stu-id="8f418-117">The default data type for a profile property is System.String.</span></span> <span data-ttu-id="8f418-118">上の例では、データ型が指定されていませんでした。</span><span class="sxs-lookup"><span data-stu-id="8f418-118">In the above example, no data type was specified.</span></span> <span data-ttu-id="8f418-119">そのため、FirstName プロパティと LastName プロパティは両方とも String 型です。</span><span class="sxs-lookup"><span data-stu-id="8f418-119">Therefore the FirstName and LastName properties are both of type String.</span></span> <span data-ttu-id="8f418-120">既に説明したように、プロファイルプロパティは厳密に型指定されています。</span><span class="sxs-lookup"><span data-stu-id="8f418-120">As previously mentioned, profile properties are strongly typed.</span></span> <span data-ttu-id="8f418-121">次のコードは、Int32 型の age の新しいプロパティを追加します。</span><span class="sxs-lookup"><span data-stu-id="8f418-121">The code below adds a new property for age that is of type Int32.</span></span>

[!code-xml[Main](profiles-themes-and-web-parts/samples/sample2.xml)]

<span data-ttu-id="8f418-122">プロファイルは、一般に ASP.NET フォーム認証で使用されます。</span><span class="sxs-lookup"><span data-stu-id="8f418-122">Profiles are generally used with ASP.NET Forms authentication.</span></span> <span data-ttu-id="8f418-123">フォーム認証と組み合わせて使用する場合、各ユーザーにはユーザー ID に関連付けられた個別のプロファイルがあります。</span><span class="sxs-lookup"><span data-stu-id="8f418-123">When used in combination with Forms authentication, each user has a separate profile associated with their user ID.</span></span> <span data-ttu-id="8f418-124">ただし、次に示すように、構成ファイルの &lt;anonymousIdentification&gt; 要素を**Allowanonymous**属性と共に使用して、匿名アプリケーションでのプロファイルの使用を許可することもできます。</span><span class="sxs-lookup"><span data-stu-id="8f418-124">However, it is also possible to allow the use of profiles in an anonymous application using the &lt;anonymousIdentification&gt; element in the configuration file along with the **allowAnonymous** attribute as shown below:</span></span>

[!code-xml[Main](profiles-themes-and-web-parts/samples/sample3.xml)]

<span data-ttu-id="8f418-125">匿名ユーザーがサイトを参照すると、ASP.NET はユーザーの**ProfileCommon**のインスタンスを作成します。</span><span class="sxs-lookup"><span data-stu-id="8f418-125">When an anonymous user browses the site, ASP.NET creates an instance of **ProfileCommon** for the user.</span></span> <span data-ttu-id="8f418-126">このプロファイルは、ブラウザーの cookie に格納されている一意の ID を使用して、ユーザーを一意の訪問者として識別します。</span><span class="sxs-lookup"><span data-stu-id="8f418-126">This profile uses a unique ID stored in a cookie on the browser to identify the user as a unique visitor.</span></span> <span data-ttu-id="8f418-127">このようにして、匿名で参照しているユーザーのプロファイル情報を格納できます。</span><span class="sxs-lookup"><span data-stu-id="8f418-127">In this way, you can store profile information for users who are browsing anonymously.</span></span>

## <a name="profile-groups"></a><span data-ttu-id="8f418-128">プロファイルグループ</span><span class="sxs-lookup"><span data-stu-id="8f418-128">Profile Groups</span></span>

<span data-ttu-id="8f418-129">プロファイルのプロパティをグループ化することができます。</span><span class="sxs-lookup"><span data-stu-id="8f418-129">It is possible to group properties of profiles.</span></span> <span data-ttu-id="8f418-130">プロパティをグループ化することにより、特定のアプリケーションに対して複数のプロファイルをシミュレートすることができます。</span><span class="sxs-lookup"><span data-stu-id="8f418-130">By grouping properties, it is possible to simulate multiple profiles for a specific application.</span></span>

<span data-ttu-id="8f418-131">次の構成では、2つのグループの FirstName と LastName プロパティを構成します。購入者と見込顧客。</span><span class="sxs-lookup"><span data-stu-id="8f418-131">The following configuration configures a FirstName and LastName property for two groups; Buyers and Prospects.</span></span>

[!code-xml[Main](profiles-themes-and-web-parts/samples/sample4.xml)]

<span data-ttu-id="8f418-132">次のように、特定のグループのプロパティを設定できます。</span><span class="sxs-lookup"><span data-stu-id="8f418-132">It is then possible to set properties on a particular group as follows:</span></span>

[!code-csharp[Main](profiles-themes-and-web-parts/samples/sample5.cs)]

## <a name="storing-complex-objects"></a><span data-ttu-id="8f418-133">複合オブジェクトの格納</span><span class="sxs-lookup"><span data-stu-id="8f418-133">Storing Complex Objects</span></span>

<span data-ttu-id="8f418-134">ここまでに説明した例では、単純なデータ型をプロファイルに格納しています。</span><span class="sxs-lookup"><span data-stu-id="8f418-134">So far, the examples we've covered have stored simple data types in a profile.</span></span> <span data-ttu-id="8f418-135">**SerializeAs**属性を使用して、次のようにシリアル化の方法を指定することにより、プロファイルに複合データ型を格納することもできます。</span><span class="sxs-lookup"><span data-stu-id="8f418-135">It is also possible to store complex data types in a profile by specifying the method of serialization using the **serializeAs** attribute as follows:</span></span>

[!code-xml[Main](profiles-themes-and-web-parts/samples/sample6.xml)]

<span data-ttu-id="8f418-136">この場合、型は PurchaseInvoice です。</span><span class="sxs-lookup"><span data-stu-id="8f418-136">In this case, the type is PurchaseInvoice.</span></span> <span data-ttu-id="8f418-137">PurchaseInvoice クラスはシリアル化可能としてマークする必要があり、任意の数のプロパティを含めることができます。</span><span class="sxs-lookup"><span data-stu-id="8f418-137">The PurchaseInvoice class needs to be marked as serializable and can contain any number of properties.</span></span> <span data-ttu-id="8f418-138">たとえば、PurchaseInvoice に**NumItemsPurchased**というプロパティがある場合、次のようにコードでそのプロパティを参照できます。</span><span class="sxs-lookup"><span data-stu-id="8f418-138">For example, if PurchaseInvoice has a property called **NumItemsPurchased**, you can refer to that property in code as follows:</span></span>

[!code-css[Main](profiles-themes-and-web-parts/samples/sample7.css)]

## <a name="profile-inheritance"></a><span data-ttu-id="8f418-139">プロファイルの継承</span><span class="sxs-lookup"><span data-stu-id="8f418-139">Profile Inheritance</span></span>

<span data-ttu-id="8f418-140">複数のアプリケーションで使用するプロファイルを作成することができます。</span><span class="sxs-lookup"><span data-stu-id="8f418-140">It is possible to create a profile for use in multiple applications.</span></span> <span data-ttu-id="8f418-141">ProfileBase から派生したプロファイルクラスを作成することにより、次に示すように、**継承**属性を使用して複数のアプリケーションでプロファイルを再利用できます。</span><span class="sxs-lookup"><span data-stu-id="8f418-141">By creating a profile class that derives from ProfileBase, you can reuse a profile in several applications by using the **inherits** attribute as shown below:</span></span>

[!code-xml[Main](profiles-themes-and-web-parts/samples/sample8.xml)]

<span data-ttu-id="8f418-142">この場合、クラス**PurchasingProfile**は次のようになります。</span><span class="sxs-lookup"><span data-stu-id="8f418-142">In this case, the class **PurchasingProfile** would look like so:</span></span>

[!code-csharp[Main](profiles-themes-and-web-parts/samples/sample9.cs)]

## <a name="profile-providers"></a><span data-ttu-id="8f418-143">プロファイルプロバイダー</span><span class="sxs-lookup"><span data-stu-id="8f418-143">Profile Providers</span></span>

<span data-ttu-id="8f418-144">ASP.NET プロファイルでは、プロバイダーモデルが使用されます。</span><span class="sxs-lookup"><span data-stu-id="8f418-144">ASP.NET profiles use the provider model.</span></span> <span data-ttu-id="8f418-145">既定のプロバイダーは、SqlProfileProvider プロバイダーを使用して、Web アプリケーションのアプリ\_データフォルダー内の SQL Server Express データベースに情報を格納します。</span><span class="sxs-lookup"><span data-stu-id="8f418-145">The default provider stores the information in a SQL Server Express database in the App\_Data folder of the Web application using the SqlProfileProvider provider.</span></span> <span data-ttu-id="8f418-146">データベースが存在しない場合は、プロファイルが情報を格納しようとすると、ASP.NET によって自動的に作成されます。</span><span class="sxs-lookup"><span data-stu-id="8f418-146">If the database doesn't exist, ASP.NET will automatically create it when the profile attempts to store information.</span></span>

<span data-ttu-id="8f418-147">ただし、場合によっては、独自のプロファイルプロバイダーを開発する必要があります。</span><span class="sxs-lookup"><span data-stu-id="8f418-147">In some cases, however, you may want to develop your own profile provider.</span></span> <span data-ttu-id="8f418-148">ASP.NET プロファイル機能を使用すると、さまざまなプロバイダーを簡単に使用できます。</span><span class="sxs-lookup"><span data-stu-id="8f418-148">The ASP.NET profile feature enables you to easily use different providers.</span></span>

<span data-ttu-id="8f418-149">カスタムプロファイルプロバイダーは、次の場合に作成します。</span><span class="sxs-lookup"><span data-stu-id="8f418-149">You create a custom profile provider when:</span></span>

- <span data-ttu-id="8f418-150">プロファイル情報は、.NET Framework に含まれているプロファイルプロバイダーでサポートされていない、FoxPro データベース、Oracle データベースなどのデータソースに格納する必要があります。</span><span class="sxs-lookup"><span data-stu-id="8f418-150">You need to store profile information in a data source, such as in a FoxPro database or in an Oracle database, that is not supported by the profile providers included with the .NET Framework.</span></span>
- <span data-ttu-id="8f418-151">.NET Framework に含まれるプロバイダーによって使用されるデータベーススキーマとは異なるデータベーススキーマを使用して、プロファイル情報を管理する必要があります。</span><span class="sxs-lookup"><span data-stu-id="8f418-151">You need to manage profile information using a database schema that is different from the database schema used by the providers included with the .NET Framework.</span></span> <span data-ttu-id="8f418-152">一般的な例として、既存の SQL Server データベースのユーザーデータにプロファイル情報を統合することが挙げられます。</span><span class="sxs-lookup"><span data-stu-id="8f418-152">A common example is that you want to integrate profile information with user data in an existing SQL Server database.</span></span>

### <a name="required-classes"></a><span data-ttu-id="8f418-153">必須クラス</span><span class="sxs-lookup"><span data-stu-id="8f418-153">Required Classes</span></span>

<span data-ttu-id="8f418-154">プロファイルプロバイダーを実装するには、System.web クラスを継承するクラスを作成します。</span><span class="sxs-lookup"><span data-stu-id="8f418-154">To implement a profile provider, you create a class that inherits the System.Web.Profile.ProfileProvider abstract class.</span></span> <span data-ttu-id="8f418-155">その後、 **Profileprovider**抽象クラスは、system.servicemodel プロバイダー抽象クラスを継承します。このクラスは、System. Configuration. providerbase 抽象クラスを継承します。</span><span class="sxs-lookup"><span data-stu-id="8f418-155">The **ProfileProvider** abstract class in turn inherits the System.Configuration.SettingsProvider abstract class, which inherits the System.Configuration.Provider.ProviderBase abstract class.</span></span> <span data-ttu-id="8f418-156">この継承チェーンにより、 **profileprovider**クラスの必須メンバーに加えて、 **settingsprovider**クラスおよび**providerbase**クラスの必須メンバーを実装する必要があります。</span><span class="sxs-lookup"><span data-stu-id="8f418-156">Because of this inheritance chain, in addition to the required members of the **ProfileProvider** class, you must implement the required members of the **SettingsProvider** and **ProviderBase** classes.</span></span>

<span data-ttu-id="8f418-157">次の表では、 **Providerbase**、 **Settingsprovider**、および**profileprovider**抽象クラスから実装する必要があるプロパティとメソッドについて説明します。</span><span class="sxs-lookup"><span data-stu-id="8f418-157">The following tables describe the properties and methods that you must implement from the **ProviderBase**, **SettingsProvider**, and **ProfileProvider** abstract classes.</span></span>

### <a name="providerbase-members"></a><span data-ttu-id="8f418-158">ProviderBase メンバー</span><span class="sxs-lookup"><span data-stu-id="8f418-158">ProviderBase Members</span></span>

| <span data-ttu-id="8f418-159">**メンバー**</span><span class="sxs-lookup"><span data-stu-id="8f418-159">**Member**</span></span> | <span data-ttu-id="8f418-160">**説明**</span><span class="sxs-lookup"><span data-stu-id="8f418-160">**Description**</span></span> |
| --- | --- |
| <span data-ttu-id="8f418-161">Initialize メソッド</span><span class="sxs-lookup"><span data-stu-id="8f418-161">Initialize method</span></span> | <span data-ttu-id="8f418-162">プロバイダーインスタンスの名前と構成設定の NameValueCollection を入力として受け取ります。</span><span class="sxs-lookup"><span data-stu-id="8f418-162">Takes as input the name of the provider instance and a NameValueCollection of configuration settings.</span></span> <span data-ttu-id="8f418-163">プロバイダーインスタンスのオプションとプロパティ値を設定するために使用します。これには、マシン構成または web.config ファイルで指定された実装固有の値やオプションも含まれます。</span><span class="sxs-lookup"><span data-stu-id="8f418-163">Used to set options and property values for the provider instance, including implementation-specific values and options specified in the machine configuration or Web.config file.</span></span> |

### <a name="settingsprovider-members"></a><span data-ttu-id="8f418-164">SettingsProvider メンバー</span><span class="sxs-lookup"><span data-stu-id="8f418-164">SettingsProvider Members</span></span>

| <span data-ttu-id="8f418-165">**メンバー**</span><span class="sxs-lookup"><span data-stu-id="8f418-165">**Member**</span></span> | <span data-ttu-id="8f418-166">**説明**</span><span class="sxs-lookup"><span data-stu-id="8f418-166">**Description**</span></span> |
| --- | --- |
| <span data-ttu-id="8f418-167">ApplicationName プロパティ</span><span class="sxs-lookup"><span data-stu-id="8f418-167">ApplicationName property</span></span> | <span data-ttu-id="8f418-168">各プロファイルに格納されているアプリケーション名。</span><span class="sxs-lookup"><span data-stu-id="8f418-168">The application name that is stored with each profile.</span></span> <span data-ttu-id="8f418-169">プロファイルプロバイダーは、アプリケーション名を使用して、アプリケーションごとにプロファイル情報を個別に格納します。</span><span class="sxs-lookup"><span data-stu-id="8f418-169">The profile provider uses the application name to store profile information separately for each application.</span></span> <span data-ttu-id="8f418-170">これにより、複数の ASP.NET アプリケーションで、同じユーザー名が異なるアプリケーションで作成された場合に、競合することなく同じデータソースを使用できます。</span><span class="sxs-lookup"><span data-stu-id="8f418-170">This enables multiple ASP.NET applications to use the same data source without a conflict if the same user name is created in different applications.</span></span> <span data-ttu-id="8f418-171">また、同じアプリケーション名を指定することで、複数の ASP.NET アプリケーションでプロファイルデータソースを共有することもできます。</span><span class="sxs-lookup"><span data-stu-id="8f418-171">Alternatively, multiple ASP.NET applications can share a profile data source by specifying the same application name.</span></span> |
| <span data-ttu-id="8f418-172">GetPropertyValues メソッド</span><span class="sxs-lookup"><span data-stu-id="8f418-172">GetPropertyValues method</span></span> | <span data-ttu-id="8f418-173">SettingsContext とカスタムオブジェクトを入力として受け取ります。</span><span class="sxs-lookup"><span data-stu-id="8f418-173">Takes as input a SettingsContext and a SettingsPropertyCollection object.</span></span> <span data-ttu-id="8f418-174">**Settingscontext**は、ユーザーに関する情報を提供します。</span><span class="sxs-lookup"><span data-stu-id="8f418-174">The **SettingsContext** provides information about the user.</span></span> <span data-ttu-id="8f418-175">この情報を主キーとして使用して、ユーザーのプロファイルプロパティ情報を取得できます。</span><span class="sxs-lookup"><span data-stu-id="8f418-175">You can use the information as a primary key to retrieve profile property information for the user.</span></span> <span data-ttu-id="8f418-176">**Settingscontext**オブジェクトを使用してユーザー名を取得し、ユーザーが認証されているか匿名であるかを確認します。</span><span class="sxs-lookup"><span data-stu-id="8f418-176">Use the **SettingsContext** object to get the user name and whether the user is authenticated or anonymous.</span></span> <span data-ttu-id="8f418-177">**カスタム**には、settingsproperty オブジェクトのコレクションが含まれています。</span><span class="sxs-lookup"><span data-stu-id="8f418-177">The **SettingsPropertyCollection** contains a collection of SettingsProperty objects.</span></span> <span data-ttu-id="8f418-178">各**settingsproperty**オブジェクトは、プロパティの名前と型、およびプロパティが読み取り専用かどうかなどの追加情報を提供します。</span><span class="sxs-lookup"><span data-stu-id="8f418-178">Each **SettingsProperty** object provides the name and type of the property as well as additional information such as the default value for the property and whether the property is read-only.</span></span> <span data-ttu-id="8f418-179">**Getpropertyvalues**メソッドは、入力として指定された**settingsproperty**オブジェクトに基づいて、Settingspropertyvaluecollection に settingspropertyvalue オブジェクトを設定します。</span><span class="sxs-lookup"><span data-stu-id="8f418-179">The **GetPropertyValues** method populates a SettingsPropertyValueCollection with SettingsPropertyValue objects based on the **SettingsProperty** objects provided as input.</span></span> <span data-ttu-id="8f418-180">指定されたユーザーのデータソースからの値は、各**Settingspropertyvalue**オブジェクトの propertyvalue プロパティに割り当てられ、コレクション全体が返されます。</span><span class="sxs-lookup"><span data-stu-id="8f418-180">The values from the data source for the specified user are assigned to the PropertyValue properties for each **SettingsPropertyValue** object and the entire collection is returned.</span></span> <span data-ttu-id="8f418-181">メソッドを呼び出すと、指定したユーザープロファイルの LastActivityDate 値も現在の日付と時刻に更新されます。</span><span class="sxs-lookup"><span data-stu-id="8f418-181">Calling the method also updates the LastActivityDate value for the specified user profile to the current date and time.</span></span> |
| <span data-ttu-id="8f418-182">SetPropertyValues メソッド</span><span class="sxs-lookup"><span data-stu-id="8f418-182">SetPropertyValues method</span></span> | <span data-ttu-id="8f418-183">**Settingscontext**と**Settingspropertyvaluecollection**オブジェクトを入力として受け取ります。</span><span class="sxs-lookup"><span data-stu-id="8f418-183">Takes as input a **SettingsContext** and a **SettingsPropertyValueCollection** object.</span></span> <span data-ttu-id="8f418-184">**Settingscontext**は、ユーザーに関する情報を提供します。</span><span class="sxs-lookup"><span data-stu-id="8f418-184">The **SettingsContext** provides information about the user.</span></span> <span data-ttu-id="8f418-185">この情報を主キーとして使用して、ユーザーのプロファイルプロパティ情報を取得できます。</span><span class="sxs-lookup"><span data-stu-id="8f418-185">You can use the information as a primary key to retrieve profile property information for the user.</span></span> <span data-ttu-id="8f418-186">**Settingscontext**オブジェクトを使用してユーザー名を取得し、ユーザーが認証されているか匿名であるかを確認します。</span><span class="sxs-lookup"><span data-stu-id="8f418-186">Use the **SettingsContext** object to get the user name and whether the user is authenticated or anonymous.</span></span> <span data-ttu-id="8f418-187">**Settingspropertyvaluecollection**には、 **settingspropertyvalue**オブジェクトのコレクションが含まれています。</span><span class="sxs-lookup"><span data-stu-id="8f418-187">The **SettingsPropertyValueCollection** contains a collection of **SettingsPropertyValue** objects.</span></span> <span data-ttu-id="8f418-188">各**Settingspropertyvalue**オブジェクトは、プロパティの名前、型、および値に加えて、プロパティの既定値やプロパティが読み取り専用かどうかなどの追加情報を提供します。</span><span class="sxs-lookup"><span data-stu-id="8f418-188">Each **SettingsPropertyValue** object provides the name, type, and value of the property as well as additional information such as the default value for the property and whether the property is read-only.</span></span> <span data-ttu-id="8f418-189">**Setpropertyvalues**メソッドは、指定されたユーザーのデータソース内のプロファイルプロパティ値を更新します。</span><span class="sxs-lookup"><span data-stu-id="8f418-189">The **SetPropertyValues** method updates the profile property values in the data source for the specified user.</span></span> <span data-ttu-id="8f418-190">メソッドを呼び出すと、指定したユーザープロファイルの**Lastactivitydate**値と LastUpdatedDate 値も現在の日付と時刻に更新されます。</span><span class="sxs-lookup"><span data-stu-id="8f418-190">Calling the method also updates the **LastActivityDate** and LastUpdatedDate values for the specified user profile to the current date and time.</span></span> |

### <a name="profileprovider-members"></a><span data-ttu-id="8f418-191">ProfileProvider のメンバー</span><span class="sxs-lookup"><span data-stu-id="8f418-191">ProfileProvider Members</span></span>

| <span data-ttu-id="8f418-192">**メンバー**</span><span class="sxs-lookup"><span data-stu-id="8f418-192">**Member**</span></span> | <span data-ttu-id="8f418-193">**説明**</span><span class="sxs-lookup"><span data-stu-id="8f418-193">**Description**</span></span> |
| --- | --- |
| <span data-ttu-id="8f418-194">DeleteProfiles メソッド</span><span class="sxs-lookup"><span data-stu-id="8f418-194">DeleteProfiles method</span></span> | <span data-ttu-id="8f418-195">は、入力としてユーザー名の文字列配列を受け取り、指定した名前のプロファイル情報とプロパティ値をすべてデータソースから削除します。アプリケーション名は**ApplicationName**プロパティ値と一致します。</span><span class="sxs-lookup"><span data-stu-id="8f418-195">Takes as input a string array of user names and deletes from the data source all profile information and property values for the specified names where the application name matches the **ApplicationName** property value.</span></span> <span data-ttu-id="8f418-196">データソースでトランザクションがサポートされている場合は、すべての削除操作をトランザクションに含め、トランザクションをロールバックして、削除操作が失敗した場合に例外をスローすることをお勧めします。</span><span class="sxs-lookup"><span data-stu-id="8f418-196">If your data source supports transactions, it is recommended that you include all delete operations in a transaction and that you roll back the transaction and throw an exception if any delete operation fails.</span></span> |
| <span data-ttu-id="8f418-197">DeleteProfiles メソッド</span><span class="sxs-lookup"><span data-stu-id="8f418-197">DeleteProfiles method</span></span> | <span data-ttu-id="8f418-198">は、ProfileInfo オブジェクトのコレクションを入力として受け取り、アプリケーション名が**ApplicationName**プロパティ値と一致する各プロファイルのプロファイル情報とプロパティ値をすべてデータソースから削除します。</span><span class="sxs-lookup"><span data-stu-id="8f418-198">Takes as input a collection of ProfileInfo objects and deletes from the data source all profile information and property values for each profile where the application name matches the **ApplicationName** property value.</span></span> <span data-ttu-id="8f418-199">データソースでトランザクションがサポートされている場合は、すべての削除操作をトランザクションに含め、トランザクションをロールバックして、削除操作が失敗した場合に例外をスローすることをお勧めします。</span><span class="sxs-lookup"><span data-stu-id="8f418-199">If your data source supports transactions, it is recommended that you include all delete operations in a transaction and roll back the transaction and throw an exception if any delete operation fails.</span></span> |
| <span data-ttu-id="8f418-200">DeleteInactiveProfiles メソッド</span><span class="sxs-lookup"><span data-stu-id="8f418-200">DeleteInactiveProfiles method</span></span> | <span data-ttu-id="8f418-201">は、入力として ProfileAuthenticationOption 値と DateTime オブジェクトを受け取り、最後のアクティビティの日付が指定した日付と時刻以下で、アプリケーション名が**ApplicationName**プロパティ値と一致するすべてのプロファイル情報とプロパティ値をデータソースから削除します。</span><span class="sxs-lookup"><span data-stu-id="8f418-201">Takes as input a ProfileAuthenticationOption value and a DateTime object and deletes from the data source all profile information and property values where the last activity date is less than or equal to the specified date and time and where the application name matches the **ApplicationName** property value.</span></span> <span data-ttu-id="8f418-202">**Profileauthenticationoption**パラメーターでは、匿名プロファイルのみ、認証されたプロファイルのみ、またはすべてのプロファイルのみを削除するかどうかを指定します。</span><span class="sxs-lookup"><span data-stu-id="8f418-202">The **ProfileAuthenticationOption** parameter specifies whether only anonymous profiles, only authenticated profiles, or all profiles are to be deleted.</span></span> <span data-ttu-id="8f418-203">データソースでトランザクションがサポートされている場合は、すべての削除操作をトランザクションに含め、トランザクションをロールバックして、削除操作が失敗した場合に例外をスローすることをお勧めします。</span><span class="sxs-lookup"><span data-stu-id="8f418-203">If your data source supports transactions, it is recommended that you include all delete operations in a transaction and roll back the transaction and throw an exception if any delete operation fails.</span></span> |
| <span data-ttu-id="8f418-204">GetAllProfiles メソッド</span><span class="sxs-lookup"><span data-stu-id="8f418-204">GetAllProfiles method</span></span> | <span data-ttu-id="8f418-205">は、入力として、 **Profileauthenticationoption**値、ページインデックスを指定する整数、ページサイズを指定する整数、およびプロファイルの合計数に設定される整数への参照を受け取ります。</span><span class="sxs-lookup"><span data-stu-id="8f418-205">Takes as input a **ProfileAuthenticationOption** value, an integer that specifies the page index, an integer that specifies the page size, and a reference to an integer that will be set to the total count of profiles.</span></span> <span data-ttu-id="8f418-206">アプリケーション名が**ApplicationName**プロパティ値と一致するデータソース内のすべてのプロファイルについて、 **profileinfo**オブジェクトを含む profileinfocollection を返します。</span><span class="sxs-lookup"><span data-stu-id="8f418-206">Returns a ProfileInfoCollection that contains **ProfileInfo** objects for all profiles in the data source where the application name matches the **ApplicationName** property value.</span></span> <span data-ttu-id="8f418-207">**Profileauthenticationoption**パラメーターは、匿名プロファイル、認証されたプロファイル、またはすべてのプロファイルのみを返すかどうかを指定します。</span><span class="sxs-lookup"><span data-stu-id="8f418-207">The **ProfileAuthenticationOption** parameter specifies whether only anonymous profiles, only authenticated profiles, or all profiles are to be returned.</span></span> <span data-ttu-id="8f418-208">**GetAllProfiles**メソッドによって返される結果は、ページインデックスとページサイズの値によって制限されます。</span><span class="sxs-lookup"><span data-stu-id="8f418-208">The results returned by the **GetAllProfiles** method are constrained by the page index and page size values.</span></span> <span data-ttu-id="8f418-209">[ページサイズ] の値は、 **Profileinfocollection**で返される**profileinfo**オブジェクトの最大数を指定します。</span><span class="sxs-lookup"><span data-stu-id="8f418-209">The page size value specifies the maximum number of **ProfileInfo** objects to return in the **ProfileInfoCollection**.</span></span> <span data-ttu-id="8f418-210">ページインデックス値は、返される結果のページを指定します。1は最初のページを示します。</span><span class="sxs-lookup"><span data-stu-id="8f418-210">The page index value specifies which page of results to return, where 1 identifies the first page.</span></span> <span data-ttu-id="8f418-211">合計レコードのパラメーターは、プロファイルの合計数に設定されている out パラメーターです (Visual Basic で**ByRef**を使用できます)。</span><span class="sxs-lookup"><span data-stu-id="8f418-211">The parameter for total records is an out parameter (you can use **ByRef** in Visual Basic) that is set to the total number of profiles.</span></span> <span data-ttu-id="8f418-212">たとえば、データストアにアプリケーション用に13のプロファイルが含まれており、ページのインデックス値が 2 (ページサイズ 5) の場合、返される**Profileinfocollection**には6番目のプロファイルが含まれます。</span><span class="sxs-lookup"><span data-stu-id="8f418-212">For example, if the data store contains 13 profiles for the application and the page index value is 2 with a page size of 5, the **ProfileInfoCollection** returned contains the sixth through the tenth profiles.</span></span> <span data-ttu-id="8f418-213">メソッドから制御が戻った場合、total records の値は13に設定されます。</span><span class="sxs-lookup"><span data-stu-id="8f418-213">The total records value is set to 13 when the method returns.</span></span> |
| <span data-ttu-id="8f418-214">GetAllInactiveProfiles メソッド</span><span class="sxs-lookup"><span data-stu-id="8f418-214">GetAllInactiveProfiles method</span></span> | <span data-ttu-id="8f418-215">は、入力として、 **Profileauthenticationoption**値、 **DateTime**オブジェクト、ページインデックスを指定する整数、ページサイズを指定する整数、およびプロファイルの合計数に設定される整数への参照を受け取ります。</span><span class="sxs-lookup"><span data-stu-id="8f418-215">Takes as input a **ProfileAuthenticationOption** value, a **DateTime** object, an integer that specifies the page index, an integer that specifies the page size, and a reference to an integer that will be set to the total count of profiles.</span></span> <span data-ttu-id="8f418-216">最後のアクティビティの日付**が指定された**日時以下で、アプリケーション名が**ApplicationName**プロパティ値と一致するデータソース内のすべてのプロファイルに対して、 **Profileinfo**オブジェクトを含む**profileinfocollection**を返します。</span><span class="sxs-lookup"><span data-stu-id="8f418-216">Returns a **ProfileInfoCollection** that contains **ProfileInfo** objects for all profiles in the data source where the last activity date is less than or equal to the specified **DateTime** and where the application name matches the **ApplicationName** property value.</span></span> <span data-ttu-id="8f418-217">**Profileauthenticationoption**パラメーターは、匿名プロファイル、認証されたプロファイル、またはすべてのプロファイルのみを返すかどうかを指定します。</span><span class="sxs-lookup"><span data-stu-id="8f418-217">The **ProfileAuthenticationOption** parameter specifies whether only anonymous profiles, only authenticated profiles, or all profiles are to be returned.</span></span> <span data-ttu-id="8f418-218">**Getallinactiveprofiles**メソッドによって返される結果は、ページインデックスとページサイズの値によって制限されます。</span><span class="sxs-lookup"><span data-stu-id="8f418-218">The results returned by the **GetAllInactiveProfiles** method are constrained by the page index and page size values.</span></span> <span data-ttu-id="8f418-219">[ページサイズ] の値は、 **Profileinfocollection**で返される**profileinfo**オブジェクトの最大数を指定します。</span><span class="sxs-lookup"><span data-stu-id="8f418-219">The page size value specifies the maximum number of **ProfileInfo** objects to return in the **ProfileInfoCollection**.</span></span> <span data-ttu-id="8f418-220">ページインデックス値は、返される結果のページを指定します。1は最初のページを示します。</span><span class="sxs-lookup"><span data-stu-id="8f418-220">The page index value specifies which page of results to return, where 1 identifies the first page.</span></span> <span data-ttu-id="8f418-221">合計レコードのパラメーターは、プロファイルの合計数に設定されている out パラメーターです (Visual Basic で**ByRef**を使用できます)。</span><span class="sxs-lookup"><span data-stu-id="8f418-221">The parameter for total records is an out parameter (you can use **ByRef** in Visual Basic) that is set to the total number of profiles.</span></span> <span data-ttu-id="8f418-222">たとえば、データストアにアプリケーション用に13のプロファイルが含まれており、ページのインデックス値が 2 (ページサイズ 5) の場合、返される**Profileinfocollection**には6番目のプロファイルが含まれます。</span><span class="sxs-lookup"><span data-stu-id="8f418-222">For example, if the data store contains 13 profiles for the application and the page index value is 2 with a page size of 5, the **ProfileInfoCollection** returned contains the sixth through the tenth profiles.</span></span> <span data-ttu-id="8f418-223">メソッドから制御が戻った場合、total records の値は13に設定されます。</span><span class="sxs-lookup"><span data-stu-id="8f418-223">The total records value is set to 13 when the method returns.</span></span> |
| <span data-ttu-id="8f418-224">Findプロファイル Byusername メソッド</span><span class="sxs-lookup"><span data-stu-id="8f418-224">FindProfilesByUserName method</span></span> | <span data-ttu-id="8f418-225">は、入力として、 **Profileauthenticationoption**値、ユーザー名を含む文字列、ページインデックスを指定する整数、ページサイズを指定する整数、およびプロファイルの合計数に設定される整数への参照を受け取ります。</span><span class="sxs-lookup"><span data-stu-id="8f418-225">Takes as input a **ProfileAuthenticationOption** value, a string containing a user name, an integer that specifies the page index, an integer that specifies the page size, and a reference to an integer that will be set to the total count of profiles.</span></span> <span data-ttu-id="8f418-226">ユーザー名が指定されたユーザー名と一致し、アプリケーション名が**ApplicationName**プロパティ値と一致する、データソース内のすべてのプロファイルの**profileinfo**オブジェクトを含む**profileinfocollection**を返します。</span><span class="sxs-lookup"><span data-stu-id="8f418-226">Returns a **ProfileInfoCollection** that contains **ProfileInfo** objects for all profiles in the data source where the user name matches the specified user name and where the application name matches the **ApplicationName** property value.</span></span> <span data-ttu-id="8f418-227">**Profileauthenticationoption**パラメーターは、匿名プロファイル、認証されたプロファイル、またはすべてのプロファイルのみを返すかどうかを指定します。</span><span class="sxs-lookup"><span data-stu-id="8f418-227">The **ProfileAuthenticationOption** parameter specifies whether only anonymous profiles, only authenticated profiles, or all profiles are to be returned.</span></span> <span data-ttu-id="8f418-228">データソースでワイルドカード文字などの追加の検索機能がサポートされている場合は、ユーザー名に対してより広範な検索機能を提供できます。</span><span class="sxs-lookup"><span data-stu-id="8f418-228">If your data source supports additional search capabilities, such as wildcard characters, you can provide more extensive search capabilities for user names.</span></span> <span data-ttu-id="8f418-229">**Findプロファイル Byusername**メソッドによって返される結果は、ページインデックスとページサイズの値によって制限されます。</span><span class="sxs-lookup"><span data-stu-id="8f418-229">The results returned by the **FindProfilesByUserName** method are constrained by the page index and page size values.</span></span> <span data-ttu-id="8f418-230">[ページサイズ] の値は、 **Profileinfocollection**で返される**profileinfo**オブジェクトの最大数を指定します。</span><span class="sxs-lookup"><span data-stu-id="8f418-230">The page size value specifies the maximum number of **ProfileInfo** objects to return in the **ProfileInfoCollection**.</span></span> <span data-ttu-id="8f418-231">ページインデックス値は、返される結果のページを指定します。1は最初のページを示します。</span><span class="sxs-lookup"><span data-stu-id="8f418-231">The page index value specifies which page of results to return, where 1 identifies the first page.</span></span> <span data-ttu-id="8f418-232">合計レコードのパラメーターは、プロファイルの合計数に設定されている out パラメーターです (Visual Basic で**ByRef**を使用できます)。</span><span class="sxs-lookup"><span data-stu-id="8f418-232">The parameter for total records is an out parameter (you can use **ByRef** in Visual Basic) that is set to the total number of profiles.</span></span> <span data-ttu-id="8f418-233">たとえば、データストアにアプリケーション用に13のプロファイルが含まれており、ページのインデックス値が 2 (ページサイズ 5) の場合、返される**Profileinfocollection**には6番目のプロファイルが含まれます。</span><span class="sxs-lookup"><span data-stu-id="8f418-233">For example, if the data store contains 13 profiles for the application and the page index value is 2 with a page size of 5, the **ProfileInfoCollection** returned contains the sixth through the tenth profiles.</span></span> <span data-ttu-id="8f418-234">メソッドから制御が戻った場合、total records の値は13に設定されます。</span><span class="sxs-lookup"><span data-stu-id="8f418-234">The total records value is set to 13 when the method returns.</span></span> |
| <span data-ttu-id="8f418-235">Findinactiveプロファイル Byusername メソッド</span><span class="sxs-lookup"><span data-stu-id="8f418-235">FindInactiveProfilesByUserName method</span></span> | <span data-ttu-id="8f418-236">は、入力として、 **Profileauthenticationoption**値、ユーザー名を含む文字列、 **DateTime**オブジェクト、ページインデックスを指定する整数、ページサイズを指定する整数、およびプロファイルの合計数に設定される整数への参照を受け取ります。</span><span class="sxs-lookup"><span data-stu-id="8f418-236">Takes as input a **ProfileAuthenticationOption** value, a string containing a user name, a **DateTime** object, an integer that specifies the page index, an integer that specifies the page size, and a reference to an integer that will be set to the total count of profiles.</span></span> <span data-ttu-id="8f418-237">ユーザー名が指定されたユーザー名と一致し、最後のアクティビティの日付**が指定された**日時以下である場合、およびアプリケーション名が**ApplicationName**プロパティ値と一致する場合に、データソース内のすべてのプロファイルの**Profileinfo**オブジェクトを含む**profileinfocollection**を返します。</span><span class="sxs-lookup"><span data-stu-id="8f418-237">Returns a **ProfileInfoCollection** that contains **ProfileInfo** objects for all profiles in the data source where the user name matches the specified user name, where the last activity date is less than or equal to the specified **DateTime**, and where the application name matches the **ApplicationName** property value.</span></span> <span data-ttu-id="8f418-238">**Profileauthenticationoption**パラメーターは、匿名プロファイル、認証されたプロファイル、またはすべてのプロファイルのみを返すかどうかを指定します。</span><span class="sxs-lookup"><span data-stu-id="8f418-238">The **ProfileAuthenticationOption** parameter specifies whether only anonymous profiles, only authenticated profiles, or all profiles are to be returned.</span></span> <span data-ttu-id="8f418-239">データソースでワイルドカード文字などの追加の検索機能がサポートされている場合は、ユーザー名に対してより広範な検索機能を提供できます。</span><span class="sxs-lookup"><span data-stu-id="8f418-239">If your data source supports additional search capabilities, such as wildcard characters, you can provide more extensive search capabilities for user names.</span></span> <span data-ttu-id="8f418-240">**Findinactiveプロファイル Byusername**メソッドによって返される結果は、ページインデックスとページサイズの値によって制限されます。</span><span class="sxs-lookup"><span data-stu-id="8f418-240">The results returned by the **FindInactiveProfilesByUserName** method are constrained by the page index and page size values.</span></span> <span data-ttu-id="8f418-241">[ページサイズ] の値は、 **Profileinfocollection**で返される**profileinfo**オブジェクトの最大数を指定します。</span><span class="sxs-lookup"><span data-stu-id="8f418-241">The page size value specifies the maximum number of **ProfileInfo** objects to return in the **ProfileInfoCollection**.</span></span> <span data-ttu-id="8f418-242">ページインデックス値は、返される結果のページを指定します。1は最初のページを示します。</span><span class="sxs-lookup"><span data-stu-id="8f418-242">The page index value specifies which page of results to return, where 1 identifies the first page.</span></span> <span data-ttu-id="8f418-243">合計レコードのパラメーターは、プロファイルの合計数に設定されている out パラメーターです (Visual Basic で**ByRef**を使用できます)。</span><span class="sxs-lookup"><span data-stu-id="8f418-243">The parameter for total records is an out parameter (you can use **ByRef** in Visual Basic) that is set to the total number of profiles.</span></span> <span data-ttu-id="8f418-244">たとえば、データストアにアプリケーション用に13のプロファイルが含まれており、ページのインデックス値が 2 (ページサイズ 5) の場合、返される**Profileinfocollection**には6番目のプロファイルが含まれます。</span><span class="sxs-lookup"><span data-stu-id="8f418-244">For example, if the data store contains 13 profiles for the application and the page index value is 2 with a page size of 5, the **ProfileInfoCollection** returned contains the sixth through the tenth profiles.</span></span> <span data-ttu-id="8f418-245">メソッドから制御が戻った場合、total records の値は13に設定されます。</span><span class="sxs-lookup"><span data-stu-id="8f418-245">The total records value is set to 13 when the method returns.</span></span> |
| <span data-ttu-id="8f418-246">Getnumber Ofinactiveprofiles メソッド</span><span class="sxs-lookup"><span data-stu-id="8f418-246">GetNumberOfInActiveProfiles method</span></span> | <span data-ttu-id="8f418-247">は、 **Profileauthenticationoption**値と**DateTime**オブジェクトを入力として受け取り、最後のアクティビティの日付が指定した**日時**以下で、アプリケーション名が**ApplicationName**プロパティ値と一致するデータソース内のすべてのプロファイルの数を返します。</span><span class="sxs-lookup"><span data-stu-id="8f418-247">Takes as input a **ProfileAuthenticationOption** value and a **DateTime** object and returns a count of all profiles in the data source where the last activity date is less than or equal to the specified **DateTime** and where the application name matches the **ApplicationName** property value.</span></span> <span data-ttu-id="8f418-248">**Profileauthenticationoption**パラメーターは、匿名プロファイル、認証されたプロファイル、またはすべてのプロファイルのみをカウントするかどうかを指定します。</span><span class="sxs-lookup"><span data-stu-id="8f418-248">The **ProfileAuthenticationOption** parameter specifies whether only anonymous profiles, only authenticated profiles, or all profiles are to be counted.</span></span> |

### <a name="applicationname"></a><span data-ttu-id="8f418-249">ApplicationName</span><span class="sxs-lookup"><span data-stu-id="8f418-249">ApplicationName</span></span>

<span data-ttu-id="8f418-250">プロファイルプロバイダーは、アプリケーションごとにプロファイル情報を個別に格納するので、データスキーマにアプリケーション名が含まれていること、およびクエリと更新プログラムにアプリケーション名が含まれていることを確認する必要があります。</span><span class="sxs-lookup"><span data-stu-id="8f418-250">Because profile providers store profile information separately for each application, you must ensure that your data schema includes the application name and that queries and updates also include the application name.</span></span> <span data-ttu-id="8f418-251">たとえば、次のコマンドは、ユーザー名に基づいてデータベースからプロパティ値を取得し、プロファイルが匿名であるかどうかを確認するために使用され、 **ApplicationName**値がクエリに含まれていることを確認します。</span><span class="sxs-lookup"><span data-stu-id="8f418-251">For example, the following command is used to retrieve a property value from a database based on the user name and whether the profile is anonymous, and ensures that the **ApplicationName** value is included in the query.</span></span>

[!code-sql[Main](profiles-themes-and-web-parts/samples/sample10.sql)]

## <a name="aspnet-themes"></a><span data-ttu-id="8f418-252">ASP.NET のテーマ</span><span class="sxs-lookup"><span data-stu-id="8f418-252">ASP.NET Themes</span></span>

## <a name="what-are-aspnet-20-themes"></a><span data-ttu-id="8f418-253">ASP.NET 2.0 のテーマとは</span><span class="sxs-lookup"><span data-stu-id="8f418-253">What are ASP.NET 2.0 Themes?</span></span>

<span data-ttu-id="8f418-254">Web アプリケーションの最も重要な側面の1つは、サイト全体の一貫したルックアンドフィールです。</span><span class="sxs-lookup"><span data-stu-id="8f418-254">One of the most important aspects of a Web application is a consistent look and feel across the site.</span></span> <span data-ttu-id="8f418-255">ASP.NET 1.x 開発者は、通常、カスケードスタイルシート (CSS) を使用して一貫したルックアンドフィールを実装します。</span><span class="sxs-lookup"><span data-stu-id="8f418-255">ASP.NET 1.x developers usually use Cascading Style Sheets (CSS) to implement a consistent look and feel.</span></span> <span data-ttu-id="8f418-256">ASP.NET 2.0 のテーマは、ASP.NET 開発者が ASP.NET サーバーコントロールと HTML 要素の外観を定義できるようにするため、CSS に対して大幅に改善されています。</span><span class="sxs-lookup"><span data-stu-id="8f418-256">ASP.NET 2.0 themes significantly improve upon CSS because they give the ASP.NET developer the ability to define the appearance of ASP.NET server controls as well as HTML elements.</span></span> <span data-ttu-id="8f418-257">ASP.NET テーマは、個々のコントロール、特定の Web ページ、または Web アプリケーション全体に適用できます。</span><span class="sxs-lookup"><span data-stu-id="8f418-257">ASP.NET themes can be applied to individual controls, a specific Web page, or an entire Web application.</span></span> <span data-ttu-id="8f418-258">テーマでは、イメージが必要な場合に、CSS ファイル、オプションのスキンファイル、およびオプションの Images ディレクトリの組み合わせを使用します。</span><span class="sxs-lookup"><span data-stu-id="8f418-258">Themes use a combination of CSS files, an optional skin file, and an optional Images directory if images are needed.</span></span> <span data-ttu-id="8f418-259">スキンファイルは、ASP.NET サーバーコントロールの外観を制御します。</span><span class="sxs-lookup"><span data-stu-id="8f418-259">The skin file controls the visual appearance of ASP.NET server controls.</span></span>

## <a name="where-are-themes-stored"></a><span data-ttu-id="8f418-260">テーマはどこに格納されますか。</span><span class="sxs-lookup"><span data-stu-id="8f418-260">Where are Themes Stored?</span></span>

<span data-ttu-id="8f418-261">テーマが格納される場所は、そのスコープによって異なります。</span><span class="sxs-lookup"><span data-stu-id="8f418-261">The location where themes are stored differs based upon their scope.</span></span> <span data-ttu-id="8f418-262">任意のアプリケーションに適用できるテーマは、次のフォルダーに格納されます。</span><span class="sxs-lookup"><span data-stu-id="8f418-262">Themes that can be applied to any application are stored in the following folder:</span></span>

`C:\WINDOWS\Microsoft.NET\Framework\v2.x.xxxxx\ASP.NETClientFiles\Themes\<Theme_Name>`

<span data-ttu-id="8f418-263">特定のアプリケーションに固有のテーマは、Web サイトのルートにある `App\_Themes\<Theme\_Name>` ディレクトリに格納されます。</span><span class="sxs-lookup"><span data-stu-id="8f418-263">A theme that is specific to a particular application is stored in an `App\_Themes\<Theme\_Name>` directory in the root of the Web site.</span></span>

> [!NOTE]
> <span data-ttu-id="8f418-264">スキンファイルは、外観に影響を与えるサーバーコントロールのプロパティのみを変更する必要があります。</span><span class="sxs-lookup"><span data-stu-id="8f418-264">A skin file should only modify server control properties that affect appearance.</span></span>

<span data-ttu-id="8f418-265">グローバルテーマは、Web サーバーで実行されている任意のアプリケーションまたは Web サイトに適用できるテーマです。</span><span class="sxs-lookup"><span data-stu-id="8f418-265">A global theme is a theme that can be applied to any application or Web site running on the Web server.</span></span> <span data-ttu-id="8f418-266">これらのテーマは、既定では、NETClientfiles\Themes ディレクトリに格納されています。</span><span class="sxs-lookup"><span data-stu-id="8f418-266">These themes are stored by default in the ASP.NETClientfiles\Themes directory that is inside of the v2.x.xxxxx directory.</span></span> <span data-ttu-id="8f418-267">または、テーマファイルを、Web サイトのルートにある クライアント/システム\_web/[バージョン]/[\_]/[テーマ\_名] フォルダーの aspnet に移動することもできます。</span><span class="sxs-lookup"><span data-stu-id="8f418-267">Alternatively, you can move the theme files into the aspnet\_client/system\_web/[version]/Themes/[theme\_name] folder in the root of your Web site.</span></span>

<span data-ttu-id="8f418-268">アプリケーション固有のテーマは、ファイルが存在するアプリケーションにのみ適用できます。</span><span class="sxs-lookup"><span data-stu-id="8f418-268">Application-specific themes can only be applied to the application in which the files reside.</span></span> <span data-ttu-id="8f418-269">これらのファイルは、Web サイトのルートにある `App\_Themes/<theme\_name>` ディレクトリに格納されます。</span><span class="sxs-lookup"><span data-stu-id="8f418-269">These files are stored in the `App\_Themes/<theme\_name>` directory in the root of the Web site.</span></span>

## <a name="the-components-of-a-theme"></a><span data-ttu-id="8f418-270">テーマのコンポーネント</span><span class="sxs-lookup"><span data-stu-id="8f418-270">The Components of a Theme</span></span>

<span data-ttu-id="8f418-271">テーマは、1つ以上の CSS ファイル、オプションのスキンファイル、およびオプションの Images フォルダーで構成されます。</span><span class="sxs-lookup"><span data-stu-id="8f418-271">A theme is made up of one or more CSS files, an optional skin file, and an optional Images folder.</span></span> <span data-ttu-id="8f418-272">CSS ファイルには任意の名前を指定できます (例: .css または theme など)。また、テーマフォルダーのルートにある必要があります。</span><span class="sxs-lookup"><span data-stu-id="8f418-272">The CSS files can be any name you wish (i.e. default.css or theme.css, etc.) and must be in the root of the themes folder.</span></span> <span data-ttu-id="8f418-273">CSS ファイルは、特定のセレクターに対して通常の CSS クラスおよび属性を定義するために使用されます。</span><span class="sxs-lookup"><span data-stu-id="8f418-273">The CSS files are used to define ordinary CSS classes and attributes for specific selectors.</span></span> <span data-ttu-id="8f418-274">いずれかの CSS クラスを page 要素に適用するには、 **CSSClass**プロパティを使用します。</span><span class="sxs-lookup"><span data-stu-id="8f418-274">To apply one of the CSS classes to a page element, the **CSSClass** property is used.</span></span>

<span data-ttu-id="8f418-275">スキンファイルは、ASP.NET サーバーコントロールのプロパティ定義を含む XML ファイルです。</span><span class="sxs-lookup"><span data-stu-id="8f418-275">The skin file is an XML file that contains property definitions for ASP.NET server controls.</span></span> <span data-ttu-id="8f418-276">次に示すコードは、スキンファイルの例です。</span><span class="sxs-lookup"><span data-stu-id="8f418-276">The code listed below is an example skin file.</span></span>

[!code-aspx[Main](profiles-themes-and-web-parts/samples/sample11.aspx)]

<span data-ttu-id="8f418-277">次の**図 1**は、テーマが適用されていない小さな ASP.NET ページを示しています。</span><span class="sxs-lookup"><span data-stu-id="8f418-277">**Figure 1** below shows a small ASP.NET page browsed without a theme applied.</span></span> <span data-ttu-id="8f418-278">**図 2**は、テーマが適用された同じファイルを示しています。</span><span class="sxs-lookup"><span data-stu-id="8f418-278">**Figure 2** shows the same file with a theme applied.</span></span> <span data-ttu-id="8f418-279">背景色とテキストの色は、CSS ファイルによって構成されます。</span><span class="sxs-lookup"><span data-stu-id="8f418-279">The background color and text color are configured via a CSS file.</span></span> <span data-ttu-id="8f418-280">ボタンとテキストボックスの外観は、上に示したスキンファイルを使用して構成されます。</span><span class="sxs-lookup"><span data-stu-id="8f418-280">The appearance of the button and textbox are configured using the skin file listed above.</span></span>

![テーマがありません](profiles-themes-and-web-parts/_static/image1.gif)

<span data-ttu-id="8f418-282">**図 1**: テーマなし</span><span class="sxs-lookup"><span data-stu-id="8f418-282">**Figure 1**: No Theme</span></span>

![適用されたテーマ](profiles-themes-and-web-parts/_static/image2.gif)

<span data-ttu-id="8f418-284">**図 2**: テーマの適用</span><span class="sxs-lookup"><span data-stu-id="8f418-284">**Figure 2**: Theme Applied</span></span>

<span data-ttu-id="8f418-285">上に示したスキンファイルは、すべてのテキストボックスコントロールとボタンコントロールの既定のスキンを定義しています。</span><span class="sxs-lookup"><span data-stu-id="8f418-285">The skin file listed above defines a default skin for all TextBox controls and Button controls.</span></span> <span data-ttu-id="8f418-286">これは、ページに挿入されたすべてのテキストボックスコントロールとボタンコントロールが、この外観になることを意味します。</span><span class="sxs-lookup"><span data-stu-id="8f418-286">That means that every TextBox control and Button control inserted on a page will take on this appearance.</span></span> <span data-ttu-id="8f418-287">コントロールの**SkinID**プロパティを使用して、これらのコントロールの特定のインスタンスに適用できるスキンを定義することもできます。</span><span class="sxs-lookup"><span data-stu-id="8f418-287">You can also define a skin that can be applied to specific instances of these controls using the **SkinID** property of the control.</span></span>

<span data-ttu-id="8f418-288">次のコードでは、ボタンコントロールのスキンを定義しています。</span><span class="sxs-lookup"><span data-stu-id="8f418-288">The code below defines a skin for a Button control.</span></span> <span data-ttu-id="8f418-289">**Gobutton**の**SkinID**プロパティを持つボタンコントロールのみが、スキンの外観になります。</span><span class="sxs-lookup"><span data-stu-id="8f418-289">Only Button controls with a **SkinID** property of **goButton** will take on the appearance of the skin.</span></span>

[!code-aspx[Main](profiles-themes-and-web-parts/samples/sample12.aspx)]

<span data-ttu-id="8f418-290">既定のスキンは、サーバーコントロールの種類ごとに1つだけ指定できます。</span><span class="sxs-lookup"><span data-stu-id="8f418-290">You can only have one default skin per server control type.</span></span> <span data-ttu-id="8f418-291">追加のスキンが必要な場合は、SkinID プロパティを使用する必要があります。</span><span class="sxs-lookup"><span data-stu-id="8f418-291">If you require additional skins, you should use the SkinID property.</span></span>

## <a name="applying-themes-to-pages"></a><span data-ttu-id="8f418-292">ページへのテーマの適用</span><span class="sxs-lookup"><span data-stu-id="8f418-292">Applying Themes to Pages</span></span>

<span data-ttu-id="8f418-293">テーマは、次のいずれかの方法を使用して適用できます。</span><span class="sxs-lookup"><span data-stu-id="8f418-293">A theme can be applied using any one of the following methods:</span></span>

- <span data-ttu-id="8f418-294">Web.config ファイルの &lt;pages&gt; 要素</span><span class="sxs-lookup"><span data-stu-id="8f418-294">In the &lt;pages&gt; element of the web.config file</span></span>
- <span data-ttu-id="8f418-295">ページの @Page ディレクティブ内</span><span class="sxs-lookup"><span data-stu-id="8f418-295">In the @Page directive of a page</span></span>
- <span data-ttu-id="8f418-296">プログラムを使用する</span><span class="sxs-lookup"><span data-stu-id="8f418-296">Programmatically</span></span>

## <a name="applying-a-theme-in-the-configuration-file"></a><span data-ttu-id="8f418-297">構成ファイルでのテーマの適用</span><span class="sxs-lookup"><span data-stu-id="8f418-297">Applying a Theme in the Configuration File</span></span>

<span data-ttu-id="8f418-298">アプリケーション構成ファイルにテーマを適用するには、次の構文を使用します。</span><span class="sxs-lookup"><span data-stu-id="8f418-298">To apply a theme in the applications configuration file, use the following syntax:</span></span>

[!code-xml[Main](profiles-themes-and-web-parts/samples/sample13.xml)]

<span data-ttu-id="8f418-299">ここで指定するテーマ名は、テーマフォルダーの名前と一致している必要があります。</span><span class="sxs-lookup"><span data-stu-id="8f418-299">The theme name specified here must match the name of the themes folder.</span></span> <span data-ttu-id="8f418-300">このフォルダーは、このコースで前述した場所のいずれかに存在することができます。</span><span class="sxs-lookup"><span data-stu-id="8f418-300">This folder can exist either in any one of the locations mentioned earlier in this course.</span></span> <span data-ttu-id="8f418-301">存在しないテーマを適用しようとすると、構成エラーが発生します。</span><span class="sxs-lookup"><span data-stu-id="8f418-301">If you attempt to apply a theme that doesn't exist, a configuration error will occur.</span></span>

## <a name="applying-a-theme-in-the-page-directive"></a><span data-ttu-id="8f418-302">Page ディレクティブでのテーマの適用</span><span class="sxs-lookup"><span data-stu-id="8f418-302">Applying a Theme in the Page Directive</span></span>

<span data-ttu-id="8f418-303">また、@ Page ディレクティブでテーマを適用することもできます。</span><span class="sxs-lookup"><span data-stu-id="8f418-303">You can also apply a theme in the @ Page directive.</span></span> <span data-ttu-id="8f418-304">このメソッドを使用すると、特定のページに対してテーマを使用できます。</span><span class="sxs-lookup"><span data-stu-id="8f418-304">This method allows you to use a theme for a specific page.</span></span>

<span data-ttu-id="8f418-305">@Page ディレクティブにテーマを適用するには、次の構文を使用します。</span><span class="sxs-lookup"><span data-stu-id="8f418-305">To apply a theme in the @Page directive, use the following syntax:</span></span>

[!code-aspx[Main](profiles-themes-and-web-parts/samples/sample14.aspx)]

<span data-ttu-id="8f418-306">ここでも、ここで指定するテーマは、前述のテーマフォルダーと一致している必要があります。</span><span class="sxs-lookup"><span data-stu-id="8f418-306">Once again, the theme specified here must match the theme folder as mentioned previously.</span></span> <span data-ttu-id="8f418-307">存在しないテーマを適用しようとすると、ビルドエラーが発生します。</span><span class="sxs-lookup"><span data-stu-id="8f418-307">If you attempt to apply a theme that doesn't exist, a build failure will occur.</span></span> <span data-ttu-id="8f418-308">また、Visual Studio は属性を強調表示し、そのようなテーマが存在しないことを通知します。</span><span class="sxs-lookup"><span data-stu-id="8f418-308">Visual Studio will also highlight the attribute and notify you that no such theme exists.</span></span>

## <a name="applying-a-theme-programmatically"></a><span data-ttu-id="8f418-309">プログラムによるテーマの適用</span><span class="sxs-lookup"><span data-stu-id="8f418-309">Applying a Theme Programmatically</span></span>

<span data-ttu-id="8f418-310">プログラムを使用してテーマを適用するには、ページ **\_PreInit**メソッドでページの**テーマ**プロパティを指定する必要があります。</span><span class="sxs-lookup"><span data-stu-id="8f418-310">To apply a theme programmatically, you must specify the **Theme** property for the page in the **Page\_PreInit** method.</span></span>

<span data-ttu-id="8f418-311">プログラムを使用してテーマを適用するには、次の構文を使用します。</span><span class="sxs-lookup"><span data-stu-id="8f418-311">To apply a theme programmatically, use the following syntax:</span></span>

[!code-csharp[Main](profiles-themes-and-web-parts/samples/sample15.cs)]

<span data-ttu-id="8f418-312">ページのライフサイクルが原因で、PreInit メソッドにテーマを適用する必要があります。</span><span class="sxs-lookup"><span data-stu-id="8f418-312">It is necessary to apply the theme in the PreInit method due to the page lifecycle.</span></span> <span data-ttu-id="8f418-313">その後に適用した場合、ページのテーマはランタイムによって既に適用されており、その時点での変更はライフサイクルにおいて遅すぎます。</span><span class="sxs-lookup"><span data-stu-id="8f418-313">If you apply it after that point, the pages theme will have already been applied by the runtime and a change at that point is too late in the lifecycle.</span></span> <span data-ttu-id="8f418-314">存在しないテーマを適用すると、 **Httpexception**が発生します。</span><span class="sxs-lookup"><span data-stu-id="8f418-314">If you apply a theme that doesn't exist, an **HttpException** occurs.</span></span> <span data-ttu-id="8f418-315">テーマがプログラムによって適用されると、いずれかのサーバーコントロールに SkinID プロパティが指定されている場合、ビルド警告が発生します。</span><span class="sxs-lookup"><span data-stu-id="8f418-315">When a theme is applied programmatically, a build warning will occur if any server controls have a SkinID property specified.</span></span> <span data-ttu-id="8f418-316">この警告は、テーマが宣言されていないことを通知するためのものであり、無視してもかまいません。</span><span class="sxs-lookup"><span data-stu-id="8f418-316">This warning is intended to inform you that no theme is declaratively applied and it can be ignored.</span></span>

## <a name="exercise-1--applying-a-theme"></a><span data-ttu-id="8f418-317">演習 1: テーマの適用</span><span class="sxs-lookup"><span data-stu-id="8f418-317">Exercise 1 : Applying a Theme</span></span>

<span data-ttu-id="8f418-318">この演習では、Web サイトに ASP.NET テーマを適用します。</span><span class="sxs-lookup"><span data-stu-id="8f418-318">In this exercise, you will apply an ASP.NET theme to a Web site.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="8f418-319">Microsoft Word を使用してスキンファイルに情報を入力する場合は、通常の引用符をスマート引用符で置き換えることがないようにしてください。</span><span class="sxs-lookup"><span data-stu-id="8f418-319">If you are using Microsoft Word to enter information into a skin file, make sure that you are not replacing regular quotes with smart quotes.</span></span> <span data-ttu-id="8f418-320">スマートクォートを使用すると、スキンファイルに問題が発生します。</span><span class="sxs-lookup"><span data-stu-id="8f418-320">Smart quotes will cause problems with skin files.</span></span>

1. <span data-ttu-id="8f418-321">新しい ASP.NET Web サイトの作成</span><span class="sxs-lookup"><span data-stu-id="8f418-321">Create a new ASP.NET Web site.</span></span>
2. <span data-ttu-id="8f418-322">ソリューションエクスプローラーでプロジェクトを右クリックし、[新しい項目の追加] を選択します。</span><span class="sxs-lookup"><span data-stu-id="8f418-322">Right-click on the project in Solution Explorer and choose Add New Item.</span></span>
3. <span data-ttu-id="8f418-323">ファイルの一覧から [Web 構成ファイル] を選択し、[追加] をクリックします。</span><span class="sxs-lookup"><span data-stu-id="8f418-323">Choose Web Configuration File from the list of files and click Add.</span></span>
4. <span data-ttu-id="8f418-324">ソリューションエクスプローラーでプロジェクトを右クリックし、[新しい項目の追加] を選択します。</span><span class="sxs-lookup"><span data-stu-id="8f418-324">Right-click on the project in Solution Explorer and choose Add New Item.</span></span>
5. <span data-ttu-id="8f418-325">[スキンファイル] を選択し、[追加] をクリックします。</span><span class="sxs-lookup"><span data-stu-id="8f418-325">Choose Skin File and click Add.</span></span>
6. <span data-ttu-id="8f418-326">アプリ\_テーマフォルダー内にファイルを配置するかどうかを確認するメッセージが表示されたら、[はい] をクリックします。</span><span class="sxs-lookup"><span data-stu-id="8f418-326">Click Yes when asked if you'd like to place the file inside of the App\_Themes folder.</span></span>
7. <span data-ttu-id="8f418-327">ソリューションエクスプローラーで、アプリ\_テーマフォルダー内の SkinFile フォルダーを右クリックし、[新しい項目の追加] を選択します。</span><span class="sxs-lookup"><span data-stu-id="8f418-327">Right-click on the SkinFile folder inside of the App\_Themes folder in Solution Explorer and choose Add New Item.</span></span>
8. <span data-ttu-id="8f418-328">ファイルの一覧から [スタイルシート] を選択し、[追加] をクリックします。</span><span class="sxs-lookup"><span data-stu-id="8f418-328">Choose Style Sheet from the list of files and click Add.</span></span> <span data-ttu-id="8f418-329">これで、新しいテーマを実装するために必要なすべてのファイルが作成されました。</span><span class="sxs-lookup"><span data-stu-id="8f418-329">You now have all of the files necessary to implement your new theme.</span></span> <span data-ttu-id="8f418-330">ただし、Visual Studio では、テーマフォルダー SkinFile という名前が付けられています。</span><span class="sxs-lookup"><span data-stu-id="8f418-330">However, Visual Studio has named your themes folder SkinFile.</span></span> <span data-ttu-id="8f418-331">そのフォルダーを右クリックし、名前を CoolTheme に変更します。</span><span class="sxs-lookup"><span data-stu-id="8f418-331">Right-click on that folder and change the name to CoolTheme.</span></span>
9. <span data-ttu-id="8f418-332">SkinFile ファイルを開き、ファイルの末尾に次のコードを追加します。</span><span class="sxs-lookup"><span data-stu-id="8f418-332">Open the SkinFile.skin file and add the following code the end of the file:</span></span> 

    [!code-aspx[Main](profiles-themes-and-web-parts/samples/sample16.aspx)]
10. <span data-ttu-id="8f418-333">SkinFile ファイルを保存します。</span><span class="sxs-lookup"><span data-stu-id="8f418-333">Save the SkinFile.skin file.</span></span>
11. <span data-ttu-id="8f418-334">StyleSheet を開きます。</span><span class="sxs-lookup"><span data-stu-id="8f418-334">Open the StyleSheet.css.</span></span>
12. <span data-ttu-id="8f418-335">その中のすべてのテキストを次の内容に置き換えます。</span><span class="sxs-lookup"><span data-stu-id="8f418-335">Replace all of the text in it with the following:</span></span> 

    [!code-css[Main](profiles-themes-and-web-parts/samples/sample17.css)]
13. <span data-ttu-id="8f418-336">スタイルシートの .css ファイルを保存します。</span><span class="sxs-lookup"><span data-stu-id="8f418-336">Save the StyleSheet.css file.</span></span>
14. <span data-ttu-id="8f418-337">Default.aspx ページを開きます。</span><span class="sxs-lookup"><span data-stu-id="8f418-337">Open the Default.aspx page.</span></span>
15. <span data-ttu-id="8f418-338">TextBox コントロールと Button コントロールを追加します。</span><span class="sxs-lookup"><span data-stu-id="8f418-338">Add a TextBox control and a Button control.</span></span>
16. <span data-ttu-id="8f418-339">ページを保存します。</span><span class="sxs-lookup"><span data-stu-id="8f418-339">Save the page.</span></span> <span data-ttu-id="8f418-340">次に default.aspx ページを参照します。</span><span class="sxs-lookup"><span data-stu-id="8f418-340">Now browse the Default.aspx page.</span></span> <span data-ttu-id="8f418-341">通常の Web フォームとして表示されます。</span><span class="sxs-lookup"><span data-stu-id="8f418-341">It should display as a normal Web form.</span></span>
17. <span data-ttu-id="8f418-342">Web.config ファイルを開きます。</span><span class="sxs-lookup"><span data-stu-id="8f418-342">Open the web.config file.</span></span>
18. <span data-ttu-id="8f418-343">開始 `<system.web>` タグのすぐ下に次のを追加します。</span><span class="sxs-lookup"><span data-stu-id="8f418-343">Add the following directly underneath the opening `<system.web>` tag:</span></span> 

    [!code-xml[Main](profiles-themes-and-web-parts/samples/sample18.xml)]
19. <span data-ttu-id="8f418-344">Web.config ファイルを保存します。</span><span class="sxs-lookup"><span data-stu-id="8f418-344">Save the web.config file.</span></span> <span data-ttu-id="8f418-345">次に default.aspx ページを参照します。</span><span class="sxs-lookup"><span data-stu-id="8f418-345">Now browse the Default.aspx page.</span></span> <span data-ttu-id="8f418-346">テーマが適用された状態で表示されます。</span><span class="sxs-lookup"><span data-stu-id="8f418-346">It should display with the theme applied.</span></span>
20. <span data-ttu-id="8f418-347">まだ開いていない場合は、Visual Studio の default.aspx ページを開きます。</span><span class="sxs-lookup"><span data-stu-id="8f418-347">If it's not already open, open the Default.aspx page in Visual Studio.</span></span>
21. <span data-ttu-id="8f418-348">[] ボタンを選択します。</span><span class="sxs-lookup"><span data-stu-id="8f418-348">Select the Button.</span></span>
22. <span data-ttu-id="8f418-349">**SkinID**プロパティを gobutton に変更します。</span><span class="sxs-lookup"><span data-stu-id="8f418-349">Change the **SkinID** property to goButton.</span></span> <span data-ttu-id="8f418-350">Visual Studio には、ボタンコントロールに対して有効な SkinID 値を含むドロップダウンが用意されています。</span><span class="sxs-lookup"><span data-stu-id="8f418-350">Notice that Visual Studio provides a dropdown with valid SkinID values for a Button control.</span></span>
23. <span data-ttu-id="8f418-351">ページを保存します。</span><span class="sxs-lookup"><span data-stu-id="8f418-351">Save the page.</span></span> <span data-ttu-id="8f418-352">次に、ブラウザーでページをもう一度プレビューします。</span><span class="sxs-lookup"><span data-stu-id="8f418-352">Now preview the page in your browser again.</span></span> <span data-ttu-id="8f418-353">ボタンが "進む" と表示され、より広い外観になります。</span><span class="sxs-lookup"><span data-stu-id="8f418-353">The Button should now say "go" and should be wider in appearance.</span></span>

<span data-ttu-id="8f418-354">**SkinID**プロパティを使用すると、特定の種類のサーバーコントロールの異なるインスタンスに対して異なるスキンを簡単に構成できます。</span><span class="sxs-lookup"><span data-stu-id="8f418-354">Using the **SkinID** property, you can easily configure different skins for different instances of a particular type of server control.</span></span>

## <a name="the-stylesheettheme-property"></a><span data-ttu-id="8f418-355">StyleSheetTheme プロパティ</span><span class="sxs-lookup"><span data-stu-id="8f418-355">The StyleSheetTheme Property</span></span>

<span data-ttu-id="8f418-356">ここまでは、テーマプロパティを使用したテーマの適用についてのみ説明しました。</span><span class="sxs-lookup"><span data-stu-id="8f418-356">So far, we've talked only about applying themes using the Theme property.</span></span> <span data-ttu-id="8f418-357">Theme プロパティを使用すると、スキンファイルによって、サーバーコントロールの宣言型の設定が上書きされます。</span><span class="sxs-lookup"><span data-stu-id="8f418-357">When using the Theme property, the skin file will override any declarative settings for server controls.</span></span> <span data-ttu-id="8f418-358">たとえば、演習1では、ボタンコントロールに対して "goButton" という SkinID を指定し、ボタンのテキストを "進む" に変更しました。</span><span class="sxs-lookup"><span data-stu-id="8f418-358">For example, in exercise 1, you specified a SkinID of "goButton" for the Button control and that changed the Button's text to "go".</span></span> <span data-ttu-id="8f418-359">デザイナーのボタンの Text プロパティが "Button" に設定されていることに気付いたかもしれませんが、テーマはそれをオーバーライドしています。</span><span class="sxs-lookup"><span data-stu-id="8f418-359">You may have noticed that the Text property of the Button in the designer was set to "Button", but the theme overrode that.</span></span> <span data-ttu-id="8f418-360">テーマは、常にデザイナーのプロパティ設定をオーバーライドします。</span><span class="sxs-lookup"><span data-stu-id="8f418-360">The theme will always override any property settings in the designer.</span></span>

<span data-ttu-id="8f418-361">テーマのスキンファイルで定義されているプロパティをデザイナーで指定されたプロパティでオーバーライドできるようにする場合は、Theme プロパティの代わりに**StyleSheetTheme**プロパティを使用できます。</span><span class="sxs-lookup"><span data-stu-id="8f418-361">If you'd like to be able to override the properties defined in the theme's skin file with properties specified in the designer, you can use the **StyleSheetTheme** property instead of the Theme property.</span></span> <span data-ttu-id="8f418-362">StyleSheetTheme プロパティは Theme プロパティと同じですが、Theme プロパティと同様に、明示的なプロパティ設定がすべてオーバーライドされる点が異なります。</span><span class="sxs-lookup"><span data-stu-id="8f418-362">The StyleSheetTheme property is the same as the Theme property except that it does not override all explicit property settings like the Theme property does.</span></span>

<span data-ttu-id="8f418-363">実際の動作を確認するには、演習1でプロジェクトの web.config ファイルを開き、`<pages>` 要素を次のように変更します。</span><span class="sxs-lookup"><span data-stu-id="8f418-363">To see this in action, open the web.config file from the project in exercise 1 and change the `<pages>` element to the following:</span></span>

[!code-xml[Main](profiles-themes-and-web-parts/samples/sample19.xml)]

<span data-ttu-id="8f418-364">Default.aspx ページを参照します。ボタンコントロールの Text プロパティが "Button" になっていることがわかります。</span><span class="sxs-lookup"><span data-stu-id="8f418-364">Now browse the Default.aspx page and you'll see that the Button control has a Text property of "Button" again.</span></span> <span data-ttu-id="8f418-365">これは、デザイナーの明示的なプロパティ設定によって、goButton SkinID によって設定された Text プロパティがオーバーライドされるためです。</span><span class="sxs-lookup"><span data-stu-id="8f418-365">That's because the explicit property setting in the designer is overriding the Text property set by the goButton SkinID.</span></span>

## <a name="overriding-themes"></a><span data-ttu-id="8f418-366">テーマのオーバーライド</span><span class="sxs-lookup"><span data-stu-id="8f418-366">Overriding Themes</span></span>

<span data-ttu-id="8f418-367">グローバルテーマをオーバーライドするには、アプリケーションの [アプリ\_テーマ] フォルダーにある同じ名前のテーマを適用します。</span><span class="sxs-lookup"><span data-stu-id="8f418-367">A global theme can be overridden by applying a theme by the same name in the App\_Themes folder of the application.</span></span> <span data-ttu-id="8f418-368">ただし、このテーマは、真のオーバーライドシナリオでは適用されません。</span><span class="sxs-lookup"><span data-stu-id="8f418-368">However, the theme is not applied in a true override scenario.</span></span> <span data-ttu-id="8f418-369">ランタイムがアプリの\_theme フォルダー内のテーマファイルを検出すると、それらのファイルを使用してテーマが適用され、グローバルテーマは無視されます。</span><span class="sxs-lookup"><span data-stu-id="8f418-369">If the runtime encounters theme files in the App\_Themes folder, it will apply the theme using those files and will ignore the global theme.</span></span>

<span data-ttu-id="8f418-370">StyleSheetTheme プロパティはオーバーライド可能で、次のようにコードでオーバーライドできます。</span><span class="sxs-lookup"><span data-stu-id="8f418-370">The StyleSheetTheme property is overridable and can be overridden in code as follows:</span></span>

[!code-csharp[Main](profiles-themes-and-web-parts/samples/sample20.cs)]

## <a name="web-parts"></a><span data-ttu-id="8f418-371">Web パーツ</span><span class="sxs-lookup"><span data-stu-id="8f418-371">Web Parts</span></span>

<span data-ttu-id="8f418-372">ASP.NET Web パーツは、エンドユーザーがブラウザーから直接 Web ページのコンテンツ、外観、および動作を変更できるようにする Web サイトを作成するためのコントロールの統合されたセットです。</span><span class="sxs-lookup"><span data-stu-id="8f418-372">ASP.NET Web Parts is an integrated set of controls for creating Web sites that enable end users to modify the content, appearance, and behavior of Web pages directly from a browser.</span></span> <span data-ttu-id="8f418-373">この変更は、サイト上のすべてのユーザーに適用することも、個々のユーザーに適用することもできます。</span><span class="sxs-lookup"><span data-stu-id="8f418-373">The modifications can be applied to all users on the site or to individual users.</span></span> <span data-ttu-id="8f418-374">ユーザーがページとコントロールを変更すると、その設定を保存して、今後のブラウザーセッション (パーソナル化と呼ばれます) の間にユーザーの個人設定を保持することができます。</span><span class="sxs-lookup"><span data-stu-id="8f418-374">When users modify pages and controls, the settings can be saved to retain a user's personal preferences across future browser sessions, a feature called personalization.</span></span> <span data-ttu-id="8f418-375">これらの Web パーツ機能は、開発者や管理者の介入なしに、エンドユーザーが Web アプリケーションを動的にカスタマイズできるようにすることを意味します。</span><span class="sxs-lookup"><span data-stu-id="8f418-375">These Web Parts capabilities mean that developers can empower end users to personalize a Web application dynamically, without developer or administrator intervention.</span></span>

<span data-ttu-id="8f418-376">開発者は、Web パーツコントロールセットを使用して、次の操作を行うことができます。</span><span class="sxs-lookup"><span data-stu-id="8f418-376">Using the Web Parts control set, you as a developer can enable end users to:</span></span>

- <span data-ttu-id="8f418-377">ページコンテンツをカスタマイズします。</span><span class="sxs-lookup"><span data-stu-id="8f418-377">Personalize page content.</span></span> <span data-ttu-id="8f418-378">ユーザーは、新しい Web パーツコントロールをページに追加したり、削除したり、非表示にしたり、通常のウィンドウのように最小化したりすることができます。</span><span class="sxs-lookup"><span data-stu-id="8f418-378">Users can add new Web Parts controls to a page, remove them, hide them, or minimize them like ordinary windows.</span></span>
- <span data-ttu-id="8f418-379">ページレイアウトを個人用に設定します。</span><span class="sxs-lookup"><span data-stu-id="8f418-379">Personalize page layout.</span></span> <span data-ttu-id="8f418-380">ユーザーは、Web パーツコントロールをページ上の別のゾーンにドラッグしたり、外観、プロパティ、動作を変更したりできます。</span><span class="sxs-lookup"><span data-stu-id="8f418-380">Users can drag a Web Parts control to a different zone on a page, or change its appearance, properties, and behavior.</span></span>
- <span data-ttu-id="8f418-381">コントロールをエクスポートおよびインポートします。</span><span class="sxs-lookup"><span data-stu-id="8f418-381">Export and import controls.</span></span> <span data-ttu-id="8f418-382">ユーザーは、他のページやサイトで使用するために Web パーツコントロールの設定をインポートまたはエクスポートできます。また、コントロールのプロパティ、外観、データも保持できます。</span><span class="sxs-lookup"><span data-stu-id="8f418-382">Users can import or export Web Parts control settings for use in other pages or sites, retaining the properties, appearance, and even the data in the controls.</span></span> <span data-ttu-id="8f418-383">これにより、エンドユーザーに対するデータ入力と構成の要求が減少します。</span><span class="sxs-lookup"><span data-stu-id="8f418-383">This reduces data entry and configuration demands on end users.</span></span>
- <span data-ttu-id="8f418-384">接続を作成します。</span><span class="sxs-lookup"><span data-stu-id="8f418-384">Create connections.</span></span> <span data-ttu-id="8f418-385">ユーザーはコントロール間の接続を確立できます。たとえば、グラフコントロールでは、株価情報コントロールのデータのグラフを表示できます。</span><span class="sxs-lookup"><span data-stu-id="8f418-385">Users can establish connections between controls so that, for example, a chart control could display a graph for the data in a stock ticker control.</span></span> <span data-ttu-id="8f418-386">ユーザーは、接続自体だけでなく、グラフコントロールでデータを表示する方法の外観と詳細をカスタマイズすることもできます。</span><span class="sxs-lookup"><span data-stu-id="8f418-386">Users could personalize not only the connection itself, but the appearance and details of how the chart control displays the data.</span></span>
- <span data-ttu-id="8f418-387">サイトレベルの設定を管理およびカスタマイズします。</span><span class="sxs-lookup"><span data-stu-id="8f418-387">Manage and personalize site-level settings.</span></span> <span data-ttu-id="8f418-388">承認されたユーザーは、サイトレベルの設定を構成したり、サイトまたはページにアクセスできるユーザーを特定したり、コントロールへのロールベースのアクセスを設定したりできます。</span><span class="sxs-lookup"><span data-stu-id="8f418-388">Authorized users can configure site-level settings, determine who can access a site or page, set role-based access to controls, and so on.</span></span> <span data-ttu-id="8f418-389">たとえば、管理者ロールのユーザーは、Web パーツコントロールをすべてのユーザーが共有するように設定し、管理者以外のユーザーが共有コントロールを個人用に設定するのを防ぐことができます。</span><span class="sxs-lookup"><span data-stu-id="8f418-389">For example, a user in an administrative role could set a Web Parts control to be shared by all users, and prevent users who are not administrators from personalizing the shared control.</span></span>

<span data-ttu-id="8f418-390">通常は、次の3つの方法のいずれかで Web パーツ操作を行います。 Web パーツコントロールを使用するページの作成、個別の Web パーツコントロールの作成、またはポータルなどの完全なパーソナル化された Web アプリケーションの作成です。</span><span class="sxs-lookup"><span data-stu-id="8f418-390">You will typically work with Web Parts in one of three ways: creating pages that use Web Parts controls, creating individual Web Parts controls, or creating complete, personalizable Web applications, such as a portal.</span></span>

## <a name="page-development"></a><span data-ttu-id="8f418-391">ページ開発</span><span class="sxs-lookup"><span data-stu-id="8f418-391">Page Development</span></span>

<span data-ttu-id="8f418-392">ページ開発者は、Microsoft Visual Studio 2005 などのビジュアルデザインツールを使用して、Web パーツを使用するページを作成できます。</span><span class="sxs-lookup"><span data-stu-id="8f418-392">Page developers can use visual design tools such as Microsoft Visual Studio 2005 to create pages that use Web Parts.</span></span> <span data-ttu-id="8f418-393">Visual Studio などのツールを使用する利点の1つとして、Web パーツコントロールセットによって、ビジュアルデザイナーでのドラッグアンドドロップによる Web パーツコントロールの作成と構成を行う機能が用意されています。</span><span class="sxs-lookup"><span data-stu-id="8f418-393">One advantage in using a tool such as Visual Studio is that the Web Parts control set provides features for drag-and-drop creation and configuration of Web Parts controls in a visual designer.</span></span> <span data-ttu-id="8f418-394">たとえば、デザイナーを使用して Web パーツゾーンまたは Web パーツエディターコントロールをデザイン画面にドラッグし、Web パーツコントロールセットによって提供される UI を使用してデザイナーでコントロールを構成できます。</span><span class="sxs-lookup"><span data-stu-id="8f418-394">For example, you can use the designer to drag a Web Parts zone, or a Web Parts editor control, onto the design surface, and then configure the control right in the designer using the UI provided by the Web Parts control set.</span></span> <span data-ttu-id="8f418-395">これにより、Web パーツアプリケーションの開発を高速化し、記述する必要のあるコードの量を減らすことができます。</span><span class="sxs-lookup"><span data-stu-id="8f418-395">This can speed development of Web Parts applications and reduce the amount of code you have to write.</span></span>

## <a name="control-development"></a><span data-ttu-id="8f418-396">開発の制御</span><span class="sxs-lookup"><span data-stu-id="8f418-396">Control Development</span></span>

<span data-ttu-id="8f418-397">標準の Web サーバーコントロール、カスタムサーバーコントロール、ユーザーコントロールなど、既存の ASP.NET コントロールを Web パーツコントロールとして使用できます。</span><span class="sxs-lookup"><span data-stu-id="8f418-397">You can use any existing ASP.NET control as a Web Parts control, including standard Web server controls, custom server controls, and user controls.</span></span> <span data-ttu-id="8f418-398">環境のプログラムによる制御を最大限に活用するために、WebPart クラスから派生するカスタム Web パーツコントロールを作成することもできます。</span><span class="sxs-lookup"><span data-stu-id="8f418-398">For maximum programmatic control of your environment, you can also create custom Web Parts controls that derive from the WebPart class.</span></span> <span data-ttu-id="8f418-399">Web パーツコントロールを個別に開発する場合は、通常、ユーザーコントロールを作成し、それを Web パーツコントロールとして使用するか、カスタム Web パーツコントロールを開発します。</span><span class="sxs-lookup"><span data-stu-id="8f418-399">For individual Web Parts control development, you will typically either create a user control and use it as a Web Parts control, or develop a custom Web Parts control.</span></span>

<span data-ttu-id="8f418-400">カスタム Web パーツコントロールを開発する例として、コントロールを作成して、他の ASP.NET サーバーコントロールによって提供される機能を提供することができます。これは、カスタマイズ可能な Web パーツコントロールとしてパッケージ化する場合に便利です。カレンダー、リスト、財務情報、コンテンツを更新するためのニュース、電卓、リッチテキストコントロール、データベースに接続する編集可能なグリッド、表示を動的に更新するグラフ、気象情報、旅行情報などがあります。</span><span class="sxs-lookup"><span data-stu-id="8f418-400">As an example of developing a custom Web Parts control, you could create a control to provide any of the features provided by other ASP.NET server controls that might be useful to package as a personalizable Web Parts control: calendars, lists, financial information, news, calculators, rich text controls for updating content, editable grids that connect to databases, charts that dynamically update their displays, or weather and travel information.</span></span> <span data-ttu-id="8f418-401">コントロールにビジュアルデザイナーを提供する場合、Visual Studio を使用するすべてのページ開発者は、コントロールを単に Web パーツゾーンにドラッグして、追加のコードを記述することなくデザイン時に構成できます。</span><span class="sxs-lookup"><span data-stu-id="8f418-401">If you provide a visual designer with your control, then any page developer using Visual Studio can simply drag your control into a Web Parts zone and configure it at design time without having to write additional code.</span></span>

<span data-ttu-id="8f418-402">個人用設定は、Web パーツ機能の基盤です。</span><span class="sxs-lookup"><span data-stu-id="8f418-402">Personalization is the foundation of the Web Parts feature.</span></span> <span data-ttu-id="8f418-403">これにより、ユーザーは、ページ上の Web パーツコントロールのレイアウト、外観、および動作を変更またはカスタマイズすることができます。</span><span class="sxs-lookup"><span data-stu-id="8f418-403">It enables users to modify--or personalize--the layout, appearance, and behavior of Web Parts controls on a page.</span></span> <span data-ttu-id="8f418-404">個人用に設定された設定は有効期間が長くなります。つまり、現在のブラウザーセッション (ビューステートの場合) だけでなく、長期的なストレージでも保持されるので、今後のブラウザーセッションでもユーザーの設定が保存されます。</span><span class="sxs-lookup"><span data-stu-id="8f418-404">The personalized settings are long-lived: they are persisted not just during the current browser session (as with view state), but also in long-term storage, so that a user's settings are saved for future browser sessions as well.</span></span> <span data-ttu-id="8f418-405">Web パーツページでは、個人用設定が既定で有効になっています。</span><span class="sxs-lookup"><span data-stu-id="8f418-405">Personalization is enabled by default for Web Parts pages.</span></span>

<span data-ttu-id="8f418-406">UI 構造コンポーネントは、パーソナル化に依存しており、すべての Web パーツコントロールで必要なコア構造とサービスを提供します。</span><span class="sxs-lookup"><span data-stu-id="8f418-406">The UI structural components rely on personalization and provide the core structure and services needed by all Web Parts controls.</span></span> <span data-ttu-id="8f418-407">すべての Web パーツページに必要な1つの UI 構造コンポーネントが、WebPartManager コントロールです。</span><span class="sxs-lookup"><span data-stu-id="8f418-407">One UI structural component required on every Web Parts page is the WebPartManager control.</span></span> <span data-ttu-id="8f418-408">このコントロールには表示されませんが、ページ上のすべての Web パーツコントロールを調整するための重要なタスクがあります。</span><span class="sxs-lookup"><span data-stu-id="8f418-408">Although never visible, this control has the critical task of coordinating all Web Parts controls on a page.</span></span> <span data-ttu-id="8f418-409">たとえば、すべての個別 Web パーツコントロールを追跡します。</span><span class="sxs-lookup"><span data-stu-id="8f418-409">For example, it tracks all the individual Web Parts controls.</span></span> <span data-ttu-id="8f418-410">Web パーツゾーン (ページ上の Web パーツコントロールを含む領域) と、どのコントロールがどのゾーンにあるかを管理します。</span><span class="sxs-lookup"><span data-stu-id="8f418-410">It manages Web Parts zones (regions that contain Web Parts controls on a page), and which controls are in which zones.</span></span> <span data-ttu-id="8f418-411">また、参照、接続、編集、カタログモードなど、ページが持つさまざまな表示モードや、個人用設定の変更をすべてのユーザーに適用するか、個々のユーザーに適用するかを追跡および制御します。</span><span class="sxs-lookup"><span data-stu-id="8f418-411">It also tracks and controls the different display modes a page can be in, such as browse,connect, edit, or catalog mode, and whether personalization changes apply to all users or to individual users.</span></span> <span data-ttu-id="8f418-412">最後に、Web パーツコントロール間の接続と通信を開始して追跡します。</span><span class="sxs-lookup"><span data-stu-id="8f418-412">Finally, it initiates and tracks connections and communication between Web Parts controls.</span></span>

<span data-ttu-id="8f418-413">UI 構造コンポーネントの2つ目の種類は、ゾーンです。</span><span class="sxs-lookup"><span data-stu-id="8f418-413">The second kind of UI structural component is the zone.</span></span> <span data-ttu-id="8f418-414">ゾーンは、Web パーツページのレイアウトマネージャーとして機能します。</span><span class="sxs-lookup"><span data-stu-id="8f418-414">Zones act as layout managers on a Web Parts page.</span></span> <span data-ttu-id="8f418-415">パートクラス (パーツコントロール) から派生したコントロールを格納して整理し、水平方向または垂直方向の両方でモジュール式のページレイアウトを行う機能を提供します。</span><span class="sxs-lookup"><span data-stu-id="8f418-415">They contain and organize controls that derive from the Part class (part controls), and provide the ability to do modular page layout in either horizontal or vertical orientation.</span></span> <span data-ttu-id="8f418-416">また、ゾーンは、含まれるコントロールごとに共通の一貫した UI 要素 (ヘッダー、フッターのスタイル、タイトル、罫線のスタイル、アクションボタンなど) を提供します。これらの共通要素は、コントロールの chrome として知られています。</span><span class="sxs-lookup"><span data-stu-id="8f418-416">Zones also offer common and consistent UI elements (such as header and footer style, title, border style, action buttons, and so on) for each control they contain; these common elements are known as the chrome of a control.</span></span> <span data-ttu-id="8f418-417">いくつかの特殊な種類のゾーンは、さまざまな表示モードおよびさまざまなコントロールで使用されます。</span><span class="sxs-lookup"><span data-stu-id="8f418-417">Several specialized types of zones are used in the different display modes and with various controls.</span></span> <span data-ttu-id="8f418-418">さまざまな種類のゾーンについては、以下の「Web パーツの重要なコントロール」で説明しています。</span><span class="sxs-lookup"><span data-stu-id="8f418-418">The different types of zones are described in the Web Parts Essential Controls section below.</span></span>

<span data-ttu-id="8f418-419">Web パーツ UI コントロールは、**パート**クラスから派生したものであり、Web パーツページのプライマリ ui を構成します。</span><span class="sxs-lookup"><span data-stu-id="8f418-419">The Web Parts UI controls, all of which derive from the **Part** class, comprise the primary UI on a Web Parts page.</span></span> <span data-ttu-id="8f418-420">Web パーツコントロールセットは柔軟であり、パーツコントロールを作成するために使用できるオプションを含みます。</span><span class="sxs-lookup"><span data-stu-id="8f418-420">The Web Parts control set is flexible and inclusive in the options it gives you for creating part controls.</span></span> <span data-ttu-id="8f418-421">独自のカスタム Web パーツコントロールを作成するだけでなく、既存の ASP.NET サーバーコントロール、ユーザーコントロール、またはカスタムサーバーコントロールを Web パーツコントロールとして使用することもできます。</span><span class="sxs-lookup"><span data-stu-id="8f418-421">In addition to creating your own custom Web Parts controls, you can also use existing ASP.NET server controls, user controls, or custom server controls as Web Parts controls.</span></span> <span data-ttu-id="8f418-422">Web パーツページを作成するために最も一般的に使用される基本コントロールについては、次のセクションで説明します。</span><span class="sxs-lookup"><span data-stu-id="8f418-422">The essential controls that are most commonly used for creating Web Parts pages are described in the next section.</span></span>

## <a name="web-parts-essential-controls"></a><span data-ttu-id="8f418-423">Web パーツの重要なコントロール</span><span class="sxs-lookup"><span data-stu-id="8f418-423">Web Parts Essential Controls</span></span>

<span data-ttu-id="8f418-424">Web パーツコントロールセットは広く使用されていますが、Web パーツが動作するために必要なコントロールや、Web パーツページで最も頻繁に使用されるコントロールであるため、いくつかのコントロールが不可欠です。</span><span class="sxs-lookup"><span data-stu-id="8f418-424">The Web Parts control set is extensive, but some controls are essential either because they are required for Web Parts to work, or because they are the controls most frequently used on Web Parts pages.</span></span> <span data-ttu-id="8f418-425">Web パーツの使用と基本的な Web パーツページの作成を開始する際には、次の表に記載されている基本的な Web パーツコントロールについて理解しておくことをお勧めします。</span><span class="sxs-lookup"><span data-stu-id="8f418-425">As you begin using Web Parts and creating basic Web Parts pages, it is helpful to be familiar with the essential Web Parts controls described in the following table.</span></span>

| <span data-ttu-id="8f418-426">**Web パーツコントロール**</span><span class="sxs-lookup"><span data-stu-id="8f418-426">**Web Parts control**</span></span> | <span data-ttu-id="8f418-427">**説明**</span><span class="sxs-lookup"><span data-stu-id="8f418-427">**Description**</span></span> |
| --- | --- |
| <span data-ttu-id="8f418-428">WebPartManager</span><span class="sxs-lookup"><span data-stu-id="8f418-428">WebPartManager</span></span> | <span data-ttu-id="8f418-429">ページ上のすべての Web パーツコントロールを管理します。</span><span class="sxs-lookup"><span data-stu-id="8f418-429">Manages all Web Parts controls on a page.</span></span> <span data-ttu-id="8f418-430">すべての Web パーツページに1つ (1 つだけ) の**WebPartManager**コントロールが必要です。</span><span class="sxs-lookup"><span data-stu-id="8f418-430">One (and only one) **WebPartManager** control is required for every Web Parts page.</span></span> |
| <span data-ttu-id="8f418-431">CatalogZone</span><span class="sxs-lookup"><span data-stu-id="8f418-431">CatalogZone</span></span> | <span data-ttu-id="8f418-432">CatalogPart コントロールを含みます。</span><span class="sxs-lookup"><span data-stu-id="8f418-432">Contains CatalogPart controls.</span></span> <span data-ttu-id="8f418-433">このゾーンを使用して、ユーザーがページに追加するコントロールを選択できる Web パーツコントロールのカタログを作成します。</span><span class="sxs-lookup"><span data-stu-id="8f418-433">Use this zone to create a catalog of Web Parts controls from which users can select controls to add to a page.</span></span> |
| <span data-ttu-id="8f418-434">EditorZone</span><span class="sxs-lookup"><span data-stu-id="8f418-434">EditorZone</span></span> | <span data-ttu-id="8f418-435">EditorPart コントロールを含みます。</span><span class="sxs-lookup"><span data-stu-id="8f418-435">Contains EditorPart controls.</span></span> <span data-ttu-id="8f418-436">このゾーンを使用して、ユーザーがページ上のコントロールを編集およびカスタマイズ Web パーツできるようにします。</span><span class="sxs-lookup"><span data-stu-id="8f418-436">Use this zone to enable users to edit and personalize Web Parts controls on a page.</span></span> |
| <span data-ttu-id="8f418-437">WebPartZone</span><span class="sxs-lookup"><span data-stu-id="8f418-437">WebPartZone</span></span> | <span data-ttu-id="8f418-438">には、ページのメイン UI を構成する WebPart コントロールの全体的なレイアウトが含まれています。</span><span class="sxs-lookup"><span data-stu-id="8f418-438">Contains and provides overall layout for the WebPart controls that compose the main UI of a page.</span></span> <span data-ttu-id="8f418-439">Web パーツコントロールを使用してページを作成するたびに、このゾーンを使用します。</span><span class="sxs-lookup"><span data-stu-id="8f418-439">Use this zone whenever you create pages with Web Parts controls.</span></span> <span data-ttu-id="8f418-440">ページには、1つまたは複数のゾーンを含めることができます。</span><span class="sxs-lookup"><span data-stu-id="8f418-440">Pages can contain one or more zones.</span></span> |
| <span data-ttu-id="8f418-441">ConnectionsZone</span><span class="sxs-lookup"><span data-stu-id="8f418-441">ConnectionsZone</span></span> | <span data-ttu-id="8f418-442">WebPartConnection コントロールを含み、接続を管理するための UI を提供します。</span><span class="sxs-lookup"><span data-stu-id="8f418-442">Contains WebPartConnection controls, and provides a UI for managing connections.</span></span> |
| <span data-ttu-id="8f418-443">WebPart (GenericWebPart)</span><span class="sxs-lookup"><span data-stu-id="8f418-443">WebPart (GenericWebPart)</span></span> | <span data-ttu-id="8f418-444">プライマリ UI をレンダリングします。ほとんどの Web パーツ UI コントロールは、このカテゴリに分類されます。</span><span class="sxs-lookup"><span data-stu-id="8f418-444">Renders the primary UI; most Web Parts UI controls fall into this category.</span></span> <span data-ttu-id="8f418-445">プログラムによる制御を最大限にするために、基本の**WebPart**コントロールから派生するカスタム Web パーツコントロールを作成できます。</span><span class="sxs-lookup"><span data-stu-id="8f418-445">For maximum programmatic control, you can create custom Web Parts controls that derive from the base **WebPart** control.</span></span> <span data-ttu-id="8f418-446">また、既存のサーバーコントロール、ユーザーコントロール、またはカスタムコントロールを Web パーツコントロールとして使用することもできます。</span><span class="sxs-lookup"><span data-stu-id="8f418-446">You can also use existing server controls, user controls, or custom controls as Web Parts controls.</span></span> <span data-ttu-id="8f418-447">これらのコントロールのいずれかがゾーン内に配置されている場合、 **WebPartManager**コントロールは、 **GenericWebPart**コントロールを実行時に自動的にラップして、Web パーツ機能と共に使用できるようにします。</span><span class="sxs-lookup"><span data-stu-id="8f418-447">Whenever any of these controls are placed in a zone, the **WebPartManager** control automatically wraps them with **GenericWebPart** controls at run time so that you can use them with Web Parts functionality.</span></span> |
| <span data-ttu-id="8f418-448">CatalogPart</span><span class="sxs-lookup"><span data-stu-id="8f418-448">CatalogPart</span></span> | <span data-ttu-id="8f418-449">ユーザーがページに追加できる、使用可能な Web パーツコントロールの一覧が含まれています。</span><span class="sxs-lookup"><span data-stu-id="8f418-449">Contains a list of available Web Parts controls that users can add to the page.</span></span> |
| <span data-ttu-id="8f418-450">WebPartConnection</span><span class="sxs-lookup"><span data-stu-id="8f418-450">WebPartConnection</span></span> | <span data-ttu-id="8f418-451">ページ上の2つの Web パーツコントロール間の接続を作成します。</span><span class="sxs-lookup"><span data-stu-id="8f418-451">Creates a connection between two Web Parts controls on a page.</span></span> <span data-ttu-id="8f418-452">この接続では、Web パーツコントロールの1つをプロバイダー (データの) として定義し、もう一方をコンシューマーとして定義します。</span><span class="sxs-lookup"><span data-stu-id="8f418-452">The connection defines one of the Web Parts controls as a provider (of data), and the other as a consumer.</span></span> |
| <span data-ttu-id="8f418-453">EditorPart</span><span class="sxs-lookup"><span data-stu-id="8f418-453">EditorPart</span></span> | <span data-ttu-id="8f418-454">特殊なエディターコントロールの基本クラスとして機能します。</span><span class="sxs-lookup"><span data-stu-id="8f418-454">Serves as the base class for the specialized editor controls.</span></span> |
| <span data-ttu-id="8f418-455">EditorPart コントロール (外観、LayoutEditorPart、PropertyGridEditorPart、および)</span><span class="sxs-lookup"><span data-stu-id="8f418-455">EditorPart controls (AppearanceEditorPart, LayoutEditorPart, BehaviorEditorPart, and PropertyGridEditorPart)</span></span> | <span data-ttu-id="8f418-456">ページ上の Web パーツ UI コントロールのさまざまな側面をユーザーがカスタマイズできるようにする</span><span class="sxs-lookup"><span data-stu-id="8f418-456">Allow users to personalize various aspects of Web Parts UI controls on a page</span></span> |

## <a name="lab-create-a-web-part-page"></a><span data-ttu-id="8f418-457">ラボ: Web パーツページの作成</span><span class="sxs-lookup"><span data-stu-id="8f418-457">Lab: Create a Web Part Page</span></span>

<span data-ttu-id="8f418-458">このラボでは、ASP.NET プロファイルを使用して情報を保持する Web パーツページを作成します。</span><span class="sxs-lookup"><span data-stu-id="8f418-458">In this lab, you will create a Web part page that will persist information via ASP.NET profiles.</span></span>

### <a name="creating-a-simple-page-with-web-parts"></a><span data-ttu-id="8f418-459">Web パーツを使用した簡単なページの作成</span><span class="sxs-lookup"><span data-stu-id="8f418-459">Creating a Simple Page with Web Parts</span></span>

<span data-ttu-id="8f418-460">チュートリアルのこの部分では、Web パーツコントロールを使用して静的コンテンツを表示するページを作成します。</span><span class="sxs-lookup"><span data-stu-id="8f418-460">In this part of the walkthrough, you create a page that uses Web Parts controls to show static content.</span></span> <span data-ttu-id="8f418-461">Web パーツを操作するための最初の手順は、2つの必須の構造要素を持つページを作成することです。</span><span class="sxs-lookup"><span data-stu-id="8f418-461">The first step in working with Web Parts is to create a page with two required structural elements.</span></span> <span data-ttu-id="8f418-462">まず、Web パーツページには、すべての Web パーツコントロールを追跡して調整するための WebPartManager コントロールが必要です。</span><span class="sxs-lookup"><span data-stu-id="8f418-462">First, a Web parts page needs a WebPartManager control to track and coordinate all Web Parts controls.</span></span> <span data-ttu-id="8f418-463">次に、Web パーツページには1つ以上のゾーンが必要です。これは、WebPart コントロールまたは他のサーバーコントロールを含み、ページの指定された領域を占める複合コントロールです。</span><span class="sxs-lookup"><span data-stu-id="8f418-463">Second, a Web Parts page needs one or more zones, which are composite controls that contain WebPart or other server controls and occupy a specified region of a page.</span></span>

> [!NOTE]
> <span data-ttu-id="8f418-464">Web パーツ個人用設定を有効にするために何もする必要はありません。これは、Web パーツコントロールセットに対して既定で有効になっています。</span><span class="sxs-lookup"><span data-stu-id="8f418-464">You do not need to do anything to enable Web Parts personalization; it is enabled by default for the Web Parts control set.</span></span> <span data-ttu-id="8f418-465">サイトで最初に Web パーツページを実行すると、ASP.NET は、ユーザーの個人用設定を格納するための既定のパーソナル化プロバイダーを設定します。</span><span class="sxs-lookup"><span data-stu-id="8f418-465">When you first run a Web Parts page on a site, ASP.NET sets up a default personalization provider to store user personalization settings.</span></span> <span data-ttu-id="8f418-466">パーソナル化の詳細については、「Web パーツパーソナル化の概要」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="8f418-466">For more information about personalization, see Web Parts Personalization Overview.</span></span>

### <a name="to-create-a-page-for-containing-web-parts-controls"></a><span data-ttu-id="8f418-467">Web パーツコントロールを含むページを作成するには</span><span class="sxs-lookup"><span data-stu-id="8f418-467">To create a page for containing Web Parts controls</span></span>

1. <span data-ttu-id="8f418-468">既定のページを閉じ、WebPartsDemo .aspx という名前のサイトに新しいページを追加します。</span><span class="sxs-lookup"><span data-stu-id="8f418-468">Close the default page and add a new page to the site named WebPartsDemo.aspx.</span></span>
2. <span data-ttu-id="8f418-469">**デザイン**ビューに切り替えます。</span><span class="sxs-lookup"><span data-stu-id="8f418-469">Switch to **Design** view.</span></span>
3. <span data-ttu-id="8f418-470">**[表示]** メニューで、 **[非ビジュアルコントロール]** オプションと **[詳細]** オプションが選択されていることを確認します。これにより、UI を持たないレイアウトタグとコントロールが表示されます。</span><span class="sxs-lookup"><span data-stu-id="8f418-470">From the **View** menu, make sure that the **Non-Visual Controls** and **Details** options are selected so you can see layout tags and controls that do not have a UI.</span></span>
4. <span data-ttu-id="8f418-471">デザインサーフェイスの `<div>` タグの前に挿入ポイントを置き、ENTER キーを押して新しい行を追加します。</span><span class="sxs-lookup"><span data-stu-id="8f418-471">Place the insertion point before the `<div>` tags on the design surface, and press ENTER to add a new line.</span></span> <span data-ttu-id="8f418-472">挿入ポイントを改行文字の前に配置し、メニューの **[ブロックの書式]** ドロップダウンリストコントロールをクリックして、**見出し 1**オプションを選択します。</span><span class="sxs-lookup"><span data-stu-id="8f418-472">Position the insertion point before the new line character, click the **Block Format** drop-down list control on the menu, and select the **Heading 1** option.</span></span> <span data-ttu-id="8f418-473">見出しに、テキスト**Web パーツのデモページ**を追加します。</span><span class="sxs-lookup"><span data-stu-id="8f418-473">In the heading, add the text **Web Parts Demonstration Page**.</span></span>
5. <span data-ttu-id="8f418-474">ツールボックス の  **Web パーツ** タブで、 **WebPartManager**コントロールをページにドラッグし、新しい行文字の直後と `<div>`タグの前に配置します。</span><span class="sxs-lookup"><span data-stu-id="8f418-474">From the **WebParts** tab of the Toolbox, drag a **WebPartManager** control onto the page, positioning it just after the new line character and before the `<div>`tags.</span></span>   
  
   <span data-ttu-id="8f418-475">**WebPartManager**コントロールは出力を表示しないので、デザイナー画面に灰色のボックスとして表示されます。</span><span class="sxs-lookup"><span data-stu-id="8f418-475">The **WebPartManager** control does not render any output, so it appears as a grey box on the designer surface.</span></span>
6. <span data-ttu-id="8f418-476">`<div>` タグ内に挿入ポイントを配置します。</span><span class="sxs-lookup"><span data-stu-id="8f418-476">Position the insertion point within the `<div>` tags.</span></span>
7. <span data-ttu-id="8f418-477">**[レイアウト]** メニューの **[テーブルの挿入]** をクリックし、1行と3つの列を含む新しいテーブルを作成します。</span><span class="sxs-lookup"><span data-stu-id="8f418-477">In the **Layout** menu, click **Insert Table**, and create a new table that has one row and three columns.</span></span> <span data-ttu-id="8f418-478">**[セルのプロパティ]** ボタンをクリックし、 **[垂直方向の配置]** ドロップダウンリストから **[上]** を選択します。 **[ok]** をクリックし、もう一度 **[ok]** をクリックしてテーブルを作成します。</span><span class="sxs-lookup"><span data-stu-id="8f418-478">Click the **Cell Properties** button, select **top** from the **Vertical align** drop-down list, click **OK**, and click **OK** again to create the table.</span></span>
8. <span data-ttu-id="8f418-479">WebPartZone コントロールを左テーブルの列にドラッグします。</span><span class="sxs-lookup"><span data-stu-id="8f418-479">Drag a WebPartZone control into the left table column.</span></span> <span data-ttu-id="8f418-480">**WebPartZone**コントロールを右クリックし、 **[プロパティ]** を選択して、次のプロパティを設定します。</span><span class="sxs-lookup"><span data-stu-id="8f418-480">Right-click the **WebPartZone** control, choose **Properties**, and set the following properties:</span></span>   
  
   <span data-ttu-id="8f418-481">ID: SidebarZone</span><span class="sxs-lookup"><span data-stu-id="8f418-481">ID: SidebarZone</span></span>   
  
   <span data-ttu-id="8f418-482">HeaderText: サイドバー</span><span class="sxs-lookup"><span data-stu-id="8f418-482">HeaderText: Sidebar</span></span>
9. <span data-ttu-id="8f418-483">2つ目の**WebPartZone**コントロールを中央のテーブル列にドラッグし、次のプロパティを設定します。</span><span class="sxs-lookup"><span data-stu-id="8f418-483">Drag a second **WebPartZone** control into the middle table column and set the following properties:</span></span>   
  
   <span data-ttu-id="8f418-484">ID: MainZone</span><span class="sxs-lookup"><span data-stu-id="8f418-484">ID: MainZone</span></span>   
  
   <span data-ttu-id="8f418-485">HeaderText: Main</span><span class="sxs-lookup"><span data-stu-id="8f418-485">HeaderText: Main</span></span>
10. <span data-ttu-id="8f418-486">ファイルを保存します。</span><span class="sxs-lookup"><span data-stu-id="8f418-486">Save the file.</span></span>

<span data-ttu-id="8f418-487">ページには、個別に制御できる2つの個別のゾーンがあります。</span><span class="sxs-lookup"><span data-stu-id="8f418-487">Your page now has two distinct zones that you can control separately.</span></span> <span data-ttu-id="8f418-488">ただし、どのゾーンにもコンテンツがないため、コンテンツを作成するのは次の手順です。</span><span class="sxs-lookup"><span data-stu-id="8f418-488">However, neither zone has any content, so creating content is the next step.</span></span> <span data-ttu-id="8f418-489">このチュートリアルでは、静的コンテンツのみを表示する Web パーツコントロールを操作します。</span><span class="sxs-lookup"><span data-stu-id="8f418-489">For this walkthrough, you work with Web Parts controls that display only static content.</span></span>

<span data-ttu-id="8f418-490">Web パーツゾーンのレイアウトは、&lt;zonetemplate&gt; 要素によって指定されます。</span><span class="sxs-lookup"><span data-stu-id="8f418-490">The layout of a Web Parts zone is specified by a &lt;zonetemplate&gt; element.</span></span> <span data-ttu-id="8f418-491">ゾーンテンプレート内では、カスタム Web パーツコントロール、ユーザーコントロール、または既存のサーバーコントロールのいずれであるかにかかわらず、任意の ASP.NET コントロールを追加できます。</span><span class="sxs-lookup"><span data-stu-id="8f418-491">Inside the zone template, you can add any ASP.NET control, whether it is a custom Web Parts control, a user control, or an existing server control.</span></span> <span data-ttu-id="8f418-492">ここでは、ラベルコントロールを使用しており、静的テキストを追加するだけであることに注意してください。</span><span class="sxs-lookup"><span data-stu-id="8f418-492">Notice that here you are using the Label control, and to that you are simply adding static text.</span></span> <span data-ttu-id="8f418-493">通常のサーバーコントロールを**WebPartZone**ゾーンに配置すると、ASP.NET はそのコントロールを実行時に Web パーツコントロールとして扱います。これにより、コントロールの機能が有効 Web パーツになります。</span><span class="sxs-lookup"><span data-stu-id="8f418-493">When you place a regular server control in a **WebPartZone** zone, ASP.NET treats the control as a Web Parts control at run time, which enables Web Parts features on the control.</span></span>

<span data-ttu-id="8f418-494">**メインゾーンのコンテンツを作成するには**</span><span class="sxs-lookup"><span data-stu-id="8f418-494">**To create content for the main zone**</span></span>

1. <span data-ttu-id="8f418-495">**[デザイン]** ビューで、ツールボックス の **[標準]** タブの **[ラベル]** コントロールを、 **ID**プロパティが [mainzone] に設定されているゾーンの [コンテンツ] 領域にドラッグします。</span><span class="sxs-lookup"><span data-stu-id="8f418-495">In **Design** view, drag a **Label** control from the **Standard** tab of the Toolbox into the contents area of the zone whose **ID** property is set to MainZone.</span></span>
2. <span data-ttu-id="8f418-496">**ソース**ビューに切り替えます。</span><span class="sxs-lookup"><span data-stu-id="8f418-496">Switch to **Source** view.</span></span> <span data-ttu-id="8f418-497">MainZone で**ラベル**コントロールをラップするために &lt;zonetemplate&gt; 要素が追加されていることに注目してください。</span><span class="sxs-lookup"><span data-stu-id="8f418-497">Notice that a &lt;zonetemplate&gt; element was added to wrap the **Label** control in the MainZone.</span></span>
3. <span data-ttu-id="8f418-498">**Title**という名前の属性を &lt;asp: label&gt; 要素に追加し、その値を Content に設定します。</span><span class="sxs-lookup"><span data-stu-id="8f418-498">Add an attribute named **title** to the &lt;asp:label&gt; element, and set its value to Content.</span></span> <span data-ttu-id="8f418-499">&lt;asp: label&gt; 要素から Text = "Label" 属性を削除します。</span><span class="sxs-lookup"><span data-stu-id="8f418-499">Remove the Text="Label" attribute from the &lt;asp:label&gt; element.</span></span> <span data-ttu-id="8f418-500">&lt;asp: label&gt; 要素の開始タグと終了タグの間に、&lt;h2&gt; 要素タグのペア内の**ホームページへようこそ**などのテキストを追加します。</span><span class="sxs-lookup"><span data-stu-id="8f418-500">Between the opening and closing tags of the &lt;asp:label&gt; element, add some text such as **Welcome to my Home Page** within a pair of &lt;h2&gt; element tags.</span></span> <span data-ttu-id="8f418-501">コードは次のようになります。</span><span class="sxs-lookup"><span data-stu-id="8f418-501">Your code should look as follows.</span></span> 

    [!code-aspx[Main](profiles-themes-and-web-parts/samples/sample21.aspx)]
4. <span data-ttu-id="8f418-502">ファイルを保存します。</span><span class="sxs-lookup"><span data-stu-id="8f418-502">Save the file.</span></span>

<span data-ttu-id="8f418-503">次に、Web パーツコントロールとしてページに追加することもできるユーザーコントロールを作成します。</span><span class="sxs-lookup"><span data-stu-id="8f418-503">Next, create a user control that can also be added to the page as a Web Parts control.</span></span>

### <a name="to-create-a-user-control"></a><span data-ttu-id="8f418-504">ユーザー コントロールを作成するには</span><span class="sxs-lookup"><span data-stu-id="8f418-504">To create a user control</span></span>

1. <span data-ttu-id="8f418-505">検索コントロールとして機能する新しい Web ユーザーコントロールをサイトに追加します。</span><span class="sxs-lookup"><span data-stu-id="8f418-505">Add a new Web user control to your site to serve as a search control.</span></span> <span data-ttu-id="8f418-506">**ソースコードを別のファイルに配置する場合**は、このオプションをオフにします。</span><span class="sxs-lookup"><span data-stu-id="8f418-506">Deselect the option to **Place source code in a separate file**.</span></span> <span data-ttu-id="8f418-507">それを WebPartsDemo .aspx ページと同じディレクトリに追加し、「SearchUserControl .ascx」という名前を付けます。</span><span class="sxs-lookup"><span data-stu-id="8f418-507">Add it in the same directory as the WebPartsDemo.aspx page, and name it SearchUserControl.ascx.</span></span>   
  
    > [!NOTE]
    > <span data-ttu-id="8f418-508">このチュートリアルのユーザーコントロールは、実際の検索機能を実装していません。Web パーツの機能を示すためにのみ使用されます。</span><span class="sxs-lookup"><span data-stu-id="8f418-508">The user control for this walkthrough does not implement actual search functionality; it is used only to demonstrate Web Parts features.</span></span>
2. <span data-ttu-id="8f418-509">**デザイン**ビューに切り替えます。</span><span class="sxs-lookup"><span data-stu-id="8f418-509">Switch to **Design** view.</span></span> <span data-ttu-id="8f418-510">ツールボックス の **標準** タブで、テキストボックスコントロールをページにドラッグします。</span><span class="sxs-lookup"><span data-stu-id="8f418-510">From the **Standard** tab of the Toolbox, drag a TextBox control onto the page.</span></span>
3. <span data-ttu-id="8f418-511">追加したテキストボックスの後に挿入ポイントを置き、ENTER キーを押して新しい行を追加します。</span><span class="sxs-lookup"><span data-stu-id="8f418-511">Place the insertion point after the text box you just added, and press ENTER to add a new line.</span></span>
4. <span data-ttu-id="8f418-512">追加したテキストボックスの下の新しい行で、ボタンコントロールをページにドラッグします。</span><span class="sxs-lookup"><span data-stu-id="8f418-512">Drag a Button control onto the page on the new line below the text box you just added.</span></span>
5. <span data-ttu-id="8f418-513">**ソース**ビューに切り替えます。</span><span class="sxs-lookup"><span data-stu-id="8f418-513">Switch to **Source** view.</span></span> <span data-ttu-id="8f418-514">ユーザーコントロールのソースコードが次の例のようになっていることを確認します。</span><span class="sxs-lookup"><span data-stu-id="8f418-514">Ensure that the source code for the user control looks like the following example.</span></span> 

    [!code-aspx[Main](profiles-themes-and-web-parts/samples/sample22.aspx)]
6. <span data-ttu-id="8f418-515">ファイルを保存して閉じます。</span><span class="sxs-lookup"><span data-stu-id="8f418-515">Save and close the file.</span></span>

<span data-ttu-id="8f418-516">これで、Web パーツコントロールをサイドバーゾーンに追加できるようになりました。</span><span class="sxs-lookup"><span data-stu-id="8f418-516">Now you can add Web Parts controls to the Sidebar zone.</span></span> <span data-ttu-id="8f418-517">2つのコントロールをサイドバーゾーンに追加します。1つはリンクのリストを含み、もう1つは前の手順で作成したユーザーコントロールです。</span><span class="sxs-lookup"><span data-stu-id="8f418-517">You are adding two controls to the Sidebar zone, one containing a list of links and another that is the user control you created in the previous procedure.</span></span> <span data-ttu-id="8f418-518">メインゾーンの静的テキストを作成した場合と同様に、リンクは標準の**ラベル**サーバーコントロールとして追加されます。</span><span class="sxs-lookup"><span data-stu-id="8f418-518">The links are added as a standard **Label** server control, similar to the way you created the static text for the Main zone.</span></span> <span data-ttu-id="8f418-519">ただし、ユーザーコントロールに含まれる個々のサーバーコントロールは、(ラベルコントロールのように) ゾーンに直接含めることができますが、この場合はそうではありません。</span><span class="sxs-lookup"><span data-stu-id="8f418-519">However, although the individual server controls contained in the user control could be contained directly in the zone (like the label control), in this case they are not.</span></span> <span data-ttu-id="8f418-520">代わりに、前の手順で作成したユーザーコントロールの一部になります。</span><span class="sxs-lookup"><span data-stu-id="8f418-520">Instead, they are part of the user control you created in the previous procedure.</span></span> <span data-ttu-id="8f418-521">これは、ユーザーコントロールに必要なコントロールや追加機能をパッケージ化し、そのコントロールを Web パーツコントロールとしてゾーンで参照するための一般的な方法を示しています。</span><span class="sxs-lookup"><span data-stu-id="8f418-521">This demonstrates a common way to package whatever controls and extra functionality you want in a user control, and then reference that control in a zone as a Web Parts control.</span></span>

<span data-ttu-id="8f418-522">実行時に Web パーツコントロールセットは、両方のコントロールを GenericWebPart コントロールでラップします。</span><span class="sxs-lookup"><span data-stu-id="8f418-522">At run time, the Web Parts control set wraps both controls with GenericWebPart controls.</span></span> <span data-ttu-id="8f418-523">**GenericWebPart**コントロールが Web サーバーコントロールをラップする場合、ジェネリックパーツコントロールは親コントロールであり、親コントロールの childcontrol プロパティを使用してサーバーコントロールにアクセスできます。</span><span class="sxs-lookup"><span data-stu-id="8f418-523">When a **GenericWebPart** control wraps a Web server control, the generic part control is the parent control, and you can access the server control through the parent control's ChildControl property.</span></span> <span data-ttu-id="8f418-524">このジェネリックパーツコントロールの使用により、標準の Web サーバーコントロールに、 **WebPart**クラスから派生したコントロール Web パーツと同じ基本動作および属性を持たせることができます。</span><span class="sxs-lookup"><span data-stu-id="8f418-524">This use of generic part controls enables standard Web server controls to have the same basic behavior and attributes as Web Parts controls that derive from the **WebPart** class.</span></span>

### <a name="to-add-web-parts-controls-to-the-sidebar-zone"></a><span data-ttu-id="8f418-525">サイドバーゾーンに Web パーツコントロールを追加するには</span><span class="sxs-lookup"><span data-stu-id="8f418-525">To add Web Parts controls to the sidebar zone</span></span>

1. <span data-ttu-id="8f418-526">WebPartsDemo .aspx ページを開きます。</span><span class="sxs-lookup"><span data-stu-id="8f418-526">Open the WebPartsDemo.aspx page.</span></span>
2. <span data-ttu-id="8f418-527">**デザイン**ビューに切り替えます。</span><span class="sxs-lookup"><span data-stu-id="8f418-527">Switch to **Design** view.</span></span>
3. <span data-ttu-id="8f418-528">作成したユーザーコントロールページ (SearchUserControl. .ascx) を**ソリューションエクスプローラー**から、 **ID**プロパティが sidebarzone に設定されているゾーンにドラッグし、そこにドロップします。</span><span class="sxs-lookup"><span data-stu-id="8f418-528">Drag the user control page you created, SearchUserControl.ascx, from **Solution Explorer** into the zone whose **ID** property is set to SidebarZone, and drop it there.</span></span>
4. <span data-ttu-id="8f418-529">WebPartsDemo .aspx ページを保存します。</span><span class="sxs-lookup"><span data-stu-id="8f418-529">Save the WebPartsDemo.aspx page.</span></span>
5. <span data-ttu-id="8f418-530">**ソース**ビューに切り替えます。</span><span class="sxs-lookup"><span data-stu-id="8f418-530">Switch to **Source** view.</span></span>
6. <span data-ttu-id="8f418-531">次の例に示すように、ユーザーコントロールへの参照のすぐ上にある、SidebarZone の &lt;asp: webpartzone&gt; 要素内で、&lt;asp: label&gt; 要素に含まれるリンクを追加します。</span><span class="sxs-lookup"><span data-stu-id="8f418-531">Inside the &lt;asp:webpartzone&gt; element for the SidebarZone, just above the reference to your user control, add an &lt;asp:label&gt; element with contained links, as shown in the following example.</span></span> <span data-ttu-id="8f418-532">また、表示されているように、ユーザーコントロールタグに**Title**属性を追加します。このとき、値は**Search**になります。</span><span class="sxs-lookup"><span data-stu-id="8f418-532">Also, add a **Title** attribute to the user control tag, with a value of **Search**, as shown.</span></span> 

    [!code-aspx[Main](profiles-themes-and-web-parts/samples/sample23.aspx)]
7. <span data-ttu-id="8f418-533">ファイルを保存して閉じます。</span><span class="sxs-lookup"><span data-stu-id="8f418-533">Save and close the file.</span></span>

<span data-ttu-id="8f418-534">ブラウザーでページを参照して、ページをテストできるようになりました。</span><span class="sxs-lookup"><span data-stu-id="8f418-534">Now you can test your page by browsing to it in your browser.</span></span> <span data-ttu-id="8f418-535">このページには、2つのゾーンが表示されます。</span><span class="sxs-lookup"><span data-stu-id="8f418-535">The page displays the two zones.</span></span> <span data-ttu-id="8f418-536">次のスクリーンショットは、このページを示しています。</span><span class="sxs-lookup"><span data-stu-id="8f418-536">The following screen shot shows the page.</span></span>

<span data-ttu-id="8f418-537">**2つのゾーンを含む Web パーツデモページ**</span><span class="sxs-lookup"><span data-stu-id="8f418-537">**Web Parts Demo page with two zones**</span></span>

![Web パーツ VS チュートリアル1のスクリーンショット](profiles-themes-and-web-parts/_static/image3.gif)

<span data-ttu-id="8f418-539">**図 3**: Web パーツ VS チュートリアル1のスクリーンショット</span><span class="sxs-lookup"><span data-stu-id="8f418-539">**Figure 3**: Web Parts VS Walkthrough 1 Screenshot</span></span>

<span data-ttu-id="8f418-540">各コントロールのタイトルバーには、コントロールに対して実行できる操作の動詞メニューへのアクセスを提供する下向きの矢印が表示されます。</span><span class="sxs-lookup"><span data-stu-id="8f418-540">In the title bar of each control is a downward arrow that provides access to a verbs menu of available actions you can perform on a control.</span></span> <span data-ttu-id="8f418-541">コントロールの1つの動詞メニューをクリックし、 **[最小化]** 動詞をクリックして、コントロールが最小化されていることを確認します。</span><span class="sxs-lookup"><span data-stu-id="8f418-541">Click the verbs menu for one of the controls, then click the **Minimize** verb and note that the control is minimized.</span></span> <span data-ttu-id="8f418-542">動詞メニューの **[復元]** をクリックすると、コントロールが通常のサイズに戻ります。</span><span class="sxs-lookup"><span data-stu-id="8f418-542">From the verbs menu, click **Restore**, and the control returns to its normal size.</span></span>

### <a name="enabling-users-to-edit-pages-and-change-layout"></a><span data-ttu-id="8f418-543">ユーザーがページを編集してレイアウトを変更できるようにする</span><span class="sxs-lookup"><span data-stu-id="8f418-543">Enabling Users to Edit Pages and Change Layout</span></span>

<span data-ttu-id="8f418-544">Web パーツには、ユーザーがコントロールを1つのゾーンから別のゾーンにドラッグすることによって、Web パーツコントロールのレイアウトを変更する機能が用意されています。</span><span class="sxs-lookup"><span data-stu-id="8f418-544">Web Parts provides the capability for users to change the layout of Web Parts controls by dragging them from one zone to another.</span></span> <span data-ttu-id="8f418-545">ユーザーが**Web パーツ**コントロールをあるゾーンから別のゾーンに移動できるようにするだけでなく、外観、レイアウト、動作など、コントロールのさまざまな特性をユーザーが編集できるようにすることができます。</span><span class="sxs-lookup"><span data-stu-id="8f418-545">In addition to allowing users to move **WebPart** controls from one zone to another, you can allow users to edit various characteristics of the controls, including their appearance, layout, and behavior.</span></span> <span data-ttu-id="8f418-546">Web パーツコントロールセットは、 **WebPart**コントロールの基本的な編集機能を提供します。</span><span class="sxs-lookup"><span data-stu-id="8f418-546">The Web Parts control set provides basic editing functionality for **WebPart** controls.</span></span> <span data-ttu-id="8f418-547">このチュートリアルではこれを行いませんが、カスタムエディターコントロールを作成して、ユーザーが**WebPart**コントロールの機能を編集できるようにすることもできます。</span><span class="sxs-lookup"><span data-stu-id="8f418-547">Although you will not do so in this walkthrough, you can also create custom editor controls that allow users to edit the features of **WebPart** controls.</span></span> <span data-ttu-id="8f418-548">**WebPart**コントロールの場所を変更する場合と同様に、コントロールのプロパティを編集するには、ユーザーが行った変更を保存するために、ASP.NET のパーソナル化に依存します。</span><span class="sxs-lookup"><span data-stu-id="8f418-548">As with changing the location of a **WebPart** control, editing a control's properties relies on ASP.NET personalization to save the changes that users make.</span></span>

<span data-ttu-id="8f418-549">チュートリアルのこの部分では、ユーザーがページ上の**WebPart**コントロールの基本的な特性を編集する機能を追加します。</span><span class="sxs-lookup"><span data-stu-id="8f418-549">In this part of the walkthrough, you add the ability for users to edit the basic characteristics of any **WebPart** control on the page.</span></span> <span data-ttu-id="8f418-550">これらの機能を有効にするには、&lt;asp: editorzone&gt; 要素と2つの編集コントロールと共に、別のカスタムユーザーコントロールをページに追加します。</span><span class="sxs-lookup"><span data-stu-id="8f418-550">To enable these features, you add another custom user control to the page, along with an &lt;asp:editorzone&gt; element and two editing controls.</span></span>

### <a name="to-create-a-user-control-that-enables-changing-page-layout"></a><span data-ttu-id="8f418-551">ページレイアウトの変更を可能にするユーザーコントロールを作成するには</span><span class="sxs-lookup"><span data-stu-id="8f418-551">To create a user control that enables changing page layout</span></span>

1. <span data-ttu-id="8f418-552">Visual Studio の **[ファイル]** メニューで、 **[新規]** サブメニューを選択し、 **[ファイル]** オプションをクリックします。</span><span class="sxs-lookup"><span data-stu-id="8f418-552">In Visual Studio, on the **File** menu, select the **New** submenu, and click the **File** option.</span></span>
2. <span data-ttu-id="8f418-553">**[新しい項目の追加]** ダイアログで、 **[Web ユーザーコントロール]** を選択します。</span><span class="sxs-lookup"><span data-stu-id="8f418-553">In the **Add New Item** dialog, select **Web User Control**.</span></span> <span data-ttu-id="8f418-554">新しいファイルに DisplayModeMenu .ascx という名前を指定します。</span><span class="sxs-lookup"><span data-stu-id="8f418-554">Name the new file DisplayModeMenu.ascx.</span></span> <span data-ttu-id="8f418-555">**ソースコードを別のファイルに配置**する場合は、このオプションをオフにします。</span><span class="sxs-lookup"><span data-stu-id="8f418-555">Deselect the option to **Place source code in separate file**.</span></span>
3. <span data-ttu-id="8f418-556">[追加] をクリックして、新しいコントロールを作成します。</span><span class="sxs-lookup"><span data-stu-id="8f418-556">Click Add to create the new control.</span></span>
4. <span data-ttu-id="8f418-557">**ソース**ビューに切り替えます。</span><span class="sxs-lookup"><span data-stu-id="8f418-557">Switch to **Source** view.</span></span>
5. <span data-ttu-id="8f418-558">新しいファイルの既存のコードをすべて削除し、次のコードを貼り付けます。</span><span class="sxs-lookup"><span data-stu-id="8f418-558">Remove all the existing code in the new file, and paste in the following code.</span></span> <span data-ttu-id="8f418-559">このユーザーコントロールコードでは、Web パーツコントロールセットの機能を使用して、ページでビューモードまたは表示モードを変更できるようにします。また、特定の表示モードでページの物理的な外観とレイアウトを変更することもできます。</span><span class="sxs-lookup"><span data-stu-id="8f418-559">This user control code uses features of the Web Parts control set that enable a page to change its view or display mode, and also enables you to change the physical appearance and layout of the page while you are in certain display modes.</span></span> 

    [!code-aspx[Main](profiles-themes-and-web-parts/samples/sample24.aspx)]
6. <span data-ttu-id="8f418-560">ツールバーの 保存 アイコンをクリックするか、**ファイル** メニューの **保存** を選択して、ファイルを保存します。</span><span class="sxs-lookup"><span data-stu-id="8f418-560">Save the file by clicking the save icon on the toolbar, or by selecting **Save** on the **File** menu.</span></span>

### <a name="to-enable-users-to-change-the-layout"></a><span data-ttu-id="8f418-561">ユーザーがレイアウトを変更できるようにするには</span><span class="sxs-lookup"><span data-stu-id="8f418-561">To enable users to change the layout</span></span>

1. <span data-ttu-id="8f418-562">WebPartsDemo ページを開き、**デザイン** ビューに切り替えます。</span><span class="sxs-lookup"><span data-stu-id="8f418-562">Open the WebPartsDemo.aspx page, and switch to **Design** view.</span></span>
2. <span data-ttu-id="8f418-563">前の手順で追加した**WebPartManager**コントロールの直後に、**デザイン**ビューに挿入ポイントを配置します。</span><span class="sxs-lookup"><span data-stu-id="8f418-563">Position the insertion point in the **Design** view just after the **WebPartManager** control that you added earlier.</span></span> <span data-ttu-id="8f418-564">**WebPartManager**コントロールの後に空白行が表示されるように、テキストの後にハードリターンを追加します。</span><span class="sxs-lookup"><span data-stu-id="8f418-564">Add a hard return after the text so that there is a blank line after the **WebPartManager** control.</span></span> <span data-ttu-id="8f418-565">空白行に挿入ポイントを配置します。</span><span class="sxs-lookup"><span data-stu-id="8f418-565">Place the insertion point on the blank line.</span></span>
3. <span data-ttu-id="8f418-566">先ほど作成したユーザーコントロール (DisplayModeMenu. .ascx という名前のファイル) を、WebPartsDemo .aspx ページにドラッグし、空白行にドロップします。</span><span class="sxs-lookup"><span data-stu-id="8f418-566">Drag the user control you just created (the file is named DisplayModeMenu.ascx) into the WebPartsDemo.aspx page and drop it on the blank line.</span></span>
4. <span data-ttu-id="8f418-567">ツールボックス の  **Web パーツ** セクションから、EditorZone コントロールを WebPartsDemo ページの その他の開いているテーブル セルにドラッグします。</span><span class="sxs-lookup"><span data-stu-id="8f418-567">Drag an EditorZone control from the **WebParts** section of the Toolbox to the remaining open table cell in the WebPartsDemo.aspx page.</span></span>
5. <span data-ttu-id="8f418-568">ツールボックスの **[Web パーツ]** セクションから、LayoutEditorPart コントロールを**EditorZone**コントロールにドラッグします。</span><span class="sxs-lookup"><span data-stu-id="8f418-568">From the **WebParts** section of the Toolbox, drag an AppearanceEditorPart control and a LayoutEditorPart control into the **EditorZone** control.</span></span>
6. <span data-ttu-id="8f418-569">**ソース**ビューに切り替えます。</span><span class="sxs-lookup"><span data-stu-id="8f418-569">Switch to **Source** view.</span></span> <span data-ttu-id="8f418-570">テーブルセル内の結果のコードは、次のコードのようになります。</span><span class="sxs-lookup"><span data-stu-id="8f418-570">The resulting code in the table cell should look similar to the following code.</span></span> 

    [!code-aspx[Main](profiles-themes-and-web-parts/samples/sample25.aspx)]
7. <span data-ttu-id="8f418-571">WebPartsDemo .aspx ファイルを保存します。</span><span class="sxs-lookup"><span data-stu-id="8f418-571">Save the WebPartsDemo.aspx file.</span></span> <span data-ttu-id="8f418-572">表示モードの変更とページレイアウトの変更を行うことができるユーザーコントロールを作成し、プライマリ Web ページでコントロールを参照しました。</span><span class="sxs-lookup"><span data-stu-id="8f418-572">You have created a user control that allows you to change display modes and change page layout, and you have referenced the control on the primary Web page.</span></span>

<span data-ttu-id="8f418-573">ページを編集してレイアウトを変更する機能をテストできるようになりました。</span><span class="sxs-lookup"><span data-stu-id="8f418-573">You can now test the capability to edit pages and change layout.</span></span>

### <a name="to-test-layout-changes"></a><span data-ttu-id="8f418-574">レイアウトの変更をテストするには</span><span class="sxs-lookup"><span data-stu-id="8f418-574">To test layout changes</span></span>

1. <span data-ttu-id="8f418-575">ブラウザーにページを読み込みます。</span><span class="sxs-lookup"><span data-stu-id="8f418-575">Load the page in a browser.</span></span>
2. <span data-ttu-id="8f418-576">**[表示モード]** ドロップダウンメニューをクリックし、 **[編集]** を選択します。</span><span class="sxs-lookup"><span data-stu-id="8f418-576">Click the **Display Mode** drop-down menu, and select **Edit**.</span></span> <span data-ttu-id="8f418-577">ゾーンタイトルが表示されます。</span><span class="sxs-lookup"><span data-stu-id="8f418-577">The zone titles are displayed.</span></span>
3. <span data-ttu-id="8f418-578">タイトルバーからメインゾーンの下部に**マイリンク**コントロールをドラッグします。</span><span class="sxs-lookup"><span data-stu-id="8f418-578">Drag the **My Links** control by its title bar from the Sidebar zone to the bottom of the Main zone.</span></span> <span data-ttu-id="8f418-579">ページは次のスクリーンショットのようになります。</span><span class="sxs-lookup"><span data-stu-id="8f418-579">Your page should look like the following screen shot.</span></span>

### <a name="web-parts-demo-page-with-my-links-control-moved"></a><span data-ttu-id="8f418-580">マイリンクコントロールを移動した Web パーツデモページ</span><span class="sxs-lookup"><span data-stu-id="8f418-580">Web Parts Demo page with My Links control moved</span></span>

![Web パーツ VS チュートリアル2のスクリーンショット](profiles-themes-and-web-parts/_static/image4.gif)

<span data-ttu-id="8f418-582">**図 4**: Web パーツ VS チュートリアル2のスクリーンショット</span><span class="sxs-lookup"><span data-stu-id="8f418-582">**Figure 4**: Web Parts VS Walkthrough 2 Screenshot</span></span>

1. <span data-ttu-id="8f418-583">**[表示モード]** ドロップダウンメニューをクリックし、 **[参照]** を選択します。</span><span class="sxs-lookup"><span data-stu-id="8f418-583">Click the **Display Mode** drop-down menu, and select **Browse**.</span></span> <span data-ttu-id="8f418-584">ページが更新され、ゾーン名が消え、 **[マイリンク**] コントロールが配置されたままになります。</span><span class="sxs-lookup"><span data-stu-id="8f418-584">The page is refreshed, the zone names disappear, and the **My Links** control remains where you positioned it.</span></span>
2. <span data-ttu-id="8f418-585">個人用設定が機能していることを示すには、ブラウザーを閉じてから、再度ページを読み込みます。</span><span class="sxs-lookup"><span data-stu-id="8f418-585">To demonstrate that personalization is working, close the browser, and then load the page again.</span></span> <span data-ttu-id="8f418-586">行った変更は、今後のブラウザーセッションのために保存されます。</span><span class="sxs-lookup"><span data-stu-id="8f418-586">The changes you made are saved for future browser sessions.</span></span>
3. <span data-ttu-id="8f418-587">**[表示モード]** メニューの **[編集]** をクリックします。</span><span class="sxs-lookup"><span data-stu-id="8f418-587">From the **Display Mode** menu, select **Edit**.</span></span>   
  
   <span data-ttu-id="8f418-588">ページ上の各コントロールは、動詞のドロップダウンメニューを含む、タイトルバーに下向きの矢印付きで表示されるようになりました。</span><span class="sxs-lookup"><span data-stu-id="8f418-588">Each control on the page is now displayed with a downward arrow in its title bar, which contains the verbs drop-down menu.</span></span>
4. <span data-ttu-id="8f418-589">矢印をクリックすると、 **[マイリンク**] コントロールに動詞メニューが表示されます。</span><span class="sxs-lookup"><span data-stu-id="8f418-589">Click the arrow to display the verbs menu on the **My Links** control.</span></span> <span data-ttu-id="8f418-590">**編集**動詞をクリックします。</span><span class="sxs-lookup"><span data-stu-id="8f418-590">Click the **Edit** verb.</span></span>   
  
   <span data-ttu-id="8f418-591">**EditorZone**コントロールが表示され、追加した editorpart コントロールが表示されます。</span><span class="sxs-lookup"><span data-stu-id="8f418-591">The **EditorZone** control appears, displaying the EditorPart controls you added.</span></span>
5. <span data-ttu-id="8f418-592">編集コントロールの **[外観]** セクションで、 **[タイトル]** を お気に入り に変更し、 **[Chrome の種類]** ドロップダウンリストを使用して **[タイトルのみ]** を選択し、 **[適用]** をクリックします。</span><span class="sxs-lookup"><span data-stu-id="8f418-592">In the **Appearance** section of the edit control, change the **Title** to My Favorites, use the **Chrome Type** drop-down list to select **Title Only**, and then click **Apply**.</span></span> <span data-ttu-id="8f418-593">次のスクリーンショットは、編集モードのページを示しています。</span><span class="sxs-lookup"><span data-stu-id="8f418-593">The following screen shot shows the page in edit mode.</span></span>

### <a name="web-parts-demo-page-in-edit-mode"></a><span data-ttu-id="8f418-594">編集モードの Web パーツデモページ</span><span class="sxs-lookup"><span data-stu-id="8f418-594">Web Parts Demo page in Edit mode</span></span>

![Web パーツ VS チュートリアル3スクリーンショット](profiles-themes-and-web-parts/_static/image5.gif)

<span data-ttu-id="8f418-596">**図 5**: Web パーツ VS チュートリアル3のスクリーンショット</span><span class="sxs-lookup"><span data-stu-id="8f418-596">**Figure 5**: Web Parts VS Walkthrough 3 Screenshot</span></span>

1. <span data-ttu-id="8f418-597">**[表示モード]** メニューをクリックし、 **[参照]** を選択してブラウズモードに戻ります。</span><span class="sxs-lookup"><span data-stu-id="8f418-597">Click the **Display Mode** menu, and select **Browse** to return to browse mode.</span></span>
2. <span data-ttu-id="8f418-598">次のスクリーンショットに示すように、コントロールのタイトルが更新され、境界線が表示されなくなりました。</span><span class="sxs-lookup"><span data-stu-id="8f418-598">The control now has an updated title and no border, as shown in the following screen shot.</span></span>

### <a name="edited-web-parts-demo-page"></a><span data-ttu-id="8f418-599">編集 Web パーツデモページ</span><span class="sxs-lookup"><span data-stu-id="8f418-599">Edited Web Parts Demo page</span></span>

![Web パーツ VS チュートリアル4のスクリーンショット](profiles-themes-and-web-parts/_static/image6.gif)

<span data-ttu-id="8f418-601">**図 4**: Web パーツ VS チュートリアル4のスクリーンショット</span><span class="sxs-lookup"><span data-stu-id="8f418-601">**Figure 4**: Web Parts VS Walkthrough 4 Screenshot</span></span>

### <a name="adding-web-parts-at-run-time"></a><span data-ttu-id="8f418-602">実行時の Web パーツの追加</span><span class="sxs-lookup"><span data-stu-id="8f418-602">Adding Web Parts at Run Time</span></span>

<span data-ttu-id="8f418-603">また、ユーザーが実行時に Web パーツコントロールをページに追加できるようにすることもできます。</span><span class="sxs-lookup"><span data-stu-id="8f418-603">You can also allow users to add Web Parts controls to their page at run time.</span></span> <span data-ttu-id="8f418-604">これを行うには、Web パーツカタログを使用してページを構成します。このページには、ユーザーが使用できるようにする Web パーツコントロールの一覧が含まれています。</span><span class="sxs-lookup"><span data-stu-id="8f418-604">To do so, configure the page with a Web Parts catalog, which contains a list of Web Parts controls that you want to make available to users.</span></span>

<span data-ttu-id="8f418-605">**実行時にユーザーが Web パーツを追加できるようにするには**</span><span class="sxs-lookup"><span data-stu-id="8f418-605">**To allow users to add Web Parts at run time**</span></span>

1. <span data-ttu-id="8f418-606">WebPartsDemo ページを開き、**デザイン** ビューに切り替えます。</span><span class="sxs-lookup"><span data-stu-id="8f418-606">Open the WebPartsDemo.aspx page, and switch to **Design** view.</span></span>
2. <span data-ttu-id="8f418-607">ツールボックスの **[Web パーツ]** タブから、CatalogZone コントロールをテーブルの右側の列 ( **EditorZone**コントロールの下) にドラッグします。</span><span class="sxs-lookup"><span data-stu-id="8f418-607">From the **WebParts** tab of the Toolbox, drag a CatalogZone control into the right column of the table, beneath the **EditorZone** control.</span></span>   
  
   <span data-ttu-id="8f418-608">両方のコントロールは、同時に表示されないため、同じテーブルセル内に配置できます。</span><span class="sxs-lookup"><span data-stu-id="8f418-608">Both controls can be in the same table cell because they will not be displayed at the same time.</span></span>
3. <span data-ttu-id="8f418-609">プロパティ ペインで、 **Add Web パーツ**を**CatalogZone**コントロールの HeaderText プロパティに割り当てます。</span><span class="sxs-lookup"><span data-stu-id="8f418-609">In the Properties pane, assign the string **Add Web Parts** to the HeaderText property of the **CatalogZone** control.</span></span>
4. <span data-ttu-id="8f418-610">ツールボックスの **[Web パーツ]** セクションから、DeclarativeCatalogPart コントロールを**CatalogZone**コントロールのコンテンツ領域にドラッグします。</span><span class="sxs-lookup"><span data-stu-id="8f418-610">From the **WebParts** section of the Toolbox, drag a DeclarativeCatalogPart control into the content area of the **CatalogZone** control.</span></span>
5. <span data-ttu-id="8f418-611">**DeclarativeCatalogPart**コントロールの右上隅にある矢印をクリックして タスク メニューを表示し、**テンプレートの編集** を選択します。</span><span class="sxs-lookup"><span data-stu-id="8f418-611">Click the arrow in the upper right corner of the **DeclarativeCatalogPart** control to expose its Tasks menu, and then select **Edit Templates**.</span></span>
6. <span data-ttu-id="8f418-612">ツールボックスの **[標準]** セクションで、 **FileUpload**コントロールと**Calendar**コントロールを**DeclarativeCatalogPart**コントロールの**WebPartsTemplate**セクションにドラッグします。</span><span class="sxs-lookup"><span data-stu-id="8f418-612">From the **Standard** section of the Toolbox, drag a **FileUpload** control and a **Calendar** control into the **WebPartsTemplate** section of the **DeclarativeCatalogPart** control.</span></span>
7. <span data-ttu-id="8f418-613">**ソース**ビューに切り替えます。</span><span class="sxs-lookup"><span data-stu-id="8f418-613">Switch to **Source** view.</span></span> <span data-ttu-id="8f418-614">&lt;asp: catalogzone&gt; 要素のソースコードを調べます。</span><span class="sxs-lookup"><span data-stu-id="8f418-614">Inspect the source code of the &lt;asp:catalogzone&gt; element.</span></span> <span data-ttu-id="8f418-615">**DeclarativeCatalogPart**コントロールには、カタログからページに追加できる2つの囲まれたサーバーコントロールを持つ &lt;webpartstemplate&gt; 要素が含まれていることに注意してください。</span><span class="sxs-lookup"><span data-stu-id="8f418-615">Notice that the **DeclarativeCatalogPart** control contains a &lt;webpartstemplate&gt; element with the two enclosed server controls that you will be able to add to your page from the catalog.</span></span>
8. <span data-ttu-id="8f418-616">次のコード例の各タイトルに対して表示される文字列値を使用して、カタログに追加した各コントロールに**title**プロパティを追加します。</span><span class="sxs-lookup"><span data-stu-id="8f418-616">Add a **Title** property to each of the controls you added to the catalog, using the string value shown for each title in the code example below.</span></span> <span data-ttu-id="8f418-617">タイトルはプロパティではありませんが、通常はデザイン時にこれら2つのサーバーコントロールに設定できますが、ユーザーがこれらのコントロールを実行時にカタログから**WebPartZone**ゾーンに追加すると、 **GenericWebPart**コントロールでラップされます。</span><span class="sxs-lookup"><span data-stu-id="8f418-617">Even though the title is not a property you can normally set on these two server controls at design time, when a user adds these controls to a **WebPartZone** zone from the catalog at run time, they are each wrapped with a **GenericWebPart** control.</span></span> <span data-ttu-id="8f418-618">これにより、Web パーツコントロールとして機能し、タイトルを表示できるようになります。</span><span class="sxs-lookup"><span data-stu-id="8f418-618">This enables them to act as Web Parts controls, so they will be able to display titles.</span></span>   
  
   <span data-ttu-id="8f418-619">**DeclarativeCatalogPart**コントロールに含まれる2つのコントロールのコードは、次のようになります。</span><span class="sxs-lookup"><span data-stu-id="8f418-619">The code for the two controls contained in the **DeclarativeCatalogPart** control should look as follows.</span></span> 

    [!code-aspx[Main](profiles-themes-and-web-parts/samples/sample26.aspx)]
9. <span data-ttu-id="8f418-620">ページを保存します。</span><span class="sxs-lookup"><span data-stu-id="8f418-620">Save the page.</span></span>

<span data-ttu-id="8f418-621">これで、カタログをテストできます。</span><span class="sxs-lookup"><span data-stu-id="8f418-621">You can now test the catalog.</span></span>

### <a name="to-test-the-web-parts-catalog"></a><span data-ttu-id="8f418-622">Web パーツカタログをテストするには</span><span class="sxs-lookup"><span data-stu-id="8f418-622">To test the Web Parts catalog</span></span>

1. <span data-ttu-id="8f418-623">ブラウザーにページを読み込みます。</span><span class="sxs-lookup"><span data-stu-id="8f418-623">Load the page in a browser.</span></span>
2. <span data-ttu-id="8f418-624">**[表示モード]** ドロップダウンメニューをクリックし、 **[カタログ]** を選択します。</span><span class="sxs-lookup"><span data-stu-id="8f418-624">Click the **Display Mode** drop-down menu, and select **Catalog**.</span></span>   
  
   <span data-ttu-id="8f418-625">Web パーツの**追加**というタイトルのカタログが表示されます。</span><span class="sxs-lookup"><span data-stu-id="8f418-625">The catalog titled **Add Web Parts** is displayed.</span></span>
3. <span data-ttu-id="8f418-626">メインゾーンの **[マイお気に入り**] コントロールをサイドバーゾーンの一番上にドラッグし、そこにドロップします。</span><span class="sxs-lookup"><span data-stu-id="8f418-626">Drag the **My Favorites** control from the Main zone back to the top of the Sidebar zone, and drop it there.</span></span>
4. <span data-ttu-id="8f418-627">Web パーツカタログの **[追加]** で、両方のチェックボックスをオンにし、使用可能なゾーンが含まれているドロップダウンリストから **[Main]** を選択します。</span><span class="sxs-lookup"><span data-stu-id="8f418-627">In the **Add Web Parts** catalog, select both check boxes, and then select **Main** from the drop-down list that contains the available zones.</span></span>
5. <span data-ttu-id="8f418-628">カタログの **[追加]** をクリックします。</span><span class="sxs-lookup"><span data-stu-id="8f418-628">Click **Add** in the catalog.</span></span> <span data-ttu-id="8f418-629">コントロールがメインゾーンに追加されます。</span><span class="sxs-lookup"><span data-stu-id="8f418-629">The controls are added to the Main zone.</span></span> <span data-ttu-id="8f418-630">必要に応じて、カタログからページにコントロールの複数のインスタンスを追加できます。</span><span class="sxs-lookup"><span data-stu-id="8f418-630">If you want, you can add multiple instances of controls from the catalog to your page.</span></span>   
  
   <span data-ttu-id="8f418-631">次のスクリーンショットは、ファイルアップロードコントロールがあるページとメインゾーンのカレンダーを示しています。</span><span class="sxs-lookup"><span data-stu-id="8f418-631">The following screen shot shows the page with the file upload control and the calendar in the Main zone.</span></span> 

![カタログからメインゾーンに追加されたコントロール](profiles-themes-and-web-parts/_static/image7.gif)

    **Figure 5**: Controls added to Main zone from the catalog
6. <span data-ttu-id="8f418-633">**[表示モード]** ドロップダウンメニューをクリックし、 **[参照]** を選択します。</span><span class="sxs-lookup"><span data-stu-id="8f418-633">Click the **Display Mode** drop-down menu, and select **Browse**.</span></span> <span data-ttu-id="8f418-634">カタログが表示されなくなり、ページが更新されます。</span><span class="sxs-lookup"><span data-stu-id="8f418-634">The catalog disappears and the page is refreshed.</span></span>
7. <span data-ttu-id="8f418-635">ブラウザーを閉じます。</span><span class="sxs-lookup"><span data-stu-id="8f418-635">Close the browser.</span></span> <span data-ttu-id="8f418-636">ページを再度読み込みます。</span><span class="sxs-lookup"><span data-stu-id="8f418-636">Load the page again.</span></span> <span data-ttu-id="8f418-637">行った変更は保持されます。</span><span class="sxs-lookup"><span data-stu-id="8f418-637">The changes you made persist.</span></span>

---
uid: web-forms/overview/moving-to-aspnet-20/improvements-in-visual-studio-2005
title: Visual Studio 2005 | の機能強化Microsoft Docs
author: microsoft
description: Visual Studio 2005 では、web アプリケーション開発者は、Web プロジェクトの機能強化と機能強化の長い一覧を提供しています。
ms.author: riande
ms.date: 02/20/2005
ms.assetid: 72d90cd0-b3d9-454c-b2eb-ed0d9812f32c
msc.legacyurl: /web-forms/overview/moving-to-aspnet-20/improvements-in-visual-studio-2005
msc.type: authoredcontent
ms.openlocfilehash: 64215d556ded0850537a13856fe69b094116ebca
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 03/06/2020
ms.locfileid: "78464650"
---
# <a name="improvements-in-visual-studio-2005"></a>Visual Studio 2005 の機能強化

[Microsoft](https://github.com/microsoft)

> Visual Studio 2005 では、web アプリケーション開発者は、Web プロジェクトの機能強化と機能強化の長い一覧を提供しています。

Visual Studio 2005 では、web アプリケーション開発者は、Web プロジェクトの機能強化と機能強化の長い一覧を提供しています。 Visual Studio .NET 2002 や2003のように、Web プロジェクトの処理方法には多くの不満がありました。 Visual Studio 2005 では、このような苦情に対処するために、多くの新機能が追加されています。 Visual Studio .NET 2003 で Web アプリケーションのコンパイルを処理する方法を好む方は、「 [Web アプリケーションプロジェクト](https://go.microsoft.com/fwlink/?LinkId=57870)」を参照してください。

このモジュールでは、Web プロジェクトの作成、管理、および開発の機能強化について説明します。 後のモジュールでは、Web プロジェクトのビルドと配置の機能強化についても説明します。

## <a name="frontpage-server-extensions"></a>FrontPage サーバー拡張

Web プロジェクトを作成またはビルドするには、Visual Studio .NET 2002 および2003が必要 FrontPage Server Extensions です。 開発者は、2つの異なるアクセスモード (FrontPage Server Extensions またはファイルアクセスモード) のいずれかを選択でき、IIS でのアプリケーションルートの設定などのタスクを実行するために FrontPage Server Extensions 使用されます。

Visual Studio 2005 では、ローカルプロジェクトの FrontPage Server Extensions への依存が削除されます。 Visual Studio 2005 では、FrontPage Server Extensions を使用する代わりに、IIS メタベースに直接アクセスできるようになりました。 また、Visual Studio 2005 では、リモートプロジェクトへのアクセスを可能にする、FrontPage Server Extensions を必要としない FTP のサポートも追加されています。

プロジェクトで FrontPage Server Extensions を使用する開発者にとって、このオプションは引き続き使用できます。 しかし、ASP.NET 開発者コミュニティからの強いフィードバックに基づいて、必須ではありません。

> [!NOTE]
> FrontPage Server Extensions は、リモートプロジェクトの作成や開くなどにも必要です。

## <a name="aspnet-development-server"></a>ASP.NET 開発サーバー

Visual Studio 2005 には、ASP.NET 開発サーバーという名前の新しい Web サーバーが付属しています。 (この Web サーバーは以前は Cassini と呼ばれていました)。

ASP.NET 開発サーバーにはいくつかの利点があります。

- 管理者以外の管理者が Web サーバーに対して開発およびデバッグを行うことができるようになりました。
- ASP.NET 開発サーバーは、柔軟なプロジェクトの場所を実現するために、仮想ディレクトリをファイルシステム内の任意の場所に動的にマップします。
- 既に IIS を使用している Windows XP Professional のユーザーは、IIS の既定の Web サイトのファイルまたはフォルダー構造に影響を与えない新しい Web アプリケーションを作成できるようになりました。

ASP.NET 開発サーバーを利用するために特別な構成は必要ありません。 ファイルシステムでホストされている Web プロジェクトがデバッグまたは参照されると、Visual Studio 2005 は、要求を処理するために ASP.NET 開発サーバーのインスタンスをランダムポートで自動的に開始します。

詳細については、このモジュールの後の ASP.NET 開発サーバーで説明します。

## <a name="improved-file-management"></a>強化されたファイル管理

Visual Studio 2002 および2003では、Web アプリケーション内のすべてのファイルについて、 C#プロジェクトファイル (VB.NET と .csproj の場合は .vbproj) が格納されています。 ソリューションエクスプローラー表示は、プロジェクトファイルのファイル情報に基づいています。 このため、外部エディターが使用されている場合、ソリューションエクスプローラーによって、誤った情報が表示されることがよくあります。 Visual Studio 2002 および2003では、ファイルの変更が上書きされることや、最新バージョンのファイルが表示されないことがよくあります。

Visual Studio 2005 では、プロジェクトファイルが使用されます。 代わりに、ファイルとフォルダーの情報をディスクから直接読み取ります。これにより、プロジェクト内のファイルが正確に表示されます。 Visual Studio 2002 および2003の References フォルダーは Web アプリケーションの実際のフォルダーを表していないため、Visual Studio 2005 ではソリューションエクスプローラーから References フォルダーも削除されます。 Visual Studio 2005 でプロジェクトの参照にアクセスするには、プロジェクトのプロパティページを使用する必要があります。

## <a name="creating-web-projects"></a>Web プロジェクトの作成

Web 開発者には、Visual Studio 2005 でプロジェクトを作成するための多くの新しいオプションが用意されています。 Web サイトは、ファイルシステム内の任意の場所に作成できるようになりました。その後、新しい ASP.NET 開発サーバーを使用してデバッグまたは参照することができます。 開発者は、FTP を使用して新しい Web サイトを作成することもできます。

Visual Studio 2005 で Web プロジェクトを作成するためのビデオチュートリアルを表示するには、ここをクリックします。

![](improvements-in-visual-studio-2005/_static/image1.png)

[全画面表示のビデオを開く](improvements-in-visual-studio-2005/_static/creating_projects1.wmv)

### <a name="file-system-projects"></a>ファイルシステムプロジェクト

ビデオのチュートリアルで説明したように、ファイルシステム上の Web サイトをローカルコンピューター上に作成するか、ファイル共有を介してリモートの場所に作成するかを選択できます。 ファイルシステム上に作成された Web サイトは、ASP.NET 開発サーバーを使用して参照およびデバッグされます。

> [!NOTE]
> ASP.NET 開発サーバーによって、お客様に混乱を招く可能性があります。 Web プロジェクトが IISs ディレクトリ構造のファイルシステムに作成された場合 (つまり、c:/inetpub/wwwroot)、Visual Studio 2005 内から起動された場合でも、Web サイトは ASP.NET 開発サーバーを通じて参照されます。 そのため、すべての IIS 構成 (つまり認証方法) は適用されません。

既定の web プロジェクトでは、既定の .aspx ページ、default.cs ファイル、およびアプリ/_Data フォルダーのみが含まれるため、大量のオーバーヘッドも解消されます。 Web.config と特別なフォルダー (つまり、app/_code) は必要に応じて追加されます。 Web プロジェクトには、必要なファイルとフォルダーだけが含まれています。

### <a name="http-projects"></a>HTTP プロジェクト

HTTP プロジェクトは、ローカルの IIS Web サイトまたはリモート Web サイトで作成されたプロジェクトのどちらでもかまいません。 既定のプロジェクトの場所は `http://localhost`です。 参照ボタンをクリックした場合、[ローカル IIS] と [リモートサイト] の2つの HTTP オプションがあります。 この2つのオプションの主な違いは、web サイトの情報を [場所の選択] ダイアログボックスに表示する方法と、ファイルを Web サーバーにコピーする方法です。

ローカル IIS オプションは、ローカルコンピューター上のメタベースからサイト情報を読み取ります。ファイルは、ファイルシステムを使用してコピーされます。 リモートサイトオプションは FrontPage Server Extensions を使用し、サイト情報とファイルは HTTP と FrontPage Server Extensions の RPC 呼び出しを使用してコピーされます。

> [!NOTE]
> Vs # # #/_tmp .htm ファイルと get/_aspx/_ver .aspx は、バージョン情報の決定には使用されなくなりました。

既定の HTTP オプションは Local IIS です。 このオプションでは、IIS メタベースを読み取り、利用可能なサイトとコンテンツを作成する場所を特定します。 別のフォルダーまたは仮想ディレクトリを選択するには、ツリービューでそれを選択します。 また、新しい仮想ディレクトリを作成したり、フォルダーをアプリケーションとしてマークしたり、このダイアログボックスから既存の仮想ディレクトリを削除したりすることもできます。

![[場所の選択] ダイアログ](improvements-in-visual-studio-2005/_static/image1.gif)

**図 1**: [場所の選択] ダイアログ

以前のバージョンの Visual Studio とは異なり、[ **Secure Sockets Layer を使用**する] チェックボックスをオンにし、SSL 証明書が参照している URL と一致しない場合は、続行するかどうかを確認するセキュリティ警告ダイアログが表示されます。 Visual Studio .NET 2003 を使用すると、証明書が一致しない場合、プロジェクトの作成は失敗します。

![SSL 証明書に関するセキュリティの警告](improvements-in-visual-studio-2005/_static/image2.gif)

**図 2**: SSL 証明書に関するセキュリティの警告

### <a name="note-on-host-headers"></a>ホストヘッダーに関する注意事項

特定の IP にバインドされたサイトで Web アプリケーションを作成する場合は、ホストヘッダーが構成されていることを確認する必要があります。 そうしないと、Visual Studio によって `http://localhost`にサイトが作成されますが、サイトが IDE 内から参照またはデバッグされている場合、IP アドレスは正しく解決されません。

[リモートサイト] オプションを選択すると、ダイアログボックスが表示され、新しい Web サイトの送信先 URL を入力できるようになります。 この URL は、FrontPage Server Extensions が有効になっているサーバー上にある必要があります。 FrontPage Server Extensions を使用してローカル Web サーバーを操作する場合は、[リモートサイト] オプションを使用してローカル URL を指定します。

![リモートサーバーでの Web サイトの作成](improvements-in-visual-studio-2005/_static/image1.jpg)

**図 3**: リモートサーバーに Web サイトを作成する

SSL を使用してリモートサイトにアプリケーションを作成する場合、SSL 証明書が一致しない場合、確認ダイアログは、ローカル IIS オプションを使用したときに表示されるダイアログと若干異なります。

![リモートサイトのセキュリティアラート](improvements-in-visual-studio-2005/_static/image3.gif)

**図 4**: リモートサイトのセキュリティの警告

<a id="_Toc116100243"></a>

#### <a name="ftp"></a>FTP

Visual Studio 2005 では、FTP 経由で Web サイトを作成するためのオプションが導入されています。 このオプションを使用すると、IDE は users temp フォルダーにローカルでファイルを作成し、FTP を使用してファイルを FTP の場所に移動します。

> [!NOTE]
> Temp フォルダーの場所は、c:/Documents and Settings/&lt;User&gt;/Local Settings/Temp/VWDWebCache/&lt;Server&gt;/_&lt;アプリケーション名&gt;

FTP オプションを使用すると、[場所の選択] ダイアログボックスが表示されます。 次に示すように、必要な FTP 接続情報をこのダイアログボックスに入力します。

![FTP の [場所の選択] ダイアログ](improvements-in-visual-studio-2005/_static/image2.jpg)

**図 5**: FTP の [場所の選択] ダイアログ

## <a name="lab-setup-ftp-site-and-create-a-project"></a>ラボ: FTP サイトのセットアップとプロジェクトの作成

次の手順では、ftp サイトを構成して、ユーザーが FTP 経由でのみアップロードできる場所を持つようにします。

### <a name="install-the-ftp-service"></a>FTP サービスをインストールする

1. [プログラムの追加と削除] を開き、[Windows コンポーネントの追加と削除] を選択します。
2. インターネットインフォメーションサービス (Windows 2003 の場合はアプリケーションサーバー) を選択し、 **[詳細]** をクリックします。
3. **ファイル転送プロトコル (FTP) サービス**を確認し、[ **OK]** をクリックします。
4. **[次へ]** をクリックして、FTP サービスをインストールします。

### <a name="create-a-new-folder-for-content"></a>コンテンツ用の新しいフォルダーを作成する

1. Windows エクスプローラーで、c:/inetpub/wwwroot 内に**User1**という名前の新しいフォルダーを作成します。

#### <a name="configure-folders-and-permissions-on-folders"></a>フォルダーおよびフォルダーに対するアクセス許可を構成します。

1. [管理ツール] からインターネットインフォメーションサービススナップインを開きます。 これで、[コンピューター名] ノードの下に [FTP サイト] フォルダーが作成されます。
2. **[FTP サイト]** を展開します。
3. **既定の FTP サイト**を右クリックし、 **[新規**]、 **[仮想ディレクトリ]** の順に選択し、 **[次へ]** をクリックします。
4. 仮想ディレクトリ名として「 **User1** 」と入力し、 **[次へ]** をクリックします。
5. パスとして **「c:/inetpub/wwwroot/User1** 」と入力し、 **[次へ]** をクリックします。
6. **[次へ]** をクリックし、 **[完了]** をクリックしてウィザードを完了します。
7. [既定の FTP サイト] で**User1**仮想ディレクトリを右クリックし、 **[プロパティ]** を選択します。
8. **[書き込み]** チェックボックスをオンにし、 **[OK]** をクリックしてダイアログを閉じます。
9. 既定の **[FTP サイト]** を右クリックし、 **[プロパティ]** を選択します。
10. **[セキュリティアカウント]** タブで、 **[匿名接続を許可する]** チェックボックスをオフにします。
11. 続行するかどうかを確認するダイアログで **[はい]** をクリックします。
12. **[OK]** をクリックしてダイアログ ボックスを閉じます。
13. **[Web サイト]** ノードの下の **[既定の web サイト]** を展開します。
14. **User1**ディレクトリを右クリックし、 **[プロパティ]** を選択します。
15. **[アプリケーションの設定]** セクションで、 **[作成]** をクリックして、フォルダーをアプリケーションとしてマークします。
16. **[OK]** をクリックしてダイアログ ボックスを閉じます。
17. インターネットインフォメーションサービススナップインを閉じます。

### <a name="create-web-project"></a>Web プロジェクトの作成

1. Visual Studio 2005 を開きます。
2. **[ファイル]** メニューの **[新しい Web サイト]** をクリックします。
3. **[場所]** ドロップダウンで、 **[FTP]** を選択します。
4. **[参照]** をクリックします。
5. **[サーバー]** テキストボックスに「 **localhost** 」と入力します。
6. [ディレクトリ] ボックスに「 **User1** 」と入力します。
7. **[開く]** をクリックします。 FTP の場所は、[新しい Web サイト] ダイアログに入力されます。
8. **[OK]** をクリックします。
9. FTP ログオン ダイアログで **匿名ログオン** チェックボックスをオフにし、資格情報を入力して、**OK** をクリックします。
10. プロジェクトの URL は何ですか? (プロジェクトの URL はソリューションエクスプローラーに表示されます)。
11. **[ビルド]** メニューの **[Web サイトのビルド]** または **[ソリューションのビルド]** をクリックします。
12. ソリューションエクスプローラーで default.aspx を右クリックし、 **[ブラウザーで表示]** を選択します。
13. [Web サイトの URL が必要] ダイアログボックスで、URL として「`http://localhost/user1`」と入力し、[ **OK]** をクリックします。

> [!NOTE]
> 型/_Default を読み込むことができないことを示すエラーが表示された場合は、以前のバージョンではなく、Web サイトで ASP.NET 2.0 を実行していることを確認してください。 これはインターネットインフォメーションサービスの [ASP.NET] タブから行うことができます。

## <a name="opening-web-projects"></a>Web プロジェクトを開く

Web プロジェクトを開くことは、プロジェクトの作成と似ています。 次のセクションでは、IDE 内での作業中に使用する領域について説明します。 また、HTTP および FTP を使用した Web プロジェクトの操作についても説明します。

Web プロジェクトを開くには、[ファイル] メニューの [Web サイトを開く] をクリックします。 前に説明したのと同じ [場所を選択] ダイアログボックスが表示され、ファイルシステム、ローカル IIS、FTP、リモートサイトの4つのオプションを使用できます。

<a id="_Toc116100245"></a>

## <a name="file-system"></a>ファイル システム

このモジュールで既に説明したように、Visual Studio はプロジェクトファイルを使用しなくなりました。 したがって、ファイルシステムから Web サイトを開くことを選択した場合、実際には、選択したフォルダーが Visual Studio で最初に Web プロジェクトとして作成されていない場合でも、必要なフォルダーを選択できます。 たとえば、[マイドキュメント] フォルダーを Web サイトとして開くことを選択すると、次のように Visual Studio によってファイルが開き、ファイルが表示されます。

![Web サイトとして開かれたマイドキュメント](improvements-in-visual-studio-2005/_static/image3.jpg)

**図 6**: Web サイトとして開いている*ドキュメント*

Visual Studio は必要に応じて追加のファイルとフォルダーのみを作成するため、開いている場所に追加のファイルやフォルダーは追加されません。 このアーキテクチャの副作用は、ファイルシステムに Web サイトを入れ子にできないことです。 たとえば、次のディレクトリ構造について考えてみます。

C:/MyWebSite サイトの Web プロジェクト

C:/MyWebSite/Nested の別の web プロジェクト

C:/MyWebSite サイトで Web サイトを開くと、入れ子になったフォルダーがそのアプリケーションのサブフォルダーとして表示されます。

<a id="_Toc116100246"></a>

## <a name="http"></a>HTTP

HTTP 経由で Web サイトを開くと、IIS メタベース (ローカル IIS) または FrontPage Server Extensions (リモートサイト) のいずれかを使用して、設定が読み取られます。入れ子になった web アプリケーションがある場合は、それらをアプリケーションとして識別するアイコンと共に表示されます。 FrontPage での web アプリケーションの操作に慣れている場合は、Visual Studio 2005 の動作も似ています。

現在 IDE 内で開かれているアプリケーションの下に入れ子になっているアプリケーションのアイコンが Visual Studio に表示される場合でも、コンテンツを表示するために拡張することはできません。 ただし、それらをダブルクリックして開くことはできます。 この操作を行うと、web アプリケーションを開く (または現在開いているソリューションを置き換える) か、現在のソリューションに Web アプリケーションを追加するかを確認するダイアログが表示されます。

![入れ子になったアプリケーションアイコンをダブルクリックすると、このダイアログが表示されます。](improvements-in-visual-studio-2005/_static/image4.jpg)

**図 7**: 入れ子になったアプリケーションアイコンをダブルクリックすると、このダイアログが表示される

<a id="_Toc116100247"></a>

## <a name="ftp-site"></a>FTP サイト

FTP 経由でサイトを開くと、ファイルはすべてローカルの temp フォルダーにコピーされます。 ローカルストレージの場所の完全なパスは、プロジェクトの [プロパティ] ウィンドウに表示され、次の形式で作成されます。

C:/Documents and Settings/&lt;User&gt;/Local Settings/Temp/VWDWebCache/&lt;Server&gt;/_&lt;アプリケーション名&gt;

FTP を使用する場合、Visual Studio ではプロジェクトのベース URL を指定する必要があるため、次のように参照できます。 ベース URL を指定しなかった場合は、Web サイト内のページを初めて参照しようとしたときに、そのことを求めるメッセージが Visual Studio によって表示されます。

![FTP サイトのベース URL の指定](improvements-in-visual-studio-2005/_static/image5.jpg)

**図 8**: FTP サイトのベース URL を指定する

## <a name="improvements-in-compilation"></a>コンパイルの機能強化

Visual Studio 2005 で Web アプリケーションを操作すると、以前のバージョンよりもかなり高速に処理できます。 これは、コンパイルアーキテクチャの変更に小さな部分がないためです。

Visual Studio 2002 および2003では、Web アプリケーションは、/bin フォルダーに存在する1つのプライマリアセンブリにコンパイルされました。 Visual Studio 2005 で、アプリ/_Code フォルダーが追加されました。 クラスとその他の UI 以外のコードは、アプリ/_Code フォルダーに追加されます。 Visual Studio によってプロジェクトがビルドされると、アプリ/_Code フォルダー内のすべてのファイルが1つのアプリ/_Code .dll ファイルにコンパイルされます。 この変更の結果、後続のビルドは以前のバージョンよりもはるかに高速になります。

> [!NOTE]
> MSBuild コマンドラインユーティリティを使用して、ASP.NET Web アプリケーションを構築することもできます。 このツールについては、モジュール9で説明します。

もう1つのコンパイル拡張機能は、[ビルド] メニューの [新しいビルドページ] オプションです。 この機能を使用すると、開発者は現在のページのみを (もちろん、依存関係と共に) 再構築できるので、変更をより迅速にコンパイルできます。 でC#は intellisense を更新するためのバックグラウンドコンパイルが提供されないため、この機能を使用すると、単一ページを単に再構築するだけで intellisense をすばやく更新できるため、この機能を非常できます。

プロジェクトのビルドプロパティを使用すると、スタートアップページが実行される前に発生するビルドの種類を構成できます。 開発者は、現在のページのみをビルドして、Visual Studio がコードの変更後により迅速にアプリケーションのデバッグを開始できるようにすることができます。

![ビルドページの開始アクション](improvements-in-visual-studio-2005/_static/image6.jpg)

**図 9**: ビルドページの開始アクション

Visual Studio と ASP.NET アーキテクチャのもう1つの優れた機能強化は、エディットコンティニュの領域にあります。 Visual Studio 2005 では、開発者はプロジェクトのデバッグを開始し、デバッガーをデタッチせずにプロジェクトでコードを変更できます。 実際には、プロジェクトのデバッグを開始し、新しいクラスを追加し、そのクラスにコードを追加し、そのクラスの新しいインスタンスを作成してクラスのメソッドを実行するコードをページに追加します。デバッガーはデタッチされません。 新しいコードを実行すると、ブラウザーを更新するだけで簡単に実行できるようになります。

Visual Studio 2005 のエディットコンティニュ機能のビデオチュートリアルを参照するには、ここをクリックしてください。

![](improvements-in-visual-studio-2005/_static/image2.png)

[全画面表示のビデオを開く](improvements-in-visual-studio-2005/_static/editcontinue1.wmv)

ASP.NET 2.0 と Visual Studio 2005 の堅牢なエディットコンティニュ機能は、ASP.NET アプリケーションのアーキテクチャの変更によるものです。 ASP.NET 1.x では、Visual Studio 2002/2003 で作成されたアプリケーションは、/bin フォルダーに格納されていたプライマリアセンブリにコンパイルされています。 アプリケーションのすべてのクラスやページなどが、その1つの DLL にコンパイルされました。 次に、実行時に、ASP.NET はページ内のすべてのコントロール、マークアップ、および ASP.NET コードをコンパイルし、それらの Dll を ASP.NET 一時フォルダーにコピーします。

ASP.NET 2.0 を使用する Visual Studio 2005 では、上に示した2つのコンパイルモデル (Visual Studio 用と実行時の ASP.NET 用) が1つの共通コンパイルモデルにマージされています。 つまり、コンパイルのすべての問題は、実行時ではなく、開発段階でキャッチされるようになりました。 また、デザイナーと IntelliSense で、ユーザーコントロールやマスターページなどの機能をサポートすることもできます。

ここをクリックして、ユーザーコントロールのデザイナーサポートのビデオチュートリアルを参照してください。

![](improvements-in-visual-studio-2005/_static/image3.png)

[全画面表示のビデオを開く](improvements-in-visual-studio-2005/_static/usercontrols1.wmv)

> [!NOTE]
> ユーザーコントロールがページから削除された場合、@Register ディレクティブはマークアップに残り、ユーザーコントロールが Web サイトから削除された場合にパーサーエラーを回避するために、手動で削除する必要があります。

Visual Studio のコンパイルモデルのもう1つの改良点は、Web サイトの発行機能です。 発行機能によって Web サイトがプリコンパイルされるため、開発者は、必要に応じて何もコンパイルしなくても、パフォーマンスを向上させることができます。 また、ソースコードをデプロイする必要がないように、App/_Code フォルダー内のすべてのソースコードを DLL にプリコンパイルします。

![[Web サイトの発行] ダイアログ](improvements-in-visual-studio-2005/_static/image7.jpg)

**図 10**: [Web サイトの発行] ダイアログ

> [!NOTE]
> Aspnet/_compile ユーティリティを使用して、ASP.NET Web アプリケーションを事前にコンパイルすることもできます。 このツールについては、モジュール9で説明します。

Web サイトを発行すると、次に示すように、プリコンパイルされたファイルが一時 ASP.NET Files フォルダーに格納されます。 ファイル拡張子が*コンパイル*されたファイルは、特定の dll の依存関係を定義する XML ファイルです。 Web フォームまたはユーザーコントロールは、 *App/_Web/_* で始まるランダムな dll にコンパイルされます。

[*このプリコンパイル済みサイトを更新可能に*する] チェックボックスをオンにしたままにした場合、Webforms およびユーザーコントロール内のマークアップは DLL に事前コンパイルされないため、デプロイ後に変更を加えることができます。 展開されたコンテンツの変更が許可されないようにマークアップをロックする場合は、このチェックボックスをオフにします。

[*固定名およびシングルページアセンブリを使用*する] チェックボックスを使用すると、各ページが固定の名前付きアセンブリにコンパイルされるようにバッチコンパイルを無効にすることができます。 このチェックボックスをオフのままにすると、バッチコンパイルを利用できます。

[*プリコンパイル済みアセンブリで厳密な*名前を付ける] チェックボックスを使用すると、プリコンパイル済みアセンブリに厳密な名前を付けることができます。

> [!NOTE]
> ASP.NET 1.x では、厳密な名前付きのアセンブリをグローバルアセンブリキャッシュ (GAC) にインストールする必要がありました。 ASP.NET 2.0 では、厳密な名前付きアセンブリを GAC にインストールする必要はありません。

![ASP.NET アプリケーションのプリコンパイル済みファイル](improvements-in-visual-studio-2005/_static/image8.jpg)

**図 11**: ASP.NET アプリケーションのプリコンパイル済みファイル

> [!NOTE]
> 上記のアプリケーションでは、web.config ファイルがありませんでした。 既に存在していた場合は、Web サイトの発行プロセスの後に*PrecompiledApp*という名前が付いています。

## <a name="improvements-in-deployment"></a>展開の機能強化

Visual Studio 2002 および2003と同様に、Visual Studio 2005 にはプロジェクトのコピー機能が用意されています。 ただし、この機能は Visual Studio 2005 で強化されており、現在は "Web サイトのコピー" と呼ばれています。

[Web サイトのコピー] ダイアログは、左フレームと右フレームに分割されます。 左フレームはソース Web サイトと呼ばれ、右フレームはリモート Web サイトと呼ばれます。 開発者によっては、右側のフレームに表示されるサイトが必ずしもリモートサイトであるとは限らないということがあります。 ローカルファイルシステムまたは IIS のローカルインスタンスのサイトの場合もあります。 また、ダイアログボックスを使用すると、リモート Web サイトからソース Web サイト*に*発行することができるため、左側のフレームに表示されるサイトは必ずしもソース web サイトであるとは限りません。

プロジェクトをリモート Web サイトにコピーする場合は、そのサイトに FrontPage Server Extensions がインストールされている必要があります。 そうでない場合は、FTP を使用して接続する必要があります。 一方、ローカルの IIS インスタンスにプロジェクトをコピーする場合、FrontPage Server Extensions は必要ありません。

> [!NOTE]
> ローカル IIS インスタンスに新しい Web サイトを作成しようとしたときに、FrontPage 2002 サーバー拡張機能がインストールされている場合は、SharePoint サーバーで Web サイトの作成がサポートされていないことを示すエラーメッセージが表示されます。 この場合、FrontPage 2000 のサーバー拡張機能をインストールするか、FrontPage Server Extensions を削除するかを選択できます。

Web サイトのコピー機能のビデオチュートリアルについては、こちらをクリックしてください。

![](improvements-in-visual-studio-2005/_static/image4.png)

[全画面表示のビデオを開く](improvements-in-visual-studio-2005/_static/copysite1.wmv)

## <a name="improvements-in-debugging"></a>デバッグの機能強化

Visual Studio 2005 でのデバッグでは、主に4つの機能強化が行われています。

- 管理者以外のローカルでのデバッグは、すぐに使用できます。
- 既定では、コンパイル要素の Debug 属性は false になりました。
- リモートデバッグのセットアップと構成は、以前よりも簡単です。
- FTP の場所を介して開いている Web サイトをデバッグできるようになりました。

## <a name="debugging-as-a-non-administrator"></a>非管理者としてのデバッグ

ASP.NET 開発サーバーの追加により、管理者以外の管理者はすぐに ASP.NET アプリケーションを簡単にデバッグできます。 ローカルファイルシステムで実行されている ASP.NET アプリケーションがデバッグされると、Visual Studio は、ログオンしているユーザーのコンテキストで ASP.NET 開発サーバーを起動します。 そのユーザーは、追加の構成なしでそのアプリケーションをデバッグできます。

## <a name="debug-is-false-by-default"></a>既定ではデバッグは False です

ASP.NET 1.x では、web.config ファイルの*コンパイル*要素の*debug*属性が既定で*true*に設定されていました。 アプリケーションを実稼働環境に配置する前に、開発者がこの属性を*false*に設定することを常に推奨していましたが、ほとんどの開発者はデバッグ属性を true に設定したままにした場合の結果を十分に理解していないので、単純にそのままにしておきます。

Debug 属性が true に設定されている場合の最も重大な問題は、ASP.NET コンパイルモデルを無効にすることです。 したがって、各ページは個別の DLL にコンパイルされます。 Web アプリケーションが数千のページで構成されている場合 (どのような方法でも前例ではありません)、そのアプリケーションによって数千の小さな Dll が作成されます。 これらの Dll はサイズが小さいのに対して、メモリ内の特定の場所に読み込まれません。 そのため、システムメモリの断片化が発生し、OutOfMemoryException オカレンスに寄与する可能性があります。

ASP.NET 2.0 では、debug 属性は既定で false に設定されています。 既に説明したように、開発者が Visual Studio 2005 で ASP.NET アプリケーションをデバッグすると、デバッグが有効になっている web.config ファイルを追加するように求められます。 これを行うと、ASP.NET 1.x に存在するのと同じ欠点が発生しますが、開発者は、アプリケーションを運用環境に移行する前に、属性を false にリセットする必要があるという警告が表示されるようになりました。

## <a name="remote-debugging-setup-and-configuration"></a>リモートデバッグのセットアップと構成

Visual Studio 2002/2003 では、リモートデバッグはコンピューターデバッグマネージャー (mdm.exe) と vs7jit プロセスに依存していました。 このため、リモートデバッグの問題のトラブルシューティングは、多くの場合、お客様のためのブラックボックスであり、PSS にとってはあまり良くありませんでした。

Visual Studio 2005 では、mdm.exe プロセスと vs7jit プロセスに依存することがなくなります。 代わりに、リモートデバッグモニターサービス (msvsmon) を使用するようになりました。

Visual Studio 2005 でのリモートデバッグの要件は非常に単純です。 デバッグする前に、リモートサーバーで msvsmon を実行する必要があります。 リモートデバッグモニターは、Visual Studio CD からインストールできます。または、Web サーバーに何もインストールせずに、共有から msvsmon を実行するだけでかまいません。

Msvsmon を実行すると、リモートデバッグのためにブロックされているポートについての通知が表示される可能性が高くなります。 幸いにも、次に示すように、警告ダイアログボックスでポートのブロックを簡単に解除できます。

![Windows ファイアウォールがリモートデバッグをブロックしていることを示す通知](improvements-in-visual-studio-2005/_static/image9.jpg)

**図 12**: Windows ファイアウォールがリモートデバッグをブロックしていることを示す通知

デバッグに必要なポートのブロックを解除すると、次に示すようにリモートデバッグモニターが表示されます。 このインターフェイスから、接続を監視し、デバッグのアクセス許可を簡単に変更できます。

![リモートデバッグモニター](improvements-in-visual-studio-2005/_static/image10.jpg)

**図 13**: リモートデバッグモニター

FTP 経由で開かれた Web アプリケーションをリモートでデバッグすることもできます。 手順は、前に説明した手順と同じです。 ただし、このモジュールで既に説明したように、FTP プロジェクトを参照するためのベース URL を指定する必要があります。

## <a name="lab-2"></a>ラボ2

## <a name="remote-debugging-with-visual-studio-2005"></a>Visual Studio 2005 を使用したリモートデバッグ

このラボでは、Visual Studio 2005 を使用したリモートデバッグについて説明します。

このラボのビデオチュートリアルについては、ここをクリックしてください。

![](improvements-in-visual-studio-2005/_static/image5.png)

[全画面表示のビデオを開く](improvements-in-visual-studio-2005/_static/remdebug1.wmv)

このラボでは2台のコンピューターが必要です。1つは Visual Studio 2005 を実行し、もう1つは IIS 5 以上を実行します。

1. Visual Studio 2005 を開き、リモートサーバー上に新しい Web サイトを作成します。

> [!NOTE]
> Web サイトは、リモートの IIS インスタンスまたは FTP を使用して作成できます。

1. リモート Web サーバーから、開発用コンピューターで、UNC パスを使用して msvsmon を見つけて実行します。  
 Msvsmon の既定の場所は、server/c $/Program Files/Microsoft Visual Studio 8/Common7/IDE/リモートデバッガー/x86 です。
2. リモートデバッグ用にポートのブロックを解除するよう求められた場合は、それを実行します。
3. 開発用コンピューターから default.aspx の分離コードを開き、ページ/_Load メソッドにブレークポイントを設定します。
4. 開発用コンピューターからデバッグを開始します。

ブレークポイントを予想どおりにヒットさせる必要があります。

## <a name="aspnet-development-server"></a>ASP.NET 開発サーバー

既に説明したように、Visual Studio 2005 には ASP.NET 開発サーバーという名前の Web サーバーが付属しています。 (ASP.NET 開発サーバーは、Cassini と呼ばれることもあります)。この Web サーバーは、ファイルシステムで実行されている Web アプリケーションを参照およびデバッグするための便利な手段です。

ASP.NET 開発サーバーは制限された Web サーバーです。 リモート接続は許可されません。 Web サーバーを起動したユーザー以外のユーザーからの要求は許可されません。 また、ASP ページにサービスを提供する機能はありません。 ASP.NET のリソースと HTML リソース (画像、CSS ファイルなどを含む) のみが提供されます。

ASP.NET 開発サーバーは、c:/Windows/Microsoft .NET/Framework/v2.0./ */* / */* /* にある webdev. WebServer ファイルを実行することで、コマンドラインから起動できます。 次のダイアログには、使用可能なパラメーターが表示されます。

![](improvements-in-visual-studio-2005/_static/image11.jpg)

**図14**

> [!NOTE]
> ASP.NET 開発サーバーは、コマンドラインを使用して明示的に起動した場合はサポートされません。

---
uid: web-forms/overview/older-versions-security/introduction/an-overview-of-forms-authentication-cs
title: フォーム認証の概要 (C#) |Microsoft Docs
author: rick-anderson
description: カスタムルートの作成
ms.author: riande
ms.date: 01/14/2008
ms.assetid: de2d65b9-aadc-42ba-abe1-4e87e66521a0
msc.legacyurl: /web-forms/overview/older-versions-security/introduction/an-overview-of-forms-authentication-cs
msc.type: authoredcontent
ms.openlocfilehash: 009c3f84e00d648ede4a15e530ceac2d23e01eec
ms.sourcegitcommit: 22fbd8863672c4ad6693b8388ad5c8e753fb41a2
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 11/28/2019
ms.locfileid: "74620749"
---
# <a name="an-overview-of-forms-authentication-c"></a><span data-ttu-id="1c4c0-103">フォーム認証の概要 (C#)</span><span class="sxs-lookup"><span data-stu-id="1c4c0-103">An Overview of Forms Authentication (C#)</span></span>

<span data-ttu-id="1c4c0-104">[Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="1c4c0-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="1c4c0-105">[コードのダウンロード](https://download.microsoft.com/download/2/F/7/2F705A34-F9DE-4112-BBDE-60098089645E/ASPNET_Security_Tutorial_02_CS.zip)または[PDF のダウンロード](https://download.microsoft.com/download/2/F/7/2F705A34-F9DE-4112-BBDE-60098089645E/aspnet_tutorial02_FormsAuth_cs.pdf)</span><span class="sxs-lookup"><span data-stu-id="1c4c0-105">[Download Code](https://download.microsoft.com/download/2/F/7/2F705A34-F9DE-4112-BBDE-60098089645E/ASPNET_Security_Tutorial_02_CS.zip) or [Download PDF](https://download.microsoft.com/download/2/F/7/2F705A34-F9DE-4112-BBDE-60098089645E/aspnet_tutorial02_FormsAuth_cs.pdf)</span></span>

> <span data-ttu-id="1c4c0-106">このチュートリアルでは、単なるディスカッションから実装について説明します。特に、フォーム認証の実装について説明します。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-106">In this tutorial we will turn from mere discussion to implementation; in particular, we will look at implementing forms authentication.</span></span> <span data-ttu-id="1c4c0-107">このチュートリアルで作成する web アプリケーションは、単純なフォーム認証からメンバーシップとロールに移行するときに、以降のチュートリアルでも引き続きビルドされます。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-107">The web application we start constructing in this tutorial will continue to be built upon in subsequent tutorials, as we move from simple forms authentication to membership and roles.</span></span>
> 
> <span data-ttu-id="1c4c0-108">このトピックの詳細については、「 [ASP.NET での基本フォーム認証の使用](../../../videos/authentication/using-basic-forms-authentication-in-aspnet.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-108">Please see this video for more information on this topic: [Using Basic Forms Authentication in ASP.NET](../../../videos/authentication/using-basic-forms-authentication-in-aspnet.md).</span></span>

## <a name="introduction"></a><span data-ttu-id="1c4c0-109">はじめに</span><span class="sxs-lookup"><span data-stu-id="1c4c0-109">Introduction</span></span>

<span data-ttu-id="1c4c0-110">前の[チュートリアル](security-basics-and-asp-net-support-cs.md)では、ASP.NET によって提供されるさまざまな認証、承認、ユーザーアカウントのオプションについて説明しました。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-110">In the [preceding tutorial](security-basics-and-asp-net-support-cs.md) we discussed the various authentication, authorization, and user account options provided by ASP.NET.</span></span> <span data-ttu-id="1c4c0-111">このチュートリアルでは、単なるディスカッションから実装について説明します。特に、フォーム認証の実装について説明します。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-111">In this tutorial we will turn from mere discussion to implementation; in particular, we will look at implementing forms authentication.</span></span> <span data-ttu-id="1c4c0-112">このチュートリアルで作成する web アプリケーションは、単純なフォーム認証からメンバーシップとロールに移行するときに、以降のチュートリアルでも引き続きビルドされます。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-112">The web application we start constructing in this tutorial will continue to be built upon in subsequent tutorials, as we move from simple forms authentication to membership and roles.</span></span>

<span data-ttu-id="1c4c0-113">このチュートリアルでは、まず、フォーム認証ワークフロー (前のチュートリアルで触れたトピック) について詳しく説明します。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-113">This tutorial begins with an in-depth look at the forms authentication workflow, a topic we touched upon in the previous tutorial.</span></span> <span data-ttu-id="1c4c0-114">次に、フォーム認証の概念をデモするための ASP.NET web サイトを作成します。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-114">Following that, we will create an ASP.NET website through which to demo the concepts of forms authentication.</span></span> <span data-ttu-id="1c4c0-115">次に、フォーム認証を使用するようにサイトを構成し、単純なログインページを作成します。また、ユーザーが認証されているかどうかをコードで確認する方法、およびユーザーがログインしたユーザー名を確認する方法についても説明します。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-115">Next, we will configure the site to use forms authentication, create a simple login page, and see how to determine, in code, whether a user is authenticated and, if so, the username they logged in with.</span></span>

<span data-ttu-id="1c4c0-116">フォーム認証ワークフローについて理解し、web アプリケーションで有効にし、ログインページとログオフページを作成することは、ユーザーアカウントをサポートし、web ページを介してユーザーを認証する ASP.NET アプリケーションを構築するためのすべての重要な手順です。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-116">Understanding the forms authentication workflow, enabling it in a web application, and creating the login and logoff pages are all vital steps in building an ASP.NET application that supports user accounts and authenticates users through a web page.</span></span> <span data-ttu-id="1c4c0-117">このため、これらのチュートリアルは相互に構築されるため、以前のプロジェクトでフォーム認証を構成している経験がある場合でも、次のチュートリアルに進む前に、このチュートリアルを完全に実行することをお勧めします。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-117">Because of this – and because these tutorials build upon one another - I would encourage you to work through this tutorial in full before moving on to the next one even if you already have had experience configuring forms authentication in past projects.</span></span>

## <a name="understanding-the-forms-authentication-workflow"></a><span data-ttu-id="1c4c0-118">フォーム認証ワークフローについて</span><span class="sxs-lookup"><span data-stu-id="1c4c0-118">Understanding the Forms Authentication Workflow</span></span>

<span data-ttu-id="1c4c0-119">ASP.NET ランタイムが ASP.NET page や ASP.NET Web service などの ASP.NET リソースの要求を処理すると、その要求によって、そのライフサイクル中に多数のイベントが発生します。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-119">When the ASP.NET runtime processes a request for an ASP.NET resource, such as an ASP.NET page or ASP.NET Web service, the request raises a number of events during its lifecycle.</span></span> <span data-ttu-id="1c4c0-120">要求の最初と最後にイベントが発生し、要求が認証され、承認されたときに発生したイベント、未処理の例外が発生した場合に発生するイベントなどがあります。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-120">There are events raised at the very beginning and very end of the request, ones raised when the request is being authenticated and authorized, an event raised in the case of an unhandled exception, and so forth.</span></span> <span data-ttu-id="1c4c0-121">イベントの完全な一覧を表示するには、 [HttpApplication オブジェクトのイベント](https://msdn.microsoft.com/library/system.web.httpapplication_events.aspx)を参照してください。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-121">To see a complete listing of the events, refer to the [HttpApplication object's events](https://msdn.microsoft.com/library/system.web.httpapplication_events.aspx).</span></span>

<span data-ttu-id="1c4c0-122">*HTTP モジュール*は、要求ライフサイクル内の特定のイベントに応答して実行されるコードを持つマネージクラスです。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-122">*HTTP Modules* are managed classes whose code is executed in response to a particular event in the request lifecycle.</span></span> <span data-ttu-id="1c4c0-123">ASP.NET には、バックグラウンドで重要なタスクを実行する多数の HTTP モジュールが付属しています。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-123">ASP.NET ships with a number of HTTP Modules that perform essential tasks behind the scenes.</span></span> <span data-ttu-id="1c4c0-124">ここで説明するために特に関連する2つの組み込み HTTP モジュールは、次のとおりです。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-124">Two built-in HTTP Modules that are especially relevant to our discussion are:</span></span>

- <span data-ttu-id="1c4c0-125">**[`FormsAuthenticationModule`](https://msdn.microsoft.com/library/system.web.security.formsauthenticationmodule.aspx)** –フォーム認証チケットを調べることによってユーザーを認証します。これは通常、ユーザーの cookies コレクションに含まれています。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-125">**[`FormsAuthenticationModule`](https://msdn.microsoft.com/library/system.web.security.formsauthenticationmodule.aspx)** – authenticates the user by inspecting the forms authentication ticket, which is typically included in the user's cookies collection.</span></span> <span data-ttu-id="1c4c0-126">フォーム認証チケットが存在しない場合、ユーザーは匿名です。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-126">If no forms authentication ticket is present, the user is anonymous.</span></span>
- <span data-ttu-id="1c4c0-127">**[`UrlAuthorizationModule`](https://msdn.microsoft.com/library/system.web.security.urlauthorizationmodule.aspx)** –現在のユーザーが要求された URL へのアクセスを承認されているかどうかを判断します。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-127">**[`UrlAuthorizationModule`](https://msdn.microsoft.com/library/system.web.security.urlauthorizationmodule.aspx)** – determines whether or not the current user is authorized to access the requested URL.</span></span> <span data-ttu-id="1c4c0-128">このモジュールは、アプリケーションの構成ファイルで指定されている承認規則を確認することによって、権限を決定します。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-128">This module determines the authority by consulting the authorization rules specified in the application's configuration files.</span></span> <span data-ttu-id="1c4c0-129">また、ASP.NET には、要求されたファイルの Acl をコンサルティングして機関を決定する[`FileAuthorizationModule`](https://msdn.microsoft.com/library/system.web.security.fileauthorizationmodule.aspx)も含まれています。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-129">ASP.NET also includes the [`FileAuthorizationModule`](https://msdn.microsoft.com/library/system.web.security.fileauthorizationmodule.aspx) that determines authority by consulting the requested file(s) ACLs.</span></span>

<span data-ttu-id="1c4c0-130">`FormsAuthenticationModule` は、`UrlAuthorizationModule` (および `FileAuthorizationModule`) を実行する前にユーザーの認証を試みます。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-130">The `FormsAuthenticationModule` attempts to authenticate the user prior to the `UrlAuthorizationModule` (and `FileAuthorizationModule`) executing.</span></span> <span data-ttu-id="1c4c0-131">要求を行っているユーザーが要求されたリソースへのアクセスを承認されていない場合、承認モジュールは要求を終了し、 [HTTP 401 の許可](http://www.checkupdown.com/status/E401.html)されていない状態を返します。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-131">If the user making the request is not authorized to access the requested resource, the authorization module terminates the request and returns an [HTTP 401 Unauthorized](http://www.checkupdown.com/status/E401.html) status.</span></span> <span data-ttu-id="1c4c0-132">Windows 認証シナリオでは、HTTP 401 状態がブラウザーに返されます。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-132">In Windows authentication scenarios, the HTTP 401 status is returned to the browser.</span></span> <span data-ttu-id="1c4c0-133">この状態コードにより、ブラウザーはモーダルダイアログボックスを使用して資格情報の入力を求めます。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-133">This status code causes the browser to prompt the user for their credentials via a modal dialog box.</span></span> <span data-ttu-id="1c4c0-134">ただし、フォーム認証では、HTTP 401 の未承認ステータスがブラウザーに送信されることはありません。これは、FormsAuthenticationModule がこの状態を検出し、代わりに、( [http 302 リダイレクト](http://www.checkupdown.com/status/E302.html)ステータスを使用して) ユーザーをログインページにリダイレクトするように変更するためです。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-134">With forms authentication, however, the HTTP 401 Unauthorized status is never sent to the browser because the FormsAuthenticationModule detects this status and modifies it to redirect the user to the login page instead (via an [HTTP 302 Redirect](http://www.checkupdown.com/status/E302.html) status).</span></span>

<span data-ttu-id="1c4c0-135">ログインページの役割は、ユーザーの資格情報が有効であるかどうかを判断し、その場合はフォーム認証チケットを作成して、アクセスしようとしていたページにユーザーをリダイレクトすることです。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-135">The login page's responsibility is to determine if the user's credentials are valid and, if so, to create a forms authentication ticket and redirect the user back to the page they were attempting to visit.</span></span> <span data-ttu-id="1c4c0-136">認証チケットは、web サイトのページへの後続の要求に含まれており、`FormsAuthenticationModule` がユーザーを識別するために使用します。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-136">The authentication ticket is included in subsequent requests to the pages on the website, which the `FormsAuthenticationModule` uses to identify the user.</span></span>

![フォーム認証ワークフロー](an-overview-of-forms-authentication-cs/_static/image1.png)

<span data-ttu-id="1c4c0-138">**図 1**: フォーム認証ワークフロー</span><span class="sxs-lookup"><span data-stu-id="1c4c0-138">**Figure 1**: The Forms Authentication Workflow</span></span>

### <a name="remembering-the-authentication-ticket-across-page-visits"></a><span data-ttu-id="1c4c0-139">ページアクセス全体で認証チケットを記憶する</span><span class="sxs-lookup"><span data-stu-id="1c4c0-139">Remembering the Authentication Ticket Across Page Visits</span></span>

<span data-ttu-id="1c4c0-140">ログイン後、各要求でフォーム認証チケットを web サーバーに送り返す必要があります。これにより、ユーザーはサイトを参照するときにログインしたままになります。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-140">After logging in, the forms authentication ticket must be sent back to the web server on each request so that the user remains logged in as they browse the site.</span></span> <span data-ttu-id="1c4c0-141">通常、これはユーザーの cookies コレクションに認証チケットを配置することで実現されます。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-141">This is typically accomplished by placing the authentication ticket in the user's cookies collection.</span></span> <span data-ttu-id="1c4c0-142">[Cookie](http://en.wikipedia.org/wiki/HTTP_cookie)は、ユーザーのコンピューター上に存在し、cookie を作成した web サイトへの各要求の HTTP ヘッダーで送信される小さなテキストファイルです。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-142">[Cookies](http://en.wikipedia.org/wiki/HTTP_cookie) are small text files that reside on the user's computer and are transmitted in the HTTP headers on each request to the website that created the cookie.</span></span> <span data-ttu-id="1c4c0-143">したがって、フォーム認証チケットが作成され、ブラウザーの cookie に格納されると、そのサイトにアクセスするたびに、要求と共に認証チケットが送信され、それによってユーザーが識別されます。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-143">Therefore, once the forms authentication ticket has been created and stored in the browser's cookies, each subsequent visit to that site sends the authentication ticket along with the request, thereby identifying the user.</span></span>

<span data-ttu-id="1c4c0-144">Cookie の1つの側面は、ブラウザーが cookie を破棄する日付と時刻である、有効期限です。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-144">One aspect of cookies is their expiration, which is the date and time at which the browser discards the cookie.</span></span> <span data-ttu-id="1c4c0-145">フォーム認証クッキーの有効期限が切れると、ユーザーは認証されなくなり、匿名になります。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-145">When the forms authentication cookie expires, the user can no longer be authenticated and therefore become anonymous.</span></span> <span data-ttu-id="1c4c0-146">ユーザーが公共のターミナルからアクセスしているときは、ブラウザーを閉じるときに認証チケットが期限切れになる可能性があります。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-146">When a user is visiting from a public terminal, chances are they want their authentication ticket to expire when they close their browser.</span></span> <span data-ttu-id="1c4c0-147">ただし、自宅からアクセスする場合、同じユーザーは、サイトにアクセスするたびに再ログインする必要がないように、ブラウザーの再起動を通じて認証チケットを記憶する必要があります。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-147">When visiting from home, however, that same user might want the authentication ticket to be remembered across browser restarts so that they do not have to re-log in each time they visit the site.</span></span> <span data-ttu-id="1c4c0-148">この決定は、多くの場合、ログインページの [記憶] チェックボックスの形式でユーザーによって行われます。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-148">This decision is often made by the user in the form of a "Remember me" checkbox on the login page.</span></span> <span data-ttu-id="1c4c0-149">手順3では、ログインページで [アカウントを記憶する] チェックボックスを実装する方法を確認します。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-149">In Step 3 we will examine how to implement a "Remember me" checkbox in the login page.</span></span> <span data-ttu-id="1c4c0-150">次のチュートリアルでは、認証チケットのタイムアウト設定について詳しく説明します。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-150">The following tutorial addresses the authentication ticket timeout settings in detail.</span></span>

> [!NOTE]
> <span data-ttu-id="1c4c0-151">Web サイトへのログオンに使用したユーザーエージェントが cookie をサポートしていない可能性があります。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-151">It is possible that the user agent used to log on to the website may not support cookies.</span></span> <span data-ttu-id="1c4c0-152">このような場合、ASP.NET では、cookie なしのフォーム認証チケットを使用できます。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-152">In such a case, ASP.NET can use cookieless forms authentication tickets.</span></span> <span data-ttu-id="1c4c0-153">このモードでは、認証チケットは URL にエンコードされます。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-153">In this mode, the authentication ticket is encoded into the URL.</span></span> <span data-ttu-id="1c4c0-154">ここでは、クッキーレス認証チケットが使用される場合と、次のチュートリアルで作成および管理される方法について説明します。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-154">We will look at when cookieless authentication tickets are used and how they are created and managed in the next tutorial.</span></span>

### <a name="the-scope-of-forms-authentication"></a><span data-ttu-id="1c4c0-155">フォーム認証のスコープ</span><span class="sxs-lookup"><span data-stu-id="1c4c0-155">The Scope of Forms Authentication</span></span>

<span data-ttu-id="1c4c0-156">`FormsAuthenticationModule` は、ASP.NET ランタイムの一部であるマネージコードです。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-156">The `FormsAuthenticationModule` is managed code that is part of the ASP.NET runtime.</span></span> <span data-ttu-id="1c4c0-157">Microsoft の[インターネットインフォメーションサービス (iis)](https://www.iis.net/) web サーバーのバージョン7より前では、IIS の HTTP パイプラインと ASP.NET ランタイムのパイプラインの間には個別のバリアがありました。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-157">Prior to version 7 of Microsoft's [Internet Information Services (IIS)](https://www.iis.net/) web server, there was a distinct barrier between IIS's HTTP pipeline and the ASP.NET runtime's pipeline.</span></span> <span data-ttu-id="1c4c0-158">つまり、IIS 6 以前では、`FormsAuthenticationModule` は、IIS から ASP.NET ランタイムに要求が委任されたときにのみ実行されます。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-158">In short, in IIS 6 and earlier, the `FormsAuthenticationModule` only executes when a request is delegated from IIS to the ASP.NET runtime.</span></span> <span data-ttu-id="1c4c0-159">既定では、IIS は静的なコンテンツ自体 (HTML ページ、CSS、イメージファイルなど) を処理します。また、.aspx、.asmx、または .ashx の拡張子を持つページが要求された場合にのみ、ASP.NET ランタイムに要求を渡します。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-159">By default, IIS processes static content itself – like HTML pages and CSS and image files – and only hands off requests to the ASP.NET runtime when a page with an extension of .aspx, .asmx, or .ashx is requested.</span></span>

<span data-ttu-id="1c4c0-160">ただし、IIS 7 では、IIS と ASP.NET の統合パイプラインを使用できます。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-160">IIS 7, however, allows for integrated IIS and ASP.NET pipelines.</span></span> <span data-ttu-id="1c4c0-161">いくつかの構成設定を使用して、IIS 7 をセットアップして、*すべて*の要求に対して FormsAuthenticationModule を呼び出すことができます。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-161">With a few configuration settings you can setup IIS 7 to invoke the FormsAuthenticationModule for *all* requests.</span></span> <span data-ttu-id="1c4c0-162">さらに、IIS 7 では、任意の種類のファイルの URL 承認規則を定義できます。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-162">Furthermore, with IIS 7 you can define URL authorization rules for files of any type.</span></span> <span data-ttu-id="1c4c0-163">詳細については、「 [IIS6 と iis7 のセキュリティ間の変更](https://www.iis.net/learn/get-started/whats-new-in-iis-7/changes-in-security-between-iis-60-and-iis-7-and-above)」、「 [Web Platform security](https://www.iis.net/learn/get-started/whats-new-in-iis-7/iis7-and-above-security-improvements)」、および「 [iis7 URL Authorization](https://www.iis.net/articles/view.aspx/IIS7/Managing-IIS7/Configuring-Security/URL-Authorization/Understanding-IIS7-URL-Authorization)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-163">For more information, see [Changes Between IIS6 and IIS7 Security](https://www.iis.net/learn/get-started/whats-new-in-iis-7/changes-in-security-between-iis-60-and-iis-7-and-above), [Your Web Platform Security](https://www.iis.net/learn/get-started/whats-new-in-iis-7/iis7-and-above-security-improvements), and [Understanding IIS7 URL Authorization](https://www.iis.net/articles/view.aspx/IIS7/Managing-IIS7/Configuring-Security/URL-Authorization/Understanding-IIS7-URL-Authorization).</span></span>

<span data-ttu-id="1c4c0-164">長期的に言えば、IIS 7 より前のバージョンでは、フォーム認証のみを使用して、ASP.NET ランタイムによって処理されるリソースを保護できます。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-164">Long story short, in versions prior to IIS 7, you can only use forms authentication to protect resources handled by the ASP.NET runtime.</span></span> <span data-ttu-id="1c4c0-165">同様に、URL 承認規則は ASP.NET ランタイムによって処理されるリソースにのみ適用されます。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-165">Likewise, URL authorization rules are only applied to resources handled by the ASP.NET runtime.</span></span> <span data-ttu-id="1c4c0-166">ただし、IIS 7 では、FormsAuthenticationModule と UrlAuthorizationModule を IIS の HTTP パイプラインに統合して、この機能をすべての要求に拡張することができます。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-166">But with IIS 7 it is possible to integrate the FormsAuthenticationModule and UrlAuthorizationModule into IIS's HTTP pipeline, thereby extending this functionality to all requests.</span></span>

## <a name="step-1-creating-an-aspnet-website-for-this-tutorial-series"></a><span data-ttu-id="1c4c0-167">手順 1: このチュートリアルシリーズの ASP.NET Web サイトを作成する</span><span class="sxs-lookup"><span data-stu-id="1c4c0-167">Step 1: Creating an ASP.NET Website for this Tutorial Series</span></span>

<span data-ttu-id="1c4c0-168">最も多くのユーザーにリーチするために、このシリーズで作成する ASP.NET web サイトは、Microsoft の無料版の Visual Studio 2008、 [Visual Web Developer 2008](https://www.microsoft.com/express/vwd/)を使用して作成されます。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-168">In order to reach the widest possible audience, the ASP.NET website we will be building throughout this series will be created with Microsoft's free version of Visual Studio 2008, [Visual Web Developer 2008](https://www.microsoft.com/express/vwd/).</span></span> <span data-ttu-id="1c4c0-169">[Microsoft SQL Server 2005 Express Edition](https://msdn.microsoft.com/sql/Aa336346.aspx)データベースに `SqlMembershipProvider` ユーザーストアを実装します。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-169">We will implement the `SqlMembershipProvider` user store in a [Microsoft SQL Server 2005 Express Edition](https://msdn.microsoft.com/sql/Aa336346.aspx) database.</span></span> <span data-ttu-id="1c4c0-170">Visual studio 2005 を使用している場合、または Visual Studio 2008 または SQL Server の別のエディションを使用している場合は、心配する必要はありません。手順はほぼ同じであり、重要ではない違いが指摘されます。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-170">If you are using Visual Studio 2005 or a different edition of Visual Studio 2008 or SQL Server, don't worry - the steps will be nearly identical and any non-trivial differences will be pointed out.</span></span>

> [!NOTE]
> <span data-ttu-id="1c4c0-171">各チュートリアルで使用されているデモ web アプリケーションは、ダウンロードとして入手できます。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-171">The demo web application used in each tutorial is available as a download.</span></span> <span data-ttu-id="1c4c0-172">このダウンロード可能なアプリケーションは、.NET Framework バージョン3.5 を対象とした Visual Web Developer 2008 で作成されました。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-172">This downloadable application was created with Visual Web Developer 2008 targeted for the .NET Framework version 3.5.</span></span> <span data-ttu-id="1c4c0-173">アプリケーションは .NET 3.5 を対象としているため、その web.config ファイルには、3.5 固有の追加の構成要素が含まれています。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-173">Since the application is targeted for .NET 3.5, its Web.config file includes additional, 3.5-specific configuration elements.</span></span> <span data-ttu-id="1c4c0-174">長期的には、コンピューターに .NET 3.5 をまだインストールしていない場合は、まず、web.config から3.5 固有のマークアップを削除しなくても、ダウンロード可能な web アプリケーションは機能しません。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-174">Long story short, if you have yet to install .NET 3.5 on your computer then the downloadable web application will not work without first removing the 3.5-specific markup from Web.config.</span></span>

<span data-ttu-id="1c4c0-175">フォーム認証を構成する前に、まず ASP.NET web サイトが必要です。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-175">Before we can configure forms authentication, we first need an ASP.NET website.</span></span> <span data-ttu-id="1c4c0-176">まず、新しいファイルシステムベースの ASP.NET web サイトを作成します。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-176">Start by creating a new file system-based ASP.NET website.</span></span> <span data-ttu-id="1c4c0-177">これを行うには、Visual Web Developer を起動し、[ファイル] メニューの [新しい Web サイト] をクリックして、[新しい Web サイト] ダイアログボックスを表示します。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-177">To accomplish this, launch Visual Web Developer and then go to the File menu and choose New Web Site, displaying the New Web Site dialog box.</span></span> <span data-ttu-id="1c4c0-178">ASP.NET Web サイトテンプレートを選択し、[場所] ドロップダウンリストを [ファイルシステム] に設定して、Web サイトを配置するフォルダーを選択C#し、言語をに設定します。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-178">Choose the ASP.NET Web Site template, set the Location drop-down list to File System, choose a folder to place the web site, and set the language to C#.</span></span> <span data-ttu-id="1c4c0-179">これにより、default.aspx ASP.NET ページ、App\_Data フォルダー、および web.config ファイルを使用して、新しい web サイトが作成されます。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-179">This will create a new web site with a Default.aspx ASP.NET page, an App\_Data folder, and a Web.config file.</span></span>

> [!NOTE]
> <span data-ttu-id="1c4c0-180">Visual Studio では、2つのプロジェクト管理モード (Web サイトプロジェクトと Web アプリケーションプロジェクト) がサポートされています。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-180">Visual Studio supports two modes of project management: Web Site Projects and Web Application Projects.</span></span> <span data-ttu-id="1c4c0-181">Web サイトプロジェクトにはプロジェクトファイルがありません。一方、Web アプリケーションプロジェクトは、Visual Studio .NET 2002/2003 のプロジェクトアーキテクチャに似ています。プロジェクトファイルが含まれ、プロジェクトのソースコードが単一のアセンブリにコンパイルされ、/bin フォルダーに配置されます。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-181">Web Site Projects lack a project file, whereas Web Application Projects mimic the project architecture in Visual Studio .NET 2002/2003 – they include a project file and compile the project's source code into a single assembly, which is placed in the /bin folder.</span></span> <span data-ttu-id="1c4c0-182">Visual Studio 2005 は、web アプリケーションプロジェクトモデルが Service Pack 1 で導入されましたが、最初はサポートされている Web サイトプロジェクトのみです。Visual Studio 2008 では、両方のプロジェクトモデルが提供されます。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-182">Visual Studio 2005 initially only supported Web Site Projects, although the Web Application Project model was reintroduced with Service Pack 1; Visual Studio 2008 offers both project models.</span></span> <span data-ttu-id="1c4c0-183">ただし、Visual Web Developer 2005 と2008の各エディションでは、Web サイトプロジェクトのみがサポートされます。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-183">The Visual Web Developer 2005 and 2008 editions, however, only support Web Site Projects.</span></span> <span data-ttu-id="1c4c0-184">ここでは、Web サイトプロジェクトモデルを使用します。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-184">I will be using the Web Site Project model.</span></span> <span data-ttu-id="1c4c0-185">Express 以外のエディションを使用していて、代わりに[Web アプリケーションプロジェクトモデル](https://msdn.microsoft.com/library/aa730880%28vs.80%29.aspx)を使用する場合は、自由に選択してください。ただし、画面に表示される内容と、このチュートリアルで説明されているスクリーンショットや手順との間には、いくつかの違いがある可能性があることに注意してください。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-185">If you are using a non-Express edition and want to use the [Web Application Project model](https://msdn.microsoft.com/library/aa730880%28vs.80%29.aspx) instead, feel free to do so but be aware that there may be some discrepancies between what you see on your screen and the steps you must take versus the screen shots shown and instructions provided in these tutorials.</span></span>

<span data-ttu-id="1c4c0-186">[新しいファイルシステムベースの Web サイトを作成 ![には](an-overview-of-forms-authentication-cs/_static/image3.png)](an-overview-of-forms-authentication-cs/_static/image2.png)</span><span class="sxs-lookup"><span data-stu-id="1c4c0-186">[![Create a New File System-Based Web Site](an-overview-of-forms-authentication-cs/_static/image3.png)](an-overview-of-forms-authentication-cs/_static/image2.png)</span></span>

<span data-ttu-id="1c4c0-187">**図 2**: 新しいファイルシステムベースの Web サイトを作成[する (クリックすると、フルサイズの画像が表示](an-overview-of-forms-authentication-cs/_static/image4.png)されます)</span><span class="sxs-lookup"><span data-stu-id="1c4c0-187">**Figure 2**: Create a New File System-Based Web Site ([Click to view full-size image](an-overview-of-forms-authentication-cs/_static/image4.png))</span></span>

### <a name="adding-a-master-page"></a><span data-ttu-id="1c4c0-188">マスターページの追加</span><span class="sxs-lookup"><span data-stu-id="1c4c0-188">Adding a Master Page</span></span>

<span data-ttu-id="1c4c0-189">次に、Site. master という名前のルートディレクトリ内のサイトに新しいマスターページを追加します。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-189">Next, add a new Master Page to the site in the root directory named Site.master.</span></span> <span data-ttu-id="1c4c0-190">[マスターページ](https://msdn.microsoft.com/library/wtxbf3hh.aspx)を使用すると、ページの開発者は、ASP.NET ページに適用できるサイト全体のテンプレートを定義できます。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-190">[Master pages](https://msdn.microsoft.com/library/wtxbf3hh.aspx) enable a page developer to define a site-wide template that can be applied to ASP.NET pages.</span></span> <span data-ttu-id="1c4c0-191">マスターページの主な利点は、サイトの全体的な外観を1つの場所に定義できるため、サイトのレイアウトを簡単に更新または調整できることです。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-191">The main benefit of master pages is that the site's overall appearance can be defined in a single location, thereby making it easy to update or tweak the site's layout.</span></span>

<span data-ttu-id="1c4c0-192">[Website という名前のマスターページを Web サイトに追加 ![には](an-overview-of-forms-authentication-cs/_static/image6.png)](an-overview-of-forms-authentication-cs/_static/image5.png)</span><span class="sxs-lookup"><span data-stu-id="1c4c0-192">[![Add a Master Page Named Site.master to the Website](an-overview-of-forms-authentication-cs/_static/image6.png)](an-overview-of-forms-authentication-cs/_static/image5.png)</span></span>

<span data-ttu-id="1c4c0-193">**図 3**: Site. Master という名前のマスターページを web サイトに追加する ([クリックすると、フルサイズの画像が表示](an-overview-of-forms-authentication-cs/_static/image7.png)されます)</span><span class="sxs-lookup"><span data-stu-id="1c4c0-193">**Figure 3**: Add a Master Page Named Site.master to the Website ([Click to view full-size image](an-overview-of-forms-authentication-cs/_static/image7.png))</span></span>

<span data-ttu-id="1c4c0-194">ここでは、マスターページでサイト全体のページレイアウトを定義します。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-194">Define the site-wide page layout here in the master page.</span></span> <span data-ttu-id="1c4c0-195">デザインビューを使用して、必要なレイアウトや Web コントロールを追加したり、手動でソースビューにマークアップを手動で追加したりすることができます。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-195">You can use the Design view and add whatever Layout or Web controls you need, or you can manually add the markup by hand in the Source view.</span></span> <span data-ttu-id="1c4c0-196">マスターページのレイアウトを構成し、 *[ASP.NET 2.0 チュートリアルシリーズのデータを操作](../../data-access/index.md)* するときに使用するレイアウトを模倣しました (図4を参照)。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-196">I structured my master page's layout to mimic the layout used in my *[Working with Data in ASP.NET 2.0](../../data-access/index.md)* tutorial series (see Figure 4).</span></span> <span data-ttu-id="1c4c0-197">マスターページでは、ファイルスタイル .css (このチュートリアルに関連するダウンロードに含まれています) に定義されている CSS 設定を使用して、配置とスタイルに[カスケードスタイルシート](http://www.w3schools.com/css/default.asp)を使用します。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-197">The master page uses [cascading style sheets](http://www.w3schools.com/css/default.asp) for positioning and styles with the CSS settings defined in the file Style.css (which is included in this tutorial's associated download).</span></span> <span data-ttu-id="1c4c0-198">次に示すマークアップからはわかりませんが、CSS 規則は、ナビゲーション &lt;div&gt;の内容が、左側に表示されるように絶対配置され、200ピクセルの固定幅であるように定義されています。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-198">While you cannot tell from the markup shown below, the CSS rules are defined such that the navigation &lt;div&gt;'s content is absolutely positioned so that it appears on the left and has a fixed width of 200 pixels.</span></span>

[!code-aspx[Main](an-overview-of-forms-authentication-cs/samples/sample1.aspx)]

<span data-ttu-id="1c4c0-199">マスターページでは、静的ページレイアウトと、マスターページを使用する ASP.NET ページで編集できる領域の両方が定義されています。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-199">A master page defines both the static page layout and the regions that can be edited by the ASP.NET pages that use the master page.</span></span> <span data-ttu-id="1c4c0-200">これらのコンテンツ編集可能な領域は、`ContentPlaceHolder` コントロールによって示されます。このコントロールは、&lt;div&gt;のコンテンツ内に表示されます。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-200">These content editable regions are indicated by the `ContentPlaceHolder` control, which can be seen within the content &lt;div&gt;.</span></span> <span data-ttu-id="1c4c0-201">マスターページには1つの `ContentPlaceHolder` (MainContent) がありますが、マスターページには複数の ContentPlaceHolders が含まれる場合があります。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-201">Our master page has a single `ContentPlaceHolder` (MainContent), but master page's may have multiple ContentPlaceHolders.</span></span>

<span data-ttu-id="1c4c0-202">上で入力したマークアップで、デザインビューに切り替えると、マスターページのレイアウトが表示されます。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-202">With the markup entered above, switching to the Design view shows the master page's layout.</span></span> <span data-ttu-id="1c4c0-203">このマスターページを使用するすべての ASP.NET ページでは、この uniform layout が使用され、`MainContent` 領域のマークアップを指定することができます。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-203">Any ASP.NET pages that use this master page will have this uniform layout, with the ability to specify the markup for the `MainContent` region.</span></span>

<span data-ttu-id="1c4c0-204">[デザインビューで表示したときにマスターページを ![する](an-overview-of-forms-authentication-cs/_static/image9.png)](an-overview-of-forms-authentication-cs/_static/image8.png)</span><span class="sxs-lookup"><span data-stu-id="1c4c0-204">[![The Master Page, When Viewed Through the Design View](an-overview-of-forms-authentication-cs/_static/image9.png)](an-overview-of-forms-authentication-cs/_static/image8.png)</span></span>

<span data-ttu-id="1c4c0-205">**図 4**: デザインビューで表示したときのマスターページ ([クリックすると、フルサイズの画像が表示](an-overview-of-forms-authentication-cs/_static/image10.png)されます)</span><span class="sxs-lookup"><span data-stu-id="1c4c0-205">**Figure 4**: The Master Page, When Viewed Through the Design View ([Click to view full-size image](an-overview-of-forms-authentication-cs/_static/image10.png))</span></span>

### <a name="creating-content-pages"></a><span data-ttu-id="1c4c0-206">コンテンツページの作成</span><span class="sxs-lookup"><span data-stu-id="1c4c0-206">Creating Content Pages</span></span>

<span data-ttu-id="1c4c0-207">この時点では、web サイトに default.aspx ページがありますが、先ほど作成したマスターページは使用しません。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-207">At this point we have a Default.aspx page in our website, but it does not use the master page we just created.</span></span> <span data-ttu-id="1c4c0-208">Web ページの宣言型マークアップを操作してマスターページを使用することは可能ですが、ページにコンテンツがまだ含まれていない場合は、ページを削除してプロジェクトに再度追加するだけで、使用するマスターページを指定できます。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-208">While it is possible to manipulate the declarative markup of a web page to use a master page, if the page doesn't contain any content yet it is easier to just delete the page and re-add it to the project, specifying the master page to use.</span></span> <span data-ttu-id="1c4c0-209">そのため、最初にプロジェクトから default.aspx を削除します。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-209">Therefore, start by deleting Default.aspx from the project.</span></span>

<span data-ttu-id="1c4c0-210">次に、ソリューションエクスプローラーでプロジェクト名を右クリックし、default.aspx という名前の新しい Web フォームを追加することを選択します。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-210">Next, right-click on the project name in the Solution Explorer and choose to add a new Web Form named Default.aspx.</span></span> <span data-ttu-id="1c4c0-211">ここで、[マスターページの選択] チェックボックスをオンにし、一覧から [.master] マスターページを選択します。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-211">This time, check the "Select master page" checkbox and choose the Site.master master page from the list.</span></span>

<span data-ttu-id="1c4c0-212">[新しい default.aspx ページを追加 ![マスターページの選択を選択します。](an-overview-of-forms-authentication-cs/_static/image12.png)](an-overview-of-forms-authentication-cs/_static/image11.png)</span><span class="sxs-lookup"><span data-stu-id="1c4c0-212">[![Add a New Default.aspx Page Choosing to Select a Master Page](an-overview-of-forms-authentication-cs/_static/image12.png)](an-overview-of-forms-authentication-cs/_static/image11.png)</span></span>

<span data-ttu-id="1c4c0-213">**図 5**: 新しい default.aspx ページを追加するマスターページの選択を選択する ([クリックすると、フルサイズの画像が表示](an-overview-of-forms-authentication-cs/_static/image13.png)されます)</span><span class="sxs-lookup"><span data-stu-id="1c4c0-213">**Figure 5**: Add a New Default.aspx Page Choosing to Select a Master Page ([Click to view full-size image](an-overview-of-forms-authentication-cs/_static/image13.png))</span></span>

![[マスター] マスターページを使用する](an-overview-of-forms-authentication-cs/_static/image14.png)

<span data-ttu-id="1c4c0-215">**図 6**: サイトのマスターページを使用する</span><span class="sxs-lookup"><span data-stu-id="1c4c0-215">**Figure 6**: Use the Site.master Master Page</span></span>

> [!NOTE]
> <span data-ttu-id="1c4c0-216">Web アプリケーションプロジェクトモデルを使用している場合は、[新しい項目の追加] ダイアログボックスに [マスターページの選択] チェックボックスは含まれません。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-216">If you are using the Web Application Project Model the Add New Item dialog box does not include a "Select master page" checkbox.</span></span> <span data-ttu-id="1c4c0-217">代わりに、"Web コンテンツフォーム" という種類の項目を追加する必要があります。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-217">Instead, you need to add an item of type "Web Content Form."</span></span> <span data-ttu-id="1c4c0-218">[Web コンテンツフォーム] オプションを選択して [追加] をクリックすると、図6に示されているのと同じ [マスターの選択] ダイアログボックスが表示されます。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-218">After choosing the "Web Content Form" option and clicking Add, Visual Studio will display the same Select a Master dialog box shown in Figure 6.</span></span>

<span data-ttu-id="1c4c0-219">新しい default.aspx ページの宣言型マークアップには、マスターページファイルへのパス、およびマスターページの MainContent ContentPlaceHolder のコンテンツコントロールを指定する @Page ディレクティブだけが含まれています。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-219">The new Default.aspx page's declarative markup includes just a @Page directive specifying the path to the master page file and a Content control for the master page's MainContent ContentPlaceHolder.</span></span>

[!code-aspx[Main](an-overview-of-forms-authentication-cs/samples/sample2.aspx)]

<span data-ttu-id="1c4c0-220">ここでは、default.aspx を空のままにします。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-220">For now, leave Default.aspx empty.</span></span> <span data-ttu-id="1c4c0-221">コンテンツを追加するには、このチュートリアルで後ほど説明します。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-221">We will return to it later in this tutorial to add content.</span></span>

> [!NOTE]
> <span data-ttu-id="1c4c0-222">マスターページには、メニューまたはその他のナビゲーションインターフェイスのセクションが含まれています。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-222">Our master page includes a section for a menu or some other navigation interface.</span></span> <span data-ttu-id="1c4c0-223">このようなインターフェイスは、今後のチュートリアルで作成します。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-223">We will create such an interface in a future tutorial.</span></span>

## <a name="step-2-enabling-forms-authentication"></a><span data-ttu-id="1c4c0-224">手順 2: フォーム認証を有効にする</span><span class="sxs-lookup"><span data-stu-id="1c4c0-224">Step 2: Enabling Forms Authentication</span></span>

<span data-ttu-id="1c4c0-225">ASP.NET web サイトを作成したので、次のタスクはフォーム認証を有効にすることです。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-225">With the ASP.NET website created, our next task is to enable forms authentication.</span></span> <span data-ttu-id="1c4c0-226">アプリケーションの認証構成は、web.config の[`<authentication>` 要素](https://msdn.microsoft.com/library/532aee0e.aspx)によって指定されます。`<authentication>` 要素には、アプリケーションで使用される認証モデルを指定する、mode という名前の1つの属性が含まれています。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-226">The application's authentication configuration is specified through the [`<authentication>` element](https://msdn.microsoft.com/library/532aee0e.aspx) in Web.config. The `<authentication>` element contains a single attribute named mode that specifies the authentication model used by the application.</span></span> <span data-ttu-id="1c4c0-227">この属性には、次の4つの値のいずれかを指定できます。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-227">This attribute can have one of the following four values:</span></span>

- <span data-ttu-id="1c4c0-228">**Windows** –前のチュートリアルで説明したように、アプリケーションで Windows 認証を使用する場合は、web サーバーがビジターを認証する必要があり、通常は基本認証、ダイジェスト認証、または統合 Windows 認証を使用して行われます。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-228">**Windows** – as discussed in the preceding tutorial, when an application uses Windows authentication it is the web server's responsibility to authenticate the visitor, and this is usually done through Basic, Digest, or Integrated Windows authentication.</span></span>
- <span data-ttu-id="1c4c0-229">**フォーム**–ユーザーは、web ページ上のフォームを使用して認証されます。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-229">**Forms**– users are authenticated via a form on a web page.</span></span>
- <span data-ttu-id="1c4c0-230">**Passport**–ユーザーは、Microsoft の passport ネットワークを使用して認証されます。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-230">**Passport**– users are authenticated using Microsoft's Passport Network.</span></span>
- <span data-ttu-id="1c4c0-231">**なし**–認証モデルは使用されません。すべての訪問者は匿名です。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-231">**None**– no authentication model is used; all visitors are anonymous.</span></span>

<span data-ttu-id="1c4c0-232">既定では、ASP.NET アプリケーションは Windows 認証を使用します。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-232">By default, ASP.NET applications use Windows authentication.</span></span> <span data-ttu-id="1c4c0-233">認証の種類をフォーム認証に変更するには、`<authentication>` 要素のモード属性をフォームに変更する必要があります。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-233">To change the authentication type to forms authentication, then, we need to modify the `<authentication>` element's mode attribute to Forms.</span></span>

<span data-ttu-id="1c4c0-234">プロジェクトに web.config ファイルがまだ含まれていない場合は、ソリューションエクスプローラーでプロジェクト名を右クリックし、[新しい項目の追加] をクリックして、Web 構成ファイルを追加することで、もう1つ追加します。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-234">If your project does not yet contain a Web.config file, add one now by right-clicking on the project name in the Solution Explorer, choosing Add New Item, and then adding a Web Configuration file.</span></span>

<span data-ttu-id="1c4c0-235">[![プロジェクトに web.config がまだ含まれていない場合は、ここで追加します。](an-overview-of-forms-authentication-cs/_static/image16.png)](an-overview-of-forms-authentication-cs/_static/image15.png)</span><span class="sxs-lookup"><span data-stu-id="1c4c0-235">[![If Your Project Does Not Yet Include Web.config, Add It Now](an-overview-of-forms-authentication-cs/_static/image16.png)](an-overview-of-forms-authentication-cs/_static/image15.png)</span></span>

<span data-ttu-id="1c4c0-236">**図 7**: プロジェクトに Web.config がまだ含まれていない場合は、ここで追加します ([クリックすると、フルサイズのイメージが表示](an-overview-of-forms-authentication-cs/_static/image17.png)されます)</span><span class="sxs-lookup"><span data-stu-id="1c4c0-236">**Figure 7**: If Your Project Does Not Yet Include Web.config, Add It Now ([Click to view full-size image](an-overview-of-forms-authentication-cs/_static/image17.png))</span></span>

<span data-ttu-id="1c4c0-237">次に、`<authentication>` 要素を見つけて、フォーム認証を使用するように更新します。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-237">Next, locate the `<authentication>` element and update it to use forms authentication.</span></span> <span data-ttu-id="1c4c0-238">この変更を行うと、web.config ファイルのマークアップは次のようになります。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-238">After this change, your Web.config file's markup should look similar to the following:</span></span>

[!code-xml[Main](an-overview-of-forms-authentication-cs/samples/sample3.xml)]

> [!NOTE]
> <span data-ttu-id="1c4c0-239">Web.config は XML ファイルであるため、大文字と小文字の区別が重要になります。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-239">Since Web.config is an XML file, casing is important.</span></span> <span data-ttu-id="1c4c0-240">Mode 属性が、大文字の "F" でフォームに設定されていることを確認します。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-240">Make sure that you set the mode attribute to Forms, with a capital "F".</span></span> <span data-ttu-id="1c4c0-241">"フォーム" などの別の大文字と小文字の区別を使用すると、ブラウザーからサイトにアクセスしたときに構成エラーが表示されます。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-241">If you use a different casing, such as "forms", you'll receive a configuration error when visiting the site through a browser.</span></span>

<span data-ttu-id="1c4c0-242">`<authentication>` 要素には、フォーム認証固有の設定を含む `<forms>` 子要素をオプションで含めることができます。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-242">The `<authentication>` element may optionally include a `<forms>` child element that contains forms authentication-specific settings.</span></span> <span data-ttu-id="1c4c0-243">ここでは、既定のフォーム認証設定を使用してみましょう。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-243">For now, let's just use the default forms authentication settings.</span></span> <span data-ttu-id="1c4c0-244">`<forms>` の子要素については、次のチュートリアルで詳しく説明します。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-244">We will explore the `<forms>` child element in more detail in the next tutorial.</span></span>

## <a name="step-3-building-the-login-page"></a><span data-ttu-id="1c4c0-245">手順 3: ログインページを作成する</span><span class="sxs-lookup"><span data-stu-id="1c4c0-245">Step 3: Building the Login Page</span></span>

<span data-ttu-id="1c4c0-246">フォーム認証をサポートするために、web サイトにはログインページが必要です。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-246">In order to support forms authentication our website needs a login page.</span></span> <span data-ttu-id="1c4c0-247">「フォーム認証ワークフローについて」セクションで説明したように、ユーザーが表示を許可されていないページにアクセスしようとすると、`FormsAuthenticationModule` によってユーザーがログインページに自動的にリダイレクトされます。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-247">As discussed in the "Understanding the Forms Authentication Workflow" section, the `FormsAuthenticationModule` will automatically redirect the user to the login page if they attempt to access a page that they are not authorized to view.</span></span> <span data-ttu-id="1c4c0-248">また、匿名ユーザーへのログインページへのリンクを表示する ASP.NET Web コントロールもあります。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-248">There are also ASP.NET Web controls that will display a link to the login page to anonymous users.</span></span> <span data-ttu-id="1c4c0-249">これは、「ログインページの URL は何ですか」という質問にそこます。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-249">This begs the question, "What is the URL of the login page?"</span></span>

<span data-ttu-id="1c4c0-250">既定では、フォーム認証システムはログインページに login.aspx という名前を付け、web アプリケーションのルートディレクトリに配置することを想定しています。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-250">By default, the forms authentication system expects the login page to be named Login.aspx and placed in the root directory of the web application.</span></span> <span data-ttu-id="1c4c0-251">別のログインページの URL を使用する場合は、web.config で指定します。これを行う方法については、以降のチュートリアルで説明します。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-251">If you want to use a different login page URL, you can do so by specifying it in Web.config. We will see how to do this in the subsequent tutorial.</span></span>

<span data-ttu-id="1c4c0-252">ログインページには、次の3つの役割があります。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-252">The login page has three responsibilities:</span></span>

1. <span data-ttu-id="1c4c0-253">ビジターが資格情報を入力できるようにするインターフェイスを提供します。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-253">Provide an interface that allows the visitor to enter their credentials.</span></span>
2. <span data-ttu-id="1c4c0-254">送信された資格情報が有効かどうかを確認します。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-254">Determine if the submitted credentials are valid.</span></span>
3. <span data-ttu-id="1c4c0-255">フォーム認証チケットを作成して、ユーザーを "ログイン" します。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-255">"Log in" the user by creating the forms authentication ticket.</span></span>

### <a name="creating-the-login-pages-user-interface"></a><span data-ttu-id="1c4c0-256">ログインページのユーザーインターフェイスを作成する</span><span class="sxs-lookup"><span data-stu-id="1c4c0-256">Creating the Login Page's User Interface</span></span>

<span data-ttu-id="1c4c0-257">最初のタスクを開始してみましょう。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-257">Let's get started with the first task.</span></span> <span data-ttu-id="1c4c0-258">新しい ASP.NET ページを login.aspx という名前のサイトのルートディレクトリに追加し、それを .master マスターページに関連付けます。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-258">Add a new ASP.NET page to the site's root directory named Login.aspx and associate it with the Site.master master page.</span></span>

<span data-ttu-id="1c4c0-259">[![、login.aspx という名前の新しい ASP.NET ページを追加します。](an-overview-of-forms-authentication-cs/_static/image19.png)](an-overview-of-forms-authentication-cs/_static/image18.png)</span><span class="sxs-lookup"><span data-stu-id="1c4c0-259">[![Add a New ASP.NET Page Named Login.aspx](an-overview-of-forms-authentication-cs/_static/image19.png)](an-overview-of-forms-authentication-cs/_static/image18.png)</span></span>

<span data-ttu-id="1c4c0-260">**図 8**: Login.aspx という名前の新しい ASP.NET ページを追加[する (クリックすると、フルサイズの画像が表示](an-overview-of-forms-authentication-cs/_static/image20.png)されます)</span><span class="sxs-lookup"><span data-stu-id="1c4c0-260">**Figure 8**: Add a New ASP.NET Page Named Login.aspx ([Click to view full-size image](an-overview-of-forms-authentication-cs/_static/image20.png))</span></span>

<span data-ttu-id="1c4c0-261">一般的なログインページインターフェイスは、2つのテキストボックスで構成されています。1つはユーザー名、もう1つはパスワード用、もう1つはフォームを送信するためのボタンです。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-261">The typical login page interface consists of two textboxes – one for the user's name, one for their password – and a button to submit the form.</span></span> <span data-ttu-id="1c4c0-262">多くの場合、web サイトには [保存] チェックボックスが含まれています</span><span class="sxs-lookup"><span data-stu-id="1c4c0-262">Websites oftentimes include a "Remember me" checkbox that, if checked, persists the resulting authentication ticket across browser restarts.</span></span>

<span data-ttu-id="1c4c0-263">Login.aspx に2つのテキストボックスを追加し、それぞれの `ID` プロパティをユーザー名とパスワードにそれぞれ設定します。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-263">Add two TextBoxes to Login.aspx and set their `ID` properties to UserName and Password, respectively.</span></span> <span data-ttu-id="1c4c0-264">また、パスワードの `TextMode` プロパティを Password に設定します。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-264">Also set Password's `TextMode` property to Password.</span></span> <span data-ttu-id="1c4c0-265">次に、CheckBox コントロールを追加し、その `ID` プロパティを RememberMe に設定し、その `Text` プロパティを "記憶する" ように設定します。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-265">Next, add a CheckBox control, setting its `ID` property to RememberMe and its `Text` property to "Remember Me".</span></span> <span data-ttu-id="1c4c0-266">次に、`Text` プロパティが "Login" に設定されている LoginButton という名前のボタンを追加します。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-266">Following that, add a Button named LoginButton whose `Text` property is set to "Login".</span></span> <span data-ttu-id="1c4c0-267">最後に、ラベル Web コントロールを追加し、その `ID` プロパティを InvalidCredentialsMessage に設定します。その `Text` プロパティは、"ユーザー名またはパスワードが無効です。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-267">And finally, add a Label Web control and set its `ID` property to InvalidCredentialsMessage, its `Text` property to "Your username or password is invalid.</span></span> <span data-ttu-id="1c4c0-268">もう一度やり直してください。 "、`ForeColor` プロパティは赤、`Visible` プロパティは False になります。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-268">Please try again.", its `ForeColor` property to Red, and its `Visible` property to False.</span></span>

<span data-ttu-id="1c4c0-269">この時点で、画面は図9のスクリーンショットのようになります。ページの宣言構文は次のようになります。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-269">At this point your screen should look similar to the screen shot in Figure 9, and your page's declarative syntax should like the following:</span></span>

[!code-aspx[Main](an-overview-of-forms-authentication-cs/samples/sample4.aspx)]

<span data-ttu-id="1c4c0-270">[ログインページに、チェックボックス、ボタン、ラベルの2つのテキストボックスが含まれて ![](an-overview-of-forms-authentication-cs/_static/image22.png)](an-overview-of-forms-authentication-cs/_static/image21.png)</span><span class="sxs-lookup"><span data-stu-id="1c4c0-270">[![The Login Page Contains Two TextBoxes, a CheckBox, a Button, and a Label](an-overview-of-forms-authentication-cs/_static/image22.png)](an-overview-of-forms-authentication-cs/_static/image21.png)</span></span>

<span data-ttu-id="1c4c0-271">**図 9**: ログインページには、チェックボックス、ボタン、ラベルの2つのテキストボックスがあります ([クリックすると、フルサイズの画像が表示](an-overview-of-forms-authentication-cs/_static/image23.png)されます)。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-271">**Figure 9**: The Login Page Contains Two TextBoxes, a CheckBox, a Button, and a Label ([Click to view full-size image](an-overview-of-forms-authentication-cs/_static/image23.png))</span></span>

<span data-ttu-id="1c4c0-272">最後に、LoginButton の Click イベントのイベントハンドラーを作成します。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-272">Finally, create an event handler for the LoginButton's Click event.</span></span> <span data-ttu-id="1c4c0-273">デザイナーからボタンコントロールをダブルクリックするだけで、このイベントハンドラーが作成されます。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-273">From the Designer, simply double-click the Button control to create this event handler.</span></span>

### <a name="determining-if-the-supplied-credentials-are-valid"></a><span data-ttu-id="1c4c0-274">指定された資格情報が有効かどうかを確認しています</span><span class="sxs-lookup"><span data-stu-id="1c4c0-274">Determining If the Supplied Credentials are Valid</span></span>

<span data-ttu-id="1c4c0-275">次に、ボタンの Click イベントハンドラーにタスク2を実装する必要があります。指定された資格情報が有効かどうかを判断します。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-275">We now need to implement task 2 in the Button's Click event handler – determining whether the supplied credentials are valid.</span></span> <span data-ttu-id="1c4c0-276">これを行うには、指定された資格情報が既知の資格情報と一致するかどうかを判断できるように、ユーザーの資格情報をすべて保持するユーザーストアが必要です。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-276">In order to do this there needs to be a user store that holds all of the users' credentials so that we can determine if the supplied credentials match up with any known credentials.</span></span>

<span data-ttu-id="1c4c0-277">ASP.NET 2.0 より前の開発者は、独自のユーザーストアを実装し、ストアに対して指定された資格情報を検証するコードを記述する責任がありました。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-277">Prior to ASP.NET 2.0, developers were responsible for implementing both their own user stores and writing the code to validate the supplied credentials against the store.</span></span> <span data-ttu-id="1c4c0-278">ほとんどの開発者は、ユーザー名、パスワード、電子メール、LastLoginDate などの列を使用して、データベースにユーザーストアを実装し、ユーザーという名前のテーブルを作成します。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-278">Most developers would implement the user store in a database, creating a table named Users with columns like UserName, Password, Email, LastLoginDate, and so forth.</span></span> <span data-ttu-id="1c4c0-279">このテーブルでは、ユーザーアカウントごとに1つのレコードが作成されます。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-279">This table, then, would have one record per user account.</span></span> <span data-ttu-id="1c4c0-280">ユーザーが指定した資格情報を確認するには、データベースに対して一致するユーザー名のクエリを実行し、データベース内のパスワードが指定されたパスワードにこれていることを確認する必要があります。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-280">Verifying a user's supplied credentials would involve querying the database for a matching username and then ensuring that the password in the database corresponded to the supplied password.</span></span>

<span data-ttu-id="1c4c0-281">ASP.NET 2.0 では、開発者はメンバーシッププロバイダーの1つを使用してユーザーストアを管理する必要があります。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-281">With ASP.NET 2.0, developers should use one of the Membership providers to manage the user store.</span></span> <span data-ttu-id="1c4c0-282">このチュートリアルシリーズでは、ユーザーストアに SQL Server データベースを使用する SqlMembershipProvider を使用します。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-282">In this tutorial series we will be using the SqlMembershipProvider, which uses a SQL Server database for the user store.</span></span> <span data-ttu-id="1c4c0-283">SqlMembershipProvider を使用する場合は、プロバイダーが想定するテーブル、ビュー、ストアドプロシージャを含む特定のデータベーススキーマを実装する必要があります。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-283">When using the SqlMembershipProvider we need to implement a specific database schema that includes the tables, views, and stored procedures expected by the provider.</span></span> <span data-ttu-id="1c4c0-284">このスキーマの実装方法については、SQL Server チュートリアルの「***メンバーシップスキーマの作成***」を確認します。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-284">We will examine how to implement this schema in the ***Creating the Membership Schema in SQL Server*** tutorial.</span></span> <span data-ttu-id="1c4c0-285">メンバーシッププロバイダーが設定されているので、ユーザーの資格情報を検証することは、[メンバーシップクラス](https://msdn.microsoft.com/library/system.web.security.membership.aspx)の[validateuser (*ユーザー名*,*パスワード*) メソッド](https://msdn.microsoft.com/library/system.web.security.membership.validateuser.aspx)を呼び出すのと同じように簡単です。これは、ユーザー*名*と*パスワード*の組み合わせが有効かどうかを示すブール値を返します。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-285">With the Membership provider in place, validating the user's credentials is as simple as calling the [Membership class](https://msdn.microsoft.com/library/system.web.security.membership.aspx)'s [ValidateUser(*username*, *password*) method](https://msdn.microsoft.com/library/system.web.security.membership.validateuser.aspx), which returns a Boolean value indicating whether the validity of the *username* and *password* combination.</span></span> <span data-ttu-id="1c4c0-286">SqlMembershipProvider のユーザーストアをまだ実装していないので、この時点ではメンバーシップクラスの ValidateUser メソッドを使用できません。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-286">Seeing as we have not yet implemented the SqlMembershipProvider's user store, we cannot use the Membership class's ValidateUser method at this time.</span></span>

<span data-ttu-id="1c4c0-287">独自のカスタムユーザーデータベーステーブル (SqlMembershipProvider を実装した後は廃止される可能性があります) を作成するのではなく、代わりにログインページ内に有効な資格情報をハードコーディングしてみましょう。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-287">Rather than take the time to build our own custom Users database table (which would be obsolete once we implemented the SqlMembershipProvider), let's instead hard-code the valid credentials within the login page itself.</span></span> <span data-ttu-id="1c4c0-288">LoginButton の Click イベントハンドラーに、次のコードを追加します。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-288">In the LoginButton's Click event handler, add the following code:</span></span>

[!code-csharp[Main](an-overview-of-forms-authentication-cs/samples/sample5.cs)]

<span data-ttu-id="1c4c0-289">ご覧のとおり、3つの有効なユーザーアカウント (Scott、Jisun、および Sam) があり、3つはすべて同じパスワード ("パスワード") を持っています。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-289">As you can see, there are three valid user accounts – Scott, Jisun, and Sam – and all three have the same password ("password").</span></span> <span data-ttu-id="1c4c0-290">このコードでは、ユーザーとパスワードの配列をループ処理して、有効なユーザー名とパスワードの一致を探します。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-290">The code loops through the users and passwords arrays looking for a valid username and password match.</span></span> <span data-ttu-id="1c4c0-291">ユーザー名とパスワードの両方が有効な場合は、ユーザーをログインさせて、適切なページにリダイレクトする必要があります。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-291">If both the username and password are valid, we need to login the user and then redirect them to the appropriate page.</span></span> <span data-ttu-id="1c4c0-292">資格情報が無効な場合は、InvalidCredentialsMessage ラベルが表示されます。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-292">If the credentials are invalid, then we display the InvalidCredentialsMessage Label.</span></span>

<span data-ttu-id="1c4c0-293">ユーザーが有効な資格情報を入力すると、"適切なページ" にリダイレクトされることを説明しました。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-293">When a user enters valid credentials, I mentioned that they are then redirected to the "appropriate page."</span></span> <span data-ttu-id="1c4c0-294">適切なページは何ですか。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-294">What is the appropriate page, though?</span></span> <span data-ttu-id="1c4c0-295">ユーザーが表示を許可されていないページにアクセスすると、FormsAuthenticationModule によって自動的にログインページにリダイレクトされることを思い出してください。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-295">Recall that when a user visits a page they are not authorized to view, the FormsAuthenticationModule automatically redirects them to the login page.</span></span> <span data-ttu-id="1c4c0-296">その場合、ReturnUrl パラメーターを使用して、要求された URL を querystring に含めます。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-296">In doing so, it includes the requested URL in the querystring via the ReturnUrl parameter.</span></span> <span data-ttu-id="1c4c0-297">つまり、ユーザーが ProtectedPage にアクセスしようとしたときに、ユーザーがその操作を許可されていない場合、FormsAuthenticationModule は次のようにリダイレクトします。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-297">That is, if a user attempted to visit ProtectedPage.aspx, and they were not authorized to do so, the FormsAuthenticationModule would redirect them to:</span></span>

<span data-ttu-id="1c4c0-298">Login.aspx ですか?ReturnUrl = ProtectedPage</span><span class="sxs-lookup"><span data-stu-id="1c4c0-298">Login.aspx?ReturnUrl=ProtectedPage.aspx</span></span>

<span data-ttu-id="1c4c0-299">ログインに成功すると、ユーザーは ProtectedPage にリダイレクトされます。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-299">Upon successfully logging in, the user should be redirected back to ProtectedPage.aspx.</span></span> <span data-ttu-id="1c4c0-300">または、ユーザーが自分の volition のログインページにアクセスすることもできます。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-300">Alternatively, users may visit the login page on their own volition.</span></span> <span data-ttu-id="1c4c0-301">この場合、ユーザーをログインした後、ルートフォルダーの default.aspx ページに送信する必要があります。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-301">In that case, after logging in the user they should be sent to the root folder's Default.aspx page.</span></span>

### <a name="logging-in-the-user"></a><span data-ttu-id="1c4c0-302">ユーザーのログイン</span><span class="sxs-lookup"><span data-stu-id="1c4c0-302">Logging In the User</span></span>

<span data-ttu-id="1c4c0-303">指定された資格情報が有効であることを前提として、フォーム認証チケットを作成し、その結果、サイトにユーザーをログインさせる必要があります。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-303">Assuming that the supplied credentials are valid, we need to create a forms authentication ticket, thereby logging in the user to the site.</span></span> <span data-ttu-id="1c4c0-304">FormsAuthentication[名前空間](https://msdn.microsoft.com/library/system.web.security.aspx)の[クラス](https://msdn.microsoft.com/library/system.web.security.formsauthentication.aspx)には、フォーム認証システムを使用してユーザーのログインとログアウトを行うためのさまざまなメソッドが用意されています。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-304">The [FormsAuthentication class](https://msdn.microsoft.com/library/system.web.security.formsauthentication.aspx) in the [System.Web.Security namespace](https://msdn.microsoft.com/library/system.web.security.aspx) provides assorted methods for logging in and logging out users via the forms authentication system.</span></span> <span data-ttu-id="1c4c0-305">FormsAuthentication クラスにはいくつかのメソッドがありますが、この時点の3つの目的は次のとおりです。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-305">While there are several methods in the FormsAuthentication class, the three we are interested in at this juncture are:</span></span>

- <span data-ttu-id="1c4c0-306">[GetAuthCookie (*username*、 *persistcookie*)](https://msdn.microsoft.com/library/system.web.security.formsauthentication.getauthcookie.aspx) –指定された名前の*ユーザー*名のフォーム認証チケットを作成します。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-306">[GetAuthCookie(*username*, *persistCookie*)](https://msdn.microsoft.com/library/system.web.security.formsauthentication.getauthcookie.aspx) – creates a forms authentication ticket for the supplied name *username*.</span></span> <span data-ttu-id="1c4c0-307">次に、このメソッドは、認証チケットの内容を保持する HttpCookie オブジェクトを作成して返します。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-307">Next, this method creates and returns an HttpCookie object that holds the contents of the authentication ticket.</span></span> <span data-ttu-id="1c4c0-308">*Persistcookie*が true の場合は、永続的なクッキーが作成されます。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-308">If *persistCookie* is true, a persistent cookie is created.</span></span>
- <span data-ttu-id="1c4c0-309">[SetAuthCookie (*username*、 *persistcookie*)](https://msdn.microsoft.com/library/system.web.security.formsauthentication.setauthcookie.aspx) –フォーム認証クッキーを生成するために getauthcookie (*username*, *persistcookie*) メソッドを呼び出します。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-309">[SetAuthCookie(*username*, *persistCookie*)](https://msdn.microsoft.com/library/system.web.security.formsauthentication.setauthcookie.aspx) – calls the GetAuthCookie(*username*, *persistCookie*) method to generate the forms authentication cookie.</span></span> <span data-ttu-id="1c4c0-310">次に、このメソッドは、GetAuthCookie によって返されたクッキーを Cookies コレクションに追加します (cookie ベースのフォーム認証が使用されていることを前提としています。それ以外の場合、このメソッドはクッキーレスチケットロジックを処理する内部クラスを呼び出します)。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-310">This method then adds the cookie returned by GetAuthCookie to the Cookies collection (assuming cookies-based forms authentication is being used; otherwise, this method calls an internal class that handles the cookieless ticket logic).</span></span>
- <span data-ttu-id="1c4c0-311">[RedirectFromLoginPage (*username*、 *persistcookie*)](https://msdn.microsoft.com/library/system.web.security.formsauthentication.redirectfromloginpage.aspx) –このメソッドは setauthcookie (*username*、 *persistcookie*) を呼び出し、適切なページにユーザーをリダイレクトします。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-311">[RedirectFromLoginPage(*username*, *persistCookie*)](https://msdn.microsoft.com/library/system.web.security.formsauthentication.redirectfromloginpage.aspx) – this method calls SetAuthCookie(*username*, *persistCookie*), and then redirects the user to the appropriate page.</span></span>

<span data-ttu-id="1c4c0-312">GetAuthCookie は、cookie を Cookie コレクションに書き込む前に認証チケットを変更する必要がある場合に便利です。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-312">GetAuthCookie is handy when you need to modify the authentication ticket before writing the cookie out to the Cookies collection.</span></span> <span data-ttu-id="1c4c0-313">SetAuthCookie は、フォーム認証チケットを作成して Cookie コレクションに追加する必要がありますが、ユーザーを適切なページにリダイレクトしない場合に便利です。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-313">SetAuthCookie is useful if you want to create the forms authentication ticket and add it to the Cookies collection, but do not want to redirect the user to the appropriate page.</span></span> <span data-ttu-id="1c4c0-314">ログインページに保存することも、別のページに送信することもできます。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-314">Perhaps you want to keep them on the login page or send them to some alternate page.</span></span>

<span data-ttu-id="1c4c0-315">ユーザーをログインし、適切なページにリダイレクトするため、RedirectFromLoginPage を使用してみましょう。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-315">Since we want to log in the user and redirect them to the appropriate page, let's use RedirectFromLoginPage.</span></span> <span data-ttu-id="1c4c0-316">LoginButton の Click イベントハンドラーを更新して、2つのコメントが付いた TODO 行を次のコード行に置き換えます。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-316">Update the LoginButton's Click event handler, replacing the two commented TODO lines with the following line of code:</span></span>

<span data-ttu-id="1c4c0-317">FormsAuthentication ページ (ユーザー名. Text, RememberMe);</span><span class="sxs-lookup"><span data-stu-id="1c4c0-317">FormsAuthentication.RedirectFromLoginPage(UserName.Text, RememberMe.Checked);</span></span>

<span data-ttu-id="1c4c0-318">フォーム認証チケットを作成するときは、フォーム認証チケットの*username*パラメーターに Username テキストボックスの Text プロパティを使用し、 *persistcookie*パラメーターの [Rememberme] チェックボックスのチェック状態を使用します。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-318">When creating the forms authentication ticket we use the UserName TextBox's Text property for the forms authentication ticket *username* parameter, and the checked state of the RememberMe CheckBox for the *persistCookie* parameter.</span></span>

<span data-ttu-id="1c4c0-319">ログインページをテストするには、ブラウザーでアクセスします。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-319">To test the login page, visit it in a browser.</span></span> <span data-ttu-id="1c4c0-320">"ユーザー名"、"間違ったパスワード" のような無効な資格情報を入力して開始します。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-320">Start by entering invalid credentials, such as a username of "Nope" and a password of "wrong".</span></span> <span data-ttu-id="1c4c0-321">ログインボタンをクリックすると、ポストバックが発生し、InvalidCredentialsMessage ラベルが表示されます。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-321">Upon clicking the Login button a postback will occur and the InvalidCredentialsMessage Label will be displayed.</span></span>

<span data-ttu-id="1c4c0-322">[無効な資格情報を入力したときに InvalidCredentialsMessage ラベルが表示される ![](an-overview-of-forms-authentication-cs/_static/image25.png)](an-overview-of-forms-authentication-cs/_static/image24.png)</span><span class="sxs-lookup"><span data-stu-id="1c4c0-322">[![The InvalidCredentialsMessage Label is Displayed When Entering Invalid Credentials](an-overview-of-forms-authentication-cs/_static/image25.png)](an-overview-of-forms-authentication-cs/_static/image24.png)</span></span>

<span data-ttu-id="1c4c0-323">**図 10**: 無効な資格情報を入力したときに InvalidCredentialsMessage ラベルが表示される ([クリックすると、フルサイズの画像が表示](an-overview-of-forms-authentication-cs/_static/image26.png)されます)</span><span class="sxs-lookup"><span data-stu-id="1c4c0-323">**Figure 10**: The InvalidCredentialsMessage Label is Displayed When Entering Invalid Credentials ([Click to view full-size image](an-overview-of-forms-authentication-cs/_static/image26.png))</span></span>

<span data-ttu-id="1c4c0-324">次に、有効な資格情報を入力し、[ログイン] ボタンをクリックします。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-324">Next, enter valid credentials and click the Login button.</span></span> <span data-ttu-id="1c4c0-325">この時点で、ポストバックが発生するとフォーム認証チケットが作成され、default.aspx に自動的にリダイレクトされます。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-325">This time when the postback occurs a forms authentication ticket is created and you are automatically redirected back to Default.aspx.</span></span> <span data-ttu-id="1c4c0-326">この時点で、web サイトにログインしましたが、現在ログインしていることを示す視覚的な手掛かりはありません。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-326">At this point you have logged in to the website, although there are no visual cues to indicate that you are currently logged in.</span></span> <span data-ttu-id="1c4c0-327">手順4では、ユーザーがログインしているかどうかをプログラムで判断する方法、およびページにアクセスするユーザーを識別する方法について説明します。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-327">In Step 4 we will see how to programmatically determine whether a user is logged in or not as well as how to identify the user visiting the page.</span></span>

<span data-ttu-id="1c4c0-328">手順5では、web サイトからユーザーをログアウトする方法について説明します。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-328">Step 5 examines techniques for logging a user out of the website.</span></span>

### <a name="securing-the-login-page"></a><span data-ttu-id="1c4c0-329">ログインページのセキュリティ保護</span><span class="sxs-lookup"><span data-stu-id="1c4c0-329">Securing the Login Page</span></span>

<span data-ttu-id="1c4c0-330">ユーザーが資格情報を入力し、ログインページフォームを送信すると、パスワードを含む資格情報がインターネット経由で*プレーンテキスト*で web サーバーに送信されます。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-330">When the user enters her credentials and submits the login page form, the credentials – including her password – are transmitted over the Internet to the web server in *plain text*.</span></span> <span data-ttu-id="1c4c0-331">つまり、ハッカーがネットワークトラフィックをスニッフィングすると、ユーザー名とパスワードが表示されます。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-331">That means any hacker sniffing the network traffic can see the username and password.</span></span> <span data-ttu-id="1c4c0-332">これを回避するには、 [SSL (Secure Socket layer)](http://en.wikipedia.org/wiki/Secure_Sockets_Layer)を使用してネットワークトラフィックを暗号化することが不可欠です。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-332">To prevent this, it is essential to encrypt the network traffic by using [Secure Socket Layers (SSL)](http://en.wikipedia.org/wiki/Secure_Sockets_Layer).</span></span> <span data-ttu-id="1c4c0-333">これにより、資格情報 (ページ全体の HTML マークアップ) が web サーバーによって受信されるまでブラウザーを離れた時点から暗号化されるようになります。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-333">This will ensure that the credentials (as well as the entire page's HTML markup) are encrypted from the moment they leave the browser until they are received by the web server.</span></span>

<span data-ttu-id="1c4c0-334">Web サイトに機密情報が含まれていない場合は、ログインページと、ユーザーのパスワードがプレーンテキストでネットワーク経由で送信されるその他のページでのみ SSL を使用する必要があります。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-334">Unless your website contains sensitive information, you will only need to use SSL on the login page and on other pages where the user's password would otherwise be sent over the wire in plain text.</span></span> <span data-ttu-id="1c4c0-335">フォーム認証チケットのセキュリティ保護について心配する必要はありません。既定では、暗号化とデジタル署名が行われます (改ざんを防ぐため)。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-335">You do not need to worry about securing the forms authentication ticket since, by default, it is both encrypted and digitally signed (to prevent tampering).</span></span> <span data-ttu-id="1c4c0-336">フォーム認証チケットのセキュリティについて詳しくは、次のチュートリアルで説明します。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-336">A more thorough discussion on forms authentication ticket security is presented in the following tutorial.</span></span>

> [!NOTE]
> <span data-ttu-id="1c4c0-337">多くの金融および医療 web サイトは、認証されたユーザーがアクセスできる*すべて*のページで SSL を使用するように構成されています。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-337">Many financial and medical websites are configured to use SSL on *all* pages accessible to authenticated users.</span></span> <span data-ttu-id="1c4c0-338">このような web サイトを構築する場合は、フォーム認証チケットがセキュリティで保護された接続でのみ送信されるように、フォーム認証システムを構成できます。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-338">If you are building such a website you can configure the forms authentication system so that the forms authentication ticket is only transmitted over a secure connection.</span></span> <span data-ttu-id="1c4c0-339">次のチュートリアル「 *[フォーム認証構成」および「高度なトピック](forms-authentication-configuration-and-advanced-topics-cs.md)* 」では、さまざまなフォーム認証構成オプションについて説明します。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-339">We will look at the various forms authentication configuration options in the next tutorial, *[Forms Authentication Configuration and Advanced Topics](forms-authentication-configuration-and-advanced-topics-cs.md)*.</span></span>

## <a name="step-4-detecting-authenticated-visitors-and-determining-their-identity"></a><span data-ttu-id="1c4c0-340">手順 4: 認証された訪問者の検出と Id の確認</span><span class="sxs-lookup"><span data-stu-id="1c4c0-340">Step 4: Detecting Authenticated Visitors and Determining Their Identity</span></span>

<span data-ttu-id="1c4c0-341">この時点で、フォーム認証が有効になり、基本的なログインページが作成されましたが、ユーザーが認証されているか匿名であるかを判断する方法はまだ確認していません。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-341">At this point we have enabled forms authentication and created a rudimentary login page, but we have yet to examine how we can determine whether a user is authenticated or anonymous.</span></span> <span data-ttu-id="1c4c0-342">場合によっては、認証されたユーザーまたは匿名ユーザーがページにアクセスしているかどうかに応じて、異なるデータまたは情報を表示したい場合があります。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-342">In certain scenarios we may wish to display different data or information depending on whether an authenticated or anonymous user is visiting the page.</span></span> <span data-ttu-id="1c4c0-343">さらに、多くの場合、認証されたユーザーの id を把握しておく必要があります。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-343">Moreover, we oftentimes need to know the identity of the authenticated user.</span></span>

<span data-ttu-id="1c4c0-344">これらの手法を説明するために、既存の default.aspx ページを拡張してみましょう。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-344">Let's augment the existing Default.aspx page to illustrate these techniques.</span></span> <span data-ttu-id="1c4c0-345">Default.aspx で、2つのパネルコントロールを追加します。1つは認証 Atedmessagepanel、もう1つは AnonymousMessagePanel という名前です。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-345">In Default.aspx add two Panel controls, one named AuthenticatedMessagePanel and another named AnonymousMessagePanel.</span></span> <span data-ttu-id="1c4c0-346">最初のパネルで、WelcomeBackMessage という名前のラベルコントロールを追加します。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-346">Add a Label control named WelcomeBackMessage in the first Panel.</span></span> <span data-ttu-id="1c4c0-347">2番目のパネルでハイパーリンクコントロールを追加し、Text プロパティを "Log In" に設定し、その NavigateUrl プロパティを "~/login, .Aspx" に設定します。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-347">In the second Panel add a HyperLink control, set its Text property to "Log In" and its NavigateUrl property to "~/Login.aspx".</span></span> <span data-ttu-id="1c4c0-348">この時点で、default.aspx の宣言型マークアップは次のようになります。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-348">At this point the declarative markup for Default.aspx should look similar to the following:</span></span>

[!code-aspx[Main](an-overview-of-forms-authentication-cs/samples/sample6.aspx)]

<span data-ttu-id="1c4c0-349">ここで推測しているように、認証された訪問者に対してのみ認証の Atedmessagepanel を表示し、匿名訪問者に AnonymousMessagePanel することをお勧めします。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-349">As you have probably guessed by now, the idea here is to display just the AuthenticatedMessagePanel to authenticated visitors and just the AnonymousMessagePanel to anonymous visitors.</span></span> <span data-ttu-id="1c4c0-350">これを実現するには、ユーザーがログインしているかどうかに応じて、これらのパネルの表示プロパティを設定する必要があります。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-350">To accomplish this we need to set these Panels' Visible properties depending on whether the user is logged in or not.</span></span>

<span data-ttu-id="1c4c0-351">[要求の IsAuthenticated プロパティ](https://msdn.microsoft.com/library/system.web.httprequest.isauthenticated.aspx)は、要求が認証されているかどうかを示すブール値を返します。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-351">The [Request.IsAuthenticated property](https://msdn.microsoft.com/library/system.web.httprequest.isauthenticated.aspx) returns a Boolean value indicating whether the request has been authenticated.</span></span> <span data-ttu-id="1c4c0-352">次のコードをページ\_読み込みイベントハンドラーコードに入力します。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-352">Enter the following code into the Page\_Load event handler code:</span></span>

[!code-csharp[Main](an-overview-of-forms-authentication-cs/samples/sample7.cs)]

<span data-ttu-id="1c4c0-353">このコードを使用して、ブラウザーから default.aspx にアクセスします。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-353">With this code in place, visit Default.aspx through a browser.</span></span> <span data-ttu-id="1c4c0-354">まだログインしていない場合は、ログインページへのリンクが表示されます (図11を参照)。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-354">Assuming that you have yet to log in, you will see a link to the login page (see Figure 11).</span></span> <span data-ttu-id="1c4c0-355">このリンクをクリックして、サイトにログインします。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-355">Click this link and log in to the site.</span></span> <span data-ttu-id="1c4c0-356">手順 3. で見たように、資格情報を入力した後、default.aspx に戻りますが、今回はページに "Welcome back!" と表示されます。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-356">As we saw in Step 3, after entering your credentials you will be returned to Default.aspx, but this time the page shows the "Welcome back!"</span></span> <span data-ttu-id="1c4c0-357">メッセージ (図12を参照)。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-357">message (see Figure 12).</span></span>

![匿名でアクセスすると、[ログイン] リンクが表示されます。](an-overview-of-forms-authentication-cs/_static/image27.png)

<span data-ttu-id="1c4c0-359">**図 11**: 匿名でアクセスする場合は、[ログイン] リンクが表示されます。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-359">**Figure 11**: When Visiting Anonymously, a Log In Link is Displayed</span></span>

![認証されたユーザーが表示されます。](an-overview-of-forms-authentication-cs/_static/image28.png)

<span data-ttu-id="1c4c0-361">**図 12**: 認証されたユーザーに "ようこそ!" と表示される</span><span class="sxs-lookup"><span data-stu-id="1c4c0-361">**Figure 12**: Authenticated Users are Shown the "Welcome back!"</span></span> <span data-ttu-id="1c4c0-362">[メッセージ]</span><span class="sxs-lookup"><span data-stu-id="1c4c0-362">Message</span></span>

<span data-ttu-id="1c4c0-363">[HttpContext オブジェクト](https://msdn.microsoft.com/library/system.web.httpcontext.aspx)の[user プロパティ](https://msdn.microsoft.com/library/system.web.httpcontext.user.aspx)を使用して、現在ログオンしているユーザーの id を確認できます。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-363">We can determine the currently logged on user's identity via the [HttpContext object](https://msdn.microsoft.com/library/system.web.httpcontext.aspx)'s [User property](https://msdn.microsoft.com/library/system.web.httpcontext.user.aspx).</span></span> <span data-ttu-id="1c4c0-364">HttpContext オブジェクトは、現在の要求に関する情報を表します。このオブジェクトは、応答、要求、セッションなどの一般的な ASP.NET オブジェクトのホームです。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-364">The HttpContext object represents information about the current request, and is the home for such common ASP.NET objects as Response, Request, and Session, among others.</span></span> <span data-ttu-id="1c4c0-365">User プロパティは、現在の HTTP 要求のセキュリティコンテキストを表し、 [IPrincipal インターフェイス](https://msdn.microsoft.com/library/system.security.principal.iprincipal.aspx)を実装します。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-365">The User property represents the security context of the current HTTP request and implements the [IPrincipal interface](https://msdn.microsoft.com/library/system.security.principal.iprincipal.aspx).</span></span>

<span data-ttu-id="1c4c0-366">User プロパティは、FormsAuthenticationModule によって設定されます。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-366">The User property is set by the FormsAuthenticationModule.</span></span> <span data-ttu-id="1c4c0-367">具体的には、FormsAuthenticationModule が受信要求でフォーム認証チケットを検出すると、新しい GenericPrincipal オブジェクトを作成し、それを User プロパティに割り当てます。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-367">Specifically, when the FormsAuthenticationModule finds a forms authentication ticket in the incoming request, it creates a new GenericPrincipal object and assigns it to the User property.</span></span>

<span data-ttu-id="1c4c0-368">プリンシパルオブジェクト (GenericPrincipal など) は、ユーザーの id と所属するロールに関する情報を提供します。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-368">Principal objects (like GenericPrincipal) provide information on the user's identity and the roles to which they belong.</span></span> <span data-ttu-id="1c4c0-369">IPrincipal インターフェイスは、次の2つのメンバーを定義します。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-369">The IPrincipal interface defines two members:</span></span>

- <span data-ttu-id="1c4c0-370">[IsInRole (*roleName*)](https://msdn.microsoft.com/library/system.security.principal.iprincipal.isinrole.aspx) –プリンシパルが指定されたロールに属しているかどうかを示すブール値を返すメソッド。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-370">[IsInRole(*roleName*)](https://msdn.microsoft.com/library/system.security.principal.iprincipal.isinrole.aspx) – a method that returns a Boolean value indicating if the principal belongs to the specified role.</span></span>
- <span data-ttu-id="1c4c0-371">[Identity](https://msdn.microsoft.com/library/system.security.principal.iprincipal.identity.aspx) – [IIdentity インターフェイス](https://msdn.microsoft.com/library/system.security.principal.iidentity.aspx)を実装するオブジェクトを返すプロパティです。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-371">[Identity](https://msdn.microsoft.com/library/system.security.principal.iprincipal.identity.aspx) – a property that returns an object that implements the [IIdentity interface](https://msdn.microsoft.com/library/system.security.principal.iidentity.aspx).</span></span> <span data-ttu-id="1c4c0-372">IIdentity インターフェイスは、 [AuthenticationType](https://msdn.microsoft.com/library/system.security.principal.iidentity.authenticationtype.aspx)、 [Isauthenticated](https://msdn.microsoft.com/library/system.security.principal.iidentity.isauthenticated.aspx)、および[Name](https://msdn.microsoft.com/library/system.security.principal.iidentity.name.aspx)という3つのプロパティを定義します。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-372">The IIdentity interface defines three properties: [AuthenticationType](https://msdn.microsoft.com/library/system.security.principal.iidentity.authenticationtype.aspx), [IsAuthenticated](https://msdn.microsoft.com/library/system.security.principal.iidentity.isauthenticated.aspx), and [Name](https://msdn.microsoft.com/library/system.security.principal.iidentity.name.aspx).</span></span>

<span data-ttu-id="1c4c0-373">現在の訪問者の名前を確認するには、次のコードを使用します。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-373">We can determine the name of the current visitor using the following code:</span></span>

<span data-ttu-id="1c4c0-374">文字列 currentUsersName = User.Identity.Name;</span><span class="sxs-lookup"><span data-stu-id="1c4c0-374">string currentUsersName = User.Identity.Name;</span></span>

<span data-ttu-id="1c4c0-375">フォーム認証を使用する場合、GenericPrincipal の Identity プロパティに対して[FormsIdentity オブジェクト](https://msdn.microsoft.com/library/system.web.security.formsidentity.aspx)が作成されます。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-375">When using forms authentication, a [FormsIdentity object](https://msdn.microsoft.com/library/system.web.security.formsidentity.aspx) is created for the GenericPrincipal's Identity property.</span></span> <span data-ttu-id="1c4c0-376">FormsIdentity クラスは、常に AuthenticationType プロパティの文字列 "Forms" を返し、IsAuthenticated プロパティに true を返します。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-376">The FormsIdentity class always returns the string "Forms" for its AuthenticationType property and true for its IsAuthenticated property.</span></span> <span data-ttu-id="1c4c0-377">Name プロパティは、フォーム認証チケットを作成するときに指定されたユーザー名を返します。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-377">The Name property returns the username specified when creating the forms authentication ticket.</span></span> <span data-ttu-id="1c4c0-378">これら3つのプロパティに加えて、FormsIdentity には、[チケットプロパティ](https://msdn.microsoft.com/library/system.web.security.formsidentity.ticket.aspx)を使用して基になる認証チケットへのアクセスが含まれます。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-378">In addition to these three properties, FormsIdentity includes access to the underlying authentication ticket via its [Ticket property](https://msdn.microsoft.com/library/system.web.security.formsidentity.ticket.aspx).</span></span> <span data-ttu-id="1c4c0-379">Ticket プロパティは、種類が[フォーム Authenticationticket](https://msdn.microsoft.com/library/system.web.security.formsauthenticationticket.aspx)のオブジェクトを返します。このオブジェクトには、有効期限、Ispersistent、IssueDate、Name などのプロパティが含まれています。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-379">The Ticket property returns an object of type [FormsAuthenticationTicket](https://msdn.microsoft.com/library/system.web.security.formsauthenticationticket.aspx), which has properties like Expiration, IsPersistent, IssueDate, Name, and so on.</span></span>

<span data-ttu-id="1c4c0-380">ここで重要な点は、FormsAuthentication (*username*, *Persistcookie*)、FormsAuthentication (*ユーザー名、* *persistcookie*)、および FormsAuthentication (*username*、 *persistcookie*) の各メソッドに指定されている*username*パラメーターが User.Identity.Name によって返される値と同じであることです。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-380">The important point to take away here is that the *username* parameter specified in the FormsAuthentication.GetAuthCookie(*username*, *persistCookie*), FormsAuthentication.SetAuthCookie(*username*, *persistCookie*), and FormsAuthentication.RedirectFromLoginPage(*username*, *persistCookie*) methods is the same value returned by User.Identity.Name.</span></span> <span data-ttu-id="1c4c0-381">さらに、これらのメソッドによって作成される認証チケットは、FormsIdentity オブジェクトにユーザー Id をキャストして、Ticket プロパティにアクセスすることによって利用できます。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-381">Moreover, the authentication ticket created by these methods is available by casting User.Identity to a FormsIdentity object and then accessing the Ticket property:</span></span>

[!code-csharp[Main](an-overview-of-forms-authentication-cs/samples/sample8.cs)]

<span data-ttu-id="1c4c0-382">Default.aspx でよりパーソナライズされたメッセージを提供してみましょう。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-382">Let's provide a more personalized message in Default.aspx.</span></span> <span data-ttu-id="1c4c0-383">WelcomeBackMessage ラベルの Text プロパティに "Welcome back, *username*!" という文字列が割り当てられるように、ページ\_読み込みイベントハンドラーを更新します。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-383">Update the Page\_Load event handler so that the WelcomeBackMessage Label's Text property is assigned the string "Welcome back, *username*!"</span></span>

<span data-ttu-id="1c4c0-384">WelcomeBackMessage = "Welcome back," + User.Identity.Name + "!";</span><span class="sxs-lookup"><span data-stu-id="1c4c0-384">WelcomeBackMessage.Text = "Welcome back, " + User.Identity.Name + "!";</span></span>

<span data-ttu-id="1c4c0-385">図13は、この変更の影響を示しています (ユーザー Scott としてログインしている場合)。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-385">Figure 13 shows the effect of this modification (when logging in as user Scott).</span></span>

![ウェルカムメッセージには、現在ログインしているユーザーの名前が含まれています](an-overview-of-forms-authentication-cs/_static/image29.png)

<span data-ttu-id="1c4c0-387">**図 13**: ウェルカムメッセージに、現在ログインしているユーザーの名前が含まれている</span><span class="sxs-lookup"><span data-stu-id="1c4c0-387">**Figure 13**: The Welcome Message Includes the Currently Logged In User's Name</span></span>

### <a name="using-the-loginview-and-loginname-controls"></a><span data-ttu-id="1c4c0-388">LoginView および Logincontrols の使用</span><span class="sxs-lookup"><span data-stu-id="1c4c0-388">Using the LoginView and LoginName Controls</span></span>

<span data-ttu-id="1c4c0-389">認証されたユーザーと匿名ユーザーに異なるコンテンツを表示することは、一般的な要件です。では、現在ログオンしているユーザーの名前が表示されます。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-389">Displaying different content to authenticated and anonymous users is a common requirement; so is displaying the name of the currently logged on user.</span></span> <span data-ttu-id="1c4c0-390">このため、ASP.NET には、図13と同じ機能を提供する2つの Web コントロールが含まれていますが、1行のコードを記述する必要はありません。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-390">For that reason, ASP.NET includes two Web controls that provide the same functionality shown in Figure 13, but without the need to write a single line of code.</span></span>

<span data-ttu-id="1c4c0-391">[LoginView コントロール](https://msdn.microsoft.com/library/system.web.ui.webcontrols.loginview.aspx)は、認証されたユーザーと匿名ユーザーに対してさまざまなデータを簡単に表示できるようにする、テンプレートベースの Web コントロールです。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-391">The [LoginView control](https://msdn.microsoft.com/library/system.web.ui.webcontrols.loginview.aspx) is a template-based Web control that makes it easy to display different data to authenticated and anonymous users.</span></span> <span data-ttu-id="1c4c0-392">LoginView には、次の2つの定義済みテンプレートが含まれます。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-392">The LoginView includes two predefined templates:</span></span>

- <span data-ttu-id="1c4c0-393">AnonymousTemplate –このテンプレートに追加されたすべてのマークアップは、匿名の訪問者にのみ表示されます。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-393">AnonymousTemplate – any markup added to this template is only displayed to anonymous visitors.</span></span>
- <span data-ttu-id="1c4c0-394">LoggedInTemplate –このテンプレートのマークアップは、認証されたユーザーにのみ表示されます。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-394">LoggedInTemplate – this template's markup is shown only to authenticated users.</span></span>

<span data-ttu-id="1c4c0-395">ここでは、LoginView コントロールをサイトのマスターページ (.master) に追加します。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-395">Let's add the LoginView control to our site's master page, Site.master.</span></span> <span data-ttu-id="1c4c0-396">ただし、LoginView コントロールだけを追加するのではなく、新しい ContentPlaceHolder コントロールを追加し、その新しい ContentPlaceHolder 内に LoginView コントロールを配置してみましょう。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-396">Rather than adding just the LoginView control, though, let's add both a new ContentPlaceHolder control and then put the LoginView control within that new ContentPlaceHolder.</span></span> <span data-ttu-id="1c4c0-397">この決定の根拠は、すぐに明らかになります。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-397">The rationale for this decision will become apparent shortly.</span></span>

> [!NOTE]
> <span data-ttu-id="1c4c0-398">AnonymousTemplate と LoggedInTemplate に加えて、LoginView コントロールには、ロール固有のテンプレートを含めることができます。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-398">In addition to the AnonymousTemplate and LoggedInTemplate, the LoginView control can include role-specific templates.</span></span> <span data-ttu-id="1c4c0-399">ロール固有のテンプレートは、指定されたロールに属しているユーザーのみにマークアップを表示します。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-399">Role-specific templates show markup only to those users that belong to a specified role.</span></span> <span data-ttu-id="1c4c0-400">この後のチュートリアルでは、LoginView コントロールのロールベースの機能について説明します。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-400">We will examine the role-based features of the LoginView control in a future tutorial.</span></span>

<span data-ttu-id="1c4c0-401">まず、LoginContent という名前の ContentPlaceHolder を、ナビゲーション &lt;div&gt; 要素内のマスターページに追加します。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-401">Start by adding a ContentPlaceHolder named LoginContent into the master page within the navigation &lt;div&gt; element.</span></span> <span data-ttu-id="1c4c0-402">ContentPlaceHolder コントロールをツールボックスからソースビューにドラッグするだけで、結果として生成されたマークアップを "TODO: Menu はここに移動..." に配置できます。本文.</span><span class="sxs-lookup"><span data-stu-id="1c4c0-402">You can simply drag a ContentPlaceHolder control from the Toolbox onto the Source view, placing the resulting markup right above the "TODO: Menu will go here…" text.</span></span>

[!code-aspx[Main](an-overview-of-forms-authentication-cs/samples/sample9.aspx)]

<span data-ttu-id="1c4c0-403">次に、LoginContent ContentPlaceHolder 内に LoginView コントロールを追加します。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-403">Next, add a LoginView control within the LoginContent ContentPlaceHolder.</span></span> <span data-ttu-id="1c4c0-404">マスターページの ContentPlaceHolder コントロールに配置されたコンテンツは、ContentPlaceHolder の*既定のコンテンツ*と見なされます。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-404">Content placed into the master page's ContentPlaceHolder controls are considered *default content* for the ContentPlaceHolder.</span></span> <span data-ttu-id="1c4c0-405">つまり、このマスターページを使用する ASP.NET ページでは、ContentPlaceHolder ごとに独自のコンテンツを指定することも、マスターページの既定のコンテンツを使用することもできます。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-405">That is, ASP.NET pages that use this master page can specify their own content for each ContentPlaceHolder or use the master page's default content.</span></span>

<span data-ttu-id="1c4c0-406">LoginView およびその他のログイン関連のコントロールは、ツールボックスの [ログイン] タブにあります。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-406">The LoginView and other login-related controls are located in the Toolbox's Login tab.</span></span>

![ツールボックスの LoginView コントロール](an-overview-of-forms-authentication-cs/_static/image30.png)

<span data-ttu-id="1c4c0-408">**図 14**: ツールボックスの LoginView コントロール</span><span class="sxs-lookup"><span data-stu-id="1c4c0-408">**Figure 14**: The LoginView Control in the Toolbox</span></span>

<span data-ttu-id="1c4c0-409">次に、LoginView コントロールの直後に ContentPlaceHolder 内にある2つの &lt;br/&gt; 要素を追加します。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-409">Next, add two &lt;br /&gt; elements immediately after the LoginView control, but still within the ContentPlaceHolder.</span></span> <span data-ttu-id="1c4c0-410">この時点で、ナビゲーション &lt;div&gt; 要素のマークアップは次のようになります。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-410">At this point, the navigation &lt;div&gt; element's markup should look like the following:</span></span>

[!code-aspx[Main](an-overview-of-forms-authentication-cs/samples/sample10.aspx)]

<span data-ttu-id="1c4c0-411">LoginView のテンプレートは、デザイナーまたは宣言型マークアップから定義できます。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-411">The LoginView's templates can be defined from the Designer or the declarative markup.</span></span> <span data-ttu-id="1c4c0-412">Visual Studio のデザイナーから、LoginView のスマートタグを展開します。このタグには、構成されているテンプレートがドロップダウンリストに表示されます。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-412">From Visual Studio's Designer, expand the LoginView's smart tag, which lists the configured templates in a drop-down list.</span></span> <span data-ttu-id="1c4c0-413">「Hello, AnonymousTemplate」というテキストを入力します。次に、HyperLink コントロールを追加し、Text プロパティと NavigateUrl プロパティをそれぞれ "Log In" と "~/Login.aspx" に設定します。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-413">Type in the text "Hello, stranger" into the AnonymousTemplate; next, add a HyperLink control and set its Text and NavigateUrl properties to "Log In" and "~/Login.aspx", respectively.</span></span>

<span data-ttu-id="1c4c0-414">AnonymousTemplate を構成した後、LoggedInTemplate に切り替え、"Welcome back" というテキストを入力します。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-414">After configuring the AnonymousTemplate, switch to the LoggedInTemplate and enter the text, "Welcome back, ".</span></span> <span data-ttu-id="1c4c0-415">次に、[ツールボックス] から [LoggedInTemplate] コントロールを [戻る] テキストの直後に配置します。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-415">Then drag a LoginName control from the Toolbox into the LoggedInTemplate, placing it immediately after the "Welcome back, " text.</span></span> <span data-ttu-id="1c4c0-416">その名前が示すように、ログイン[コントロール](https://msdn.microsoft.com/library/system.web.ui.webcontrols.loginname.aspx)は、現在ログインしているユーザーの名前を表示します。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-416">The [LoginName control](https://msdn.microsoft.com/library/system.web.ui.webcontrols.loginname.aspx), as its name implies, displays the name of the currently logged in user.</span></span> <span data-ttu-id="1c4c0-417">内部的には、Logincontrol は User.Identity.Name プロパティを単に出力します。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-417">Internally, the LoginName control simply outputs the User.Identity.Name property</span></span>

<span data-ttu-id="1c4c0-418">これらを LoginView のテンプレートに追加すると、マークアップは次のようになります。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-418">After making these additions to the LoginView's templates, the markup should look similar to the following:</span></span>

[!code-aspx[Main](an-overview-of-forms-authentication-cs/samples/sample11.aspx)]

<span data-ttu-id="1c4c0-419">このマスターページに追加すると、ユーザーが認証されているかどうかに応じて、web サイトの各ページに異なるメッセージが表示されます。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-419">With this addition to the Site.master master page, each page in our website will display a different message depending on whether the user is authenticated.</span></span> <span data-ttu-id="1c4c0-420">図15は、ブラウザーでユーザー Jisun によってアクセスされたときの default.aspx ページを示しています。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-420">Figure 15 shows the Default.aspx page when visited through a browser by user Jisun.</span></span> <span data-ttu-id="1c4c0-421">"ウェルカム, Jisun" メッセージは2回繰り返されます。1回目は、(追加した LoginView コントロールを使用して) 左側にあるマスターページのナビゲーションセクションに、もう1回は default.aspx のコンテンツ領域 (パネルコントロールとプログラムロジックを使用) に1回です。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-421">The "Welcome back, Jisun" message is repeated twice: once in the master page's navigation section on the left (via the LoginView control we just added) and once in the Default.aspx's content area (via Panel controls and programmatic logic).</span></span>

![LoginView コントロールが表示されます。](an-overview-of-forms-authentication-cs/_static/image31.png)

<span data-ttu-id="1c4c0-423">**図 15**: LoginView コントロールは、"Welcome, Jisun" を表示します。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-423">**Figure 15**: The LoginView Control Displays "Welcome back, Jisun."</span></span>

<span data-ttu-id="1c4c0-424">LoginView をマスターページに追加したので、サイトのすべてのページに表示できます。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-424">Because we added the LoginView to the master page, it can appear in every page on our site.</span></span> <span data-ttu-id="1c4c0-425">ただし、このメッセージを表示しない web ページが存在する場合があります。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-425">However, there may be web pages where we don't want to show this message.</span></span> <span data-ttu-id="1c4c0-426">ログインページへのリンクは存在しないと思われるため、このようなページはログインページです。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-426">One such page is the login page, since a link to the login page seems out of place there.</span></span> <span data-ttu-id="1c4c0-427">LoginView コントロールをマスターページの ContentPlaceHolder に配置したため、コンテンツページでこの既定のマークアップをオーバーライドできます。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-427">Since we placed the LoginView control in a ContentPlaceHolder in the master page, we can override this default markup in our content page.</span></span> <span data-ttu-id="1c4c0-428">Login.aspx を開き、デザイナーにアクセスします。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-428">Open Login.aspx and go to the Designer.</span></span> <span data-ttu-id="1c4c0-429">マスターページの LoginContent ContentPlaceHolder に対して login.aspx でコンテンツコントロールが明示的に定義されていないため、ログインページには、この ContentPlaceHolder のマスターページの既定のマークアップが表示されます。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-429">Since we have not explicitly defined a Content control in Login.aspx for the LoginContent ContentPlaceHolder in the master page, the login page will show the master page's default markup for this ContentPlaceHolder.</span></span> <span data-ttu-id="1c4c0-430">これはデザイナーで確認できます。 LoginContent ContentPlaceHolder には、既定のマークアップ (LoginView コントロール) が表示されます。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-430">You can see this through the Designer – the LoginContent ContentPlaceHolder shows the default markup (the LoginView control).</span></span>

<span data-ttu-id="1c4c0-431">[![ログインページに、マスターページの LoginContent ContentPlaceHolder の既定のコンテンツが表示されます。](an-overview-of-forms-authentication-cs/_static/image33.png)](an-overview-of-forms-authentication-cs/_static/image32.png)</span><span class="sxs-lookup"><span data-stu-id="1c4c0-431">[![The Login Page Shows the Default Content for the Master Page's LoginContent ContentPlaceHolder](an-overview-of-forms-authentication-cs/_static/image33.png)](an-overview-of-forms-authentication-cs/_static/image32.png)</span></span>

<span data-ttu-id="1c4c0-432">**図 16**: ログインページには、マスターページの Logincontent ContentPlaceHolder の既定のコンテンツが表示されます ([クリックすると、フルサイズの画像が表示](an-overview-of-forms-authentication-cs/_static/image34.png)されます)</span><span class="sxs-lookup"><span data-stu-id="1c4c0-432">**Figure 16**: The Login Page Shows the Default Content for the Master Page's LoginContent ContentPlaceHolder ([Click to view full-size image](an-overview-of-forms-authentication-cs/_static/image34.png))</span></span>

<span data-ttu-id="1c4c0-433">LoginContent ContentPlaceHolder の既定のマークアップをオーバーライドするには、デザイナーで領域を右クリックし、コンテキストメニューから [カスタムコンテンツの作成] オプションを選択します。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-433">To override the default markup for the LoginContent ContentPlaceHolder, simply right-click on the region in the Designer and choose the Create Custom Content option from the context menu.</span></span> <span data-ttu-id="1c4c0-434">(Visual Studio 2008 を使用している場合、ContentPlaceHolder にはスマートタグが含まれています。このタグを選択すると、同じオプションが提供されます)。これにより、ページのマークアップに新しいコンテンツコントロールが追加され、このページのカスタムコンテンツを定義できるようになります。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-434">(When using Visual Studio 2008 the ContentPlaceHolder includes a smart tag that, when selected, offers the same option.) This adds a new Content control to the page's markup and thereby allows us to define custom content for this page.</span></span> <span data-ttu-id="1c4c0-435">ここに "ログインしてください..." のようなカスタムメッセージを追加できますが、空白のままにしておきます。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-435">You could add a custom message here, such as "Please log in…", but let's just leave this blank.</span></span>

> [!NOTE]
> <span data-ttu-id="1c4c0-436">Visual Studio 2005 では、カスタムコンテンツを作成すると、ASP.NET ページに空のコンテンツコントロールが作成されます。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-436">In Visual Studio 2005, creating custom content creates an empty Content control in the ASP.NET page.</span></span> <span data-ttu-id="1c4c0-437">ただし、Visual Studio 2008 では、カスタムコンテンツを作成すると、マスターページの既定のコンテンツが新しく作成されたコンテンツコントロールにコピーされます。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-437">In Visual Studio 2008, however, creating custom content copies the master page's default content into the newly created Content control.</span></span> <span data-ttu-id="1c4c0-438">Visual Studio 2008 を使用している場合は、新しいコンテンツコントロールを作成した後で、マスターページからコピーしたコンテンツをクリアするようにしてください。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-438">If you are using Visual Studio 2008, then, after creating the new Content control make sure to clear out the content copied over from the master page.</span></span>

<span data-ttu-id="1c4c0-439">図17は、この変更を行った後にブラウザーからアクセスしたときの login.aspx ページを示しています。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-439">Figure 17 shows the Login.aspx page when visited from a browser after making this change.</span></span> <span data-ttu-id="1c4c0-440">Default.aspx にアクセスするときと同じように、左側のナビゲーション &lt;div&gt; に "Hello, こんにちは" または "Welcome back, *username*" というメッセージが表示されないことに注意してください。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-440">Note that there is no "Hello, stranger" or "Welcome back, *username*" message in the left navigation &lt;div&gt; as there is when visiting Default.aspx.</span></span>

<span data-ttu-id="1c4c0-441">[ログインページを ![と、既定の LoginContent ContentPlaceHolder のマークアップが非表示になります。](an-overview-of-forms-authentication-cs/_static/image36.png)](an-overview-of-forms-authentication-cs/_static/image35.png)</span><span class="sxs-lookup"><span data-stu-id="1c4c0-441">[![The Login Page Hides the Default LoginContent ContentPlaceHolder's Markup](an-overview-of-forms-authentication-cs/_static/image36.png)](an-overview-of-forms-authentication-cs/_static/image35.png)</span></span>

<span data-ttu-id="1c4c0-442">**図 17**: ログインページで既定の Logincontent ContentPlaceHolder のマークアップが非表示になる ([クリックしてフルサイズの画像を表示する](an-overview-of-forms-authentication-cs/_static/image37.png))</span><span class="sxs-lookup"><span data-stu-id="1c4c0-442">**Figure 17**: The Login Page Hides the Default LoginContent ContentPlaceHolder's Markup ([Click to view full-size image](an-overview-of-forms-authentication-cs/_static/image37.png))</span></span>

## <a name="step-5-logging-out"></a><span data-ttu-id="1c4c0-443">手順 5: ログアウト</span><span class="sxs-lookup"><span data-stu-id="1c4c0-443">Step 5: Logging Out</span></span>

<span data-ttu-id="1c4c0-444">手順3では、ユーザーをサイトにログインするためのログインページの構築について説明しましたが、ユーザーをログアウトする方法についてはまだ説明していません。FormsAuthentication クラスには、でユーザーをログに記録するメソッドに加えて、[サインアウトメソッド](https://msdn.microsoft.com/library/system.web.security.formsauthentication.signout.aspx)も用意されています。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-444">In Step 3 we looked at building a login page to log a user in to the site, but we have yet to see how to log a user out. In addition to methods for logging a user in, the FormsAuthentication class also provides a [SignOut method](https://msdn.microsoft.com/library/system.web.security.formsauthentication.signout.aspx).</span></span> <span data-ttu-id="1c4c0-445">サインアウトメソッドは、単にフォーム認証チケットを破棄し、その結果、サイトからユーザーをログアウトします。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-445">The SignOut method simply destroys the forms authentication ticket, thereby logging the user out of the site.</span></span>

<span data-ttu-id="1c4c0-446">Log out リンクを提供することは、ユーザーをログアウトするために特別に設計されたコントロールを ASP.NET に含む一般的な機能です。[LoginStatus コントロール](https://msdn.microsoft.com/library/system.web.ui.webcontrols.loginstatus.aspx)は、ユーザーの認証状態に応じて、"Login" linkbutton または "Logout" linkbutton のいずれかを表示します。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-446">Offering a log out link is such a common feature that ASP.NET includes a control specifically designed to log a user out. The [LoginStatus control](https://msdn.microsoft.com/library/system.web.ui.webcontrols.loginstatus.aspx) displays either a "Login" LinkButton or a "Logout" LinkButton, depending on the user's authentication status.</span></span> <span data-ttu-id="1c4c0-447">"Login" LinkButton は匿名ユーザーに対してレンダリングされますが、"Logout" LinkButton は認証されたユーザーに表示されます。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-447">A "Login" LinkButton is rendered for anonymous users, whereas a "Logout" LinkButton is displayed to authenticated users.</span></span> <span data-ttu-id="1c4c0-448">"Login" および "Logout" リンクボタンのテキストは、LoginStatus の LoginText プロパティおよび LogoutText プロパティを使用して構成できます。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-448">The text for the "Login" and "Logout" LinkButtons can be configured via the LoginStatus's LoginText and LogoutText properties.</span></span>

<span data-ttu-id="1c4c0-449">"Login" LinkButton をクリックするとポストバックが発生し、ログインページにリダイレクトが発行されます。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-449">Clicking the "Login" LinkButton causes a postback, from which a redirect is issued to the login page.</span></span> <span data-ttu-id="1c4c0-450">"Logout" LinkButton をクリックすると、LoginStatus コントロールは FormsAuthentication メソッドを呼び出し、ページにユーザーをリダイレクトします。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-450">Clicking the "Logout" LinkButton causes the LoginStatus control to invoke the FormsAuthentication.SignOff method and then redirects the user to a page.</span></span> <span data-ttu-id="1c4c0-451">ログオフしたユーザーがリダイレクトされるページは、LogoutAction プロパティによって異なります。このプロパティは、次の3つの値のいずれかに割り当てることができます。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-451">The page the logged off user is redirected to depends on the LogoutAction property, which can be assigned to one of the three following values:</span></span>

- <span data-ttu-id="1c4c0-452">Refresh –既定値。アクセスしたばかりのページにユーザーをリダイレクトします。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-452">Refresh – the default; redirects the user to the page they were just visiting.</span></span> <span data-ttu-id="1c4c0-453">アクセスしたばかりのページで匿名ユーザーが許可されていない場合、FormsAuthenticationModule はユーザーをログインページに自動的にリダイレクトします。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-453">If the page they were just visiting does not allow anonymous users, then the FormsAuthenticationModule will automatically redirect the user to the login page.</span></span>

<span data-ttu-id="1c4c0-454">ここでリダイレクトが実行される理由を知りたい場合があります。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-454">You may be curious as to why a redirect is performed here.</span></span> <span data-ttu-id="1c4c0-455">ユーザーが同じページにとどまる場合は、明示的なリダイレクトが必要になるのはなぜですか。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-455">If the user wants to remain on the same page, why the need for the explicit redirect?</span></span> <span data-ttu-id="1c4c0-456">理由は、"ログオフ" LinkButton がクリックされたときに、ユーザーの cookie コレクションにフォーム認証チケットがまだあるためです。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-456">The reason is because when the "Logoff" LinkButton is clicked, the user still has the forms authentication ticket in their cookies collection.</span></span> <span data-ttu-id="1c4c0-457">その結果、ポストバック要求は認証された要求になります。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-457">Consequently, the postback request is an authenticated request.</span></span> <span data-ttu-id="1c4c0-458">LoginStatus コントロールはサインアウトメソッドを呼び出しますが、これは FormsAuthenticationModule がユーザーを認証した後に発生します。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-458">The LoginStatus control calls the SignOut method, but that happens after the FormsAuthenticationModule has authenticated the user.</span></span> <span data-ttu-id="1c4c0-459">したがって、明示的なリダイレクトによって、ブラウザーはページを再要求します。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-459">Therefore, an explicit redirect causes the browser to re-request the page.</span></span> <span data-ttu-id="1c4c0-460">ブラウザーがページを再要求したときに、フォーム認証チケットが削除されたため、受信要求は匿名になります。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-460">By the time the browser re-requests the page, the forms authentication ticket has been removed and therefore the incoming request is anonymous.</span></span>

- <span data-ttu-id="1c4c0-461">リダイレクト–ユーザーは、LoginStatus の LogoutPageUrl プロパティによって指定された URL にリダイレクトされます。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-461">Redirect – the user is redirected to the URL specified by the LoginStatus's LogoutPageUrl property.</span></span>
- <span data-ttu-id="1c4c0-462">RedirectToLoginPage –ユーザーはログインページにリダイレクトされます。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-462">RedirectToLoginPage – the user is redirected to the login page.</span></span>

<span data-ttu-id="1c4c0-463">マスターページに LoginStatus コントロールを追加し、リダイレクトオプションを使用して、サインアウトしたことを確認するメッセージを表示するページにユーザーを送信するように構成してみましょう。まず、Logout という名前のルートディレクトリにページを作成します。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-463">Let's add a LoginStatus control to the master page and configure it to use the Redirect option to send the user to a page that displays a message confirming that they have been signed out. Start by creating a page in the root directory named Logout.aspx.</span></span> <span data-ttu-id="1c4c0-464">このページを必ず、このページを使用してください。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-464">Don't forget to associate this page with the Site.master master page.</span></span> <span data-ttu-id="1c4c0-465">次に、ページのマークアップに、ログアウトしたことを示すメッセージを入力します。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-465">Next, enter a message in the page's markup explaining to the user that they have been logged out.</span></span>

<span data-ttu-id="1c4c0-466">次に、LoginStatus マスターページに戻り、LoginContent ContentPlaceHolder の LoginView の下に、[] コントロールを追加します。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-466">Next, return to the Site.master master page and add a LoginStatus control beneath the LoginView in the LoginContent ContentPlaceHolder.</span></span> <span data-ttu-id="1c4c0-467">LoginStatus コントロールの LogoutAction プロパティを Redirect に設定し、その LogoutPageUrl プロパティを "~/logoutaction" に設定します。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-467">Set the LoginStatus control's LogoutAction property to Redirect and its LogoutPageUrl property to "~/Logout.aspx".</span></span>

[!code-aspx[Main](an-overview-of-forms-authentication-cs/samples/sample12.aspx)]

<span data-ttu-id="1c4c0-468">LoginStatus は LoginView コントロールの外部にあるため、匿名ユーザーと認証済みユーザーの両方に対して表示されますが、LoginStatus によって "Login" または "Logout" LinkButton が正しく表示されるため、問題はありません。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-468">Since the LoginStatus is outside of the LoginView control, it will appear for both anonymous and authenticated users, but that's OK because the LoginStatus will correctly display a "Login" or "Logout" LinkButton.</span></span> <span data-ttu-id="1c4c0-469">LoginStatus コントロールを追加すると、AnonymousTemplate の "ログイン" ハイパーリンクは不要になり、削除されます。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-469">With the addition of the LoginStatus control, the "Log In" HyperLink in the AnonymousTemplate is superfluous, so remove it.</span></span>

<span data-ttu-id="1c4c0-470">図18は、Jisun がアクセスしたときの default.aspx を示しています。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-470">Figure 18 shows Default.aspx when Jisun visits.</span></span> <span data-ttu-id="1c4c0-471">左の列には、"Welcome back, Jisun" というメッセージと、ログアウト用のリンクが表示されていることに注意してください。Log out LinkButton をクリックすると、ポストバックが発生し、システムから Jisun に署名された後、Logout にリダイレクトされます。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-471">Note that the left column displays the message, "Welcome back, Jisun" along with a link to log out. Clicking the log out LinkButton causes a postback, signs Jisun out of the system, and then redirects her to Logout.aspx.</span></span> <span data-ttu-id="1c4c0-472">図19に示すように、Jisun が Logout に到達すると、既にサインアウトされているため、匿名になります。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-472">As Figure 19 shows, by the time Jisun reaches Logout.aspx she has already been signed out and is therefore anonymous.</span></span> <span data-ttu-id="1c4c0-473">その結果、左側の列には、"ようこそ, 人" というテキストとログインページへのリンクが表示されます。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-473">Consequently, the left column shows the text "Welcome, stranger" and a link to the login page.</span></span>

<span data-ttu-id="1c4c0-474">[default.aspx ![が表示されます。](an-overview-of-forms-authentication-cs/_static/image39.png)](an-overview-of-forms-authentication-cs/_static/image38.png)</span><span class="sxs-lookup"><span data-stu-id="1c4c0-474">[![Default.aspx Shows](an-overview-of-forms-authentication-cs/_static/image39.png)](an-overview-of-forms-authentication-cs/_static/image38.png)</span></span>

<span data-ttu-id="1c4c0-475">**図 18**: default.aspx は、"Logout" LinkButton と共に "Welcome, Jisun" を表示します ([クリックすると、フルサイズの画像が表示](an-overview-of-forms-authentication-cs/_static/image40.png)されます)</span><span class="sxs-lookup"><span data-stu-id="1c4c0-475">**Figure 18**: Default.aspx Shows "Welcome Back, Jisun" Along with a "Logout" LinkButton ([Click to view full-size image](an-overview-of-forms-authentication-cs/_static/image40.png))</span></span>

<span data-ttu-id="1c4c0-476">[![Logout の表示](an-overview-of-forms-authentication-cs/_static/image42.png)](an-overview-of-forms-authentication-cs/_static/image41.png)</span><span class="sxs-lookup"><span data-stu-id="1c4c0-476">[![Logout.aspx Shows](an-overview-of-forms-authentication-cs/_static/image42.png)](an-overview-of-forms-authentication-cs/_static/image41.png)</span></span>

<span data-ttu-id="1c4c0-477">**図 19**: Logout に "Login" LinkButton と共に "ようこそ, 人" が表示される ([クリックすると、フルサイズの画像が表示](an-overview-of-forms-authentication-cs/_static/image43.png)されます)</span><span class="sxs-lookup"><span data-stu-id="1c4c0-477">**Figure 19**: Logout.aspx Shows "Welcome, stranger" Along with a "Login" LinkButton ([Click to view full-size image](an-overview-of-forms-authentication-cs/_static/image43.png))</span></span>

> [!NOTE]
> <span data-ttu-id="1c4c0-478">Logout ページをカスタマイズして、マスターページの LoginContent ContentPlaceHolder を非表示にすることをお勧めします (手順4の login.aspx の場合と同様)。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-478">I encourage you to customize the Logout.aspx page to hide the master page's LoginContent ContentPlaceHolder (like we did for Login.aspx in Step 4).</span></span> <span data-ttu-id="1c4c0-479">その理由は、LoginStatus コントロールによってレンダリングされる "Login" LinkButton ("Hello, こんにちは") によってユーザーがログインページに送信され、ReturnUrl querystring パラメーターに現在の URL が渡されるためです。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-479">The reason is because the "Login" LinkButton rendered by the LoginStatus control (the one beneath "Hello, stranger") sends the user to the login page passing the current URL in the ReturnUrl querystring parameter.</span></span> <span data-ttu-id="1c4c0-480">つまり、ログアウトしたユーザーがこの LoginStatus の "Login" LinkButton をクリックし、ログインすると、ユーザーを混乱させる可能性がある Logout にリダイレクトされます。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-480">In short, if a user who has logged out clicks this LoginStatus's "Login" LinkButton, and then logs in, they will be redirected back to Logout.aspx, which could easily confuse the user.</span></span>

## <a name="summary"></a><span data-ttu-id="1c4c0-481">要約</span><span class="sxs-lookup"><span data-stu-id="1c4c0-481">Summary</span></span>

<span data-ttu-id="1c4c0-482">このチュートリアルでは、フォーム認証ワークフローの調査を開始し、ASP.NET アプリケーションでフォーム認証を実装しました。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-482">In this tutorial we started with an examination of the forms authentication workflow and then turned to implementing forms authentication in an ASP.NET application.</span></span> <span data-ttu-id="1c4c0-483">フォーム認証は FormsAuthenticationModule を利用しています。これには、フォーム認証チケットに基づいてユーザーを識別し、承認されていないユーザーをログインページにリダイレクトするという2つの役割があります。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-483">Forms authentication is powered by the FormsAuthenticationModule, which has two responsibilities: identifying users based on their forms authentication ticket, and redirecting unauthorized users to the login page.</span></span>

<span data-ttu-id="1c4c0-484">.NET Framework の FormsAuthentication クラスには、フォーム認証チケットを作成、検査、および削除するメソッドが含まれています。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-484">The .NET Framework's FormsAuthentication class includes methods for creating, inspecting, and removing forms authentication tickets.</span></span> <span data-ttu-id="1c4c0-485">要求が認証されているかどうかを判断するための追加のプログラムサポートと、ユーザーの id に関する情報が提供されます。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-485">The Request.IsAuthenticated property and User object provide additional programmatic support for determining whether a request is authenticated and information about the user's identity.</span></span> <span data-ttu-id="1c4c0-486">また、LoginView、LoginStatus、および Loginweb コントロールもあります。これにより、開発者は、多くの一般的なログイン関連タスクを簡単に、コードを自由に実行できるようになります。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-486">There are also the LoginView, LoginStatus, and LoginName Web controls, which give developers a quick, code-free way for performing many common login-related tasks.</span></span> <span data-ttu-id="1c4c0-487">今後のチュートリアルでは、これらおよび他のログイン関連 Web コントロールについてさらに詳しく説明します。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-487">We will examine these and other login-related Web controls in greater detail in future tutorials.</span></span>

<span data-ttu-id="1c4c0-488">このチュートリアルでは、フォーム認証の概要を大まかに説明しました。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-488">This tutorial provided a cursory overview of forms authentication.</span></span> <span data-ttu-id="1c4c0-489">さまざまな構成オプションについては説明しませんでした。クッキーレスフォーム認証チケットがどのように機能するかを確認するか、ASP.NET がフォーム認証チケットの内容を保護する方法を調べてください。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-489">We did not examine the assorted configuration options, look at how cookieless forms authentication tickets work, or explore how ASP.NET protects the contents of the forms authentication ticket.</span></span> <span data-ttu-id="1c4c0-490">これらのトピックについては、[次のチュートリアル](forms-authentication-configuration-and-advanced-topics-cs.md)で説明します。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-490">We will discuss these topics and more in the [next tutorial](forms-authentication-configuration-and-advanced-topics-cs.md).</span></span>

<span data-ttu-id="1c4c0-491">プログラミングを楽しんでください。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-491">Happy Programming!</span></span>

### <a name="further-reading"></a><span data-ttu-id="1c4c0-492">関連項目</span><span class="sxs-lookup"><span data-stu-id="1c4c0-492">Further Reading</span></span>

<span data-ttu-id="1c4c0-493">このチュートリアルで説明しているトピックの詳細については、次のリソースを参照してください。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-493">For more information on the topics discussed in this tutorial, refer to the following resources:</span></span>

- [<span data-ttu-id="1c4c0-494">IIS6 と IIS7 のセキュリティ間の変更</span><span class="sxs-lookup"><span data-stu-id="1c4c0-494">Changes Between IIS6 and IIS7 Security</span></span>](https://www.iis.net/articles/view.aspx/IIS7/Managing-IIS7/Configuring-Security/Changes-between-IIS6-and-IIS7-Security)
- [<span data-ttu-id="1c4c0-495">Login ASP.NET コントロール</span><span class="sxs-lookup"><span data-stu-id="1c4c0-495">Login ASP.NET Controls</span></span>](https://msdn.microsoft.com/library/d51ttbhx.aspx)
- <span data-ttu-id="1c4c0-496">[Professional ASP.NET 2.0 のセキュリティ、メンバーシップ、およびロール管理](http://www.wrox.com/WileyCDA/WroxTitle/productCd-0764596985.html)(ISBN: 978-0-7645-9698-8)</span><span class="sxs-lookup"><span data-stu-id="1c4c0-496">[Professional ASP.NET 2.0 Security, Membership, and Role Management](http://www.wrox.com/WileyCDA/WroxTitle/productCd-0764596985.html) (ISBN: 978-0-7645-9698-8)</span></span>
- [<span data-ttu-id="1c4c0-497">`<authentication>` 要素</span><span class="sxs-lookup"><span data-stu-id="1c4c0-497">The `<authentication>` Element</span></span>](https://msdn.microsoft.com/library/532aee0e.aspx)
- [<span data-ttu-id="1c4c0-498">の `<forms>` 要素 `<authentication>`</span><span class="sxs-lookup"><span data-stu-id="1c4c0-498">The `<forms>` Element for `<authentication>`</span></span>](https://msdn.microsoft.com/library/1d3t3c61.aspx)

### <a name="video-training-on-topics-contained-in-this-tutorial"></a><span data-ttu-id="1c4c0-499">このチュートリアルに含まれるトピックのビデオトレーニング</span><span class="sxs-lookup"><span data-stu-id="1c4c0-499">Video Training on Topics Contained in this Tutorial</span></span>

- [<span data-ttu-id="1c4c0-500">ASP.NET で基本フォーム認証を使用する</span><span class="sxs-lookup"><span data-stu-id="1c4c0-500">Using Basic Forms Authentication in ASP.NET</span></span>](../../../videos/authentication/using-basic-forms-authentication-in-aspnet.md)

## <a name="about-the-author"></a><span data-ttu-id="1c4c0-501">作成者について</span><span class="sxs-lookup"><span data-stu-id="1c4c0-501">About the Author</span></span>

<span data-ttu-id="1c4c0-502">1998以来、 [Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml)は 7 asp/創設者 of [4GuysFromRolla.com](http://www.4guysfromrolla.com)の執筆者であり、Microsoft Web テクノロジを使用しています。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-502">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="1c4c0-503">Scott は、独立したコンサルタント、トレーナー、およびライターとして機能します。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-503">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="1c4c0-504">彼の最新の書籍は[ *、ASP.NET 2.0 を24時間以内に教え*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)ています。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-504">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="1c4c0-505">mitchell@4GuysFromRolla.comでアクセスでき[ます。](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="1c4c0-505">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="1c4c0-506">または彼のブログを参照してください。これは[http://ScottOnWriting.NET](http://ScottOnWriting.NET)にあります。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-506">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="1c4c0-507">ありがとうございました。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-507">Special Thanks To…</span></span>

<span data-ttu-id="1c4c0-508">このチュートリアルシリーズは、役に立つ多くのレビュー担当者によってレビューされました。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-508">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="1c4c0-509">このチュートリアルのリーダーレビュー担当者は、このチュートリアルシリーズは多くの便利なレビュー担当者によってレビューされました。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-509">Lead reviewer for this tutorial was This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="1c4c0-510">このチュートリアルのリードレビュー担当者には、Alicja Maziarz、John 加藤 u、Teresa Murphy が含まれています。</span><span class="sxs-lookup"><span data-stu-id="1c4c0-510">Lead reviewers for this tutorial include Alicja Maziarz, John Suru, and Teresa Murphy.</span></span> <span data-ttu-id="1c4c0-511">今後の MSDN 記事を確認することに興味がありますか?</span><span class="sxs-lookup"><span data-stu-id="1c4c0-511">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="1c4c0-512">その場合は、mitchell@4GuysFromRolla.comの行を削除[します。](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="1c4c0-512">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="1c4c0-513">[前へ](security-basics-and-asp-net-support-cs.md)
> [次へ](forms-authentication-configuration-and-advanced-topics-cs.md)</span><span class="sxs-lookup"><span data-stu-id="1c4c0-513">[Previous](security-basics-and-asp-net-support-cs.md)
[Next](forms-authentication-configuration-and-advanced-topics-cs.md)</span></span>

---
uid: web-forms/overview/older-versions-security/membership/validating-user-credentials-against-the-membership-user-store-cs
title: メンバーシップ ユーザー ストア (c#) に対してユーザー資格情報の検証 |Microsoft Docs
author: rick-anderson
description: このチュートリアルでは、プログラムによる方法と、ログイン コントロールの両方を使用して、メンバーシップ ユーザー ストアに対してユーザーの資格情報を検証する方法を説明しています.
ms.author: riande
ms.date: 01/18/2008
ms.assetid: 61aa4e08-aa81-4aeb-8ebe-19ba7a65e04c
msc.legacyurl: /web-forms/overview/older-versions-security/membership/validating-user-credentials-against-the-membership-user-store-cs
msc.type: authoredcontent
ms.openlocfilehash: 469fc9c52bd3d1e5dd69b80399b250ba46f72405
ms.sourcegitcommit: 51b01b6ff8edde57d8243e4da28c9f1e7f1962b2
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 05/06/2019
ms.locfileid: "65131827"
---
# <a name="validating-user-credentials-against-the-membership-user-store-c"></a><span data-ttu-id="d1bac-103">メンバーシップ ユーザー ストアに対してユーザー資格情報を確認する (C#)</span><span class="sxs-lookup"><span data-stu-id="d1bac-103">Validating User Credentials Against the Membership User Store (C#)</span></span>

<span data-ttu-id="d1bac-104">によって[Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="d1bac-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="d1bac-105">[コードのダウンロード](http://download.microsoft.com/download/3/f/5/3f5a8605-c526-4b34-b3fd-a34167117633/ASPNET_Security_Tutorial_06_CS.zip)または[PDF のダウンロード](http://download.microsoft.com/download/3/f/5/3f5a8605-c526-4b34-b3fd-a34167117633/aspnet_tutorial06_LoggingIn_cs.pdf)</span><span class="sxs-lookup"><span data-stu-id="d1bac-105">[Download Code](http://download.microsoft.com/download/3/f/5/3f5a8605-c526-4b34-b3fd-a34167117633/ASPNET_Security_Tutorial_06_CS.zip) or [Download PDF](http://download.microsoft.com/download/3/f/5/3f5a8605-c526-4b34-b3fd-a34167117633/aspnet_tutorial06_LoggingIn_cs.pdf)</span></span>

> <span data-ttu-id="d1bac-106">このチュートリアルでは、プログラムによる方法と、ログイン コントロールの両方を使用して、メンバーシップ ユーザー ストアに対してユーザーの資格情報を検証する方法を説明します。</span><span class="sxs-lookup"><span data-stu-id="d1bac-106">In this tutorial we will examine how to validate a user's credentials against the Membership user store using both programmatic means and the Login control.</span></span> <span data-ttu-id="d1bac-107">ログイン コントロールの外観と動作をカスタマイズする方法に注目するはもします。</span><span class="sxs-lookup"><span data-stu-id="d1bac-107">We will also look at how to customize the login control's appearance and behavior.</span></span>

## <a name="introduction"></a><span data-ttu-id="d1bac-108">はじめに</span><span class="sxs-lookup"><span data-stu-id="d1bac-108">Introduction</span></span>

<span data-ttu-id="d1bac-109"><a id="Tutorial05"> </a>[前のチュートリアル](creating-user-accounts-cs.md)メンバーシップ フレームワークで新しいユーザー アカウントを作成する方法を説明しました。</span><span class="sxs-lookup"><span data-stu-id="d1bac-109">In the <a id="Tutorial05"></a>[preceding tutorial](creating-user-accounts-cs.md) we looked at how to create a new user account in the Membership framework.</span></span> <span data-ttu-id="d1bac-110">最初にプログラムで使用してユーザー アカウントを作成しました、`Membership`クラスの`CreateUser`メソッド、CreateUserWizard Web コントロールを使用して、調査とします。</span><span class="sxs-lookup"><span data-stu-id="d1bac-110">We first looked at programmatically creating user accounts via the `Membership` class's `CreateUser` method, and then examined using the CreateUserWizard Web control.</span></span> <span data-ttu-id="d1bac-111">ただし、ログイン ページは現在のユーザー名とパスワードのペアのハード コーディングされた一覧を指定された資格情報を検証します。</span><span class="sxs-lookup"><span data-stu-id="d1bac-111">However, the login page currently validates the supplied credentials against a hard-coded list of username and password pairs.</span></span> <span data-ttu-id="d1bac-112">メンバーシップ フレームワークのユーザー ストアに対して資格情報を検証するために、ログイン ページのロジックを更新する必要があります。</span><span class="sxs-lookup"><span data-stu-id="d1bac-112">We need to update the login page's logic so that it validates credentials against the Membership framework's user store.</span></span>

<span data-ttu-id="d1bac-113">はるかのようなユーザー アカウントの作成と資格情報検証できるプログラムから、または宣言によって。</span><span class="sxs-lookup"><span data-stu-id="d1bac-113">Much like with creating user accounts, credentials can be validated programmatically or declaratively.</span></span> <span data-ttu-id="d1bac-114">メンバーシップ API には、ユーザー ストアに対してユーザーの資格情報をプログラムで検証するためのメソッドが含まれています。</span><span class="sxs-lookup"><span data-stu-id="d1bac-114">The Membership API includes a method for programmatically validating a user's credentials against the user store.</span></span> <span data-ttu-id="d1bac-115">ASP.NET がユーザー名とパスワード ログインするためのボタンのテキスト ボックスにユーザー インターフェイスをレンダリングする、ログイン Web コントロールが付属しています。</span><span class="sxs-lookup"><span data-stu-id="d1bac-115">And ASP.NET ships with the Login Web control, which renders a user interface with textboxes for the username and password and a button to log in.</span></span>

<span data-ttu-id="d1bac-116">このチュートリアルでは、プログラムによる方法と、ログイン コントロールの両方を使用して、メンバーシップ ユーザー ストアに対してユーザーの資格情報を検証する方法を説明します。</span><span class="sxs-lookup"><span data-stu-id="d1bac-116">In this tutorial we will examine how to validate a user's credentials against the Membership user store using both programmatic means and the Login control.</span></span> <span data-ttu-id="d1bac-117">ログイン コントロールの外観と動作をカスタマイズする方法に注目するはもします。</span><span class="sxs-lookup"><span data-stu-id="d1bac-117">We will also look at how to customize the login control's appearance and behavior.</span></span> <span data-ttu-id="d1bac-118">それでは、始めましょう!</span><span class="sxs-lookup"><span data-stu-id="d1bac-118">Let's get started!</span></span>

## <a name="step-1-validating-credentials-against-the-membership-user-store"></a><span data-ttu-id="d1bac-119">手順 1: メンバーシップ ユーザー ストアに対して資格情報の検証</span><span class="sxs-lookup"><span data-stu-id="d1bac-119">Step 1: Validating Credentials Against the Membership User Store</span></span>

<span data-ttu-id="d1bac-120">フォーム認証を使用する web サイトでは、ユーザー ログオンの web サイトにログイン ページにアクセスして資格情報を入力します。</span><span class="sxs-lookup"><span data-stu-id="d1bac-120">For web sites that use forms authentication, a user logs on to the website by visiting a login page and entering their credentials.</span></span> <span data-ttu-id="d1bac-121">これらの資格情報は、ユーザー ストアに対してと比較されます。</span><span class="sxs-lookup"><span data-stu-id="d1bac-121">These credentials are then compared against the user store.</span></span> <span data-ttu-id="d1bac-122">有効な場合は、ユーザーの間でフォーム認証チケット、id および訪問者の信頼性を示すセキュリティ トークンが付与されます。</span><span class="sxs-lookup"><span data-stu-id="d1bac-122">If they are valid, then the user is granted a forms authentication ticket, which is a security token that indicates the identity and authenticity of the visitor.</span></span>

<span data-ttu-id="d1bac-123">メンバーシップ フレームワークを対象にユーザーを検証するには、使用、`Membership`クラスの[`ValidateUser`メソッド](https://msdn.microsoft.com/library/system.web.security.membership.validateuser.aspx)します。</span><span class="sxs-lookup"><span data-stu-id="d1bac-123">To validate a user against the Membership framework, use the `Membership` class's [`ValidateUser` method](https://msdn.microsoft.com/library/system.web.security.membership.validateuser.aspx).</span></span> <span data-ttu-id="d1bac-124">`ValidateUser`メソッドは 2 つの入力パラメーター - *`username`* と*`password`* -資格情報が有効かどうかを示すブール値を返します。</span><span class="sxs-lookup"><span data-stu-id="d1bac-124">The `ValidateUser` method takes in two input parameters - *`username`* and *`password`* - and returns a Boolean value indicating whether the credentials were valid.</span></span> <span data-ttu-id="d1bac-125">使用するような`CreateUser`メソッドの前のチュートリアルで調べる、`ValidateUser`メソッドが実際の検証を構成したメンバーシップ プロバイダーを委任します。</span><span class="sxs-lookup"><span data-stu-id="d1bac-125">Like with the `CreateUser` method we examined in the previous tutorial, the `ValidateUser` method delegates the actual validation to the configured Membership provider.</span></span>

<span data-ttu-id="d1bac-126">`SqlMembershipProvider`を使用して、指定したユーザーのパスワードを取得することによって指定された資格情報を検証、`aspnet_Membership_GetPasswordWithFormat`ストアド プロシージャ。</span><span class="sxs-lookup"><span data-stu-id="d1bac-126">The `SqlMembershipProvider` validates the supplied credentials by obtaining the specified user's password via the `aspnet_Membership_GetPasswordWithFormat` stored procedure.</span></span> <span data-ttu-id="d1bac-127">いることを思い出してください、 `SqlMembershipProvider` 3 つの形式のいずれかを使用してユーザーのパスワードを格納: clear、暗号化、またはハッシュします。</span><span class="sxs-lookup"><span data-stu-id="d1bac-127">Recall that the `SqlMembershipProvider` stores users' passwords using one of three formats: clear, encrypted, or hashed.</span></span> <span data-ttu-id="d1bac-128">`aspnet_Membership_GetPasswordWithFormat`ストアド プロシージャは、未加工の形式でパスワードを返します。</span><span class="sxs-lookup"><span data-stu-id="d1bac-128">The `aspnet_Membership_GetPasswordWithFormat` stored procedure returns the password in its raw format.</span></span> <span data-ttu-id="d1bac-129">暗号化またはハッシュされたパスワードの場合、`SqlMembershipProvider`変換、 *`password`* に渡された値、`ValidateUser`暗号化をそれと同等のメソッド、または状態をハッシュされから返された結果と比較、データベース。</span><span class="sxs-lookup"><span data-stu-id="d1bac-129">For encrypted or hashed passwords, the `SqlMembershipProvider` transforms the *`password`* value passed into the `ValidateUser` method into its equivalent encrypted or hashed state and then compares it with what was returned from the database.</span></span> <span data-ttu-id="d1bac-130">データベースに格納されているパスワードには、ユーザーが入力した書式設定されたパスワードが一致すると、資格情報が無効です。</span><span class="sxs-lookup"><span data-stu-id="d1bac-130">If the password stored in the database matches the formatted password entered by the user, the credentials are valid.</span></span>

<span data-ttu-id="d1bac-131">このログイン ページを更新しましょう (~/`Login.aspx`) メンバーシップ フレームワークのユーザー ストアに対して指定された資格情報を検証します。</span><span class="sxs-lookup"><span data-stu-id="d1bac-131">Let's update our login page (~/`Login.aspx`) so that it validates the supplied credentials against the Membership framework user store.</span></span> <span data-ttu-id="d1bac-132">このログイン ページを作成したに戻り、 <a id="Tutorial02"> </a> [*フォーム認証の概要を*](../introduction/an-overview-of-forms-authentication-cs.md)チュートリアルでは、ユーザー名とパスワードの 2 つのテキスト ボックスで、インターフェイスの作成をチェック ボックスをオンし、ログイン ボタンに、そのアカウントを記憶する (図 1 参照)。</span><span class="sxs-lookup"><span data-stu-id="d1bac-132">We created this login page back in the <a id="Tutorial02"></a>[*An Overview of Forms Authentication*](../introduction/an-overview-of-forms-authentication-cs.md) tutorial, creating an interface with two TextBoxes for the username and password, a Remember Me checkbox, and a Login button (see Figure 1).</span></span> <span data-ttu-id="d1bac-133">コードでは、ハード コーディングされた (Scott/パスワード、Jisun/パスワード、および Sam/パスワード) は、ユーザー名とパスワードのペアのリストに対して入力した資格情報を検証します。</span><span class="sxs-lookup"><span data-stu-id="d1bac-133">The code validates the entered credentials against a hard-coded list of username and password pairs (Scott/password, Jisun/password, and Sam/password).</span></span> <span data-ttu-id="d1bac-134"><a id="Tutorial03"> </a> [*フォーム認証の構成と高度なトピック*](../introduction/forms-authentication-configuration-and-advanced-topics-cs.md)チュートリアルは、フォームに追加情報を格納する、ログイン ページのコードを更新しました認証チケットの`UserData`プロパティ。</span><span class="sxs-lookup"><span data-stu-id="d1bac-134">In the <a id="Tutorial03"></a>[*Forms Authentication Configuration and Advanced Topics*](../introduction/forms-authentication-configuration-and-advanced-topics-cs.md) tutorial we updated the login page's code to store additional information in the forms authentication ticket's `UserData` property.</span></span>

<span data-ttu-id="d1bac-135">[![ログイン ページのインターフェイスには、2 つのテキスト ボックス、CheckBoxList、およびボタンが含まれます。](validating-user-credentials-against-the-membership-user-store-cs/_static/image2.png)](validating-user-credentials-against-the-membership-user-store-cs/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="d1bac-135">[![The Login Page's Interface Includes Two TextBoxes, a CheckBoxList, and a Button](validating-user-credentials-against-the-membership-user-store-cs/_static/image2.png)](validating-user-credentials-against-the-membership-user-store-cs/_static/image1.png)</span></span>

<span data-ttu-id="d1bac-136">**図 1**:ログイン ページのインターフェイスを含む 2 つのテキスト ボックス、CheckBoxList、およびボタン ([フルサイズの画像を表示する をクリックします](validating-user-credentials-against-the-membership-user-store-cs/_static/image3.png))。</span><span class="sxs-lookup"><span data-stu-id="d1bac-136">**Figure 1**: The Login Page's Interface Includes Two TextBoxes, a CheckBoxList, and a Button  ([Click to view full-size image](validating-user-credentials-against-the-membership-user-store-cs/_static/image3.png))</span></span>

<span data-ttu-id="d1bac-137">ログイン ページのユーザー インターフェイスは変わらないことができますが、ログイン ボタンのボタンに置き換える必要があります`Click`メンバーシップ フレームワークのユーザー ストアに対してユーザーを検証するコードを持つイベント ハンドラー。</span><span class="sxs-lookup"><span data-stu-id="d1bac-137">The login page's user interface can remain unchanged, but we need to replace the Login button's `Click` event handler with code that validates the user against the Membership framework user store.</span></span> <span data-ttu-id="d1bac-138">イベント ハンドラーは、そのコードは次のように表示されるように更新します。</span><span class="sxs-lookup"><span data-stu-id="d1bac-138">Update the event handler so that its code appears as follows:</span></span>

[!code-csharp[Main](validating-user-credentials-against-the-membership-user-store-cs/samples/sample1.cs)]

<span data-ttu-id="d1bac-139">このコードでは、非常に単純です。</span><span class="sxs-lookup"><span data-stu-id="d1bac-139">This code is remarkably simple.</span></span> <span data-ttu-id="d1bac-140">まず、呼び出すことによって、`Membership.ValidateUser`メソッドを指定されたユーザー名とパスワードを渡します。</span><span class="sxs-lookup"><span data-stu-id="d1bac-140">We start by calling the `Membership.ValidateUser` method, passing in the supplied username and password.</span></span> <span data-ttu-id="d1bac-141">そのメソッドが true を返すかどうかは、ユーザーが経由でのサイトにサインインして、`FormsAuthentication`クラスの RedirectFromLoginPage メソッド。</span><span class="sxs-lookup"><span data-stu-id="d1bac-141">If that method returns true, then the user is signed into the site via the `FormsAuthentication` class's RedirectFromLoginPage method.</span></span> <span data-ttu-id="d1bac-142">(で説明したように、 <a id="Tutorial2"> </a> [*フォーム認証の概要を*](../introduction/an-overview-of-forms-authentication-cs.md)チュートリアルでは、`FormsAuthentication.RedirectFromLoginPage`フォーム認証チケットを作成し、ユーザーをリダイレクトします適切なページです。)資格情報が無効の場合、ただし、`InvalidCredentialsMessage`ラベルを表示すると、ユーザーに知らせることがユーザー名またはパスワードが間違っています。</span><span class="sxs-lookup"><span data-stu-id="d1bac-142">(As we discussed in the <a id="Tutorial2"></a>[*An Overview of Forms Authentication*](../introduction/an-overview-of-forms-authentication-cs.md) tutorial, the `FormsAuthentication.RedirectFromLoginPage` creates the forms authentication ticket and then redirects the user to the appropriate page.) If the credentials are invalid, however, the `InvalidCredentialsMessage` Label is displayed, informing the user that their username or password was incorrect.</span></span>

<span data-ttu-id="d1bac-143">必要な作業は以上です。</span><span class="sxs-lookup"><span data-stu-id="d1bac-143">That's all there is to it!</span></span>

<span data-ttu-id="d1bac-144">ログイン ページが期待どおりに動作をテストするには、前のチュートリアルで作成したユーザー アカウントのいずれかでログインするしようとします。</span><span class="sxs-lookup"><span data-stu-id="d1bac-144">To test that the login page works as expected, attempt to login with one of the user accounts you created in the preceding tutorial.</span></span> <span data-ttu-id="d1bac-145">または、いずれかから作成してください、アカウントをまだ作成がない場合、`~/Membership/CreatingUserAccounts.aspx`ページ。</span><span class="sxs-lookup"><span data-stu-id="d1bac-145">Or, if you have not yet created an account, go ahead and create one from the `~/Membership/CreatingUserAccounts.aspx` page.</span></span>

> [!NOTE]
> <span data-ttu-id="d1bac-146">自分のパスワードを含む、資格情報がで web サーバーにインターネット経由で転送されるときに、ユーザーは自分の資格情報を入力し、ログイン ページのフォームを送信する、*プレーン テキスト*します。</span><span class="sxs-lookup"><span data-stu-id="d1bac-146">When the user enters her credentials and submits the login page form, the credentials, including her password, are transmitted over the Internet to the web server in *plain text*.</span></span> <span data-ttu-id="d1bac-147">つまり、ネットワーク トラフィックをスニッフィング ハッカーは、ユーザー名とパスワードを確認できます。</span><span class="sxs-lookup"><span data-stu-id="d1bac-147">That means any hacker sniffing the network traffic can see the username and password.</span></span> <span data-ttu-id="d1bac-148">これを防ぐにを使用して、ネットワーク トラフィックを暗号化するために不可欠[セキュリティで保護されたソケット レイヤー (SSL)](http://en.wikipedia.org/wiki/Secure_Sockets_Layer)します。</span><span class="sxs-lookup"><span data-stu-id="d1bac-148">To prevent this, it is essential to encrypt the network traffic by using [Secure Socket Layers (SSL)](http://en.wikipedia.org/wiki/Secure_Sockets_Layer).</span></span> <span data-ttu-id="d1bac-149">これにより、web サーバーによって受信されるまで、ブラウザーを離れる時点から、資格情報 (およびその全体のページの HTML マークアップ) を暗号化することが保証されます。</span><span class="sxs-lookup"><span data-stu-id="d1bac-149">This will ensure that the credentials (as well as the entire page's HTML markup) are encrypted from the moment they leave the browser until they are received by the web server.</span></span>

### <a name="how-the-membership-framework-handles-invalid-login-attempts"></a><span data-ttu-id="d1bac-150">メンバーシップ フレームワークが無効なログイン試行を処理する方法</span><span class="sxs-lookup"><span data-stu-id="d1bac-150">How the Membership Framework Handles Invalid Login Attempts</span></span>

<span data-ttu-id="d1bac-151">訪問者は、ログイン ページに達するし、自分の資格情報を送信する、ブラウザーは、ログイン ページに HTTP 要求を作成します。</span><span class="sxs-lookup"><span data-stu-id="d1bac-151">When a visitor reaches the login page and submits their credentials, their browser makes an HTTP request to the login page.</span></span> <span data-ttu-id="d1bac-152">資格情報が有効な場合は、HTTP 応答には、cookie に認証チケットが含まれています。</span><span class="sxs-lookup"><span data-stu-id="d1bac-152">If the credentials are valid, the HTTP response includes the authentication ticket in a cookie.</span></span> <span data-ttu-id="d1bac-153">そのため、サイトに分割しようとしています。 ハッカーは徹底的有効なユーザー名とパスワードの推測されたログイン ページに HTTP 要求を送信するプログラムを作成します。</span><span class="sxs-lookup"><span data-stu-id="d1bac-153">Therefore, a hacker attempting to break into your site could create a program that exhaustively sends HTTP requests to the login page with a valid username and a guess at the password.</span></span> <span data-ttu-id="d1bac-154">パスワードの推測が正しい場合は、ログイン ページは、プログラムが有効なユーザー名/パスワードのペアを偶然を知ってこの時点で、認証チケットのクッキーを返します。</span><span class="sxs-lookup"><span data-stu-id="d1bac-154">If the password guess is correct, the login page will return the authentication ticket cookie, at which point the program knows it has stumbled upon a valid username/password pair.</span></span> <span data-ttu-id="d1bac-155">ブルート フォース攻撃、によっては、パスワードが脆弱な場合に特にに、このようなプログラムがユーザーのパスワードに遭遇すること可能性があります。</span><span class="sxs-lookup"><span data-stu-id="d1bac-155">Through brute force, such a program might be able to stumble upon a user's password, especially if the password is weak.</span></span>

<span data-ttu-id="d1bac-156">このようなブルート フォース攻撃を防ぐためには、メンバーシップ フレームワークを一定期間内で失敗したログイン試行数がある場合、ユーザーをロックします。</span><span class="sxs-lookup"><span data-stu-id="d1bac-156">To prevent such brute force attacks, the Membership framework locks out a user if there are a certain number of unsuccessful login attempts within a certain period of time.</span></span> <span data-ttu-id="d1bac-157">正確なパラメーターは、次の 2 つのメンバーシップ プロバイダーの構成設定を使用して構成できます。</span><span class="sxs-lookup"><span data-stu-id="d1bac-157">The exact parameters are configurable through the following two Membership provider configuration settings:</span></span>

- <span data-ttu-id="d1bac-158">`maxInvalidPasswordAttempts` -無効なパスワードの数を指定します、アカウントがロックアウトされるまでの期間内のユーザーの試行が許可されます。既定値は 5 です。</span><span class="sxs-lookup"><span data-stu-id="d1bac-158">`maxInvalidPasswordAttempts` - specifies how many invalid password attempts are allowed for the user within the time period before the account is locked out. The default value is 5.</span></span>
- <span data-ttu-id="d1bac-159">`passwordAttemptWindow` -指定された無効なログイン試行回数が、アカウントがロックアウトを原因を分単位で期間を示します。既定値は 10 です。</span><span class="sxs-lookup"><span data-stu-id="d1bac-159">`passwordAttemptWindow` - indicates the time period in minutes during which the specified number of invalid login attempts will cause the account to be locked out. The default value is 10.</span></span>

<span data-ttu-id="d1bac-160">ユーザーがロックアウトされている場合は、管理者が自分のアカウントをロック解除まで彼女ログインできません。</span><span class="sxs-lookup"><span data-stu-id="d1bac-160">If a user has been locked out, she cannot login until an administrator unlocks her account.</span></span> <span data-ttu-id="d1bac-161">ユーザーがロックアウトされた場合、`ValidateUser`メソッドは*常に*を返す`false`場合でも、有効な資格情報を入力します。</span><span class="sxs-lookup"><span data-stu-id="d1bac-161">When a user is locked out, the `ValidateUser` method will *always* return `false`, even if valid credentials are supplied.</span></span> <span data-ttu-id="d1bac-162">この動作は、ハッカーはサイト ブルート フォース攻撃の方法で分割される可能性を軽減、中には、ユーザーが自分のパスワードを忘れた単に、Capslock にまたは誤って不適切な入力日がある有効なユーザーがロックアウトを終了できます。</span><span class="sxs-lookup"><span data-stu-id="d1bac-162">While this behavior lessens the likelihood that a hacker will break into your site through brute force methods, it can end up locking out a valid user who has simply forgotten her password or accidentally has the Caps Lock on or is having a bad typing day.</span></span>

<span data-ttu-id="d1bac-163">残念ながら、ユーザー アカウントをロック解除用の組み込みのツールではありません。</span><span class="sxs-lookup"><span data-stu-id="d1bac-163">Unfortunately, there is no built-in tool for unlocking a user account.</span></span> <span data-ttu-id="d1bac-164">アカウントのロックを解除するには、データベースを変更することができますを直接の変更、`IsLockedOut`フィールドに、 `aspnet_Membership` - 適切なユーザー アカウントのテーブルか、web ベースのインターフェイスを一覧表示、保護を解除するためのオプションを持つアカウントのロックアウトを作成します。</span><span class="sxs-lookup"><span data-stu-id="d1bac-164">In order to unlock an account, you can modify the database directly - change the `IsLockedOut` field in the `aspnet_Membership` table for the appropriate user account - or create a web-based interface that lists locked out accounts with options to unlock them.</span></span> <span data-ttu-id="d1bac-165">今後のチュートリアルでは、一般的なユーザー アカウントと役割に関連するタスクを実行するための管理インターフェイスの作成を見ていきます。</span><span class="sxs-lookup"><span data-stu-id="d1bac-165">We will examine creating administrative interfaces for accomplishing common user account- and role-related tasks in a future tutorial.</span></span>

> [!NOTE]
> <span data-ttu-id="d1bac-166">1 つの欠点、`ValidateUser`メソッドは、指定された資格情報が有効でない場合に提供されません理由についても説明します。</span><span class="sxs-lookup"><span data-stu-id="d1bac-166">One downside of the `ValidateUser` method is that when the supplied credentials are invalid, it does not provide any explanation as to why.</span></span> <span data-ttu-id="d1bac-167">資格情報、ユーザー ストアに一致するユーザー名とパスワードの組み合わせがないため、ユーザーが承認されていないため、またはユーザーがロックアウトされているために有効なことがあります。手順 4 は、そのログインが失敗したときに、ユーザーに詳細なメッセージを表示する方法が表示されます。</span><span class="sxs-lookup"><span data-stu-id="d1bac-167">The credentials may be invalid because there is no matching username/password pair in the user store, or because the user has not yet been approved, or because the user has been locked out. In Step 4 we will see how to show a more detailed message to the user when their login attempt fails.</span></span>

## <a name="step-2-collecting-credentials-through-the-login-web-control"></a><span data-ttu-id="d1bac-168">手順 2: ログインの Web コントロールを使用して資格情報の収集</span><span class="sxs-lookup"><span data-stu-id="d1bac-168">Step 2: Collecting Credentials through the Login Web Control</span></span>

<span data-ttu-id="d1bac-169">[ログイン Web コントロール](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.aspx)に戻り作成したものとよく似ています、既定のユーザー インターフェイスを表示、 <a id="SKM5"> </a> [*フォーム認証の概要を*](../introduction/an-overview-of-forms-authentication-cs.md)チュートリアル。</span><span class="sxs-lookup"><span data-stu-id="d1bac-169">The [Login Web control](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.aspx) renders a default user interface very similar to the one we created back in the <a id="SKM5"></a>[*An Overview of Forms Authentication*](../introduction/an-overview-of-forms-authentication-cs.md) tutorial.</span></span> <span data-ttu-id="d1bac-170">ログイン コントロールを使用する私たちと保存、ユーザー資格情報を収集するインターフェイスを作成するための作業します。</span><span class="sxs-lookup"><span data-stu-id="d1bac-170">Using the Login control saves us the work of having to create the interface to collect the visitor�s credentials.</span></span> <span data-ttu-id="d1bac-171">さらに、Login コントロールが自動的にサインイン (送信された資格情報が有効なを想定) ユーザーのためご保存コードを記述する必要がなくなります。</span><span class="sxs-lookup"><span data-stu-id="d1bac-171">Moreover, the Login control automatically signs in the user (assuming the submitted credentials are valid), thereby saving us from having to write any code.</span></span>

<span data-ttu-id="d1bac-172">更新`Login.aspx`、手動で作成したインターフェイスを交換およびコードでは、Login コントロール。</span><span class="sxs-lookup"><span data-stu-id="d1bac-172">Let's update `Login.aspx`, replacing the manually created interface and code with a Login control.</span></span> <span data-ttu-id="d1bac-173">既存のマークアップを削除することで起動し、コードで`Login.aspx`します。</span><span class="sxs-lookup"><span data-stu-id="d1bac-173">Start by removing the existing markup and code in `Login.aspx`.</span></span> <span data-ttu-id="d1bac-174">削除しても、最初から、または単にコメント アウトする可能性があります。宣言型マークアップをコメントに、それを囲む、`<%--`と`--%>`区切り記号。</span><span class="sxs-lookup"><span data-stu-id="d1bac-174">You may delete it outright, or simply comment it out. To comment out declarative markup, surround it with the `<%--` and `--%>` delimiters.</span></span> <span data-ttu-id="d1bac-175">これらの区切り記号を手動で入力することができますか、図 2 に示すよう、コメント アウトし、ツールバーのアイコンを選択した行をコメントをクリックするテキストを選択します。</span><span class="sxs-lookup"><span data-stu-id="d1bac-175">You can enter these delimiters manually, or, as Figure 2 shows, you may select the text to comment out and then click the Comment out the selected lines icon in the Toolbar.</span></span> <span data-ttu-id="d1bac-176">同様に、選択した行のアイコンをコメントを使用すると、分離コード クラスで選択したコードをコメント アウトします。</span><span class="sxs-lookup"><span data-stu-id="d1bac-176">Similarly, you can use the Comment out the selected lines icon to comment out the selected code in the code-behind class.</span></span>

<span data-ttu-id="d1bac-177">[![既存の宣言型マークアップと Login.aspx 内のソース コード コメント](validating-user-credentials-against-the-membership-user-store-cs/_static/image5.png)](validating-user-credentials-against-the-membership-user-store-cs/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="d1bac-177">[![Comment Out the Existing Declarative Markup and Source Code in Login.aspx](validating-user-credentials-against-the-membership-user-store-cs/_static/image5.png)](validating-user-credentials-against-the-membership-user-store-cs/_static/image4.png)</span></span>

<span data-ttu-id="d1bac-178">**図 2**:コメントを既存宣言マークアップとソース コードで`Login.aspx`([フルサイズの画像を表示する をクリックします](validating-user-credentials-against-the-membership-user-store-cs/_static/image6.png))。</span><span class="sxs-lookup"><span data-stu-id="d1bac-178">**Figure 2**: Comment Out the Existing Declarative Markup and Source Code in `Login.aspx` ([Click to view full-size image](validating-user-credentials-against-the-membership-user-store-cs/_static/image6.png))</span></span>

> [!NOTE]
> <span data-ttu-id="d1bac-179">Visual Studio 2005 で宣言型マークアップを表示するときに、選択した行のアイコンをコメントは使用できません。</span><span class="sxs-lookup"><span data-stu-id="d1bac-179">The Comment out the selected lines icon is not available when viewing the declarative markup in Visual Studio 2005.</span></span> <span data-ttu-id="d1bac-180">Visual Studio 2008 を使用していない場合は、手動で追加する必要があります。、`<%--`と`--%>`区切り記号。</span><span class="sxs-lookup"><span data-stu-id="d1bac-180">If you are not using Visual Studio 2008 you will need to manually add the `<%--` and `--%>` delimiters.</span></span>

<span data-ttu-id="d1bac-181">次に、ログイン コントロールをページにツールボックスからドラッグし、設定、`ID`プロパティを`myLogin`します。</span><span class="sxs-lookup"><span data-stu-id="d1bac-181">Next, drag a Login control from the Toolbox on to the page and set its `ID` property to `myLogin`.</span></span> <span data-ttu-id="d1bac-182">この時点で、画面に図 3 のようになります。</span><span class="sxs-lookup"><span data-stu-id="d1bac-182">At this point your screen should look similar to Figure 3.</span></span> <span data-ttu-id="d1bac-183">ログイン コントロールの既定のインターフェイスがユーザー名とパスワードを次回チェック ボックスをオンおよびログの ボタンのテキスト ボックス コントロールが含まれることに注意してください。</span><span class="sxs-lookup"><span data-stu-id="d1bac-183">Note that the Login control's default interface includes TextBox controls for the username and password, a Remember me next time CheckBox, and a Log In Button.</span></span> <span data-ttu-id="d1bac-184">`RequiredFieldValidator`の 2 つのテキスト ボックス コントロール。</span><span class="sxs-lookup"><span data-stu-id="d1bac-184">There are also `RequiredFieldValidator` controls for the two TextBoxes.</span></span>

<span data-ttu-id="d1bac-185">[![Login コントロールをページに追加します。](validating-user-credentials-against-the-membership-user-store-cs/_static/image8.png)](validating-user-credentials-against-the-membership-user-store-cs/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="d1bac-185">[![Add a Login Control to the Page](validating-user-credentials-against-the-membership-user-store-cs/_static/image8.png)](validating-user-credentials-against-the-membership-user-store-cs/_static/image7.png)</span></span>

<span data-ttu-id="d1bac-186">**図 3**:Login コントロールをページに追加 ([フルサイズの画像を表示する をクリックします](validating-user-credentials-against-the-membership-user-store-cs/_static/image9.png))。</span><span class="sxs-lookup"><span data-stu-id="d1bac-186">**Figure 3**: Add a Login Control to the Page  ([Click to view full-size image](validating-user-credentials-against-the-membership-user-store-cs/_static/image9.png))</span></span>

<span data-ttu-id="d1bac-187">完了します。</span><span class="sxs-lookup"><span data-stu-id="d1bac-187">And we're done!</span></span> <span data-ttu-id="d1bac-188">ログイン コントロールのログイン ボタンがクリックされたときにポストバックが発生し、Login コントロールが呼び出す、`Membership.ValidateUser`メソッド、入力したユーザー名とパスワードを渡します。</span><span class="sxs-lookup"><span data-stu-id="d1bac-188">When the Login control's Log In button is clicked, a postback will occur and the Login control will call the `Membership.ValidateUser` method, passing in the entered username and password.</span></span> <span data-ttu-id="d1bac-189">資格情報が有効でない場合、Login コントロールには、このようなことを示すメッセージが表示されます。</span><span class="sxs-lookup"><span data-stu-id="d1bac-189">If the credentials are invalid, the Login control displays a message stating such.</span></span> <span data-ttu-id="d1bac-190">ただし、資格情報が有効で場合、Login コントロールは、フォーム認証チケットを作成し、ユーザーを適切なページにリダイレクトします。</span><span class="sxs-lookup"><span data-stu-id="d1bac-190">If, however, the credentials are valid, then the Login control creates the forms authentication ticket and redirects the user to the appropriate page.</span></span>

<span data-ttu-id="d1bac-191">Login コントロールでは、4 つの要因を使って、正常にログインとユーザーをリダイレクトする、適切なページを決定します。</span><span class="sxs-lookup"><span data-stu-id="d1bac-191">The Login control uses four factors to determine the appropriate page to redirect the user to upon a successful login:</span></span>

- <span data-ttu-id="d1bac-192">定義されているのログイン ページで、Login コントロールがかどうかは`loginUrl`この設定の既定値は、フォーム認証の構成の設定 `Login.aspx`</span><span class="sxs-lookup"><span data-stu-id="d1bac-192">Whether the Login control is on the login page as defined by `loginUrl` setting in the forms authentication configuration; this setting's default value is `Login.aspx`</span></span>
- <span data-ttu-id="d1bac-193">有無、 `ReturnUrl` querystring パラメーター</span><span class="sxs-lookup"><span data-stu-id="d1bac-193">The presence of a `ReturnUrl` querystring parameter</span></span>
- <span data-ttu-id="d1bac-194">ログイン コントロールの値[`DestinationUrl`プロパティ](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.destinationpageurl.aspx)</span><span class="sxs-lookup"><span data-stu-id="d1bac-194">The value of the Login control's [`DestinationUrl` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.destinationpageurl.aspx)</span></span>
- <span data-ttu-id="d1bac-195">`defaultUrl`フォーム認証の構成設定に指定された値は、この設定の既定値は `Default.aspx`</span><span class="sxs-lookup"><span data-stu-id="d1bac-195">The `defaultUrl` value specified in the forms authentication configuration settings; this setting's default value is `Default.aspx`</span></span>

<span data-ttu-id="d1bac-196">図 4 は、方法を示しています、Login コントロールがそのページの適切な意思決定に到着するこれら 4 つのパラメーターを使用します。</span><span class="sxs-lookup"><span data-stu-id="d1bac-196">Figure 4 depicts the how the Login control uses these four parameters to arrive at its appropriate page decision.</span></span>

<span data-ttu-id="d1bac-197">[![Login コントロールをページに追加します。](validating-user-credentials-against-the-membership-user-store-cs/_static/image11.png)](validating-user-credentials-against-the-membership-user-store-cs/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="d1bac-197">[![Add a Login Control to the Page](validating-user-credentials-against-the-membership-user-store-cs/_static/image11.png)](validating-user-credentials-against-the-membership-user-store-cs/_static/image10.png)</span></span>

<span data-ttu-id="d1bac-198">**図 4**:Login コントロールをページに追加 ([フルサイズの画像を表示する をクリックします](validating-user-credentials-against-the-membership-user-store-cs/_static/image12.png))。</span><span class="sxs-lookup"><span data-stu-id="d1bac-198">**Figure 4**: Add a Login Control to the Page  ([Click to view full-size image](validating-user-credentials-against-the-membership-user-store-cs/_static/image12.png))</span></span>

<span data-ttu-id="d1bac-199">ブラウザーを使用してサイトを訪問し、メンバーシップ フレームワークで既存のユーザーとしてログインして、ログイン コントロールをテストする時間がかかります。</span><span class="sxs-lookup"><span data-stu-id="d1bac-199">Take a moment to test out the Login control by visiting the site through a browser and logging in as an existing user in the Membership framework.</span></span>

<span data-ttu-id="d1bac-200">ログイン コントロールのレンダリングされたインターフェイスでは、高度に構成できます。</span><span class="sxs-lookup"><span data-stu-id="d1bac-200">The Login control's rendered interface is highly configurable.</span></span> <span data-ttu-id="d1bac-201">その外観を与えるプロパティのいくつかさらに、Login コントロールがテンプレートのレイアウトを細かく制御する場合にユーザー インターフェイス要素変換することができます。</span><span class="sxs-lookup"><span data-stu-id="d1bac-201">There are a number of properties that influence its appearance; what's more, the Login control can be converted into a template for precise control over the layout the user interface elements.</span></span> <span data-ttu-id="d1bac-202">この手順の残りの部分では、レイアウトと外観をカスタマイズする方法について説明します。</span><span class="sxs-lookup"><span data-stu-id="d1bac-202">The remainder of this step examines how to customize the appearance and layout.</span></span>

### <a name="customizing-the-login-controls-appearance"></a><span data-ttu-id="d1bac-203">ログイン コントロールの外観のカスタマイズ</span><span class="sxs-lookup"><span data-stu-id="d1bac-203">Customizing the Login Control's Appearance</span></span>

<span data-ttu-id="d1bac-204">ログイン コントロールの既定のプロパティ設定のタイトルと共に (ログ) のユーザー インターフェイスをレンダリングする、チェック ボックス、および Log In ボタン、アカウントを記憶 ユーザー名とパスワード入力用テキスト ボックス、およびラベル コントロールが次に時刻します。</span><span class="sxs-lookup"><span data-stu-id="d1bac-204">The Login control's default property settings render a user interface with a title ( Log In ), TextBox and Label controls for the username and password inputs, a Remember me next time CheckBox, and a Log In button.</span></span> <span data-ttu-id="d1bac-205">これらの要素の外観は、ログイン コントロールの多数のプロパティをすべて構成可能です。</span><span class="sxs-lookup"><span data-stu-id="d1bac-205">The appearances of these elements are all configurable through the Login control's numerous properties.</span></span> <span data-ttu-id="d1bac-206">さらに、プロパティ、または 2 つの設定 - 新しいユーザー アカウントを作成するページへのリンクなどの他のユーザー インターフェイス要素を追加できます。</span><span class="sxs-lookup"><span data-stu-id="d1bac-206">Furthermore, additional user interface elements - such as a link to a page to create a new user account - can be added by setting a property or two.</span></span>

<span data-ttu-id="d1bac-207">では、ユーザーのログイン コントロールの外観を増やさずに少しご説明します。</span><span class="sxs-lookup"><span data-stu-id="d1bac-207">Let's spend a few moments to gussy up the appearance of our Login control.</span></span> <span data-ttu-id="d1bac-208">以降、`Login.aspx`ページが既にログインを示すページの上部にあるテキスト、ログイン コントロールのタイトルは不要です。</span><span class="sxs-lookup"><span data-stu-id="d1bac-208">Since the `Login.aspx` page already has text at the top of the page that says Login, the Login control's title is superfluous.</span></span> <span data-ttu-id="d1bac-209">したがって、クリア、 [ `TitleText`プロパティ](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.titletext.aspx)ログイン コントロールのタイトルを削除するには値。</span><span class="sxs-lookup"><span data-stu-id="d1bac-209">Therefore, clear out the [`TitleText` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.titletext.aspx) value in order to remove the Login control's title.</span></span>

<span data-ttu-id="d1bac-210">: ユーザー名とパスワード。2 つの TextBox コントロールの左にラベルをを通じてカスタマイズできる、 [ `UserNameLabelText` ](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.usernamelabeltext.aspx)と[`PasswordLabelText`プロパティ](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.passwordlabeltext.aspx)、それぞれします。</span><span class="sxs-lookup"><span data-stu-id="d1bac-210">The User Name: and Password: Labels to the left of the two TextBox controls can be customized through the [`UserNameLabelText`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.usernamelabeltext.aspx) and [`PasswordLabelText` properties](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.passwordlabeltext.aspx), respectively.</span></span> <span data-ttu-id="d1bac-211">ユーザー名を変更してみましょう。Username を読み取るためのラベル: です。</span><span class="sxs-lookup"><span data-stu-id="d1bac-211">Let's change the User Name: Label to read Username:.</span></span> <span data-ttu-id="d1bac-212">ラベルとテキスト ボックスのスタイルを使用して構成できますが、 [ `LabelStyle` ](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.labelstyle.aspx)と[`TextBoxStyle`プロパティ](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.textboxstyle.aspx)、それぞれします。</span><span class="sxs-lookup"><span data-stu-id="d1bac-212">The Label and TextBox styles are configurable through the [`LabelStyle`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.labelstyle.aspx) and [`TextBoxStyle` properties](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.textboxstyle.aspx), respectively.</span></span>

<span data-ttu-id="d1bac-213">メール アドレス、ログイン コントロールから、[次へ] の時間チェック ボックスの Text プロパティを設定できます[ `RememberMeText property` ](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.remembermetext.aspx)、および既定のチェック状態を使用して構成できますが、 [ `RememberMeSet property` ](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.remembermeset.aspx) (既定値は False)。</span><span class="sxs-lookup"><span data-stu-id="d1bac-213">The Remember me next time CheckBox's Text property can be set through the Login control's [`RememberMeText property`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.remembermetext.aspx), and its default checked state is configurable through the [`RememberMeSet property`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.remembermeset.aspx) (which defaults to False).</span></span> <span data-ttu-id="d1bac-214">さあ、設定、`RememberMeSet`プロパティをチェック ボックスを次にときにアカウントを記憶する を True には、既定でチェックします。</span><span class="sxs-lookup"><span data-stu-id="d1bac-214">Go ahead and set the `RememberMeSet` property to True so that the Remember me next time CheckBox will be checked by default.</span></span>

<span data-ttu-id="d1bac-215">Login コントロールは、そのユーザー インターフェイス コントロールのレイアウトを調整するための 2 つのプロパティを提供します。</span><span class="sxs-lookup"><span data-stu-id="d1bac-215">The Login control offers two properties for adjusting the layout of its user interface controls.</span></span> <span data-ttu-id="d1bac-216">[ `TextLayout property` ](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.textlayout.aspx)を示すかどうか、ユーザー名: とパスワード。左側の対応するテキスト ボックス (既定)、または上にラベルが表示されます。</span><span class="sxs-lookup"><span data-stu-id="d1bac-216">The [`TextLayout property`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.textlayout.aspx) indicates whether the Username: and Password: Labels appear to the left of their corresponding TextBoxes (the default), or above them.</span></span> <span data-ttu-id="d1bac-217">[ `Orientation property` ](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.orientation.aspx)ユーザー名とパスワードの入力が垂直方向に設置されているかどうかを示します (上、もう 1 つ) または水平方向にします。</span><span class="sxs-lookup"><span data-stu-id="d1bac-217">The [`Orientation property`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.orientation.aspx) indicates whether the username and password inputs are situated vertically (one above the other) or horizontally.</span></span> <span data-ttu-id="d1bac-218">これら 2 つのプロパティには既定では、設定のままにしますが、ぜひこれら 2 つのプロパティを結果として得られる効果を表示する、既定以外の値に設定してください。</span><span class="sxs-lookup"><span data-stu-id="d1bac-218">I am going to leave these two properties set to their defaults, but I encourage you to try setting these two properties to their non-default values to see the resulting effect.</span></span>

> [!NOTE]
> <span data-ttu-id="d1bac-219">次のセクションで、ログイン コントロールのレイアウトを構成するに注目レイアウト コントロールのユーザー インターフェイス要素の正確なレイアウトを定義するテンプレートを使用します。</span><span class="sxs-lookup"><span data-stu-id="d1bac-219">In the next section, Configuring the Login Control's Layout, we will look at using templates to define the precise layout of the Layout control's user interface elements.</span></span>

<span data-ttu-id="d1bac-220">設定して、ログイン コントロールのプロパティの設定をまとめ、 [ `CreateUserText` ](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.createusertext.aspx)と[`CreateUserUrl`プロパティ](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.createuserurl.aspx)にまだ登録されていませんか?</span><span class="sxs-lookup"><span data-stu-id="d1bac-220">Wrap up the Login control's property settings by setting the [`CreateUserText`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.createusertext.aspx) and [`CreateUserUrl` properties](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.createuserurl.aspx) to Not registered yet?</span></span> <span data-ttu-id="d1bac-221">アカウントを作成します。</span><span class="sxs-lookup"><span data-stu-id="d1bac-221">Create an account!</span></span> <span data-ttu-id="d1bac-222">`~/Membership/CreatingUserAccounts.aspx`、それぞれします。</span><span class="sxs-lookup"><span data-stu-id="d1bac-222">and `~/Membership/CreatingUserAccounts.aspx`, respectively.</span></span> <span data-ttu-id="d1bac-223">これで作成したページを指す、ログイン コントロールのインターフェイスにハイパーリンクを追加、 <a id="SKM6"> </a>[前のチュートリアル](creating-user-accounts-cs.md)します。</span><span class="sxs-lookup"><span data-stu-id="d1bac-223">This adds a hyperlink to the Login control's interface pointing to the page we created in the <a id="SKM6"></a>[preceding tutorial](creating-user-accounts-cs.md).</span></span> <span data-ttu-id="d1bac-224">ログイン コントロールの[ `HelpPageText` ](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.helppagetext.aspx)と[`HelpPageUrl`プロパティ](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.helppageurl.aspx)と[ `PasswordRecoveryText` ](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.passwordrecoverytext.aspx)と[ `PasswordRecoveryUrl` プロパティ](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.passwordrecoveryurl.aspx)ヘルプ ページと、パスワード回復ページへのリンクを表示、同じ方法で作業します。</span><span class="sxs-lookup"><span data-stu-id="d1bac-224">The Login control's [`HelpPageText`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.helppagetext.aspx) and [`HelpPageUrl` properties](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.helppageurl.aspx) and [`PasswordRecoveryText`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.passwordrecoverytext.aspx) and [`PasswordRecoveryUrl` properties](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.passwordrecoveryurl.aspx) work in the same manner, rendering links to a help page and a password recovery page.</span></span>

<span data-ttu-id="d1bac-225">これらのプロパティの変更を行った後、ログイン コントロールの宣言型マークアップと外観のようなります図 5 に示されています。</span><span class="sxs-lookup"><span data-stu-id="d1bac-225">After making these property changes, your Login control's declarative markup and appearance should look similar to that shown in Figure 5.</span></span>

<span data-ttu-id="d1bac-226">[![ログイン コントロールのプロパティの値の外観を決定します。](validating-user-credentials-against-the-membership-user-store-cs/_static/image14.png)](validating-user-credentials-against-the-membership-user-store-cs/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="d1bac-226">[![The Login Control's Properties' Values Dictate Its Appearance](validating-user-credentials-against-the-membership-user-store-cs/_static/image14.png)](validating-user-credentials-against-the-membership-user-store-cs/_static/image13.png)</span></span>

<span data-ttu-id="d1bac-227">**図 5**:外観をディクテーション ログイン コントロールのプロパティの値 ([フルサイズの画像を表示する をクリックします](validating-user-credentials-against-the-membership-user-store-cs/_static/image15.png))。</span><span class="sxs-lookup"><span data-stu-id="d1bac-227">**Figure 5**: The Login Control's Properties' Values Dictate Its Appearance  ([Click to view full-size image](validating-user-credentials-against-the-membership-user-store-cs/_static/image15.png))</span></span>

### <a name="configuring-the-login-controls-layout"></a><span data-ttu-id="d1bac-228">ログイン コントロールのレイアウトを構成します。</span><span class="sxs-lookup"><span data-stu-id="d1bac-228">Configuring the Login Control's Layout</span></span>

<span data-ttu-id="d1bac-229">ログイン Web コントロールの既定のユーザー インターフェイスを html インターフェイス レイアウト`<table>`します。</span><span class="sxs-lookup"><span data-stu-id="d1bac-229">The Login Web control's default user interface lays out the interface in an HTML `<table>`.</span></span> <span data-ttu-id="d1bac-230">しかしレンダリングされた出力をより細かく制御が必要な場合でしょうか。</span><span class="sxs-lookup"><span data-stu-id="d1bac-230">But what if we need finer control over the rendered output?</span></span> <span data-ttu-id="d1bac-231">置換することができます、`<table>`は一連の`<div>`タグ。</span><span class="sxs-lookup"><span data-stu-id="d1bac-231">Maybe we want to replace the `<table>` with a series of `<div>` tags.</span></span> <span data-ttu-id="d1bac-232">または、アプリケーションが認証の追加の資格情報に必要な場合でしょうか。</span><span class="sxs-lookup"><span data-stu-id="d1bac-232">Or what if our application requires additional credentials for authentication?</span></span> <span data-ttu-id="d1bac-233">多くの財務 web サイトには、ユーザーだけでなく、ユーザー名とパスワードも個人識別番号 (PIN)、または他の識別情報を指定するなどが必要です。</span><span class="sxs-lookup"><span data-stu-id="d1bac-233">Many financial websites, for instance, require users to supply not only a username and password, but also a Personal Identification Number (PIN), or other identifying information.</span></span> <span data-ttu-id="d1bac-234">任意理由かもしれませんがが Login コントロールにテンプレートを明示的に定義できます、インターフェイスの宣言型マークアップを変換します。</span><span class="sxs-lookup"><span data-stu-id="d1bac-234">Whatever the reasons may be, it is possible to convert the Login control into a template, from which we can explicitly define the interface's declarative markup.</span></span>

<span data-ttu-id="d1bac-235">追加の資格情報を収集するログイン コントロールを更新するには 2 つの作業を行う必要があります。</span><span class="sxs-lookup"><span data-stu-id="d1bac-235">We need to do two things in order to update the Login control to collect additional credentials:</span></span>

1. <span data-ttu-id="d1bac-236">含める追加の資格情報を収集する Web コントロール、ログイン コントロールのインターフェイスを更新します。</span><span class="sxs-lookup"><span data-stu-id="d1bac-236">Update the Login control's interface to include Web control(s) to collect the additional credentials.</span></span>
2. <span data-ttu-id="d1bac-237">ユーザー名とパスワードが有効とその他の資格情報が有効ですぎる場合にのみ、ユーザーが認証されるように、ログイン コントロールの内部の認証ロジックをオーバーライドします。</span><span class="sxs-lookup"><span data-stu-id="d1bac-237">Override the Login control's internal authentication logic so that a user is only authenticated if their username and password is valid and their additional credentials are valid, too.</span></span>

<span data-ttu-id="d1bac-238">最初のタスクを実行するには、ログイン コントロールをテンプレートに変換し、必要な Web コントロールを追加する必要があります。</span><span class="sxs-lookup"><span data-stu-id="d1bac-238">To accomplish the first task, we need to convert the Login control into a template and add the necessary Web controls.</span></span> <span data-ttu-id="d1bac-239">2 番目のタスクとは、コントロールのイベント ハンドラーを作成して、ログイン コントロールの認証ロジックが優先されることが[`Authenticate`イベント](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.authenticate.aspx)します。</span><span class="sxs-lookup"><span data-stu-id="d1bac-239">As for the second task, the Login control's authentication logic can be superseded by creating an event handler for the control's [`Authenticate` event](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.authenticate.aspx).</span></span>

<span data-ttu-id="d1bac-240">指定された電子メール アドレス、電子メール アドレス宛に一致する場合にのみユーザーを認証し、ユーザー名、パスワード、および電子メール アドレスのユーザー入力を求めるようにしてみましょう Login コントロールを更新します。</span><span class="sxs-lookup"><span data-stu-id="d1bac-240">Let's update the Login control so that it prompts users for their username, password, and email address and only authenticates the user if the email address supplied matches their email address on file.</span></span> <span data-ttu-id="d1bac-241">まず、ログイン コントロールのインターフェイスをテンプレートに変換する必要があります。</span><span class="sxs-lookup"><span data-stu-id="d1bac-241">We first need to convert the Login control's interface to a template.</span></span> <span data-ttu-id="d1bac-242">ログイン コントロールのスマート タグから変換テンプレート オプションを選択します。</span><span class="sxs-lookup"><span data-stu-id="d1bac-242">From the Login control's Smart Tag, choose the Convert to template option.</span></span>

<span data-ttu-id="d1bac-243">[![Login コントロールをテンプレートに変換します。](validating-user-credentials-against-the-membership-user-store-cs/_static/image17.png)](validating-user-credentials-against-the-membership-user-store-cs/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="d1bac-243">[![Convert the Login Control to a Template](validating-user-credentials-against-the-membership-user-store-cs/_static/image17.png)](validating-user-credentials-against-the-membership-user-store-cs/_static/image16.png)</span></span>

<span data-ttu-id="d1bac-244">**図 6**:Login コントロールをテンプレートに変換 ([フルサイズの画像を表示する をクリックします](validating-user-credentials-against-the-membership-user-store-cs/_static/image18.png))。</span><span class="sxs-lookup"><span data-stu-id="d1bac-244">**Figure 6**: Convert the Login Control to a Template  ([Click to view full-size image](validating-user-credentials-against-the-membership-user-store-cs/_static/image18.png))</span></span>

> [!NOTE]
> <span data-ttu-id="d1bac-245">Login コントロールの template 前のバージョンに戻すには、コントロールのスマート タグからのリセット リンクをクリックします。</span><span class="sxs-lookup"><span data-stu-id="d1bac-245">To revert the Login control to its pre-template version, click the Reset link from the control's Smart Tag.</span></span>

<span data-ttu-id="d1bac-246">Login コントロールをテンプレートに変換を追加、 `LayoutTemplate` HTML 要素およびユーザー インターフェイスを定義する Web コントロールを使用するコントロールの宣言型マークアップにします。</span><span class="sxs-lookup"><span data-stu-id="d1bac-246">Converting the Login control to a template adds a `LayoutTemplate` to the control's declarative markup with HTML elements and Web controls defining the user interface.</span></span> <span data-ttu-id="d1bac-247">図 7 に示すようコントロールをテンプレートに変換するさまざまなプロパティから削除プロパティ ウィンドウなど`TitleText`、`CreateUserUrl`などのように、ため、テンプレートを使用する場合、これらのプロパティ値は無視されます。</span><span class="sxs-lookup"><span data-stu-id="d1bac-247">As Figure 7 shows, converting the control to a template removes a number of properties from the Properties window, such as `TitleText`, `CreateUserUrl`, and so forth, since these property values are ignored when using a template.</span></span>

<span data-ttu-id="d1bac-248">[![以下のプロパティは、使用可能なときのログイン コントロールがテンプレートに変換されます。](validating-user-credentials-against-the-membership-user-store-cs/_static/image20.png)](validating-user-credentials-against-the-membership-user-store-cs/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="d1bac-248">[![Fewer Properties are Available When the Login Control is Converted to a Template](validating-user-credentials-against-the-membership-user-store-cs/_static/image20.png)](validating-user-credentials-against-the-membership-user-store-cs/_static/image19.png)</span></span>

<span data-ttu-id="d1bac-249">**図 7**:以下のプロパティは、使用可能なときのログイン コントロールがテンプレートに変換されます ([フルサイズの画像を表示する をクリックします](validating-user-credentials-against-the-membership-user-store-cs/_static/image21.png))。</span><span class="sxs-lookup"><span data-stu-id="d1bac-249">**Figure 7**: Fewer Properties are Available When the Login Control is Converted to a Template  ([Click to view full-size image](validating-user-credentials-against-the-membership-user-store-cs/_static/image21.png))</span></span>

<span data-ttu-id="d1bac-250">内の HTML マークアップ、`LayoutTemplate`必要に応じて変更することがあります。</span><span class="sxs-lookup"><span data-stu-id="d1bac-250">The HTML markup in the `LayoutTemplate` may be modified as needed.</span></span> <span data-ttu-id="d1bac-251">同様に、自由にテンプレートに新しい Web コントロールを追加します。</span><span class="sxs-lookup"><span data-stu-id="d1bac-251">Likewise, feel free to add any new Web controls to the template.</span></span> <span data-ttu-id="d1bac-252">ただし、重要なは、そのログイン コントロールのコア Web コントロールがテンプレートに保持され、割り当てられた保持は`ID`値。</span><span class="sxs-lookup"><span data-stu-id="d1bac-252">However, it is important that Login control's core Web controls remain in the template and keep their assigned `ID` values.</span></span> <span data-ttu-id="d1bac-253">具体的には、削除したりしないでの名前を変更、`UserName`または`Password`、テキスト ボックス、`RememberMe`チェック ボックスをオン、 `LoginButton`  ボタン、`FailureText`ラベル、または`RequiredFieldValidator`コントロール。</span><span class="sxs-lookup"><span data-stu-id="d1bac-253">In particular, do not remove or rename the `UserName` or `Password` TextBoxes, the `RememberMe` CheckBox, the `LoginButton` Button, the `FailureText` Label, or the `RequiredFieldValidator` controls.</span></span>

<span data-ttu-id="d1bac-254">訪問者の電子メール アドレスを収集するには、テンプレートにテキスト ボックスを追加する必要があります。</span><span class="sxs-lookup"><span data-stu-id="d1bac-254">To collect the visitor's email address, we need to add a TextBox to the template.</span></span> <span data-ttu-id="d1bac-255">テーブルの行の間で次の宣言型マークアップを追加 (`<tr>`) を格納している、 `Password` TextBox およびアカウントを記憶する を次に保持するテーブルの行の時間をチェック ボックスをオンします。</span><span class="sxs-lookup"><span data-stu-id="d1bac-255">Add the following declarative markup between the table row (`<tr>`) that contains the `Password` TextBox and the table row that holds the Remember me next time CheckBox:</span></span>

[!code-aspx[Main](validating-user-credentials-against-the-membership-user-store-cs/samples/sample2.aspx)]

<span data-ttu-id="d1bac-256">追加した後、 `Email`  ボックスに、ブラウザーを使用してページを参照してください。</span><span class="sxs-lookup"><span data-stu-id="d1bac-256">After adding the `Email` TextBox, visit the page through a browser.</span></span> <span data-ttu-id="d1bac-257">図 8 に示すよう、ログイン コントロールのユーザー インターフェイスの 3 つ目のテキスト ボックスに追加されました。</span><span class="sxs-lookup"><span data-stu-id="d1bac-257">As Figure 8 shows, the Login control's user interface now includes a third textbox.</span></span>

<span data-ttu-id="d1bac-258">[![Login コントロールのユーザーの電子メール アドレス テキスト ボックスになりました](validating-user-credentials-against-the-membership-user-store-cs/_static/image23.png)](validating-user-credentials-against-the-membership-user-store-cs/_static/image22.png)</span><span class="sxs-lookup"><span data-stu-id="d1bac-258">[![The Login Control Now Includes a Textbox for the User's Email Address](validating-user-credentials-against-the-membership-user-store-cs/_static/image23.png)](validating-user-credentials-against-the-membership-user-store-cs/_static/image22.png)</span></span>

<span data-ttu-id="d1bac-259">**図 8**:Login コントロールのユーザーの電子メール アドレス テキスト ボックスになりました ([フルサイズの画像を表示する をクリックします](validating-user-credentials-against-the-membership-user-store-cs/_static/image24.png))。</span><span class="sxs-lookup"><span data-stu-id="d1bac-259">**Figure 8**: The Login Control Now Includes a Textbox for the User's Email Address  ([Click to view full-size image](validating-user-credentials-against-the-membership-user-store-cs/_static/image24.png))</span></span>

<span data-ttu-id="d1bac-260">この時点では、Login コントロールがまだを使用して、`Membership.ValidateUser`指定された資格情報を検証するメソッド。</span><span class="sxs-lookup"><span data-stu-id="d1bac-260">At this point, the Login control is still using the `Membership.ValidateUser` method to validate the supplied credentials.</span></span> <span data-ttu-id="d1bac-261">値が同様に、入力、 `Email` TextBox は、ユーザーがログインできるかどうかに影響を与えません。</span><span class="sxs-lookup"><span data-stu-id="d1bac-261">Correspondingly, the value entered into the `Email` TextBox has no bearing on whether the user can log in.</span></span> <span data-ttu-id="d1bac-262">手順 3 では、資格情報、ユーザー名とパスワードが有効とファイルの電子メール アドレスが一致する指定した電子メール アドレスの場合有効と見なされるのみログイン コントロールの認証ロジックをオーバーライドする方法に注目します。</span><span class="sxs-lookup"><span data-stu-id="d1bac-262">In Step 3 we will look at how to override the Login control's authentication logic so that the credentials are only considered valid if the username and password are valid and the supplied email address matches up with the email address on file.</span></span>

## <a name="step-3-modifying-the-login-controls-authentication-logic"></a><span data-ttu-id="d1bac-263">手順 3: ログイン コントロールの認証ロジックを変更します。</span><span class="sxs-lookup"><span data-stu-id="d1bac-263">Step 3: Modifying the Login Control's Authentication Logic</span></span>

<span data-ttu-id="d1bac-264">彼女の訪問者を指定すると、数回のクリック、[ログイン] ボタン、ポストバックに陥ります、ログインの資格情報、認証ワークフローの進捗状況を制御します。</span><span class="sxs-lookup"><span data-stu-id="d1bac-264">When a visitor supplies her credentials and clicks the Log In button, a postback ensues and the Login control progresses through its authentication workflow.</span></span> <span data-ttu-id="d1bac-265">ワークフローを開始することで、 [ `LoggingIn`イベント](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.loggingin.aspx)します。</span><span class="sxs-lookup"><span data-stu-id="d1bac-265">The workflow starts by raising the [`LoggingIn` event](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.loggingin.aspx).</span></span> <span data-ttu-id="d1bac-266">このイベントに関連付けられたイベント ハンドラーを設定して操作のログを取り消すことが、`e.Cancel`プロパティを`true`します。</span><span class="sxs-lookup"><span data-stu-id="d1bac-266">Any event handlers associated with this event may cancel the log in operation by setting the `e.Cancel` property to `true`.</span></span>

<span data-ttu-id="d1bac-267">発生させることによって、ワークフローの進行の操作のログがキャンセルされない場合、 [ `Authenticate`イベント](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.authenticate.aspx)します。</span><span class="sxs-lookup"><span data-stu-id="d1bac-267">If the log in operation is not cancelled, the workflow progresses by raising the [`Authenticate` event](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.authenticate.aspx).</span></span> <span data-ttu-id="d1bac-268">イベント ハンドラーがある場合、`Authenticate`イベント、されますか、指定された資格情報が有効かどうかを判断する責任を負います。</span><span class="sxs-lookup"><span data-stu-id="d1bac-268">If there is an event handler for the `Authenticate` event, then it is responsible for determining whether the supplied credentials are valid or not.</span></span> <span data-ttu-id="d1bac-269">Login コントロールを使用してイベント ハンドラーが指定されていない場合、`Membership.ValidateUser`資格情報の有効性を判断するメソッド。</span><span class="sxs-lookup"><span data-stu-id="d1bac-269">If no event handler is specified, the Login control uses the `Membership.ValidateUser` method to determine the validity of the credentials.</span></span>

<span data-ttu-id="d1bac-270">指定された資格情報は、有効なかどうかは、フォーム認証チケットを作成すると、 [ `LoggedIn`イベント](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.loggedin.aspx)が発生し、ユーザーは、適切なページにリダイレクトされます。</span><span class="sxs-lookup"><span data-stu-id="d1bac-270">If the supplied credentials are valid, then the forms authentication ticket is created, the [`LoggedIn` event](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.loggedin.aspx) is raised, and the user is redirected to the appropriate page.</span></span> <span data-ttu-id="d1bac-271">ただし、資格情報と見なされる、無効な場合は、 [ `LoginError`イベント](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.loginerror.aspx)が発生し、自分の資格情報が有効なされていないことをユーザーに通知メッセージが表示されます。</span><span class="sxs-lookup"><span data-stu-id="d1bac-271">If, however, the credentials are deemed invalid, then the [`LoginError` event](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.loginerror.aspx) is raised and a message is displayed informing the user that their credentials were invalid.</span></span> <span data-ttu-id="d1bac-272">既定では、失敗した場合、ログイン コントロールだけを設定、 `FailureText` (ログインの試行に失敗しましたエラー メッセージをコントロールのテキスト プロパティ ラベルします。</span><span class="sxs-lookup"><span data-stu-id="d1bac-272">By default, on failure the Login control simply sets its `FailureText` Label control's Text property to a failure message ( Your login attempt was not successful.</span></span> <span data-ttu-id="d1bac-273">もう一度やり直してください)。</span><span class="sxs-lookup"><span data-stu-id="d1bac-273">Please try again ).</span></span> <span data-ttu-id="d1bac-274">ただし場合、ログイン コントロールの[`FailureAction`プロパティ](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.failureaction.aspx)に設定されている`RedirectToLoginPage`、ログイン管理の問題から、`Response.Redirect`クエリ文字列パラメーターを追加するログイン ページに`loginfailure=1`(これにより、ログインコントロールをエラー メッセージを表示する)。</span><span class="sxs-lookup"><span data-stu-id="d1bac-274">However, if the Login control's [`FailureAction` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.failureaction.aspx) is set to `RedirectToLoginPage`, then the Login control issues a `Response.Redirect` to the login page appending the querystring parameter `loginfailure=1` (which causes the Login control to display the failure message).</span></span>

<span data-ttu-id="d1bac-275">図 9 には、認証ワークフローのフロー チャートが用意されています。</span><span class="sxs-lookup"><span data-stu-id="d1bac-275">Figure 9 offers a flow chart of the authentication workflow.</span></span>

<span data-ttu-id="d1bac-276">[![ログイン コントロールの認証ワークフロー](validating-user-credentials-against-the-membership-user-store-cs/_static/image26.png)](validating-user-credentials-against-the-membership-user-store-cs/_static/image25.png)</span><span class="sxs-lookup"><span data-stu-id="d1bac-276">[![The Login Control's Authentication Workflow](validating-user-credentials-against-the-membership-user-store-cs/_static/image26.png)](validating-user-credentials-against-the-membership-user-store-cs/_static/image25.png)</span></span>

<span data-ttu-id="d1bac-277">**図 9**:ログイン コントロールの認証ワークフロー ([フルサイズの画像を表示する をクリックします](validating-user-credentials-against-the-membership-user-store-cs/_static/image27.png))。</span><span class="sxs-lookup"><span data-stu-id="d1bac-277">**Figure 9**: The Login Control's Authentication Workflow  ([Click to view full-size image](validating-user-credentials-against-the-membership-user-store-cs/_static/image27.png))</span></span>

> [!NOTE]
> <span data-ttu-id="d1bac-278">使用する場合を迷っている場合、`FailureAction`の`RedirectToLogin`オプションのページで、次のシナリオを検討してください。</span><span class="sxs-lookup"><span data-stu-id="d1bac-278">If you are wondering when you would use the `FailureAction`'s `RedirectToLogin` page option, consider the following scenario.</span></span> <span data-ttu-id="d1bac-279">今すぐ、`Site.master`マスター ページは、現在、こんにちは、よそ者に表示されるテキスト、匿名ユーザーに表示したときに、左側の列をいますが、ログイン コントロールでそのテキストを置き換えますしたいことを想像してください。</span><span class="sxs-lookup"><span data-stu-id="d1bac-279">Right now our `Site.master` master page currently has the text, Hello, stranger displayed in the left column when visited by an anonymous user, but imagine that we wanted to replace that text with a Login control.</span></span> <span data-ttu-id="d1bac-280">匿名ユーザーがログイン ページに直接アクセスを必要とするのではなく、サイトの任意のページからのログインをこのようにするとします。</span><span class="sxs-lookup"><span data-stu-id="d1bac-280">This would allow an anonymous user to log in from any page on the site, instead of requiring them to visit the login page directly.</span></span> <span data-ttu-id="d1bac-281">ただし、ユーザーは、マスター ページでレンダリングのログイン コントロールを使用してログインできなくなりますが場合、有意義なことをログイン ページにリダイレクトする (`Login.aspx`) そのページの可能性には、その他については、リンク、およびリンクを作成するなどの他のヘルプが含まれているため、新しいアカウントまたはマスター ページに追加されませんでした - 紛失のパスワードを取得します。</span><span class="sxs-lookup"><span data-stu-id="d1bac-281">However, if a user was unable to log in via the Login control rendered by the master page, it might make sense to redirect them to the login page (`Login.aspx`) because that page likely includes additional instructions, links, and other help - such as links to create a new account or retrieve a lost password - that were not added to the master page.</span></span>

### <a name="creating-theauthenticateevent-handler"></a><span data-ttu-id="d1bac-282">作成、`Authenticate`イベント ハンドラー</span><span class="sxs-lookup"><span data-stu-id="d1bac-282">Creating the`Authenticate`Event Handler</span></span>

<span data-ttu-id="d1bac-283">ログイン コントロールのイベント ハンドラーを作成する、カスタム認証ロジックをプラグインするために`Authenticate`イベント。</span><span class="sxs-lookup"><span data-stu-id="d1bac-283">In order to plug in our custom authentication logic, we need to create an event handler for the Login control's `Authenticate` event.</span></span> <span data-ttu-id="d1bac-284">イベント ハンドラーの作成、`Authenticate`イベントは、次のイベント ハンドラーの定義を生成します。</span><span class="sxs-lookup"><span data-stu-id="d1bac-284">Creating an event handler for the `Authenticate` event will generate the following event handler definition:</span></span>

[!code-csharp[Main](validating-user-credentials-against-the-membership-user-store-cs/samples/sample3.cs)]

<span data-ttu-id="d1bac-285">ご覧のとおり、`Authenticate`イベント ハンドラーの型のオブジェクトが渡される[ `AuthenticateEventArgs` ](https://msdn.microsoft.com/library/system.web.ui.webcontrols.authenticateeventargs.aspx) 2 番目の入力パラメーターとして。</span><span class="sxs-lookup"><span data-stu-id="d1bac-285">As you can see, the `Authenticate` event handler is passed an object of type [`AuthenticateEventArgs`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.authenticateeventargs.aspx) as its second input parameter.</span></span> <span data-ttu-id="d1bac-286">`AuthenticateEventArgs`クラスには、という名前のブール型プロパティが含まれています。`Authenticated`指定された資格情報が有効かどうかを指定するために使用されます。</span><span class="sxs-lookup"><span data-stu-id="d1bac-286">The `AuthenticateEventArgs` class contains a Boolean property named `Authenticated` that is used to specify whether the supplied credentials are valid.</span></span> <span data-ttu-id="d1bac-287">このタスクは、か、指定された資格情報が有効かどうかを決定します。 コードをここで記述し、を設定する、`e.Authenticate`プロパティに応じて。</span><span class="sxs-lookup"><span data-stu-id="d1bac-287">Our task, then, is to write code here that determines whether the supplied credentials are valid or not, and to set the `e.Authenticate` property accordingly.</span></span>

### <a name="determining-and-validating-the-supplied-credentials"></a><span data-ttu-id="d1bac-288">決定し、指定された資格情報を検証しています</span><span class="sxs-lookup"><span data-stu-id="d1bac-288">Determining and Validating the Supplied Credentials</span></span>

<span data-ttu-id="d1bac-289">使用して、ログイン コントロールの[ `UserName` ](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.username.aspx)と[`Password`プロパティ](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.password.aspx)をユーザーが入力したユーザー名とパスワードの資格情報を確認します。</span><span class="sxs-lookup"><span data-stu-id="d1bac-289">Use the Login control's [`UserName`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.username.aspx) and [`Password` properties](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.password.aspx) to determine the username and password credentials entered by the user.</span></span> <span data-ttu-id="d1bac-290">Web コントロールに入力された値を決定するために (など、`Email`テキスト ボックスに、前の手順で追加された) を使用して*`LoginControlID`* `.FindControl`("*`controlID`*") を取得するプログラムへの参照 Web コントロール テンプレートを持つ`ID`プロパティは等しく *`controlID`* します。</span><span class="sxs-lookup"><span data-stu-id="d1bac-290">In order to determine the values entered into any additional Web controls (such as the `Email` TextBox we added in the previous step), use *`LoginControlID`*`.FindControl`("*`controlID`*") to obtain a programmatic reference to the Web control in the template whose `ID` property is equal to *`controlID`*.</span></span> <span data-ttu-id="d1bac-291">参照を取得する例を`Email` ボックスに、次のコードを使用します。</span><span class="sxs-lookup"><span data-stu-id="d1bac-291">For example, to get a reference to the `Email` TextBox, use the following code:</span></span>

`TextBox EmailTextBox = myLogin.FindControl("Email") as TextBox;`

<span data-ttu-id="d1bac-292">ユーザーの資格情報を検証するためには、2 つの作業を行う必要があります。</span><span class="sxs-lookup"><span data-stu-id="d1bac-292">In order to validate the user's credentials we need to do two things:</span></span>

1. <span data-ttu-id="d1bac-293">指定されたユーザー名とパスワードが有効であることを確認します。</span><span class="sxs-lookup"><span data-stu-id="d1bac-293">Ensure that the provided username and password are valid</span></span>
2. <span data-ttu-id="d1bac-294">入力した電子メール アドレスがログインしようとしてください。 ユーザーのファイルの電子メール アドレスと一致することを確認します。</span><span class="sxs-lookup"><span data-stu-id="d1bac-294">Ensure that email address entered matches the email address on file for the user attempting to log in</span></span>

<span data-ttu-id="d1bac-295">使用できる最初のチェックを実行する、`Membership.ValidateUser`メソッド手順 1. で説明したようにします。</span><span class="sxs-lookup"><span data-stu-id="d1bac-295">To accomplish the first check we can simply use the `Membership.ValidateUser` method like we saw in Step 1.</span></span> <span data-ttu-id="d1bac-296">2 番目のチェックでは、TextBox コントロールに入力した電子メール アドレスにこれと比較できるように、ユーザーの電子メール アドレスを決定する必要があります。</span><span class="sxs-lookup"><span data-stu-id="d1bac-296">For the second check, we need to determine the user's email address so that we can compare it to the email address they entered into the TextBox control.</span></span> <span data-ttu-id="d1bac-297">特定のユーザーに関する情報を取得する、`Membership`クラスの[`GetUser`メソッド](https://msdn.microsoft.com/library/system.web.security.membership.getuser.aspx)します。</span><span class="sxs-lookup"><span data-stu-id="d1bac-297">To get information about a particular user, use the `Membership` class's [`GetUser` method](https://msdn.microsoft.com/library/system.web.security.membership.getuser.aspx).</span></span>

<span data-ttu-id="d1bac-298">`GetUser`メソッドがオーバー ロードの数。</span><span class="sxs-lookup"><span data-stu-id="d1bac-298">The `GetUser` method has a number of overloads.</span></span> <span data-ttu-id="d1bac-299">すべてのパラメーターに渡されずに使用する場合は、現在ログインしているユーザーに関する情報を返します。</span><span class="sxs-lookup"><span data-stu-id="d1bac-299">If used without passing in any parameters, it returns information about the currently logged in user.</span></span> <span data-ttu-id="d1bac-300">特定のユーザーに関する情報を取得するには、呼び出す`GetUser`ユーザー名を渡します。</span><span class="sxs-lookup"><span data-stu-id="d1bac-300">To get information about a particular user, call `GetUser` passing in their username.</span></span> <span data-ttu-id="d1bac-301">どちらの方法でも、`GetUser`を返します、 [ `MembershipUser`オブジェクト](https://msdn.microsoft.com/library/system.web.security.membershipuser.aspx)などのプロパティを持つ`UserName`、 `Email`、 `IsApproved`、`IsOnline`など。</span><span class="sxs-lookup"><span data-stu-id="d1bac-301">Either way, `GetUser` returns a [`MembershipUser` object](https://msdn.microsoft.com/library/system.web.security.membershipuser.aspx), which has properties like `UserName`, `Email`, `IsApproved`, `IsOnline`, and so on.</span></span>

<span data-ttu-id="d1bac-302">次のコードでは、これら 2 つのチェックを実装します。</span><span class="sxs-lookup"><span data-stu-id="d1bac-302">The following code implements these two checks.</span></span> <span data-ttu-id="d1bac-303">次の両方の成功した場合`e.Authenticate`に設定されている`true`、それ以外の場合、割り当てられている`false`。</span><span class="sxs-lookup"><span data-stu-id="d1bac-303">If both pass, then `e.Authenticate` is set to `true`, otherwise it is assigned `false`.</span></span>

[!code-csharp[Main](validating-user-credentials-against-the-membership-user-store-cs/samples/sample4.cs)]

<span data-ttu-id="d1bac-304">このコードでは、適切なユーザー名、パスワード、および電子メール アドレスを入力する、有効なユーザーとしてログインを試みます。</span><span class="sxs-lookup"><span data-stu-id="d1bac-304">With this code in place, attempt to log in as a valid user, entering the correct username, password, and email address.</span></span> <span data-ttu-id="d1bac-305">もう一度お試しくださいがこの時間は意図的に正しくない電子メール アドレスを使用して (図 10 参照)。</span><span class="sxs-lookup"><span data-stu-id="d1bac-305">Try it again, but this time purposefully use an incorrect email address (see Figure 10).</span></span> <span data-ttu-id="d1bac-306">最後に、試して、存在しないユーザー名を使用して 3 回目です。</span><span class="sxs-lookup"><span data-stu-id="d1bac-306">Finally, try it a third time using a non-existent username.</span></span> <span data-ttu-id="d1bac-307">最初のケースでする必要がありますが正常にログオンして、サイトが最後の 2 つの場合、ログイン コントロールの無効な資格情報のメッセージが表示されます。</span><span class="sxs-lookup"><span data-stu-id="d1bac-307">In the first case you should be successfully logged on to the site, but in the last two cases you should see the Login control's invalid credentials message.</span></span>

<span data-ttu-id="d1bac-308">[![Tito が正しくない電子メール アドレスを指定するときにログインできません。](validating-user-credentials-against-the-membership-user-store-cs/_static/image29.png)](validating-user-credentials-against-the-membership-user-store-cs/_static/image28.png)</span><span class="sxs-lookup"><span data-stu-id="d1bac-308">[![Tito Cannot Log In When Supplying an Incorrect Email Address](validating-user-credentials-against-the-membership-user-store-cs/_static/image29.png)](validating-user-credentials-against-the-membership-user-store-cs/_static/image28.png)</span></span>

<span data-ttu-id="d1bac-309">**図 10**:Tito ことはできませんログのときに指定が正しくない電子メール アドレス ([フルサイズの画像を表示する をクリックします](validating-user-credentials-against-the-membership-user-store-cs/_static/image30.png))。</span><span class="sxs-lookup"><span data-stu-id="d1bac-309">**Figure 10**: Tito Cannot Log In When Supplying an Incorrect Email Address  ([Click to view full-size image](validating-user-credentials-against-the-membership-user-store-cs/_static/image30.png))</span></span>

> [!NOTE]
> <span data-ttu-id="d1bac-310">手順 1 で、方法、メンバーシップ フレームワークを処理無効なログイン試行のセクションで説明したときに、`Membership.ValidateUser`の無効なログイン試行を追跡し、特定数を超える場合、ユーザーをロックアウトするメソッドが呼び出され、無効な資格情報を渡して、指定された時間ウィンドウ内の無効な試行のしきい値。</span><span class="sxs-lookup"><span data-stu-id="d1bac-310">As discussed in the How the Membership Framework Handles Invalid Login Attempts section in Step 1, when the `Membership.ValidateUser` method is called and passed invalid credentials, it keeps track of the invalid login attempt and locks out the user if they exceed a certain threshold of invalid attempts within a specified time window.</span></span> <span data-ttu-id="d1bac-311">以降、カスタム認証ロジックの呼び出し、`ValidateUser`メソッド、間違ったパスワードの有効なユーザー名には、無効なログイン試行カウンターが 1 ずつ増分されますが、このカウンターは、ユーザー名とパスワードは、有効な場合は加算されませんが、電子メール アドレスが正しくありません。</span><span class="sxs-lookup"><span data-stu-id="d1bac-311">Since our custom authentication logic calls the `ValidateUser` method, an incorrect password for a valid username will increment the invalid login attempt counter, but this counter is not incremented in the case where the username and password are valid, but the email address is incorrect.</span></span> <span data-ttu-id="d1bac-312">ハッカーがユーザー名とパスワードがユーザーの電子メール アドレスを決定するブルート フォース手法を使用する必要がないために、この動作は、適切な可能性があります。</span><span class="sxs-lookup"><span data-stu-id="d1bac-312">Chances are, this behavior is suitable, since it's unlikely that a hacker will know the username and password, but have to use brute force techniques to determine the user's email address.</span></span>

## <a name="step-4-improving-the-login-controls-invalid-credentials-message"></a><span data-ttu-id="d1bac-313">手順 4: ログイン コントロールの無効な資格情報のメッセージの向上</span><span class="sxs-lookup"><span data-stu-id="d1bac-313">Step 4: Improving the Login Control's Invalid Credentials Message</span></span>

<span data-ttu-id="d1bac-314">ユーザーが無効な資格情報でログオンしようとすると、ログイン コントロールには、ログインの試行が成功したことを説明するメッセージが表示されます。</span><span class="sxs-lookup"><span data-stu-id="d1bac-314">When a user attempts to log on with invalid credentials, the Login control displays a message explaining that the login attempt was unsuccessful.</span></span> <span data-ttu-id="d1bac-315">具体的には、コントロールがで指定されたメッセージが表示されます、 [ `FailureText`プロパティ](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.failuretext.aspx)ログインの試行の既定値を持つに失敗しました。</span><span class="sxs-lookup"><span data-stu-id="d1bac-315">In particular, the control displays the message specified by its [`FailureText` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.failuretext.aspx), which has a default value of Your login attempt was not successful.</span></span> <span data-ttu-id="d1bac-316">やり直してください。</span><span class="sxs-lookup"><span data-stu-id="d1bac-316">Please try again.</span></span>

<span data-ttu-id="d1bac-317">なぜユーザーの資格情報がありますいない有効な多くの理由があることを思い出してください。</span><span class="sxs-lookup"><span data-stu-id="d1bac-317">Recall that there are many reasons why a user's credentials may be invalid:</span></span>

- <span data-ttu-id="d1bac-318">ユーザー名がない可能性があります。</span><span class="sxs-lookup"><span data-stu-id="d1bac-318">The username may not exist</span></span>
- <span data-ttu-id="d1bac-319">ユーザー名が存在しますが、パスワードが無効です。</span><span class="sxs-lookup"><span data-stu-id="d1bac-319">The username exists, but the password is invalid</span></span>
- <span data-ttu-id="d1bac-320">ユーザー名とパスワードが有効では、ユーザーがまだ承認されていません。</span><span class="sxs-lookup"><span data-stu-id="d1bac-320">The username and password are valid, but the user is not yet approved</span></span>
- <span data-ttu-id="d1bac-321">ユーザー名とパスワードが有効では、ユーザーがロックアウトされている出力 (指定した期間内の無効なログイン試行の回数を超過したため、最も高い)</span><span class="sxs-lookup"><span data-stu-id="d1bac-321">The username and password are valid, but the user is locked out (most likely because they exceeded the number of invalid login attempts within the specified time frame)</span></span>

<span data-ttu-id="d1bac-322">カスタムの認証ロジックを使用する場合、その他の理由にすることがあります。</span><span class="sxs-lookup"><span data-stu-id="d1bac-322">And there may be other reasons when using custom authentication logic.</span></span> <span data-ttu-id="d1bac-323">たとえば、手順 3 では、ユーザー名で作成したコードとパスワードは、有効な可能性がありますが、電子メール アドレスが正しくない可能性があります。</span><span class="sxs-lookup"><span data-stu-id="d1bac-323">For example, with the code we wrote in Step 3, the username and password may be valid, but the email address may be incorrect.</span></span>

<span data-ttu-id="d1bac-324">なぜ、資格情報は、無効なに関係なく、Login コントロールには、同じエラー メッセージが表示されます。</span><span class="sxs-lookup"><span data-stu-id="d1bac-324">Regardless of why the credentials are invalid, the Login control displays the same error message.</span></span> <span data-ttu-id="d1bac-325">フィードバックのこの不足をロックアウトされているユーザー アカウントが承認されていない、またはユーザーの混乱を招くことはできます。ただし、若干の開発では、使用より適切なメッセージを表示する、ログイン コントロールがおできます。</span><span class="sxs-lookup"><span data-stu-id="d1bac-325">This lack of feedback can be confusing for a user whose account has not yet been approved or who has been locked out. With a little bit of work, though, we can have the Login control display a more appropriate message.</span></span>

<span data-ttu-id="d1bac-326">ユーザーがログイン コントロールで発生し、無効な資格情報でログインしようとしたときにその`LoginError`イベント。</span><span class="sxs-lookup"><span data-stu-id="d1bac-326">Whenever a user attempts to login with invalid credentials the Login control raises its `LoginError` event.</span></span> <span data-ttu-id="d1bac-327">さあと、このイベントのイベント ハンドラーを作成し、次のコードを追加します。</span><span class="sxs-lookup"><span data-stu-id="d1bac-327">Go ahead and create an event handler for this event, and add the following code:</span></span>

[!code-csharp[Main](validating-user-credentials-against-the-membership-user-store-cs/samples/sample5.cs)]

<span data-ttu-id="d1bac-328">上記のコードを開始するには、ログイン コントロールの`FailureText`プロパティを既定値 (ログインの試行に失敗しました。</span><span class="sxs-lookup"><span data-stu-id="d1bac-328">The above code starts by setting the Login control's `FailureText` property to the default value ( Your login attempt was not successful.</span></span> <span data-ttu-id="d1bac-329">もう一度やり直してください)。</span><span class="sxs-lookup"><span data-stu-id="d1bac-329">Please try again ).</span></span> <span data-ttu-id="d1bac-330">次のかどうか、指定したユーザー名は、既存のユーザー アカウントにマップされます。 表示する確認します。</span><span class="sxs-lookup"><span data-stu-id="d1bac-330">It then checks to see if the username supplied maps to an existing user account.</span></span> <span data-ttu-id="d1bac-331">そのため、その結果、調べて場合`MembershipUser`オブジェクトの`IsLockedOut`と`IsApproved`プロパティを確認して、アカウントがロックアウトされているか、承認されていないかどうか。</span><span class="sxs-lookup"><span data-stu-id="d1bac-331">If so, it consults the resulting `MembershipUser` object's `IsLockedOut` and `IsApproved` properties to determine if the account has been locked out or has not yet been approved.</span></span> <span data-ttu-id="d1bac-332">どちらの場合、`FailureText`プロパティは、対応する値に更新されます。</span><span class="sxs-lookup"><span data-stu-id="d1bac-332">In either case, the `FailureText` property is updated to a corresponding value.</span></span>

<span data-ttu-id="d1bac-333">このコードをテストするには、意図的しようとすると、既存のユーザーとしてログインしますが、正しくないパスワードを使用します。</span><span class="sxs-lookup"><span data-stu-id="d1bac-333">To test this code, purposefully attempt to log in as an existing user, but use an incorrect password.</span></span> <span data-ttu-id="d1bac-334">10 分間のタイム フレーム内の行で 5 回を行い、アカウントをロックアウトします。図 11 に示す試行は常に (正しいパスワード) でも失敗しますが、ここでは、その後のログインよりわかりやすい表示と、アカウントが無効なログインの回数が多すぎるためロックされています。</span><span class="sxs-lookup"><span data-stu-id="d1bac-334">Do this five times in a row within a 10 minute time frame and the account will be locked out. As Figure 11 shows, subsequent login attempts will always fail (even with the correct password), but will now display the more descriptive Your account has been locked out because of too many invalid login attempts.</span></span> <span data-ttu-id="d1bac-335">アカウント ロック解除されたメッセージが管理者にお問い合わせください。</span><span class="sxs-lookup"><span data-stu-id="d1bac-335">Please contact the administrator to have your account unlocked message.</span></span>

<span data-ttu-id="d1bac-336">[![Tito が無効なログインを何度もを実行して、ロックアウトされています。](validating-user-credentials-against-the-membership-user-store-cs/_static/image32.png)](validating-user-credentials-against-the-membership-user-store-cs/_static/image31.png)</span><span class="sxs-lookup"><span data-stu-id="d1bac-336">[![Tito Performed Too Many Invalid Login Attempts and Has Been Locked Out](validating-user-credentials-against-the-membership-user-store-cs/_static/image32.png)](validating-user-credentials-against-the-membership-user-store-cs/_static/image31.png)</span></span>

<span data-ttu-id="d1bac-337">**図 11**:Tito 実行が無効なログインも間違えるとがされてロックアウト ([フルサイズの画像を表示する をクリックします](validating-user-credentials-against-the-membership-user-store-cs/_static/image33.png))。</span><span class="sxs-lookup"><span data-stu-id="d1bac-337">**Figure 11**: Tito Performed Too Many Invalid Login Attempts and Has Been Locked Out  ([Click to view full-size image](validating-user-credentials-against-the-membership-user-store-cs/_static/image33.png))</span></span>

## <a name="summary"></a><span data-ttu-id="d1bac-338">まとめ</span><span class="sxs-lookup"><span data-stu-id="d1bac-338">Summary</span></span>

<span data-ttu-id="d1bac-339">以前このチュートリアルでは、弊社のログイン ページは、ハード コーディングされたユーザー名/パスワードのペアのリストに対して指定された資格情報を検証します。</span><span class="sxs-lookup"><span data-stu-id="d1bac-339">Prior this tutorial, our login page validated the supplied credentials against a hard-coded list of username/password pairs.</span></span> <span data-ttu-id="d1bac-340">このチュートリアルでは、メンバーシップ フレームワークに対して資格情報を検証するページを更新しました。</span><span class="sxs-lookup"><span data-stu-id="d1bac-340">In this tutorial, we updated the page to validate credentials against the Membership framework.</span></span> <span data-ttu-id="d1bac-341">手順 1 でしましたを使用して、`Membership.ValidateUser`メソッド プログラムを使用します。</span><span class="sxs-lookup"><span data-stu-id="d1bac-341">In Step 1 we looked at using the `Membership.ValidateUser` method programmatically.</span></span> <span data-ttu-id="d1bac-342">手順 2. で置き換え、手動で作成したユーザー インターフェイスとコード ログイン コントロールを使用します。</span><span class="sxs-lookup"><span data-stu-id="d1bac-342">In Step 2 we replaced our manually created user interface and code with the Login control.</span></span>

<span data-ttu-id="d1bac-343">Login コントロールは、標準的なログインのユーザー インターフェイスをレンダリングし、自動的にメンバーシップ フレームワークに対してユーザーの資格情報を検証します。</span><span class="sxs-lookup"><span data-stu-id="d1bac-343">The Login control renders a standard login user interface and automatically validates the user's credentials against the Membership framework.</span></span> <span data-ttu-id="d1bac-344">さらに、有効な資格情報が発生した場合、Login コントロール ユーザーでサインイン フォーム認証を使用しています。</span><span class="sxs-lookup"><span data-stu-id="d1bac-344">Moreover, in the event of valid credentials, the Login control signs the user in via forms authentication.</span></span> <span data-ttu-id="d1bac-345">つまり、完全に機能のログインのユーザー エクスペリエンスはページ、ない余分な宣言型マークアップまたは必要なコードに、ログイン コントロールをドラッグするだけで使用できます。</span><span class="sxs-lookup"><span data-stu-id="d1bac-345">In short, a fully functional login user experience is available by simply dragging the Login control onto a page, no extra declarative markup or code necessary.</span></span> <span data-ttu-id="d1bac-346">詳細については、ログイン コントロールは、自由にカスタマイズ、レンダリングされたユーザー インターフェイスと認証のロジックを制御のきめ細かなすることができます。</span><span class="sxs-lookup"><span data-stu-id="d1bac-346">What's more, the Login control is highly customizable, allowing for a fine degree of control over both the rendered user interface and authentication logic.</span></span>

<span data-ttu-id="d1bac-347">この時点で、web サイトへの訪問者を作成できます、新しいユーザー アカウントとログをサイトにまだ、認証されたユーザーに基づいて、ページにアクセスを制限することを確認します。</span><span class="sxs-lookup"><span data-stu-id="d1bac-347">At this point visitors to our website can create a new user account and log into the site, but we have yet to look at restricting access to pages based on the authenticated user.</span></span> <span data-ttu-id="d1bac-348">現時点では、任意のユーザーが認証済みまたは匿名では、サイトのいずれかのページを表示できます。</span><span class="sxs-lookup"><span data-stu-id="d1bac-348">Currently, any user, authenticated or anonymous, can view any page on our site.</span></span> <span data-ttu-id="d1bac-349">と共に、ユーザー単位のユーザーごとに、サイトのページへのアクセスを制御する機能を持つは、ユーザーによって異なります。 特定のページがあります。</span><span class="sxs-lookup"><span data-stu-id="d1bac-349">Along with controlling access to our site's pages on a user-by-user basis, we might have certain pages whose functionality depends on the user.</span></span> <span data-ttu-id="d1bac-350">次のチュートリアルでは、アクセスとログインのユーザーに基づくページで機能を制限する方法を検索します。</span><span class="sxs-lookup"><span data-stu-id="d1bac-350">The next tutorial looks at how to limit access and in-page functionality based on the logged in user.</span></span>

<span data-ttu-id="d1bac-351">満足のプログラミングです。</span><span class="sxs-lookup"><span data-stu-id="d1bac-351">Happy Programming!</span></span>

### <a name="further-reading"></a><span data-ttu-id="d1bac-352">関連項目</span><span class="sxs-lookup"><span data-stu-id="d1bac-352">Further Reading</span></span>

<span data-ttu-id="d1bac-353">このチュートリアルで説明したトピックの詳細については、次の情報を参照してください。</span><span class="sxs-lookup"><span data-stu-id="d1bac-353">For more information on the topics discussed in this tutorial, refer to the following resources:</span></span>

- [<span data-ttu-id="d1bac-354">ロックされており、承認されていないユーザーにカスタム メッセージを表示します。</span><span class="sxs-lookup"><span data-stu-id="d1bac-354">Displaying Custom Messages to Locked Out and Non-Approved Users</span></span>](http://aspnet.4guysfromrolla.com/articles/050306-1.aspx)
- [<span data-ttu-id="d1bac-355">ASP.NET 2.0 の検査のメンバーシップ、ロール、およびプロファイル</span><span class="sxs-lookup"><span data-stu-id="d1bac-355">Examining ASP.NET 2.0's Membership, Roles, and Profile</span></span>](http://aspnet.4guysfromrolla.com/articles/120705-1.aspx)
- [<span data-ttu-id="d1bac-356">方法: ASP.NET ログイン ページを作成します。</span><span class="sxs-lookup"><span data-stu-id="d1bac-356">How To: Create an ASP.NET Login Page</span></span>](https://msdn.microsoft.com/library/ms178331.aspx)
- [<span data-ttu-id="d1bac-357">ログイン コントロールのテクニカル ドキュメント</span><span class="sxs-lookup"><span data-stu-id="d1bac-357">Login Control Technical Documentation</span></span>](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.aspx)
- [<span data-ttu-id="d1bac-358">ログイン コントロールを使用します。</span><span class="sxs-lookup"><span data-stu-id="d1bac-358">Using the Login Controls</span></span>](https://quickstarts.asp.net/QuickStartv20/aspnet/doc/security/login.aspx)

### <a name="about-the-author"></a><span data-ttu-id="d1bac-359">執筆者紹介</span><span class="sxs-lookup"><span data-stu-id="d1bac-359">About the Author</span></span>

<span data-ttu-id="d1bac-360">Scott Mitchell、複数の受け取ります書籍の著者と、4GuysFromRolla.com の創設者では、1998 年から、Microsoft Web テクノロジに取り組んできました。</span><span class="sxs-lookup"><span data-stu-id="d1bac-360">Scott Mitchell, author of multiple ASP/ASP.NET books and founder of 4GuysFromRolla.com, has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="d1bac-361">Scott は、フリーのコンサルタント、トレーナー、およびライターとして動作します。</span><span class="sxs-lookup"><span data-stu-id="d1bac-361">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="d1bac-362">最新の著書は *[Sams 教える自分で ASP.NET 2.0 24 時間以内に](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)* します。</span><span class="sxs-lookup"><span data-stu-id="d1bac-362">His latest book is *[Sams Teach Yourself ASP.NET 2.0 in 24 Hours](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)*.</span></span> <span data-ttu-id="d1bac-363">Scott に到達できる[ mitchell@4guysfromrolla.com ](mailto:mitchell@4guysfromrolla.com)または彼のブログ[ http://ScottOnWriting.NET](http://scottonwriting.net/)します。</span><span class="sxs-lookup"><span data-stu-id="d1bac-363">Scott can be reached at [mitchell@4guysfromrolla.com](mailto:mitchell@4guysfromrolla.com) or via his blog at [http://ScottOnWriting.NET](http://scottonwriting.net/).</span></span>

### <a name="special-thanks-to"></a><span data-ttu-id="d1bac-364">特別なに感謝します。</span><span class="sxs-lookup"><span data-stu-id="d1bac-364">Special Thanks To</span></span>

<span data-ttu-id="d1bac-365">このチュートリアル シリーズは、多くの便利なレビュー担当者によってレビューされました。</span><span class="sxs-lookup"><span data-stu-id="d1bac-365">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="d1bac-366">このチュートリアルでは、潜在顧客レビュー担当者は、Teresa Murphy および Michael Olivero でした。</span><span class="sxs-lookup"><span data-stu-id="d1bac-366">Lead reviewers for this tutorial were Teresa Murphy and Michael Olivero.</span></span> <span data-ttu-id="d1bac-367">今後、MSDN の記事を確認したいですか。</span><span class="sxs-lookup"><span data-stu-id="d1bac-367">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="d1bac-368">場合は、筆者に[ mitchell@4GuysFromRolla.com](mailto:mitchell@4guysfromrolla.com)します。</span><span class="sxs-lookup"><span data-stu-id="d1bac-368">If so, drop me a line at [mitchell@4GuysFromRolla.com](mailto:mitchell@4guysfromrolla.com).</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="d1bac-369">[前へ](creating-user-accounts-cs.md)
> [次へ](user-based-authorization-cs.md)</span><span class="sxs-lookup"><span data-stu-id="d1bac-369">[Previous](creating-user-accounts-cs.md)
[Next](user-based-authorization-cs.md)</span></span>

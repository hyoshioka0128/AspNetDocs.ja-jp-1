---
uid: web-forms/overview/older-versions-security/membership/validating-user-credentials-against-the-membership-user-store-vb
title: メンバーシップユーザーストアに対してユーザー資格情報を検証する (VB) |Microsoft Docs
author: rick-anderson
description: このチュートリアルでは、プログラムによる方法とログイン制御の両方を使用して、メンバーシップユーザーストアに対してユーザーの資格情報を検証する方法について説明します。
ms.author: riande
ms.date: 01/18/2008
ms.assetid: 17772912-b47b-4557-9ce9-80f22df642f7
msc.legacyurl: /web-forms/overview/older-versions-security/membership/validating-user-credentials-against-the-membership-user-store-vb
msc.type: authoredcontent
ms.openlocfilehash: 37574e4cdc86f518d01d12da58cc2862bc77d463
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 03/06/2020
ms.locfileid: "78423808"
---
# <a name="validating-user-credentials-against-the-membership-user-store-vb"></a><span data-ttu-id="af5de-103">メンバーシップ ユーザー ストアに対してユーザー資格情報を確認する (VB)</span><span class="sxs-lookup"><span data-stu-id="af5de-103">Validating User Credentials Against the Membership User Store (VB)</span></span>

<span data-ttu-id="af5de-104">[Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="af5de-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="af5de-105">[コードのダウンロード](https://download.microsoft.com/download/3/f/5/3f5a8605-c526-4b34-b3fd-a34167117633/ASPNET_Security_Tutorial_06_VB.zip)または[PDF のダウンロード](https://download.microsoft.com/download/3/f/5/3f5a8605-c526-4b34-b3fd-a34167117633/aspnet_tutorial06_LoggingIn_vb.pdf)</span><span class="sxs-lookup"><span data-stu-id="af5de-105">[Download Code](https://download.microsoft.com/download/3/f/5/3f5a8605-c526-4b34-b3fd-a34167117633/ASPNET_Security_Tutorial_06_VB.zip) or [Download PDF](https://download.microsoft.com/download/3/f/5/3f5a8605-c526-4b34-b3fd-a34167117633/aspnet_tutorial06_LoggingIn_vb.pdf)</span></span>

> <span data-ttu-id="af5de-106">このチュートリアルでは、プログラムによる方法とログイン制御の両方を使用して、メンバーシップユーザーストアに対してユーザーの資格情報を検証する方法について説明します。</span><span class="sxs-lookup"><span data-stu-id="af5de-106">In this tutorial we will examine how to validate a user's credentials against the Membership user store using both programmatic means and the Login control.</span></span> <span data-ttu-id="af5de-107">また、ログインコントロールの外観と動作をカスタマイズする方法についても説明します。</span><span class="sxs-lookup"><span data-stu-id="af5de-107">We will also look at how to customize the login control's appearance and behavior.</span></span>

## <a name="introduction"></a><span data-ttu-id="af5de-108">はじめに</span><span class="sxs-lookup"><span data-stu-id="af5de-108">Introduction</span></span>

<span data-ttu-id="af5de-109">前の<a id="Tutorial05"> </a>[チュートリアル](creating-user-accounts-vb.md)では、メンバーシップフレームワークで新しいユーザーアカウントを作成する方法について説明しました。</span><span class="sxs-lookup"><span data-stu-id="af5de-109">In the <a id="Tutorial05"></a>[preceding tutorial](creating-user-accounts-vb.md) we looked at how to create a new user account in the Membership framework.</span></span> <span data-ttu-id="af5de-110">まず、プログラムで `Membership` クラスの `CreateUser` メソッドを使用してユーザーアカウントを作成し、次に CreateUserWizard Web コントロールを使用して検証しました。</span><span class="sxs-lookup"><span data-stu-id="af5de-110">We first looked at programmatically creating user accounts via the `Membership` class's `CreateUser` method, and then examined using the CreateUserWizard Web control.</span></span> <span data-ttu-id="af5de-111">ただし、ログインページでは、指定された資格情報が、ハードコーディングされたユーザー名とパスワードの組み合わせに対して現在検証されています。</span><span class="sxs-lookup"><span data-stu-id="af5de-111">However, the login page currently validates the supplied credentials against a hard-coded list of username and password pairs.</span></span> <span data-ttu-id="af5de-112">メンバーシップフレームワークのユーザーストアに対して資格情報を検証するために、ログインページのロジックを更新する必要があります。</span><span class="sxs-lookup"><span data-stu-id="af5de-112">We need to update the login page's logic so that it validates credentials against the Membership framework's user store.</span></span>

<span data-ttu-id="af5de-113">ユーザーアカウントの作成と同様に、資格情報はプログラムによって、または宣言によって検証できます。</span><span class="sxs-lookup"><span data-stu-id="af5de-113">Much like with creating user accounts, credentials can be validated programmatically or declaratively.</span></span> <span data-ttu-id="af5de-114">メンバーシップ API には、ユーザーストアに対してユーザーの資格情報をプログラムによって検証するためのメソッドが含まれています。</span><span class="sxs-lookup"><span data-stu-id="af5de-114">The Membership API includes a method for programmatically validating a user's credentials against the user store.</span></span> <span data-ttu-id="af5de-115">と ASP.NET には、ログイン Web コントロールが付属しています。これにより、ユーザー名とパスワードのテキストボックスとログインするボタンを含むユーザーインターフェイスがレンダリングされます。</span><span class="sxs-lookup"><span data-stu-id="af5de-115">And ASP.NET ships with the Login Web control, which renders a user interface with textboxes for the username and password and a button to log in.</span></span>

<span data-ttu-id="af5de-116">このチュートリアルでは、プログラムによる方法とログイン制御の両方を使用して、メンバーシップユーザーストアに対してユーザーの資格情報を検証する方法について説明します。</span><span class="sxs-lookup"><span data-stu-id="af5de-116">In this tutorial we will examine how to validate a user's credentials against the Membership user store using both programmatic means and the Login control.</span></span> <span data-ttu-id="af5de-117">また、ログインコントロールの外観と動作をカスタマイズする方法についても説明します。</span><span class="sxs-lookup"><span data-stu-id="af5de-117">We will also look at how to customize the login control's appearance and behavior.</span></span> <span data-ttu-id="af5de-118">作業開始</span><span class="sxs-lookup"><span data-stu-id="af5de-118">Let's get started!</span></span>

## <a name="step-1-validating-credentials-against-the-membership-user-store"></a><span data-ttu-id="af5de-119">手順 1: メンバーシップユーザーストアに対して資格情報を検証する</span><span class="sxs-lookup"><span data-stu-id="af5de-119">Step 1: Validating Credentials Against the Membership User Store</span></span>

<span data-ttu-id="af5de-120">フォーム認証を使用する web サイトの場合、ユーザーはログインページにアクセスして資格情報を入力することで、web サイトにログオンします。</span><span class="sxs-lookup"><span data-stu-id="af5de-120">For web sites that use forms authentication, a user logs on to the website by visiting a login page and entering their credentials.</span></span> <span data-ttu-id="af5de-121">これらの資格情報は、ユーザーストアと比較されます。</span><span class="sxs-lookup"><span data-stu-id="af5de-121">These credentials are then compared against the user store.</span></span> <span data-ttu-id="af5de-122">有効な場合、ユーザーにはフォーム認証チケットが付与されます。これは、ビジターの id と信頼性を示すセキュリティトークンです。</span><span class="sxs-lookup"><span data-stu-id="af5de-122">If they are valid, then the user is granted a forms authentication ticket, which is a security token that indicates the identity and authenticity of the visitor.</span></span>

<span data-ttu-id="af5de-123">メンバーシップフレームワークに対してユーザーを検証するには、`Membership` クラスの[`ValidateUser` メソッド](https://msdn.microsoft.com/library/system.web.security.membership.validateuser.aspx)を使用します。</span><span class="sxs-lookup"><span data-stu-id="af5de-123">To validate a user against the Membership framework, use the `Membership` class's [`ValidateUser` method](https://msdn.microsoft.com/library/system.web.security.membership.validateuser.aspx).</span></span> <span data-ttu-id="af5de-124">`ValidateUser` メソッドは、`username` と `password` の2つの入力パラメーターを受け取り、資格情報が有効であるかどうかを示すブール値を返します。</span><span class="sxs-lookup"><span data-stu-id="af5de-124">The `ValidateUser` method takes in two input parameters - `username` and `password` - and returns a Boolean value indicating whether the credentials were valid.</span></span> <span data-ttu-id="af5de-125">前のチュートリアルで調べた `CreateUser` メソッドと同様に、`ValidateUser` メソッドは、構成されたメンバーシッププロバイダーに実際の検証を委任します。</span><span class="sxs-lookup"><span data-stu-id="af5de-125">Like with the `CreateUser` method we examined in the previous tutorial, the `ValidateUser` method delegates the actual validation to the configured Membership provider.</span></span>

<span data-ttu-id="af5de-126">`SqlMembershipProvider` は、指定されたユーザーのパスワードを `aspnet_Membership_GetPasswordWithFormat` ストアドプロシージャを使用して取得することによって、指定された資格情報を検証します。</span><span class="sxs-lookup"><span data-stu-id="af5de-126">The `SqlMembershipProvider` validates the supplied credentials by obtaining the specified user's password via the `aspnet_Membership_GetPasswordWithFormat` stored procedure.</span></span> <span data-ttu-id="af5de-127">`SqlMembershipProvider` には、クリア、暗号化、またはハッシュされた3つの形式のいずれかを使用してユーザーのパスワードが格納されていることを思い出してください。</span><span class="sxs-lookup"><span data-stu-id="af5de-127">Recall that the `SqlMembershipProvider` stores users' passwords using one of three formats: clear, encrypted, or hashed.</span></span> <span data-ttu-id="af5de-128">`aspnet_Membership_GetPasswordWithFormat` ストアドプロシージャは、パスワードを未加工の形式で返します。</span><span class="sxs-lookup"><span data-stu-id="af5de-128">The `aspnet_Membership_GetPasswordWithFormat` stored procedure returns the password in its raw format.</span></span> <span data-ttu-id="af5de-129">暗号化またはハッシュされたパスワードの場合、`SqlMembershipProvider` は `ValidateUser` メソッドに渡された `password` 値を、それと等価な暗号化またはハッシュされた状態に変換し、データベースから返された値と比較します。</span><span class="sxs-lookup"><span data-stu-id="af5de-129">For encrypted or hashed passwords, the `SqlMembershipProvider` transforms the `password` value passed into the `ValidateUser` method into its equivalent encrypted or hashed state and then compares it with what was returned from the database.</span></span> <span data-ttu-id="af5de-130">データベースに格納されているパスワードが、ユーザーが入力した書式設定されたパスワードと一致する場合、資格情報は有効です。</span><span class="sxs-lookup"><span data-stu-id="af5de-130">If the password stored in the database matches the formatted password entered by the user, the credentials are valid.</span></span>

<span data-ttu-id="af5de-131">メンバーシップフレームワークのユーザーストアに対して指定された資格情報を検証するように、ログインページ (~/`Login.aspx`) を更新してみましょう。</span><span class="sxs-lookup"><span data-stu-id="af5de-131">Let's update our login page (~/`Login.aspx`) so that it validates the supplied credentials against the Membership framework user store.</span></span> <span data-ttu-id="af5de-132">このログインページは、 <a id="Tutorial02"> </a> [ *「フォーム認証の概要」* ](../introduction/an-overview-of-forms-authentication-vb.md)チュートリアルで作成したもので、[ユーザー名] と [パスワード] の2つのテキストボックス、[覚えてください] チェックボックス、[ログイン] ボタン (図1を参照) を使用してインターフェイスを作成しています。</span><span class="sxs-lookup"><span data-stu-id="af5de-132">We created this login page back in the <a id="Tutorial02"></a>[*An Overview of Forms Authentication*](../introduction/an-overview-of-forms-authentication-vb.md) tutorial, creating an interface with two TextBoxes for the username and password, a Remember Me checkbox, and a Login button (see Figure 1).</span></span> <span data-ttu-id="af5de-133">このコードは、入力された資格情報を、ユーザー名とパスワードのペア (Scott/password、Jisun/password、および Sam/password) のハードコーディングされたリストと照合して検証します。</span><span class="sxs-lookup"><span data-stu-id="af5de-133">The code validates the entered credentials against a hard-coded list of username and password pairs (Scott/password, Jisun/password, and Sam/password).</span></span> <span data-ttu-id="af5de-134"><a id="Tutorial03"> </a>[*フォーム認証構成と高度なトピック*](../introduction/forms-authentication-configuration-and-advanced-topics-vb.md)のチュートリアルでは、フォーム認証チケットの `UserData` プロパティに追加情報を格納するために、ログインページのコードを更新しました。</span><span class="sxs-lookup"><span data-stu-id="af5de-134">In the <a id="Tutorial03"></a>[*Forms Authentication Configuration and Advanced Topics*](../introduction/forms-authentication-configuration-and-advanced-topics-vb.md) tutorial we updated the login page's code to store additional information in the forms authentication ticket's `UserData` property.</span></span>

<span data-ttu-id="af5de-135">[ログインページのインターフェイスに、2つのテキストボックス、CheckBoxList、およびボタンが含まれている ![](validating-user-credentials-against-the-membership-user-store-vb/_static/image2.png)](validating-user-credentials-against-the-membership-user-store-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="af5de-135">[![The Login Page's Interface Includes Two TextBoxes, a CheckBoxList, and a Button](validating-user-credentials-against-the-membership-user-store-vb/_static/image2.png)](validating-user-credentials-against-the-membership-user-store-vb/_static/image1.png)</span></span>

<span data-ttu-id="af5de-136">**図 1**: ログインページのインターフェイスには、2つのテキストボックス、CheckBoxList、ボタンが含まれています ([クリックすると、フルサイズの画像が表示](validating-user-credentials-against-the-membership-user-store-vb/_static/image3.png)されます)</span><span class="sxs-lookup"><span data-stu-id="af5de-136">**Figure 1**: The Login Page's Interface Includes Two TextBoxes, a CheckBoxList, and a Button  ([Click to view full-size image](validating-user-credentials-against-the-membership-user-store-vb/_static/image3.png))</span></span>

<span data-ttu-id="af5de-137">ログインページのユーザーインターフェイスは変更されませんが、ログインボタンの `Click` イベントハンドラーを、メンバーシップフレームワークのユーザーストアに対してユーザーを検証するコードに置き換える必要があります。</span><span class="sxs-lookup"><span data-stu-id="af5de-137">The login page's user interface can remain unchanged, but we need to replace the Login button's `Click` event handler with code that validates the user against the Membership framework user store.</span></span> <span data-ttu-id="af5de-138">イベントハンドラーを次のように更新します。</span><span class="sxs-lookup"><span data-stu-id="af5de-138">Update the event handler so that its code appears as follows:</span></span>

[!code-vb[Main](validating-user-credentials-against-the-membership-user-store-vb/samples/sample1.vb)]

<span data-ttu-id="af5de-139">このコードは非常に単純です。</span><span class="sxs-lookup"><span data-stu-id="af5de-139">This code is remarkably simple.</span></span> <span data-ttu-id="af5de-140">まず、`Membership.ValidateUser` メソッドを呼び出して、指定されたユーザー名とパスワードを渡します。</span><span class="sxs-lookup"><span data-stu-id="af5de-140">We start by calling the `Membership.ValidateUser` method, passing in the supplied username and password.</span></span> <span data-ttu-id="af5de-141">このメソッドが True を返す場合、ユーザーは `FormsAuthentication` クラスの RedirectFromLoginPage メソッドを使用してサイトにサインインします。</span><span class="sxs-lookup"><span data-stu-id="af5de-141">If that method returns True, then the user is signed into the site via the `FormsAuthentication` class's RedirectFromLoginPage method.</span></span> <span data-ttu-id="af5de-142">( <a id="Tutorial02"> </a> [ *「フォーム認証の概要*](../introduction/an-overview-of-forms-authentication-vb.md)」チュートリアルで説明したように、`FormsAuthentication.RedirectFromLoginPage` はフォーム認証チケットを作成し、ユーザーを適切なページにリダイレクトします)。ただし、資格情報が無効な場合は、ユーザー名またはパスワードが間違っていることを知らせる `InvalidCredentialsMessage` ラベルが表示されます。</span><span class="sxs-lookup"><span data-stu-id="af5de-142">(As we discussed in the <a id="Tutorial02"></a>[*An Overview of Forms Authentication*](../introduction/an-overview-of-forms-authentication-vb.md) tutorial, the `FormsAuthentication.RedirectFromLoginPage` creates the forms authentication ticket and then redirects the user to the appropriate page.) If the credentials are invalid, however, the `InvalidCredentialsMessage` Label is displayed, informing the user that their username or password was incorrect.</span></span>

<span data-ttu-id="af5de-143">これですべて完了です。</span><span class="sxs-lookup"><span data-stu-id="af5de-143">That's all there is to it!</span></span>

<span data-ttu-id="af5de-144">ログインページが想定どおりに動作することをテストするには、前のチュートリアルで作成したユーザーアカウントのいずれかでログインを試みます。</span><span class="sxs-lookup"><span data-stu-id="af5de-144">To test that the login page works as expected, attempt to login with one of the user accounts you created in the preceding tutorial.</span></span> <span data-ttu-id="af5de-145">または、まだアカウントを作成していない場合は、[`~/Membership/CreatingUserAccounts.aspx`] ページからアカウントを作成します。</span><span class="sxs-lookup"><span data-stu-id="af5de-145">Or, if you have not yet created an account, go ahead and create one from the `~/Membership/CreatingUserAccounts.aspx` page.</span></span>

> [!NOTE]
> <span data-ttu-id="af5de-146">ユーザーが資格情報を入力し、ログインページフォームを送信すると、パスワードを含む資格情報がインターネット経由で*プレーンテキスト*で web サーバーに送信されます。</span><span class="sxs-lookup"><span data-stu-id="af5de-146">When the user enters her credentials and submits the login page form, the credentials, including her password, are transmitted over the Internet to the web server in *plain text*.</span></span> <span data-ttu-id="af5de-147">つまり、ハッカーがネットワークトラフィックをスニッフィングすると、ユーザー名とパスワードが表示されます。</span><span class="sxs-lookup"><span data-stu-id="af5de-147">That means any hacker sniffing the network traffic can see the username and password.</span></span> <span data-ttu-id="af5de-148">これを回避するには、 [SSL (Secure Socket layer)](http://en.wikipedia.org/wiki/Secure_Sockets_Layer)を使用してネットワークトラフィックを暗号化することが不可欠です。</span><span class="sxs-lookup"><span data-stu-id="af5de-148">To prevent this, it is essential to encrypt the network traffic by using [Secure Socket Layers (SSL)](http://en.wikipedia.org/wiki/Secure_Sockets_Layer).</span></span> <span data-ttu-id="af5de-149">これにより、資格情報 (ページ全体の HTML マークアップ) が web サーバーによって受信されるまでブラウザーを離れた時点から暗号化されるようになります。</span><span class="sxs-lookup"><span data-stu-id="af5de-149">This will ensure that the credentials (as well as the entire page's HTML markup) are encrypted from the moment they leave the browser until they are received by the web server.</span></span>

### <a name="how-the-membership-framework-handles-invalid-login-attempts"></a><span data-ttu-id="af5de-150">メンバーシップフレームワークが無効なログイン試行を処理する方法</span><span class="sxs-lookup"><span data-stu-id="af5de-150">How the Membership Framework Handles Invalid Login Attempts</span></span>

<span data-ttu-id="af5de-151">ビジターがログインページに到達し、資格情報を送信すると、ブラウザーはログインページに HTTP 要求を行います。</span><span class="sxs-lookup"><span data-stu-id="af5de-151">When a visitor reaches the login page and submits their credentials, their browser makes an HTTP request to the login page.</span></span> <span data-ttu-id="af5de-152">資格情報が有効な場合、HTTP 応答には、cookie 内の認証チケットが含まれます。</span><span class="sxs-lookup"><span data-stu-id="af5de-152">If the credentials are valid, the HTTP response includes the authentication ticket in a cookie.</span></span> <span data-ttu-id="af5de-153">したがって、ハッカーがサイトに侵入しようとすると、有効なユーザー名とパスワードで推測されたパスワードを使用して、ログインページに HTTP 要求を徹底的に送信するプログラムが作成される可能性があります。</span><span class="sxs-lookup"><span data-stu-id="af5de-153">Therefore, a hacker attempting to break into your site could create a program that exhaustively sends HTTP requests to the login page with a valid username and a guess at the password.</span></span> <span data-ttu-id="af5de-154">パスワードの推定値が正しい場合、ログインページは認証チケットクッキーを返します。これは、プログラムが有効なユーザー名とパスワードの組み合わせで偶然していることを認識しています。</span><span class="sxs-lookup"><span data-stu-id="af5de-154">If the password guess is correct, the login page will return the authentication ticket cookie, at which point the program knows it has stumbled upon a valid username/password pair.</span></span> <span data-ttu-id="af5de-155">ブルートフォース攻撃によって、このようなプログラムは、特にパスワードが脆弱な場合に、ユーザーのパスワードを遭遇ことができる可能性があります。</span><span class="sxs-lookup"><span data-stu-id="af5de-155">Through brute force, such a program might be able to stumble upon a user's password, especially if the password is weak.</span></span>

<span data-ttu-id="af5de-156">このようなブルートフォース攻撃を防ぐために、特定の期間内にログイン試行が何回も失敗した場合に、メンバーシップフレームワークによってユーザーがロックアウトされます。</span><span class="sxs-lookup"><span data-stu-id="af5de-156">To prevent such brute force attacks, the Membership framework locks out a user if there are a certain number of unsuccessful login attempts within a certain period of time.</span></span> <span data-ttu-id="af5de-157">正確なパラメーターは、次の2つのメンバーシッププロバイダーの構成設定を使用して構成できます。</span><span class="sxs-lookup"><span data-stu-id="af5de-157">The exact parameters are configurable through the following two Membership provider configuration settings:</span></span>

- <span data-ttu-id="af5de-158">`maxInvalidPasswordAttempts`-アカウントがロックアウトされるまでにユーザーが使用できる無効なパスワードの試行回数を指定します。既定値は5です。</span><span class="sxs-lookup"><span data-stu-id="af5de-158">`maxInvalidPasswordAttempts` - specifies how many invalid password attempts are allowed for the user within the time period before the account is locked out. The default value is 5.</span></span>
- <span data-ttu-id="af5de-159">`passwordAttemptWindow`-指定した回数の無効なログイン試行によってアカウントがロックアウトされる期間を分単位で示します。既定値は10です。</span><span class="sxs-lookup"><span data-stu-id="af5de-159">`passwordAttemptWindow` - indicates the time period in minutes during which the specified number of invalid login attempts will cause the account to be locked out. The default value is 10.</span></span>

<span data-ttu-id="af5de-160">ユーザーがロックアウトされている場合は、管理者が自分のアカウントのロックを解除するまでログインできません。</span><span class="sxs-lookup"><span data-stu-id="af5de-160">If a user has been locked out, she cannot login until an administrator unlocks her account.</span></span> <span data-ttu-id="af5de-161">ユーザーがロックアウトされると、`ValidateUser` メソッドは、有効な資格情報が指定されている場合でも、*常に*`False`を返します。</span><span class="sxs-lookup"><span data-stu-id="af5de-161">When a user is locked out, the `ValidateUser` method will *always* return `False`, even if valid credentials are supplied.</span></span> <span data-ttu-id="af5de-162">この動作によって、ハッカーがブルートフォース方式を使用してサイトに侵入する可能性が低くなりますが、パスワードを忘れた場合、または誤って入力された日付が間違っていた場合は、有効なユーザーがロックアウトされる可能性があります。</span><span class="sxs-lookup"><span data-stu-id="af5de-162">While this behavior lessens the likelihood that a hacker will break into your site through brute force methods, it can end up locking out a valid user who has simply forgotten her password or accidentally has the Caps Lock on or is having a bad typing day.</span></span>

<span data-ttu-id="af5de-163">残念ながら、ユーザーアカウントのロックを解除するための組み込みツールはありません。</span><span class="sxs-lookup"><span data-stu-id="af5de-163">Unfortunately, there is no built-in tool for unlocking a user account.</span></span> <span data-ttu-id="af5de-164">アカウントのロックを解除するには、データベースを直接変更して、適切なユーザーアカウントの `aspnet_Membership` テーブルの [`IsLockedOut`] フィールドを変更するか、ロックアウトされたアカウントのロック解除オプションを含む web ベースのインターフェイスを作成します。</span><span class="sxs-lookup"><span data-stu-id="af5de-164">In order to unlock an account, you can modify the database directly - change the `IsLockedOut` field in the `aspnet_Membership` table for the appropriate user account - or create a web-based interface that lists locked out accounts with options to unlock them.</span></span> <span data-ttu-id="af5de-165">この後のチュートリアルでは、一般的なユーザーアカウントとロールに関連するタスクを実行するための管理インターフェイスの作成について説明します。</span><span class="sxs-lookup"><span data-stu-id="af5de-165">We will examine creating administrative interfaces for accomplishing common user account- and role-related tasks in a future tutorial.</span></span>

> [!NOTE]
> <span data-ttu-id="af5de-166">`ValidateUser` メソッドの欠点の1つは、指定された資格情報が無効な場合に、その理由を説明するものではないということです。</span><span class="sxs-lookup"><span data-stu-id="af5de-166">One downside of the `ValidateUser` method is that when the supplied credentials are invalid, it does not provide any explanation as to why.</span></span> <span data-ttu-id="af5de-167">ユーザーストアに一致するユーザー名とパスワードのペアがないか、ユーザーがまだ承認されていないか、ユーザーがロックアウトされているため、資格情報が無効になっている可能性があります。手順 4. では、ログイン試行が失敗したときに、より詳細なメッセージをユーザーに表示する方法を説明します。</span><span class="sxs-lookup"><span data-stu-id="af5de-167">The credentials may be invalid because there is no matching username/password pair in the user store, or because the user has not yet been approved, or because the user has been locked out. In Step 4 we will see how to show a more detailed message to the user when their login attempt fails.</span></span>

## <a name="step-2-collecting-credentials-through-the-login-web-control"></a><span data-ttu-id="af5de-168">手順 2: ログイン Web コントロールを使用して資格情報を収集する</span><span class="sxs-lookup"><span data-stu-id="af5de-168">Step 2: Collecting Credentials through the Login Web Control</span></span>

<span data-ttu-id="af5de-169">[ログイン Web コントロール](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.aspx)は、 <a id="Tutorial02"> </a> [ *「フォーム認証の概要」* ](../introduction/an-overview-of-forms-authentication-vb.md)チュートリアルで作成したものとよく似た既定のユーザーインターフェイスをレンダリングします。</span><span class="sxs-lookup"><span data-stu-id="af5de-169">The [Login Web control](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.aspx) renders a default user interface very similar to the one we created back in the <a id="Tutorial02"></a>[*An Overview of Forms Authentication*](../introduction/an-overview-of-forms-authentication-vb.md) tutorial.</span></span> <span data-ttu-id="af5de-170">ログインコントロールを使用すると、ユーザーの資格情報を収集するためのインターフェイスを作成する作業が保存されます。</span><span class="sxs-lookup"><span data-stu-id="af5de-170">Using the Login control saves us the work of having to create the interface to collect the visitor's credentials.</span></span> <span data-ttu-id="af5de-171">さらに、ログインコントロールは、(送信された資格情報が有効であることを前提として) ユーザーに自動的にサインインするため、コードを記述する必要がなくなります。</span><span class="sxs-lookup"><span data-stu-id="af5de-171">Moreover, the Login control automatically signs in the user (assuming the submitted credentials are valid), thereby saving us from having to write any code.</span></span>

<span data-ttu-id="af5de-172">`Login.aspx`を更新して、手動で作成したインターフェイスとコードをログインコントロールに置き換えてみましょう。</span><span class="sxs-lookup"><span data-stu-id="af5de-172">Let's update `Login.aspx`, replacing the manually created interface and code with a Login control.</span></span> <span data-ttu-id="af5de-173">まず、`Login.aspx`の既存のマークアップとコードを削除します。</span><span class="sxs-lookup"><span data-stu-id="af5de-173">Start by removing the existing markup and code in `Login.aspx`.</span></span> <span data-ttu-id="af5de-174">完全に削除することも、単にコメントアウトすることもできます。宣言型マークアップをコメントアウトするには、`<%--` と `--%>` 区切り記号で囲みます。</span><span class="sxs-lookup"><span data-stu-id="af5de-174">You may delete it outright, or simply comment it out. To comment out declarative markup, surround it with the `<%--` and `--%>` delimiters.</span></span> <span data-ttu-id="af5de-175">これらの区切り記号を手動で入力することも、図2に示すように、コメントアウトするテキストを選択してから、ツールバーの [選択した行をコメントアウトする] アイコンをクリックすることもできます。</span><span class="sxs-lookup"><span data-stu-id="af5de-175">You can enter these delimiters manually, or, as Figure 2 shows, you may select the text to comment out and then click the Comment out the selected lines icon in the Toolbar.</span></span> <span data-ttu-id="af5de-176">同様に、[選択した行をコメントアウトする] アイコンを使用して、分離コードクラスで選択されているコードをコメントアウトすることもできます。</span><span class="sxs-lookup"><span data-stu-id="af5de-176">Similarly, you can use the Comment out the selected lines icon to comment out the selected code in the code-behind class.</span></span>

<span data-ttu-id="af5de-177">[![既存の宣言型マークアップと login.aspx のソースコードをコメントアウトします。](validating-user-credentials-against-the-membership-user-store-vb/_static/image5.png)](validating-user-credentials-against-the-membership-user-store-vb/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="af5de-177">[![Comment Out the Existing Declarative Markup and Source Code in Login.aspx](validating-user-credentials-against-the-membership-user-store-vb/_static/image5.png)](validating-user-credentials-against-the-membership-user-store-vb/_static/image4.png)</span></span>

<span data-ttu-id="af5de-178">**図 2**: Login.aspx の既存の宣言型マークアップとソースコードをコメントアウト[する (クリックしてフルサイズのイメージを表示する](validating-user-credentials-against-the-membership-user-store-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="af5de-178">**Figure 2**: Comment Out the Existing Declarative Markup and Source Code in Login.aspx  ([Click to view full-size image](validating-user-credentials-against-the-membership-user-store-vb/_static/image6.png))</span></span>

> [!NOTE]
> <span data-ttu-id="af5de-179">Visual Studio 2005 で宣言マークアップを表示する場合、[選択した行をコメントアウトする] アイコンは使用できません。</span><span class="sxs-lookup"><span data-stu-id="af5de-179">The Comment out the selected lines icon is not available when viewing the declarative markup in Visual Studio 2005.</span></span> <span data-ttu-id="af5de-180">Visual Studio 2008 を使用していない場合は、`<%--` と `--%>` 区切り記号を手動で追加する必要があります。</span><span class="sxs-lookup"><span data-stu-id="af5de-180">If you are not using Visual Studio 2008 you will need to manually add the `<%--` and `--%>` delimiters.</span></span>

<span data-ttu-id="af5de-181">次に、ツールボックスからログインコントロールをページにドラッグし、その `ID` プロパティを `myLogin`に設定します。</span><span class="sxs-lookup"><span data-stu-id="af5de-181">Next, drag a Login control from the Toolbox on to the page and set its `ID` property to `myLogin`.</span></span> <span data-ttu-id="af5de-182">この時点で、画面は図3のようになります。</span><span class="sxs-lookup"><span data-stu-id="af5de-182">At this point your screen should look similar to Figure 3.</span></span> <span data-ttu-id="af5de-183">Login コントロールの既定のインターフェイスには、[ユーザー名とパスワード]、[次回に記憶する] チェックボックス、[ログイン] ボタンのテキストボックスコントロールが含まれていることに注意してください。</span><span class="sxs-lookup"><span data-stu-id="af5de-183">Note that the Login control's default interface includes TextBox controls for the username and password, a Remember me next time CheckBox, and a Log In Button.</span></span> <span data-ttu-id="af5de-184">2つのテキストボックスには、`RequiredFieldValidator` コントロールもあります。</span><span class="sxs-lookup"><span data-stu-id="af5de-184">There are also `RequiredFieldValidator` controls for the two TextBoxes.</span></span>

<span data-ttu-id="af5de-185">[ログインコントロールをページに追加 ![には](validating-user-credentials-against-the-membership-user-store-vb/_static/image8.png)](validating-user-credentials-against-the-membership-user-store-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="af5de-185">[![Add a Login Control to the Page](validating-user-credentials-against-the-membership-user-store-vb/_static/image8.png)](validating-user-credentials-against-the-membership-user-store-vb/_static/image7.png)</span></span>

<span data-ttu-id="af5de-186">**図 3**: ログインコントロールをページに追加する ([クリックすると、フルサイズの画像が表示](validating-user-credentials-against-the-membership-user-store-vb/_static/image9.png)されます)</span><span class="sxs-lookup"><span data-stu-id="af5de-186">**Figure 3**: Add a Login Control to the Page  ([Click to view full-size image](validating-user-credentials-against-the-membership-user-store-vb/_static/image9.png))</span></span>

<span data-ttu-id="af5de-187">これで完了です。</span><span class="sxs-lookup"><span data-stu-id="af5de-187">And we're done!</span></span> <span data-ttu-id="af5de-188">ログインコントロールの [ログイン] ボタンをクリックすると、ポストバックが発生し、ログインコントロールは、入力したユーザー名とパスワードを渡して `Membership.ValidateUser` メソッドを呼び出します。</span><span class="sxs-lookup"><span data-stu-id="af5de-188">When the Login control's Log In button is clicked, a postback will occur and the Login control will call the `Membership.ValidateUser` method, passing in the entered username and password.</span></span> <span data-ttu-id="af5de-189">資格情報が無効な場合、ログインコントロールには、そのようなメッセージが表示されます。</span><span class="sxs-lookup"><span data-stu-id="af5de-189">If the credentials are invalid, the Login control displays a message stating such.</span></span> <span data-ttu-id="af5de-190">ただし、資格情報が有効な場合、ログイン制御によってフォーム認証チケットが作成され、ユーザーが適切なページにリダイレクトされます。</span><span class="sxs-lookup"><span data-stu-id="af5de-190">If, however, the credentials are valid, then the Login control creates the forms authentication ticket and redirects the user to the appropriate page.</span></span>

<span data-ttu-id="af5de-191">ログイン制御では、次の4つの要素を使用して、ログインが成功したときにユーザーをリダイレクトするための適切なページを決定します。</span><span class="sxs-lookup"><span data-stu-id="af5de-191">The Login control uses four factors to determine the appropriate page to redirect the user to upon a successful login:</span></span>

- <span data-ttu-id="af5de-192">フォーム認証構成の `loginUrl` 設定によって定義されたログインページにログイン制御があるかどうか。この設定の既定値は `Login.aspx`</span><span class="sxs-lookup"><span data-stu-id="af5de-192">Whether the Login control is on the login page as defined by `loginUrl` setting in the forms authentication configuration; this setting's default value is `Login.aspx`</span></span>
- <span data-ttu-id="af5de-193">`ReturnUrl` querystring パラメーターの存在</span><span class="sxs-lookup"><span data-stu-id="af5de-193">The presence of a `ReturnUrl` querystring parameter</span></span>
- <span data-ttu-id="af5de-194">ログインコントロールの[`DestinationUrl` プロパティ](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.destinationpageurl.aspx)の値</span><span class="sxs-lookup"><span data-stu-id="af5de-194">The value of the Login control's [`DestinationUrl` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.destinationpageurl.aspx)</span></span>
- <span data-ttu-id="af5de-195">フォーム認証構成設定で指定された `defaultUrl` 値。この設定の既定値は default.aspx です。</span><span class="sxs-lookup"><span data-stu-id="af5de-195">The `defaultUrl` value specified in the forms authentication configuration settings; this setting's default value is Default.aspx</span></span>

<span data-ttu-id="af5de-196">図4は、ログインコントロールがこれら4つのパラメーターを使用して、適切なページの決定に到達する方法を示しています。</span><span class="sxs-lookup"><span data-stu-id="af5de-196">Figure 4 depicts the how the Login control uses these four parameters to arrive at its appropriate page decision.</span></span>

<span data-ttu-id="af5de-197">[ログインコントロールをページに追加 ![には](validating-user-credentials-against-the-membership-user-store-vb/_static/image11.png)](validating-user-credentials-against-the-membership-user-store-vb/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="af5de-197">[![Add a Login Control to the Page](validating-user-credentials-against-the-membership-user-store-vb/_static/image11.png)](validating-user-credentials-against-the-membership-user-store-vb/_static/image10.png)</span></span>

<span data-ttu-id="af5de-198">**図 4**: ログインコントロールをページに追加する ([クリックすると、フルサイズの画像が表示](validating-user-credentials-against-the-membership-user-store-vb/_static/image12.png)されます)</span><span class="sxs-lookup"><span data-stu-id="af5de-198">**Figure 4**: Add a Login Control to the Page  ([Click to view full-size image](validating-user-credentials-against-the-membership-user-store-vb/_static/image12.png))</span></span>

<span data-ttu-id="af5de-199">ブラウザーを使用してサイトにアクセスし、メンバーシップフレームワークの既存のユーザーとしてログインして、ログイン制御をテストしてみましょう。</span><span class="sxs-lookup"><span data-stu-id="af5de-199">Take a moment to test out the Login control by visiting the site through a browser and logging in as an existing user in the Membership framework.</span></span>

<span data-ttu-id="af5de-200">ログインコントロールの表示インターフェイスは、高度な構成が可能です。</span><span class="sxs-lookup"><span data-stu-id="af5de-200">The Login control's rendered interface is highly configurable.</span></span> <span data-ttu-id="af5de-201">外観に影響を与えるプロパティがいくつかあります。さらに、ユーザーインターフェイス要素のレイアウトを正確に制御するために、ログインコントロールをテンプレートに変換することができます。</span><span class="sxs-lookup"><span data-stu-id="af5de-201">There are a number of properties that influence its appearance; what's more, the Login control can be converted into a template for precise control over the layout the user interface elements.</span></span> <span data-ttu-id="af5de-202">この手順の残りの部分では、外観とレイアウトをカスタマイズする方法について説明します。</span><span class="sxs-lookup"><span data-stu-id="af5de-202">The remainder of this step examines how to customize the appearance and layout.</span></span>

### <a name="customizing-the-login-controls-appearance"></a><span data-ttu-id="af5de-203">ログインコントロールの外観のカスタマイズ</span><span class="sxs-lookup"><span data-stu-id="af5de-203">Customizing the Login Control's Appearance</span></span>

<span data-ttu-id="af5de-204">ログインコントロールの既定のプロパティ設定では、ユーザーインターフェイスが表示されます。これには、ユーザー名とパスワードの入力、[次回に保存] チェックボックス、[ログイン] ボタンがあります。</span><span class="sxs-lookup"><span data-stu-id="af5de-204">The Login control's default property settings render a user interface with a title ( Log In ), TextBox and Label controls for the username and password inputs, a Remember me next time CheckBox, and a Log In button.</span></span> <span data-ttu-id="af5de-205">これらの要素の外観は、すべて Login コントロールの多くのプロパティを使用して構成できます。</span><span class="sxs-lookup"><span data-stu-id="af5de-205">The appearances of these elements are all configurable through the Login control's numerous properties.</span></span> <span data-ttu-id="af5de-206">さらに、新しいユーザーアカウントを作成するためのページへのリンクなどの追加のユーザーインターフェイス要素は、プロパティまたは2を設定することによって追加できます。</span><span class="sxs-lookup"><span data-stu-id="af5de-206">Furthermore, additional user interface elements - such as a link to a page to create a new user account - can be added by setting a property or two.</span></span>

<span data-ttu-id="af5de-207">ログインコントロールの外観をさしに少し時間をかけてみましょう。</span><span class="sxs-lookup"><span data-stu-id="af5de-207">Let's spend a few moments to gussy up the appearance of our Login control.</span></span> <span data-ttu-id="af5de-208">[`Login.aspx`] ページには [ログイン] と表示されているページの上部に既にテキストがあるため、ログインコントロールのタイトルは余分です。</span><span class="sxs-lookup"><span data-stu-id="af5de-208">Since the `Login.aspx` page already has text at the top of the page that says Login, the Login control's title is superfluous.</span></span> <span data-ttu-id="af5de-209">そのため、ログインコントロールのタイトルを削除するには、 [`TitleText` プロパティ](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.titletext.aspx)の値をオフにします。</span><span class="sxs-lookup"><span data-stu-id="af5de-209">Therefore, clear out the [`TitleText` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.titletext.aspx) value in order to remove the Login control's title.</span></span>

<span data-ttu-id="af5de-210">[ユーザー名] と [パスワード]: 2 つのテキストボックスコントロールの左側にあるラベルは、それぞれ[`UserNameLabelText`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.usernamelabeltext.aspx)および[`PasswordLabelText` プロパティ](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.passwordlabeltext.aspx)を使用してカスタマイズできます。</span><span class="sxs-lookup"><span data-stu-id="af5de-210">The User Name: and Password: Labels to the left of the two TextBox controls can be customized through the [`UserNameLabelText`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.usernamelabeltext.aspx) and [`PasswordLabelText` properties](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.passwordlabeltext.aspx), respectively.</span></span> <span data-ttu-id="af5de-211">ユーザー名: ラベルを「ユーザー名:」に変更してみましょう。</span><span class="sxs-lookup"><span data-stu-id="af5de-211">Let's change the User Name: Label to read Username:.</span></span> <span data-ttu-id="af5de-212">ラベルとテキストボックスのスタイルは、それぞれ[`LabelStyle`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.labelstyle.aspx)と[`TextBoxStyle` のプロパティ](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.textboxstyle.aspx)を使用して構成できます。</span><span class="sxs-lookup"><span data-stu-id="af5de-212">The Label and TextBox styles are configurable through the [`LabelStyle`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.labelstyle.aspx) and [`TextBoxStyle` properties](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.textboxstyle.aspx), respectively.</span></span>

<span data-ttu-id="af5de-213">[次回に保存] チェックボックスの Text プロパティは、Login コントロールの[`RememberMeText` プロパティ](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.remembermetext.aspx)を使用して設定できます。既定のチェック状態は、 [`RememberMeSet` プロパティ](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.remembermeset.aspx)(既定値は False) を使用して構成できます。</span><span class="sxs-lookup"><span data-stu-id="af5de-213">The Remember me next time CheckBox's Text property can be set through the Login control's [`RememberMeText` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.remembermetext.aspx), and its default checked state is configurable through the [`RememberMeSet` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.remembermeset.aspx) (which defaults to False).</span></span> <span data-ttu-id="af5de-214">[次の時間を記憶する] チェックボックスが既定でオンになるように、[`RememberMeSet`] プロパティを [True] に設定します。</span><span class="sxs-lookup"><span data-stu-id="af5de-214">Go ahead and set the `RememberMeSet` property to True so that the Remember me next time CheckBox will be checked by default.</span></span>

<span data-ttu-id="af5de-215">ログインコントロールには、ユーザーインターフェイスコントロールのレイアウトを調整するための2つのプロパティが用意されています。</span><span class="sxs-lookup"><span data-stu-id="af5de-215">The Login control offers two properties for adjusting the layout of its user interface controls.</span></span> <span data-ttu-id="af5de-216">[`TextLayout` プロパティ](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.textlayout.aspx)は、ユーザー名: とパスワード: ラベルが対応するテキストボックスの左側に表示されるかどうかを示します (既定)。それ以外の場合は、その上に表示されます。</span><span class="sxs-lookup"><span data-stu-id="af5de-216">The [`TextLayout` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.textlayout.aspx) indicates whether the Username: and Password: Labels appear to the left of their corresponding TextBoxes (the default), or above them.</span></span> <span data-ttu-id="af5de-217">[`Orientation` プロパティ](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.orientation.aspx)は、ユーザー名とパスワードの入力が垂直方向 (もう一方の方) または水平方向のどちらに配置されているかを示します。</span><span class="sxs-lookup"><span data-stu-id="af5de-217">The [`Orientation` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.orientation.aspx) indicates whether the username and password inputs are situated vertically (one above the other) or horizontally.</span></span> <span data-ttu-id="af5de-218">これら2つのプロパティは既定値に設定したままにしておきますが、結果として得られる効果を確認するには、これら2つのプロパティを既定値以外の値に設定することをお勧めします。</span><span class="sxs-lookup"><span data-stu-id="af5de-218">I am going to leave these two properties set to their defaults, but I encourage you to try setting these two properties to their non-default values to see the resulting effect.</span></span>

> [!NOTE]
> <span data-ttu-id="af5de-219">次のセクション「ログインコントロールのレイアウトの構成」では、テンプレートを使用してレイアウトコントロールのユーザーインターフェイス要素の正確なレイアウトを定義する方法を見ていきます。</span><span class="sxs-lookup"><span data-stu-id="af5de-219">In the next section, Configuring the Login Control's Layout, we will look at using templates to define the precise layout of the Layout control's user interface elements.</span></span>

<span data-ttu-id="af5de-220">[`CreateUserText`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.createusertext.aspx)と[`CreateUserUrl` のプロパティ](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.createuserurl.aspx)を未登録に設定して、ログインコントロールのプロパティ設定をラップしますか?</span><span class="sxs-lookup"><span data-stu-id="af5de-220">Wrap up the Login control's property settings by setting the [`CreateUserText`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.createusertext.aspx) and [`CreateUserUrl` properties](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.createuserurl.aspx) to Not registered yet?</span></span> <span data-ttu-id="af5de-221">アカウントを作成します。</span><span class="sxs-lookup"><span data-stu-id="af5de-221">Create an account!</span></span> <span data-ttu-id="af5de-222">とはそれぞれ `~/Membership/CreatingUserAccounts.aspx`ます。</span><span class="sxs-lookup"><span data-stu-id="af5de-222">and `~/Membership/CreatingUserAccounts.aspx`, respectively.</span></span> <span data-ttu-id="af5de-223">これにより、 <a id="Tutorial05"> </a>[前のチュートリアル](creating-user-accounts-vb.md)で作成したページを指すログインコントロールのインターフェイスへのハイパーリンクが追加されます。</span><span class="sxs-lookup"><span data-stu-id="af5de-223">This adds a hyperlink to the Login control's interface pointing to the page we created in the <a id="Tutorial05"></a>[preceding tutorial](creating-user-accounts-vb.md).</span></span> <span data-ttu-id="af5de-224">ログインコントロールの[`HelpPageText`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.helppagetext.aspx)と[`HelpPageUrl` のプロパティ](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.helppageurl.aspx)と[`PasswordRecoveryText`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.passwordrecoverytext.aspx)および[`PasswordRecoveryUrl` プロパティ](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.passwordrecoveryurl.aspx)は同じように動作し、ヘルプページへのリンクとパスワードの回復ページが表示されます。</span><span class="sxs-lookup"><span data-stu-id="af5de-224">The Login control's [`HelpPageText`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.helppagetext.aspx) and [`HelpPageUrl` properties](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.helppageurl.aspx) and [`PasswordRecoveryText`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.passwordrecoverytext.aspx) and [`PasswordRecoveryUrl` properties](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.passwordrecoveryurl.aspx) work in the same manner, rendering links to a help page and a password recovery page.</span></span>

<span data-ttu-id="af5de-225">これらのプロパティの変更を行った後、ログインコントロールの宣言型のマークアップと外観は、図5に示すようになります。</span><span class="sxs-lookup"><span data-stu-id="af5de-225">After making these property changes, your Login control's declarative markup and appearance should look similar to that shown in Figure 5.</span></span>

<span data-ttu-id="af5de-226">[ログインコントロールのプロパティの値を ![して、その外観を決定します](validating-user-credentials-against-the-membership-user-store-vb/_static/image14.png)](validating-user-credentials-against-the-membership-user-store-vb/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="af5de-226">[![The Login Control's Properties' Values Dictate Its Appearance](validating-user-credentials-against-the-membership-user-store-vb/_static/image14.png)](validating-user-credentials-against-the-membership-user-store-vb/_static/image13.png)</span></span>

<span data-ttu-id="af5de-227">**図 5**: ログインコントロールのプロパティの値によって外観が決まります ([クリックすると、フルサイズの画像が表示](validating-user-credentials-against-the-membership-user-store-vb/_static/image15.png)されます)</span><span class="sxs-lookup"><span data-stu-id="af5de-227">**Figure 5**: The Login Control's Properties' Values Dictate Its Appearance  ([Click to view full-size image](validating-user-credentials-against-the-membership-user-store-vb/_static/image15.png))</span></span>

### <a name="configuring-the-login-controls-layout"></a><span data-ttu-id="af5de-228">ログインコントロールのレイアウトの構成</span><span class="sxs-lookup"><span data-stu-id="af5de-228">Configuring the Login Control's Layout</span></span>

<span data-ttu-id="af5de-229">ログイン Web コントロールの既定のユーザーインターフェイスは、HTML `<table>`でインターフェイスをレイアウトします。</span><span class="sxs-lookup"><span data-stu-id="af5de-229">The Login Web control's default user interface lays out the interface in an HTML `<table>`.</span></span> <span data-ttu-id="af5de-230">しかし、レンダリングされた出力をより細かく制御する必要がある場合はどうでしょうか。</span><span class="sxs-lookup"><span data-stu-id="af5de-230">But what if we need finer control over the rendered output?</span></span> <span data-ttu-id="af5de-231">場合によっては、`<table>` を一連の `<div>` タグに置き換える必要があります。</span><span class="sxs-lookup"><span data-stu-id="af5de-231">Maybe we want to replace the `<table>` with a series of `<div>` tags.</span></span> <span data-ttu-id="af5de-232">または、アプリケーションで認証に追加の資格情報が必要な場合はどうすればよいでしょうか。</span><span class="sxs-lookup"><span data-stu-id="af5de-232">Or what if our application requires additional credentials for authentication?</span></span> <span data-ttu-id="af5de-233">たとえば、多くの金融 web サイトでは、ユーザー名とパスワードだけでなく、個人識別番号 (PIN)、またはその他の識別情報も指定する必要があります。</span><span class="sxs-lookup"><span data-stu-id="af5de-233">Many financial websites, for instance, require users to supply not only a username and password, but also a Personal Identification Number (PIN), or other identifying information.</span></span> <span data-ttu-id="af5de-234">理由にかかわらず、ログインコントロールをテンプレートに変換することができます。この場合、インターフェイスの宣言型マークアップを明示的に定義できます。</span><span class="sxs-lookup"><span data-stu-id="af5de-234">Whatever the reasons may be, it is possible to convert the Login control into a template, from which we can explicitly define the interface's declarative markup.</span></span>

<span data-ttu-id="af5de-235">追加の資格情報を収集するためにログインコントロールを更新するには、次の2つの操作を行う必要があります。</span><span class="sxs-lookup"><span data-stu-id="af5de-235">We need to do two things in order to update the Login control to collect additional credentials:</span></span>

1. <span data-ttu-id="af5de-236">追加の資格情報を収集するための Web コントロールを含めるように、ログインコントロールのインターフェイスを更新します。</span><span class="sxs-lookup"><span data-stu-id="af5de-236">Update the Login control's interface to include Web control(s) to collect the additional credentials.</span></span>
2. <span data-ttu-id="af5de-237">ログインコントロールの内部認証ロジックをオーバーライドして、ユーザー名とパスワードが有効で、追加の資格情報が有効である場合にのみユーザーが認証されるようにします。</span><span class="sxs-lookup"><span data-stu-id="af5de-237">Override the Login control's internal authentication logic so that a user is only authenticated if their username and password is valid and their additional credentials are valid, too.</span></span>

<span data-ttu-id="af5de-238">最初のタスクを実行するには、ログインコントロールをテンプレートに変換し、必要な Web コントロールを追加する必要があります。</span><span class="sxs-lookup"><span data-stu-id="af5de-238">To accomplish the first task, we need to convert the Login control into a template and add the necessary Web controls.</span></span> <span data-ttu-id="af5de-239">2番目のタスクと同様に、コントロールの[`Authenticate` イベント](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.authenticate.aspx)のイベントハンドラーを作成することによって、ログインコントロールの認証ロジックを置き換えることができます。</span><span class="sxs-lookup"><span data-stu-id="af5de-239">As for the second task, the Login control's authentication logic can be superseded by creating an event handler for the control's [`Authenticate` event](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.authenticate.aspx).</span></span>

<span data-ttu-id="af5de-240">ログインコントロールを更新して、ユーザーにユーザー名、パスワード、および電子メールアドレスを要求し、指定された電子メールアドレスがファイルの電子メールアドレスと一致する場合にのみ、ユーザーを認証するようにしてみましょう。</span><span class="sxs-lookup"><span data-stu-id="af5de-240">Let's update the Login control so that it prompts users for their username, password, and email address and only authenticates the user if the email address supplied matches their email address on file.</span></span> <span data-ttu-id="af5de-241">まず、ログインコントロールのインターフェイスをテンプレートに変換する必要があります。</span><span class="sxs-lookup"><span data-stu-id="af5de-241">We first need to convert the Login control's interface to a template.</span></span> <span data-ttu-id="af5de-242">ログインコントロールのスマートタグから、[テンプレートに変換] オプションを選択します。</span><span class="sxs-lookup"><span data-stu-id="af5de-242">From the Login control's Smart Tag, choose the Convert to template option.</span></span>

<span data-ttu-id="af5de-243">[ログインコントロールをテンプレートに変換 ![には](validating-user-credentials-against-the-membership-user-store-vb/_static/image17.png)](validating-user-credentials-against-the-membership-user-store-vb/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="af5de-243">[![Convert the Login Control to a Template](validating-user-credentials-against-the-membership-user-store-vb/_static/image17.png)](validating-user-credentials-against-the-membership-user-store-vb/_static/image16.png)</span></span>

<span data-ttu-id="af5de-244">**図 6**: ログインコントロールをテンプレートに変換する ([クリックすると、フルサイズの画像が表示](validating-user-credentials-against-the-membership-user-store-vb/_static/image18.png)されます)</span><span class="sxs-lookup"><span data-stu-id="af5de-244">**Figure 6**: Convert the Login Control to a Template  ([Click to view full-size image](validating-user-credentials-against-the-membership-user-store-vb/_static/image18.png))</span></span>

> [!NOTE]
> <span data-ttu-id="af5de-245">ログインコントロールをテンプレート前のバージョンに戻すには、コントロールのスマートタグから [リセット] リンクをクリックします。</span><span class="sxs-lookup"><span data-stu-id="af5de-245">To revert the Login control to its pre-template version, click the Reset link from the control's Smart Tag.</span></span>

<span data-ttu-id="af5de-246">ログインコントロールをテンプレートに変換すると、ユーザーインターフェイスを定義する HTML 要素および Web コントロールを使用して、コントロールの宣言マークアップに `LayoutTemplate` が追加されます。</span><span class="sxs-lookup"><span data-stu-id="af5de-246">Converting the Login control to a template adds a `LayoutTemplate` to the control's declarative markup with HTML elements and Web controls defining the user interface.</span></span> <span data-ttu-id="af5de-247">図7に示すように、コントロールをテンプレートに変換すると、テンプレートを使用するときに、これらのプロパティ値は無視されるため、`TitleText`、`CreateUserUrl`などのプロパティウィンドウから多数のプロパティが削除されます。</span><span class="sxs-lookup"><span data-stu-id="af5de-247">As Figure 7 shows, converting the control to a template removes a number of properties from the Properties window, such as `TitleText`, `CreateUserUrl`, and so forth, since these property values are ignored when using a template.</span></span>

<span data-ttu-id="af5de-248">[ログインコントロールがテンプレートに変換されるときに使用できるプロパティを ![減らす](validating-user-credentials-against-the-membership-user-store-vb/_static/image20.png)](validating-user-credentials-against-the-membership-user-store-vb/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="af5de-248">[![Fewer Properties are Available When the Login Control is Converted to a Template](validating-user-credentials-against-the-membership-user-store-vb/_static/image20.png)](validating-user-credentials-against-the-membership-user-store-vb/_static/image19.png)</span></span>

<span data-ttu-id="af5de-249">**図 7**: ログインコントロールがテンプレートに変換されたときに使用できるプロパティが減る ([クリックすると、フルサイズの画像が表示](validating-user-credentials-against-the-membership-user-store-vb/_static/image21.png)されます)</span><span class="sxs-lookup"><span data-stu-id="af5de-249">**Figure 7**: Fewer Properties are Available When the Login Control is Converted to a Template  ([Click to view full-size image](validating-user-credentials-against-the-membership-user-store-vb/_static/image21.png))</span></span>

<span data-ttu-id="af5de-250">`LayoutTemplate` の HTML マークアップは、必要に応じて変更することができます。</span><span class="sxs-lookup"><span data-stu-id="af5de-250">The HTML markup in the `LayoutTemplate` may be modified as needed.</span></span> <span data-ttu-id="af5de-251">同様に、新しい Web コントロールをテンプレートに追加してもかまいません。</span><span class="sxs-lookup"><span data-stu-id="af5de-251">Likewise, feel free to add any new Web controls to the template.</span></span> <span data-ttu-id="af5de-252">ただし、ログイン制御のコア Web コントロールをテンプレートに残し、割り当てられた `ID` 値を保持することが重要です。</span><span class="sxs-lookup"><span data-stu-id="af5de-252">However, it is important that Login control's core Web controls remain in the template and keep their assigned `ID` values.</span></span> <span data-ttu-id="af5de-253">特に、`UserName` または `Password` のテキストボックス、[`RememberMe`] チェックボックス、[`LoginButton`] ボタン、`FailureText` ラベル、または `RequiredFieldValidator` コントロールを削除したり、名前を変更したりしないでください。</span><span class="sxs-lookup"><span data-stu-id="af5de-253">In particular, do not remove or rename the `UserName` or `Password` TextBoxes, the `RememberMe` CheckBox, the `LoginButton` Button, the `FailureText` Label, or the `RequiredFieldValidator` controls.</span></span>

<span data-ttu-id="af5de-254">訪問者の電子メールアドレスを収集するには、テンプレートにテキストボックスを追加する必要があります。</span><span class="sxs-lookup"><span data-stu-id="af5de-254">To collect the visitor's email address, we need to add a TextBox to the template.</span></span> <span data-ttu-id="af5de-255">`Password` テキストボックスを含むテーブル行 (`<tr>`) と、[次回保存] チェックボックスを保持するテーブル行の間に、次の宣言型マークアップを追加します。</span><span class="sxs-lookup"><span data-stu-id="af5de-255">Add the following declarative markup between the table row (`<tr>`) that contains the `Password` TextBox and the table row that holds the Remember me next time CheckBox:</span></span>

[!code-aspx[Main](validating-user-credentials-against-the-membership-user-store-vb/samples/sample2.aspx)]

<span data-ttu-id="af5de-256">`Email` テキストボックスを追加した後、ブラウザーを使用してページにアクセスします。</span><span class="sxs-lookup"><span data-stu-id="af5de-256">After adding the `Email` TextBox, visit the page through a browser.</span></span> <span data-ttu-id="af5de-257">図8に示すように、ログインコントロールのユーザーインターフェイスには、3番目のテキストボックスが含まれています。</span><span class="sxs-lookup"><span data-stu-id="af5de-257">As Figure 8 shows, the Login control's user interface now includes a third textbox.</span></span>

<span data-ttu-id="af5de-258">[ログインコントロールにユーザーの電子メールアドレスのテキストボックスが含まれるようになった ![](validating-user-credentials-against-the-membership-user-store-vb/_static/image23.png)](validating-user-credentials-against-the-membership-user-store-vb/_static/image22.png)</span><span class="sxs-lookup"><span data-stu-id="af5de-258">[![The Login Control Now Includes a Textbox for the User's Email Address](validating-user-credentials-against-the-membership-user-store-vb/_static/image23.png)](validating-user-credentials-against-the-membership-user-store-vb/_static/image22.png)</span></span>

<span data-ttu-id="af5de-259">**図 8**: ログインコントロールにユーザーの電子メールアドレスのテキストボックスが含まれるようになりました ([クリックすると、フルサイズの画像が表示](validating-user-credentials-against-the-membership-user-store-vb/_static/image24.png)されます)</span><span class="sxs-lookup"><span data-stu-id="af5de-259">**Figure 8**: The Login Control Now Includes a Textbox for the User's Email Address  ([Click to view full-size image](validating-user-credentials-against-the-membership-user-store-vb/_static/image24.png))</span></span>

<span data-ttu-id="af5de-260">この時点で、ログインコントロールは、まだ `Membership.ValidateUser` メソッドを使用して、指定された資格情報を検証しています。</span><span class="sxs-lookup"><span data-stu-id="af5de-260">At this point, the Login control is still using the `Membership.ValidateUser` method to validate the supplied credentials.</span></span> <span data-ttu-id="af5de-261">また、`Email` テキストボックスに入力した値は、ユーザーがログインできるかどうかには影響しません。</span><span class="sxs-lookup"><span data-stu-id="af5de-261">Correspondingly, the value entered into the `Email` TextBox has no bearing on whether the user can log in.</span></span> <span data-ttu-id="af5de-262">手順3では、ユーザー名とパスワードが有効であり、指定された電子メールアドレスがファイルの電子メールアドレスと一致する場合にのみ、資格情報が有効と見なされるように、ログインコントロールの認証ロジックを上書きする方法について説明します。</span><span class="sxs-lookup"><span data-stu-id="af5de-262">In Step 3 we will look at how to override the Login control's authentication logic so that the credentials are only considered valid if the username and password are valid and the supplied email address matches up with the email address on file.</span></span>

## <a name="step-3-modifying-the-login-controls-authentication-logic"></a><span data-ttu-id="af5de-263">手順 3: ログインコントロールの認証ロジックを変更する</span><span class="sxs-lookup"><span data-stu-id="af5de-263">Step 3: Modifying the Login Control's Authentication Logic</span></span>

<span data-ttu-id="af5de-264">ビジターが資格情報を入力し、[ログイン] ボタンをクリックすると、ポストバック ensues とログイン制御が、その認証ワークフローを通じて進行します。</span><span class="sxs-lookup"><span data-stu-id="af5de-264">When a visitor supplies her credentials and clicks the Log In button, a postback ensues and the Login control progresses through its authentication workflow.</span></span> <span data-ttu-id="af5de-265">ワークフローは、 [`LoggingIn` イベント](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.loggingin.aspx)を発生させて開始します。</span><span class="sxs-lookup"><span data-stu-id="af5de-265">The workflow starts by raising the [`LoggingIn` event](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.loggingin.aspx).</span></span> <span data-ttu-id="af5de-266">このイベントに関連付けられているすべてのイベントハンドラーは、`e.Cancel` プロパティを `True`に設定することによって、ログイン操作をキャンセルできます。</span><span class="sxs-lookup"><span data-stu-id="af5de-266">Any event handlers associated with this event may cancel the log in operation by setting the `e.Cancel` property to `True`.</span></span>

<span data-ttu-id="af5de-267">ログイン操作が取り消されていない場合、ワークフローは[`Authenticate` イベント](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.authenticate.aspx)を発生させて進行します。</span><span class="sxs-lookup"><span data-stu-id="af5de-267">If the log in operation is not cancelled, the workflow progresses by raising the [`Authenticate` event](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.authenticate.aspx).</span></span> <span data-ttu-id="af5de-268">`Authenticate` イベントのイベントハンドラーがある場合は、指定された資格情報が有効かどうかを判断する役割があります。</span><span class="sxs-lookup"><span data-stu-id="af5de-268">If there is an event handler for the `Authenticate` event, then it is responsible for determining whether the supplied credentials are valid or not.</span></span> <span data-ttu-id="af5de-269">イベントハンドラーが指定されていない場合、ログイン制御は `Membership.ValidateUser` メソッドを使用して資格情報の有効性を判断します。</span><span class="sxs-lookup"><span data-stu-id="af5de-269">If no event handler is specified, the Login control uses the `Membership.ValidateUser` method to determine the validity of the credentials.</span></span>

<span data-ttu-id="af5de-270">指定された資格情報が有効な場合は、フォーム認証チケットが作成され、 [`LoggedIn` イベント](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.loggedin.aspx)が発生し、ユーザーが適切なページにリダイレクトされます。</span><span class="sxs-lookup"><span data-stu-id="af5de-270">If the supplied credentials are valid, then the forms authentication ticket is created, the [`LoggedIn` event](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.loggedin.aspx) is raised, and the user is redirected to the appropriate page.</span></span> <span data-ttu-id="af5de-271">ただし、資格情報が無効と見なされた場合、 [`LoginError` イベント](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.loginerror.aspx)が発生し、ユーザーに資格情報が無効であることを知らせるメッセージが表示されます。</span><span class="sxs-lookup"><span data-stu-id="af5de-271">If, however, the credentials are deemed invalid, then the [`LoginError` event](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.loginerror.aspx) is raised and a message is displayed informing the user that their credentials were invalid.</span></span> <span data-ttu-id="af5de-272">既定では、エラーが発生した場合、ログイン制御は単に `FailureText` Label コントロールの Text プロパティをエラーメッセージに設定します (ログイン試行は成功しませんでした)。</span><span class="sxs-lookup"><span data-stu-id="af5de-272">By default, on failure the Login control simply sets its `FailureText` Label control's Text property to a failure message ( Your login attempt was not successful.</span></span> <span data-ttu-id="af5de-273">もう一度やり直してください。)</span><span class="sxs-lookup"><span data-stu-id="af5de-273">Please try again ).</span></span> <span data-ttu-id="af5de-274">ただし、ログインコントロールの[`FailureAction` プロパティ](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.failureaction.aspx)が `RedirectToLoginPage`に設定されている場合、ログインコントロールは、querystring パラメーター `loginfailure=1` を追加するログインページに `Response.Redirect` を発行します (これにより、ログイン制御によってエラーメッセージが表示されます)。</span><span class="sxs-lookup"><span data-stu-id="af5de-274">However, if the Login control's [`FailureAction` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.failureaction.aspx) is set to `RedirectToLoginPage`, then the Login control issues a `Response.Redirect` to the login page appending the querystring parameter `loginfailure=1` (which causes the Login control to display the failure message).</span></span>

<span data-ttu-id="af5de-275">図9に、認証ワークフローのフローチャートを提供します。</span><span class="sxs-lookup"><span data-stu-id="af5de-275">Figure 9 offers a flow chart of the authentication workflow.</span></span>

<span data-ttu-id="af5de-276">[ログインコントロールの認証ワークフローを ![する](validating-user-credentials-against-the-membership-user-store-vb/_static/image26.png)](validating-user-credentials-against-the-membership-user-store-vb/_static/image25.png)</span><span class="sxs-lookup"><span data-stu-id="af5de-276">[![The Login Control's Authentication Workflow](validating-user-credentials-against-the-membership-user-store-vb/_static/image26.png)](validating-user-credentials-against-the-membership-user-store-vb/_static/image25.png)</span></span>

<span data-ttu-id="af5de-277">**図 9**: ログインコントロールの認証ワークフロー ([クリックすると、フルサイズの画像が表示](validating-user-credentials-against-the-membership-user-store-vb/_static/image27.png)されます)</span><span class="sxs-lookup"><span data-stu-id="af5de-277">**Figure 9**: The Login Control's Authentication Workflow  ([Click to view full-size image](validating-user-credentials-against-the-membership-user-store-vb/_static/image27.png))</span></span>

> [!NOTE]
> <span data-ttu-id="af5de-278">`FailureAction`の `RedirectToLogin` ページ オプションを使用する場合は、次のシナリオを考慮してください。</span><span class="sxs-lookup"><span data-stu-id="af5de-278">If you are wondering when you would use the `FailureAction`'s `RedirectToLogin` page option, consider the following scenario.</span></span> <span data-ttu-id="af5de-279">現在、`Site.master` マスターページには、匿名ユーザーがアクセスしたときに、左側の列に "Hello" というテキストが表示されていますが、そのテキストをログインコントロールに置き換えることを考えています。</span><span class="sxs-lookup"><span data-stu-id="af5de-279">Right now our `Site.master` master page currently has the text, Hello, stranger displayed in the left column when visited by an anonymous user, but imagine that we wanted to replace that text with a Login control.</span></span> <span data-ttu-id="af5de-280">これにより、匿名ユーザーは、ログインページに直接アクセスする必要がなく、サイトの任意のページからログインできるようになります。</span><span class="sxs-lookup"><span data-stu-id="af5de-280">This would allow an anonymous user to log in from any page on the site, instead of requiring them to visit the login page directly.</span></span> <span data-ttu-id="af5de-281">ただし、マスターページによって表示されるログイン制御を使用してユーザーがログインできなかった場合は、ログインページ (`Login.aspx`) にリダイレクトすることをお勧めします。これは、マスターページに追加されていない新しいアカウントを作成したり、紛失したパスワードを取得したりするためのリンクなど、追加の指示やリンクなどの</span><span class="sxs-lookup"><span data-stu-id="af5de-281">However, if a user was unable to log in via the Login control rendered by the master page, it might make sense to redirect them to the login page (`Login.aspx`) because that page likely includes additional instructions, links, and other help - such as links to create a new account or retrieve a lost password - that were not added to the master page.</span></span>

### <a name="creating-theauthenticateevent-handler"></a><span data-ttu-id="af5de-282">`Authenticate`イベントハンドラーの作成</span><span class="sxs-lookup"><span data-stu-id="af5de-282">Creating the`Authenticate`Event Handler</span></span>

<span data-ttu-id="af5de-283">カスタム認証ロジックをプラグインするには、ログインコントロールの `Authenticate` イベントのイベントハンドラーを作成する必要があります。</span><span class="sxs-lookup"><span data-stu-id="af5de-283">In order to plug in our custom authentication logic, we need to create an event handler for the Login control's `Authenticate` event.</span></span> <span data-ttu-id="af5de-284">`Authenticate` イベントのイベントハンドラーを作成すると、次のイベントハンドラー定義が生成されます。</span><span class="sxs-lookup"><span data-stu-id="af5de-284">Creating an event handler for the `Authenticate` event will generate the following event handler definition:</span></span>

[!code-vb[Main](validating-user-credentials-against-the-membership-user-store-vb/samples/sample3.vb)]

<span data-ttu-id="af5de-285">ご覧のように、`Authenticate` イベントハンドラーには、 [`AuthenticateEventArgs`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.authenticateeventargs.aspx)型のオブジェクトが2番目の入力パラメーターとして渡されます。</span><span class="sxs-lookup"><span data-stu-id="af5de-285">As you can see, the `Authenticate` event handler is passed an object of type [`AuthenticateEventArgs`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.authenticateeventargs.aspx) as its second input parameter.</span></span> <span data-ttu-id="af5de-286">`AuthenticateEventArgs` クラスには、指定された資格情報が有効かどうかを指定するために使用される `Authenticated` という名前のブール型プロパティが含まれています。</span><span class="sxs-lookup"><span data-stu-id="af5de-286">The `AuthenticateEventArgs` class contains a Boolean property named `Authenticated` that is used to specify whether the supplied credentials are valid.</span></span> <span data-ttu-id="af5de-287">次に、指定された資格情報が有効かどうかを判断し、それに応じて `e.Authenticate` プロパティを設定するコードをここに記述します。</span><span class="sxs-lookup"><span data-stu-id="af5de-287">Our task, then, is to write code here that determines whether the supplied credentials are valid or not, and to set the `e.Authenticate` property accordingly.</span></span>

### <a name="determining-and-validating-the-supplied-credentials"></a><span data-ttu-id="af5de-288">指定された資格情報の確認と検証</span><span class="sxs-lookup"><span data-stu-id="af5de-288">Determining and Validating the Supplied Credentials</span></span>

<span data-ttu-id="af5de-289">ログインコントロールの[`UserName`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.username.aspx)と`Password` の[プロパティ](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.password.aspx)を使用して、ユーザーが入力したユーザー名とパスワードの資格情報を確認します。</span><span class="sxs-lookup"><span data-stu-id="af5de-289">Use the Login control's [`UserName`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.username.aspx) and [`Password` properties](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.password.aspx) to determine the username and password credentials entered by the user.</span></span> <span data-ttu-id="af5de-290">追加の Web コントロール (前の手順で追加した `Email` TextBox など) に入力された値を確認するには、`LoginControlID.FindControl`(" *`controlID`* ") を使用して、`ID` プロパティが *`controlID`* と等しいテンプレート内の web コントロールへのプログラムによる参照を取得します。</span><span class="sxs-lookup"><span data-stu-id="af5de-290">In order to determine the values entered into any additional Web controls (such as the `Email` TextBox we added in the previous step), use `LoginControlID.FindControl`("*`controlID`*") to obtain a programmatic reference to the Web control in the template whose `ID` property is equal to *`controlID`*.</span></span> <span data-ttu-id="af5de-291">たとえば、`Email` テキストボックスへの参照を取得するには、次のコードを使用します。</span><span class="sxs-lookup"><span data-stu-id="af5de-291">For example, to get a reference to the `Email` TextBox, use the following code:</span></span>

`Dim EmailTextBox As TextBox = CType(myLogin.FindControl("Email"), TextBox)`

<span data-ttu-id="af5de-292">ユーザーの資格情報を検証するには、次の2つの作業を行う必要があります。</span><span class="sxs-lookup"><span data-stu-id="af5de-292">In order to validate the user's credentials we need to do two things:</span></span>

1. <span data-ttu-id="af5de-293">指定されたユーザー名とパスワードが有効であることを確認してください</span><span class="sxs-lookup"><span data-stu-id="af5de-293">Ensure that the provided username and password are valid</span></span>
2. <span data-ttu-id="af5de-294">入力した電子メールアドレスが、ログインしようとしているユーザーのファイルの電子メールアドレスと一致していることを確認します</span><span class="sxs-lookup"><span data-stu-id="af5de-294">Ensure that email address entered matches the email address on file for the user attempting to log in</span></span>

<span data-ttu-id="af5de-295">最初のチェックを実行するには、手順1で示したのと同様に `Membership.ValidateUser` メソッドを使用するだけです。</span><span class="sxs-lookup"><span data-stu-id="af5de-295">To accomplish the first check we can simply use the `Membership.ValidateUser` method like we saw in Step 1.</span></span> <span data-ttu-id="af5de-296">2番目のチェックでは、ユーザーの電子メールアドレスを確認し、テキストボックスコントロールに入力した電子メールアドレスと比較できるようにする必要があります。</span><span class="sxs-lookup"><span data-stu-id="af5de-296">For the second check, we need to determine the user's email address so that we can compare it to the email address they entered into the TextBox control.</span></span> <span data-ttu-id="af5de-297">特定のユーザーに関する情報を取得するには、`Membership` クラスの[`GetUser` メソッド](https://msdn.microsoft.com/library/system.web.security.membership.getuser.aspx)を使用します。</span><span class="sxs-lookup"><span data-stu-id="af5de-297">To get information about a particular user, use the `Membership` class's [`GetUser` method](https://msdn.microsoft.com/library/system.web.security.membership.getuser.aspx).</span></span>

<span data-ttu-id="af5de-298">`GetUser` メソッドには、多くのオーバーロードがあります。</span><span class="sxs-lookup"><span data-stu-id="af5de-298">The `GetUser` method has a number of overloads.</span></span> <span data-ttu-id="af5de-299">パラメーターを渡さずに使用した場合は、現在ログインしているユーザーに関する情報が返されます。</span><span class="sxs-lookup"><span data-stu-id="af5de-299">If used without passing in any parameters, it returns information about the currently logged in user.</span></span> <span data-ttu-id="af5de-300">特定のユーザーに関する情報を取得するには、を呼び出し `GetUser` ユーザー名を渡します。</span><span class="sxs-lookup"><span data-stu-id="af5de-300">To get information about a particular user, call `GetUser` passing in their username.</span></span> <span data-ttu-id="af5de-301">どちらの場合も、`GetUser` は、`UserName`、`Email`、`IsApproved`、`IsOnline`などのプロパティを持つ[`MembershipUser` オブジェクト](https://msdn.microsoft.com/library/system.web.security.membershipuser.aspx)を返します。</span><span class="sxs-lookup"><span data-stu-id="af5de-301">Either way, `GetUser` returns a [`MembershipUser` object](https://msdn.microsoft.com/library/system.web.security.membershipuser.aspx), which has properties like `UserName`, `Email`, `IsApproved`, `IsOnline`, and so on.</span></span>

<span data-ttu-id="af5de-302">次のコードでは、これら2つのチェックを実装しています。</span><span class="sxs-lookup"><span data-stu-id="af5de-302">The following code implements these two checks.</span></span> <span data-ttu-id="af5de-303">両方が渡された場合、`e.Authenticate` は `True`に設定されます。それ以外の場合は `False`が割り当てられます。</span><span class="sxs-lookup"><span data-stu-id="af5de-303">If both pass, then `e.Authenticate` is set to `True`, otherwise it is assigned `False`.</span></span>

[!code-vb[Main](validating-user-credentials-against-the-membership-user-store-vb/samples/sample4.vb)]

<span data-ttu-id="af5de-304">このコードを使用して、有効なユーザーとしてログインし、正しいユーザー名、パスワード、および電子メールアドレスを入力します。</span><span class="sxs-lookup"><span data-stu-id="af5de-304">With this code in place, attempt to log in as a valid user, entering the correct username, password, and email address.</span></span> <span data-ttu-id="af5de-305">もう一度試してみてください。ただし、今回は意図的に無効な電子メールアドレスを使用しています (図10を参照)。</span><span class="sxs-lookup"><span data-stu-id="af5de-305">Try it again, but this time purposefully use an incorrect email address (see Figure 10).</span></span> <span data-ttu-id="af5de-306">最後に、存在しないユーザー名を使用して、3回目にします。</span><span class="sxs-lookup"><span data-stu-id="af5de-306">Finally, try it a third time using a non-existent username.</span></span> <span data-ttu-id="af5de-307">最初のケースでは、サイトに正常にログオンする必要がありますが、最後の2つのケースでは、ログインコントロールの無効な資格情報メッセージが表示されます。</span><span class="sxs-lookup"><span data-stu-id="af5de-307">In the first case you should be successfully logged on to the site, but in the last two cases you should see the Login control's invalid credentials message.</span></span>

<span data-ttu-id="af5de-308">[無効な電子メールアドレスを指定したときにログインできない ![Tito](validating-user-credentials-against-the-membership-user-store-vb/_static/image29.png)](validating-user-credentials-against-the-membership-user-store-vb/_static/image28.png)</span><span class="sxs-lookup"><span data-stu-id="af5de-308">[![Tito Cannot Log In When Supplying an Incorrect Email Address](validating-user-credentials-against-the-membership-user-store-vb/_static/image29.png)](validating-user-credentials-against-the-membership-user-store-vb/_static/image28.png)</span></span>

<span data-ttu-id="af5de-309">**図 10**: 無効な電子メールアドレスを指定するときにログインできない ([クリックしてフルサイズの画像を表示する](validating-user-credentials-against-the-membership-user-store-vb/_static/image30.png))</span><span class="sxs-lookup"><span data-stu-id="af5de-309">**Figure 10**: Tito Cannot Log In When Supplying an Incorrect Email Address  ([Click to view full-size image](validating-user-credentials-against-the-membership-user-store-vb/_static/image30.png))</span></span>

> [!NOTE]
> <span data-ttu-id="af5de-310">手順1の「メンバーシップフレームワークが無効なログイン試行を処理する方法」セクションで説明したように、`Membership.ValidateUser` メソッドが呼び出され、無効な資格情報が渡されると、無効なログイン試行を追跡し、指定された時間枠内に無効な試行回数を超えた場合にユーザーをロックアウトします。</span><span class="sxs-lookup"><span data-stu-id="af5de-310">As discussed in the How the Membership Framework Handles Invalid Login Attempts section in Step 1, when the `Membership.ValidateUser` method is called and passed invalid credentials, it keeps track of the invalid login attempt and locks out the user if they exceed a certain threshold of invalid attempts within a specified time window.</span></span> <span data-ttu-id="af5de-311">カスタム認証ロジックによって `ValidateUser` メソッドが呼び出されるため、有効なユーザー名のパスワードが正しくないと、無効なログイン試行カウンターが増加しますが、ユーザー名とパスワードが有効であっても、電子メールアドレスが正しくない場合は、このカウンターはインクリメントされません。</span><span class="sxs-lookup"><span data-stu-id="af5de-311">Since our custom authentication logic calls the `ValidateUser` method, an incorrect password for a valid username will increment the invalid login attempt counter, but this counter is not incremented in the case where the username and password are valid, but the email address is incorrect.</span></span> <span data-ttu-id="af5de-312">ハッカーがユーザー名とパスワードを知ることはほとんどなく、ブルートフォース手法を使用してユーザーの電子メールアドレスを決定する必要があるため、この動作は適切です。</span><span class="sxs-lookup"><span data-stu-id="af5de-312">Chances are, this behavior is suitable, since it's unlikely that a hacker will know the username and password, but have to use brute force techniques to determine the user's email address.</span></span>

## <a name="step-4-improving-the-login-controls-invalid-credentials-message"></a><span data-ttu-id="af5de-313">手順 4: ログインコントロールの無効な資格情報メッセージを改善する</span><span class="sxs-lookup"><span data-stu-id="af5de-313">Step 4: Improving the Login Control's Invalid Credentials Message</span></span>

<span data-ttu-id="af5de-314">ユーザーが無効な資格情報でログオンしようとすると、ログインの試行が失敗したことを示すメッセージが表示されます。</span><span class="sxs-lookup"><span data-stu-id="af5de-314">When a user attempts to log on with invalid credentials, the Login control displays a message explaining that the login attempt was unsuccessful.</span></span> <span data-ttu-id="af5de-315">特に、コントロールには[`FailureText` プロパティ](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.failuretext.aspx)によって指定されたメッセージが表示されます。このプロパティには、ログイン試行の既定値が正しくありませんでした。</span><span class="sxs-lookup"><span data-stu-id="af5de-315">In particular, the control displays the message specified by its [`FailureText` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.failuretext.aspx), which has a default value of Your login attempt was not successful.</span></span> <span data-ttu-id="af5de-316">再試行してください。</span><span class="sxs-lookup"><span data-stu-id="af5de-316">Please try again.</span></span>

<span data-ttu-id="af5de-317">ユーザーの資格情報が無効になる理由は数多くあります。</span><span class="sxs-lookup"><span data-stu-id="af5de-317">Recall that there are many reasons why a user's credentials may be invalid:</span></span>

- <span data-ttu-id="af5de-318">ユーザー名が存在しない可能性があります</span><span class="sxs-lookup"><span data-stu-id="af5de-318">The username may not exist</span></span>
- <span data-ttu-id="af5de-319">ユーザー名は存在しますが、パスワードが無効です</span><span class="sxs-lookup"><span data-stu-id="af5de-319">The username exists, but the password is invalid</span></span>
- <span data-ttu-id="af5de-320">ユーザー名とパスワードは有効ですが、ユーザーはまだ承認されていません</span><span class="sxs-lookup"><span data-stu-id="af5de-320">The username and password are valid, but the user is not yet approved</span></span>
- <span data-ttu-id="af5de-321">ユーザー名とパスワードは有効ですが、ユーザーがロックアウトされています (指定された期間内の無効なログイン試行回数を超えたことが原因である可能性があります)。</span><span class="sxs-lookup"><span data-stu-id="af5de-321">The username and password are valid, but the user is locked out (most likely because they exceeded the number of invalid login attempts within the specified time frame)</span></span>

<span data-ttu-id="af5de-322">また、カスタム認証ロジックを使用する場合もあります。</span><span class="sxs-lookup"><span data-stu-id="af5de-322">And there may be other reasons when using custom authentication logic.</span></span> <span data-ttu-id="af5de-323">たとえば、手順 3. で記述したコードでは、ユーザー名とパスワードは有効ですが、電子メールアドレスが正しくない可能性があります。</span><span class="sxs-lookup"><span data-stu-id="af5de-323">For example, with the code we wrote in Step 3, the username and password may be valid, but the email address may be incorrect.</span></span>

<span data-ttu-id="af5de-324">資格情報が無効である理由に関係なく、ログインコントロールでも同じエラーメッセージが表示されます。</span><span class="sxs-lookup"><span data-stu-id="af5de-324">Regardless of why the credentials are invalid, the Login control displays the same error message.</span></span> <span data-ttu-id="af5de-325">このフィードバックがないと、アカウントがまだ承認されていないユーザーや、ロックアウトされているユーザーが混乱する可能性があります。ただし、少しの作業で、ログインコントロールにより適切なメッセージが表示されるようにすることができます。</span><span class="sxs-lookup"><span data-stu-id="af5de-325">This lack of feedback can be confusing for a user whose account has not yet been approved or who has been locked out. With a little bit of work, though, we can have the Login control display a more appropriate message.</span></span>

<span data-ttu-id="af5de-326">ユーザーが無効な資格情報でログインしようとすると、ログイン制御によってその `LoginError` イベントが発生します。</span><span class="sxs-lookup"><span data-stu-id="af5de-326">Whenever a user attempts to login with invalid credentials the Login control raises its `LoginError` event.</span></span> <span data-ttu-id="af5de-327">このイベントのイベントハンドラーを作成し、次のコードを追加します。</span><span class="sxs-lookup"><span data-stu-id="af5de-327">Go ahead and create an event handler for this event, and add the following code:</span></span>

[!code-vb[Main](validating-user-credentials-against-the-membership-user-store-vb/samples/sample5.vb)]

<span data-ttu-id="af5de-328">上記のコードは、ログインコントロールの `FailureText` プロパティを既定値に設定することによって開始されます (ログイン試行は成功しませんでした。</span><span class="sxs-lookup"><span data-stu-id="af5de-328">The above code starts by setting the Login control's `FailureText` property to the default value ( Your login attempt was not successful.</span></span> <span data-ttu-id="af5de-329">もう一度やり直してください。)</span><span class="sxs-lookup"><span data-stu-id="af5de-329">Please try again ).</span></span> <span data-ttu-id="af5de-330">次に、指定されたユーザー名が既存のユーザーアカウントにマップされているかどうかを確認します。</span><span class="sxs-lookup"><span data-stu-id="af5de-330">It then checks to see if the username supplied maps to an existing user account.</span></span> <span data-ttu-id="af5de-331">その場合は、生成された `MembershipUser` オブジェクトの `IsLockedOut` と `IsApproved` プロパティを調べて、アカウントがロックアウトされているか、まだ承認されていないかを判断します。</span><span class="sxs-lookup"><span data-stu-id="af5de-331">If so, it consults the resulting `MembershipUser` object's `IsLockedOut` and `IsApproved` properties to determine if the account has been locked out or has not yet been approved.</span></span> <span data-ttu-id="af5de-332">どちらの場合も、`FailureText` プロパティは対応する値に更新されます。</span><span class="sxs-lookup"><span data-stu-id="af5de-332">In either case, the `FailureText` property is updated to a corresponding value.</span></span>

<span data-ttu-id="af5de-333">このコードをテストするには、既存のユーザーとしてログインを意図的に試みますが、正しくないパスワードを使用します。</span><span class="sxs-lookup"><span data-stu-id="af5de-333">To test this code, purposefully attempt to log in as an existing user, but use an incorrect password.</span></span> <span data-ttu-id="af5de-334">この処理は10分間の行で5回実行され、アカウントはロックアウトされます。図11に示すように、後続のログイン試行は (正しいパスワードを使用しても) 常に失敗しますが、無効なログイン試行回数が多すぎるため、アカウントがロックアウトされたことがわかりやすく表示されるようになりました。</span><span class="sxs-lookup"><span data-stu-id="af5de-334">Do this five times in a row within a 10 minute time frame and the account will be locked out. As Figure 11 shows, subsequent login attempts will always fail (even with the correct password), but will now display the more descriptive Your account has been locked out because of too many invalid login attempts.</span></span> <span data-ttu-id="af5de-335">アカウントのロックを解除するには、管理者に連絡してください。</span><span class="sxs-lookup"><span data-stu-id="af5de-335">Please contact the administrator to have your account unlocked message.</span></span>

<span data-ttu-id="af5de-336">[無効なログイン試行回数が多すぎて、ロックアウトされた ![Tito](validating-user-credentials-against-the-membership-user-store-vb/_static/image32.png)](validating-user-credentials-against-the-membership-user-store-vb/_static/image31.png)</span><span class="sxs-lookup"><span data-stu-id="af5de-336">[![Tito Performed Too Many Invalid Login Attempts and Has Been Locked Out](validating-user-credentials-against-the-membership-user-store-vb/_static/image32.png)](validating-user-credentials-against-the-membership-user-store-vb/_static/image31.png)</span></span>

<span data-ttu-id="af5de-337">**図 11**: Tito は無効なログイン試行回数が多すぎて、ロックアウトされています ([クリックすると、フルサイズの画像が表示](validating-user-credentials-against-the-membership-user-store-vb/_static/image33.png)されます)</span><span class="sxs-lookup"><span data-stu-id="af5de-337">**Figure 11**: Tito Performed Too Many Invalid Login Attempts and Has Been Locked Out  ([Click to view full-size image](validating-user-credentials-against-the-membership-user-store-vb/_static/image33.png))</span></span>

## <a name="summary"></a><span data-ttu-id="af5de-338">まとめ</span><span class="sxs-lookup"><span data-stu-id="af5de-338">Summary</span></span>

<span data-ttu-id="af5de-339">このチュートリアルの前に、ログインページでは、指定された資格情報を、ハードコーディングされたユーザー名とパスワードの組み合わせに対して検証しました。</span><span class="sxs-lookup"><span data-stu-id="af5de-339">Prior this tutorial, our login page validated the supplied credentials against a hard-coded list of username/password pairs.</span></span> <span data-ttu-id="af5de-340">このチュートリアルでは、メンバーシップフレームワークに対して資格情報を検証するためにページを更新しました。</span><span class="sxs-lookup"><span data-stu-id="af5de-340">In this tutorial, we updated the page to validate credentials against the Membership framework.</span></span> <span data-ttu-id="af5de-341">手順 1. では、`Membership.ValidateUser` メソッドをプログラムで使用する方法を説明しました。</span><span class="sxs-lookup"><span data-stu-id="af5de-341">In Step 1 we looked at using the `Membership.ValidateUser` method programmatically.</span></span> <span data-ttu-id="af5de-342">手順2では、手動で作成したユーザーインターフェイスとコードをログインコントロールに置き換えました。</span><span class="sxs-lookup"><span data-stu-id="af5de-342">In Step 2 we replaced our manually created user interface and code with the Login control.</span></span>

<span data-ttu-id="af5de-343">Login コントロールは、標準のログインユーザーインターフェイスをレンダリングし、メンバーシップフレームワークに対してユーザーの資格情報を自動的に検証します。</span><span class="sxs-lookup"><span data-stu-id="af5de-343">The Login control renders a standard login user interface and automatically validates the user's credentials against the Membership framework.</span></span> <span data-ttu-id="af5de-344">さらに、有効な資格情報がある場合、ログイン制御はフォーム認証を介してユーザーにサインインします。</span><span class="sxs-lookup"><span data-stu-id="af5de-344">Moreover, in the event of valid credentials, the Login control signs the user in via forms authentication.</span></span> <span data-ttu-id="af5de-345">簡単に言うと、完全に機能するログインユーザーエクスペリエンスは、ログインコントロールをページにドラッグするだけで利用できます。追加の宣言型マークアップやコードは必要ありません。</span><span class="sxs-lookup"><span data-stu-id="af5de-345">In short, a fully functional login user experience is available by simply dragging the Login control onto a page, no extra declarative markup or code necessary.</span></span> <span data-ttu-id="af5de-346">さらに、ログイン制御は高度なカスタマイズが可能で、レンダリングされたユーザーインターフェイスと認証ロジックの両方を細かく制御できます。</span><span class="sxs-lookup"><span data-stu-id="af5de-346">What's more, the Login control is highly customizable, allowing for a fine degree of control over both the rendered user interface and authentication logic.</span></span>

<span data-ttu-id="af5de-347">この時点で、web サイトの訪問者は、新しいユーザーアカウントを作成してサイトにログインできますが、認証されたユーザーに基づいてページへのアクセスを制限することを検討しています。</span><span class="sxs-lookup"><span data-stu-id="af5de-347">At this point visitors to our website can create a new user account and log into the site, but we have yet to look at restricting access to pages based on the authenticated user.</span></span> <span data-ttu-id="af5de-348">現在、認証または匿名のすべてのユーザーは、サイトの任意のページを表示できます。</span><span class="sxs-lookup"><span data-stu-id="af5de-348">Currently, any user, authenticated or anonymous, can view any page on our site.</span></span> <span data-ttu-id="af5de-349">ユーザーごとにサイトのページへのアクセスを制御することに加えて、ユーザーに依存する機能を持つ特定のページがある場合があります。</span><span class="sxs-lookup"><span data-stu-id="af5de-349">Along with controlling access to our site's pages on a user-by-user basis, we might have certain pages whose functionality depends on the user.</span></span> <span data-ttu-id="af5de-350">次のチュートリアルでは、ログインしているユーザーに基づいて、アクセスとページ内の機能を制限する方法について説明します。</span><span class="sxs-lookup"><span data-stu-id="af5de-350">The next tutorial looks at how to limit access and in-page functionality based on the logged in user.</span></span>

<span data-ttu-id="af5de-351">プログラミングを楽しんでください。</span><span class="sxs-lookup"><span data-stu-id="af5de-351">Happy Programming!</span></span>

### <a name="further-reading"></a><span data-ttu-id="af5de-352">参考資料</span><span class="sxs-lookup"><span data-stu-id="af5de-352">Further Reading</span></span>

<span data-ttu-id="af5de-353">このチュートリアルで説明しているトピックの詳細については、次のリソースを参照してください。</span><span class="sxs-lookup"><span data-stu-id="af5de-353">For more information on the topics discussed in this tutorial, refer to the following resources:</span></span>

- [<span data-ttu-id="af5de-354">ロックアウトされたユーザーと承認されていないユーザーにカスタムメッセージを表示する</span><span class="sxs-lookup"><span data-stu-id="af5de-354">Displaying Custom Messages to Locked Out and Non-Approved Users</span></span>](http://aspnet.4guysfromrolla.com/articles/050306-1.aspx)
- [<span data-ttu-id="af5de-355">ASP.NET 2.0 のメンバーシップ、ロール、およびプロファイルを調べています</span><span class="sxs-lookup"><span data-stu-id="af5de-355">Examining ASP.NET 2.0's Membership, Roles, and Profile</span></span>](http://aspnet.4guysfromrolla.com/articles/120705-1.aspx)
- [<span data-ttu-id="af5de-356">方法: ASP.NET ログインページを作成する</span><span class="sxs-lookup"><span data-stu-id="af5de-356">How To: Create an ASP.NET Login Page</span></span>](https://msdn.microsoft.com/library/ms178331.aspx)
- [<span data-ttu-id="af5de-357">ログイン制御の技術ドキュメント</span><span class="sxs-lookup"><span data-stu-id="af5de-357">Login Control Technical Documentation</span></span>](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.aspx)
- [<span data-ttu-id="af5de-358">ログインコントロールの使用</span><span class="sxs-lookup"><span data-stu-id="af5de-358">Using the Login Controls</span></span>](https://quickstarts.asp.net/QuickStartv20/aspnet/doc/security/login.aspx)

### <a name="about-the-author"></a><span data-ttu-id="af5de-359">著者について</span><span class="sxs-lookup"><span data-stu-id="af5de-359">About the Author</span></span>

<span data-ttu-id="af5de-360">1998以降、Microsoft の Web テクノロジを使用して、Scott Mitchell (複数の ASP/創設者4GuysFromRolla.com の執筆者) が Microsoft の Web テクノロジを使用しています。</span><span class="sxs-lookup"><span data-stu-id="af5de-360">Scott Mitchell, author of multiple ASP/ASP.NET books and founder of 4GuysFromRolla.com, has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="af5de-361">Scott は、独立したコンサルタント、トレーナー、およびライターとして機能します。</span><span class="sxs-lookup"><span data-stu-id="af5de-361">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="af5de-362">彼の最新の書籍は *[、ASP.NET 2.0 を24時間以内に教え](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)* ています。</span><span class="sxs-lookup"><span data-stu-id="af5de-362">His latest book is *[Sams Teach Yourself ASP.NET 2.0 in 24 Hours](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)*.</span></span> <span data-ttu-id="af5de-363">Scott は、 [mitchell@4guysfromrolla.com](mailto:mitchell@4guysfromrolla.com)またはブログで[http://ScottOnWriting.NET](http://scottonwriting.net/)にアクセスできます。</span><span class="sxs-lookup"><span data-stu-id="af5de-363">Scott can be reached at [mitchell@4guysfromrolla.com](mailto:mitchell@4guysfromrolla.com) or via his blog at [http://ScottOnWriting.NET](http://scottonwriting.net/).</span></span>

### <a name="special-thanks-to"></a><span data-ttu-id="af5de-364">ありがとうございました。</span><span class="sxs-lookup"><span data-stu-id="af5de-364">Special Thanks To</span></span>

<span data-ttu-id="af5de-365">このチュートリアルシリーズは、役に立つ多くのレビュー担当者によってレビューされました。</span><span class="sxs-lookup"><span data-stu-id="af5de-365">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="af5de-366">このチュートリアルのリードレビュー担当者は、Teresa Murphy と Michael Olivero でした。</span><span class="sxs-lookup"><span data-stu-id="af5de-366">Lead reviewers for this tutorial were Teresa Murphy and Michael Olivero.</span></span> <span data-ttu-id="af5de-367">今後の MSDN 記事を確認することに興味がありますか?</span><span class="sxs-lookup"><span data-stu-id="af5de-367">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="af5de-368">その場合は、 [mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com)の行を削除します。</span><span class="sxs-lookup"><span data-stu-id="af5de-368">If so, drop me a line at [mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com).</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="af5de-369">[前へ](creating-user-accounts-vb.md)
> [次へ](user-based-authorization-vb.md)</span><span class="sxs-lookup"><span data-stu-id="af5de-369">[Previous](creating-user-accounts-vb.md)
[Next](user-based-authorization-vb.md)</span></span>

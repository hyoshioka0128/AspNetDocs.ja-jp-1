---
uid: aspnet/overview/developing-apps-with-windows-azure/building-real-world-cloud-apps-with-windows-azure/design-to-survive-failures
title: (Azure で現実世界のクラウド アプリの構築) の障害から復旧する設計 |Microsoft Docs
author: MikeWasson
description: Azure 電子書籍で構築実世界クラウド アプリは、Scott Guthrie が開発したプレゼンテーションに基づいています。 13 のパターンとプラクティスを彼がについて説明しています.
ms.author: riande
ms.date: 06/12/2014
ms.assetid: 364ce84e-5af8-4e08-afc9-75a512b01f84
msc.legacyurl: /aspnet/overview/developing-apps-with-windows-azure/building-real-world-cloud-apps-with-windows-azure/design-to-survive-failures
msc.type: authoredcontent
ms.openlocfilehash: 54bfa40a7d853e29c42512ba375271587fb6f565
ms.sourcegitcommit: 51b01b6ff8edde57d8243e4da28c9f1e7f1962b2
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 05/06/2019
ms.locfileid: "65118840"
---
# <a name="design-to-survive-failures-building-real-world-cloud-apps-with-azure"></a><span data-ttu-id="1caf9-104">(Azure で現実世界のクラウド アプリの構築) の障害から復旧する設計します。</span><span class="sxs-lookup"><span data-stu-id="1caf9-104">Design to Survive Failures (Building Real-World Cloud Apps with Azure)</span></span>

<span data-ttu-id="1caf9-105">によって[Mike Wasson](https://github.com/MikeWasson)、 [Rick Anderson]((https://twitter.com/RickAndMSFT))、 [Tom Dykstra](https://github.com/tdykstra)</span><span class="sxs-lookup"><span data-stu-id="1caf9-105">by [Mike Wasson](https://github.com/MikeWasson), [Rick Anderson]((https://twitter.com/RickAndMSFT)), [Tom Dykstra](https://github.com/tdykstra)</span></span>

<span data-ttu-id="1caf9-106">[ダウンロードその修正プロジェクト](http://code.msdn.microsoft.com/Fix-It-app-for-Building-cdd80df4)または[電子書籍をダウンロード](http://blogs.msdn.com/b/microsoft_press/archive/2014/07/23/free-ebook-building-cloud-apps-with-microsoft-azure.aspx)</span><span class="sxs-lookup"><span data-stu-id="1caf9-106">[Download Fix It Project](http://code.msdn.microsoft.com/Fix-It-app-for-Building-cdd80df4) or [Download E-book](http://blogs.msdn.com/b/microsoft_press/archive/2014/07/23/free-ebook-building-cloud-apps-with-microsoft-azure.aspx)</span></span>

> <span data-ttu-id="1caf9-107">**構築現実世界の Cloud Apps with Azure**電子書籍は Scott Guthrie が開発したプレゼンテーションに基づきます。</span><span class="sxs-lookup"><span data-stu-id="1caf9-107">The **Building Real World Cloud Apps with Azure** e-book is based on a presentation developed by Scott Guthrie.</span></span> <span data-ttu-id="1caf9-108">13 のパターンについて説明しするのに役立つプラクティスは、クラウドの web アプリの開発が成功します。</span><span class="sxs-lookup"><span data-stu-id="1caf9-108">It explains 13 patterns and practices that can help you be successful developing web apps for the cloud.</span></span> <span data-ttu-id="1caf9-109">電子書籍の詳細については、次を参照してください。[第 1 章](introduction.md)します。</span><span class="sxs-lookup"><span data-stu-id="1caf9-109">For information about the e-book, see [the first chapter](introduction.md).</span></span>

<span data-ttu-id="1caf9-110">適切にエラーを処理し、続ける価値を提供するように、アプリを設計する方法は、のアプリケーション、特に 1 つが、多くの人が使用する、クラウドで実行される任意の型を作成する場合について考慮する必要がある点の 1 つとして考えられる。</span><span class="sxs-lookup"><span data-stu-id="1caf9-110">One of the things you have to think about when you build any type of application, but especially one that will run in the cloud where lots of people will be using it, is how to design the app so that it can gracefully handle failures and continue to deliver value as much as possible.</span></span> <span data-ttu-id="1caf9-111">十分な時間を指定するには、任意の環境または任意のソフトウェア システムで問題が発生する作業がうまきます。</span><span class="sxs-lookup"><span data-stu-id="1caf9-111">Given enough time, things are going to go wrong in any environment or any software system.</span></span> <span data-ttu-id="1caf9-112">お客様の取得方法感情的とどれ時間だけを決定します、アプリがそのような状況を処理する方法を分析し、問題の修正を使う必要です。</span><span class="sxs-lookup"><span data-stu-id="1caf9-112">How your app handles those situations determines how upset your customers will get and how much time you have to spend analyzing and fixing problems.</span></span>

## <a name="types-of-failures"></a><span data-ttu-id="1caf9-113">エラーの種類</span><span class="sxs-lookup"><span data-stu-id="1caf9-113">Types of failures</span></span>

<span data-ttu-id="1caf9-114">異なる方法で処理しエラーの 2 つの基本的なカテゴリがあります。</span><span class="sxs-lookup"><span data-stu-id="1caf9-114">There are two basic categories of failures that you'll want to handle differently:</span></span>

- <span data-ttu-id="1caf9-115">一時的なもの、断続的なネットワーク接続の問題などのエラーを自己復旧機能です。</span><span class="sxs-lookup"><span data-stu-id="1caf9-115">Transient, self-healing failures such as intermittent network connectivity issues.</span></span>
- <span data-ttu-id="1caf9-116">介入を必要とするエラーを支えます。</span><span class="sxs-lookup"><span data-stu-id="1caf9-116">Enduring failures that require intervention.</span></span>

<span data-ttu-id="1caf9-117">一時的な障害は、最も迅速かつ自動的にアプリが復旧時間のことを確認する再試行ポリシーを実装できます。</span><span class="sxs-lookup"><span data-stu-id="1caf9-117">For transient failures, you can implement a retry policy to ensure that most of the time the app recovers quickly and automatically.</span></span> <span data-ttu-id="1caf9-118">お客様には、次のような応答時間が若干長くなる可能性がありますに注意してください、それ以外の場合、影響しません。</span><span class="sxs-lookup"><span data-stu-id="1caf9-118">Your customers might notice slightly longer response time, but otherwise they won't be affected.</span></span> <span data-ttu-id="1caf9-119">これらのエラーを処理するためにいくつかの方法を紹介します、[章の一時的な障害処理](transient-fault-handling.md)します。</span><span class="sxs-lookup"><span data-stu-id="1caf9-119">We'll show some ways to handle these errors in the [Transient Fault Handling chapter](transient-fault-handling.md).</span></span>

<span data-ttu-id="1caf9-120">不朽のエラーの監視と問題が発生して、根本原因分析を容易にするときにすぐに通知する機能をログ記録を実装できます。</span><span class="sxs-lookup"><span data-stu-id="1caf9-120">For enduring failures, you can implement monitoring and logging functionality that notifies you promptly when issues arise and that facilitates root cause analysis.</span></span> <span data-ttu-id="1caf9-121">この種のエラーを掌握するためにいくつかの方法を紹介します、 [』 の「監視とテレメトリ](monitoring-and-telemetry.md)します。</span><span class="sxs-lookup"><span data-stu-id="1caf9-121">We'll show some ways to help you stay on top of these kinds of errors in the [Monitoring and Telemetry chapter](monitoring-and-telemetry.md).</span></span>

## <a name="failure-scope"></a><span data-ttu-id="1caf9-122">エラーのスコープ</span><span class="sxs-lookup"><span data-stu-id="1caf9-122">Failure scope</span></span>

<span data-ttu-id="1caf9-123">また、あるな障害の範囲を考慮する 1 台のコンピューターが影響を受けるかどうかなど、SQL Database、Storage、またはリージョン全体の全体のサービスです。</span><span class="sxs-lookup"><span data-stu-id="1caf9-123">You also have to think about failure scope – whether a single machine is affected, a whole service such as SQL Database or Storage, or an entire region.</span></span>

![エラーのスコープ](design-to-survive-failures/_static/image1.png)

### <a name="machine-failures"></a><span data-ttu-id="1caf9-125">コンピューターのエラー</span><span class="sxs-lookup"><span data-stu-id="1caf9-125">Machine failures</span></span>

<span data-ttu-id="1caf9-126">Azure では、障害が発生したサーバーに自動的に新しい置き換えられ、自動的かつ迅速に、適切に設計されたクラウド アプリがこの種のエラーから回復します。</span><span class="sxs-lookup"><span data-stu-id="1caf9-126">In Azure, a failed server is automatically replaced by a new one, and a well-designed cloud app recovers from this kind of failure automatically and quickly.</span></span> <span data-ttu-id="1caf9-127">ステートレス web 層のスケーラビリティのメリットを強調しました前と、故障したサーバーからの回復性が状態を保持しないという利点もあります。</span><span class="sxs-lookup"><span data-stu-id="1caf9-127">Earlier we stressed the scalability benefits of a stateless web tier, and ease of recovery from a failed server is another benefit of statelessness.</span></span> <span data-ttu-id="1caf9-128">回復性も SQL Database と Azure App Service Web Apps などのサービスとしてのプラットフォーム (PaaS) 機能の利点の 1 つです。</span><span class="sxs-lookup"><span data-stu-id="1caf9-128">Ease of recovery is also one of the benefits of platform-as-a-service (PaaS) features such as SQL Database and Azure App Service Web Apps.</span></span> <span data-ttu-id="1caf9-129">ハードウェアの障害はまれですが、これらのサービスは、それらを自動的に処理が発生するタイミングこれらのサービスを使用しているときに、コンピューターのエラーを処理するコードを記述する必要はありません。</span><span class="sxs-lookup"><span data-stu-id="1caf9-129">Hardware failures are rare, but when they occur these services handle them automatically; you don't even have to write code to handle machine failures when you're using one of these services.</span></span>

### <a name="service-failures"></a><span data-ttu-id="1caf9-130">サービスの失敗</span><span class="sxs-lookup"><span data-stu-id="1caf9-130">Service failures</span></span>

<span data-ttu-id="1caf9-131">クラウド アプリは、通常複数のサービスを使用します。</span><span class="sxs-lookup"><span data-stu-id="1caf9-131">Cloud apps typically use multiple services.</span></span> <span data-ttu-id="1caf9-132">たとえば、Fix It アプリは、SQL Database のサービス、ストレージ サービスを使用してし、を Azure App Service web アプリをデプロイします。</span><span class="sxs-lookup"><span data-stu-id="1caf9-132">For example, the Fix It app uses the SQL Database service, the Storage service, and the web app is deployed to Azure App Service.</span></span> <span data-ttu-id="1caf9-133">アプリ何に依存するサービスのいずれかが失敗した場合ですか。</span><span class="sxs-lookup"><span data-stu-id="1caf9-133">What will your app do if one of the services you depend on fails?</span></span> <span data-ttu-id="1caf9-134">エラーをわかりやすいサービスいくつかの「申し訳ありませんが、一度お試しください」メッセージはせいぜいできることになります。</span><span class="sxs-lookup"><span data-stu-id="1caf9-134">For some service failures a friendly "sorry, try again later" message might be the best you can do.</span></span> <span data-ttu-id="1caf9-135">多くのシナリオで行うことができます向上します。</span><span class="sxs-lookup"><span data-stu-id="1caf9-135">But in many scenarios you can do better.</span></span> <span data-ttu-id="1caf9-136">など、バックエンド データ ストアは、ときにユーザー入力を受け付ける、「要求が受け取られて、」を表示して他の任意の場所の入力を一時的に格納必要なサービスが再度、運用し、入力を取得および処理できます。</span><span class="sxs-lookup"><span data-stu-id="1caf9-136">For example, when your back-end data store is down, you can accept user input, display "your request has been received," and store the input someplace else temporarily; then when the service you need is operational again, you can retrieve the input and process it.</span></span>

<span data-ttu-id="1caf9-137">[キューを中心とした作業パターン](queue-centric-work-pattern.md)章は、このシナリオを処理する方法を示しています。</span><span class="sxs-lookup"><span data-stu-id="1caf9-137">The [Queue-centric Work Pattern](queue-centric-work-pattern.md) chapter shows one way to handle this scenario.</span></span> <span data-ttu-id="1caf9-138">Fix It アプリでは、SQL Database でタスクが格納されますが、SQL データベースがダウンする際に操作を終了する必要はありません。</span><span class="sxs-lookup"><span data-stu-id="1caf9-138">The Fix It app stores tasks in SQL Database, but it doesn't have to quit working when SQL Database is down.</span></span> <span data-ttu-id="1caf9-139">その章では、タスクのユーザー入力をキューに格納し、ワーカー プロセスを使用して、キューを読み取って、タスクを更新する方法を表示されます。</span><span class="sxs-lookup"><span data-stu-id="1caf9-139">In that chapter we'll see how to store user input for a task in a queue, and use a worker process to read the queue and update the task.</span></span> <span data-ttu-id="1caf9-140">SQL は、Fix It タスクを作成する機能は影響を受けません。ワーカー プロセスは待機し、SQL Database が利用可能な場合は、新しいタスクを処理できます。</span><span class="sxs-lookup"><span data-stu-id="1caf9-140">If SQL is down, the ability to create Fix It tasks is unaffected; the worker process can wait and process new tasks when SQL Database is available.</span></span>

### <a name="region-failures"></a><span data-ttu-id="1caf9-141">リージョン障害</span><span class="sxs-lookup"><span data-stu-id="1caf9-141">Region failures</span></span>

<span data-ttu-id="1caf9-142">リージョン全体が失敗する可能性があります。</span><span class="sxs-lookup"><span data-stu-id="1caf9-142">Entire regions may fail.</span></span> <span data-ttu-id="1caf9-143">自然災害がデータ センターに壊れる可能性がありますでの meteor フラット化された取得可能性があります、によるなど牛埋没させる farmer によって、データ センターにトランク行を切り取る。アプリが stricken データ センターでホストされている場合は何か。</span><span class="sxs-lookup"><span data-stu-id="1caf9-143">A natural disaster might destroy a data center, it might get flattened by a meteor, the trunk line into the datacenter could be cut by a farmer burying a cow with a backhoe, etc. If your app is hosted in the stricken datacenter what do you do?</span></span> <span data-ttu-id="1caf9-144">別のリージョンで実行されているいずれかで障害がある場合は、続行するように、複数のリージョンで同時に実行する Azure でのアプリを設定することになります。</span><span class="sxs-lookup"><span data-stu-id="1caf9-144">It's possible to set up your app in Azure to run in multiple regions simultaneously so that if there's a disaster in one, you continue running in another region.</span></span> <span data-ttu-id="1caf9-145">このようなエラーは、非常にまれな出現回数と、ほとんどのアプリは、この種のエラーで中断されないようにサービスを確実に行うための輪をジャンプはありません。</span><span class="sxs-lookup"><span data-stu-id="1caf9-145">Such failures are extremely rare occurrences, and most apps don't jump through the hoops necessary to ensure uninterrupted service through failures of this sort.</span></span> <span data-ttu-id="1caf9-146">リージョン障害も、使用可能なアプリを保持する方法についての章の末尾には、リソースを参照してください。</span><span class="sxs-lookup"><span data-stu-id="1caf9-146">See the Resources section at the end of the chapter for information about how to keep your app available even through a region failure.</span></span>

<span data-ttu-id="1caf9-147">Azure の目標は、すべてのこの種のエラーがずっと簡単に処理できるようにして、例をいくつかの方法で作業している、次の章がわかります。</span><span class="sxs-lookup"><span data-stu-id="1caf9-147">A goal of Azure is to make handling all of these kinds of failures a lot easier, and you'll see some examples of how we're doing that in the following chapters.</span></span>

## <a name="slas"></a><span data-ttu-id="1caf9-148">Sla</span><span class="sxs-lookup"><span data-stu-id="1caf9-148">SLAs</span></span>

<span data-ttu-id="1caf9-149">多くの場合、聞く、クラウド環境でのサービス レベル アグリーメント (Sla)。</span><span class="sxs-lookup"><span data-stu-id="1caf9-149">People often hear about service-level agreements (SLAs) in the cloud environment.</span></span> <span data-ttu-id="1caf9-150">基本的に、これらは、そのサービスの信頼性に関する約束する企業です。</span><span class="sxs-lookup"><span data-stu-id="1caf9-150">Basically these are promises that companies make about how reliable their service is.</span></span> <span data-ttu-id="1caf9-151">SLA は、99.9% は、サービスを 99.9% の時間、正しく動作するはずです。</span><span class="sxs-lookup"><span data-stu-id="1caf9-151">A 99.9% SLA means you should expect the service to be working correctly 99.9% of the time.</span></span> <span data-ttu-id="1caf9-152">SLA の非常に典型的な値は、非常に大きな数に似ていてどの程度のダウンタイムが気付かない可能性があります。 1% が実際には金額をします。</span><span class="sxs-lookup"><span data-stu-id="1caf9-152">That's a fairly typical value for an SLA and it sounds like a very high number, but you might not realize how much down time .1% actually amounts to.</span></span> <span data-ttu-id="1caf9-153">どの程度のダウンタイムが年、月、および 1 週間に生じるさまざまな SLA の割合を示すテーブルを次に示します。</span><span class="sxs-lookup"><span data-stu-id="1caf9-153">Here's a table that shows how much downtime various SLA percentages amount to over a year, a month, and a week.</span></span>

![SLA テーブル](design-to-survive-failures/_static/image2.png)

<span data-ttu-id="1caf9-155">したがって、1 年か 43.2 分 1 か月間 8.76 時間を 99.9% の SLA は、サービスを意味考えられます。</span><span class="sxs-lookup"><span data-stu-id="1caf9-155">So a 99.9% SLA means your service could be down 8.76 hours a year or 43.2 minutes a month.</span></span> <span data-ttu-id="1caf9-156">よりがダウンしている時間よりも、ほとんどの人を認識</span><span class="sxs-lookup"><span data-stu-id="1caf9-156">That's more down time than most people realize.</span></span> <span data-ttu-id="1caf9-157">そのため、開発者として、一定量のダウン タイムが可能なことに注意してくださいし、正常な方法で処理します。</span><span class="sxs-lookup"><span data-stu-id="1caf9-157">So as a developer you want to be aware that a certain amount of down time is possible and handle it in a graceful way.</span></span> <span data-ttu-id="1caf9-158">アプリを使用する予定はだれかがある時点で、サービスが停止しているしようとするのには、顧客の負の値の影響を最小限にしたいとします。</span><span class="sxs-lookup"><span data-stu-id="1caf9-158">At some point someone is going to be using your app, and a service is going to be down, and you want to minimize the negative impact of that on the customer.</span></span>

<span data-ttu-id="1caf9-159">SLA について知っておくべきことですが、どのような時間枠を指していますはに毎週、毎月、または毎年、クロックはリセットを取得しますか?。</span><span class="sxs-lookup"><span data-stu-id="1caf9-159">One thing you should know about an SLA is what time-frame it refers to: does the clock get reset every week, every month, or every year?</span></span> <span data-ttu-id="1caf9-160">Azure yearly SLA も良いか月間の一連のオフセットで月を非表示にするための年単位の SLA をよりは毎月を時計にリセットします。</span><span class="sxs-lookup"><span data-stu-id="1caf9-160">In Azure we reset the clock every month, which is better for you than a yearly SLA, since a yearly SLA could hide bad months by offsetting them with a series of good months.</span></span>

<span data-ttu-id="1caf9-161">もちろん SLA; よりも優れたに求められます常に通常よりもより少ないデータ ダウンできます。</span><span class="sxs-lookup"><span data-stu-id="1caf9-161">Of course we always aspire to do better than the SLA; usually you'll be down much less than that.</span></span> <span data-ttu-id="1caf9-162">保証が、私たちはこれまで下へのダウン タイムの最大長を超えて場合でも、返金にもらうことができます。</span><span class="sxs-lookup"><span data-stu-id="1caf9-162">The promise is that if we're ever down for longer than the maximum down time you can ask for money back.</span></span> <span data-ttu-id="1caf9-163">取得おそらく金額は完全に補償たびに、余分のビジネスへの影響が、SLA の側面は、強制ポリシーとして機能し、ことがわかったことは、真剣にすることができます。</span><span class="sxs-lookup"><span data-stu-id="1caf9-163">The amount of money you get back probably wouldn't fully compensate you for the business impact of the excess down time, but that aspect of the SLA acts as an enforcement policy and lets you know that we do take it very seriously.</span></span>

### <a name="composite-slas"></a><span data-ttu-id="1caf9-164">複合 Sla</span><span class="sxs-lookup"><span data-stu-id="1caf9-164">Composite SLAs</span></span>

<span data-ttu-id="1caf9-165">Sla の表示されているときに考慮する重要では、アプリケーションでは、複数のサービスを使用して別の SLA を持つ各 service での影響です。</span><span class="sxs-lookup"><span data-stu-id="1caf9-165">An important thing to think about when you're looking at SLAs is the impact of using multiple services in an app, with each service having a separate SLA.</span></span> <span data-ttu-id="1caf9-166">たとえば、Fix It アプリは、Azure App Service Web Apps、Azure Storage、および SQL Database を使用します。</span><span class="sxs-lookup"><span data-stu-id="1caf9-166">For example, the Fix It app uses Azure App Service Web Apps, Azure Storage, and SQL Database.</span></span> <span data-ttu-id="1caf9-167">この電子書籍は、2013 年 12 月で記述されている日の時点で、SLA の番号を次に示します。</span><span class="sxs-lookup"><span data-stu-id="1caf9-167">Here are their SLA numbers as of the date this e-book is being written in December, 2013:</span></span>

![Web サイト、ストレージ、SQL Database の SLA](design-to-survive-failures/_static/image3.png)

<span data-ttu-id="1caf9-169">これらのサービスの Sla に基づくアプリが期待する時間を最大値とは何ですか。</span><span class="sxs-lookup"><span data-stu-id="1caf9-169">What is the maximum down time you would expect for the app based on these service SLAs?</span></span> <span data-ttu-id="1caf9-170">ダウンタイムがある最悪の SLA の割合、または、99.9% 以上この場合と思わ可能性があります。</span><span class="sxs-lookup"><span data-stu-id="1caf9-170">You might think that your down time would be equal to the worst SLA percentage, or 99.9% in this case.</span></span> <span data-ttu-id="1caf9-171">True の場合は、同時に 3 つすべてのサービスが常に失敗しましたが、それは必ずしも実際の動作。</span><span class="sxs-lookup"><span data-stu-id="1caf9-171">That would be true if all three services always failed at the same time, but that isn't necessarily what actually happens.</span></span> <span data-ttu-id="1caf9-172">各サービスが失敗しない個別に、異なるタイミングに複合 SLA を個別の SLA の数値を乗算して計算する必要があるためです。</span><span class="sxs-lookup"><span data-stu-id="1caf9-172">Each service may fail independently at different times, so you have to calculate the composite SLA by multiplying the individual SLA numbers.</span></span>

![複合 SLA](design-to-survive-failures/_static/image4.png)

<span data-ttu-id="1caf9-174">したがって、アプリは、ダウンしている 43.2 分だけでなく、1 か月が 3 倍になる、1 か月間 – 108 分と Azure SLA の制限内にあります。</span><span class="sxs-lookup"><span data-stu-id="1caf9-174">So your app could be down not just 43.2 minutes a month but 3 times that amount, 108 minutes a month – and still be within the Azure SLA limits.</span></span>

<span data-ttu-id="1caf9-175">この問題は、Azure に固有ではありません。</span><span class="sxs-lookup"><span data-stu-id="1caf9-175">This issue is not unique to Azure.</span></span> <span data-ttu-id="1caf9-176">実際に最適なクラウドの使用可能な任意のクラウド サービスの Sla を提供してと同様の問題、仕入先のクラウド サービスを使用する場合、対処する必要があります。</span><span class="sxs-lookup"><span data-stu-id="1caf9-176">We actually provide the best cloud SLAs of any cloud service available, and you'll have similar issues to deal with if you use any vendor's cloud services.</span></span> <span data-ttu-id="1caf9-177">重要度、顧客やユーザーに影響するほど頻繁に起こる可能性があるため必然的なサービス エラーを適切に処理するアプリを設計する方法についての考え方は、この強調表示します。</span><span class="sxs-lookup"><span data-stu-id="1caf9-177">What this highlights is the importance of thinking about how you can design your app to handle the inevitable service failures gracefully, because they might happen often enough to impact your customers or users.</span></span>

### <a name="cloud-slas-compared-to-enterprise-down-time-experience"></a><span data-ttu-id="1caf9-178">エンタープライズ ダウン時のエクスペリエンスと比較してクラウドの Sla</span><span class="sxs-lookup"><span data-stu-id="1caf9-178">Cloud SLAs compared to enterprise down-time experience</span></span>

<span data-ttu-id="1caf9-179">"ユーザー場合があります、エンタープライズ アプリは決してあるとこれらの問題"</span><span class="sxs-lookup"><span data-stu-id="1caf9-179">People sometimes say, "In my enterprise app I never have these problems."</span></span> <span data-ttu-id="1caf9-180">1 か月間ダウン時間を求める場合が実際にある、作業は、通常は「も、発生場合があります」</span><span class="sxs-lookup"><span data-stu-id="1caf9-180">If you ask how much down time a month they actually have, they usually say, "Well, it happens occasionally."</span></span> <span data-ttu-id="1caf9-181">認めているどのくらいの頻度を依頼する場合、「をバックアップするか、新しいサーバーまたは update のソフトウェアをインストールする必要はあります」。</span><span class="sxs-lookup"><span data-stu-id="1caf9-181">And if you ask how often, they admit that "Sometimes we do need to back up or install a new server or update software."</span></span> <span data-ttu-id="1caf9-182">もちろん、ダウン時間としてカウントします。</span><span class="sxs-lookup"><span data-stu-id="1caf9-182">Of course, that counts as down time.</span></span> <span data-ttu-id="1caf9-183">ほとんどのエンタープライズ アプリ特にミッション クリティカルでない限りは実際にはダウン サービスの Sla で許容される時間よりです。</span><span class="sxs-lookup"><span data-stu-id="1caf9-183">Most enterprise apps unless they are especially mission-critical are actually down for more than the amount of time allowed by our service SLAs.</span></span> <span data-ttu-id="1caf9-184">終了時間以下が持つ不安を感じて傾向がありますが、サーバーと、インフラストラクチャとは、そのコントロールを担当する、します。</span><span class="sxs-lookup"><span data-stu-id="1caf9-184">But when it's your server and your infrastructure and you're responsible for it and in control of it, you tend to feel less angst about down times.</span></span> <span data-ttu-id="1caf9-185">クラウド環境で他のユーザーに依存しているし、何が起こっては認識しないためより心配を取得する傾向がある可能性があります。</span><span class="sxs-lookup"><span data-stu-id="1caf9-185">In a cloud environment you're dependent on someone else and you don't know what's going on, so you might tend to get more worried about it.</span></span>

<span data-ttu-id="1caf9-186">獲得すると、エンタープライズ SLA、クラウドから取得するよりも大きい稼働時間比率、彼らは、ハードウェアをより多くの費用をかけるでします。</span><span class="sxs-lookup"><span data-stu-id="1caf9-186">When an enterprise achieves a greater up-time percentage than you get from a cloud SLA, they do it by spending a lot more money on hardware.</span></span> <span data-ttu-id="1caf9-187">クラウド サービスでは、操作を行うことが、そのサービスの多くを請求する必要があります。</span><span class="sxs-lookup"><span data-stu-id="1caf9-187">A cloud service could do that but would have to charge much more for its services.</span></span> <span data-ttu-id="1caf9-188">代わりに、コスト効率に優れたサービスを活用し、必然的な障害を顧客に最小の中断が発生するように、ソフトウェアを設計します。</span><span class="sxs-lookup"><span data-stu-id="1caf9-188">Instead, you take advantage of a cost-effective service and design your software so that the inevitable failures cause minimum disruption to your customers.</span></span> <span data-ttu-id="1caf9-189">クラウド アプリのデザイナーとして、ジョブは、災害の回避に関するエラーを回避するために多くあり、ハードウェアではなく、ソフトウェアに重点を置いたその。</span><span class="sxs-lookup"><span data-stu-id="1caf9-189">Your job as a cloud app designer is not so much to avoid failure as to avoid catastrophe, and you do that by focusing on software, not on hardware.</span></span> <span data-ttu-id="1caf9-190">エンタープライズ アプリが平均故障間隔を最大化しようとすると、一方のクラウド アプリは、平均復旧時間を最小限に抑えるに努めています。</span><span class="sxs-lookup"><span data-stu-id="1caf9-190">Whereas enterprise apps strive to maximize mean time between failures, cloud apps strive to minimize mean time to recover.</span></span>

### <a name="not-all-cloud-services-have-slas"></a><span data-ttu-id="1caf9-191">すべてのクラウド サービスの Sla があります。</span><span class="sxs-lookup"><span data-stu-id="1caf9-191">Not all cloud services have SLAs</span></span>

<span data-ttu-id="1caf9-192">了承もいないすべてのクラウド サービスは、SLA をでもが。</span><span class="sxs-lookup"><span data-stu-id="1caf9-192">Be aware also that not every cloud service even has an SLA.</span></span> <span data-ttu-id="1caf9-193">アプリが稼働時間の保証はありませんでサービスに依存する場合は、想像よりも長くダウンすることもできます。</span><span class="sxs-lookup"><span data-stu-id="1caf9-193">If your app is dependent on a service with no up-time guarantee, you could be down far longer than you might imagine.</span></span> <span data-ttu-id="1caf9-194">たとえば、Facebook や Twitter などのソーシャル プロバイダーを使用して、サイトに、ログで有効にすると場合、SLA があるかどうかを発見する可能性がありますを確認するサービス プロバイダーに確認は 1 つはありません。</span><span class="sxs-lookup"><span data-stu-id="1caf9-194">For example, if you enable log-in to your site using a social provider such as Facebook or Twitter, check with the service provider to find out if there is an SLA, and you might find out there isn't one.</span></span> <span data-ttu-id="1caf9-195">ただし、顧客がアプリからロックアウトされた場合は、認証サービスがダウンするか大量の要求をサポートするようになって。</span><span class="sxs-lookup"><span data-stu-id="1caf9-195">But if the authentication service goes down or is unable to support the volume of requests you throw at it, your customers are locked out of your app.</span></span> <span data-ttu-id="1caf9-196">日以上、ダウンする可能性があります。</span><span class="sxs-lookup"><span data-stu-id="1caf9-196">You could be down for days or longer.</span></span> <span data-ttu-id="1caf9-197">1 つの新しいアプリの作成者が必要数億のダウンロードとが Facebook 認証 – 依存が遅すぎるライブと検出されたを移行する前に、Facebook に説明しませんでしたをそのサービスの SLA がありません。</span><span class="sxs-lookup"><span data-stu-id="1caf9-197">The creators of one new app expected hundreds of millions of downloads and took a dependency on Facebook authentication – but didn't talk to Facebook before going live and discovered too late that there was no SLA for that service.</span></span>

### <a name="not-all-downtime-counts-toward-slas"></a><span data-ttu-id="1caf9-198">Sla に向けたすべてダウンタイムのカウント</span><span class="sxs-lookup"><span data-stu-id="1caf9-198">Not all downtime counts toward SLAs</span></span>

<span data-ttu-id="1caf9-199">一部のクラウド サービスでは、過剰なアプリで使用する場合、サービスが意図的に拒否します。</span><span class="sxs-lookup"><span data-stu-id="1caf9-199">Some cloud services may deliberately deny service if your app over-uses them.</span></span> <span data-ttu-id="1caf9-200">これは呼び出されます*調整*します。</span><span class="sxs-lookup"><span data-stu-id="1caf9-200">This is called *throttling*.</span></span> <span data-ttu-id="1caf9-201">サービスに SLA がある場合は、条件は、調整される可能性がある、アプリの設計がそれらの条件を回避しに発生した場合、調整を適切に対処する必要がありますの条件の状態にする必要があります。</span><span class="sxs-lookup"><span data-stu-id="1caf9-201">If a service has an SLA, it should state the conditions under which you might be throttled, and your app design should avoid those conditions and react appropriately to the throttling if it happens.</span></span> <span data-ttu-id="1caf9-202">たとえば場合は、サービスへの要求を開始できない特定の数/秒を超えると、自動再試行が速すぎて、続行する、調整が発生することが発生しないかどうかを確認します。</span><span class="sxs-lookup"><span data-stu-id="1caf9-202">For example, if requests to a service start to fail when you exceed a certain number per second, you want to make sure automatic retries don't happen so fast that they cause the throttling to continue.</span></span> <span data-ttu-id="1caf9-203">調整について取り上げる、[章の一時的な障害処理](transient-fault-handling.md)します。</span><span class="sxs-lookup"><span data-stu-id="1caf9-203">We'll have more to say about throttling in the [Transient Fault Handling chapter](transient-fault-handling.md).</span></span>

## <a name="summary"></a><span data-ttu-id="1caf9-204">まとめ</span><span class="sxs-lookup"><span data-stu-id="1caf9-204">Summary</span></span>

<span data-ttu-id="1caf9-205">この章は、理由、現実世界のクラウド アプリは、障害を適切にから復旧するように設計する必要があります。 を実現できるようにしようとしています。</span><span class="sxs-lookup"><span data-stu-id="1caf9-205">This chapter has tried to help you realize why a real world cloud app has to be designed to survive failures gracefully.</span></span> <span data-ttu-id="1caf9-206">以降では、 [[次へ] の章](monitoring-and-telemetry.md)、このシリーズでは、それ以外のパターンは、そのために使用できるいくつかの方法の詳細に移動します。</span><span class="sxs-lookup"><span data-stu-id="1caf9-206">Starting with the [next chapter](monitoring-and-telemetry.md), the remaining patterns in this series go into more detail about some strategies you can use to do that:</span></span>

- <span data-ttu-id="1caf9-207">良いが[監視とテレメトリ](monitoring-and-telemetry.md)、問題を解決するための十分な情報を使用してすばやくの介入を必要とするエラーの詳細について確認するようにします。</span><span class="sxs-lookup"><span data-stu-id="1caf9-207">Have good [monitoring and telemetry](monitoring-and-telemetry.md), so that you find out quickly about failures that require intervention, and you have sufficient information to resolve them.</span></span>
- <span data-ttu-id="1caf9-208">[一時的な障害処理](transient-fault-handling.md)でき、にフォールバックするときに、アプリが自動的に回復するために、インテリジェントな再試行ロジックを実装することによって[サーキット ブレーカー](transient-fault-handling.md#circuitbreakers)できないときにロジック。</span><span class="sxs-lookup"><span data-stu-id="1caf9-208">[Handle transient faults](transient-fault-handling.md) by implementing intelligent retry logic, so that your app recovers automatically when it can and falls back to [circuit breaker](transient-fault-handling.md#circuitbreakers) logic when it can't.</span></span>
- <span data-ttu-id="1caf9-209">使用[分散キャッシュ](distributed-caching.md)データベース アクセスのスループット、待機時間、および接続の問題を最小限に抑えるためにします。</span><span class="sxs-lookup"><span data-stu-id="1caf9-209">Use [distributed caching](distributed-caching.md) in order to minimize throughput, latency, and connection problems with database access.</span></span>
- <span data-ttu-id="1caf9-210">実装の疎結合を使用して、[キューを中心とした作業パターン](queue-centric-work-pattern.md)バック エンドが下にあるときに、アプリのフロント エンドを続行するため、します。</span><span class="sxs-lookup"><span data-stu-id="1caf9-210">Implement loose coupling via the [queue-centric work pattern](queue-centric-work-pattern.md), so that your app front end can continue to work when the back end is down.</span></span>

## <a name="resources"></a><span data-ttu-id="1caf9-211">リソース</span><span class="sxs-lookup"><span data-stu-id="1caf9-211">Resources</span></span>

<span data-ttu-id="1caf9-212">詳細については、この電子書籍と、次のリソースの後の章を参照してください。</span><span class="sxs-lookup"><span data-stu-id="1caf9-212">For more information, see later chapters in this e-book and the following resources.</span></span>

<span data-ttu-id="1caf9-213">ドキュメント:</span><span class="sxs-lookup"><span data-stu-id="1caf9-213">Documentation:</span></span>

- <span data-ttu-id="1caf9-214">[フェール セーフ:回復力のあるクラウド アーキテクチャに関するガイダンス](https://msdn.microsoft.com/library/windowsazure/jj853352.aspx)します。</span><span class="sxs-lookup"><span data-stu-id="1caf9-214">[Failsafe: Guidance for Resilient Cloud Architectures](https://msdn.microsoft.com/library/windowsazure/jj853352.aspx).</span></span> <span data-ttu-id="1caf9-215">Marc Mercuri、Ulrich Homann、Andrew Townhill してホワイト ペーパー。</span><span class="sxs-lookup"><span data-stu-id="1caf9-215">White paper by Marc Mercuri, Ulrich Homann, and Andrew Townhill.</span></span> <span data-ttu-id="1caf9-216">フェール セーフ ビデオ シリーズの web ページ バージョンです。</span><span class="sxs-lookup"><span data-stu-id="1caf9-216">Web page version of the FailSafe video series.</span></span>
- <span data-ttu-id="1caf9-217">[Azure Cloud Services で大規模なサービスを設計するためのベスト プラクティス](https://msdn.microsoft.com/library/windowsazure/jj717232.aspx)します。</span><span class="sxs-lookup"><span data-stu-id="1caf9-217">[Best Practices for the Design of Large-Scale Services on Azure Cloud Services](https://msdn.microsoft.com/library/windowsazure/jj717232.aspx).</span></span> <span data-ttu-id="1caf9-218">Mark Simms、Michael Thomassy、ホワイト ペーパー。</span><span class="sxs-lookup"><span data-stu-id="1caf9-218">White paper by Mark Simms and Michael Thomassy.</span></span>
- <span data-ttu-id="1caf9-219">[Azure のビジネス継続性テクニカル ガイダンス](https://msdn.microsoft.com/library/windowsazure/hh873027.aspx)します。</span><span class="sxs-lookup"><span data-stu-id="1caf9-219">[Azure Business Continuity Technical Guidance](https://msdn.microsoft.com/library/windowsazure/hh873027.aspx).</span></span> <span data-ttu-id="1caf9-220">Patrick Wickline、Jason Roth、ホワイト ペーパー。</span><span class="sxs-lookup"><span data-stu-id="1caf9-220">White paper by Patrick Wickline and Jason Roth.</span></span>
- <span data-ttu-id="1caf9-221">[ディザスター リカバリーおよび Azure アプリケーションの高可用性](https://msdn.microsoft.com/library/windowsazure/dn251004.aspx)します。</span><span class="sxs-lookup"><span data-stu-id="1caf9-221">[Disaster Recovery and High Availability for Azure Applications](https://msdn.microsoft.com/library/windowsazure/dn251004.aspx).</span></span> <span data-ttu-id="1caf9-222">Michael McKeown、Hanu Kommalapati、Jason Roth、ホワイト ペーパー。</span><span class="sxs-lookup"><span data-stu-id="1caf9-222">White paper by Michael McKeown, Hanu Kommalapati, and Jason Roth.</span></span>
- <span data-ttu-id="1caf9-223">[Microsoft Patterns and Practices - Azure ガイダンス](https://msdn.microsoft.com/library/dn568099.aspx)します。</span><span class="sxs-lookup"><span data-stu-id="1caf9-223">[Microsoft Patterns and Practices - Azure Guidance](https://msdn.microsoft.com/library/dn568099.aspx).</span></span> <span data-ttu-id="1caf9-224">複数のデータ センターの展開ガイダンスについては、サーキット ブレーカー パターンを参照してください。</span><span class="sxs-lookup"><span data-stu-id="1caf9-224">See Multi Data Center Deployment guidance, Circuit breaker pattern.</span></span>
- <span data-ttu-id="1caf9-225">[Azure サポート - サービス レベル アグリーメント](https://azure.microsoft.com/support/legal/sla/)します。</span><span class="sxs-lookup"><span data-stu-id="1caf9-225">[Azure Support - Service Level Agreements](https://azure.microsoft.com/support/legal/sla/).</span></span>
- <span data-ttu-id="1caf9-226">[Azure SQL Database におけるビジネス継続性](https://msdn.microsoft.com/library/windowsazure/hh852669.aspx)します。</span><span class="sxs-lookup"><span data-stu-id="1caf9-226">[Business Continuity in Azure SQL Database](https://msdn.microsoft.com/library/windowsazure/hh852669.aspx).</span></span> <span data-ttu-id="1caf9-227">SQL のデータベース高可用性とディザスター リカバリー機能に関するドキュメントです。</span><span class="sxs-lookup"><span data-stu-id="1caf9-227">Documentation about SQL Database high availability and disaster recovery features.</span></span>
- <span data-ttu-id="1caf9-228">[高可用性とディザスター リカバリー Azure Virtual Machines における SQL Server の](https://msdn.microsoft.com/library/windowsazure/jj870962.aspx)します。</span><span class="sxs-lookup"><span data-stu-id="1caf9-228">[High Availability and Disaster Recovery for SQL Server in Azure Virtual Machines](https://msdn.microsoft.com/library/windowsazure/jj870962.aspx).</span></span>

<span data-ttu-id="1caf9-229">ビデオ:</span><span class="sxs-lookup"><span data-stu-id="1caf9-229">Videos:</span></span>

- <span data-ttu-id="1caf9-230">[フェール セーフ:スケーラブルで回復力のあるクラウド サービスの構築](https://channel9.msdn.com/Series/FailSafe)します。</span><span class="sxs-lookup"><span data-stu-id="1caf9-230">[FailSafe: Building Scalable, Resilient Cloud Services](https://channel9.msdn.com/Series/FailSafe).</span></span> <span data-ttu-id="1caf9-231">Ulrich Homann、Marc Mercuri、Mark Simms、9 部構成シリーズ。</span><span class="sxs-lookup"><span data-stu-id="1caf9-231">Nine-part series by Ulrich Homann, Marc Mercuri, and Mark Simms.</span></span> <span data-ttu-id="1caf9-232">Microsoft Customer ・ Advisory Team (CAT) の実際の顧客使用経験描画ストーリーと非常にアクセス可能な興味深い方法で高度な概念とアーキテクチャの原則を説明します。</span><span class="sxs-lookup"><span data-stu-id="1caf9-232">Presents high-level concepts and architectural principles in a very accessible and interesting way, with stories drawn from Microsoft Customer Advisory Team (CAT) experience with actual customers.</span></span> <span data-ttu-id="1caf9-233">エピソード 1 から 8 は、深さの障害から復旧するクラウド アプリをデザインする理由に移動します。</span><span class="sxs-lookup"><span data-stu-id="1caf9-233">Episodes 1 and 8 go in depth into the reasons for designing cloud apps to survive failures.</span></span> <span data-ttu-id="1caf9-234">49:57、障害点と障害モード エピソード 2 から始まる 56:05 でのディスカッションおよびエピソード 3 から始まる 40:55 でサーキット ブレーカーのディスカッションでエピソード 2 の開始時に調整のフォロー アップの説明を参照してください。</span><span class="sxs-lookup"><span data-stu-id="1caf9-234">See also the follow-up discussion of throttling in episode 2 starting at 49:57, the discussion of failure points and failure modes in episode 2 starting at 56:05, and the discussion of circuit breakers in episode 3 starting at 40:55.</span></span>
- <span data-ttu-id="1caf9-235">[大規模なビルド。Azure のお客様 - パート II から学んだ教訓](https://channel9.msdn.com/Events/Build/2012/3-030)します。</span><span class="sxs-lookup"><span data-stu-id="1caf9-235">[Building Big: Lessons learned from Azure customers - Part II](https://channel9.msdn.com/Events/Build/2012/3-030).</span></span> <span data-ttu-id="1caf9-236">Mark Simms は、エラーのための設計と、すべてのインストルメント化について説明します。</span><span class="sxs-lookup"><span data-stu-id="1caf9-236">Mark Simms talks about designing for failure and instrumenting everything.</span></span> <span data-ttu-id="1caf9-237">フェール セーフ シリーズが操作方法の詳細になると似ています。</span><span class="sxs-lookup"><span data-stu-id="1caf9-237">Similar to the Failsafe series but goes into more how-to details.</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="1caf9-238">[前へ](unstructured-blob-storage.md)
> [次へ](monitoring-and-telemetry.md)</span><span class="sxs-lookup"><span data-stu-id="1caf9-238">[Previous](unstructured-blob-storage.md)
[Next](monitoring-and-telemetry.md)</span></span>

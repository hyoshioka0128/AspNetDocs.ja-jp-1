---
uid: aspnet/overview/developing-apps-with-windows-azure/building-real-world-cloud-apps-with-windows-azure/queue-centric-work-pattern
title: キュー中心の作業パターン (Azure を使用した実際のクラウドアプリの構築) |Microsoft Docs
author: MikeWasson
description: Azure 電子ブックを使用した実際のクラウドアプリの構築は、Scott Guthrie によって開発されたプレゼンテーションに基づいています。 13のパターンとベストプラクティスについて説明します。
ms.author: riande
ms.date: 06/12/2014
ms.assetid: cc1ad51b-40c3-4c68-8620-9aaa0fd1f6cf
msc.legacyurl: /aspnet/overview/developing-apps-with-windows-azure/building-real-world-cloud-apps-with-windows-azure/queue-centric-work-pattern
msc.type: authoredcontent
ms.openlocfilehash: c73b070f11366e781bcea70ffc84fd49a47d469a
ms.sourcegitcommit: 22fbd8863672c4ad6693b8388ad5c8e753fb41a2
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 11/28/2019
ms.locfileid: "74582771"
---
# <a name="queue-centric-work-pattern-building-real-world-cloud-apps-with-azure"></a><span data-ttu-id="9496f-104">キュー中心の作業パターン (Azure を使用した実際のクラウドアプリの構築)</span><span class="sxs-lookup"><span data-stu-id="9496f-104">Queue-Centric Work Pattern (Building Real-World Cloud Apps with Azure)</span></span>

<span data-ttu-id="9496f-105">[Mike Wasson](https://github.com/MikeWasson)、 [Rick Anderson]((https://twitter.com/RickAndMSFT))、 [Tom Dykstra](https://github.com/tdykstra)</span><span class="sxs-lookup"><span data-stu-id="9496f-105">by [Mike Wasson](https://github.com/MikeWasson), [Rick Anderson]((https://twitter.com/RickAndMSFT)), [Tom Dykstra](https://github.com/tdykstra)</span></span>

<span data-ttu-id="9496f-106">[修正 It プロジェクトをダウンロード](https://code.msdn.microsoft.com/Fix-It-app-for-Building-cdd80df4)するか[、電子書籍をダウンロード](https://blogs.msdn.com/b/microsoft_press/archive/2014/07/23/free-ebook-building-cloud-apps-with-microsoft-azure.aspx)します</span><span class="sxs-lookup"><span data-stu-id="9496f-106">[Download Fix It Project](https://code.msdn.microsoft.com/Fix-It-app-for-Building-cdd80df4) or [Download E-book](https://blogs.msdn.com/b/microsoft_press/archive/2014/07/23/free-ebook-building-cloud-apps-with-microsoft-azure.aspx)</span></span>

> <span data-ttu-id="9496f-107">Azure 電子ブック**を使用した実際のクラウドアプリの構築**は、Scott Guthrie によって開発されたプレゼンテーションに基づいています。</span><span class="sxs-lookup"><span data-stu-id="9496f-107">The **Building Real World Cloud Apps with Azure** e-book is based on a presentation developed by Scott Guthrie.</span></span> <span data-ttu-id="9496f-108">ここでは、クラウド用の web アプリの開発を成功させるのに役立つ13のパターンとプラクティスについて説明します。</span><span class="sxs-lookup"><span data-stu-id="9496f-108">It explains 13 patterns and practices that can help you be successful developing web apps for the cloud.</span></span> <span data-ttu-id="9496f-109">電子書籍の詳細については、[最初の章](introduction.md)を参照してください。</span><span class="sxs-lookup"><span data-stu-id="9496f-109">For information about the e-book, see [the first chapter](introduction.md).</span></span>

<span data-ttu-id="9496f-110">前述のように、複数のサービスを使用すると、アプリの有効な SLA が個々の Sla の*製品*である "複合" sla が得られる可能性があります。</span><span class="sxs-lookup"><span data-stu-id="9496f-110">Earlier, we saw that using multiple services can result in a "composite" SLA, where the app's effective SLA is the *product* of the individual SLAs.</span></span> <span data-ttu-id="9496f-111">たとえば、It アプリを修正するには、Web サイト、ストレージ、および SQL Database を使用します。</span><span class="sxs-lookup"><span data-stu-id="9496f-111">For example, the Fix It app uses Web Sites, Storage, and SQL Database.</span></span> <span data-ttu-id="9496f-112">これらのサービスのいずれかが失敗した場合、アプリはユーザーにエラーを返します。</span><span class="sxs-lookup"><span data-stu-id="9496f-112">If any one of these services fails, the app will return an error to the user.</span></span>

<span data-ttu-id="9496f-113">キャッシュは、読み取り専用コンテンツの一時的なエラーを処理するのに適した方法です。</span><span class="sxs-lookup"><span data-stu-id="9496f-113">Caching is a good way to handle transient failures for read-only content.</span></span> <span data-ttu-id="9496f-114">しかし、アプリケーションが作業を行う必要がある場合はどうでしょうか。</span><span class="sxs-lookup"><span data-stu-id="9496f-114">But what if your application needs to do work?</span></span> <span data-ttu-id="9496f-115">たとえば、ユーザーが新しい Fix It タスクを送信した場合、アプリはタスクをキャッシュに配置するだけではありません。</span><span class="sxs-lookup"><span data-stu-id="9496f-115">For example, when the user submits a new Fix It task, the app can't just put the task into the cache.</span></span> <span data-ttu-id="9496f-116">アプリは、修正タスクを永続データストアに書き込み、処理できるようにする必要があります。</span><span class="sxs-lookup"><span data-stu-id="9496f-116">The app needs to write the Fix It task into a persistent data store, so it can be processed.</span></span>

<span data-ttu-id="9496f-117">ここで、キュー中心の作業パターンが登場します。</span><span class="sxs-lookup"><span data-stu-id="9496f-117">That's where the queue-centric work pattern comes in.</span></span> <span data-ttu-id="9496f-118">このパターンは、web 層とバックエンドサービス間の疎結合を可能にします。</span><span class="sxs-lookup"><span data-stu-id="9496f-118">This pattern enables loose coupling between a web tier and a backend service.</span></span>

<span data-ttu-id="9496f-119">パターンのしくみを次に示します。</span><span class="sxs-lookup"><span data-stu-id="9496f-119">Here's how the pattern works.</span></span> <span data-ttu-id="9496f-120">アプリケーションは、要求を取得すると、作業項目をキューに格納し、応答を直ちに返します。</span><span class="sxs-lookup"><span data-stu-id="9496f-120">When the application gets a request, it puts a work item onto a queue and immediately returns the response.</span></span> <span data-ttu-id="9496f-121">次に、別のバックエンドプロセスがキューから作業項目を取得し、作業を行います。</span><span class="sxs-lookup"><span data-stu-id="9496f-121">Then a separate backend process pulls work items from the queue and does the work.</span></span>

<span data-ttu-id="9496f-122">キュー中心の作業パターンは、次の場合に役立ちます。</span><span class="sxs-lookup"><span data-stu-id="9496f-122">The queue-centric work pattern is useful for:</span></span>

- <span data-ttu-id="9496f-123">時間がかかる作業 (待機時間が長くなります)。</span><span class="sxs-lookup"><span data-stu-id="9496f-123">Work that is time consuming (high latency).</span></span>
- <span data-ttu-id="9496f-124">常に使用できるとは限りません。</span><span class="sxs-lookup"><span data-stu-id="9496f-124">Work that requires an external service that might not always be available.</span></span>
- <span data-ttu-id="9496f-125">リソースを集中的に使用する作業 (高 CPU)。</span><span class="sxs-lookup"><span data-stu-id="9496f-125">Work that is resource-intensive (high CPU).</span></span>
- <span data-ttu-id="9496f-126">レート平準化によるメリットが得られる作業 (負荷の急激な増加による)。</span><span class="sxs-lookup"><span data-stu-id="9496f-126">Work that would benefit from rate leveling (subject to sudden load bursts).</span></span>

## <a name="reduced-latency"></a><span data-ttu-id="9496f-127">待機時間の短縮</span><span class="sxs-lookup"><span data-stu-id="9496f-127">Reduced Latency</span></span>

<span data-ttu-id="9496f-128">キューは、時間のかかる作業を行うときに便利です。</span><span class="sxs-lookup"><span data-stu-id="9496f-128">Queues are useful any time you are doing time-consuming work.</span></span> <span data-ttu-id="9496f-129">タスクの実行に数秒以上かかる場合は、エンドユーザーをブロックするのではなく、作業項目をキューに配置します。</span><span class="sxs-lookup"><span data-stu-id="9496f-129">If a task takes a few seconds or longer, instead of blocking the end user, put the work item into a queue.</span></span> <span data-ttu-id="9496f-130">ユーザーに "私たちが作業しています" という指示を出し、キューリスナーを使用してバックグラウンドでタスクを処理します。</span><span class="sxs-lookup"><span data-stu-id="9496f-130">Tell the user "We're working on it," and then use a queue listener to process the task in the background.</span></span>

<span data-ttu-id="9496f-131">たとえば、オンライン小売業者で購入すると、web サイトはすぐに注文を確認します。</span><span class="sxs-lookup"><span data-stu-id="9496f-131">For example, when you purchase something at an online retailer, the web site confirms your order immediately.</span></span> <span data-ttu-id="9496f-132">しかし、これは、既に送信されているトラックに含まれていることを意味するわけではありません。</span><span class="sxs-lookup"><span data-stu-id="9496f-132">But that doesn't mean your stuff is already in a truck being delivered.</span></span> <span data-ttu-id="9496f-133">タスクをキューに配置し、バックグラウンドでクレジット確認を行い、商品を発送するための準備を行います。</span><span class="sxs-lookup"><span data-stu-id="9496f-133">They put a task in a queue, and in the background they are doing the credit check, preparing your items for shipping, and so forth.</span></span>

<span data-ttu-id="9496f-134">待機時間が短いシナリオでは、タスクを同期的に実行する場合と比較して、エンドツーエンドの合計時間がキューを使用していない可能性があります。</span><span class="sxs-lookup"><span data-stu-id="9496f-134">For scenarios with short latency, the total end-to-end time might be longer using a queue, compared with doing the task synchronously.</span></span> <span data-ttu-id="9496f-135">ただし、その他の利点は、その欠点を上回る可能性があります。</span><span class="sxs-lookup"><span data-stu-id="9496f-135">But even then, the other benefits can outweigh that disadvantage.</span></span>

## <a name="increased-reliability"></a><span data-ttu-id="9496f-136">信頼性の向上</span><span class="sxs-lookup"><span data-stu-id="9496f-136">Increased Reliability</span></span>

<span data-ttu-id="9496f-137">これまでに見てきたバージョンの修正プログラムでは、web フロントエンドは SQL Database バックエンドと密接に結び付いています。</span><span class="sxs-lookup"><span data-stu-id="9496f-137">In the version of Fix It that we've been looking at so far, the web front-end is tightly coupled with the SQL Database back-end.</span></span> <span data-ttu-id="9496f-138">SQL database サービスが使用できない場合は、エラーが発生します。</span><span class="sxs-lookup"><span data-stu-id="9496f-138">If the SQL database service is unavailable, the user gets an error.</span></span> <span data-ttu-id="9496f-139">再試行が機能しない場合 (つまり、エラーが一時的なものを超えている場合) は、エラーを表示し、後で再試行するようにユーザーに要求するだけです。</span><span class="sxs-lookup"><span data-stu-id="9496f-139">If retries don't work (that is, the failure is more than transient), the only thing you can do is show an error and ask the user to try again later.</span></span>

![SQL Database バックエンドで障害が発生した場合の web フロントエンドの失敗を示す図](queue-centric-work-pattern/_static/image1.png)

<span data-ttu-id="9496f-141">キューを使用すると、ユーザーが Fix It タスクを送信するときに、アプリがメッセージをキューに書き込みます。</span><span class="sxs-lookup"><span data-stu-id="9496f-141">Using queues, when a user submits a Fix It task, the app writes a message to the queue.</span></span> <span data-ttu-id="9496f-142">メッセージペイロードは、タスクの[JSON](http://json.org/)表現です。</span><span class="sxs-lookup"><span data-stu-id="9496f-142">The message payload is a [JSON](http://json.org/) representation of the task.</span></span> <span data-ttu-id="9496f-143">メッセージがキューに書き込まれるとすぐに、アプリはが返され、ユーザーに成功を示すメッセージが直ちに表示されます。</span><span class="sxs-lookup"><span data-stu-id="9496f-143">As soon as the message is written to the queue, the app returns and immediately shows a success message to the user.</span></span>

<span data-ttu-id="9496f-144">SQL データベースやキューリスナーなどのバックエンドサービスがオフラインになった場合でも、ユーザーは新しい Fix It タスクを送信できます。</span><span class="sxs-lookup"><span data-stu-id="9496f-144">If any of the backend services – such as the SQL database or the queue listener -- go offline, users can still submit new Fix It tasks.</span></span> <span data-ttu-id="9496f-145">バックエンドサービスが再び使用可能になるまで、メッセージはキューに入れられます。</span><span class="sxs-lookup"><span data-stu-id="9496f-145">The messages will just queue up until the backend services are available again.</span></span> <span data-ttu-id="9496f-146">その時点で、バックログがバックエンドサービスによって検出されます。</span><span class="sxs-lookup"><span data-stu-id="9496f-146">At that point, the backend services will catch up on the backlog.</span></span>

![SQL Database エラーが発生したときに web フロントエンドが引き続き機能することを示す図](queue-centric-work-pattern/_static/image2.png)

<span data-ttu-id="9496f-148">さらに、フロントエンドの回復性について心配することなく、より多くのバックエンドロジックを追加できます。</span><span class="sxs-lookup"><span data-stu-id="9496f-148">Moreover, now you can add more backend logic without worrying about the resiliency of the front end.</span></span> <span data-ttu-id="9496f-149">たとえば、新しい修正プログラムが割り当てられるたびに、その所有者に電子メールまたは SMS メッセージを送信することができます。</span><span class="sxs-lookup"><span data-stu-id="9496f-149">For example, you might want to send an email or SMS message to the owner whenever a new Fix It is assigned.</span></span> <span data-ttu-id="9496f-150">電子メールまたは SMS サービスが使用できなくなった場合は、他のすべてを処理し、電子メール/SMS メッセージを送信するための別のキューにメッセージを配置できます。</span><span class="sxs-lookup"><span data-stu-id="9496f-150">If the email or SMS service becomes unavailable, you can process everything else, and then put a message into a separate queue for sending email/SMS messages.</span></span>

<span data-ttu-id="9496f-151">以前は、有効な SLA は Web Apps &times; ストレージ &times; SQL Database = 99.7% でした。</span><span class="sxs-lookup"><span data-stu-id="9496f-151">Previously, our effective SLA was Web Apps &times; Storage &times; SQL Database = 99.7%.</span></span> <span data-ttu-id="9496f-152">(「[エラーが](design-to-survive-failures.md)発生した場合の設計」を参照してください)。</span><span class="sxs-lookup"><span data-stu-id="9496f-152">(See [Design to Survive Failures](design-to-survive-failures.md).)</span></span>

<span data-ttu-id="9496f-153">キューを使用するようにアプリを変更すると、web フロントエンドは Web Apps とストレージのみに依存し、複合 SLA は99.8% になります。</span><span class="sxs-lookup"><span data-stu-id="9496f-153">When we change the app to use a queue, the web front end depends only on Web Apps and Storage, for a composite SLA of 99.8%.</span></span> <span data-ttu-id="9496f-154">(キューは Azure storage サービスの一部であるため、blob ストレージと同じ SLA に含まれています)。</span><span class="sxs-lookup"><span data-stu-id="9496f-154">(Note that queues are part of the Azure storage service, so they are included in the same SLA as blob storage.)</span></span>

<span data-ttu-id="9496f-155">99.8% よりもさらに高いパフォーマンスが必要な場合は、2つの異なるリージョンに2つのキューを作成できます。</span><span class="sxs-lookup"><span data-stu-id="9496f-155">If you need even better than 99.8%, you can create two queues in two different regions.</span></span> <span data-ttu-id="9496f-156">一方をプライマリ、もう1つをセカンダリとして指定します。</span><span class="sxs-lookup"><span data-stu-id="9496f-156">Designate one as the primary, and the other as the secondary.</span></span> <span data-ttu-id="9496f-157">プライマリキューが使用できない場合は、アプリでセカンダリキューにフェールオーバーします。</span><span class="sxs-lookup"><span data-stu-id="9496f-157">In your app, fail over to the secondary queue if the primary queue is not available.</span></span> <span data-ttu-id="9496f-158">同時に使用できなくなる可能性は非常に小さいものです。</span><span class="sxs-lookup"><span data-stu-id="9496f-158">The chance of both being unavailable at the same time is very small.</span></span>

## <a name="rate-leveling-and-independent-scaling"></a><span data-ttu-id="9496f-159">比率の平準化と独立したスケーリング</span><span class="sxs-lookup"><span data-stu-id="9496f-159">Rate Leveling and Independent Scaling</span></span>

<span data-ttu-id="9496f-160">キューは、*レート*調整や*負荷平準化*と呼ばれるものにも役立ちます。</span><span class="sxs-lookup"><span data-stu-id="9496f-160">Queues are also useful for something called *rate leveling* or *load leveling*.</span></span>

<span data-ttu-id="9496f-161">多くの場合、Web アプリはトラフィックの急激な増加の影響を受けやすくなります。</span><span class="sxs-lookup"><span data-stu-id="9496f-161">Web apps are often susceptible to sudden bursts in traffic.</span></span> <span data-ttu-id="9496f-162">自動スケールを使用して web サーバーを自動的に追加して、増加した web トラフィックを処理できますが、負荷の急増に対応するのに十分な速さで自動スケールを処理できない場合があります。</span><span class="sxs-lookup"><span data-stu-id="9496f-162">While you can use autoscaling to automatically add web servers to handle increased web traffic, autoscaling might not be able to react quickly enough to handle abrupt spikes in load.</span></span> <span data-ttu-id="9496f-163">Web サーバーが、キューにメッセージを書き込むことによって実行する必要のある作業の一部をオフロードできる場合は、より多くのトラフィックを処理できます。</span><span class="sxs-lookup"><span data-stu-id="9496f-163">If the web servers can offload some of the work they have to do by writing a message to a queue, they can handle more traffic.</span></span> <span data-ttu-id="9496f-164">バックエンドサービスは、キューからメッセージを読み取って処理することができます。</span><span class="sxs-lookup"><span data-stu-id="9496f-164">A backend service can then read messages from the queue and process them.</span></span> <span data-ttu-id="9496f-165">キューの深さは、受信負荷が変化するにつれて増加または縮小されます。</span><span class="sxs-lookup"><span data-stu-id="9496f-165">The depth of the queue will grow or shrink as the incoming load varies.</span></span>

<span data-ttu-id="9496f-166">時間のかかる作業のほとんどがバックエンドサービスに読み込まれないため、web 層はトラフィックの急激な急増に簡単に対応できます。</span><span class="sxs-lookup"><span data-stu-id="9496f-166">With much of its time-consuming work off-loaded to a backend service, the web tier can more easily respond to sudden spikes in traffic.</span></span> <span data-ttu-id="9496f-167">また、特定の量のトラフィックを少数の web サーバーで処理できるため、コストを削減できます。</span><span class="sxs-lookup"><span data-stu-id="9496f-167">And you save money because any given amount of traffic can be handled by fewer web servers.</span></span>

<span data-ttu-id="9496f-168">Web 層とバックエンドサービスは個別に拡張できます。</span><span class="sxs-lookup"><span data-stu-id="9496f-168">You can scale the web tier and backend service independently.</span></span> <span data-ttu-id="9496f-169">たとえば、3つの web サーバーが必要になる場合がありますが、キューメッセージを処理するサーバーは1つだけです。</span><span class="sxs-lookup"><span data-stu-id="9496f-169">For example, you might need three web servers but only one server processing queue messages.</span></span> <span data-ttu-id="9496f-170">また、多くのコンピューティング処理を要するタスクをバックグラウンドで実行している場合は、より多くのバックエンドサーバーが必要になることがあります。</span><span class="sxs-lookup"><span data-stu-id="9496f-170">Or if you're running a compute-intensive task in the background, you might need more backend servers.</span></span>

![](queue-centric-work-pattern/_static/image3.png)

<span data-ttu-id="9496f-171">自動スケールは、web 層と同様に、バックエンドサービスでも機能します。</span><span class="sxs-lookup"><span data-stu-id="9496f-171">Autoscaling works with backend services as well as with the web tier.</span></span> <span data-ttu-id="9496f-172">バックエンド Vm の CPU 使用率に基づいて、キュー内のタスクを処理している Vm の数をスケールアップまたはスケールダウンすることができます。</span><span class="sxs-lookup"><span data-stu-id="9496f-172">You can scale up or scale down the number of VMs that are processing the tasks in the queue, based on the CPU usage of the backend VMs.</span></span> <span data-ttu-id="9496f-173">または、キューにあるアイテムの数に基づいて自動スケールできます。</span><span class="sxs-lookup"><span data-stu-id="9496f-173">Or, you can autoscale based on how many items are in a queue.</span></span> <span data-ttu-id="9496f-174">たとえば、キュー内の項目数が10個を超えないように自動スケールに指示できます。</span><span class="sxs-lookup"><span data-stu-id="9496f-174">For example, you can tell autoscale to try to keep no more than 10 items in the queue.</span></span> <span data-ttu-id="9496f-175">キューに10個を超える項目がある場合は、自動スケールによって Vm が追加されます。</span><span class="sxs-lookup"><span data-stu-id="9496f-175">If the queue has more than 10 items, autoscale will add VMs.</span></span> <span data-ttu-id="9496f-176">これらが追いつくと、自動スケールによって余分な Vm が破棄されます。</span><span class="sxs-lookup"><span data-stu-id="9496f-176">When they catch up, autoscale will tear down the extra VMs.</span></span>

## <a name="adding-queues-to-the-fix-it-application"></a><span data-ttu-id="9496f-177">It アプリケーションを修正するためのキューの追加</span><span class="sxs-lookup"><span data-stu-id="9496f-177">Adding Queues to the Fix It Application</span></span>

<span data-ttu-id="9496f-178">キューパターンを実装するには、Fix It アプリに2つの変更を加える必要があります。</span><span class="sxs-lookup"><span data-stu-id="9496f-178">To implement the queue pattern, we need to make two changes to the Fix It app.</span></span>

- <span data-ttu-id="9496f-179">ユーザーが新しい Fix It タスクを送信するときに、タスクをデータベースに書き込むのではなく、キューに配置します。</span><span class="sxs-lookup"><span data-stu-id="9496f-179">When a user submits a new Fix It task, put the task in the queue, instead of writing it to the database.</span></span>
- <span data-ttu-id="9496f-180">キュー内のメッセージを処理するバックエンドサービスを作成します。</span><span class="sxs-lookup"><span data-stu-id="9496f-180">Create a back-end service that processes messages in the queue.</span></span>

<span data-ttu-id="9496f-181">キューについては、 [Azure Queue Storage サービス](https://www.windowsazure.com/develop/net/how-to-guides/queue-service/)を使用します。</span><span class="sxs-lookup"><span data-stu-id="9496f-181">For the queue, we'll use the [Azure Queue Storage Service](https://www.windowsazure.com/develop/net/how-to-guides/queue-service/).</span></span> <span data-ttu-id="9496f-182">別の方法として、 [Azure Service Bus](https://docs.microsoft.com/azure/service-bus/)を使用することもできます。</span><span class="sxs-lookup"><span data-stu-id="9496f-182">Another option is to use [Azure Service Bus](https://docs.microsoft.com/azure/service-bus/).</span></span>

<span data-ttu-id="9496f-183">どのキューサービスを使用するかを決定するには、アプリがキュー内のメッセージを送受信する方法を検討します。</span><span class="sxs-lookup"><span data-stu-id="9496f-183">To decide which queue service to use, consider how your app needs to send and receive the messages in the queue:</span></span>

- <span data-ttu-id="9496f-184">協調プロデューサーと競合コンシューマーがある場合は、Azure Queue Storage サービスの使用を検討してください。</span><span class="sxs-lookup"><span data-stu-id="9496f-184">If you have cooperating producers and competing consumers, consider using Azure Queue Storage Service.</span></span> <span data-ttu-id="9496f-185">"協調プロデューサー" とは、複数のプロセスがメッセージをキューに追加することを意味します。</span><span class="sxs-lookup"><span data-stu-id="9496f-185">"Cooperating producers" means multiple processes are adding messages to a queue.</span></span> <span data-ttu-id="9496f-186">"競合コンシューマー" とは、複数のプロセスがメッセージを処理するためにキューからメッセージをプルすることを意味しますが、特定のメッセージを処理できるのは1つの "コンシューマー" だけです。</span><span class="sxs-lookup"><span data-stu-id="9496f-186">"Competing consumers" means multiple processes are pulling messages off the queue to process them, but any given message can only be processed by one "consumer."</span></span> <span data-ttu-id="9496f-187">1つのキューで取得できるスループットよりも高いスループットが必要な場合は、追加のキューや追加のストレージアカウントを使用します。</span><span class="sxs-lookup"><span data-stu-id="9496f-187">If you need more throughput than you can get with a single queue, use additional queues and/or additional storage accounts.</span></span>
- <span data-ttu-id="9496f-188">[パブリッシュ/サブスクライブモデル](http://en.wikipedia.org/wiki/Publish/subscribe)が必要な場合は、Azure Service Bus キューを使用することを検討してください。</span><span class="sxs-lookup"><span data-stu-id="9496f-188">If you need a [publish/subscribe model](http://en.wikipedia.org/wiki/Publish/subscribe), consider using Azure Service Bus Queues.</span></span>

<span data-ttu-id="9496f-189">Fix It アプリは、協調するプロデューサーと競合コンシューマーモデルに適合しています。</span><span class="sxs-lookup"><span data-stu-id="9496f-189">The Fix It app fits the cooperating producers and competing consumers model.</span></span>

<span data-ttu-id="9496f-190">もう1つの考慮事項は、アプリケーションの可用性です。</span><span class="sxs-lookup"><span data-stu-id="9496f-190">Another consideration is application availability.</span></span> <span data-ttu-id="9496f-191">Queue Storage サービスは、blob Storage に使用しているものと同じサービスの一部であるため、SLA には影響しません。</span><span class="sxs-lookup"><span data-stu-id="9496f-191">The Queue Storage Service is part of the same service that we're using for blob storage, so using it has no effect on our SLA.</span></span> <span data-ttu-id="9496f-192">Azure Service Bus は、独自の SLA を持つ独立したサービスです。</span><span class="sxs-lookup"><span data-stu-id="9496f-192">Azure Service Bus is a separate service with its own SLA.</span></span> <span data-ttu-id="9496f-193">Service Bus キューを使用した場合は、追加の SLA の割合を考慮する必要があります。また、複合 SLA は低くなります。</span><span class="sxs-lookup"><span data-stu-id="9496f-193">If we used Service Bus Queues, we would have to factor in an additional SLA percentage, and our composite SLA would be lower.</span></span> <span data-ttu-id="9496f-194">Queue サービスを選択するときは、アプリケーションの可用性に与える影響について理解しておいてください。</span><span class="sxs-lookup"><span data-stu-id="9496f-194">When you're choosing a queue service, make sure you understand the impact of your choice on application availability.</span></span> <span data-ttu-id="9496f-195">詳細については、「 [resources](#resources) 」セクションを参照してください。</span><span class="sxs-lookup"><span data-stu-id="9496f-195">For more information, see the [Resources](#resources) section.</span></span>

## <a name="creating-queue-messages"></a><span data-ttu-id="9496f-196">キューメッセージの作成</span><span class="sxs-lookup"><span data-stu-id="9496f-196">Creating Queue Messages</span></span>

<span data-ttu-id="9496f-197">このタスクをキューに配置するために、web フロントエンドは次の手順を実行します。</span><span class="sxs-lookup"><span data-stu-id="9496f-197">To put a Fix It task on the queue, the web front end performs the following steps:</span></span>

1. <span data-ttu-id="9496f-198">[Cloudqueueclient](https://msdn.microsoft.com/library/microsoft.windowsazure.storage.queue.cloudqueueclient.aspx)インスタンスを作成します。</span><span class="sxs-lookup"><span data-stu-id="9496f-198">Create a [CloudQueueClient](https://msdn.microsoft.com/library/microsoft.windowsazure.storage.queue.cloudqueueclient.aspx) instance.</span></span> <span data-ttu-id="9496f-199">`CloudQueueClient` インスタンスは、Queue サービスに対して要求を実行するために使用されます。</span><span class="sxs-lookup"><span data-stu-id="9496f-199">The `CloudQueueClient` instance is used to execute requests against the Queue Service.</span></span>
2. <span data-ttu-id="9496f-200">キューを作成します (まだ存在しない場合)。</span><span class="sxs-lookup"><span data-stu-id="9496f-200">Create the queue, if it doesn't exist yet.</span></span>
3. <span data-ttu-id="9496f-201">Fix It タスクをシリアル化します。</span><span class="sxs-lookup"><span data-stu-id="9496f-201">Serialize the Fix It task.</span></span>
4. <span data-ttu-id="9496f-202">メッセージをキューに配置するには、 [Cloudqueue. AddMessageAsync](https://msdn.microsoft.com/library/microsoft.windowsazure.storage.queue.cloudqueue.addmessageasync.aspx)を呼び出します。</span><span class="sxs-lookup"><span data-stu-id="9496f-202">Call [CloudQueue.AddMessageAsync](https://msdn.microsoft.com/library/microsoft.windowsazure.storage.queue.cloudqueue.addmessageasync.aspx) to put the message onto the queue.</span></span>

<span data-ttu-id="9496f-203">この作業は、新しい `FixItQueueManager` クラスのコンストラクターと `SendMessageAsync` メソッドで行います。</span><span class="sxs-lookup"><span data-stu-id="9496f-203">We'll do this work in the constructor and `SendMessageAsync` method of a new `FixItQueueManager` class.</span></span>

[!code-csharp[Main](queue-centric-work-pattern/samples/sample1.cs?highlight=11-12,16,18-25)]

<span data-ttu-id="9496f-204">ここでは、 [Json.NET](https://github.com/JamesNK/Newtonsoft.Json)ライブラリを使用して、FIXIT を Json 形式にシリアル化しています。</span><span class="sxs-lookup"><span data-stu-id="9496f-204">Here we are using the [Json.NET](https://github.com/JamesNK/Newtonsoft.Json) library to serialize the fixit to JSON format.</span></span> <span data-ttu-id="9496f-205">任意のシリアル化方法を使用できます。</span><span class="sxs-lookup"><span data-stu-id="9496f-205">You can use whatever serialization approach you prefer.</span></span> <span data-ttu-id="9496f-206">JSON には人間が判読できるという利点がありますが、XML よりも詳細が少なくなっています。</span><span class="sxs-lookup"><span data-stu-id="9496f-206">JSON has the advantage of being human-readable, while being less verbose than XML.</span></span>

<span data-ttu-id="9496f-207">実稼働品質のコードは、エラー処理ロジックを追加し、データベースが使用できなくなった場合は一時停止し、回復をより明確に処理し、アプリケーションの起動時にキューを作成し、"[有害な" メッセージ](https://msdn.microsoft.com/library/ms789028(v=vs.110).aspx)を管理します。</span><span class="sxs-lookup"><span data-stu-id="9496f-207">Production-quality code would add error handling logic, pause if the database became unavailable, handle recovery more cleanly, create the queue on application start-up, and manage "[poison" messages](https://msdn.microsoft.com/library/ms789028(v=vs.110).aspx).</span></span> <span data-ttu-id="9496f-208">(有害メッセージとは、何らかの理由で処理できないメッセージのことです。</span><span class="sxs-lookup"><span data-stu-id="9496f-208">(A poison message is a message that cannot be processed for some reason.</span></span> <span data-ttu-id="9496f-209">有害なメッセージがキューに置かれないようにする必要があります。ワーカーロールは、そのメッセージを継続的に処理したり、失敗したり、再試行したり、失敗したりします)。</span><span class="sxs-lookup"><span data-stu-id="9496f-209">You don't want poison messages to sit in the queue, where the worker role will continually try to process them, fail, try again, fail, and so on.)</span></span>

<span data-ttu-id="9496f-210">フロントエンド MVC アプリケーションでは、新しいタスクを作成するコードを更新する必要があります。</span><span class="sxs-lookup"><span data-stu-id="9496f-210">In the front-end MVC application, we need to update the code that creates a new task.</span></span> <span data-ttu-id="9496f-211">タスクをリポジトリに配置するのではなく、上に示した `SendMessageAsync` メソッドを呼び出します。</span><span class="sxs-lookup"><span data-stu-id="9496f-211">Instead of putting the task into the repository, call the `SendMessageAsync` method shown above.</span></span>

[!code-csharp[Main](queue-centric-work-pattern/samples/sample2.cs?highlight=10)]

## <a name="processing-queue-messages"></a><span data-ttu-id="9496f-212">キューメッセージの処理</span><span class="sxs-lookup"><span data-stu-id="9496f-212">Processing Queue Messages</span></span>

<span data-ttu-id="9496f-213">キュー内のメッセージを処理するには、バックエンドサービスを作成します。</span><span class="sxs-lookup"><span data-stu-id="9496f-213">To process messages in the queue, we'll create a backend service.</span></span> <span data-ttu-id="9496f-214">バックエンドサービスは、次の手順を実行する無限ループを実行します。</span><span class="sxs-lookup"><span data-stu-id="9496f-214">The backend service will run an infinite loop that performs the following steps:</span></span>

1. <span data-ttu-id="9496f-215">キューから次のメッセージを取得します。</span><span class="sxs-lookup"><span data-stu-id="9496f-215">Get the next message from the queue.</span></span>
2. <span data-ttu-id="9496f-216">メッセージを修正するタスクに逆シリアル化します。</span><span class="sxs-lookup"><span data-stu-id="9496f-216">Deserialize the message to a Fix It task.</span></span>
3. <span data-ttu-id="9496f-217">修正プログラムをデータベースに書き込みます。</span><span class="sxs-lookup"><span data-stu-id="9496f-217">Write the Fix It task to the database.</span></span>

<span data-ttu-id="9496f-218">バックエンドサービスをホストするために、*ワーカーロール*を含む Azure クラウドサービスを作成します。</span><span class="sxs-lookup"><span data-stu-id="9496f-218">To host the backend service, we'll create an Azure Cloud Service that contains a *worker role*.</span></span> <span data-ttu-id="9496f-219">ワーカーロールは、バックエンド処理を実行できる1つ以上の Vm で構成されます。</span><span class="sxs-lookup"><span data-stu-id="9496f-219">A worker role consists of one or more VMs that can do backend processing.</span></span> <span data-ttu-id="9496f-220">これらの Vm で実行されるコードは、キューが使用可能になったときにメッセージをプルします。</span><span class="sxs-lookup"><span data-stu-id="9496f-220">The code that runs in these VMs will pull messages from the queue as they become available.</span></span> <span data-ttu-id="9496f-221">各メッセージについて、JSON ペイロードを逆シリアル化して、web 層で前に使用したのと同じリポジトリを使用して、Fix It Task エンティティのインスタンスをデータベースに書き込みます。</span><span class="sxs-lookup"><span data-stu-id="9496f-221">For each message, we'll deserialize the JSON payload and write an instance of the Fix It Task entity to the database, using the same repository that we used earlier in the web tier.</span></span>

<span data-ttu-id="9496f-222">次の手順は、標準の web プロジェクトを持つソリューションにワーカーロールプロジェクトを追加する方法を示しています。</span><span class="sxs-lookup"><span data-stu-id="9496f-222">The following steps show how to add a worker role project to a solution that has a standard web project.</span></span> <span data-ttu-id="9496f-223">これらの手順は、ダウンロード可能な修正プログラムのプロジェクトで既に実行されています。</span><span class="sxs-lookup"><span data-stu-id="9496f-223">These steps have already been done in the Fix It project that you can download.</span></span>

<span data-ttu-id="9496f-224">まず、Visual Studio ソリューションにクラウドサービスプロジェクトを追加します。</span><span class="sxs-lookup"><span data-stu-id="9496f-224">First add a Cloud Service project to the Visual Studio solution.</span></span> <span data-ttu-id="9496f-225">ソリューションを右クリックし、 **[追加]** 、 **[新しいプロジェクト]** の順に選択します。</span><span class="sxs-lookup"><span data-stu-id="9496f-225">Right-click the solution and select **Add**, then **New Project**.</span></span> <span data-ttu-id="9496f-226">左側のウィンドウで、 **[ビジュアルC# ]** を展開し、 **[クラウド]** を選択します。</span><span class="sxs-lookup"><span data-stu-id="9496f-226">In the left pane, expand **Visual C#** and select **Cloud**.</span></span>

[![](queue-centric-work-pattern/_static/image5.png)](queue-centric-work-pattern/_static/image4.png)

<span data-ttu-id="9496f-227">**[新しい Azure クラウドサービス]** ダイアログで、左側のウィンドウの **[ビジュアルC# ]** ノードを展開します。</span><span class="sxs-lookup"><span data-stu-id="9496f-227">In the **New Azure Cloud Service** dialog, expand the **Visual C#** node on the left pane.</span></span> <span data-ttu-id="9496f-228">**[Worker ロール]** を選択し、右矢印アイコンをクリックします。</span><span class="sxs-lookup"><span data-stu-id="9496f-228">Select **Worker Role** and click the right-arrow icon.</span></span>

![](queue-centric-work-pattern/_static/image6.png)

<span data-ttu-id="9496f-229">( *Web ロール*を追加することもできます。</span><span class="sxs-lookup"><span data-stu-id="9496f-229">(Notice that you can also add a *web role*.</span></span> <span data-ttu-id="9496f-230">Azure の Web サイトで実行するのではなく、同じクラウドサービスでフロントエンドを修正することができました。</span><span class="sxs-lookup"><span data-stu-id="9496f-230">We could run the Fix It front-end in the same Cloud Service instead of running it in an Azure Web Site.</span></span> <span data-ttu-id="9496f-231">これには、フロントエンドとバックエンド間の接続を簡単に調整できるという利点があります。</span><span class="sxs-lookup"><span data-stu-id="9496f-231">That has some advantages in making connections between front-end and back-end easier to coordinate.</span></span> <span data-ttu-id="9496f-232">ただし、このデモを簡潔にするために、フロントエンドを Azure App Service Web アプリに保持し、クラウドサービスでバックエンドのみを実行しています)。</span><span class="sxs-lookup"><span data-stu-id="9496f-232">However, to keep this demo simple, we're keeping the front-end in an Azure App Service Web App and only running the back-end in a Cloud Service.)</span></span>

<span data-ttu-id="9496f-233">既定の名前は worker ロールに割り当てられます。</span><span class="sxs-lookup"><span data-stu-id="9496f-233">A default name is assigned to the worker role.</span></span> <span data-ttu-id="9496f-234">名前を変更するには、右側のウィンドウで worker ロールの上にマウスポインターを置き、鉛筆アイコンをクリックします。</span><span class="sxs-lookup"><span data-stu-id="9496f-234">To change the name, hover the mouse over the worker role in the right pane, then click the pencil icon.</span></span>

![](queue-centric-work-pattern/_static/image7.png)

<span data-ttu-id="9496f-235">**[OK]** をクリックしてダイアログを完了します。</span><span class="sxs-lookup"><span data-stu-id="9496f-235">Click **OK** to complete the dialog.</span></span> <span data-ttu-id="9496f-236">これにより、2つのプロジェクトが Visual Studio ソリューションに追加されます。</span><span class="sxs-lookup"><span data-stu-id="9496f-236">This adds two projects to the Visual Studio solution.</span></span>

- <span data-ttu-id="9496f-237">構成情報を含む、クラウドサービスを定義する Azure プロジェクト。</span><span class="sxs-lookup"><span data-stu-id="9496f-237">an Azure project that defines the cloud service, including configuration information.</span></span>
- <span data-ttu-id="9496f-238">ワーカーロールを定義するワーカーロールプロジェクト。</span><span class="sxs-lookup"><span data-stu-id="9496f-238">A worker role project that defines the worker role.</span></span>

![](queue-centric-work-pattern/_static/image8.png)

<span data-ttu-id="9496f-239">詳細については、「 [Visual Studio を使用した Azure プロジェクトの作成](https://msdn.microsoft.com/library/windowsazure/ee405487.aspx)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="9496f-239">For more information, see [Creating an Azure Project with Visual Studio.](https://msdn.microsoft.com/library/windowsazure/ee405487.aspx)</span></span>

<span data-ttu-id="9496f-240">Worker ロール内では、前に見た `FixItQueueManager` クラスの `ProcessMessageAsync` メソッドを呼び出すことによってメッセージをポーリングします。</span><span class="sxs-lookup"><span data-stu-id="9496f-240">Inside the worker role, we poll for messages by calling the `ProcessMessageAsync` method of the `FixItQueueManager` class that we saw earlier.</span></span>

[!code-csharp[Main](queue-centric-work-pattern/samples/sample3.cs?highlight=25)]

<span data-ttu-id="9496f-241">`ProcessMessagesAsync` メソッドは、待機中のメッセージがあるかどうかを確認します。</span><span class="sxs-lookup"><span data-stu-id="9496f-241">The `ProcessMessagesAsync` method checks if there's a message waiting.</span></span> <span data-ttu-id="9496f-242">存在する場合は、メッセージを `FixItTask` エンティティに逆シリアル化し、エンティティをデータベースに保存します。</span><span class="sxs-lookup"><span data-stu-id="9496f-242">If there is one, it deserializes the message into a `FixItTask` entity and saves the entity in the database.</span></span> <span data-ttu-id="9496f-243">キューが空になるまでループします。</span><span class="sxs-lookup"><span data-stu-id="9496f-243">It loops until the queue is empty.</span></span>

[!code-csharp[Main](queue-centric-work-pattern/samples/sample4.cs)]

<span data-ttu-id="9496f-244">キューメッセージをポーリングすると、トランザクションの料金が小さいので、処理を待機しているメッセージがない場合、ワーカーロールの `RunAsync` メソッドは、`Task.Delay(1000)`を呼び出して、もう一度ポーリングする前に秒待機します。</span><span class="sxs-lookup"><span data-stu-id="9496f-244">Polling for queue messages incurs a small transaction charge, so when there's no message waiting to be processed, the worker role's `RunAsync` method waits a second before polling again by calling `Task.Delay(1000)`.</span></span>

<span data-ttu-id="9496f-245">Web プロジェクトで非同期コードを追加すると、IIS が制限されたスレッドプールを管理するため、パフォーマンスが自動的に向上します。</span><span class="sxs-lookup"><span data-stu-id="9496f-245">In a web project, adding asynchronous code can automatically improve performance because IIS manages a limited thread pool.</span></span> <span data-ttu-id="9496f-246">これは、ワーカーロールプロジェクトの場合には当てはまりません。</span><span class="sxs-lookup"><span data-stu-id="9496f-246">That is not the case in a worker role project.</span></span> <span data-ttu-id="9496f-247">ワーカーロールのスケーラビリティを向上させるには、マルチスレッドコードを記述するか、非同期コードを使用して[並列プログラミング](https://msdn.microsoft.com/library/ff963553.aspx)を実装します。</span><span class="sxs-lookup"><span data-stu-id="9496f-247">To improve scalability of the worker role, you can write multi-threaded code or use asynchronous code to implement [parallel programming](https://msdn.microsoft.com/library/ff963553.aspx).</span></span> <span data-ttu-id="9496f-248">このサンプルは並列プログラミングを実装していませんが、並列プログラミングを実装できるようにコードを非同期にする方法を示しています。</span><span class="sxs-lookup"><span data-stu-id="9496f-248">The sample doesn't implement parallel programming but shows how to make the code asynchronous so you can implement parallel programming.</span></span>

## <a name="summary"></a><span data-ttu-id="9496f-249">要約</span><span class="sxs-lookup"><span data-stu-id="9496f-249">Summary</span></span>

<span data-ttu-id="9496f-250">この章では、キュー中心の作業パターンを実装することによって、アプリケーションの応答性、信頼性、スケーラビリティを向上させる方法について説明しました。</span><span class="sxs-lookup"><span data-stu-id="9496f-250">In this chapter you've seen how to improve application responsiveness, reliability, and scalability by implementing the queue-centric work pattern.</span></span>

<span data-ttu-id="9496f-251">これは、この電子書籍に記載されている13個のパターンの最後のパターンですが、成功したクラウドアプリの構築に役立つパターンとプラクティスは他にも多数あります。</span><span class="sxs-lookup"><span data-stu-id="9496f-251">This is the last of the 13 patterns covered in this e-book, but there are of course many other patterns and practices that can help you build successful cloud apps.</span></span> <span data-ttu-id="9496f-252">[最後の章](more-patterns-and-guidance.md)では、これらの13のパターンで説明されていないトピックに関するリソースへのリンクを示します。</span><span class="sxs-lookup"><span data-stu-id="9496f-252">The [final chapter](more-patterns-and-guidance.md) provides links to resources for topics that haven't been covered in these 13 patterns.</span></span>

<a id="resources"></a>
## <a name="resources"></a><span data-ttu-id="9496f-253">リソース</span><span class="sxs-lookup"><span data-stu-id="9496f-253">Resources</span></span>

<span data-ttu-id="9496f-254">キューの詳細については、次のリソースを参照してください。</span><span class="sxs-lookup"><span data-stu-id="9496f-254">For more information about queues, see the following resources.</span></span>

<span data-ttu-id="9496f-255">ドキュメント:</span><span class="sxs-lookup"><span data-stu-id="9496f-255">Documentation:</span></span>

- <span data-ttu-id="9496f-256">[Microsoft Azure Storage キューパート 1: はじめに](https://www.red-gate.com/simple-talk/cloud/platform-as-a-service/microsoft-azure-storage-queues-part-1-getting-started/)。</span><span class="sxs-lookup"><span data-stu-id="9496f-256">[Microsoft Azure Storage Queues Part 1: Getting Started](https://www.red-gate.com/simple-talk/cloud/platform-as-a-service/microsoft-azure-storage-queues-part-1-getting-started/).</span></span> <span data-ttu-id="9496f-257">Roman Schacherl の記事。</span><span class="sxs-lookup"><span data-stu-id="9496f-257">Article by Roman Schacherl.</span></span>
- <span data-ttu-id="9496f-258">[バックグラウンドタスクの実行](https://msdn.microsoft.com/library/ff803365.aspx)、クラウドへのアプリケーションの移動の第5章[、3エディション (](https://msdn.microsoft.com/library/ff728592.aspx) Microsoft のパターンとプラクティスを参照)。</span><span class="sxs-lookup"><span data-stu-id="9496f-258">[Executing Background Tasks](https://msdn.microsoft.com/library/ff803365.aspx), chapter 5 of [Moving Applications to the Cloud, 3rd Edition](https://msdn.microsoft.com/library/ff728592.aspx) from Microsoft Patterns and Practices.</span></span> <span data-ttu-id="9496f-259">(特に、「 [Azure Storage キューの使用」](https://msdn.microsoft.com/library/ff803365.aspx#sec7)を参照してください)。</span><span class="sxs-lookup"><span data-stu-id="9496f-259">(In particular, the section ["Using Azure Storage Queues"](https://msdn.microsoft.com/library/ff803365.aspx#sec7).)</span></span>
- <span data-ttu-id="9496f-260">[Azure 上のキューベースのメッセージングソリューションのスケーラビリティとコスト効果を最大化するためのベストプラクティス](https://msdn.microsoft.com/library/windowsazure/hh697709.aspx)です。</span><span class="sxs-lookup"><span data-stu-id="9496f-260">[Best Practices for Maximizing Scalability and Cost Effectiveness of Queue-Based Messaging Solutions on Azure](https://msdn.microsoft.com/library/windowsazure/hh697709.aspx).</span></span> <span data-ttu-id="9496f-261">Valery のホワイトペーパー。</span><span class="sxs-lookup"><span data-stu-id="9496f-261">White paper by Valery Mizonov.</span></span>
- <span data-ttu-id="9496f-262">[Azure キューと Service Bus キューを比較](https://msdn.microsoft.com/magazine/jj159884.aspx)します。</span><span class="sxs-lookup"><span data-stu-id="9496f-262">[Comparing Azure Queues and Service Bus Queues](https://msdn.microsoft.com/magazine/jj159884.aspx).</span></span> <span data-ttu-id="9496f-263">MSDN マガジンの記事では、使用するキューサービスを選択する際に役立つ追加情報を提供しています。</span><span class="sxs-lookup"><span data-stu-id="9496f-263">MSDN Magazine article, provides additional information that can help you choose which queue service to use.</span></span> <span data-ttu-id="9496f-264">この記事では、Service Bus が認証用に ACS に依存していることを示しています。つまり、ACS を使用できない場合、SB キューは使用できなくなります。</span><span class="sxs-lookup"><span data-stu-id="9496f-264">The article mentions that Service Bus is dependent on ACS for authentication, which means your SB queues would be unavailable when ACS is unavailable.</span></span> <span data-ttu-id="9496f-265">ただし、記事が書かれたため、SB は ACS の代わりに[SAS トークン](https://msdn.microsoft.com/library/windowsazure/dn170477.aspx)を使用できるように変更されました。</span><span class="sxs-lookup"><span data-stu-id="9496f-265">However, since the article was written, SB was changed to enable you to use [SAS tokens](https://msdn.microsoft.com/library/windowsazure/dn170477.aspx) as an alternative to ACS.</span></span>
- <span data-ttu-id="9496f-266">[Microsoft のパターンとプラクティス-Azure のガイダンス](https://msdn.microsoft.com/library/dn568099.aspx)。</span><span class="sxs-lookup"><span data-stu-id="9496f-266">[Microsoft Patterns and Practices - Azure Guidance](https://msdn.microsoft.com/library/dn568099.aspx).</span></span> <span data-ttu-id="9496f-267">「非同期メッセージングの概要」、「パイプとフィルターパターン」、「補正トランザクションパターン」、「競合コンシューマーパターン」、「CQRS パターン」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="9496f-267">See Asynchronous Messaging primer, Pipes and Filters pattern, Compensating Transaction pattern, Competing Consumers pattern, CQRS pattern.</span></span>
- <span data-ttu-id="9496f-268">[CQRS の旅](https://msdn.microsoft.com/library/jj554200)。</span><span class="sxs-lookup"><span data-stu-id="9496f-268">[CQRS Journey](https://msdn.microsoft.com/library/jj554200).</span></span> <span data-ttu-id="9496f-269">Microsoft のパターンとプラクティスによる CQRS に関する電子書籍。</span><span class="sxs-lookup"><span data-stu-id="9496f-269">E-book about CQRS by Microsoft Patterns and Practices.</span></span>

<span data-ttu-id="9496f-270">ビデオ:</span><span class="sxs-lookup"><span data-stu-id="9496f-270">Video:</span></span>

- <span data-ttu-id="9496f-271">[フェイルセーフ: スケーラブルで回復力のある Cloud Services を構築](https://channel9.msdn.com/Series/FailSafe)します。</span><span class="sxs-lookup"><span data-stu-id="9496f-271">[FailSafe: Building Scalable, Resilient Cloud Services](https://channel9.msdn.com/Series/FailSafe).</span></span> <span data-ttu-id="9496f-272">Ulrich Homann、Marc Mercuri、Mark Simm による9部構成のビデオシリーズ。</span><span class="sxs-lookup"><span data-stu-id="9496f-272">Nine-part video series by Ulrich Homann, Marc Mercuri, and Mark Simms.</span></span> <span data-ttu-id="9496f-273">高度な概念とアーキテクチャの原則を、非常にアクセスしやすく興味深い方法で紹介します。実際の顧客との Microsoft カスタマーアドバイザリチーム (CAT) エクスペリエンスによってストーリーが描画されます。</span><span class="sxs-lookup"><span data-stu-id="9496f-273">Presents high-level concepts and architectural principles in a very accessible and interesting way, with stories drawn from Microsoft Customer Advisory Team (CAT) experience with actual customers.</span></span> <span data-ttu-id="9496f-274">Azure Storage サービスとキューの概要については、35:13 以降のエピソード5を参照してください。</span><span class="sxs-lookup"><span data-stu-id="9496f-274">For an introduction to the Azure Storage service and queues, see episode 5 starting at 35:13.</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="9496f-275">[前へ](distributed-caching.md)
> [次へ](more-patterns-and-guidance.md)</span><span class="sxs-lookup"><span data-stu-id="9496f-275">[Previous](distributed-caching.md)
[Next](more-patterns-and-guidance.md)</span></span>
